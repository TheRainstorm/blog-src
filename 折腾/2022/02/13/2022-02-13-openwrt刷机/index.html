
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录一些关于数学、计算机的知识，以及一些日常。">
      
      
      
        <link rel="canonical" href="https://yfy.cqu.ai/%E6%8A%98%E8%85%BE/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/">
      
      
        <link rel="prev" href="../2022-02-13-openwrt%E7%BC%96%E8%AF%91/">
      
      
        <link rel="next" href="../../14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>openwrt刷机 - Rain的随笔</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openwrt硬件选择" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="Rain的随笔" class="md-header__button md-logo" aria-label="Rain的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rain的随笔
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              openwrt刷机
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  博客

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../about/" class="md-tabs__link">
        
  
    
  
  关于

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tags/" class="md-tabs__link">
        
  
    
  
  标签

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../series/" class="md-tabs__link">
        
  
    
  
  系列

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tools/" class="md-tabs__link">
        
  
    
  
  工具

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../archive/2024/" class="md-tabs__link">
          
  
  归档

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../category/homelab/" class="md-tabs__link">
          
  
  分类

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Rain的随笔" class="md-nav__button md-logo" aria-label="Rain的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Rain的随笔
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    博客
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    标签
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    系列
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    工具
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    归档
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    分类
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            分类
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/homelab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    homelab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E4%B8%AA%E4%BA%BA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    个人
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%8D%9A%E5%AE%A2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    博客
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何实现网络自由
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E6%8A%98%E8%85%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    折腾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E6%9D%82%E6%96%87/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    杂文
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    编程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%99%9A%E6%8B%9F%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    虚拟化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%AE%BE%E5%A4%87/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    设备
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%AF%BE%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    课程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E9%98%85%E8%AF%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    阅读
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2022-02-13 01:18:16" class="md-ellipsis">2022年2月13日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../../../../category/%E6%8A%98%E8%85%BE/">折腾</a>, 
                              <a href="../../../../../category/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/">如何实现网络自由</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 18 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openwrt硬件选择" class="md-nav__link">
    <span class="md-ellipsis">
      Openwrt硬件选择
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Openwrt硬件选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#小米路由器型号总结" class="md-nav__link">
    <span class="md-ellipsis">
      小米路由器型号总结
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米路由器型号总结">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu分类" class="md-nav__link">
    <span class="md-ellipsis">
      CPU分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#小米系列产品" class="md-nav__link">
    <span class="md-ellipsis">
      小米系列产品
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2023-wifi6产品" class="md-nav__link">
    <span class="md-ellipsis">
      2023 wifi6产品
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu对比" class="md-nav__link">
    <span class="md-ellipsis">
      CPU对比
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#刷机过程总结" class="md-nav__link">
    <span class="md-ellipsis">
      刷机过程总结
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#小米路由器救砖" class="md-nav__link">
    <span class="md-ellipsis">
      小米路由器救砖
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米路由器救砖">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#有官方bootloader的情况" class="md-nav__link">
    <span class="md-ellipsis">
      有官方bootloader的情况
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#刷了breed" class="md-nav__link">
    <span class="md-ellipsis">
      刷了breed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#常用操作" class="md-nav__link">
    <span class="md-ellipsis">
      常用操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="常用操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#刷之前备份mtd分区" class="md-nav__link">
    <span class="md-ellipsis">
      刷之前备份mtd分区
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshot的说明" class="md-nav__link">
    <span class="md-ellipsis">
      snapshot的说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#命令行安装sysupgradebin" class="md-nav__link">
    <span class="md-ellipsis">
      命令行安装sysupgrade.bin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#备份恢复-cli" class="md-nav__link">
    <span class="md-ellipsis">
      备份恢复 CLI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#性能测试" class="md-nav__link">
    <span class="md-ellipsis">
      性能测试
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iperf3" class="md-nav__link">
    <span class="md-ellipsis">
      iperf3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#具体型号刷机过程" class="md-nav__link">
    <span class="md-ellipsis">
      具体型号刷机过程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="具体型号刷机过程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redmi-ac2100刷openwrt" class="md-nav__link">
    <span class="md-ellipsis">
      Redmi AC2100刷Openwrt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Redmi AC2100刷Openwrt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-确认stock系统版本" class="md-nav__link">
    <span class="md-ellipsis">
      1. 确认stock系统版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-获得ssh" class="md-nav__link">
    <span class="md-ellipsis">
      2. 获得ssh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-下载openwrt镜像" class="md-nav__link">
    <span class="md-ellipsis">
      3. 下载openwrt镜像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-备份" class="md-nav__link">
    <span class="md-ellipsis">
      4. 备份
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-设置环境变量" class="md-nav__link">
    <span class="md-ellipsis">
      5. 设置环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-刷机" class="md-nav__link">
    <span class="md-ellipsis">
      6. 刷机
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mi-4a千兆版" class="md-nav__link">
    <span class="md-ellipsis">
      MI 4A千兆版
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MI 4A千兆版">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#说明" class="md-nav__link">
    <span class="md-ellipsis">
      说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#步骤" class="md-nav__link">
    <span class="md-ellipsis">
      步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#参考" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eeprom下载" class="md-nav__link">
    <span class="md-ellipsis">
      EEPROM下载
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eeprom修改" class="md-nav__link">
    <span class="md-ellipsis">
      EEPROM修改
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mi-r3g" class="md-nav__link">
    <span class="md-ellipsis">
      MI R3G
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MI R3G">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#准备" class="md-nav__link">
    <span class="md-ellipsis">
      准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#开启ssh" class="md-nav__link">
    <span class="md-ellipsis">
      开启ssh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#备份" class="md-nav__link">
    <span class="md-ellipsis">
      备份
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#刷openwrt" class="md-nav__link">
    <span class="md-ellipsis">
      刷openwrt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ax6s" class="md-nav__link">
    <span class="md-ellipsis">
      AX6S
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AX6S">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#步骤_1" class="md-nav__link">
    <span class="md-ellipsis">
      步骤
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#竞斗云20pw" class="md-nav__link">
    <span class="md-ellipsis">
      竞斗云2.0（P&amp;W)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="竞斗云2.0（P&W)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#资料" class="md-nav__link">
    <span class="md-ellipsis">
      资料
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#教程" class="md-nav__link">
    <span class="md-ellipsis">
      教程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#遇到问题" class="md-nav__link">
    <span class="md-ellipsis">
      遇到问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#360-t7" class="md-nav__link">
    <span class="md-ellipsis">
      360 T7
    </span>
  </a>
  
    <nav class="md-nav" aria-label="360 T7">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#基本参数" class="md-nav__link">
    <span class="md-ellipsis">
      基本参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#准备_1" class="md-nav__link">
    <span class="md-ellipsis">
      准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-拆机和ttl模块连接" class="md-nav__link">
    <span class="md-ellipsis">
      1. 拆机和TTL模块连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ttl进入failsafe模式开启telnet" class="md-nav__link">
    <span class="md-ellipsis">
      2. TTL进入failsafe模式开启telnet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-刷改版uboot并刷固件" class="md-nav__link">
    <span class="md-ellipsis">
      3. 刷改版uboot并刷固件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#固件选择" class="md-nav__link">
    <span class="md-ellipsis">
      固件选择
    </span>
  </a>
  
    <nav class="md-nav" aria-label="固件选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mtwifi闭源驱动" class="md-nav__link">
    <span class="md-ellipsis">
      mtwifi闭源驱动
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#不确定" class="md-nav__link">
    <span class="md-ellipsis">
      不确定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#小米wr30u" class="md-nav__link">
    <span class="md-ellipsis">
      小米WR30U
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米WR30U">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#刷机" class="md-nav__link">
    <span class="md-ellipsis">
      刷机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#固件" class="md-nav__link">
    <span class="md-ellipsis">
      固件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ft" class="md-nav__link">
    <span class="md-ellipsis">
      FT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#其它" class="md-nav__link">
    <span class="md-ellipsis">
      其它
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#硬件性能测试wg带宽" class="md-nav__link">
    <span class="md-ellipsis">
      硬件性能测试(wg带宽)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="硬件性能测试(wg带宽)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#king3399" class="md-nav__link">
    <span class="md-ellipsis">
      king3399
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p2w" class="md-nav__link">
    <span class="md-ellipsis">
      p2w
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ax6s_1" class="md-nav__link">
    <span class="md-ellipsis">
      ax6s
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <a href="../../../../../tags/#openwrt" class="md-tag">openwrt</a>
    
  
</nav>



  <h1>openwrt刷机</h1>

<p>介绍了从硬件选择到刷机整个过程</p>
<!-- more -->

<h2 id="openwrt硬件选择">Openwrt硬件选择<a class="headerlink" href="#openwrt硬件选择" title="Permanent link">&para;</a></h2>
<p>如何选择一个可以刷openwrt的路由器？</p>
<ul>
<li><a href="https://post.smzdm.com/p/awznd6qg/">老房子WiFi布网攻略 篇三十八：WiFi 6 梅林或openwrt固件路由器入手指南_路由器_什么值得买 (smzdm.com)</a></li>
<li><a href="https://post.smzdm.com/p/apzkqlrx/">老房子WiFi布网攻略 篇二十四：不漏油的路由器不是好矿机，矿渣路由器盘点_路由器_什么值得买 (smzdm.com)</a></li>
<li>极路由、新路由：<a href="https://www.right.com.cn/forum/thread-8097191-1-1.html">机皇！几种高性价比矿渣路由器比较-新手入门及其它(硬件)-恩山无线论坛 (right.com.cn)</a></li>
</ul>
<h3 id="小米路由器型号总结">小米路由器型号总结<a class="headerlink" href="#小米路由器型号总结" title="Permanent link">&para;</a></h3>
<h4 id="cpu分类">CPU分类<a class="headerlink" href="#cpu分类" title="Permanent link">&para;</a></h4>
<ul>
<li>mt7621型号</li>
<li>R3G：咸鱼50元左右，有USB3.0接口，128MB的flash。</li>
<li>4A千兆版：咸鱼70元左右，外观简约漂亮，16MB NOR flash有点小。</li>
<li>C660x：咸鱼100多，支持wifi6</li>
<li>高通型号</li>
<li><strong>目前(22.03)只有AX6S是受openwrt官方支持的</strong>，AX6, AX3600有第三方支持。AX5等其余未支持<ul>
<li>不能刷好像是linux kernel还不支持高通的IPQ SoC。</li>
<li>B站看到说AX5刷openwrt需要硬改内存为1G，好像说高通的wifi驱动非常耗内存</li>
</ul>
</li>
<li>AX6S：220左右</li>
<li>AX6：250-300左右</li>
</ul>
<h4 id="小米系列产品">小米系列产品<a class="headerlink" href="#小米系列产品" title="Permanent link">&para;</a></h4>
<ul>
<li>红米AX5，小米AX1800换皮</li>
<li>
<p>IPQ6000, 4核A53@1.2Ghz：[<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_ax1800">OpenWrt Wiki] Xiaomi AX1800 (AX5/RA67)</a></p>
</li>
<li>
<p><strong>红米AX6</strong>，小米AX3600换皮</p>
</li>
<li>AX6, <strong>IPQ8071A</strong>@1.4GHz, 512(ram) + 128：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_redmi_ax6_ax3000">[OpenWrt Wiki] Xiaomi Redmi AX6 Wi-Fi 6 Mesh Router</a></li>
<li>AX3600, IPQ8071A, 512 + 256：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_ax3600">[OpenWrt Wiki] Xiaomi AX3600</a></li>
<li>对比：<a href="https://www.acwifi.net/11176.html">红米AX6拆机，旧款WIFI6无线路由器-路由器交流 (acwifi.net)</a></li>
<li>AX3000</li>
<li><strong>红米AX3000（比较常见）</strong>，IPQ5000：双核A53@1.0GHz, 256(ram) + 128：<a href="https://www.mi.com/shop/buy/detail?product_id=14538">Redmi路由器AX3000立即购买-小米商城</a></li>
<li>小米AX3000：IPQ5000：双核A53@1.0GHz, 256(ram) + 128：<a href="https://www.mi.com/shop/buy/detail?product_id=14790">小米路由器AX3000立即购买-小米商城 (mi.com)</a></li>
<li>红米AX3000模具和AX6S一样，为白色。小米AX3000为黑色四棱柱。</li>
<li>AX5400</li>
<li>红米AX5400，IPQ5018：双核A53@1.0GHz，512(ram) + 128：<a href="https://www.acwifi.net/19451.html">红米AX5400千兆版拆机，看看与电竞版有什么差别-路由器交流 (acwifi.net)</a></li>
<li>AX6000</li>
<li>小米AX6000<ul>
<li>IPQ5018, 2核A53@1.0Ghz, 512(ram) + 128</li>
<li>使用的SoC IPQ5018为高通沉浸式家庭联网平台，不如高通专业联网平台的IPQ8071A（AX3600上的）</li>
</ul>
</li>
<li><strong>红米AX6000（很强）</strong><ul>
<li><strong>MT7986A</strong>, 4核A53@2.0Ghz, 512(ram) + 128：[<a href="https://openwrt.org/toh/xiaomi/redmi_ax6000">OpenWrt Wiki] Xiaomi Redmi AX6000</a></li>
<li><a href="https://www.acwifi.net/19676.html">红米AX6000拆机，最便宜的四核2.0GHz-路由器交流 (acwifi.net)</a></li>
</ul>
</li>
</ul>
<p><img alt="image-20221029213022447" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20221029213022447.png" /></p>
<p>参考
- <a href="https://www.zhihu.com/question/474579126">(33 封私信 / 71 条消息) 路由器红米ax3000和红米ax6选择哪个? - 知乎 (zhihu.com)</a>
- 小米openwrt页面：<a href="https://openwrt.org/toh/hwdata/xiaomi/start">[OpenWrt Wiki] Xiaomi</a>
- 常见MediaTek SoC：<a href="https://wikidevi.wi-cat.ru/MediaTek">MediaTek - WikiDevi.Wi-Cat.RU</a></p>
<h3 id="2023-wifi6产品">2023 wifi6产品<a class="headerlink" href="#2023-wifi6产品" title="Permanent link">&para;</a></h3>
<p>现在需求wifi6，且信号覆盖广
- 小米wr30u：运营商定制版
- 360 T7：和上者硬件一摸一样。12v 1A</p>
<p>wr30u: wifi6: <a href="https://www.acwifi.net/23700.html">小米WR30U无线路由器拆机 AX3000联通定制版-路由器交流 (acwifi.net)</a>
<a href="https://zhuanlan.zhihu.com/p/640643641">2023年支持刷机的路由器大全（建议收藏） - 知乎 (zhihu.com)</a></p>
<ul>
<li>AX1800：cr660x</li>
<li>AX3000：cr880x：135</li>
</ul>
<p><a href="https://www.v2ex.com/t/948845">618 想买台路由器求推荐 - V2EX</a>
150的T7 512改：<a href="https://www.saraba1st.com/2b/thread-2141173-1-1.html">WR30U路由到了随手测测 - ＰＣ数码 - Stage1st - stage1/s1 游戏动漫论坛 (saraba1st.com)</a></p>
<h3 id="cpu对比">CPU对比<a class="headerlink" href="#cpu对比" title="Permanent link">&para;</a></h3>
<p>参考：</p>
<ul>
<li>
<p>[<a href="https://www.right.com.cn/forum/thread-216888-1-1.html">转贴] 无线路由器CPU浅析 MT7621A、 BCM47189 到底谁强？-新手入门及其它(硬件)-恩山无线论坛 (right.com.cn)</a></p>
</li>
<li>
<p>树莓派系列处理器：<a href="https://www.raspberrypi.com/documentation/computers/processors.html">Raspberry Pi Documentation - Processors</a></p>
</li>
<li>Raspberry Pi 2 Model B： BCM2836(quad-core Cortex-A7 )</li>
<li>Raspberry Pi 3 Model B：BCM2837( quad-core Cortex-A53@1.2)<ul>
<li>50% faster than the Raspberry Pi 2.</li>
</ul>
</li>
<li>Raspberry Pi 3 Models A+, B+: BCM2837B0(quad-core Cortex-A53@1.4)<ul>
<li>17% faster than the original Raspberry Pi 3</li>
</ul>
</li>
<li>
<p>Raspberry Pi 4 Model B: BCM2837(quad-core Cortex-A72@1.5 GHz)</p>
<ul>
<li>50% faster than the Raspberry Pi 3B+</li>
</ul>
</li>
<li>
<p>ARM核对比：<a href="https://en.wikipedia.org/wiki/List_of_ARM_processors">List of ARM processors - Wikipedia</a></p>
</li>
<li>Cortex-A7: 1.9 DMIPS/MHz per core</li>
<li>A53: 2.3 DMIPS/MHz</li>
<li>A72: 6.3-7.3 DMIPS/MHz</li>
<li>MIPS核：<a href="https://www.mips.com/products/classic/">MIPS Classic Processor Cores - Imagination Technologies</a></li>
<li>1004K: 1.6 DMIPS/MHz</li>
<li>
<p>74k: 1.93 DMIPS/MHz：CSAC路由器：71</p>
</li>
<li>
<p><a href="https://github.com/sawaYch/newifi3-d2-firmware/blob/master/README.md">newifi3-d2-firmware/README.md at master · sawaYch/newifi3-d2-firmware (github.com)</a></p>
</li>
</ul>
<h2 id="刷机过程总结">刷机过程总结<a class="headerlink" href="#刷机过程总结" title="Permanent link">&para;</a></h2>
<p>以红米AC2100可能的刷机为例，涵盖了openwrt的各种情况：刷breed，恢复，临时镜像</p>
<ul>
<li>
<p><strong>建议直接使用官方openwrt镜像 + 官方安装方式。几次使用breed都遇到了问题，而小米官方恢复工具也挺好用的。</strong></p>
</li>
<li>
<p>第一次自己刷机红米AC2100[[记录红米AC2100折腾]]，一张精华图</p>
</li>
</ul>
<p><img alt="image-20210622145337241" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20210622145337241.png" /></p>
<ul>
<li>路由器刷出问题，修复经验。知道了备份的重要性[[记录记一次路由器刷出问题修复过程]]</li>
</ul>
<h2 id="小米路由器救砖">小米路由器救砖<a class="headerlink" href="#小米路由器救砖" title="Permanent link">&para;</a></h2>
<h3 id="有官方bootloader的情况">有官方bootloader的情况<a class="headerlink" href="#有官方bootloader的情况" title="Permanent link">&para;</a></h3>
<p><strong>说明：</strong></p>
<p>官方的引导程序使用的是uboot，位于flash的Bootloader分区，而官方固件则位于OS1分区（红米AC2100）。正常刷openwrt的过程中不会修改bootloader。只要还保留着官方bootloader，就可以通过官方修复工具恢复。</p>
<p><strong>步骤：</strong></p>
<ol>
<li>下载<code>小米路由器修复工具</code>和官方镜像：<a href="https://www.xiaomi.cn/post/19184644">【下载汇总】客户端/ROM下载 - 小米社区 (xiaomi.cn)</a></li>
<li><strong>路由器通电</strong>，PC通过网线连接到路由器LAN口</li>
<li>打开<code>MIWIFIRepairTool.x86.exe</code></li>
<li>选择镜像</li>
<li><strong>选择网卡</strong>（可以在网络中心中将其它网卡禁用）</li>
<li>断开路由器电源，按住rst键（也有可能需要用针戳），然后接上电源，等待黄灯闪烁（两个灯，一个是有电源标志，一个有互联网标志，这里为电源灯那个）</li>
<li>软件自动上传镜像</li>
<li>保持耐心等待路由器黄灯变蓝（中间过程保持黄灯），<strong>亲测需要4分钟</strong></li>
<li>断电后重新接上电源，路由器重启</li>
</ol>
<h3 id="刷了breed">刷了breed<a class="headerlink" href="#刷了breed" title="Permanent link">&para;</a></h3>
<p><strong>说明：</strong></p>
<p>breed自身便是一个bootloader，刷完breed后会覆盖原本的bootloader。如果想复原，可通过breed的功能，重新刷回官方bootloader。<strong>强烈建议刷breed前，先备份原本的bootloader以及整个flash</strong>。如果没备份，这里是恩山上收集的<strong>小米官方bootloader下载</strong>：<a href="https://www.right.com.cn/forum/thread-4102208-1-1.html">论坛收集的几个小米路由器官方bootloader - 恩山无线论坛</a></p>
<p><strong>步骤：</strong></p>
<ol>
<li>通过breed刷回官方bootloader</li>
<li>通过官方修复工具修复</li>
</ol>
<h2 id="常用操作">常用操作<a class="headerlink" href="#常用操作" title="Permanent link">&para;</a></h2>
<h3 id="刷之前备份mtd分区">刷之前备份mtd分区<a class="headerlink" href="#刷之前备份mtd分区" title="Permanent link">&para;</a></h3>
<p>路由器flash有若干分区，其中有一个分区存储路由器MAC地址、无线校准参数等。若损坏可能导致无线信号弱等问题。因此刷之前最好备份。
查看mtd分区</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>root@XiaoQiang:~#<span class="w"> </span>cat<span class="w"> </span>/proc/mtd
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>dev:<span class="w">    </span>size<span class="w">   </span>erasesize<span class="w">  </span>name
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>mtd0:<span class="w"> </span>07f80000<span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;ALL&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>mtd1:<span class="w"> </span><span class="m">00080000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Bootloader&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>mtd2:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Config&quot;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>mtd3:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Bdata&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>mtd4:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Factory&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>mtd5:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;crash&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>mtd6:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;crash_syslog&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>mtd7:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;reserved0&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>mtd8:<span class="w"> </span><span class="m">00400000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;kernel0&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>mtd9:<span class="w"> </span><span class="m">00400000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;kernel1&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>mtd10:<span class="w"> </span><span class="m">02000000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;rootfs0&quot;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>mtd11:<span class="w"> </span><span class="m">02000000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;rootfs1&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>mtd12:<span class="w"> </span><span class="m">03580000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;overlay&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>mtd13:<span class="w"> </span>012a6000<span class="w"> </span>0001f000<span class="w"> </span><span class="s2">&quot;ubi_rootfs&quot;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>mtd14:<span class="w"> </span>030ec000<span class="w"> </span>0001f000<span class="w"> </span><span class="s2">&quot;data&quot;</span>
</span></code></pre></div>
<p>备份factory分区（小米路由器一般是factory存储了上述那些数据）
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cat<span class="w"> </span>/dev/mtd4<span class="w"> </span>&gt;<span class="w"> </span>/tmp/factory.bin
</span></code></pre></div></p>
<p>之后通过scp复制到本地</p>
<h3 id="snapshot的说明">snapshot的说明<a class="headerlink" href="#snapshot的说明" title="Permanent link">&para;</a></h3>
<p>snapshot是开发版分支</p>
<ul>
<li>默认没有安装luci（没有网页界面）</li>
<li>上游每天都会编译产生新的snapshot。对于kernel mod相关软件，不是同一次编译则无法安装。</li>
<li>[<a href="https://openwrt.org/docs/guide-quick-start/developmentinstallation">OpenWrt Wiki] Installing OpenWrt development snapshots</a></li>
</ul>
<h3 id="命令行安装sysupgradebin">命令行安装sysupgrade.bin<a class="headerlink" href="#命令行安装sysupgradebin" title="Permanent link">&para;</a></h3>
<ul>
<li>[<a href="https://openwrt.org/docs/guide-user/installation/sysupgrade.cli">OpenWrt Wiki] Upgrading OpenWrt firmware using CLI</a></li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sysupgrade -v /tmp/firmware_image.bin
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>#If sysupgrade is not available.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a># Flash firmware
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>mtd -r write /tmp/firmware_image.bin firmware
</span></code></pre></div>
<h3 id="备份恢复-cli">备份恢复 CLI<a class="headerlink" href="#备份恢复-cli" title="Permanent link">&para;</a></h3>
<ul>
<li>官方：[<a href="https://openwrt.org/docs/guide-user/troubleshooting/backup_restore">OpenWrt Wiki] Backup and restore</a></li>
</ul>
<p>自己实现了一个自动配置openwrt脚本</p>
<ul>
<li><a href="https://github.com/TheRainstorm/my-openwrt-config">TheRainstorm/my-openwrt-config (github.com)</a></li>
</ul>
<h3 id="性能测试">性能测试<a class="headerlink" href="#性能测试" title="Permanent link">&para;</a></h3>
<h4 id="iperf3">iperf3<a class="headerlink" href="#iperf3" title="Permanent link">&para;</a></h4>
<p>ax6s &amp; mi4a</p>
<table>
<thead>
<tr>
<th>测试目的</th>
<th>连接</th>
<th>src</th>
<th>dst</th>
<th>speed(Mb/s)</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>ax6s LAN性能</td>
<td>千兆USB网卡</td>
<td>tianyi310</td>
<td>ax6s</td>
<td><strong>941</strong></td>
<td></td>
</tr>
<tr>
<td>ax6s 无线性能</td>
<td>wifi6 5Ghz@1201</td>
<td>s3pro</td>
<td>ax6s</td>
<td><strong>626</strong></td>
<td></td>
</tr>
<tr>
<td>mi4a LAN性能</td>
<td>2.5G网卡</td>
<td>ryzen</td>
<td>mi4a</td>
<td><strong><em>470</em></strong></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>隧道性能</td>
<td></td>
<td>tianyi310</td>
<td>ryzen</td>
<td>118</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>隧道性能</td>
<td></td>
<td>mi4a</td>
<td>ax6s</td>
<td>136</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ax6s</td>
<td>mi4a</td>
<td>149</td>
<td></td>
</tr>
<tr>
<td>mi4a交换性能</td>
<td>ryzen - mi4a - p2w</td>
<td>ryzen</td>
<td>p2w</td>
<td><strong>943</strong></td>
<td>结果居然比ryzen - mi4a还要快！</td>
</tr>
</tbody>
</table>
<p>将r4a替换掉后
| 测试目的 | src       | dst       | speed(Mb/s) | 备注 |
| -------- | --------- | --------- | ----------- | ---- |
| p2w      | ryzen     | p2w       | <strong>936</strong>     |      |
|          | p2w       | ryzen     | <strong><em>577</em></strong>   |      |
| 隧道性能 | p2w       | ax6s      | 150         |      |
|          | ax6s      | p2w       | 250         |      |
| 隧道性能 | ryzen     | tianyi310 | <strong>295</strong>     |      |
|          | tianyi310 | ryzen     | <strong>173</strong>     |      |
|          | s3pro     | ryzen     | 256         |      |
| 780/886  | s3pro     | p2w       | <strong>370</strong>     |      |
|          | ryzen     | s3pro     | 274         |      |</p>
<h2 id="具体型号刷机过程">具体型号刷机过程<a class="headerlink" href="#具体型号刷机过程" title="Permanent link">&para;</a></h2>
<h3 id="redmi-ac2100刷openwrt">Redmi AC2100刷Openwrt<a class="headerlink" href="#redmi-ac2100刷openwrt" title="Permanent link">&para;</a></h3>
<p><a href="https://openwrt.org/toh/xiaomi/xiaomi_redmi_router_ac2100">[OpenWrt Wiki] Xiaomi Redmi Router AC2100</a></p>
<h4 id="1-确认stock系统版本">1. 确认stock系统版本<a class="headerlink" href="#1-确认stock系统版本" title="Permanent link">&para;</a></h4>
<p>确认系统版本是否为2.0.23，如果不是，则在系统内手动升级到该版本http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin</p>
<h4 id="2-获得ssh">2. 获得ssh<a class="headerlink" href="#2-获得ssh" title="Permanent link">&para;</a></h4>
<p>使用web漏洞，获得ssh</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Work for RedMi 2100 firmware 2.0.23</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1">// http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getSTOK</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/;stok=(.*?)\//</span><span class="p">);</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="p">}</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="kd">function</span><span class="w"> </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="nx">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">command</span><span class="p">);</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`/cgi-bin/luci/;stok=</span><span class="si">${</span><span class="nx">stok</span><span class="si">}</span><span class="sb">/api/misystem/set_config_iotdev?bssid=SteelyWing&amp;user_id=SteelyWing&amp;ssid=-h%0A</span><span class="si">${</span><span class="nx">command</span><span class="si">}</span><span class="sb">%0A`</span><span class="p">;</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Request</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">path</span><span class="p">));</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="p">}</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="kd">function</span><span class="w"> </span><span class="nx">enableSSH</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">    </span><span class="nx">stok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getSTOK</span><span class="p">();</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;stok not found in URL&#39;</span><span class="p">);</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`stok = &quot;</span><span class="si">${</span><span class="nx">stok</span><span class="si">}</span><span class="sb">&quot;`</span><span class="p">);</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">    </span><span class="nx">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;Input new SSH password&#39;</span><span class="p">);</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;You must input password&#39;</span><span class="p">);</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">    </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="sb">`</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="sb">nvram set ssh_en=1</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="sb">nvram commit</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="sb">sed -i &#39;s/channel=.*/channel=\\&quot;debug\\&quot;/g&#39; /etc/init.d/dropbear</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="sb">/etc/init.d/dropbear start</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="sb">`</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">));</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;New SSH password: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">password</span><span class="p">);</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">    </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span><span class="sb">`echo -e &quot;</span><span class="si">${</span><span class="nx">password</span><span class="si">}</span><span class="sb">\\n</span><span class="si">${</span><span class="nx">password</span><span class="si">}</span><span class="sb">&quot; | passwd root`</span><span class="p">)</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">));</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="p">}</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="nx">enableSSH</span><span class="p">();</span>
</span></code></pre></div>
<h4 id="3-下载openwrt镜像">3. 下载openwrt镜像<a class="headerlink" href="#3-下载openwrt镜像" title="Permanent link">&para;</a></h4>
<p>从官方下载最新镜像，注意有四个文件</p>
<ul>
<li>kernel: 具有最少文件系统的Linux内核. 对于首次安装或恢复很有用.</li>
<li>kernel1: Linux内核作为单独的映像</li>
<li>rootfs0: 根文件系统作为单独的映像.</li>
<li>Sysupgrade: 使用Sysupgrade映像更新已经运行OpenWrt的路由器. 该映像可以与LuCI Web界面或终端一起使用.</li>
</ul>
<p>需要下载kernel1和rootfs0</p>
<ul>
<li><a href="https://downloads.openwrt.org/">OpenWrt Downloads</a></li>
<li><a href="https://firmware-selector.openwrt.org/">OpenWrt Firmware Selector</a></li>
</ul>
<h4 id="4-备份">4. 备份<a class="headerlink" href="#4-备份" title="Permanent link">&para;</a></h4>
<p>通过dmesg，知道一共有14个mtd分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[    2.940000] NAND device: Manufacturer ID: 0xc8, Chip ID: 0xd1 (ESMT NAND 128MiB 3,3V 8-bit), 128MiB, page size: 2048, OOB size: 64
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>[    2.950000] [NAND]select ecc bit:4, sparesize :64 spare_per_sector=16
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>[    2.950000] Scanning device for bad blocks
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>[    3.100000] Signature matched and data read!
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>[    3.110000] load_fact_bbt success 1023
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>...
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>[    3.190000] Creating 14 MTD partitions on &quot;MT7621-NAND&quot;:
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>[    3.190000] 0x000000000000-0x000007f80000 : &quot;ALL&quot;
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>[    3.200000] 0x000000000000-0x000000080000 : &quot;Bootloader&quot;
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>[    3.210000] 0x000000080000-0x0000000c0000 : &quot;Config&quot;
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>[    3.210000] 0x0000000c0000-0x000000100000 : &quot;Bdata&quot;
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>[    3.220000] 0x000000100000-0x000000140000 : &quot;Factory&quot;
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>[    3.230000] 0x000000140000-0x000000180000 : &quot;crash&quot;
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>[    3.230000] 0x000000180000-0x0000001c0000 : &quot;crash_syslog&quot;
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>[    3.240000] 0x0000001c0000-0x000000200000 : &quot;cfg_bak&quot;
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>[    3.240000] 0x000000200000-0x000000600000 : &quot;kernel0&quot;
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>[    3.250000] 0x000000600000-0x000000a00000 : &quot;kernel1&quot;
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>[    3.260000] 0x000000a00000-0x000002400000 : &quot;rootfs0&quot;
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>[    3.260000] 0x000002400000-0x000003e00000 : &quot;rootfs1&quot;
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>[    3.270000] 0x000003e00000-0x000006400000 : &quot;overlay&quot;
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>[    3.280000] 0x000006400000-0x000007f80000 : &quot;obr&quot;
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>[    3.280000] [mtk_nand] probe successfully!
</span></code></pre></div>
<p>通过cat /proc/mtd，知道对应关系</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>root@XiaoQiang:/tmp# cat /proc/mtd
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>dev:    size   erasesize  name
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>mtd0: 07f80000 00020000 &quot;ALL&quot;
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>mtd1: 00080000 00020000 &quot;Bootloader&quot;
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>mtd2: 00040000 00020000 &quot;Config&quot;
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>mtd3: 00040000 00020000 &quot;Bdata&quot;
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>mtd4: 00040000 00020000 &quot;Factory&quot;
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>mtd5: 00040000 00020000 &quot;crash&quot;
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>mtd6: 00040000 00020000 &quot;crash_syslog&quot;
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>mtd7: 00040000 00020000 &quot;cfg_bak&quot;
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>mtd8: 00400000 00020000 &quot;kernel0&quot;
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>mtd9: 00400000 00020000 &quot;kernel1&quot;
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>mtd10: 01a00000 00020000 &quot;rootfs0&quot;
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>mtd11: 01a00000 00020000 &quot;rootfs1&quot;
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>mtd12: 02600000 00020000 &quot;overlay&quot;
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>mtd13: 01b80000 00020000 &quot;obr&quot;
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>mtd14: 00c1c000 0001f000 &quot;ubi_rootfs&quot;
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>mtd15: 021e8000 0001f000 &quot;data&quot;
</span></code></pre></div>
<p>备份，其中Factory中存储了EEPROM的数据</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>cat /dev/mtd4 &gt; Factory.dump
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>scp复制到本地
</span></code></pre></div>
<h4 id="5-设置环境变量">5. 设置环境变量<a class="headerlink" href="#5-设置环境变量" title="Permanent link">&para;</a></h4>
<p>设置环境变量（rm2100有双系统用于备份保护，需要设置先启动哪一个）</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Enable uart and boot_wait, useful for testing or recovery if you have an uart adapter!</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">uart_en</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">boot_wait</span><span class="o">=</span>on
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">bootdelay</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1"># Set kernel1 as the booting kernel</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">flag_try_sys1_failed</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1"># Commit our nvram changes</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>nvram<span class="w"> </span>commit
</span></code></pre></div>
<h4 id="6-刷机">6. 刷机<a class="headerlink" href="#6-刷机" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>mtd<span class="w"> </span>write<span class="w"> </span>kernel1.bin<span class="w"> </span>kernel1
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>mtd<span class="w"> </span>-r<span class="w"> </span>write<span class="w"> </span>rootfs0.bin<span class="w"> </span>rootfs0
</span></code></pre></div>
<h3 id="mi-4a千兆版">MI 4A千兆版<a class="headerlink" href="#mi-4a千兆版" title="Permanent link">&para;</a></h3>
<p>官方教程：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_mi_router_4a_gigabit_edition">[OpenWrt Wiki] Xiaomi Mi Router 4A Gigabit Edition</a></p>
<p><strong>warning</strong>
- 2022/10：v2版本的4A千兆版无法刷op。原版使用的是Winbond or GigaDevice的flash芯片，我手头的是GigaDevice的<a href="https://www.tme.eu/en/details/gd25q127csig/serial-flash-memories-integrated-circ/gigadevice/">GD25Q127CSIG </a>。新版使用 Eon or CFeon的芯片，还在支持中。
- 老版的有无线屏蔽，而在售的没有</p>
<h4 id="说明">说明<a class="headerlink" href="#说明" title="Permanent link">&para;</a></h4>
<p>可以漏洞获取shell，不必使用硬件编程器</p>
<p>2022/11/6日，因刷breed bootloader，使得MI 4A变砖。忠告：别用breed，会变得不幸。（你tm支持r3g，不支持mi 4a能不能写清楚）</p>
<h4 id="步骤">步骤<a class="headerlink" href="#步骤" title="Permanent link">&para;</a></h4>
<p>~~1. 首先需要使用<code>OpenWRTInvasion</code><strong>获取shell</strong>。参考：<a href="https://github.com/acecilia/OpenWRTInvasion">acecilia/OpenWRTInvasion(github.com)</a>。</p>
<p>~~同时，该仓库也提供了获得shell后的刷机过程。不过使用官方的<code>OpenWRTInvasion</code>会从github上下载文件，而因为网络原因可能会失败。恩山论坛中有用户提供了修改代码的离线版本，可以搜索使用。
不过也可以自行修改代码：修改<code>script.sh</code>，将其中的链接替换成本地链接。可以使用python -m http.server运行一个小的http服务，提供下载。例：
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>curl<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;https://github.com/acecilia/OpenWRTInvasion/raw/master/script_tools/busybox-mipsel&quot;</span><span class="w"> </span>--insecure<span class="w"> </span>--output<span class="w"> </span>busybox
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1">#改为,ip需要调整</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>curl<span class="w"> </span><span class="s2">&quot;http://192.168.31.189:8000/busybox-mipsel&quot;</span><span class="w"> </span>--output<span class="w"> </span>busybox
</span></code></pre></div></p>
<ol>
<li>现在官方仓库集成了本地服务器的功能，直接运行脚本即可。但是官方仓库却放弃了对windows的支持，不过亲测在git bash中运行没有问题，只需要把脚本开头的检测注释掉即可。
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a># if platform.system() == &quot;Windows&quot;:
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>#     sys.exit(&quot;Stopping: script can only be run on a Mac/Linux system&quot;)
</span></code></pre></div></li>
<li>之后使用telnet进行连接，成功获得shell如图所示
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>telnet 192.168.31.1 #账号root, 密码root
</span></code></pre></div>
   <img alt="image-20221030210955796" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20221030210955796.png" /></li>
<li>接着上传openwrt镜像(使用sysupgrade bin)到路由器中，可以使用python搭建http文件服务器。最后运行mtd等待路由器重启完成即可。
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>#window上, sysupgrade.bin所在目录
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>python -m http.server
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>#路由器上
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>cd /tmp
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>curl -O http://&lt;windows ip&gt;:8000/sysupgrade.bin
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>mtd -e OS1 -r write sysupgrade.bin OS1
</span></code></pre></div></li>
</ol>
<h4 id="参考">参考<a class="headerlink" href="#参考" title="Permanent link">&para;</a></h4>
<p>breed使用说明：https://www.sohu.com/a/304140654_120096961
breed刷openwrt教程https://www.ixigua.com/6974624328725824031</p>
<h4 id="eeprom下载">EEPROM下载<a class="headerlink" href="#eeprom下载" title="Permanent link">&para;</a></h4>
<blockquote>
<p>eeprom里有mac和sn等信息，如果sn丢失刷官方bootloader刷回原厂也不能绑定手机app的</p>
</blockquote>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4054821-1-1.html">【新提醒】[20210919更新]小米路由4A千兆版LEDE固件_集成快乐上网、内网穿透、KMS、网络加速-小米无线路由器以及小米无线相关的设备-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></li>
</ul>
<blockquote>
<p>我看了下果然是错的，我之前也是这个情况，后来分析了下把eeprom用上了正确的就好了，你刷我这个eeprom，如果还不行就刷我的解锁分区的lede固件，用mtd命令刷写，ssh上路由，本地scp命令拷贝上传到tmp目录，<br />
  mtd -r write /tmp/eeprom.bin factory<br />
重启完了就ok<br />
刷完mac会变，把你的mac地址改成你原来的mac地址。<br />
如果有原来的固件备份，发我我来帮你提取</p>
</blockquote>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-8252165-1-1.html">【新提醒】帮助提取eeprom小米4A千兆(22年8月新版)-小米无线路由器以及小米无线相关的设备-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></li>
</ul>
<h4 id="eeprom修改">EEPROM修改<a class="headerlink" href="#eeprom修改" title="Permanent link">&para;</a></h4>
<p><a href="https://www.right.com.cn/forum/thread-384637-1-1.html">【新提醒】关于新3(newifi 3)的eeprom文件中MAC-SN等参数位置-newifi无线路由器及网络设备-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<p>用SSH登录进入路由器的Console台后，用命令(cat /proc/mtd)的输出中，Factory区对应的就是无线和MAC/SN等的配置文件。
这个文件备份出来后，大小为64KB，可以在breed中更新eeprom处刷入路由器。</p>
<p>(下图为解锁后的输出)
用WinHex打开备份的文件(假设为eeprom.bin)</p>
<p>1)     路由器的SN
路由器的SN号在路由器的背面贴纸处有，SN的存储在这个文件中的偏移0x7000(处)，格式为以MND开头，如下：</p>
<p>2)     路由器的MAC地址
路由器的MAC号在路由器的背面贴纸处有，MAC的存储在这个文件中的偏移0xE000(处)，格式为连续的两个MAC地址，共占12字节。
分别为起始”MAC地址-结束MAC地址”, 结束MAC地址为起始MAC地址的最后一个字节内容+2. 如图：
起始MAC地址：20 76 93 48 A9 1F (路由器背面处的贴纸)
结束MAC地址：20 76 93 48 A9 21</p>
<p>3)     和无线有关的参数
2.4G无线的BSSID在文件开头偏移0x4-0x9处，总共6字节，如下图所示:</p>
<p>5G无线的BSSID在偏移0x8004-0x8009处，总共6字节, (2.4G无线的BSSID与5G-BSSID的最后一个字节内容相差2)。如下图所示：</p>
<p>和无线有关的参数应该是在偏移0x8000-0x80C0处。看网友们改的话，都是在0x8060-0x809F这三行上修改，由于没有具体说明参数含义，因此不推荐自己修改。
如图所示：</p>
<p>4) 未知的内容</p>
<p>文件开头的0x56-0x61偏移处，一共12字节，分为2组。前6字节和后6字节内容也比较相似。不是mac也不是bssid.</p>
<p>另外在偏移0x8060-0x80A0共4行内，有几个参数是以5个字节为一组的参数，具体格式特征如下：
00 00 26 xx xx, 或者 00 01 26 xx xx, 或者00 02 26 xx xx 等。</p>
<p>建议:
    可以用其它人的EEPROM固件，仅仅修改MAC和SN (可选：BSSID)为自己的路由器的即可，不推荐自己修改无线参数部分内容。</p>
<h3 id="mi-r3g">MI R3G<a class="headerlink" href="#mi-r3g" title="Permanent link">&para;</a></h3>
<p>官方教程：[<a href="https://openwrt.org/toh/xiaomi/mir3g">OpenWrt Wiki] Xiaomi Mi WiFi R3G (Mi Wifi Router 3G / MIR3G / MI3G / mi4a Gigabit)</a></p>
<p>r3g官方固件下载：<a href="https://firmware-selector.openwrt.org/?version=21.02.3&amp;target=ramips%2Fmt7621&amp;id=xiaomi_mi-router-3g">OpenWrt Firmware Selector</a></p>
<h4 id="准备">准备<a class="headerlink" href="#准备" title="Permanent link">&para;</a></h4>
<ul>
<li>FAT32格式U盘</li>
<li>一枚针用于戳路由器reset键</li>
<li>手机安装MIWIFI app</li>
</ul>
<h4 id="开启ssh">开启ssh<a class="headerlink" href="#开启ssh" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>更新为小米开发版固件：https://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_12f97_2.25.124.bin</p>
</li>
<li>
<p><strong>下载小米路由器手机客户端(应用商店MI WIFI)软件，绑定路由器</strong></p>
</li>
<li>
<p>根据https://d.miwifi.com/rom/ssh，开启SSH</p>
</li>
</ol>
<p><em>p.s. 1. 即使是同一型号，miwifi_ssh.bin也是不同的；2. ssh密码显示在该页面</em></p>
<ol>
<li>请将下载的工具包bin文件复制到U盘（FAT/FAT32格式）的根目录下，保证文件名为miwifi_ssh.bin；</li>
<li>断开小米路由器的电源，将U盘插入USB接口；</li>
<li>按住reset按钮之后重新接入电源，指示灯变为黄色闪烁状态即可松开reset键；</li>
<li>等待3-5秒后安装完成之后，小米路由器会自动重启，之后您就可以尽情折腾啦 ：）</li>
</ol>
<h4 id="备份">备份<a class="headerlink" href="#备份" title="Permanent link">&para;</a></h4>
<p>查看mtd分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>root@XiaoQiang:~# cat /proc/mtd
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>dev:    size   erasesize  name
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>mtd0: 07f80000 00020000 &quot;ALL&quot;
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>mtd1: 00080000 00020000 &quot;Bootloader&quot;
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>mtd2: 00040000 00020000 &quot;Config&quot;
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>mtd3: 00040000 00020000 &quot;Bdata&quot;
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>mtd4: 00040000 00020000 &quot;Factory&quot;
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>mtd5: 00040000 00020000 &quot;crash&quot;
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>mtd6: 00040000 00020000 &quot;crash_syslog&quot;
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>mtd7: 00040000 00020000 &quot;reserved0&quot;
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>mtd8: 00400000 00020000 &quot;kernel0&quot;
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>mtd9: 00400000 00020000 &quot;kernel1&quot;
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>mtd10: 02000000 00020000 &quot;rootfs0&quot;
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>mtd11: 02000000 00020000 &quot;rootfs1&quot;
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>mtd12: 03580000 00020000 &quot;overlay&quot;
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>mtd13: 012a6000 0001f000 &quot;ubi_rootfs&quot;
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>mtd14: 030ec000 0001f000 &quot;data&quot;
</span></code></pre></div>
<p>备份factory分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>cat /dev/mtd4 &gt; /tmp/factory.bin
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>#on windows
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>scp root@192.168.33.193:/tmp/factory.bin .
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>scp root@192.168.33.228:/tmp/factory.bin .
</span></code></pre></div>
<h4 id="刷openwrt">刷openwrt<a class="headerlink" href="#刷openwrt" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>mtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-kernel1.bin kernel1
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>mtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-rootfs0.bin rootfs0
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>nvram set flag_try_sys1_failed=1
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>nvram commit
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>reboot
</span></code></pre></div>
<h3 id="ax6s">AX6S<a class="headerlink" href="#ax6s" title="Permanent link">&para;</a></h3>
<h4 id="步骤_1">步骤<a class="headerlink" href="#步骤_1" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/YangWang92/AX6S-unlock">YangWang92/AX6S-unlock (github.com)</a></p>
<ul>
<li>telnet后手动开启ssh
  <div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>/etc/init.d/dropbear start
</span></code></pre></div>
  ​ tips: 使用git-bash版本的ssh连接报错。使用cmd的ssh可以。
  <div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Unable to negotiate with 192.168.31.1 port 22: no matching host key type found. Their offer: ssh-rsa
</span></code></pre></div></li>
<li>必须添加boot_fw1改行，否则重启后进入原系统。
  <div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>nvram set ssh_en=1
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>nvram set uart_en=1
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>nvram set boot_wait=on
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>nvram set flag_boot_success=1
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>nvram set flag_try_sys1_failed=0
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>nvram set flag_try_sys2_failed=0
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>nvram set &quot;boot_fw1=run boot_rd_img;bootm&quot;
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>nvram commit
</span></code></pre></div></li>
<li>刷写factory.bin-&gt; firmware分区</li>
</ul>
<p>AX6S为国内版，国外版称为AX3200
- SoC：<strong>MT7622</strong>B: 2 x A53@1.35GHz CPU。
  - 满血版本是MT7622A，少了蓝牙就是MT7622BV，没有蓝牙和多媒体功能的是MT7622B，基本剩下无线功能的是MT7622E
-  ram: 256 + flash: 128
- <a href="https://openwrt.org/toh/xiaomi/ax3200">[OpenWrt Wiki] Xiaomi AX3200 / Redmi AX6S</a></p>
<h3 id="竞斗云20pw">竞斗云2.0（P&amp;W)<a class="headerlink" href="#竞斗云20pw" title="Permanent link">&para;</a></h3>
<h4 id="资料">资料<a class="headerlink" href="#资料" title="Permanent link">&para;</a></h4>
<p><a href="https://openwrt.org/toh/p_w/r619ac">[OpenWrt Wiki] P&amp;W R619AC</a></p>
<h4 id="教程">教程<a class="headerlink" href="#教程" title="Permanent link">&para;</a></h4>
<p>需要先刷入opboot（一个第三方bootloader）<a href="https://www.red-yellow.net/竞斗云2刷opboot.html">竞斗云2刷opboot - 路由智态 (red-yellow.net)</a></p>
<p>然后再刷openwrt。
编译：<a href="https://www.red-yellow.net/%e7%ab%9e%e6%96%97%e4%ba%912%e7%9a%84openwrt%e5%9b%ba%e4%bb%b6.html">竞斗云2的OpenWrt固件 - 路由智态 (red-yellow.net)</a>
刷的这里作者提供的immortalwrt：<a href="https://www.right.com.cn/forum/thread-4061585-1-1.html">【新提醒】【2023-6-13】竞斗云2.0P&amp;W-R619AC OPENWRT固件|插件全面|多版本-OPENWRT专版-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<p>之前使用switch官方固件22.03，看到device有eth0, eth1，然后switch界面可以设置4个lan口
但是问题是只要一改动vlan设置，通过wan口（开启192.168.99.0的dhcp）访问p2w就会掉</p>
<p>后面刷了一个其它人编译的immortalwrt固件，发现其实只有一个eth0。wan口eth0.2是一个vlan。switch界面有4个lan和1个wan可以配置。
这下配置switch vlan异常稳定顺畅
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/vlan-plan.jpg" /></p>
<p>这里CPU端口的tag和untag
- 设置为off，则不存在eth0.3设备
- 设置为tag则eth0.3上tcpdump能收到很多包
- 设置为untag，则收不到包</p>
<p>收到的包其实只有广播等情况，否则包直接从特定端口出去了，不会往其它端口发。
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>root@p2w:~# tcpdump -ni eth0.3 host 114.214.236.72
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>listening on eth0.3, link-type EN10MB (Ethernet), capture size 262144 bytes
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>q01:50:16.005639 IP 114.214.236.72.45520 &gt; 239.255.255.250.1900: UDP, length 94
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>01:50:16.006412 ARP, Request who-has 114.214.236.74 tell 114.214.236.72, length 46
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>01:50:16.173072 ARP, Request who-has 114.214.236.96 tell 114.214.236.72, length 46
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>01:50:16.926278 ARP, Request who-has 114.214.236.200 tell 114.214.236.72, length 46
</span></code></pre></div></p>
<h4 id="遇到问题">遇到问题<a class="headerlink" href="#遇到问题" title="Permanent link">&para;</a></h4>
<p>经常性的掉网络，研究后发现是ap的br-lan和上游无法连接了。通过无线手动设置静态ip可以连上p2w。尝试ping 网关地址，发现eth0.1上能抓到arp包，但是上游对应bridge却抓不到。反过来，上游arping ap地址，ap也收不到包。
- 测试如果把连接ap的网线连接笔记本，网络是正常的，因此排除上游问题。
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>arping -i interface 测试二层是否通
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>arp查看当前mac表
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>tcpdump -ni eth0.1 arp
</span></code></pre></div></p>
<p>没办法，不知如何解决，只好重装了官方22.03.5的系统。官方系统把wan单独拿了出来作为eth1，而switch界面可以配置eth0和剩余四个端口</p>
<h3 id="360-t7">360 T7<a class="headerlink" href="#360-t7" title="Permanent link">&para;</a></h3>
<h4 id="基本参数">基本参数<a class="headerlink" href="#基本参数" title="Permanent link">&para;</a></h4>
<p>mt7681：2xA53@1.3GHz
256 RAM+ 128 NAND</p>
<p>价格
- 原版118x2包邮，魔改512内存版：150</p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815125432.png" /></p>
<p>待机60多度有毒，看来还是需要自己加散热片</p>
<p>40(30，最小覆盖两个的距离) x25（深度10mm）
- 13x7
- 12x13
25x25
- 10x12
30x25（深度：15mm）
- 13x14</p>
<p>单个芯片：14x14
整个盖住：25x25，30x20</p>
<p><a href="https://cmi.hanwckf.top/">hanwckf's blog</a>
<a href="https://qust.me/post/360t7-openwrt/">360 T7 刷 openwrt 教程｜最强的百元路由器 | 酱紫表 (qust.me)</a>
<a href="https://www.right.com.cn/forum/thread-8263290-1-1.html">【新提醒】360T7 openwrt固件发布，感谢H大-OPENWRT专版-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
提到了ipv6 + wiregaurd + hnat有问题？<a href="https://www.v2ex.com/t/930398">[避坑] 360T7 - V2EX</a></p>
<h4 id="准备_1">准备<a class="headerlink" href="#准备_1" title="Permanent link">&para;</a></h4>
<p>硬件
- 拆机工具：螺丝刀，撬片（没它真打不开）
- usb转ttl模块，杜邦线公对母</p>
<p>软件
- putty等串口软件
- 修改版uboot：<a href="https://github.com/hanwckf/bl-mt798x/releases/tag/20230727">Release 20230727 · hanwckf/bl-mt798x (github.com)</a>
- 固件：237, immortal原版
- 可能需要：旧版原厂固件，新版固件关闭了failsafe模式<a href="https://github.com/hqvv/360T7">hqvv/360T7: qihoo 360T7 resources and official firmware (github.com)</a>
- 可选，windows netcat，用于在failsafe模式下备份路由器flash。</p>
<h4 id="1-拆机和ttl模块连接">1. 拆机和TTL模块连接<a class="headerlink" href="#1-拆机和ttl模块连接" title="Permanent link">&para;</a></h4>
<p>拆机注意：
- 路由器只有两个螺丝，都被背面贴纸盖住了
- 一共有2+8个卡口，非常难拆。优先从路由器下方撬开，然后再两侧，最后上侧比较容易。
  - 视频参考：<a href="https://www.bilibili.com/video/BV1GV4y1P74A/?spm_id_from=333.880.my_history.page.click">360T7第二部分拆机_哔哩哔哩_bilibili</a></p>
<p>TTL模块连接
板子左上角四个触孔，从上到下：RX, TX, GND。<strong>波特率115200</strong>
- 注意，对应TTL模块一侧，RX需要对应TX，TX对应RX</p>
<h4 id="2-ttl进入failsafe模式开启telnet">2. TTL进入failsafe模式开启telnet<a class="headerlink" href="#2-ttl进入failsafe模式开启telnet" title="Permanent link">&para;</a></h4>
<p>原理
- 原系统使用uboot，但是关闭了uboot菜单，开机后会直接引导内核
- 原系统引导过程中支持failsafe模式，进入后可以mount_root，对文件系统进行修改，从而可以开启telnet</p>
<p>过程
- 连接好串口，并打开putty后，插电开机，路由器启动并输出信息
- 在引导内核过程中，会出现进入failsafe提示，按f+enter即可进入。大概有3秒等待时间。
  - 如果没出现，需要降级原系统。<a href="https://www.right.com.cn/forum/thread-8297040-1-1.html">【新提醒】360t7m(t7移动定制版)无法进入failsafe模式-OPENWRT专版-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815140202.png" /></p>
<p>进入后
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># 开启uboot控制台菜单</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>fw_setenv<span class="w"> </span>bootmenu_delay<span class="w"> </span><span class="m">3</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># 挂载rootfs并开启telnet</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>mount_root
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/.*local debug=.*/\tlocal debug=1/&#39;</span><span class="w"> </span>/etc/init.d/telnet
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1"># 修改root密码</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>passwd<span class="w"> </span>root
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c1"># 重启</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>reboot
</span></code></pre></div></p>
<p>可以选择备份固件
- 注意千万不要ping，否则无法ctrl-c
- nc结束后会自动退出，128MB的flash不到1分钟能够下载完。
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># 将电脑的IP地址设置为192.168.1.8，插入路由器LAN口</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c1"># 使用nc监听3333端口并写入all.bin</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c1"># Windows系统可以使用netcat</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># nc -l -p 3333 &gt; all.bin</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="c1"># 在路由器failsafe模式下开启网络</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">0</span>.0.0.0
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>brctl<span class="w"> </span>addbr<span class="w"> </span>br-lan
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>ifconfig<span class="w"> </span>br-lan<span class="w"> </span><span class="m">192</span>.168.1.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span>up
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>brctl<span class="w"> </span>addif<span class="w"> </span>br-lan<span class="w"> </span>eth0
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="c1"># 读取/dev/mtd0，使用nc发送到192.168.1.8:3333</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>cat<span class="w"> </span>/dev/mtd0<span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span><span class="m">192</span>.168.1.8<span class="w"> </span><span class="m">3333</span>
</span></code></pre></div></p>
<h4 id="3-刷改版uboot并刷固件">3. 刷改版uboot并刷固件<a class="headerlink" href="#3-刷改版uboot并刷固件" title="Permanent link">&para;</a></h4>
<p>改版uboot功能详细介绍：<a href="https://cmi.hanwckf.top/p/mt798x-uboot-usage/">mt798x uboot 功能介绍 (hanwckf.top)</a>
- 如果使用原版uboot，则固件大小最多只能使用36MB，改版支持108MB
- 支持webui方便刷固件</p>
<p>步骤
- 上一步开启telnet后，正常重启系统
- telnet连接路由器，root用户名，密码为上一步修改的密码
- 本地python搭建一个http服务，路由器上通过wget下载改版uboot
- 刷写
  <div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>mtd write 360t7-fip-fixed-parts.bin fip
</span></code></pre></div>
- 按住reset键，插上路由器电源，保持3秒左右，灯变为绿色
- 设置静态ip 192.168.1.2，即可打开路由器web界面。
- 选择固件上传即可（需要对应改版uboot分区格式的）</p>
<h4 id="固件选择">固件选择<a class="headerlink" href="#固件选择" title="Permanent link">&para;</a></h4>
<h5 id="mtwifi闭源驱动">mtwifi闭源驱动<a class="headerlink" href="#mtwifi闭源驱动" title="Permanent link">&para;</a></h5>
<p><a href="https://www.right.com.cn/forum/thread-8263340-1-1.html">恩山237大佬固件</a>
- Hanwckf 的源码+18.06软件包
- 支持802.11 k/v/r无缝漫游、硬件 QOS等功能
- 通过uboot刷入过程中，不知为何刷完重启后灯灭了一段时间。刚开始还以为是进不了系统，但是后面发现没问题的。
- 界面主题是design，确实很好看
- 致命问题：由于是自编译，无法安装wireguard
- 第二个严重问题：没有使用wpad，而是使用luci-app-mtk管理无线，这导致配置FT没法</p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230818012311.png" /></p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230818012256.png" /></p>
<p><a href="https://github.com/hanwckf/immortalwrt-mt798x">hanwckf/immortalwrt-mt798x (github.com)</a>
- <a href="https://cmi.hanwckf.top/p/immortalwrt-mt798x/">immortalwrt-mt798x项目介绍 (hanwckf.top)</a></p>
<p>QWRT(lean)
<a href="https://www.right.com.cn/forum/thread-8283847-1-1.html">【新提醒】潘多拉 QWRT MT7981 360T7 R23.5.4 高性能闭源固件发布（原生无线配置）-OPENWRT专版-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
- lua界面
- 原版无线配置</p>
<p>加群后，群主告诉我，闭源驱动只能和闭源驱动组mesh，并且也不太支持802.11r。</p>
<p>ImmortalwrtARM
<a href="https://www.right.com.cn/forum/thread-5053708-1-1.html">【新提醒】【2023-08-12】小米WR30U闭源驱动immortalwrt固件-小米无线路由器以及小米无线相关的设备-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
- <a href="https://www.v2ex.com/t/930398">[避坑] 360T7 - V2EX</a>在这里看到说padavanonly/immortalwrtARM FT正常</p>
<h5 id="不确定">不确定<a class="headerlink" href="#不确定" title="Permanent link">&para;</a></h5>
<p><a href="https://firmware-selector.immortalwrt.org/?version=23.05.0-rc3&amp;target=mediatek%2Ffilogic&amp;id=qihoo_360t7-ubootmod">原版immortalwrt</a>
- 使用了下发现wan口设置dhcp刚开始总有问题，虽然最后通过手动重启dnsmasq方式解决了，但是确实不是很顺利。</p>
<p>自编译</p>
<p>大佬你好。我购买了 360T7 和 wr30u 来对家中网络进行升级。但是由于这两个都没有官方 openwrt 支持，我用的都是别人编译的版本。
360T7 用的是这个<a href="https://github.com/hanwckf/immortalwrt-mt798x">hanwckf/immortalwrt-mt798x (github.com)</a>，但是它的无限配置是 luci-app-mtk ，我找不到 802.11r 的配置选项。
wr30u 用的是这个 https://www.right.com.cn/forum/thread-8284824-1-1.html ，它有 802.11r 但是却啥都不能设置，我查看日志看到 FT 会有 The PMKID is invalid 错误。现象就是连上它之后压根不会漫游，甚至强度低于-80db 了都不会，只能手动断开 wifi 重连。</p>
<p>看到你测试了无线开源和闭源的固件，我想问下开源的固件在那找。我不需要最强的性能，我只想要它的设置和官方 openwrt 一样，可以一起工作就行。😭</p>
<p>注：家中网络原本是 ax6s(做 ac ）+3 R3g （ ap ），802.11r 工作得很正常。</p>
<h3 id="小米wr30u">小米WR30U<a class="headerlink" href="#小米wr30u" title="Permanent link">&para;</a></h3>
<h4 id="刷机">刷机<a class="headerlink" href="#刷机" title="Permanent link">&para;</a></h4>
<p>一个比较广泛的教程：<a href="https://blog.qust.me/wr30u">小米 WR30U 解锁 SSH 刷 openwrt，最有性价比的百元路由器 (qust.me)</a></p>
<p>这里的uboot用的是哪个不清楚，不是</p>
<p>恢复uboot：<a href="https://www.right.com.cn/forum/thread-8291160-1-1.html">【新提醒】小米WR30U 恢复原厂固件的几种方法-小米无线路由器以及小米无线相关的设备-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<h4 id="固件">固件<a class="headerlink" href="#固件" title="Permanent link">&para;</a></h4>
<ul>
<li>QWRT
<a href="https://www.right.com.cn/forum/thread-8284824-1-1.html">【新提醒】潘多拉 QWRT MT7981 小米 WR30U 联通版 高性能闭源固件发布（原生无线配置）-OPENWRT专版-恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></li>
</ul>
<p><a href="https://x-wrt.com/">X-Wrt, for IoT, a custom Distribution for OpenWrt</a></p>
<h3 id="ft">FT<a class="headerlink" href="#ft" title="Permanent link">&para;</a></h3>
<p><a href="https://post.smzdm.com/p/a6lr03wg/">OpenWRT 路由器快速漫游（802.11r）配置教程以及深度解析_路由器_什么值得买 (smzdm.com)</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>
</span></code></pre></div></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Thu Aug 17 11:31:19 2023 kern.warn kernel: [164938.908390] 7981@C13L2,MacTableInsertEntry() 1537: New Sta:2a:85:8f:ff:be:e3
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>Thu Aug 17 11:31:19 2023 kern.err kernel: [164938.915643] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>Thu Aug 17 11:31:22 2023 kern.notice kernel: [164942.301972] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>Thu Aug 17 11:31:22 2023 kern.err kernel: [164942.314678] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>Thu Aug 17 11:31:26 2023 kern.notice kernel: [164945.762095] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>Thu Aug 17 11:31:26 2023 kern.err kernel: [164945.774793] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>Thu Aug 17 11:31:32 2023 kern.warn kernel: [164952.375145] 7981@C01L2,wifi_sys_disconn_act() 1002:  wdev_idx=1
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>Thu Aug 17 11:31:32 2023 kern.warn kernel: [164952.381500] 7981@C13L2,MacTableDeleteEntry() 1793: Del Sta:2a:85:8f:ff:be:e3
</span></code></pre></div>
<p>客厅r3g
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, OPEN_SYSTEM)
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authenticated
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-ASSOCIATE.indication(2a:85:8f:ff:be:e3)
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 1 notification
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: start authentication
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: unauthorizing port
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 1/4 msg of 4-Way Handshake
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (2/4 Pairwise)
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 3/4 msg of 4-Way Handshake
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (4/4 Pairwise)
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>Thu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: authorizing port
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 RADIUS: starting accounting session CDB345D82723F2E1
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: pairwise key handshake completed (RSN)
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>Thu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: EAPOL-4WAY-HS-COMPLETED 2a:85:8f:ff:be:e3
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>Thu Aug 17 11:36:38 2023 daemon.notice hostapd: wlan1: AP-STA-DISCONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>Thu Aug 17 11:36:38 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: disassociated due to inactivity
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>Thu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DISASSOCIATE.indication(2a:85:8f:ff:be:e3, 4)
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>Thu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>Thu Aug 17 11:36:39 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: deauthenticated due to inactivity (timer DEAUTH/REMOVE)
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>Thu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DEAUTHENTICATE.indication(2a:85:8f:ff:be:e3, 2)
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>Thu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span></code></pre></div></p>
<p>op3(ax6s)
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authentication OK (FT)
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, FT)
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>Thu Aug 17 11:30:57 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>Thu Aug 17 11:30:57 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-REASSOCIATE.indication(2a:85:8f:ff:be:e3)
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 6 notification
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: FT authentication already completed - do not start 4-way handshake
</span></code></pre></div></p>
<h4 id="其它">其它<a class="headerlink" href="#其它" title="Permanent link">&para;</a></h4>
<p>原厂系统
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141433.png" />
支持的功能
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141449.png" /></p>
<p>从咸鱼上买的，路由器系统里可以看到1月份的日志。
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141342.png" /></p>
<p>uboot控制台
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141529.png" /></p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141559.png" /></p>
<p>webui刷机时串口输出
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141615.png" /></p>
<h2 id="硬件性能测试wg带宽">硬件性能测试(wg带宽)<a class="headerlink" href="#硬件性能测试wg带宽" title="Permanent link">&para;</a></h2>
<h3 id="king3399">king3399<a class="headerlink" href="#king3399" title="Permanent link">&para;</a></h3>
<p>未加密
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>root@op1 ➜  ~ iperf3 -c 114.214.236.90
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>[  5]   0.00-10.00  sec  1.10 GBytes   943 Mbits/sec   70             sender
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>[  5]   0.00-10.05  sec  1.09 GBytes   936 Mbits/sec                  receiver
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>root@op1 ➜  ~ iperf3 -c king6.yfycloud.top
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>[  5]   0.00-10.00  sec  1.08 GBytes   924 Mbits/sec   29             sender
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>[  5]   0.00-10.04  sec  1.07 GBytes   918 Mbits/sec                  receiver
</span></code></pre></div></p>
<p>wg
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>➜  ~ iperf3 -c king
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>[  5]   0.00-10.00  sec  1.04 GBytes   893 Mbits/sec  70559             sender
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>[  5]   0.00-10.04  sec  1.04 GBytes   887 Mbits/sec                  receiver
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>➜  ~ iperf3 -c king -R
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>[  5]   0.00-10.04  sec   691 MBytes   577 Mbits/sec    2             sender
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>[  5]   0.00-10.00  sec   688 MBytes   577 Mbits/sec                  receiver
</span></code></pre></div></p>
<h3 id="p2w">p2w<a class="headerlink" href="#p2w" title="Permanent link">&para;</a></h3>
<p>未加密，居然跑不满千兆（连接中间通过了一个usb 千兆网卡）
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>➜  ~ iperf3 -c p2w
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>[  5]   0.00-10.00  sec   754 MBytes   633 Mbits/sec  344             sender
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>[  5]   0.00-10.00  sec   752 MBytes   630 Mbits/sec                  receiver
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>➜  ~ iperf3 -c p2w -R
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>[  5]   0.00-10.01  sec   902 MBytes   757 Mbits/sec  738             sender
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>[  5]   0.00-10.00  sec   902 MBytes   757 Mbits/sec                  receiver
</span></code></pre></div></p>
<h3 id="ax6s_1">ax6s<a class="headerlink" href="#ax6s_1" title="Permanent link">&para;</a></h3>
<p>未加密（中间是一个usb千兆网卡）
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>(base) yfy@Tianyi ➜  ~ iperf3 -c 192.168.36.2
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>[  5]   0.00-10.00  sec  1.10 GBytes   942 Mbits/sec    0             sender
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>[  5]   0.00-10.01  sec  1.09 GBytes   939 Mbits/sec                  receiver
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>(base) yfy@Tianyi ➜  ~ iperf3 -c 192.168.36.2 -R
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>[  5]   0.00-10.00  sec  1.09 GBytes   940 Mbits/sec    0             sender
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>[  5]   0.00-10.00  sec  1.09 GBytes   939 Mbits/sec                  receiver
</span></code></pre></div></p>
<p>wg
复用之前的home到学校数据
baseline：ipv6直连
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>home下载
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>[SUM]   0.00-10.00  sec   798 MBytes   669 Mbits/sec  468             sender
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>[SUM]   0.00-10.05  sec   786 MBytes   656 Mbits/sec                  receiver
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>home上传
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>[SUM]   0.00-10.06  sec   925 MBytes   771 Mbits/sec  1185             sender
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>[SUM]   0.00-10.00  sec   918 MBytes   770 Mbits/sec                  receiver
</span></code></pre></div></p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>➜  ~ iperf3 -c op3
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>[  5]   0.00-10.00  sec   163 MBytes   137 Mbits/sec    0             sender
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>[  5]   0.00-10.05  sec   161 MBytes   134 Mbits/sec                  receiver
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>➜  ~ iperf3 -c op3 -P 5
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>[SUM]   0.00-10.00  sec   537 MBytes   450 Mbits/sec  302             sender
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>[SUM]   0.00-10.06  sec   525 MBytes   438 Mbits/sec                  receiver
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>➜  ~ iperf3 -c op3 -R
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>[  5]   0.00-10.05  sec   235 MBytes   196 Mbits/sec  170             sender
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>[  5]   0.00-10.00  sec   234 MBytes   196 Mbits/sec                  receiver
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>➜  ~ iperf3 -c op3 -R -P 5
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>[SUM]   0.00-10.05  sec   504 MBytes   421 Mbits/sec    0             sender
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>[SUM]   0.00-10.00  sec   497 MBytes   417 Mbits/sec                  receiver
</span></code></pre></div>
恐怖的CPU占用
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230810160001.png" /></p>







  
  




  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../2022-02-13-openwrt%E7%BC%96%E8%AF%91/" class="md-footer__link md-footer__link--prev" aria-label="上一页: openwrt编译">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                openwrt编译
              </div>
            </div>
          </a>
        
        
          
          <a href="../../14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/" class="md-footer__link md-footer__link--next" aria-label="下一页: 如何实现网络自由">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                如何实现网络自由
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/TheRainstorm" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.footer", "content.code.copy", "toc.follow", "toc.integrate"], "search": "../../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>